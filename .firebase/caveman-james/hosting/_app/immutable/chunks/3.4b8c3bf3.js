import{s as zs,v as An,h as In,o as Cn,i as Hs,d as re,r as un,j as Ys,n as ya}from"./scheduler.2364b0ad.js";import{S as Gs,i as Ws,d as Ne,v as Js,j as ne,s as ve,u as _a,k as ae,c as we,w as ba,m as Q,a as Ce,x as va,f as wa,t as xa,g as te,y as ka,C as Qs,D as Xs,E as xr,o as wt,l as he,A as Ge,p as xt,n as Ea,z as Y,F as dt,B as Qe,G as Dn,H as Mn,q as Tr,I as Pa,J as Nn}from"./index.9f7452a2.js";import{g as ei}from"./globals.7f7f1b26.js";import{a as kt,_ as vt,p as ti,g as Ke,b as ri,c as Oa,R as Ta,B as Sa,H as ja,d as Aa,e as ni,f as ai,O as Wr,S as Jr,A as Ia,N as Ca}from"./NavBar.28f036ee.js";import{g as Da,_ as Ae,e as si,f as Ln,c as _r,P as br,a as vr,d as Qr,G as ii,b as Rn}from"./public.9062b0fe.js";import{g as oi,T as ui,c as pr}from"./_commonjs-dynamic-modules.6fed1697.js";import{w as qr}from"./index.db1f7a41.js";import{H as li}from"./hf.6d567cb7.js";let mr;const ci=new Uint8Array(16);function di(){if(!mr&&(mr=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!mr))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return mr(ci)}const xe=[];for(let n=0;n<256;++n)xe.push((n+256).toString(16).slice(1));function hi(n,e=0){return(xe[n[e+0]]+xe[n[e+1]]+xe[n[e+2]]+xe[n[e+3]]+"-"+xe[n[e+4]]+xe[n[e+5]]+"-"+xe[n[e+6]]+xe[n[e+7]]+"-"+xe[n[e+8]]+xe[n[e+9]]+"-"+xe[n[e+10]]+xe[n[e+11]]+xe[n[e+12]]+xe[n[e+13]]+xe[n[e+14]]+xe[n[e+15]]).toLowerCase()}const fi=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Zn={randomUUID:fi};function We(n,e,t){if(Zn.randomUUID&&!e&&!n)return Zn.randomUUID();n=n||{};const r=n.random||(n.rng||di)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){t=t||0;for(let a=0;a<16;++a)e[t+a]=r[a];return e}return hi(r)}class pi{}class lr extends pi{get lc_namespace(){return["langchain","callbacks",this.name]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}constructor(e){var t;super(),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ignoreLLM",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreChain",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreAgent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"awaitHandlers",{enumerable:!0,configurable:!0,writable:!0,value:typeof process<"u"?((t=process.env)==null?void 0:t.LANGCHAIN_CALLBACKS_BACKGROUND)!=="true":!0}),this.lc_kwargs=e||{},e&&(this.ignoreLLM=e.ignoreLLM??this.ignoreLLM,this.ignoreChain=e.ignoreChain??this.ignoreChain,this.ignoreAgent=e.ignoreAgent??this.ignoreAgent)}copy(){return new this.constructor(this)}toJSON(){return kt.prototype.toJSON.call(this)}toJSONNotImplemented(){return kt.prototype.toJSONNotImplemented.call(this)}static fromMethods(e){class t extends lr{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:We()}),Object.assign(this,e)}}return new t}}var ln={exports:{}};ln.exports;(function(n){const t=(s=0)=>i=>`\x1B[${38+s};5;${i}m`,r=(s=0)=>(i,o,u)=>`\x1B[${38+s};2;${i};${o};${u}m`;function a(){const s=new Map,i={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};i.color.gray=i.color.blackBright,i.bgColor.bgGray=i.bgColor.bgBlackBright,i.color.grey=i.color.blackBright,i.bgColor.bgGrey=i.bgColor.bgBlackBright;for(const[o,u]of Object.entries(i)){for(const[c,m]of Object.entries(u))i[c]={open:`\x1B[${m[0]}m`,close:`\x1B[${m[1]}m`},u[c]=i[c],s.set(m[0],m[1]);Object.defineProperty(i,o,{value:u,enumerable:!1})}return Object.defineProperty(i,"codes",{value:s,enumerable:!1}),i.color.close="\x1B[39m",i.bgColor.close="\x1B[49m",i.color.ansi256=t(),i.color.ansi16m=r(),i.bgColor.ansi256=t(10),i.bgColor.ansi16m=r(10),Object.defineProperties(i,{rgbToAnsi256:{value:(o,u,c)=>o===u&&u===c?o<8?16:o>248?231:Math.round((o-8)/247*24)+232:16+36*Math.round(o/255*5)+6*Math.round(u/255*5)+Math.round(c/255*5),enumerable:!1},hexToRgb:{value:o=>{const u=/(?<colorString>[a-f\d]{6}|[a-f\d]{3})/i.exec(o.toString(16));if(!u)return[0,0,0];let{colorString:c}=u.groups;c.length===3&&(c=c.split("").map(k=>k+k).join(""));const m=Number.parseInt(c,16);return[m>>16&255,m>>8&255,m&255]},enumerable:!1},hexToAnsi256:{value:o=>i.rgbToAnsi256(...i.hexToRgb(o)),enumerable:!1}}),i}Object.defineProperty(n,"exports",{enumerable:!0,get:a})})(ln);var mi=ln.exports;const Ma=Da(mi);class cn extends lr{constructor(e){super(...arguments),Object.defineProperty(this,"runMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map})}copy(){return this}_addChildRun(e,t){e.child_runs.push(t)}_startTrace(e){if(e.parent_run_id!==void 0){const t=this.runMap.get(e.parent_run_id);t&&this._addChildRun(t,e)}this.runMap.set(e.id,e)}async _endTrace(e){const t=e.parent_run_id!==void 0&&this.runMap.get(e.parent_run_id);t?t.child_execution_order=Math.max(t.child_execution_order,e.child_execution_order):await this.persistRun(e),this.runMap.delete(e.id)}_getExecutionOrder(e){const t=e!==void 0&&this.runMap.get(e);return t?t.child_execution_order+1:1}async handleLLMStart(e,t,r,a,s,i,o){var M;const u=this._getExecutionOrder(a),c=Date.now(),m=o?{...s,metadata:o}:s,k={id:r,name:e.id[e.id.length-1],parent_run_id:a,start_time:c,serialized:e,events:[{name:"start",time:c}],inputs:{prompts:t},execution_order:u,child_runs:[],child_execution_order:u,run_type:"llm",extra:m??{},tags:i||[]};this._startTrace(k),await((M=this.onLLMStart)==null?void 0:M.call(this,k))}async handleChatModelStart(e,t,r,a,s,i,o){var M;const u=this._getExecutionOrder(a),c=Date.now(),m=o?{...s,metadata:o}:s,k={id:r,name:e.id[e.id.length-1],parent_run_id:a,start_time:c,serialized:e,events:[{name:"start",time:c}],inputs:{messages:t},execution_order:u,child_runs:[],child_execution_order:u,run_type:"llm",extra:m??{},tags:i||[]};this._startTrace(k),await((M=this.onLLMStart)==null?void 0:M.call(this,k))}async handleLLMEnd(e,t){var a;const r=this.runMap.get(t);if(!r||(r==null?void 0:r.run_type)!=="llm")throw new Error("No LLM run to end.");r.end_time=Date.now(),r.outputs=e,r.events.push({name:"end",time:r.end_time}),await((a=this.onLLMEnd)==null?void 0:a.call(this,r)),await this._endTrace(r)}async handleLLMError(e,t){var a;const r=this.runMap.get(t);if(!r||(r==null?void 0:r.run_type)!=="llm")throw new Error("No LLM run to end.");r.end_time=Date.now(),r.error=e.message,r.events.push({name:"error",time:r.end_time}),await((a=this.onLLMError)==null?void 0:a.call(this,r)),await this._endTrace(r)}async handleChainStart(e,t,r,a,s,i){var m;const o=this._getExecutionOrder(a),u=Date.now(),c={id:r,name:e.id[e.id.length-1],parent_run_id:a,start_time:u,serialized:e,events:[{name:"start",time:u}],inputs:t,execution_order:o,child_execution_order:o,run_type:"chain",child_runs:[],extra:i?{metadata:i}:{},tags:s||[]};this._startTrace(c),await((m=this.onChainStart)==null?void 0:m.call(this,c))}async handleChainEnd(e,t){var a;const r=this.runMap.get(t);if(!r||(r==null?void 0:r.run_type)!=="chain")throw new Error("No chain run to end.");r.end_time=Date.now(),r.outputs=e,r.events.push({name:"end",time:r.end_time}),await((a=this.onChainEnd)==null?void 0:a.call(this,r)),await this._endTrace(r)}async handleChainError(e,t){var a;const r=this.runMap.get(t);if(!r||(r==null?void 0:r.run_type)!=="chain")throw new Error("No chain run to end.");r.end_time=Date.now(),r.error=e.message,r.events.push({name:"error",time:r.end_time}),await((a=this.onChainError)==null?void 0:a.call(this,r)),await this._endTrace(r)}async handleToolStart(e,t,r,a,s,i){var m;const o=this._getExecutionOrder(a),u=Date.now(),c={id:r,name:e.id[e.id.length-1],parent_run_id:a,start_time:u,serialized:e,events:[{name:"start",time:u}],inputs:{input:t},execution_order:o,child_execution_order:o,run_type:"tool",child_runs:[],extra:i?{metadata:i}:{},tags:s||[]};this._startTrace(c),await((m=this.onToolStart)==null?void 0:m.call(this,c))}async handleToolEnd(e,t){var a;const r=this.runMap.get(t);if(!r||(r==null?void 0:r.run_type)!=="tool")throw new Error("No tool run to end");r.end_time=Date.now(),r.outputs={output:e},r.events.push({name:"end",time:r.end_time}),await((a=this.onToolEnd)==null?void 0:a.call(this,r)),await this._endTrace(r)}async handleToolError(e,t){var a;const r=this.runMap.get(t);if(!r||(r==null?void 0:r.run_type)!=="tool")throw new Error("No tool run to end");r.end_time=Date.now(),r.error=e.message,r.events.push({name:"error",time:r.end_time}),await((a=this.onToolError)==null?void 0:a.call(this,r)),await this._endTrace(r)}async handleAgentAction(e,t){var s;const r=this.runMap.get(t);if(!r||(r==null?void 0:r.run_type)!=="chain")return;const a=r;a.actions=a.actions||[],a.actions.push(e),a.events.push({name:"agent_action",time:Date.now(),kwargs:{action:e}}),await((s=this.onAgentAction)==null?void 0:s.call(this,r))}async handleAgentEnd(e,t){var a;const r=this.runMap.get(t);!r||(r==null?void 0:r.run_type)!=="chain"||(r.events.push({name:"agent_end",time:Date.now(),kwargs:{action:e}}),await((a=this.onAgentEnd)==null?void 0:a.call(this,r)))}async handleText(e,t){var a;const r=this.runMap.get(t);!r||(r==null?void 0:r.run_type)!=="chain"||(r.events.push({name:"text",time:Date.now(),kwargs:{text:e}}),await((a=this.onText)==null?void 0:a.call(this,r)))}async handleLLMNewToken(e,t,r){var s;const a=this.runMap.get(r);!a||(a==null?void 0:a.run_type)!=="llm"||(a.events.push({name:"new_token",time:Date.now(),kwargs:{token:e,idx:t}}),await((s=this.onLLMNewToken)==null?void 0:s.call(this,a)))}}function Le(n,e){return`${n.open}${e}${n.close}`}function rt(n,e){try{return JSON.stringify(n,null,2)}catch{return e}}function yt(n){if(!n.end_time)return"";const e=n.end_time-n.start_time;return e<1e3?`${e}ms`:`${(e/1e3).toFixed(2)}s`}const{color:Ve}=Ma;class Bn extends cn{constructor(){super(...arguments),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"console_callback_handler"})}persistRun(e){return Promise.resolve()}getParents(e){const t=[];let r=e;for(;r.parent_run_id;){const a=this.runMap.get(r.parent_run_id);if(a)t.push(a),r=a;else break}return t}getBreadcrumbs(e){const r=[...this.getParents(e).reverse(),e].map((a,s,i)=>{const o=`${a.execution_order}:${a.run_type}:${a.name}`;return s===i.length-1?Le(Ma.bold,o):o}).join(" > ");return Le(Ve.grey,r)}onChainStart(e){const t=this.getBreadcrumbs(e);console.log(`${Le(Ve.green,"[chain/start]")} [${t}] Entering Chain run with input: ${rt(e.inputs,"[inputs]")}`)}onChainEnd(e){const t=this.getBreadcrumbs(e);console.log(`${Le(Ve.cyan,"[chain/end]")} [${t}] [${yt(e)}] Exiting Chain run with output: ${rt(e.outputs,"[outputs]")}`)}onChainError(e){const t=this.getBreadcrumbs(e);console.log(`${Le(Ve.red,"[chain/error]")} [${t}] [${yt(e)}] Chain run errored with error: ${rt(e.error,"[error]")}`)}onLLMStart(e){const t=this.getBreadcrumbs(e),r="prompts"in e.inputs?{prompts:e.inputs.prompts.map(a=>a.trim())}:e.inputs;console.log(`${Le(Ve.green,"[llm/start]")} [${t}] Entering LLM run with input: ${rt(r,"[inputs]")}`)}onLLMEnd(e){const t=this.getBreadcrumbs(e);console.log(`${Le(Ve.cyan,"[llm/end]")} [${t}] [${yt(e)}] Exiting LLM run with output: ${rt(e.outputs,"[response]")}`)}onLLMError(e){const t=this.getBreadcrumbs(e);console.log(`${Le(Ve.red,"[llm/error]")} [${t}] [${yt(e)}] LLM run errored with error: ${rt(e.error,"[error]")}`)}onToolStart(e){var r;const t=this.getBreadcrumbs(e);console.log(`${Le(Ve.green,"[tool/start]")} [${t}] Entering Tool run with input: "${(r=e.inputs.input)==null?void 0:r.trim()}"`)}onToolEnd(e){var r,a;const t=this.getBreadcrumbs(e);console.log(`${Le(Ve.cyan,"[tool/end]")} [${t}] [${yt(e)}] Exiting Tool run with output: "${(a=(r=e.outputs)==null?void 0:r.output)==null?void 0:a.trim()}"`)}onToolError(e){const t=this.getBreadcrumbs(e);console.log(`${Le(Ve.red,"[tool/error]")} [${t}] [${yt(e)}] Tool run errored with error: ${rt(e.error,"[error]")}`)}onAgentAction(e){const t=e,r=this.getBreadcrumbs(e);console.log(`${Le(Ve.blue,"[agent/action]")} [${r}] Agent selected action: ${rt(t.actions[t.actions.length-1],"[action]")}`)}}const gi=[400,401,403,404,405,406,407,408,409];class yi{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6;const t="default"in vt?vt.default:vt;this.queue=new t({concurrency:this.maxConcurrency})}call(e,...t){return this.queue.add(()=>ti(()=>e(...t).catch(r=>{throw r instanceof Error?r:new Error(r)}),{onFailedAttempt(r){var s;if(r.message.startsWith("Cancel")||r.message.startsWith("TimeoutError")||r.message.startsWith("AbortError")||(r==null?void 0:r.code)==="ECONNABORTED")throw r;const a=(s=r==null?void 0:r.response)==null?void 0:s.status;if(a&&gi.includes(+a))throw r},retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,t,...r){return e.signal?Promise.race([this.call(t,...r),new Promise((a,s)=>{var i;(i=e.signal)==null||i.addEventListener("abort",()=>{s(new Error("AbortError"))})})]):this.call(t,...r)}fetch(...e){return this.call(()=>fetch(...e).then(t=>t.ok?t:Promise.reject(t)))}}const _i=()=>typeof window<"u"&&typeof window.document<"u",bi=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",vi=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom")),Na=()=>typeof Deno<"u",wi=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!Na(),xi=()=>{let n;return _i()?n="browser":wi()?n="node":bi()?n="webworker":vi()?n="jsdom":Na()?n="deno":n="other",n};let zr;async function ki(){return zr===void 0&&(zr={library:"langsmith",runtime:xi()}),zr}function Un(n){var e;try{return typeof process<"u"?(e=process.env)==null?void 0:e[n]:void 0}catch{return}}const Ei=n=>{const t=n.replace("http://","").replace("https://","").split("/")[0].split(":")[0];return t==="localhost"||t==="127.0.0.1"||t==="::1"},gr=async(n,e)=>{const t=await n.text();if(!n.ok)throw new Error(`Failed to ${e}: ${n.status} ${n.statusText} ${t}`)};class dn{constructor(e={}){Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout_ms",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const t=dn.getDefaultClientConfig();this.apiUrl=e.apiUrl??t.apiUrl,this.apiKey=e.apiKey??t.apiKey,this.validateApiKeyIfHosted(),this.timeout_ms=e.timeout_ms??4e3,this.caller=new yi(e.callerOptions??{})}static getDefaultClientConfig(){return{apiUrl:Un("LANGCHAIN_ENDPOINT")??"http://localhost:1984",apiKey:Un("LANGCHAIN_API_KEY")}}validateApiKeyIfHosted(){if(!Ei(this.apiUrl)&&!this.apiKey)throw new Error("API key must be provided when using hosted LangSmith API")}get headers(){const e={};return this.apiKey&&(e["x-api-key"]=`${this.apiKey}`),e}async _get(e,t){const r=(t==null?void 0:t.toString())??"",a=`${this.apiUrl}${e}?${r}`,s=await this.caller.call(fetch,a,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});if(!s.ok)throw new Error(`Failed to fetch ${e}: ${s.status} ${s.statusText}`);return s.json()}async createRun(e){const t={...this.headers,"Content-Type":"application/json"},r=e.extra??{},a=await ki(),s=e.project_name;delete e.project_name;const i={session_name:s,...e,extra:{...e.extra,runtime:{...a,...r.runtime}}},o=await this.caller.call(fetch,`${this.apiUrl}/runs`,{method:"POST",headers:t,body:JSON.stringify(i),signal:AbortSignal.timeout(this.timeout_ms)});await gr(o,"create run")}async updateRun(e,t){const r={...this.headers,"Content-Type":"application/json"},a=await this.caller.call(fetch,`${this.apiUrl}/runs/${e}`,{method:"PATCH",headers:r,body:JSON.stringify(t),signal:AbortSignal.timeout(this.timeout_ms)});await gr(a,"update run")}async readRun(e,{loadChildRuns:t}={loadChildRuns:!1}){let r=await this._get(`/runs/${e}`);return t&&r.child_run_ids&&(r=await this._loadChildRuns(r)),r}async _loadChildRuns(e){const t=await this.listRuns({id:e.child_run_ids}),r={},a={};t.sort((s,i)=>s.execution_order-i.execution_order);for(const s of t){if(s.parent_run_id===null||s.parent_run_id===void 0)throw new Error(`Child run ${s.id} has no parent`);s.parent_run_id in r||(r[s.parent_run_id]=[]),r[s.parent_run_id].push(s),a[s.id]=s}e.child_runs=r[e.id]||[];for(const s in r)s!==e.id&&(a[s].child_runs=r[s]);return e}async listRuns({projectId:e,projectName:t,executionOrder:r,runType:a,error:s,id:i,limit:o,offset:u}){const c=new URLSearchParams;let m=e;if(t){if(e)throw new Error("Only one of projectId or projectName may be given");m=(await this.readProject({projectName:t})).id}if(m&&c.append("session",m),r&&c.append("execution_order",r.toString()),a&&c.append("run_type",a),s!==void 0&&c.append("error",s.toString()),i!==void 0)for(const k of i)c.append("id",k);return o!==void 0&&c.append("limit",o.toString()),u!==void 0&&c.append("offset",u.toString()),this._get("/runs",c)}async deleteRun(e){const t=await this.caller.call(fetch,`${this.apiUrl}/runs/${e}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});await gr(t,"delete run")}async createProject({projectName:e,projectExtra:t,upsert:r}){const a=r?"?upsert=true":"",s=`${this.apiUrl}/sessions${a}`,i={name:e};t!==void 0&&(i.extra=t);const o=await this.caller.call(fetch,s,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(i),signal:AbortSignal.timeout(this.timeout_ms)}),u=await o.json();if(!o.ok)throw new Error(`Failed to create session ${e}: ${o.status} ${o.statusText}`);return u}async readProject({projectId:e,projectName:t}){let r="/sessions";const a=new URLSearchParams;if(e!==void 0&&t!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(e!==void 0)r+=`/${e}`;else if(t!==void 0)a.append("name",t);else throw new Error("Must provide projectName or projectId");const s=await this._get(r,a);let i;if(Array.isArray(s)){if(s.length===0)throw new Error(`Project[id=${e}, name=${t}] not found`);i=s[0]}else i=s;return i}async listProjects(){return this._get("/sessions")}async deleteProject({projectId:e,projectName:t}){let r;if(e===void 0&&t===void 0)throw new Error("Must provide projectName or projectId");if(e!==void 0&&t!==void 0)throw new Error("Must provide either projectName or projectId, not both");e===void 0?r=(await this.readProject({projectName:t})).id:r=e;const a=await this.caller.call(fetch,`${this.apiUrl}/sessions/${r}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});await gr(a,`delete session ${r} (${t})`)}async uploadCsv({csvFile:e,fileName:t,inputKeys:r,outputKeys:a,description:s,dataType:i,name:o}){const u=`${this.apiUrl}/datasets/upload`,c=new FormData;c.append("file",e,t),r.forEach(M=>{c.append("input_keys",M)}),a.forEach(M=>{c.append("output_keys",M)}),s&&c.append("description",s),i&&c.append("data_type",i),o&&c.append("name",o);const m=await this.caller.call(fetch,u,{method:"POST",headers:this.headers,body:c,signal:AbortSignal.timeout(this.timeout_ms)});if(!m.ok){const M=await m.json();throw M.detail&&M.detail.includes("already exists")?new Error(`Dataset ${t} already exists`):new Error(`Failed to upload CSV: ${m.status} ${m.statusText}`)}return await m.json()}async createDataset(e,{description:t,dataType:r}={}){const a={name:e,description:t};r&&(a.data_type=r);const s=await this.caller.call(fetch,`${this.apiUrl}/datasets`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(a),signal:AbortSignal.timeout(this.timeout_ms)});if(!s.ok){const o=await s.json();throw o.detail&&o.detail.includes("already exists")?new Error(`Dataset ${e} already exists`):new Error(`Failed to create dataset ${s.status} ${s.statusText}`)}return await s.json()}async readDataset({datasetId:e,datasetName:t}){let r="/datasets";const a=new URLSearchParams({limit:"1"});if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(e!==void 0)r+=`/${e}`;else if(t!==void 0)a.append("name",t);else throw new Error("Must provide datasetName or datasetId");const s=await this._get(r,a);let i;if(Array.isArray(s)){if(s.length===0)throw new Error(`Dataset[id=${e}, name=${t}] not found`);i=s[0]}else i=s;return i}async listDatasets({limit:e=100,offset:t=0}={}){const r="/datasets",a=new URLSearchParams({limit:e.toString(),offset:t.toString()}),s=await this._get(r,a);if(!Array.isArray(s))throw new Error(`Expected ${r} to return an array, but got ${s}`);return s}async deleteDataset({datasetId:e,datasetName:t}){let r="/datasets",a=e;if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(t!==void 0&&(a=(await this.readDataset({datasetName:t})).id),a!==void 0)r+=`/${a}`;else throw new Error("Must provide datasetName or datasetId");const s=await this.caller.call(fetch,this.apiUrl+r,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});if(!s.ok)throw new Error(`Failed to delete ${r}: ${s.status} ${s.statusText}`);await s.json()}async createExample(e,t,{datasetId:r,datasetName:a,createdAt:s}){let i=r;if(i===void 0&&a===void 0)throw new Error("Must provide either datasetName or datasetId");if(i!==void 0&&a!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");i===void 0&&(i=(await this.readDataset({datasetName:a})).id);const u={dataset_id:i,inputs:e,outputs:t,created_at:(s||new Date).toISOString()},c=await this.caller.call(fetch,`${this.apiUrl}/examples`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(u),signal:AbortSignal.timeout(this.timeout_ms)});if(!c.ok)throw new Error(`Failed to create example: ${c.status} ${c.statusText}`);return await c.json()}async readExample(e){const t=`/examples/${e}`;return await this._get(t)}async listExamples({datasetId:e,datasetName:t,limit:r,offset:a}={}){let s;if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(e!==void 0)s=e;else if(t!==void 0)s=(await this.readDataset({datasetName:t})).id;else throw new Error("Must provide a datasetName or datasetId");const i=await this._get("/examples",new URLSearchParams({dataset:s,limit:(r==null?void 0:r.toString())??"100",offset:(a==null?void 0:a.toString())??"0"}));if(!Array.isArray(i))throw new Error(`Expected /examples to return an array, but got ${i}`);return i}async deleteExample(e){const t=`/examples/${e}`,r=await this.caller.call(fetch,this.apiUrl+t,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});if(!r.ok)throw new Error(`Failed to delete ${t}: ${r.status} ${r.statusText}`);await r.json()}async updateExample(e,t){const r=await this.caller.call(fetch,`${this.apiUrl}/examples/${e}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(t),signal:AbortSignal.timeout(this.timeout_ms)});if(!r.ok)throw new Error(`Failed to update example ${e}: ${r.status} ${r.statusText}`);return await r.json()}async evaluateRun(e,t,{sourceInfo:r,loadChildRuns:a}={loadChildRuns:!1}){let s;if(typeof e=="string")s=await this.readRun(e,{loadChildRuns:a});else if(typeof e=="object"&&"id"in e)s=e;else throw new Error(`Invalid run type: ${typeof e}`);let i;s.reference_example_id!==null&&s.reference_example_id!==void 0&&(i=await this.readExample(s.reference_example_id));const o=await t.evaluateRun(s,i);let u=r??{};return o.evaluatorInfo&&(u={...u,...o.evaluatorInfo}),await this.createFeedback(s.id,o.key,{score:o.score,value:o.value,comment:o.comment,correction:o.correction,sourceInfo:u,feedbackSourceType:"MODEL"})}async createFeedback(e,t,{score:r,value:a,correction:s,comment:i,sourceInfo:o,feedbackSourceType:u="API"}){let c;if(u==="API")c={type:"api",metadata:o??{}};else if(u==="MODEL")c={type:"model",metadata:o??{}};else throw new Error(`Unknown feedback source type ${u}`);const m={id:We(),run_id:e,key:t,score:r,value:a,correction:s,comment:i,feedback_source:c},k=await this.caller.call(fetch,`${this.apiUrl}/feedback`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(m),signal:AbortSignal.timeout(this.timeout_ms)});if(!k.ok)throw new Error(`Failed to create feedback for run ${e}: ${k.status} ${k.statusText}`);return await k.json()}async readFeedback(e){const t=`/feedback/${e}`;return await this._get(t)}async deleteFeedback(e){const t=`/feedback/${e}`,r=await this.caller.call(fetch,this.apiUrl+t,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});if(!r.ok)throw new Error(`Failed to delete ${t}: ${r.status} ${r.statusText}`);await r.json()}async listFeedback({runIds:e,limit:t,offset:r}={}){const a=new URLSearchParams;return e&&a.append("run",e.join(",")),t!==void 0&&a.append("limit",t.toString()),r!==void 0&&a.append("offset",r.toString()),await this._get("/feedback",a)}}class Pi extends cn{constructor(e={}){super(e),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"langchain_tracer"}),Object.defineProperty(this,"projectName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exampleId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const{exampleId:t,projectName:r,client:a}=e;this.projectName=r??Ke("LANGCHAIN_PROJECT")??Ke("LANGCHAIN_SESSION"),this.exampleId=t,this.client=a??new dn({})}async _convertToCreate(e,t=void 0){return{...e,extra:{...e.extra,runtime:await ri()},child_runs:void 0,session_name:this.projectName,reference_example_id:e.parent_run_id?void 0:t}}async persistRun(e){}async _persistRunSingle(e){const t=await this._convertToCreate(e,this.exampleId);await this.client.createRun(t)}async _updateRunSingle(e){const t={end_time:e.end_time,error:e.error,outputs:e.outputs,events:e.events};await this.client.updateRun(e.id,t)}async onLLMStart(e){await this._persistRunSingle(e)}async onLLMEnd(e){await this._updateRunSingle(e)}async onLLMError(e){await this._updateRunSingle(e)}async onChainStart(e){await this._persistRunSingle(e)}async onChainEnd(e){await this._updateRunSingle(e)}async onChainError(e){await this._updateRunSingle(e)}async onToolStart(e){await this._persistRunSingle(e)}async onToolEnd(e){await this._updateRunSingle(e)}async onToolError(e){await this._updateRunSingle(e)}}function hn(n,e="Human",t="AI"){const r=[];for(const a of n){let s;if(a._getType()==="human")s=e;else if(a._getType()==="ai")s=t;else if(a._getType()==="system")s="System";else if(a._getType()==="function")s="Function";else if(a._getType()==="generic")s=a.role;else throw new Error(`Got unsupported message type: ${a}`);const i=a.name?`${a.name}, `:"";r.push(`${s}: ${i}${a.content}`)}return r.join(`
`)}class Oi extends cn{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"langchain_tracer"}),Object.defineProperty(this,"endpoint",{enumerable:!0,configurable:!0,writable:!0,value:Ke("LANGCHAIN_ENDPOINT")||"http://localhost:1984"}),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:{"Content-Type":"application/json"}}),Object.defineProperty(this,"session",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const e=Ke("LANGCHAIN_API_KEY");e&&(this.headers["x-api-key"]=e)}async newSession(e){const t={start_time:Date.now(),name:e},r=await this.persistSession(t);return this.session=r,r}async loadSession(e){const t=`${this.endpoint}/sessions?name=${e}`;return this._handleSessionResponse(t)}async loadDefaultSession(){const e=`${this.endpoint}/sessions?name=default`;return this._handleSessionResponse(e)}async convertV2RunToRun(e){var s;const t=this.session??await this.loadDefaultSession(),r=e.serialized;let a;if(e.run_type==="llm"){const i=e.inputs.prompts?e.inputs.prompts:e.inputs.messages.map(u=>hn(u));a={uuid:e.id,start_time:e.start_time,end_time:e.end_time,execution_order:e.execution_order,child_execution_order:e.child_execution_order,serialized:r,type:e.run_type,session_id:t.id,prompts:i,response:e.outputs}}else if(e.run_type==="chain"){const i=await Promise.all(e.child_runs.map(u=>this.convertV2RunToRun(u)));a={uuid:e.id,start_time:e.start_time,end_time:e.end_time,execution_order:e.execution_order,child_execution_order:e.child_execution_order,serialized:r,type:e.run_type,session_id:t.id,inputs:e.inputs,outputs:e.outputs,child_llm_runs:i.filter(u=>u.type==="llm"),child_chain_runs:i.filter(u=>u.type==="chain"),child_tool_runs:i.filter(u=>u.type==="tool")}}else if(e.run_type==="tool"){const i=await Promise.all(e.child_runs.map(u=>this.convertV2RunToRun(u)));a={uuid:e.id,start_time:e.start_time,end_time:e.end_time,execution_order:e.execution_order,child_execution_order:e.child_execution_order,serialized:r,type:e.run_type,session_id:t.id,tool_input:e.inputs.input,output:(s=e.outputs)==null?void 0:s.output,action:JSON.stringify(r),child_llm_runs:i.filter(u=>u.type==="llm"),child_chain_runs:i.filter(u=>u.type==="chain"),child_tool_runs:i.filter(u=>u.type==="tool")}}else throw new Error(`Unknown run type: ${e.run_type}`);return a}async persistRun(e){let t,r;e.run_type!==void 0?r=await this.convertV2RunToRun(e):r=e,r.type==="llm"?t=`${this.endpoint}/llm-runs`:r.type==="chain"?t=`${this.endpoint}/chain-runs`:t=`${this.endpoint}/tool-runs`;const a=await fetch(t,{method:"POST",headers:this.headers,body:JSON.stringify(r)});a.ok||console.error(`Failed to persist run: ${a.status} ${a.statusText}`)}async persistSession(e){const t=`${this.endpoint}/sessions`,r=await fetch(t,{method:"POST",headers:this.headers,body:JSON.stringify(e)});return r.ok?{id:(await r.json()).id,...e}:(console.error(`Failed to persist session: ${r.status} ${r.statusText}, using default session.`),{id:1,...e})}async _handleSessionResponse(e){const t=await fetch(e,{method:"GET",headers:this.headers});let r;if(!t.ok)return console.error(`Failed to load session: ${t.status} ${t.statusText}`),r={id:1,start_time:Date.now()},this.session=r,r;const a=await t.json();return a.length===0?(r={id:1,start_time:Date.now()},this.session=r,r):([r]=a,this.session=r,r)}}async function Ti(n){const e=new Oi;return n?await e.loadSession(n):await e.loadDefaultSession(),e}async function Si(){return new Pi}let Hr;function ji(){const n="default"in vt?vt.default:vt;return new n({autoStart:!0,concurrency:1})}async function Ie(n,e){e===!0?await n():(typeof Hr>"u"&&(Hr=ji()),Hr.add(n))}function Ai(n){return n?Array.isArray(n)||"name"in n?{callbacks:n}:n:{}}class Ii{setHandler(e){return this.setHandlers([e])}}class fn{constructor(e,t,r,a,s,i,o,u){Object.defineProperty(this,"runId",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:u})}async handleText(e){await Promise.all(this.handlers.map(t=>Ie(async()=>{var r;try{await((r=t.handleText)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(a){console.error(`Error in handler ${t.constructor.name}, handleText: ${a}`)}},t.awaitHandlers)))}}class Vn extends fn{async handleLLMNewToken(e,t={prompt:0,completion:0}){await Promise.all(this.handlers.map(r=>Ie(async()=>{var a;if(!r.ignoreLLM)try{await((a=r.handleLLMNewToken)==null?void 0:a.call(r,e,t,this.runId,this._parentRunId,this.tags))}catch(s){console.error(`Error in handler ${r.constructor.name}, handleLLMNewToken: ${s}`)}},r.awaitHandlers)))}async handleLLMError(e){await Promise.all(this.handlers.map(t=>Ie(async()=>{var r;if(!t.ignoreLLM)try{await((r=t.handleLLMError)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(a){console.error(`Error in handler ${t.constructor.name}, handleLLMError: ${a}`)}},t.awaitHandlers)))}async handleLLMEnd(e){await Promise.all(this.handlers.map(t=>Ie(async()=>{var r;if(!t.ignoreLLM)try{await((r=t.handleLLMEnd)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(a){console.error(`Error in handler ${t.constructor.name}, handleLLMEnd: ${a}`)}},t.awaitHandlers)))}}class Ci extends fn{getChild(e){const t=new at(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleChainError(e){await Promise.all(this.handlers.map(t=>Ie(async()=>{var r;if(!t.ignoreChain)try{await((r=t.handleChainError)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(a){console.error(`Error in handler ${t.constructor.name}, handleChainError: ${a}`)}},t.awaitHandlers)))}async handleChainEnd(e){await Promise.all(this.handlers.map(t=>Ie(async()=>{var r;if(!t.ignoreChain)try{await((r=t.handleChainEnd)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(a){console.error(`Error in handler ${t.constructor.name}, handleChainEnd: ${a}`)}},t.awaitHandlers)))}async handleAgentAction(e){await Promise.all(this.handlers.map(t=>Ie(async()=>{var r;if(!t.ignoreAgent)try{await((r=t.handleAgentAction)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(a){console.error(`Error in handler ${t.constructor.name}, handleAgentAction: ${a}`)}},t.awaitHandlers)))}async handleAgentEnd(e){await Promise.all(this.handlers.map(t=>Ie(async()=>{var r;if(!t.ignoreAgent)try{await((r=t.handleAgentEnd)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(a){console.error(`Error in handler ${t.constructor.name}, handleAgentEnd: ${a}`)}},t.awaitHandlers)))}}class Di extends fn{getChild(e){const t=new at(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleToolError(e){await Promise.all(this.handlers.map(t=>Ie(async()=>{var r;if(!t.ignoreAgent)try{await((r=t.handleToolError)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(a){console.error(`Error in handler ${t.constructor.name}, handleToolError: ${a}`)}},t.awaitHandlers)))}async handleToolEnd(e){await Promise.all(this.handlers.map(t=>Ie(async()=>{var r;if(!t.ignoreAgent)try{await((r=t.handleToolEnd)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(a){console.error(`Error in handler ${t.constructor.name}, handleToolEnd: ${a}`)}},t.awaitHandlers)))}}class at extends Ii{constructor(e){super(),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"callback_manager"}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.handlers=[],this.inheritableHandlers=[],this._parentRunId=e}async handleLLMStart(e,t,r=void 0,a=void 0,s=void 0){return Promise.all(t.map(async i=>{const o=We();return await Promise.all(this.handlers.map(u=>Ie(async()=>{var c;if(!u.ignoreLLM)try{await((c=u.handleLLMStart)==null?void 0:c.call(u,e,[i],o,this._parentRunId,s,this.tags,this.metadata))}catch(m){console.error(`Error in handler ${u.constructor.name}, handleLLMStart: ${m}`)}},u.awaitHandlers))),new Vn(o,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChatModelStart(e,t,r=void 0,a=void 0,s=void 0){return Promise.all(t.map(async i=>{const o=We();return await Promise.all(this.handlers.map(u=>Ie(async()=>{var c,m;if(!u.ignoreLLM)try{if(u.handleChatModelStart)await((c=u.handleChatModelStart)==null?void 0:c.call(u,e,[i],o,this._parentRunId,s,this.tags,this.metadata));else if(u.handleLLMStart){const k=hn(i);await((m=u.handleLLMStart)==null?void 0:m.call(u,e,[k],o,this._parentRunId,s,this.tags,this.metadata))}}catch(k){console.error(`Error in handler ${u.constructor.name}, handleLLMStart: ${k}`)}},u.awaitHandlers))),new Vn(o,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChainStart(e,t,r=We()){return await Promise.all(this.handlers.map(a=>Ie(async()=>{var s;if(!a.ignoreChain)try{await((s=a.handleChainStart)==null?void 0:s.call(a,e,t,r,this._parentRunId,this.tags,this.metadata))}catch(i){console.error(`Error in handler ${a.constructor.name}, handleChainStart: ${i}`)}},a.awaitHandlers))),new Ci(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleToolStart(e,t,r=We()){return await Promise.all(this.handlers.map(a=>Ie(async()=>{var s;if(!a.ignoreAgent)try{await((s=a.handleToolStart)==null?void 0:s.call(a,e,t,r,this._parentRunId,this.tags,this.metadata))}catch(i){console.error(`Error in handler ${a.constructor.name}, handleToolStart: ${i}`)}},a.awaitHandlers))),new Di(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}addHandler(e,t=!0){this.handlers.push(e),t&&this.inheritableHandlers.push(e)}removeHandler(e){this.handlers=this.handlers.filter(t=>t!==e),this.inheritableHandlers=this.inheritableHandlers.filter(t=>t!==e)}setHandlers(e,t=!0){this.handlers=[],this.inheritableHandlers=[];for(const r of e)this.addHandler(r,t)}addTags(e,t=!0){this.removeTags(e),this.tags.push(...e),t&&this.inheritableTags.push(...e)}removeTags(e){this.tags=this.tags.filter(t=>!e.includes(t)),this.inheritableTags=this.inheritableTags.filter(t=>!e.includes(t))}addMetadata(e,t=!0){this.metadata={...this.metadata,...e},t&&(this.inheritableMetadata={...this.inheritableMetadata,...e})}removeMetadata(e){for(const t of Object.keys(e))delete this.metadata[t],delete this.inheritableMetadata[t]}copy(e=[],t=!0){const r=new at(this._parentRunId);for(const a of this.handlers){const s=this.inheritableHandlers.includes(a);r.addHandler(a,s)}for(const a of this.tags){const s=this.inheritableTags.includes(a);r.addTags([a],s)}for(const a of Object.keys(this.metadata)){const s=Object.keys(this.inheritableMetadata).includes(a);r.addMetadata({[a]:this.metadata[a]},s)}for(const a of e)r.handlers.filter(s=>s.name==="console_callback_handler").some(s=>s.name===a.name)||r.addHandler(a,t);return r}static fromHandlers(e){class t extends lr{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:We()}),Object.assign(this,e)}}const r=new this;return r.addHandler(new t),r}static async configure(e,t,r,a,s,i,o){let u;(e||t)&&(Array.isArray(e)||!e?(u=new at,u.setHandlers((e==null?void 0:e.map($n))??[],!0)):u=e,u=u.copy(Array.isArray(t)?t.map($n):t==null?void 0:t.handlers,!1));const c=Ke("LANGCHAIN_VERBOSE")||(o==null?void 0:o.verbose),m=Ke("LANGCHAIN_TRACING_V2")??!1,k=m||(Ke("LANGCHAIN_TRACING")??!1);if(c||k){if(u||(u=new at),c&&!u.handlers.some(M=>M.name===Bn.prototype.name)){const M=new Bn;u.addHandler(M,!0)}if(k&&!u.handlers.some(M=>M.name==="langchain_tracer"))if(m)u.addHandler(await Si(),!0);else{const M=Ke("LANGCHAIN_PROJECT")&&Ke("LANGCHAIN_SESSION");u.addHandler(await Ti(M),!0)}}return(r||a)&&u&&(u.addTags(r??[]),u.addTags(a??[],!1)),(s||i)&&u&&(u.addMetadata(s??{}),u.addMetadata(i??{},!1)),u}}function $n(n){return"name"in n?n:lr.fromMethods(n)}const yr={},Mi=new Oa({});async function Ni(n,e){return n in yr||(yr[n]=Mi.fetch(`https://tiktoken.pages.dev/js/${n}.json`,{signal:e==null?void 0:e.signal}).then(t=>t.json()).catch(t=>{throw delete yr[n],t})),new ui(await yr[n],e==null?void 0:e.extendedSpecialTokens)}async function La(n,e){return Ni(oi(n),e)}const Ra=n=>n.startsWith("gpt-3.5-turbo-16k")?"gpt-3.5-turbo-16k":n.startsWith("gpt-3.5-turbo-")?"gpt-3.5-turbo":n.startsWith("gpt-4-32k")?"gpt-4-32k":n.startsWith("gpt-4-")?"gpt-4":n,Li=n=>{switch(Ra(n)){case"gpt-3.5-turbo-16k":return 16384;case"gpt-3.5-turbo":return 4096;case"gpt-4-32k":return 32768;case"gpt-4":return 8192;case"text-davinci-003":return 4097;case"text-curie-001":return 2048;case"text-babbage-001":return 2048;case"text-ada-001":return 2048;case"code-davinci-002":return 8e3;case"code-cushman-001":return 2048;default:return 4097}},ac=async({prompt:n,modelName:e})=>{let t;try{t=(await La(e)).encode(n).length}catch{console.warn("Failed to calculate number of tokens, falling back to approximate count"),t=Math.ceil(n.length/4)}return Li(e)-t},Ri=()=>!1;class Za extends kt{get lc_attributes(){return{callbacks:void 0,verbose:void 0}}constructor(e){super(e),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.verbose=e.verbose??Ri(),this.callbacks=e.callbacks,this.tags=e.tags??[],this.metadata=e.metadata??{}}}class Ba extends Za{get callKeys(){return["stop","timeout","signal","tags","metadata","callbacks"]}constructor({callbacks:e,callbackManager:t,...r}){super({callbacks:e??t,...r}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_encoding",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.caller=new Oa(r??{})}async getNumTokens(e){let t=Math.ceil(e.length/4);if(!this._encoding)try{this._encoding=await La("modelName"in this?Ra(this.modelName):"gpt2")}catch(r){console.warn("Failed to calculate number of tokens, falling back to approximate count",r)}return this._encoding&&(t=this._encoding.encode(e).length),t}_identifyingParams(){return{}}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}static async deserialize(e){const{_type:t,_model:r,...a}=e;if(r&&r!=="base_chat_model")throw new Error(`Cannot load LLM with model ${r}`);const s={openai:(await Ae(()=>import("./openai.01b5f902.js"),["./openai.01b5f902.js","./NavBar.28f036ee.js","./public.9062b0fe.js","./scheduler.2364b0ad.js","./index.9f7452a2.js","./globals.7f7f1b26.js","../assets/NavBar.ffbd0f32.css","./prompt-layer.00daf386.js"],import.meta.url)).ChatOpenAI}[t];if(s===void 0)throw new Error(`Cannot load  LLM with type ${t}`);return new s(a)}}class cr extends Za{get lc_namespace(){return["langchain","chains",this._chainType()]}constructor(e,t,r){if(arguments.length===1&&typeof e=="object"&&!("saveContext"in e)){const{memory:a,callbackManager:s,...i}=e;super({...i,callbacks:s??i.callbacks}),this.memory=a}else super({verbose:t,callbacks:r}),this.memory=e}_selectMemoryInputs(e){const t={...e};return"signal"in t&&delete t.signal,"timeout"in t&&delete t.timeout,t}serialize(){throw new Error("Method not implemented.")}async run(e,t){const r=this.inputKeys.filter(u=>{var c;return!((c=this.memory)!=null&&c.memoryKeys.includes(u))});if(!(r.length<=1))throw new Error(`Chain ${this._chainType()} expects multiple inputs, cannot use 'run' `);const s=r.length?{[r[0]]:e}:{},i=await this.call(s,t),o=Object.keys(i);if(o.length===1)return i[o[0]];throw new Error("return values have multiple keys, `run` only supported when one key currently")}async call(e,t,r){const a={...e};if(a.timeout&&!a.signal&&(a.signal=AbortSignal.timeout(a.timeout),delete a.timeout),this.memory!=null){const c=await this.memory.loadMemoryVariables(this._selectMemoryInputs(e));for(const[m,k]of Object.entries(c))a[m]=k}const s=Ai(t),i=await at.configure(s.callbacks,this.callbacks,s.tags||r,this.tags,s.metadata,this.metadata,{verbose:this.verbose}),o=await(i==null?void 0:i.handleChainStart(this.toJSON(),a));let u;try{u=await(e.signal?Promise.race([this._call(a,o),new Promise((c,m)=>{var k;(k=e.signal)==null||k.addEventListener("abort",()=>{m(new Error("AbortError"))})})]):this._call(a,o))}catch(c){throw await(o==null?void 0:o.handleChainError(c)),c}return this.memory!=null&&await this.memory.saveContext(this._selectMemoryInputs(e),u),await(o==null?void 0:o.handleChainEnd(u)),Object.defineProperty(u,Ta,{value:o?{runId:o==null?void 0:o.runId}:void 0,configurable:!0}),u}async apply(e,t){return Promise.all(e.map(async(r,a)=>this.call(r,t==null?void 0:t[a])))}static async deserialize(e,t={}){switch(e._type){case"llm_chain":{const{LLMChain:r}=await Ae(()=>Promise.resolve().then(()=>Fi),void 0,import.meta.url);return r.deserialize(e)}case"sequential_chain":{const{SequentialChain:r}=await Ae(()=>import("./sequential_chain.09a969a6.js"),[],import.meta.url);return r.deserialize(e)}case"simple_sequential_chain":{const{SimpleSequentialChain:r}=await Ae(()=>import("./sequential_chain.09a969a6.js"),[],import.meta.url);return r.deserialize(e)}case"stuff_documents_chain":{const{StuffDocumentsChain:r}=await Ae(()=>Promise.resolve().then(()=>Yr),void 0,import.meta.url);return r.deserialize(e)}case"map_reduce_documents_chain":{const{MapReduceDocumentsChain:r}=await Ae(()=>Promise.resolve().then(()=>Yr),void 0,import.meta.url);return r.deserialize(e)}case"refine_documents_chain":{const{RefineDocumentsChain:r}=await Ae(()=>Promise.resolve().then(()=>Yr),void 0,import.meta.url);return r.deserialize(e)}case"vector_db_qa":{const{VectorDBQAChain:r}=await Ae(()=>import("./vector_db_qa.b5185e3b.js"),[],import.meta.url);return r.deserialize(e,t)}case"api_chain":{const{APIChain:r}=await Ae(()=>import("./api_chain.0f32db6a.js"),[],import.meta.url);return r.deserialize(e)}default:throw new Error(`Invalid prompt type in config: ${e._type}`)}}}class Zi extends Sa{constructor(e){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","prompts","base"]}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.value=e}toString(){return this.value}toChatMessages(){return[new ja(this.value)]}}class pn extends kt{get lc_attributes(){return{partialVariables:void 0}}constructor(e){super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","prompts",this._getPromptType()]}),Object.defineProperty(this,"inputVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"partialVariables",{enumerable:!0,configurable:!0,writable:!0,value:{}});const{inputVariables:t}=e;if(t.includes("stop"))throw new Error("Cannot have an input variable named 'stop', as it is used internally, please rename.");Object.assign(this,e)}async mergePartialAndUserVariables(e){const t=this.partialVariables??{},r={};for(const[s,i]of Object.entries(t))typeof i=="string"?r[s]=i:r[s]=await i();return{...r,...e}}serialize(){throw new Error("Use .toJSON() instead")}static async deserialize(e){switch(e._type){case"prompt":{const{PromptTemplate:t}=await Ae(()=>Promise.resolve().then(()=>Fn),void 0,import.meta.url);return t.deserialize(e)}case void 0:{const{PromptTemplate:t}=await Ae(()=>Promise.resolve().then(()=>Fn),void 0,import.meta.url);return t.deserialize({...e,_type:"prompt"})}case"few_shot":{const{FewShotPromptTemplate:t}=await Ae(()=>import("./few_shot.bf2e2e40.js"),[],import.meta.url);return t.deserialize(e)}default:throw new Error(`Invalid prompt type in config: ${e._type}`)}}}class Bi extends pn{async formatPromptValue(e){const t=await this.format(e);return new Zi(t)}}class Ui extends kt{parseResultWithPrompt(e,t,r){return this.parseResult(e,r)}}class Vi extends Ui{parseResult(e,t){return this.parse(e[0].text,t)}async parseWithPrompt(e,t,r){return this.parse(e,r)}_type(){throw new Error("_type not implemented")}}class $i extends Vi{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","default"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}parse(e){return Promise.resolve(e)}getFormatInstructions(){return""}}class De extends cr{get inputKeys(){return this.prompt.inputVariables}get outputKeys(){return[this.outputKey]}constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"prompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"llm",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"llmKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputKey",{enumerable:!0,configurable:!0,writable:!0,value:"text"}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.prompt=e.prompt,this.llm=e.llm,this.llmKwargs=e.llmKwargs,this.outputKey=e.outputKey??this.outputKey,this.outputParser=e.outputParser??new $i,this.prompt.outputParser){if(e.outputParser)throw new Error("Cannot set both outputParser and prompt.outputParser");this.outputParser=this.prompt.outputParser}}_selectMemoryInputs(e){const t=super._selectMemoryInputs(e);for(const r of this.llm.callKeys)r in e&&delete t[r];return t}async _getFinalOutput(e,t,r){let a;return this.outputParser?a=await this.outputParser.parseResultWithPrompt(e,t,r==null?void 0:r.getChild()):a=e[0].text,a}call(e,t){return super.call(e,t)}async _call(e,t){const r={...e},a={...this.llmKwargs};for(const o of this.llm.callKeys)o in e&&(a[o]=e[o],delete r[o]);const s=await this.prompt.formatPromptValue(r),{generations:i}=await this.llm.generatePrompt([s],a,t==null?void 0:t.getChild());return{[this.outputKey]:await this._getFinalOutput(i[0],s,t)}}async predict(e,t){return(await this.call(e,t))[this.outputKey]}_chainType(){return"llm"}static async deserialize(e){const{llm:t,prompt:r}=e;if(!t)throw new Error("LLMChain must have llm");if(!r)throw new Error("LLMChain must have prompt");return new De({llm:await Ba.deserialize(t),prompt:await pn.deserialize(r)})}serialize(){return{_type:`${this._chainType()}_chain`,llm:this.llm.serialize(),prompt:this.prompt.serialize()}}}const Fi=Object.freeze(Object.defineProperty({__proto__:null,LLMChain:De},Symbol.toStringTag,{value:"Module"})),Ua=n=>{const e=n.split(""),t=[],r=(s,i)=>{for(let o=i;o<e.length;o+=1)if(s.includes(e[o]))return o;return-1};let a=0;for(;a<e.length;)if(e[a]==="{"&&a+1<e.length&&e[a+1]==="{")t.push({type:"literal",text:"{"}),a+=2;else if(e[a]==="}"&&a+1<e.length&&e[a+1]==="}")t.push({type:"literal",text:"}"}),a+=2;else if(e[a]==="{"){const s=r("}",a);if(s<0)throw new Error("Unclosed '{' in template.");t.push({type:"variable",name:e.slice(a+1,s).join("")}),a=s+1}else{if(e[a]==="}")throw new Error("Single '}' in template.");{const s=r("{}",a),i=(s<0?e.slice(a):e.slice(a,s)).join("");t.push({type:"literal",text:i}),a=s<0?e.length:s}}return t},Ki=(n,e)=>Ua(n).reduce((t,r)=>{if(r.type==="variable"){if(r.name in e)return t+e[r.name];throw new Error(`Missing value for input ${r.name}`)}return t+r.text},""),Xr={"f-string":Ki,jinja2:(n,e)=>""},qi={"f-string":Ua,jinja2:n=>[]},Va=(n,e,t)=>Xr[e](n,t),zi=(n,e)=>qi[e](n),Hi=(n,e,t)=>{if(!(e in Xr)){const r=Object.keys(Xr);throw new Error(`Invalid template format. Got \`${e}\`;
                         should be one of ${r}`)}try{const r=t.reduce((a,s)=>(a[s]="foo",a),{});Va(n,e,r)}catch(r){throw new Error(`Invalid prompt schema: ${r.message}`)}};class ke extends Bi{constructor(e){if(super(e),Object.defineProperty(this,"template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.assign(this,e),this.validateTemplate){let t=this.inputVariables;this.partialVariables&&(t=t.concat(Object.keys(this.partialVariables))),Hi(this.template,this.templateFormat,t)}}_getPromptType(){return"prompt"}async format(e){const t=await this.mergePartialAndUserVariables(e);return Va(this.template,this.templateFormat,t)}static fromExamples(e,t,r,a=`

`,s=""){const i=[s,...e,t].join(a);return new ke({inputVariables:r,template:i})}static fromTemplate(e,{templateFormat:t="f-string",...r}={}){const a=new Set;return zi(e,t).forEach(s=>{s.type==="variable"&&a.add(s.name)}),new ke({inputVariables:[...a],templateFormat:t,template:e,...r})}async partial(e){const t={...this};return t.inputVariables=this.inputVariables.filter(r=>!(r in e)),t.partialVariables={...this.partialVariables??{},...e},new ke(t)}serialize(){if(this.outputParser!==void 0)throw new Error("Cannot serialize a prompt template with an output parser");return{_type:this._getPromptType(),input_variables:this.inputVariables,template:this.template,template_format:this.templateFormat}}static async deserialize(e){if(!e.template)throw new Error("Prompt template must have a template");return new ke({inputVariables:e.input_variables,template:e.template,templateFormat:e.template_format})}}const Fn=Object.freeze(Object.defineProperty({__proto__:null,PromptTemplate:ke},Symbol.toStringTag,{value:"Module"}));class Lt extends cr{get inputKeys(){return[this.inputKey,...this.llmChain.inputKeys].filter(e=>e!==this.documentVariableName)}get outputKeys(){return this.llmChain.outputKeys}constructor(e){super(e),Object.defineProperty(this,"llmChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"input_documents"}),Object.defineProperty(this,"documentVariableName",{enumerable:!0,configurable:!0,writable:!0,value:"context"}),this.llmChain=e.llmChain,this.documentVariableName=e.documentVariableName??this.documentVariableName,this.inputKey=e.inputKey??this.inputKey}_prepInputs(e){if(!(this.inputKey in e))throw new Error(`Document key ${this.inputKey} not found.`);const{[this.inputKey]:t,...r}=e,s=t.map(({pageContent:i})=>i).join(`

`);return{...r,[this.documentVariableName]:s}}async _call(e,t){return await this.llmChain.call(this._prepInputs(e),t==null?void 0:t.getChild("combine_documents"))}_chainType(){return"stuff_documents_chain"}static async deserialize(e){if(!e.llm_chain)throw new Error("Missing llm_chain");return new Lt({llmChain:await De.deserialize(e.llm_chain)})}serialize(){return{_type:this._chainType(),llm_chain:this.llmChain.serialize()}}}class Sr extends cr{get inputKeys(){return[this.inputKey,...this.combineDocumentChain.inputKeys]}get outputKeys(){return this.combineDocumentChain.outputKeys}constructor(e){super(e),Object.defineProperty(this,"llmChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"input_documents"}),Object.defineProperty(this,"documentVariableName",{enumerable:!0,configurable:!0,writable:!0,value:"context"}),Object.defineProperty(this,"returnIntermediateSteps",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:3e3}),Object.defineProperty(this,"maxIterations",{enumerable:!0,configurable:!0,writable:!0,value:10}),Object.defineProperty(this,"ensureMapStep",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"combineDocumentChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.llmChain=e.llmChain,this.combineDocumentChain=e.combineDocumentChain,this.documentVariableName=e.documentVariableName??this.documentVariableName,this.ensureMapStep=e.ensureMapStep??this.ensureMapStep,this.inputKey=e.inputKey??this.inputKey,this.maxTokens=e.maxTokens??this.maxTokens,this.maxIterations=e.maxIterations??this.maxIterations,this.returnIntermediateSteps=e.returnIntermediateSteps??!1}async _call(e,t){if(!(this.inputKey in e))throw new Error(`Document key ${this.inputKey} not found.`);const{[this.inputKey]:r,...a}=e;let s=r,i=[];for(let c=0;c<this.maxIterations;c+=1){const m=s.map(x=>({[this.documentVariableName]:x.pageContent,...a}));if(c!==0||!this.ensureMapStep){const x=await this.combineDocumentChain.llmChain.prompt.format(this.combineDocumentChain._prepInputs({[this.combineDocumentChain.inputKey]:s,...a}));if(await this.combineDocumentChain.llmChain.llm.getNumTokens(x)<this.maxTokens)break}const M=await this.llmChain.apply(m,t?Array.from({length:m.length},(x,N)=>t.getChild(`map_${N+1}`)):void 0),{outputKey:q}=this.llmChain;this.returnIntermediateSteps&&(i=i.concat(M.map(x=>x[q]))),s=M.map(x=>({pageContent:x[q],metadata:{}}))}const o={[this.combineDocumentChain.inputKey]:s,...a},u=await this.combineDocumentChain.call(o,t==null?void 0:t.getChild("combine_documents"));return this.returnIntermediateSteps?{...u,intermediateSteps:i}:u}_chainType(){return"map_reduce_documents_chain"}static async deserialize(e){if(!e.llm_chain)throw new Error("Missing llm_chain");if(!e.combine_document_chain)throw new Error("Missing combine_document_chain");return new Sr({llmChain:await De.deserialize(e.llm_chain),combineDocumentChain:await Lt.deserialize(e.combine_document_chain)})}serialize(){return{_type:this._chainType(),llm_chain:this.llmChain.serialize(),combine_document_chain:this.combineDocumentChain.serialize()}}}class jr extends cr{get defaultDocumentPrompt(){return new ke({inputVariables:["page_content"],template:"{page_content}"})}get inputKeys(){return[...new Set([this.inputKey,...this.llmChain.inputKeys,...this.refineLLMChain.inputKeys])].filter(e=>e!==this.documentVariableName&&e!==this.initialResponseName)}get outputKeys(){return[this.outputKey]}constructor(e){super(e),Object.defineProperty(this,"llmChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"input_documents"}),Object.defineProperty(this,"outputKey",{enumerable:!0,configurable:!0,writable:!0,value:"output_text"}),Object.defineProperty(this,"documentVariableName",{enumerable:!0,configurable:!0,writable:!0,value:"context"}),Object.defineProperty(this,"initialResponseName",{enumerable:!0,configurable:!0,writable:!0,value:"existing_answer"}),Object.defineProperty(this,"refineLLMChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"documentPrompt",{enumerable:!0,configurable:!0,writable:!0,value:this.defaultDocumentPrompt}),this.llmChain=e.llmChain,this.refineLLMChain=e.refineLLMChain,this.documentVariableName=e.documentVariableName??this.documentVariableName,this.inputKey=e.inputKey??this.inputKey,this.outputKey=e.outputKey??this.outputKey,this.documentPrompt=e.documentPrompt??this.documentPrompt,this.initialResponseName=e.initialResponseName??this.initialResponseName}async _constructInitialInputs(e,t){const r={page_content:e.pageContent,...e.metadata},a={};return this.documentPrompt.inputVariables.forEach(o=>{a[o]=r[o]}),{...{[this.documentVariableName]:await this.documentPrompt.format({...a})},...t}}async _constructRefineInputs(e,t){const r={page_content:e.pageContent,...e.metadata},a={};this.documentPrompt.inputVariables.forEach(o=>{a[o]=r[o]});const s={[this.documentVariableName]:await this.documentPrompt.format({...a})};return{[this.initialResponseName]:t,...s}}async _call(e,t){if(!(this.inputKey in e))throw new Error(`Document key ${this.inputKey} not found.`);const{[this.inputKey]:r,...a}=e,s=r,i=await this._constructInitialInputs(s[0],a);let o=await this.llmChain.predict({...i},t==null?void 0:t.getChild("answer"));for(let u=1;u<s.length;u+=1){const m={...await this._constructRefineInputs(s[u],o),...a};o=await this.refineLLMChain.predict({...m},t==null?void 0:t.getChild("refine"))}return{[this.outputKey]:o}}_chainType(){return"refine_documents_chain"}static async deserialize(e){const t=e.llm_chain;if(!t)throw new Error("Missing llm_chain");const r=e.refine_llm_chain;if(!r)throw new Error("Missing refine_llm_chain");return new jr({llmChain:await De.deserialize(t),refineLLMChain:await De.deserialize(r)})}serialize(){return{_type:this._chainType(),llm_chain:this.llmChain.serialize(),refine_llm_chain:this.refineLLMChain.serialize()}}}const Yr=Object.freeze(Object.defineProperty({__proto__:null,MapReduceDocumentsChain:Sr,RefineDocumentsChain:jr,StuffDocumentsChain:Lt},Symbol.toStringTag,{value:"Module"}));class Yi extends kt{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","prompts","chat"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}}class Gi extends Sa{constructor(e){Array.isArray(e)&&(e={messages:e}),super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","prompts","chat"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"messages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.messages=e.messages}toString(){return JSON.stringify(this.messages)}toChatMessages(){return this.messages}}class mn extends Yi{constructor(e){"prompt"in e||(e={prompt:e}),super(e),Object.defineProperty(this,"prompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.prompt=e.prompt}get inputVariables(){return this.prompt.inputVariables}async formatMessages(e){return[await this.format(e)]}}class Wi extends pn{constructor(e){super(e)}async format(e){return(await this.formatPromptValue(e)).toString()}async formatPromptValue(e){const t=await this.formatMessages(e);return new Gi(t)}}class Et extends mn{async format(e){return new ja(await this.prompt.format(e))}static fromTemplate(e){return new this(ke.fromTemplate(e))}}class Ji extends mn{async format(e){return new Aa(await this.prompt.format(e))}static fromTemplate(e){return new this(ke.fromTemplate(e))}}class Ar extends mn{async format(e){return new ni(await this.prompt.format(e))}static fromTemplate(e){return new this(ke.fromTemplate(e))}}class qe extends Wi{get lc_aliases(){return{promptMessages:"messages"}}constructor(e){if(super(e),Object.defineProperty(this,"promptMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.assign(this,e),this.validateTemplate){const t=new Set;for(const i of this.promptMessages)for(const o of i.inputVariables)t.add(o);const r=new Set(this.partialVariables?this.inputVariables.concat(Object.keys(this.partialVariables)):this.inputVariables),a=new Set([...r].filter(i=>!t.has(i)));if(a.size>0)throw new Error(`Input variables \`${[...a]}\` are not used in any of the prompt messages.`);const s=new Set([...t].filter(i=>!r.has(i)));if(s.size>0)throw new Error(`Input variables \`${[...s]}\` are used in prompt messages but not in the prompt template.`)}}_getPromptType(){return"chat"}async formatMessages(e){const t=await this.mergePartialAndUserVariables(e);let r=[];for(const a of this.promptMessages){const s=a.inputVariables.reduce((o,u)=>{if(!(u in t))throw new Error(`Missing value for input variable \`${u}\``);return o[u]=t[u],o},{}),i=await a.formatMessages(s);r=r.concat(i)}return r}async partial(e){const t={...this};return t.inputVariables=this.inputVariables.filter(r=>!(r in e)),t.partialVariables={...this.partialVariables??{},...e},new qe(t)}static fromPromptMessages(e){const t=e.reduce((s,i)=>s.concat(i instanceof qe?i.promptMessages:[i]),[]),r=e.reduce((s,i)=>i instanceof qe?Object.assign(s,i.partialVariables):s,Object.create(null)),a=new Set;for(const s of t)for(const i of s.inputVariables)i in r||a.add(i);return new qe({inputVariables:[...a],promptMessages:t,partialVariables:r})}}class Qi{async getPromptAsync(e,t){return this.getPrompt(e).partial((t==null?void 0:t.partialVariables)??{})}}class dr extends Qi{constructor(e,t=[]){super(),Object.defineProperty(this,"defaultPrompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"conditionals",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.defaultPrompt=e,this.conditionals=t}getPrompt(e){for(const[t,r]of this.conditionals)if(t(e))return r;return this.defaultPrompt}}function hr(n){return n._modelType()==="base_chat_model"}const Xi=new ke({template:`Use the following pieces of context to answer the question at the end. If you don't know the answer, just say that you don't know, don't try to make up an answer.

{context}

Question: {question}
Helpful Answer:`,inputVariables:["context","question"]}),eo=`Use the following pieces of context to answer the users question. 
If you don't know the answer, just say that you don't know, don't try to make up an answer.
----------------
{context}`,to=[Ar.fromTemplate(eo),Et.fromTemplate("{question}")],ro=qe.fromPromptMessages(to),no=new dr(Xi,[[hr,ro]]),ao=`Use the following portion of a long document to see if any of the text is relevant to answer the question. 
Return any relevant text verbatim.
{context}
Question: {question}
Relevant text, if any:`,so=ke.fromTemplate(ao),io=`Use the following portion of a long document to see if any of the text is relevant to answer the question. 
Return any relevant text verbatim.
----------------
{context}`,oo=[Ar.fromTemplate(io),Et.fromTemplate("{question}")],uo=qe.fromPromptMessages(oo),lo=new dr(so,[[hr,uo]]),co=`Given the following extracted parts of a long document and a question, create a final answer. 
If you don't know the answer, just say that you don't know. Don't try to make up an answer.

QUESTION: Which state/country's law governs the interpretation of the contract?
=========
Content: This Agreement is governed by English law and the parties submit to the exclusive jurisdiction of the English courts in  relation to any dispute (contractual or non-contractual) concerning this Agreement save that either party may apply to any court for an  injunction or other relief to protect its Intellectual Property Rights.

Content: No Waiver. Failure or delay in exercising any right or remedy under this Agreement shall not constitute a waiver of such (or any other)  right or remedy.

11.7 Severability. The invalidity, illegality or unenforceability of any term (or part of a term) of this Agreement shall not affect the continuation  in force of the remainder of the term (if any) and this Agreement.

11.8 No Agency. Except as expressly stated otherwise, nothing in this Agreement shall create an agency, partnership or joint venture of any  kind between the parties.

11.9 No Third-Party Beneficiaries.

Content: (b) if Google believes, in good faith, that the Distributor has violated or caused Google to violate any Anti-Bribery Laws (as  defined in Clause 8.5) or that such a violation is reasonably likely to occur,
=========
FINAL ANSWER: This Agreement is governed by English law.

QUESTION: What did the president say about Michael Jackson?
=========
Content: Madam Speaker, Madam Vice President, our First Lady and Second Gentleman. Members of Congress and the Cabinet. Justices of the Supreme Court. My fellow Americans.  

Last year COVID-19 kept us apart. This year we are finally together again. 

Tonight, we meet as Democrats Republicans and Independents. But most importantly as Americans. 

With a duty to one another to the American people to the Constitution. 

And with an unwavering resolve that freedom will always triumph over tyranny. 

Six days ago, Russias Vladimir Putin sought to shake the foundations of the free world thinking he could make it bend to his menacing ways. But he badly miscalculated. 

He thought he could roll into Ukraine and the world would roll over. Instead he met a wall of strength he never imagined. 

He met the Ukrainian people. 

From President Zelenskyy to every Ukrainian, their fearlessness, their courage, their determination, inspires the world. 

Groups of citizens blocking tanks with their bodies. Everyone from students to retirees teachers turned soldiers defending their homeland.

Content: And we wont stop. 

We have lost so much to COVID-19. Time with one another. And worst of all, so much loss of life. 

Lets use this moment to reset. Lets stop looking at COVID-19 as a partisan dividing line and see it for what it is: A God-awful disease.  

Lets stop seeing each other as enemies, and start seeing each other for who we really are: Fellow Americans.  

We cant change how divided weve been. But we can change how we move forwardon COVID-19 and other issues we must face together. 

I recently visited the New York City Police Department days after the funerals of Officer Wilbert Mora and his partner, Officer Jason Rivera. 

They were responding to a 9-1-1 call when a man shot and killed them with a stolen gun. 

Officer Mora was 27 years old. 

Officer Rivera was 22. 

Both Dominican Americans whod grown up on the same streets they later chose to patrol as police officers. 

I spoke with their families and told them that we are forever in debt for their sacrifice, and we will carry on their mission to restore the trust and safety every community deserves.

Content: And a proud Ukrainian people, who have known 30 years  of independence, have repeatedly shown that they will not tolerate anyone who tries to take their country backwards.  

To all Americans, I will be honest with you, as Ive always promised. A Russian dictator, invading a foreign country, has costs around the world. 

And Im taking robust action to make sure the pain of our sanctions  is targeted at Russias economy. And I will use every tool at our disposal to protect American businesses and consumers. 

Tonight, I can announce that the United States has worked with 30 other countries to release 60 Million barrels of oil from reserves around the world.  

America will lead that effort, releasing 30 Million barrels from our own Strategic Petroleum Reserve. And we stand ready to do more if necessary, unified with our allies.  

These steps will help blunt gas prices here at home. And I know the news about whats happening can seem alarming. 

But I want you to know that we are going to be okay.

Content: More support for patients and families. 

To get there, I call on Congress to fund ARPA-H, the Advanced Research Projects Agency for Health. 

Its based on DARPAthe Defense Department project that led to the Internet, GPS, and so much more.  

ARPA-H will have a singular purposeto drive breakthroughs in cancer, Alzheimers, diabetes, and more. 

A unity agenda for the nation. 

We can do this. 

My fellow Americanstonight , we have gathered in a sacred spacethe citadel of our democracy. 

In this Capitol, generation after generation, Americans have debated great questions amid great strife, and have done great things. 

We have fought for freedom, expanded liberty, defeated totalitarianism and terror. 

And built the strongest, freest, and most prosperous nation the world has ever known. 

Now is the hour. 

Our moment of responsibility. 

Our test of resolve and conscience, of history itself. 

It is in this moment that our character is formed. Our purpose is found. Our future is forged. 

Well I know this nation.
=========
FINAL ANSWER: The president did not mention Michael Jackson.

QUESTION: {question}
=========
{summaries}
=========
FINAL ANSWER:`,ho=ke.fromTemplate(co),fo=`Given the following extracted parts of a long document and a question, create a final answer. 
If you don't know the answer, just say that you don't know. Don't try to make up an answer.
----------------
{summaries}`,po=[Ar.fromTemplate(fo),Et.fromTemplate("{question}")],mo=qe.fromPromptMessages(po),go=new dr(ho,[[hr,mo]]),yo=`The original question is as follows: {question}
We have provided an existing answer: {existing_answer}
We have the opportunity to refine the existing answer
(only if needed) with some more context below.
------------
{context}
------------
Given the new context, refine the original answer to better answer the question. 
If the context isn't useful, return the original answer.`,_o=new ke({inputVariables:["question","existing_answer","context"],template:yo}),bo=`The original question is as follows: {question}
We have provided an existing answer: {existing_answer}
We have the opportunity to refine the existing answer
(only if needed) with some more context below.
------------
{context}
------------
Given the new context, refine the original answer to better answer the question. 
If the context isn't useful, return the original answer.`,vo=[Et.fromTemplate("{question}"),Ji.fromTemplate("{existing_answer}"),Et.fromTemplate(bo)],wo=qe.fromPromptMessages(vo),xo=new dr(_o,[[hr,wo]]),ko=`Context information is below. 
---------------------
{context}
---------------------
Given the context information and not prior knowledge, answer the question: {question}`,Eo=new ke({inputVariables:["context","question"],template:ko}),Po=`Context information is below. 
---------------------
{context}
---------------------
Given the context information and not prior knowledge, answer any questions`,Oo=[Ar.fromTemplate(Po),Et.fromTemplate("{question}")],To=qe.fromPromptMessages(Oo),So=new dr(Eo,[[hr,To]]),jo=(n,e={type:"stuff"})=>{const{type:t}=e;if(t==="stuff")return Ao(n,e);if(t==="map_reduce")return Io(n,e);if(t==="refine")return Co(n,e);throw new Error(`Invalid _type: ${t}`)};function Ao(n,e={}){const{prompt:t=no.getPrompt(n),verbose:r}=e,a=new De({prompt:t,llm:n,verbose:r});return new Lt({llmChain:a,verbose:r})}function Io(n,e={}){const{combineMapPrompt:t=lo.getPrompt(n),combinePrompt:r=go.getPrompt(n),verbose:a,returnIntermediateSteps:s}=e,i=new De({prompt:t,llm:n,verbose:a}),o=new De({prompt:r,llm:n,verbose:a}),u=new Lt({llmChain:o,documentVariableName:"summaries",verbose:a});return new Sr({llmChain:i,combineDocumentChain:u,returnIntermediateSteps:s,verbose:a})}function Co(n,e={}){const{questionPrompt:t=So.getPrompt(n),refinePrompt:r=xo.getPrompt(n),verbose:a}=e,s=new De({prompt:t,llm:n,verbose:a}),i=new De({prompt:r,llm:n,verbose:a});return new jr({llmChain:s,refineLLMChain:i,verbose:a})}const Do=`Given the following conversation and a follow up question, rephrase the follow up question to be a standalone question.

Chat History:
{chat_history}
Follow Up Input: {question}
Standalone question:`;class gn extends cr{get inputKeys(){return[this.inputKey,this.chatHistoryKey]}get outputKeys(){return this.combineDocumentsChain.outputKeys.concat(this.returnSourceDocuments?["sourceDocuments"]:[])}constructor(e){super(e),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"question"}),Object.defineProperty(this,"chatHistoryKey",{enumerable:!0,configurable:!0,writable:!0,value:"chat_history"}),Object.defineProperty(this,"retriever",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"combineDocumentsChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"questionGeneratorChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSourceDocuments",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.retriever=e.retriever,this.combineDocumentsChain=e.combineDocumentsChain,this.questionGeneratorChain=e.questionGeneratorChain,this.inputKey=e.inputKey??this.inputKey,this.returnSourceDocuments=e.returnSourceDocuments??this.returnSourceDocuments}static getChatHistoryString(e){return Array.isArray(e)?e.map(t=>t._getType()==="human"?`Human: ${t.content}`:t._getType()==="ai"?`Assistant: ${t.content}`:`${t.content}`).join(`
`):e}async _call(e,t){if(!(this.inputKey in e))throw new Error(`Question key ${this.inputKey} not found.`);if(!(this.chatHistoryKey in e))throw new Error(`Chat history key ${this.chatHistoryKey} not found.`);const r=e[this.inputKey],a=gn.getChatHistoryString(e[this.chatHistoryKey]);let s=r;if(a.length>0){const c=await this.questionGeneratorChain.call({question:r,chat_history:a},t==null?void 0:t.getChild("question_generator")),m=Object.keys(c);if(m.length===1)s=c[m[0]];else throw new Error("Return from llm chain has multiple values, only single values supported.")}const i=await this.retriever.getRelevantDocuments(s),o={question:s,input_documents:i,chat_history:a},u=await this.combineDocumentsChain.call(o,t==null?void 0:t.getChild("combine_documents"));return this.returnSourceDocuments?{...u,sourceDocuments:i}:u}_chainType(){return"conversational_retrieval_chain"}static async deserialize(e,t){throw new Error("Not implemented.")}serialize(){throw new Error("Not implemented.")}static fromLLM(e,t,r={}){const{questionGeneratorTemplate:a,qaTemplate:s,qaChainOptions:i={type:"stuff",prompt:s?ke.fromTemplate(s):void 0},questionGeneratorChainOptions:o,verbose:u,...c}=r,m=jo(e,i),k=ke.fromTemplate((o==null?void 0:o.template)??a??Do),M=new De({prompt:k,llm:(o==null?void 0:o.llm)??e,verbose:u});return new this({retriever:t,combineDocumentsChain:m,questionGeneratorChain:M,verbose:u,...c})}}var le;(function(n){n.assertEqual=a=>a;function e(a){}n.assertIs=e;function t(a){throw new Error}n.assertNever=t,n.arrayToEnum=a=>{const s={};for(const i of a)s[i]=i;return s},n.getValidEnumValues=a=>{const s=n.objectKeys(a).filter(o=>typeof a[a[o]]!="number"),i={};for(const o of s)i[o]=a[o];return n.objectValues(i)},n.objectValues=a=>n.objectKeys(a).map(function(s){return a[s]}),n.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const s=[];for(const i in a)Object.prototype.hasOwnProperty.call(a,i)&&s.push(i);return s},n.find=(a,s)=>{for(const i of a)if(s(i))return i},n.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&isFinite(a)&&Math.floor(a)===a;function r(a,s=" | "){return a.map(i=>typeof i=="string"?`'${i}'`:i).join(s)}n.joinValues=r,n.jsonStringifyReplacer=(a,s)=>typeof s=="bigint"?s.toString():s})(le||(le={}));var kr;(function(n){n.mergeShapes=(e,t)=>({...e,...t})})(kr||(kr={}));const U=le.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Je=n=>{switch(typeof n){case"undefined":return U.undefined;case"string":return U.string;case"number":return isNaN(n)?U.nan:U.number;case"boolean":return U.boolean;case"function":return U.function;case"bigint":return U.bigint;case"symbol":return U.symbol;case"object":return Array.isArray(n)?U.array:n===null?U.null:n.then&&typeof n.then=="function"&&n.catch&&typeof n.catch=="function"?U.promise:typeof Map<"u"&&n instanceof Map?U.map:typeof Set<"u"&&n instanceof Set?U.set:typeof Date<"u"&&n instanceof Date?U.date:U.object;default:return U.unknown}},C=le.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),$a=n=>JSON.stringify(n,null,2).replace(/"([^"]+)":/g,"$1:");class Ze extends Error{constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const t=e||function(s){return s.message},r={_errors:[]},a=s=>{for(const i of s.issues)if(i.code==="invalid_union")i.unionErrors.map(a);else if(i.code==="invalid_return_type")a(i.returnTypeError);else if(i.code==="invalid_arguments")a(i.argumentsError);else if(i.path.length===0)r._errors.push(t(i));else{let o=r,u=0;for(;u<i.path.length;){const c=i.path[u];u===i.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(t(i))):o[c]=o[c]||{_errors:[]},o=o[c],u++}}};return a(this),r}toString(){return this.message}get message(){return JSON.stringify(this.issues,le.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},r=[];for(const a of this.issues)a.path.length>0?(t[a.path[0]]=t[a.path[0]]||[],t[a.path[0]].push(e(a))):r.push(e(a));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}Ze.create=n=>new Ze(n);const Pt=(n,e)=>{let t;switch(n.code){case C.invalid_type:n.received===U.undefined?t="Required":t=`Expected ${n.expected}, received ${n.received}`;break;case C.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(n.expected,le.jsonStringifyReplacer)}`;break;case C.unrecognized_keys:t=`Unrecognized key(s) in object: ${le.joinValues(n.keys,", ")}`;break;case C.invalid_union:t="Invalid input";break;case C.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${le.joinValues(n.options)}`;break;case C.invalid_enum_value:t=`Invalid enum value. Expected ${le.joinValues(n.options)}, received '${n.received}'`;break;case C.invalid_arguments:t="Invalid function arguments";break;case C.invalid_return_type:t="Invalid function return type";break;case C.invalid_date:t="Invalid date";break;case C.invalid_string:typeof n.validation=="object"?"includes"in n.validation?(t=`Invalid input: must include "${n.validation.includes}"`,typeof n.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${n.validation.position}`)):"startsWith"in n.validation?t=`Invalid input: must start with "${n.validation.startsWith}"`:"endsWith"in n.validation?t=`Invalid input: must end with "${n.validation.endsWith}"`:le.assertNever(n.validation):n.validation!=="regex"?t=`Invalid ${n.validation}`:t="Invalid";break;case C.too_small:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at least":"more than"} ${n.minimum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at least":"over"} ${n.minimum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(n.minimum))}`:t="Invalid input";break;case C.too_big:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at most":"less than"} ${n.maximum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at most":"under"} ${n.maximum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="bigint"?t=`BigInt must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly":n.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(n.maximum))}`:t="Invalid input";break;case C.custom:t="Invalid input";break;case C.invalid_intersection_types:t="Intersection results could not be merged";break;case C.not_multiple_of:t=`Number must be a multiple of ${n.multipleOf}`;break;case C.not_finite:t="Number must be finite";break;default:t=e.defaultError,le.assertNever(n)}return{message:t}};let Fa=Pt;function Ka(n){Fa=n}function Xt(){return Fa}const er=n=>{const{data:e,path:t,errorMaps:r,issueData:a}=n,s=[...t,...a.path||[]],i={...a,path:s};let o="";const u=r.filter(c=>!!c).slice().reverse();for(const c of u)o=c(i,{data:e,defaultError:o}).message;return{...a,path:s,message:a.message||o}},qa=[];function V(n,e){const t=er({issueData:e,data:n.data,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,Xt(),Pt].filter(r=>!!r)});n.common.issues.push(t)}class Ee{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const r=[];for(const a of t){if(a.status==="aborted")return J;a.status==="dirty"&&e.dirty(),r.push(a.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,t){const r=[];for(const a of t)r.push({key:await a.key,value:await a.value});return Ee.mergeObjectSync(e,r)}static mergeObjectSync(e,t){const r={};for(const a of t){const{key:s,value:i}=a;if(s.status==="aborted"||i.status==="aborted")return J;s.status==="dirty"&&e.dirty(),i.status==="dirty"&&e.dirty(),(typeof i.value<"u"||a.alwaysSet)&&(r[s.value]=i.value)}return{status:e.value,value:r}}}const J=Object.freeze({status:"aborted"}),yn=n=>({status:"dirty",value:n}),Te=n=>({status:"valid",value:n}),Er=n=>n.status==="aborted",Pr=n=>n.status==="dirty",tr=n=>n.status==="valid",rr=n=>typeof Promise<"u"&&n instanceof Promise;var H;(function(n){n.errToObj=e=>typeof e=="string"?{message:e}:e||{},n.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(H||(H={}));class He{constructor(e,t,r,a){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=a}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Kn=(n,e)=>{if(tr(e))return{success:!0,data:e.value};if(!n.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new Ze(n.common.issues);return this._error=t,this._error}}};function ee(n){if(!n)return{};const{errorMap:e,invalid_type_error:t,required_error:r,description:a}=n;if(e&&(t||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:a}:{errorMap:(i,o)=>i.code!=="invalid_type"?{message:o.defaultError}:typeof o.data>"u"?{message:r??o.defaultError}:{message:t??o.defaultError},description:a}}class X{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return Je(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:Je(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Ee,ctx:{common:e.parent.common,data:e.data,parsedType:Je(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(rr(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){var r;const a={common:{issues:[],async:(r=t==null?void 0:t.async)!==null&&r!==void 0?r:!1,contextualErrorMap:t==null?void 0:t.errorMap},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Je(e)},s=this._parseSync({data:e,path:a.path,parent:a});return Kn(a,s)}async parseAsync(e,t){const r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){const r={common:{issues:[],contextualErrorMap:t==null?void 0:t.errorMap,async:!0},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Je(e)},a=this._parse({data:e,path:r.path,parent:r}),s=await(rr(a)?a:Promise.resolve(a));return Kn(r,s)}refine(e,t){const r=a=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(a):t;return this._refinement((a,s)=>{const i=e(a),o=()=>s.addIssue({code:C.custom,...r(a)});return typeof Promise<"u"&&i instanceof Promise?i.then(u=>u?!0:(o(),!1)):i?!0:(o(),!1)})}refinement(e,t){return this._refinement((r,a)=>e(r)?!0:(a.addIssue(typeof t=="function"?t(r,a):t),!1))}_refinement(e){return new Me({schema:this,typeName:G.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return ze.create(this,this._def)}nullable(){return ut.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Be.create(this,this._def)}promise(){return mt.create(this,this._def)}or(e){return jt.create([this,e],this._def)}and(e){return At.create(this,e,this._def)}transform(e){return new Me({...ee(this._def),schema:this,typeName:G.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new Nt({...ee(this._def),innerType:this,defaultValue:t,typeName:G.ZodDefault})}brand(){return new _n({typeName:G.ZodBranded,type:this,...ee(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new ir({...ee(this._def),innerType:this,catchValue:t,typeName:G.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return Rt.create(this,e)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Mo=/^c[^\s-]{8,}$/i,No=/^[a-z][a-z0-9]*$/,Lo=/[0-9A-HJKMNP-TV-Z]{26}/,Ro=/^([a-f0-9]{8}-[a-f0-9]{4}-[1-5][a-f0-9]{3}-[a-f0-9]{4}-[a-f0-9]{12}|00000000-0000-0000-0000-000000000000)$/i,Zo=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\])|(\[IPv6:(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))\])|([A-Za-z0-9]([A-Za-z0-9-]*[A-Za-z0-9])*(\.[A-Za-z]{2,})+))$/,Bo=/^(\p{Extended_Pictographic}|\p{Emoji_Component})+$/u,Uo=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,Vo=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,$o=n=>n.precision?n.offset?new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${n.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${n.precision}}Z$`):n.precision===0?n.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):n.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$");function Fo(n,e){return!!((e==="v4"||!e)&&Uo.test(n)||(e==="v6"||!e)&&Vo.test(n))}class Re extends X{constructor(){super(...arguments),this._regex=(e,t,r)=>this.refinement(a=>e.test(a),{validation:t,code:C.invalid_string,...H.errToObj(r)}),this.nonempty=e=>this.min(1,H.errToObj(e)),this.trim=()=>new Re({...this._def,checks:[...this._def.checks,{kind:"trim"}]}),this.toLowerCase=()=>new Re({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]}),this.toUpperCase=()=>new Re({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==U.string){const s=this._getOrReturnCtx(e);return V(s,{code:C.invalid_type,expected:U.string,received:s.parsedType}),J}const r=new Ee;let a;for(const s of this._def.checks)if(s.kind==="min")e.data.length<s.value&&(a=this._getOrReturnCtx(e,a),V(a,{code:C.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),r.dirty());else if(s.kind==="max")e.data.length>s.value&&(a=this._getOrReturnCtx(e,a),V(a,{code:C.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!1,message:s.message}),r.dirty());else if(s.kind==="length"){const i=e.data.length>s.value,o=e.data.length<s.value;(i||o)&&(a=this._getOrReturnCtx(e,a),i?V(a,{code:C.too_big,maximum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}):o&&V(a,{code:C.too_small,minimum:s.value,type:"string",inclusive:!0,exact:!0,message:s.message}),r.dirty())}else if(s.kind==="email")Zo.test(e.data)||(a=this._getOrReturnCtx(e,a),V(a,{validation:"email",code:C.invalid_string,message:s.message}),r.dirty());else if(s.kind==="emoji")Bo.test(e.data)||(a=this._getOrReturnCtx(e,a),V(a,{validation:"emoji",code:C.invalid_string,message:s.message}),r.dirty());else if(s.kind==="uuid")Ro.test(e.data)||(a=this._getOrReturnCtx(e,a),V(a,{validation:"uuid",code:C.invalid_string,message:s.message}),r.dirty());else if(s.kind==="cuid")Mo.test(e.data)||(a=this._getOrReturnCtx(e,a),V(a,{validation:"cuid",code:C.invalid_string,message:s.message}),r.dirty());else if(s.kind==="cuid2")No.test(e.data)||(a=this._getOrReturnCtx(e,a),V(a,{validation:"cuid2",code:C.invalid_string,message:s.message}),r.dirty());else if(s.kind==="ulid")Lo.test(e.data)||(a=this._getOrReturnCtx(e,a),V(a,{validation:"ulid",code:C.invalid_string,message:s.message}),r.dirty());else if(s.kind==="url")try{new URL(e.data)}catch{a=this._getOrReturnCtx(e,a),V(a,{validation:"url",code:C.invalid_string,message:s.message}),r.dirty()}else s.kind==="regex"?(s.regex.lastIndex=0,s.regex.test(e.data)||(a=this._getOrReturnCtx(e,a),V(a,{validation:"regex",code:C.invalid_string,message:s.message}),r.dirty())):s.kind==="trim"?e.data=e.data.trim():s.kind==="includes"?e.data.includes(s.value,s.position)||(a=this._getOrReturnCtx(e,a),V(a,{code:C.invalid_string,validation:{includes:s.value,position:s.position},message:s.message}),r.dirty()):s.kind==="toLowerCase"?e.data=e.data.toLowerCase():s.kind==="toUpperCase"?e.data=e.data.toUpperCase():s.kind==="startsWith"?e.data.startsWith(s.value)||(a=this._getOrReturnCtx(e,a),V(a,{code:C.invalid_string,validation:{startsWith:s.value},message:s.message}),r.dirty()):s.kind==="endsWith"?e.data.endsWith(s.value)||(a=this._getOrReturnCtx(e,a),V(a,{code:C.invalid_string,validation:{endsWith:s.value},message:s.message}),r.dirty()):s.kind==="datetime"?$o(s).test(e.data)||(a=this._getOrReturnCtx(e,a),V(a,{code:C.invalid_string,validation:"datetime",message:s.message}),r.dirty()):s.kind==="ip"?Fo(e.data,s.version)||(a=this._getOrReturnCtx(e,a),V(a,{validation:"ip",code:C.invalid_string,message:s.message}),r.dirty()):le.assertNever(s);return{status:r.value,value:e.data}}_addCheck(e){return new Re({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...H.errToObj(e)})}url(e){return this._addCheck({kind:"url",...H.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...H.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...H.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...H.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...H.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...H.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...H.errToObj(e)})}datetime(e){var t;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(t=e==null?void 0:e.offset)!==null&&t!==void 0?t:!1,...H.errToObj(e==null?void 0:e.message)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...H.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t==null?void 0:t.position,...H.errToObj(t==null?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...H.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...H.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...H.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...H.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...H.errToObj(t)})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}Re.create=n=>{var e;return new Re({checks:[],typeName:G.ZodString,coerce:(e=n==null?void 0:n.coerce)!==null&&e!==void 0?e:!1,...ee(n)})};function Ko(n,e){const t=(n.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,a=t>r?t:r,s=parseInt(n.toFixed(a).replace(".","")),i=parseInt(e.toFixed(a).replace(".",""));return s%i/Math.pow(10,a)}class Xe extends X{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==U.number){const s=this._getOrReturnCtx(e);return V(s,{code:C.invalid_type,expected:U.number,received:s.parsedType}),J}let r;const a=new Ee;for(const s of this._def.checks)s.kind==="int"?le.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),V(r,{code:C.invalid_type,expected:"integer",received:"float",message:s.message}),a.dirty()):s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(r=this._getOrReturnCtx(e,r),V(r,{code:C.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),a.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(r=this._getOrReturnCtx(e,r),V(r,{code:C.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),a.dirty()):s.kind==="multipleOf"?Ko(e.data,s.value)!==0&&(r=this._getOrReturnCtx(e,r),V(r,{code:C.not_multiple_of,multipleOf:s.value,message:s.message}),a.dirty()):s.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),V(r,{code:C.not_finite,message:s.message}),a.dirty()):le.assertNever(s);return{status:a.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,H.toString(t))}gt(e,t){return this.setLimit("min",e,!1,H.toString(t))}lte(e,t){return this.setLimit("max",e,!0,H.toString(t))}lt(e,t){return this.setLimit("max",e,!1,H.toString(t))}setLimit(e,t,r,a){return new Xe({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:H.toString(a)}]})}_addCheck(e){return new Xe({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:H.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:H.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:H.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:H.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:H.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:H.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:H.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:H.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:H.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&le.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(t===null||r.value>t)&&(t=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}}Xe.create=n=>new Xe({checks:[],typeName:G.ZodNumber,coerce:(n==null?void 0:n.coerce)||!1,...ee(n)});class et extends X{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==U.bigint){const s=this._getOrReturnCtx(e);return V(s,{code:C.invalid_type,expected:U.bigint,received:s.parsedType}),J}let r;const a=new Ee;for(const s of this._def.checks)s.kind==="min"?(s.inclusive?e.data<s.value:e.data<=s.value)&&(r=this._getOrReturnCtx(e,r),V(r,{code:C.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),a.dirty()):s.kind==="max"?(s.inclusive?e.data>s.value:e.data>=s.value)&&(r=this._getOrReturnCtx(e,r),V(r,{code:C.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),a.dirty()):s.kind==="multipleOf"?e.data%s.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),V(r,{code:C.not_multiple_of,multipleOf:s.value,message:s.message}),a.dirty()):le.assertNever(s);return{status:a.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,H.toString(t))}gt(e,t){return this.setLimit("min",e,!1,H.toString(t))}lte(e,t){return this.setLimit("max",e,!0,H.toString(t))}lt(e,t){return this.setLimit("max",e,!1,H.toString(t))}setLimit(e,t,r,a){return new et({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:H.toString(a)}]})}_addCheck(e){return new et({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:H.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:H.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:H.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:H.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:H.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}et.create=n=>{var e;return new et({checks:[],typeName:G.ZodBigInt,coerce:(e=n==null?void 0:n.coerce)!==null&&e!==void 0?e:!1,...ee(n)})};class Ot extends X{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==U.boolean){const r=this._getOrReturnCtx(e);return V(r,{code:C.invalid_type,expected:U.boolean,received:r.parsedType}),J}return Te(e.data)}}Ot.create=n=>new Ot({typeName:G.ZodBoolean,coerce:(n==null?void 0:n.coerce)||!1,...ee(n)});class it extends X{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==U.date){const s=this._getOrReturnCtx(e);return V(s,{code:C.invalid_type,expected:U.date,received:s.parsedType}),J}if(isNaN(e.data.getTime())){const s=this._getOrReturnCtx(e);return V(s,{code:C.invalid_date}),J}const r=new Ee;let a;for(const s of this._def.checks)s.kind==="min"?e.data.getTime()<s.value&&(a=this._getOrReturnCtx(e,a),V(a,{code:C.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),r.dirty()):s.kind==="max"?e.data.getTime()>s.value&&(a=this._getOrReturnCtx(e,a),V(a,{code:C.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),r.dirty()):le.assertNever(s);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new it({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:H.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:H.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}it.create=n=>new it({checks:[],coerce:(n==null?void 0:n.coerce)||!1,typeName:G.ZodDate,...ee(n)});class nr extends X{_parse(e){if(this._getType(e)!==U.symbol){const r=this._getOrReturnCtx(e);return V(r,{code:C.invalid_type,expected:U.symbol,received:r.parsedType}),J}return Te(e.data)}}nr.create=n=>new nr({typeName:G.ZodSymbol,...ee(n)});class Tt extends X{_parse(e){if(this._getType(e)!==U.undefined){const r=this._getOrReturnCtx(e);return V(r,{code:C.invalid_type,expected:U.undefined,received:r.parsedType}),J}return Te(e.data)}}Tt.create=n=>new Tt({typeName:G.ZodUndefined,...ee(n)});class St extends X{_parse(e){if(this._getType(e)!==U.null){const r=this._getOrReturnCtx(e);return V(r,{code:C.invalid_type,expected:U.null,received:r.parsedType}),J}return Te(e.data)}}St.create=n=>new St({typeName:G.ZodNull,...ee(n)});class pt extends X{constructor(){super(...arguments),this._any=!0}_parse(e){return Te(e.data)}}pt.create=n=>new pt({typeName:G.ZodAny,...ee(n)});class st extends X{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Te(e.data)}}st.create=n=>new st({typeName:G.ZodUnknown,...ee(n)});class Ye extends X{_parse(e){const t=this._getOrReturnCtx(e);return V(t,{code:C.invalid_type,expected:U.never,received:t.parsedType}),J}}Ye.create=n=>new Ye({typeName:G.ZodNever,...ee(n)});class ar extends X{_parse(e){if(this._getType(e)!==U.undefined){const r=this._getOrReturnCtx(e);return V(r,{code:C.invalid_type,expected:U.void,received:r.parsedType}),J}return Te(e.data)}}ar.create=n=>new ar({typeName:G.ZodVoid,...ee(n)});class Be extends X{_parse(e){const{ctx:t,status:r}=this._processInputParams(e),a=this._def;if(t.parsedType!==U.array)return V(t,{code:C.invalid_type,expected:U.array,received:t.parsedType}),J;if(a.exactLength!==null){const i=t.data.length>a.exactLength.value,o=t.data.length<a.exactLength.value;(i||o)&&(V(t,{code:i?C.too_big:C.too_small,minimum:o?a.exactLength.value:void 0,maximum:i?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),r.dirty())}if(a.minLength!==null&&t.data.length<a.minLength.value&&(V(t,{code:C.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),r.dirty()),a.maxLength!==null&&t.data.length>a.maxLength.value&&(V(t,{code:C.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((i,o)=>a.type._parseAsync(new He(t,i,t.path,o)))).then(i=>Ee.mergeArray(r,i));const s=[...t.data].map((i,o)=>a.type._parseSync(new He(t,i,t.path,o)));return Ee.mergeArray(r,s)}get element(){return this._def.type}min(e,t){return new Be({...this._def,minLength:{value:e,message:H.toString(t)}})}max(e,t){return new Be({...this._def,maxLength:{value:e,message:H.toString(t)}})}length(e,t){return new Be({...this._def,exactLength:{value:e,message:H.toString(t)}})}nonempty(e){return this.min(1,e)}}Be.create=(n,e)=>new Be({type:n,minLength:null,maxLength:null,exactLength:null,typeName:G.ZodArray,...ee(e)});function bt(n){if(n instanceof fe){const e={};for(const t in n.shape){const r=n.shape[t];e[t]=ze.create(bt(r))}return new fe({...n._def,shape:()=>e})}else return n instanceof Be?new Be({...n._def,type:bt(n.element)}):n instanceof ze?ze.create(bt(n.unwrap())):n instanceof ut?ut.create(bt(n.unwrap())):n instanceof $e?$e.create(n.items.map(e=>bt(e))):n}class fe extends X{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=le.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==U.object){const c=this._getOrReturnCtx(e);return V(c,{code:C.invalid_type,expected:U.object,received:c.parsedType}),J}const{status:r,ctx:a}=this._processInputParams(e),{shape:s,keys:i}=this._getCached(),o=[];if(!(this._def.catchall instanceof Ye&&this._def.unknownKeys==="strip"))for(const c in a.data)i.includes(c)||o.push(c);const u=[];for(const c of i){const m=s[c],k=a.data[c];u.push({key:{status:"valid",value:c},value:m._parse(new He(a,k,a.path,c)),alwaysSet:c in a.data})}if(this._def.catchall instanceof Ye){const c=this._def.unknownKeys;if(c==="passthrough")for(const m of o)u.push({key:{status:"valid",value:m},value:{status:"valid",value:a.data[m]}});else if(c==="strict")o.length>0&&(V(a,{code:C.unrecognized_keys,keys:o}),r.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const m of o){const k=a.data[m];u.push({key:{status:"valid",value:m},value:c._parse(new He(a,k,a.path,m)),alwaysSet:m in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const c=[];for(const m of u){const k=await m.key;c.push({key:k,value:await m.value,alwaysSet:m.alwaysSet})}return c}).then(c=>Ee.mergeObjectSync(r,c)):Ee.mergeObjectSync(r,u)}get shape(){return this._def.shape()}strict(e){return H.errToObj,new fe({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,r)=>{var a,s,i,o;const u=(i=(s=(a=this._def).errorMap)===null||s===void 0?void 0:s.call(a,t,r).message)!==null&&i!==void 0?i:r.defaultError;return t.code==="unrecognized_keys"?{message:(o=H.errToObj(e).message)!==null&&o!==void 0?o:u}:{message:u}}}:{}})}strip(){return new fe({...this._def,unknownKeys:"strip"})}passthrough(){return new fe({...this._def,unknownKeys:"passthrough"})}extend(e){return new fe({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new fe({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:G.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new fe({...this._def,catchall:e})}pick(e){const t={};return le.objectKeys(e).forEach(r=>{e[r]&&this.shape[r]&&(t[r]=this.shape[r])}),new fe({...this._def,shape:()=>t})}omit(e){const t={};return le.objectKeys(this.shape).forEach(r=>{e[r]||(t[r]=this.shape[r])}),new fe({...this._def,shape:()=>t})}deepPartial(){return bt(this)}partial(e){const t={};return le.objectKeys(this.shape).forEach(r=>{const a=this.shape[r];e&&!e[r]?t[r]=a:t[r]=a.optional()}),new fe({...this._def,shape:()=>t})}required(e){const t={};return le.objectKeys(this.shape).forEach(r=>{if(e&&!e[r])t[r]=this.shape[r];else{let s=this.shape[r];for(;s instanceof ze;)s=s._def.innerType;t[r]=s}}),new fe({...this._def,shape:()=>t})}keyof(){return za(le.objectKeys(this.shape))}}fe.create=(n,e)=>new fe({shape:()=>n,unknownKeys:"strip",catchall:Ye.create(),typeName:G.ZodObject,...ee(e)});fe.strictCreate=(n,e)=>new fe({shape:()=>n,unknownKeys:"strict",catchall:Ye.create(),typeName:G.ZodObject,...ee(e)});fe.lazycreate=(n,e)=>new fe({shape:n,unknownKeys:"strip",catchall:Ye.create(),typeName:G.ZodObject,...ee(e)});class jt extends X{_parse(e){const{ctx:t}=this._processInputParams(e),r=this._def.options;function a(s){for(const o of s)if(o.result.status==="valid")return o.result;for(const o of s)if(o.result.status==="dirty")return t.common.issues.push(...o.ctx.common.issues),o.result;const i=s.map(o=>new Ze(o.ctx.common.issues));return V(t,{code:C.invalid_union,unionErrors:i}),J}if(t.common.async)return Promise.all(r.map(async s=>{const i={...t,common:{...t.common,issues:[]},parent:null};return{result:await s._parseAsync({data:t.data,path:t.path,parent:i}),ctx:i}})).then(a);{let s;const i=[];for(const u of r){const c={...t,common:{...t.common,issues:[]},parent:null},m=u._parseSync({data:t.data,path:t.path,parent:c});if(m.status==="valid")return m;m.status==="dirty"&&!s&&(s={result:m,ctx:c}),c.common.issues.length&&i.push(c.common.issues)}if(s)return t.common.issues.push(...s.ctx.common.issues),s.result;const o=i.map(u=>new Ze(u));return V(t,{code:C.invalid_union,unionErrors:o}),J}}get options(){return this._def.options}}jt.create=(n,e)=>new jt({options:n,typeName:G.ZodUnion,...ee(e)});const wr=n=>n instanceof Ct?wr(n.schema):n instanceof Me?wr(n.innerType()):n instanceof Dt?[n.value]:n instanceof tt?n.options:n instanceof Mt?Object.keys(n.enum):n instanceof Nt?wr(n._def.innerType):n instanceof Tt?[void 0]:n instanceof St?[null]:null;class fr extends X{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==U.object)return V(t,{code:C.invalid_type,expected:U.object,received:t.parsedType}),J;const r=this.discriminator,a=t.data[r],s=this.optionsMap.get(a);return s?t.common.async?s._parseAsync({data:t.data,path:t.path,parent:t}):s._parseSync({data:t.data,path:t.path,parent:t}):(V(t,{code:C.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),J)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,r){const a=new Map;for(const s of t){const i=wr(s.shape[e]);if(!i)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const o of i){if(a.has(o))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(o)}`);a.set(o,s)}}return new fr({typeName:G.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:a,...ee(r)})}}function en(n,e){const t=Je(n),r=Je(e);if(n===e)return{valid:!0,data:n};if(t===U.object&&r===U.object){const a=le.objectKeys(e),s=le.objectKeys(n).filter(o=>a.indexOf(o)!==-1),i={...n,...e};for(const o of s){const u=en(n[o],e[o]);if(!u.valid)return{valid:!1};i[o]=u.data}return{valid:!0,data:i}}else if(t===U.array&&r===U.array){if(n.length!==e.length)return{valid:!1};const a=[];for(let s=0;s<n.length;s++){const i=n[s],o=e[s],u=en(i,o);if(!u.valid)return{valid:!1};a.push(u.data)}return{valid:!0,data:a}}else return t===U.date&&r===U.date&&+n==+e?{valid:!0,data:n}:{valid:!1}}class At extends X{_parse(e){const{status:t,ctx:r}=this._processInputParams(e),a=(s,i)=>{if(Er(s)||Er(i))return J;const o=en(s.value,i.value);return o.valid?((Pr(s)||Pr(i))&&t.dirty(),{status:t.value,value:o.data}):(V(r,{code:C.invalid_intersection_types}),J)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([s,i])=>a(s,i)):a(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}At.create=(n,e,t)=>new At({left:n,right:e,typeName:G.ZodIntersection,...ee(t)});class $e extends X{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==U.array)return V(r,{code:C.invalid_type,expected:U.array,received:r.parsedType}),J;if(r.data.length<this._def.items.length)return V(r,{code:C.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),J;!this._def.rest&&r.data.length>this._def.items.length&&(V(r,{code:C.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const s=[...r.data].map((i,o)=>{const u=this._def.items[o]||this._def.rest;return u?u._parse(new He(r,i,r.path,o)):null}).filter(i=>!!i);return r.common.async?Promise.all(s).then(i=>Ee.mergeArray(t,i)):Ee.mergeArray(t,s)}get items(){return this._def.items}rest(e){return new $e({...this._def,rest:e})}}$e.create=(n,e)=>{if(!Array.isArray(n))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new $e({items:n,typeName:G.ZodTuple,rest:null,...ee(e)})};class It extends X{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==U.object)return V(r,{code:C.invalid_type,expected:U.object,received:r.parsedType}),J;const a=[],s=this._def.keyType,i=this._def.valueType;for(const o in r.data)a.push({key:s._parse(new He(r,o,r.path,o)),value:i._parse(new He(r,r.data[o],r.path,o))});return r.common.async?Ee.mergeObjectAsync(t,a):Ee.mergeObjectSync(t,a)}get element(){return this._def.valueType}static create(e,t,r){return t instanceof X?new It({keyType:e,valueType:t,typeName:G.ZodRecord,...ee(r)}):new It({keyType:Re.create(),valueType:e,typeName:G.ZodRecord,...ee(t)})}}class sr extends X{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==U.map)return V(r,{code:C.invalid_type,expected:U.map,received:r.parsedType}),J;const a=this._def.keyType,s=this._def.valueType,i=[...r.data.entries()].map(([o,u],c)=>({key:a._parse(new He(r,o,r.path,[c,"key"])),value:s._parse(new He(r,u,r.path,[c,"value"]))}));if(r.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const u of i){const c=await u.key,m=await u.value;if(c.status==="aborted"||m.status==="aborted")return J;(c.status==="dirty"||m.status==="dirty")&&t.dirty(),o.set(c.value,m.value)}return{status:t.value,value:o}})}else{const o=new Map;for(const u of i){const c=u.key,m=u.value;if(c.status==="aborted"||m.status==="aborted")return J;(c.status==="dirty"||m.status==="dirty")&&t.dirty(),o.set(c.value,m.value)}return{status:t.value,value:o}}}}sr.create=(n,e,t)=>new sr({valueType:e,keyType:n,typeName:G.ZodMap,...ee(t)});class ot extends X{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==U.set)return V(r,{code:C.invalid_type,expected:U.set,received:r.parsedType}),J;const a=this._def;a.minSize!==null&&r.data.size<a.minSize.value&&(V(r,{code:C.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),t.dirty()),a.maxSize!==null&&r.data.size>a.maxSize.value&&(V(r,{code:C.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),t.dirty());const s=this._def.valueType;function i(u){const c=new Set;for(const m of u){if(m.status==="aborted")return J;m.status==="dirty"&&t.dirty(),c.add(m.value)}return{status:t.value,value:c}}const o=[...r.data.values()].map((u,c)=>s._parse(new He(r,u,r.path,c)));return r.common.async?Promise.all(o).then(u=>i(u)):i(o)}min(e,t){return new ot({...this._def,minSize:{value:e,message:H.toString(t)}})}max(e,t){return new ot({...this._def,maxSize:{value:e,message:H.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}ot.create=(n,e)=>new ot({valueType:n,minSize:null,maxSize:null,typeName:G.ZodSet,...ee(e)});class ft extends X{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==U.function)return V(t,{code:C.invalid_type,expected:U.function,received:t.parsedType}),J;function r(o,u){return er({data:o,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Xt(),Pt].filter(c=>!!c),issueData:{code:C.invalid_arguments,argumentsError:u}})}function a(o,u){return er({data:o,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Xt(),Pt].filter(c=>!!c),issueData:{code:C.invalid_return_type,returnTypeError:u}})}const s={errorMap:t.common.contextualErrorMap},i=t.data;return this._def.returns instanceof mt?Te(async(...o)=>{const u=new Ze([]),c=await this._def.args.parseAsync(o,s).catch(M=>{throw u.addIssue(r(o,M)),u}),m=await i(...c);return await this._def.returns._def.type.parseAsync(m,s).catch(M=>{throw u.addIssue(a(m,M)),u})}):Te((...o)=>{const u=this._def.args.safeParse(o,s);if(!u.success)throw new Ze([r(o,u.error)]);const c=i(...u.data),m=this._def.returns.safeParse(c,s);if(!m.success)throw new Ze([a(c,m.error)]);return m.data})}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new ft({...this._def,args:$e.create(e).rest(st.create())})}returns(e){return new ft({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,r){return new ft({args:e||$e.create([]).rest(st.create()),returns:t||st.create(),typeName:G.ZodFunction,...ee(r)})}}class Ct extends X{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}Ct.create=(n,e)=>new Ct({getter:n,typeName:G.ZodLazy,...ee(e)});class Dt extends X{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return V(t,{received:t.data,code:C.invalid_literal,expected:this._def.value}),J}return{status:"valid",value:e.data}}get value(){return this._def.value}}Dt.create=(n,e)=>new Dt({value:n,typeName:G.ZodLiteral,...ee(e)});function za(n,e){return new tt({values:n,typeName:G.ZodEnum,...ee(e)})}class tt extends X{_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),r=this._def.values;return V(t,{expected:le.joinValues(r),received:t.parsedType,code:C.invalid_type}),J}if(this._def.values.indexOf(e.data)===-1){const t=this._getOrReturnCtx(e),r=this._def.values;return V(t,{received:t.data,code:C.invalid_enum_value,options:r}),J}return Te(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e){return tt.create(e)}exclude(e){return tt.create(this.options.filter(t=>!e.includes(t)))}}tt.create=za;class Mt extends X{_parse(e){const t=le.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==U.string&&r.parsedType!==U.number){const a=le.objectValues(t);return V(r,{expected:le.joinValues(a),received:r.parsedType,code:C.invalid_type}),J}if(t.indexOf(e.data)===-1){const a=le.objectValues(t);return V(r,{received:r.data,code:C.invalid_enum_value,options:a}),J}return Te(e.data)}get enum(){return this._def.values}}Mt.create=(n,e)=>new Mt({values:n,typeName:G.ZodNativeEnum,...ee(e)});class mt extends X{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==U.promise&&t.common.async===!1)return V(t,{code:C.invalid_type,expected:U.promise,received:t.parsedType}),J;const r=t.parsedType===U.promise?t.data:Promise.resolve(t.data);return Te(r.then(a=>this._def.type.parseAsync(a,{path:t.path,errorMap:t.common.contextualErrorMap})))}}mt.create=(n,e)=>new mt({type:n,typeName:G.ZodPromise,...ee(e)});class Me extends X{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===G.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:r}=this._processInputParams(e),a=this._def.effect||null;if(a.type==="preprocess"){const i=a.transform(r.data);return r.common.async?Promise.resolve(i).then(o=>this._def.schema._parseAsync({data:o,path:r.path,parent:r})):this._def.schema._parseSync({data:i,path:r.path,parent:r})}const s={addIssue:i=>{V(r,i),i.fatal?t.abort():t.dirty()},get path(){return r.path}};if(s.addIssue=s.addIssue.bind(s),a.type==="refinement"){const i=o=>{const u=a.refinement(o,s);if(r.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return o.status==="aborted"?J:(o.status==="dirty"&&t.dirty(),i(o.value),{status:t.value,value:o.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>o.status==="aborted"?J:(o.status==="dirty"&&t.dirty(),i(o.value).then(()=>({status:t.value,value:o.value}))))}if(a.type==="transform")if(r.common.async===!1){const i=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!tr(i))return i;const o=a.transform(i.value,s);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:o}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(i=>tr(i)?Promise.resolve(a.transform(i.value,s)).then(o=>({status:t.value,value:o})):i);le.assertNever(a)}}Me.create=(n,e,t)=>new Me({schema:n,typeName:G.ZodEffects,effect:e,...ee(t)});Me.createWithPreprocess=(n,e,t)=>new Me({schema:e,effect:{type:"preprocess",transform:n},typeName:G.ZodEffects,...ee(t)});class ze extends X{_parse(e){return this._getType(e)===U.undefined?Te(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ze.create=(n,e)=>new ze({innerType:n,typeName:G.ZodOptional,...ee(e)});class ut extends X{_parse(e){return this._getType(e)===U.null?Te(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ut.create=(n,e)=>new ut({innerType:n,typeName:G.ZodNullable,...ee(e)});class Nt extends X{_parse(e){const{ctx:t}=this._processInputParams(e);let r=t.data;return t.parsedType===U.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}Nt.create=(n,e)=>new Nt({innerType:n,typeName:G.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...ee(e)});class ir extends X{_parse(e){const{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},a=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return rr(a)?a.then(s=>({status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Ze(r.common.issues)},input:r.data})})):{status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new Ze(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}ir.create=(n,e)=>new ir({innerType:n,typeName:G.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...ee(e)});class or extends X{_parse(e){if(this._getType(e)!==U.nan){const r=this._getOrReturnCtx(e);return V(r,{code:C.invalid_type,expected:U.nan,received:r.parsedType}),J}return{status:"valid",value:e.data}}}or.create=n=>new or({typeName:G.ZodNaN,...ee(n)});const Ha=Symbol("zod_brand");class _n extends X{_parse(e){const{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}class Rt extends X{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const s=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?J:s.status==="dirty"?(t.dirty(),yn(s.value)):this._def.out._parseAsync({data:s.value,path:r.path,parent:r})})();{const a=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?J:a.status==="dirty"?(t.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:r.path,parent:r})}}static create(e,t){return new Rt({in:e,out:t,typeName:G.ZodPipeline})}}const bn=(n,e={},t)=>n?pt.create().superRefine((r,a)=>{var s,i;if(!n(r)){const o=typeof e=="function"?e(r):typeof e=="string"?{message:e}:e,u=(i=(s=o.fatal)!==null&&s!==void 0?s:t)!==null&&i!==void 0?i:!0,c=typeof o=="string"?{message:o}:o;a.addIssue({code:"custom",...c,fatal:u})}}):pt.create(),Ya={object:fe.lazycreate};var G;(function(n){n.ZodString="ZodString",n.ZodNumber="ZodNumber",n.ZodNaN="ZodNaN",n.ZodBigInt="ZodBigInt",n.ZodBoolean="ZodBoolean",n.ZodDate="ZodDate",n.ZodSymbol="ZodSymbol",n.ZodUndefined="ZodUndefined",n.ZodNull="ZodNull",n.ZodAny="ZodAny",n.ZodUnknown="ZodUnknown",n.ZodNever="ZodNever",n.ZodVoid="ZodVoid",n.ZodArray="ZodArray",n.ZodObject="ZodObject",n.ZodUnion="ZodUnion",n.ZodDiscriminatedUnion="ZodDiscriminatedUnion",n.ZodIntersection="ZodIntersection",n.ZodTuple="ZodTuple",n.ZodRecord="ZodRecord",n.ZodMap="ZodMap",n.ZodSet="ZodSet",n.ZodFunction="ZodFunction",n.ZodLazy="ZodLazy",n.ZodLiteral="ZodLiteral",n.ZodEnum="ZodEnum",n.ZodEffects="ZodEffects",n.ZodNativeEnum="ZodNativeEnum",n.ZodOptional="ZodOptional",n.ZodNullable="ZodNullable",n.ZodDefault="ZodDefault",n.ZodCatch="ZodCatch",n.ZodPromise="ZodPromise",n.ZodBranded="ZodBranded",n.ZodPipeline="ZodPipeline"})(G||(G={}));const Ga=(n,e={message:`Input not instance of ${n.name}`})=>bn(t=>t instanceof n,e),vn=Re.create,wn=Xe.create,Wa=or.create,Ja=et.create,xn=Ot.create,Qa=it.create,Xa=nr.create,es=Tt.create,ts=St.create,rs=pt.create,ns=st.create,as=Ye.create,ss=ar.create,is=Be.create,os=fe.create,us=fe.strictCreate,ls=jt.create,cs=fr.create,ds=At.create,hs=$e.create,fs=It.create,ps=sr.create,ms=ot.create,gs=ft.create,ys=Ct.create,_s=Dt.create,bs=tt.create,vs=Mt.create,ws=mt.create,Or=Me.create,xs=ze.create,ks=ut.create,Es=Me.createWithPreprocess,Ps=Rt.create,Os=()=>vn().optional(),Ts=()=>wn().optional(),Ss=()=>xn().optional(),js={string:n=>Re.create({...n,coerce:!0}),number:n=>Xe.create({...n,coerce:!0}),boolean:n=>Ot.create({...n,coerce:!0}),bigint:n=>et.create({...n,coerce:!0}),date:n=>it.create({...n,coerce:!0})},As=J;var qn=Object.freeze({__proto__:null,defaultErrorMap:Pt,setErrorMap:Ka,getErrorMap:Xt,makeIssue:er,EMPTY_PATH:qa,addIssueToContext:V,ParseStatus:Ee,INVALID:J,DIRTY:yn,OK:Te,isAborted:Er,isDirty:Pr,isValid:tr,isAsync:rr,get util(){return le},get objectUtil(){return kr},ZodParsedType:U,getParsedType:Je,ZodType:X,ZodString:Re,ZodNumber:Xe,ZodBigInt:et,ZodBoolean:Ot,ZodDate:it,ZodSymbol:nr,ZodUndefined:Tt,ZodNull:St,ZodAny:pt,ZodUnknown:st,ZodNever:Ye,ZodVoid:ar,ZodArray:Be,ZodObject:fe,ZodUnion:jt,ZodDiscriminatedUnion:fr,ZodIntersection:At,ZodTuple:$e,ZodRecord:It,ZodMap:sr,ZodSet:ot,ZodFunction:ft,ZodLazy:Ct,ZodLiteral:Dt,ZodEnum:tt,ZodNativeEnum:Mt,ZodPromise:mt,ZodEffects:Me,ZodTransformer:Me,ZodOptional:ze,ZodNullable:ut,ZodDefault:Nt,ZodCatch:ir,ZodNaN:or,BRAND:Ha,ZodBranded:_n,ZodPipeline:Rt,custom:bn,Schema:X,ZodSchema:X,late:Ya,get ZodFirstPartyTypeKind(){return G},coerce:js,any:rs,array:is,bigint:Ja,boolean:xn,date:Qa,discriminatedUnion:cs,effect:Or,enum:bs,function:gs,instanceof:Ga,intersection:ds,lazy:ys,literal:_s,map:ps,nan:Wa,nativeEnum:vs,never:as,null:ts,nullable:ks,number:wn,object:os,oboolean:Ss,onumber:Ts,optional:xs,ostring:Os,pipeline:Ps,preprocess:Es,promise:ws,record:fs,set:ms,strictObject:us,string:vn,symbol:Xa,transformer:Or,tuple:hs,undefined:es,union:ls,unknown:ns,void:ss,NEVER:As,ZodIssueCode:C,quotelessJson:$a,ZodError:Ze});const qo=Object.freeze(Object.defineProperty({__proto__:null,BRAND:Ha,DIRTY:yn,EMPTY_PATH:qa,INVALID:J,NEVER:As,OK:Te,ParseStatus:Ee,Schema:X,ZodAny:pt,ZodArray:Be,ZodBigInt:et,ZodBoolean:Ot,ZodBranded:_n,ZodCatch:ir,ZodDate:it,ZodDefault:Nt,ZodDiscriminatedUnion:fr,ZodEffects:Me,ZodEnum:tt,ZodError:Ze,get ZodFirstPartyTypeKind(){return G},ZodFunction:ft,ZodIntersection:At,ZodIssueCode:C,ZodLazy:Ct,ZodLiteral:Dt,ZodMap:sr,ZodNaN:or,ZodNativeEnum:Mt,ZodNever:Ye,ZodNull:St,ZodNullable:ut,ZodNumber:Xe,ZodObject:fe,ZodOptional:ze,ZodParsedType:U,ZodPipeline:Rt,ZodPromise:mt,ZodRecord:It,ZodSchema:X,ZodSet:ot,ZodString:Re,ZodSymbol:nr,ZodTransformer:Me,ZodTuple:$e,ZodType:X,ZodUndefined:Tt,ZodUnion:jt,ZodUnknown:st,ZodVoid:ar,addIssueToContext:V,any:rs,array:is,bigint:Ja,boolean:xn,coerce:js,custom:bn,date:Qa,default:qn,defaultErrorMap:Pt,discriminatedUnion:cs,effect:Or,enum:bs,function:gs,getErrorMap:Xt,getParsedType:Je,instanceof:Ga,intersection:ds,isAborted:Er,isAsync:rr,isDirty:Pr,isValid:tr,late:Ya,lazy:ys,literal:_s,makeIssue:er,map:ps,nan:Wa,nativeEnum:vs,never:as,null:ts,nullable:ks,number:wn,object:os,get objectUtil(){return kr},oboolean:Ss,onumber:Ts,optional:xs,ostring:Os,pipeline:Ps,preprocess:Es,promise:ws,quotelessJson:$a,record:fs,set:ms,setErrorMap:Ka,strictObject:us,string:vn,symbol:Xa,transformer:Or,tuple:hs,undefined:es,union:ls,unknown:ns,get util(){return le},void:ss,z:qn},Symbol.toStringTag,{value:"Module"}));var zo={},Ir={},Zt={};const kn=si(qo);var Cr={};Object.defineProperty(Cr,"__esModule",{value:!0});Cr.parseAnyDef=void 0;function Ho(){return{}}Cr.parseAnyDef=Ho;var Bt={},Fe={};Object.defineProperty(Fe,"__esModule",{value:!0});Fe.setResponseValueAndErrors=Fe.addErrorMessage=void 0;function Is(n,e,t,r){r!=null&&r.errorMessages&&t&&(n.errorMessage=Object.assign(Object.assign({},n.errorMessage),{[e]:t}))}Fe.addErrorMessage=Is;function Yo(n,e,t,r,a){n[e]=t,Is(n,e,r,a)}Fe.setResponseValueAndErrors=Yo;var zn;function Go(){if(zn)return Bt;zn=1,Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.parseArrayDef=void 0;const n=kn,e=Fe,t=Pe();function r(a,s){var i,o;const u={type:"array"};return((o=(i=a.type)===null||i===void 0?void 0:i._def)===null||o===void 0?void 0:o.typeName)!==n.ZodFirstPartyTypeKind.ZodAny&&(u.items=(0,t.parseDef)(a.type._def,Object.assign(Object.assign({},s),{currentPath:[...s.currentPath,"items"]}))),a.minLength&&(0,e.setResponseValueAndErrors)(u,"minItems",a.minLength.value,a.minLength.message,s),a.maxLength&&(0,e.setResponseValueAndErrors)(u,"maxItems",a.maxLength.value,a.maxLength.message,s),a.exactLength&&((0,e.setResponseValueAndErrors)(u,"minItems",a.exactLength.value,a.exactLength.message,s),(0,e.setResponseValueAndErrors)(u,"maxItems",a.exactLength.value,a.exactLength.message,s)),u}return Bt.parseArrayDef=r,Bt}var Dr={};Object.defineProperty(Dr,"__esModule",{value:!0});Dr.parseBigintDef=void 0;const lt=Fe;function Wo(n,e){const t={type:"integer",format:"int64"};if(!n.checks)return t;for(const r of n.checks)switch(r.kind){case"min":e.target==="jsonSchema7"?r.inclusive?(0,lt.setResponseValueAndErrors)(t,"minimum",r.value,r.message,e):(0,lt.setResponseValueAndErrors)(t,"exclusiveMinimum",r.value,r.message,e):(r.inclusive||(t.exclusiveMinimum=!0),(0,lt.setResponseValueAndErrors)(t,"minimum",r.value,r.message,e));break;case"max":e.target==="jsonSchema7"?r.inclusive?(0,lt.setResponseValueAndErrors)(t,"maximum",r.value,r.message,e):(0,lt.setResponseValueAndErrors)(t,"exclusiveMaximum",r.value,r.message,e):(r.inclusive||(t.exclusiveMaximum=!0),(0,lt.setResponseValueAndErrors)(t,"maximum",r.value,r.message,e));break;case"multipleOf":(0,lt.setResponseValueAndErrors)(t,"multipleOf",r.value,r.message,e);break}return t}Dr.parseBigintDef=Wo;var Mr={};Object.defineProperty(Mr,"__esModule",{value:!0});Mr.parseBooleanDef=void 0;function Jo(){return{type:"boolean"}}Mr.parseBooleanDef=Jo;var Ut={},Hn;function Qo(){if(Hn)return Ut;Hn=1,Object.defineProperty(Ut,"__esModule",{value:!0}),Ut.parseBrandedDef=void 0;const n=Pe();function e(t,r){return(0,n.parseDef)(t.type._def,r)}return Ut.parseBrandedDef=e,Ut}var Vt={},Yn;function Xo(){if(Yn)return Vt;Yn=1,Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.parseCatchDef=void 0;const n=Pe(),e=(t,r)=>(0,n.parseDef)(t.innerType._def,r);return Vt.parseCatchDef=e,Vt}var Nr={};Object.defineProperty(Nr,"__esModule",{value:!0});Nr.parseDateDef=void 0;const Gn=Fe;function eu(n,e){return e.dateStrategy=="integer"?tu(n,e):{type:"string",format:"date-time"}}Nr.parseDateDef=eu;const tu=(n,e)=>{const t={type:"integer",format:"unix-time"};for(const r of n.checks)switch(r.kind){case"min":e.target==="jsonSchema7"&&(0,Gn.setResponseValueAndErrors)(t,"minimum",r.value,r.message,e);break;case"max":e.target==="jsonSchema7"&&(0,Gn.setResponseValueAndErrors)(t,"maximum",r.value,r.message,e);break}return t};var $t={},Wn;function ru(){if(Wn)return $t;Wn=1,Object.defineProperty($t,"__esModule",{value:!0}),$t.parseDefaultDef=void 0;const n=Pe();function e(t,r){return Object.assign(Object.assign({},(0,n.parseDef)(t.innerType._def,r)),{default:t.defaultValue()})}return $t.parseDefaultDef=e,$t}var Ft={},Jn;function nu(){if(Jn)return Ft;Jn=1,Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.parseEffectsDef=void 0;const n=Pe();function e(t,r){return r.effectStrategy==="input"?(0,n.parseDef)(t.schema._def,r):{}}return Ft.parseEffectsDef=e,Ft}var Lr={};Object.defineProperty(Lr,"__esModule",{value:!0});Lr.parseEnumDef=void 0;function au(n){return{type:"string",enum:n.values}}Lr.parseEnumDef=au;var Kt={},Qn;function su(){if(Qn)return Kt;Qn=1;var n=Ln&&Ln.__rest||function(a,s){var i={};for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&s.indexOf(o)<0&&(i[o]=a[o]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,o=Object.getOwnPropertySymbols(a);u<o.length;u++)s.indexOf(o[u])<0&&Object.prototype.propertyIsEnumerable.call(a,o[u])&&(i[o[u]]=a[o[u]]);return i};Object.defineProperty(Kt,"__esModule",{value:!0}),Kt.parseIntersectionDef=void 0;const e=Pe(),t=a=>"type"in a&&a.type==="string"?!1:"allOf"in a;function r(a,s){const i=[(0,e.parseDef)(a.left._def,Object.assign(Object.assign({},s),{currentPath:[...s.currentPath,"allOf","0"]})),(0,e.parseDef)(a.right._def,Object.assign(Object.assign({},s),{currentPath:[...s.currentPath,"allOf","1"]}))].filter(c=>!!c);let o=s.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const u=[];return i.forEach(c=>{if(t(c))u.push(...c.allOf),c.unevaluatedProperties===void 0&&(o=void 0);else{let m=c;"additionalProperties"in c&&c.additionalProperties===!1?m=n(c,["additionalProperties"]):o=void 0,u.push(m)}}),u.length?Object.assign({allOf:u},o):void 0}return Kt.parseIntersectionDef=r,Kt}var Rr={};Object.defineProperty(Rr,"__esModule",{value:!0});Rr.parseLiteralDef=void 0;function iu(n,e){const t=typeof n.value;return t!=="bigint"&&t!=="number"&&t!=="boolean"&&t!=="string"?{type:Array.isArray(n.value)?"array":"object"}:e.target==="openApi3"?{type:t==="bigint"?"integer":t,enum:[n.value]}:{type:t==="bigint"?"integer":t,const:n.value}}Rr.parseLiteralDef=iu;var qt={},Xn;function ou(){if(Xn)return qt;Xn=1,Object.defineProperty(qt,"__esModule",{value:!0}),qt.parseMapDef=void 0;const n=Pe();function e(t,r){const a=(0,n.parseDef)(t.keyType._def,Object.assign(Object.assign({},r),{currentPath:[...r.currentPath,"items","items","0"]}))||{},s=(0,n.parseDef)(t.valueType._def,Object.assign(Object.assign({},r),{currentPath:[...r.currentPath,"items","items","1"]}))||{};return{type:"array",maxItems:125,items:{type:"array",items:[a,s],minItems:2,maxItems:2}}}return qt.parseMapDef=e,qt}var Zr={};Object.defineProperty(Zr,"__esModule",{value:!0});Zr.parseNativeEnumDef=void 0;function uu(n){const e=n.values,r=Object.keys(n.values).filter(s=>typeof e[e[s]]!="number").map(s=>e[s]),a=Array.from(new Set(r.map(s=>typeof s)));return{type:a.length===1?a[0]==="string"?"string":"number":["string","number"],enum:r}}Zr.parseNativeEnumDef=uu;var Br={};Object.defineProperty(Br,"__esModule",{value:!0});Br.parseNeverDef=void 0;function lu(){return{not:{}}}Br.parseNeverDef=lu;var Ur={};Object.defineProperty(Ur,"__esModule",{value:!0});Ur.parseNullDef=void 0;function cu(n){return n.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}Ur.parseNullDef=cu;var zt={},Gr={},ea;function Cs(){return ea||(ea=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.parseUnionDef=n.primitiveMappings=void 0;const e=Pe();n.primitiveMappings={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function t(a,s){if(s.target==="openApi3")return r(a,s);const i=a.options instanceof Map?Array.from(a.options.values()):a.options;if(i.every(o=>o._def.typeName in n.primitiveMappings&&(!o._def.checks||!o._def.checks.length))){const o=i.reduce((u,c)=>{const m=n.primitiveMappings[c._def.typeName];return m&&!u.includes(m)?[...u,m]:u},[]);return{type:o.length>1?o:o[0]}}else if(i.every(o=>o._def.typeName==="ZodLiteral"&&!o.description)){const o=i.reduce((u,c)=>{const m=typeof c._def.value;switch(m){case"string":case"number":case"boolean":return[...u,m];case"bigint":return[...u,"integer"];case"object":if(c._def.value===null)return[...u,"null"];case"symbol":case"undefined":case"function":default:return u}},[]);if(o.length===i.length){const u=o.filter((c,m,k)=>k.indexOf(c)===m);return{type:u.length>1?u:u[0],enum:i.reduce((c,m)=>c.includes(m._def.value)?c:[...c,m._def.value],[])}}}else if(i.every(o=>o._def.typeName==="ZodEnum"))return{type:"string",enum:i.reduce((o,u)=>[...o,...u._def.values.filter(c=>!o.includes(c))],[])};return r(a,s)}n.parseUnionDef=t;const r=(a,s)=>{const i=(a.options instanceof Map?Array.from(a.options.values()):a.options).map((o,u)=>(0,e.parseDef)(o._def,Object.assign(Object.assign({},s),{currentPath:[...s.currentPath,"anyOf",`${u}`]}))).filter(o=>!!o&&(!s.strictUnions||typeof o=="object"&&Object.keys(o).length>0));return i.length?{anyOf:i}:void 0}}(Gr)),Gr}var ta;function du(){if(ta)return zt;ta=1,Object.defineProperty(zt,"__esModule",{value:!0}),zt.parseNullableDef=void 0;const n=Pe(),e=Cs();function t(r,a){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(r.innerType._def.typeName)&&(!r.innerType._def.checks||!r.innerType._def.checks.length))return a.target==="openApi3"?{type:e.primitiveMappings[r.innerType._def.typeName],nullable:!0}:{type:[e.primitiveMappings[r.innerType._def.typeName],"null"]};if(a.target==="openApi3"){const i=(0,n.parseDef)(r.innerType._def,Object.assign(Object.assign({},a),{currentPath:[...a.currentPath]}));return i&&Object.assign(Object.assign({},i),{nullable:!0})}const s=(0,n.parseDef)(r.innerType._def,Object.assign(Object.assign({},a),{currentPath:[...a.currentPath,"anyOf","0"]}));return s&&{anyOf:[s,{type:"null"}]}}return zt.parseNullableDef=t,zt}var Vr={};Object.defineProperty(Vr,"__esModule",{value:!0});Vr.parseNumberDef=void 0;const nt=Fe;function hu(n,e){const t={type:"number"};if(!n.checks)return t;for(const r of n.checks)switch(r.kind){case"int":t.type="integer",(0,nt.addErrorMessage)(t,"type",r.message,e);break;case"min":e.target==="jsonSchema7"?r.inclusive?(0,nt.setResponseValueAndErrors)(t,"minimum",r.value,r.message,e):(0,nt.setResponseValueAndErrors)(t,"exclusiveMinimum",r.value,r.message,e):(r.inclusive||(t.exclusiveMinimum=!0),(0,nt.setResponseValueAndErrors)(t,"minimum",r.value,r.message,e));break;case"max":e.target==="jsonSchema7"?r.inclusive?(0,nt.setResponseValueAndErrors)(t,"maximum",r.value,r.message,e):(0,nt.setResponseValueAndErrors)(t,"exclusiveMaximum",r.value,r.message,e):(r.inclusive||(t.exclusiveMaximum=!0),(0,nt.setResponseValueAndErrors)(t,"maximum",r.value,r.message,e));break;case"multipleOf":(0,nt.setResponseValueAndErrors)(t,"multipleOf",r.value,r.message,e);break}return t}Vr.parseNumberDef=hu;var ct={},ra;function fu(){if(ra)return ct;ra=1,Object.defineProperty(ct,"__esModule",{value:!0}),ct.parseObjectDef=ct.parseObjectDefX=void 0;const n=Pe();function e(r,a){var s,i;Object.keys(r.shape()).reduce((u,c)=>{let m=r.shape()[c];const k=m.isOptional();k||(m=Object.assign({},m._def.innerSchema));const M=(0,n.parseDef)(m._def,Object.assign(Object.assign({},a),{currentPath:[...a.currentPath,"properties",c],propertyPath:[...a.currentPath,"properties",c]}));return M!==void 0&&(u.properties[c]=M,k||(u.required||(u.required=[]),u.required.push(c))),u},{type:"object",properties:{},additionalProperties:r.catchall._def.typeName==="ZodNever"?r.unknownKeys==="passthrough":(s=(0,n.parseDef)(r.catchall._def,Object.assign(Object.assign({},a),{currentPath:[...a.currentPath,"additionalProperties"]})))!==null&&s!==void 0?s:!0});const o=Object.assign(Object.assign({type:"object"},Object.entries(r.shape()).reduce((u,[c,m])=>{if(m===void 0||m._def===void 0)return u;const k=(0,n.parseDef)(m._def,Object.assign(Object.assign({},a),{currentPath:[...a.currentPath,"properties",c],propertyPath:[...a.currentPath,"properties",c]}));return k===void 0?u:{properties:Object.assign(Object.assign({},u.properties),{[c]:k}),required:m.isOptional()?u.required:[...u.required,c]}},{properties:{},required:[]})),{additionalProperties:r.catchall._def.typeName==="ZodNever"?r.unknownKeys==="passthrough":(i=(0,n.parseDef)(r.catchall._def,Object.assign(Object.assign({},a),{currentPath:[...a.currentPath,"additionalProperties"]})))!==null&&i!==void 0?i:!0});return o.required.length||delete o.required,o}ct.parseObjectDefX=e;function t(r,a){var s;const i=Object.assign(Object.assign({type:"object"},Object.entries(r.shape()).reduce((o,[u,c])=>{if(c===void 0||c._def===void 0)return o;const m=(0,n.parseDef)(c._def,Object.assign(Object.assign({},a),{currentPath:[...a.currentPath,"properties",u],propertyPath:[...a.currentPath,"properties",u]}));return m===void 0?o:{properties:Object.assign(Object.assign({},o.properties),{[u]:m}),required:c.isOptional()?o.required:[...o.required,u]}},{properties:{},required:[]})),{additionalProperties:r.catchall._def.typeName==="ZodNever"?r.unknownKeys==="passthrough":(s=(0,n.parseDef)(r.catchall._def,Object.assign(Object.assign({},a),{currentPath:[...a.currentPath,"additionalProperties"]})))!==null&&s!==void 0?s:!0});return i.required.length||delete i.required,i}return ct.parseObjectDef=t,ct}var Ht={},na;function pu(){if(na)return Ht;na=1,Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.parseOptionalDef=void 0;const n=Pe(),e=(t,r)=>{var a;if(r.currentPath.toString()===((a=r.propertyPath)===null||a===void 0?void 0:a.toString()))return(0,n.parseDef)(t.innerType._def,r);const s=(0,n.parseDef)(t.innerType._def,Object.assign(Object.assign({},r),{currentPath:[...r.currentPath,"anyOf","1"]}));return s?{anyOf:[{not:{}},s]}:{}};return Ht.parseOptionalDef=e,Ht}var Yt={},aa;function mu(){if(aa)return Yt;aa=1,Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.parsePipelineDef=void 0;const n=Pe(),e=(t,r)=>{if(r.pipeStrategy==="input")return(0,n.parseDef)(t.in._def,r);const a=(0,n.parseDef)(t.in._def,Object.assign(Object.assign({},r),{currentPath:[...r.currentPath,"allOf","0"]})),s=(0,n.parseDef)(t.out._def,Object.assign(Object.assign({},r),{currentPath:[...r.currentPath,"allOf",a?"1":"0"]}));return{allOf:[a,s].filter(i=>i!==void 0)}};return Yt.parsePipelineDef=e,Yt}var Gt={},sa;function gu(){if(sa)return Gt;sa=1,Object.defineProperty(Gt,"__esModule",{value:!0}),Gt.parsePromiseDef=void 0;const n=Pe();function e(t,r){return(0,n.parseDef)(t.type._def,r)}return Gt.parsePromiseDef=e,Gt}var Wt={},En={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.parseStringDef=n.emojiPattern=n.ulidPattern=n.cuid2Pattern=n.cuidPattern=n.emailPattern=void 0;const e=Fe;n.emailPattern='^(([^<>()[\\]\\\\.,;:\\s@\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\"]+)*)|(\\".+\\"))@((\\[(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\])|(\\[IPv6:(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))\\])|([A-Za-z0-9]([A-Za-z0-9-]*[A-Za-z0-9])*(\\.[A-Za-z]{2,})+))$',n.cuidPattern="^c[^\\s-]{8,}$",n.cuid2Pattern="^[a-z][a-z0-9]*$",n.ulidPattern="/[0-9A-HJKMNP-TV-Z]{26}/",n.emojiPattern="/^(p{Extended_Pictographic}|p{Emoji_Component})+$/u";function t(i,o){const u={type:"string"};if(i.checks)for(const c of i.checks)switch(c.kind){case"min":(0,e.setResponseValueAndErrors)(u,"minLength",typeof u.minLength=="number"?Math.max(u.minLength,c.value):c.value,c.message,o);break;case"max":(0,e.setResponseValueAndErrors)(u,"maxLength",typeof u.maxLength=="number"?Math.min(u.maxLength,c.value):c.value,c.message,o);break;case"email":switch(o.emailStrategy){case"format:email":a(u,"email",c.message,o);break;case"format:idn-email":a(u,"idn-email",c.message,o);break;case"pattern:zod":s(u,n.emailPattern,c.message,o);break}break;case"url":a(u,"uri",c.message,o);break;case"uuid":a(u,"uuid",c.message,o);break;case"regex":s(u,c.regex.source,c.message,o);break;case"cuid":s(u,n.cuidPattern,c.message,o);break;case"cuid2":s(u,n.cuid2Pattern,c.message,o);break;case"startsWith":s(u,"^"+r(c.value),c.message,o);break;case"endsWith":s(u,r(c.value)+"$",c.message,o);break;case"datetime":a(u,"date-time",c.message,o);break;case"length":(0,e.setResponseValueAndErrors)(u,"minLength",typeof u.minLength=="number"?Math.max(u.minLength,c.value):c.value,c.message,o),(0,e.setResponseValueAndErrors)(u,"maxLength",typeof u.maxLength=="number"?Math.min(u.maxLength,c.value):c.value,c.message,o);break;case"includes":{s(u,r(c.value),c.message,o);break}case"ip":{c.version!=="v6"&&a(u,"ipv4",c.message,o),c.version!=="v4"&&a(u,"ipv6",c.message,o);break}case"emoji":s(u,n.emojiPattern,c.message,o);break;case"ulid":{s(u,n.ulidPattern,c.message,o);break}}return u}n.parseStringDef=t;const r=i=>Array.from(i).map(o=>/[a-zA-Z0-9]/.test(o)?o:`\\${o}`).join(""),a=(i,o,u,c)=>{var m;i.format||!((m=i.anyOf)===null||m===void 0)&&m.some(k=>k.format)?(i.anyOf||(i.anyOf=[]),i.format&&(i.anyOf.push(Object.assign({format:i.format},i.errorMessage&&c.errorMessages&&{errorMessage:{format:i.errorMessage.format}})),delete i.format,i.errorMessage&&(delete i.errorMessage.format,Object.keys(i.errorMessage).length===0&&delete i.errorMessage)),i.anyOf.push(Object.assign({format:o},u&&c.errorMessages&&{errorMessage:{format:u}}))):(0,e.setResponseValueAndErrors)(i,"format",o,u,c)},s=(i,o,u,c)=>{var m;i.pattern||!((m=i.allOf)===null||m===void 0)&&m.some(k=>k.pattern)?(i.allOf||(i.allOf=[]),i.pattern&&(i.allOf.push(Object.assign({pattern:i.pattern},i.errorMessage&&c.errorMessages&&{errorMessage:{pattern:i.errorMessage.pattern}})),delete i.pattern,i.errorMessage&&(delete i.errorMessage.pattern,Object.keys(i.errorMessage).length===0&&delete i.errorMessage)),i.allOf.push(Object.assign({pattern:o},u&&c.errorMessages&&{errorMessage:{pattern:u}}))):(0,e.setResponseValueAndErrors)(i,"pattern",o,u,c)}})(En);var ia;function yu(){if(ia)return Wt;ia=1,Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.parseRecordDef=void 0;const n=kn,e=Pe(),t=En;function r(a,s){var i,o,u,c,m;if(s.target==="openApi3"&&((i=a.keyType)===null||i===void 0?void 0:i._def.typeName)===n.ZodFirstPartyTypeKind.ZodEnum)return{type:"object",required:a.keyType._def.values,properties:a.keyType._def.values.reduce((M,q)=>{var x;return Object.assign(Object.assign({},M),{[q]:(x=(0,e.parseDef)(a.valueType._def,Object.assign(Object.assign({},s),{currentPath:[...s.currentPath,"properties",q]})))!==null&&x!==void 0?x:{}})},{}),additionalProperties:!1};const k={type:"object",additionalProperties:(o=(0,e.parseDef)(a.valueType._def,Object.assign(Object.assign({},s),{currentPath:[...s.currentPath,"additionalProperties"]})))!==null&&o!==void 0?o:{}};if(s.target==="openApi3")return k;if(((u=a.keyType)===null||u===void 0?void 0:u._def.typeName)===n.ZodFirstPartyTypeKind.ZodString&&(!((c=a.keyType._def.checks)===null||c===void 0)&&c.length)){const M=Object.entries((0,t.parseStringDef)(a.keyType._def,s)).reduce((q,[x,N])=>x==="type"?q:Object.assign(Object.assign({},q),{[x]:N}),{});return Object.assign(Object.assign({},k),{propertyNames:M})}else if(((m=a.keyType)===null||m===void 0?void 0:m._def.typeName)===n.ZodFirstPartyTypeKind.ZodEnum)return Object.assign(Object.assign({},k),{propertyNames:{enum:a.keyType._def.values}});return k}return Wt.parseRecordDef=r,Wt}var Jt={},oa;function _u(){if(oa)return Jt;oa=1,Object.defineProperty(Jt,"__esModule",{value:!0}),Jt.parseSetDef=void 0;const n=Fe,e=Pe();function t(r,a){const i={type:"array",uniqueItems:!0,items:(0,e.parseDef)(r.valueType._def,Object.assign(Object.assign({},a),{currentPath:[...a.currentPath,"items"]}))};return r.minSize&&(0,n.setResponseValueAndErrors)(i,"minItems",r.minSize.value,r.minSize.message,a),r.maxSize&&(0,n.setResponseValueAndErrors)(i,"maxItems",r.maxSize.value,r.maxSize.message,a),i}return Jt.parseSetDef=t,Jt}var Qt={},ua;function bu(){if(ua)return Qt;ua=1,Object.defineProperty(Qt,"__esModule",{value:!0}),Qt.parseTupleDef=void 0;const n=Pe();function e(t,r){return t.rest?{type:"array",minItems:t.items.length,items:t.items.map((a,s)=>(0,n.parseDef)(a._def,Object.assign(Object.assign({},r),{currentPath:[...r.currentPath,"items",`${s}`]}))).reduce((a,s)=>s===void 0?a:[...a,s],[]),additionalItems:(0,n.parseDef)(t.rest._def,Object.assign(Object.assign({},r),{currentPath:[...r.currentPath,"additionalItems"]}))}:{type:"array",minItems:t.items.length,maxItems:t.items.length,items:t.items.map((a,s)=>(0,n.parseDef)(a._def,Object.assign(Object.assign({},r),{currentPath:[...r.currentPath,"items",`${s}`]}))).reduce((a,s)=>s===void 0?a:[...a,s],[])}}return Qt.parseTupleDef=e,Qt}var $r={};Object.defineProperty($r,"__esModule",{value:!0});$r.parseUndefinedDef=void 0;function vu(){return{not:{}}}$r.parseUndefinedDef=vu;var Fr={};Object.defineProperty(Fr,"__esModule",{value:!0});Fr.parseUnknownDef=void 0;function wu(){return{}}Fr.parseUnknownDef=wu;var la;function Pe(){if(la)return Zt;la=1,Object.defineProperty(Zt,"__esModule",{value:!0}),Zt.parseDef=void 0;const n=kn,e=Cr,t=Go(),r=Dr,a=Mr,s=Qo(),i=Xo(),o=Nr,u=ru(),c=nu(),m=Lr,k=su(),M=Rr,q=ou(),x=Zr,N=Br,b=Ur,O=du(),j=Vr,S=fu(),P=pu(),F=mu(),y=gu(),w=yu(),h=_u(),p=En,d=bu(),_=$r,v=Cs(),$=Fr;function K(E,L,Z=!1){const ie=L.seen.get(E);if(ie&&!Z){const oe=z(ie,L);if(oe!==void 0)return oe}const pe={def:E,path:L.currentPath,jsonSchema:void 0};L.seen.set(E,pe);const T=W(E,E.typeName,L);return T&&de(E,L,T),pe.jsonSchema=T,T}Zt.parseDef=K;const z=(E,L)=>{switch(L.$refStrategy){case"root":return{$ref:E.path.length===0?"":E.path.length===1?`${E.path[0]}/`:E.path.join("/")};case"relative":return{$ref:R(L.currentPath,E.path)};case"none":return E.path.length<L.currentPath.length&&E.path.every((Z,ie)=>L.currentPath[ie]===Z)?(console.warn(`Recursive reference detected at ${L.currentPath.join("/")}! Defaulting to any`),{}):void 0;case"seen":return E.path.length<L.currentPath.length&&E.path.every((Z,ie)=>L.currentPath[ie]===Z)?(console.warn(`Recursive reference detected at ${L.currentPath.join("/")}! Defaulting to any`),{}):E.jsonSchema}},R=(E,L)=>{let Z=0;for(;Z<E.length&&Z<L.length&&E[Z]===L[Z];Z++);return[(E.length-Z).toString(),...L.slice(Z)].join("/")},W=(E,L,Z)=>{switch(L){case n.ZodFirstPartyTypeKind.ZodString:return(0,p.parseStringDef)(E,Z);case n.ZodFirstPartyTypeKind.ZodNumber:return(0,j.parseNumberDef)(E,Z);case n.ZodFirstPartyTypeKind.ZodObject:return(0,S.parseObjectDef)(E,Z);case n.ZodFirstPartyTypeKind.ZodBigInt:return(0,r.parseBigintDef)(E,Z);case n.ZodFirstPartyTypeKind.ZodBoolean:return(0,a.parseBooleanDef)();case n.ZodFirstPartyTypeKind.ZodDate:return(0,o.parseDateDef)(E,Z);case n.ZodFirstPartyTypeKind.ZodUndefined:return(0,_.parseUndefinedDef)();case n.ZodFirstPartyTypeKind.ZodNull:return(0,b.parseNullDef)(Z);case n.ZodFirstPartyTypeKind.ZodArray:return(0,t.parseArrayDef)(E,Z);case n.ZodFirstPartyTypeKind.ZodUnion:case n.ZodFirstPartyTypeKind.ZodDiscriminatedUnion:return(0,v.parseUnionDef)(E,Z);case n.ZodFirstPartyTypeKind.ZodIntersection:return(0,k.parseIntersectionDef)(E,Z);case n.ZodFirstPartyTypeKind.ZodTuple:return(0,d.parseTupleDef)(E,Z);case n.ZodFirstPartyTypeKind.ZodRecord:return(0,w.parseRecordDef)(E,Z);case n.ZodFirstPartyTypeKind.ZodLiteral:return(0,M.parseLiteralDef)(E,Z);case n.ZodFirstPartyTypeKind.ZodEnum:return(0,m.parseEnumDef)(E);case n.ZodFirstPartyTypeKind.ZodNativeEnum:return(0,x.parseNativeEnumDef)(E);case n.ZodFirstPartyTypeKind.ZodNullable:return(0,O.parseNullableDef)(E,Z);case n.ZodFirstPartyTypeKind.ZodOptional:return(0,P.parseOptionalDef)(E,Z);case n.ZodFirstPartyTypeKind.ZodMap:return(0,q.parseMapDef)(E,Z);case n.ZodFirstPartyTypeKind.ZodSet:return(0,h.parseSetDef)(E,Z);case n.ZodFirstPartyTypeKind.ZodLazy:return K(E.getter()._def,Z);case n.ZodFirstPartyTypeKind.ZodPromise:return(0,y.parsePromiseDef)(E,Z);case n.ZodFirstPartyTypeKind.ZodNaN:case n.ZodFirstPartyTypeKind.ZodNever:return(0,N.parseNeverDef)();case n.ZodFirstPartyTypeKind.ZodEffects:return(0,c.parseEffectsDef)(E,Z);case n.ZodFirstPartyTypeKind.ZodAny:return(0,e.parseAnyDef)();case n.ZodFirstPartyTypeKind.ZodUnknown:return(0,$.parseUnknownDef)();case n.ZodFirstPartyTypeKind.ZodDefault:return(0,u.parseDefaultDef)(E,Z);case n.ZodFirstPartyTypeKind.ZodBranded:return(0,s.parseBrandedDef)(E,Z);case n.ZodFirstPartyTypeKind.ZodCatch:return(0,i.parseCatchDef)(E,Z);case n.ZodFirstPartyTypeKind.ZodPipeline:return(0,F.parsePipelineDef)(E,Z);case n.ZodFirstPartyTypeKind.ZodFunction:case n.ZodFirstPartyTypeKind.ZodVoid:case n.ZodFirstPartyTypeKind.ZodSymbol:return;default:return(ie=>{})()}},de=(E,L,Z)=>(E.description&&(Z.description=E.description,L.markdownDescription&&(Z.markdownDescription=E.description)),Z);return Zt}var Kr={},Ds={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.getDefaultOptions=n.defaultOptions=void 0,n.defaultOptions={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"string",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,emailStrategy:"format:email"};const e=t=>typeof t=="string"?Object.assign(Object.assign({},n.defaultOptions),{name:t}):Object.assign(Object.assign({},n.defaultOptions),t);n.getDefaultOptions=e})(Ds);Object.defineProperty(Kr,"__esModule",{value:!0});Kr.getRefs=void 0;const xu=Ds,ku=n=>{const e=(0,xu.getDefaultOptions)(n),t=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return Object.assign(Object.assign({},e),{currentPath:t,propertyPath:void 0,seen:new Map(Object.entries(e.definitions).map(([r,a])=>[a._def,{def:a._def,path:[...e.basePath,e.definitionPath,r],jsonSchema:void 0}]))})};Kr.getRefs=ku;Object.defineProperty(Ir,"__esModule",{value:!0});Ir.zodToJsonSchema=void 0;const ca=Pe(),Eu=Kr,Pu=(n,e)=>{var t;const r=(0,Eu.getRefs)(e),a=typeof e=="object"&&e.definitions?Object.entries(e.definitions).reduce((u,[c,m])=>{var k;return Object.assign(Object.assign({},u),{[c]:(k=(0,ca.parseDef)(m._def,Object.assign(Object.assign({},r),{currentPath:[...r.basePath,r.definitionPath,c]}),!0))!==null&&k!==void 0?k:{}})},{}):void 0,s=typeof e=="string"?e:e==null?void 0:e.name,i=(t=(0,ca.parseDef)(n._def,s===void 0?r:Object.assign(Object.assign({},r),{currentPath:[...r.basePath,r.definitionPath,s]}),!1))!==null&&t!==void 0?t:{},o=s===void 0?a?Object.assign(Object.assign({},i),{[r.definitionPath]:a}):i:{$ref:[...r.$refStrategy==="relative"?[]:r.basePath,r.definitionPath,s].join("/"),[r.definitionPath]:Object.assign(Object.assign({},a),{[s]:i})};return r.target==="jsonSchema7"?o.$schema="http://json-schema.org/draft-07/schema#":r.target==="jsonSchema2019-09"&&(o.$schema="https://json-schema.org/draft/2019-09/schema#"),o};Ir.zodToJsonSchema=Pu;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.zodToJsonSchema=void 0;const e=Ir;Object.defineProperty(n,"zodToJsonSchema",{enumerable:!0,get:function(){return e.zodToJsonSchema}}),n.default=e.zodToJsonSchema})(zo);/*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT */function Ms(n){return typeof n>"u"||n===null}function Ou(n){return typeof n=="object"&&n!==null}function Tu(n){return Array.isArray(n)?n:Ms(n)?[]:[n]}function Su(n,e){var t,r,a,s;if(e)for(s=Object.keys(e),t=0,r=s.length;t<r;t+=1)a=s[t],n[a]=e[a];return n}function ju(n,e){var t="",r;for(r=0;r<e;r+=1)t+=n;return t}function Au(n){return n===0&&Number.NEGATIVE_INFINITY===1/n}var Iu=Ms,Cu=Ou,Du=Tu,Mu=ju,Nu=Au,Lu=Su,Pn={isNothing:Iu,isObject:Cu,toArray:Du,repeat:Mu,isNegativeZero:Nu,extend:Lu};function Ns(n,e){var t="",r=n.reason||"(unknown reason)";return n.mark?(n.mark.name&&(t+='in "'+n.mark.name+'" '),t+="("+(n.mark.line+1)+":"+(n.mark.column+1)+")",!e&&n.mark.snippet&&(t+=`

`+n.mark.snippet),r+" "+t):r}function ur(n,e){Error.call(this),this.name="YAMLException",this.reason=n,this.mark=e,this.message=Ns(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}ur.prototype=Object.create(Error.prototype);ur.prototype.constructor=ur;ur.prototype.toString=function(e){return this.name+": "+Ns(this,e)};var ht=ur,Ru=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],Zu=["scalar","sequence","mapping"];function Bu(n){var e={};return n!==null&&Object.keys(n).forEach(function(t){n[t].forEach(function(r){e[String(r)]=t})}),e}function Uu(n,e){if(e=e||{},Object.keys(e).forEach(function(t){if(Ru.indexOf(t)===-1)throw new ht('Unknown option "'+t+'" is met in definition of "'+n+'" YAML type.')}),this.options=e,this.tag=n,this.kind=e.kind||null,this.resolve=e.resolve||function(){return!0},this.construct=e.construct||function(t){return t},this.instanceOf=e.instanceOf||null,this.predicate=e.predicate||null,this.represent=e.represent||null,this.representName=e.representName||null,this.defaultStyle=e.defaultStyle||null,this.multi=e.multi||!1,this.styleAliases=Bu(e.styleAliases||null),Zu.indexOf(this.kind)===-1)throw new ht('Unknown kind "'+this.kind+'" is specified for "'+n+'" YAML type.')}var Oe=Uu;function da(n,e){var t=[];return n[e].forEach(function(r){var a=t.length;t.forEach(function(s,i){s.tag===r.tag&&s.kind===r.kind&&s.multi===r.multi&&(a=i)}),t[a]=r}),t}function Vu(){var n={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},e,t;function r(a){a.multi?(n.multi[a.kind].push(a),n.multi.fallback.push(a)):n[a.kind][a.tag]=n.fallback[a.tag]=a}for(e=0,t=arguments.length;e<t;e+=1)arguments[e].forEach(r);return n}function tn(n){return this.extend(n)}tn.prototype.extend=function(e){var t=[],r=[];if(e instanceof Oe)r.push(e);else if(Array.isArray(e))r=r.concat(e);else if(e&&(Array.isArray(e.implicit)||Array.isArray(e.explicit)))e.implicit&&(t=t.concat(e.implicit)),e.explicit&&(r=r.concat(e.explicit));else throw new ht("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");t.forEach(function(s){if(!(s instanceof Oe))throw new ht("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(s.loadKind&&s.loadKind!=="scalar")throw new ht("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(s.multi)throw new ht("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),r.forEach(function(s){if(!(s instanceof Oe))throw new ht("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var a=Object.create(tn.prototype);return a.implicit=(this.implicit||[]).concat(t),a.explicit=(this.explicit||[]).concat(r),a.compiledImplicit=da(a,"implicit"),a.compiledExplicit=da(a,"explicit"),a.compiledTypeMap=Vu(a.compiledImplicit,a.compiledExplicit),a};var $u=tn,Fu=new Oe("tag:yaml.org,2002:str",{kind:"scalar",construct:function(n){return n!==null?n:""}}),Ku=new Oe("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(n){return n!==null?n:[]}}),qu=new Oe("tag:yaml.org,2002:map",{kind:"mapping",construct:function(n){return n!==null?n:{}}}),zu=new $u({explicit:[Fu,Ku,qu]});function Hu(n){if(n===null)return!0;var e=n.length;return e===1&&n==="~"||e===4&&(n==="null"||n==="Null"||n==="NULL")}function Yu(){return null}function Gu(n){return n===null}var Wu=new Oe("tag:yaml.org,2002:null",{kind:"scalar",resolve:Hu,construct:Yu,predicate:Gu,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});function Ju(n){if(n===null)return!1;var e=n.length;return e===4&&(n==="true"||n==="True"||n==="TRUE")||e===5&&(n==="false"||n==="False"||n==="FALSE")}function Qu(n){return n==="true"||n==="True"||n==="TRUE"}function Xu(n){return Object.prototype.toString.call(n)==="[object Boolean]"}var el=new Oe("tag:yaml.org,2002:bool",{kind:"scalar",resolve:Ju,construct:Qu,predicate:Xu,represent:{lowercase:function(n){return n?"true":"false"},uppercase:function(n){return n?"TRUE":"FALSE"},camelcase:function(n){return n?"True":"False"}},defaultStyle:"lowercase"});function tl(n){return 48<=n&&n<=57||65<=n&&n<=70||97<=n&&n<=102}function rl(n){return 48<=n&&n<=55}function nl(n){return 48<=n&&n<=57}function al(n){if(n===null)return!1;var e=n.length,t=0,r=!1,a;if(!e)return!1;if(a=n[t],(a==="-"||a==="+")&&(a=n[++t]),a==="0"){if(t+1===e)return!0;if(a=n[++t],a==="b"){for(t++;t<e;t++)if(a=n[t],a!=="_"){if(a!=="0"&&a!=="1")return!1;r=!0}return r&&a!=="_"}if(a==="x"){for(t++;t<e;t++)if(a=n[t],a!=="_"){if(!tl(n.charCodeAt(t)))return!1;r=!0}return r&&a!=="_"}if(a==="o"){for(t++;t<e;t++)if(a=n[t],a!=="_"){if(!rl(n.charCodeAt(t)))return!1;r=!0}return r&&a!=="_"}}if(a==="_")return!1;for(;t<e;t++)if(a=n[t],a!=="_"){if(!nl(n.charCodeAt(t)))return!1;r=!0}return!(!r||a==="_")}function sl(n){var e=n,t=1,r;if(e.indexOf("_")!==-1&&(e=e.replace(/_/g,"")),r=e[0],(r==="-"||r==="+")&&(r==="-"&&(t=-1),e=e.slice(1),r=e[0]),e==="0")return 0;if(r==="0"){if(e[1]==="b")return t*parseInt(e.slice(2),2);if(e[1]==="x")return t*parseInt(e.slice(2),16);if(e[1]==="o")return t*parseInt(e.slice(2),8)}return t*parseInt(e,10)}function il(n){return Object.prototype.toString.call(n)==="[object Number]"&&n%1===0&&!Pn.isNegativeZero(n)}var ol=new Oe("tag:yaml.org,2002:int",{kind:"scalar",resolve:al,construct:sl,predicate:il,represent:{binary:function(n){return n>=0?"0b"+n.toString(2):"-0b"+n.toString(2).slice(1)},octal:function(n){return n>=0?"0o"+n.toString(8):"-0o"+n.toString(8).slice(1)},decimal:function(n){return n.toString(10)},hexadecimal:function(n){return n>=0?"0x"+n.toString(16).toUpperCase():"-0x"+n.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),ul=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function ll(n){return!(n===null||!ul.test(n)||n[n.length-1]==="_")}function cl(n){var e,t;return e=n.replace(/_/g,"").toLowerCase(),t=e[0]==="-"?-1:1,"+-".indexOf(e[0])>=0&&(e=e.slice(1)),e===".inf"?t===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:e===".nan"?NaN:t*parseFloat(e,10)}var dl=/^[-+]?[0-9]+e/;function hl(n,e){var t;if(isNaN(n))switch(e){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===n)switch(e){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===n)switch(e){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(Pn.isNegativeZero(n))return"-0.0";return t=n.toString(10),dl.test(t)?t.replace("e",".e"):t}function fl(n){return Object.prototype.toString.call(n)==="[object Number]"&&(n%1!==0||Pn.isNegativeZero(n))}var pl=new Oe("tag:yaml.org,2002:float",{kind:"scalar",resolve:ll,construct:cl,predicate:fl,represent:hl,defaultStyle:"lowercase"}),ml=zu.extend({implicit:[Wu,el,ol,pl]}),gl=ml,Ls=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),Rs=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function yl(n){return n===null?!1:Ls.exec(n)!==null||Rs.exec(n)!==null}function _l(n){var e,t,r,a,s,i,o,u=0,c=null,m,k,M;if(e=Ls.exec(n),e===null&&(e=Rs.exec(n)),e===null)throw new Error("Date resolve error");if(t=+e[1],r=+e[2]-1,a=+e[3],!e[4])return new Date(Date.UTC(t,r,a));if(s=+e[4],i=+e[5],o=+e[6],e[7]){for(u=e[7].slice(0,3);u.length<3;)u+="0";u=+u}return e[9]&&(m=+e[10],k=+(e[11]||0),c=(m*60+k)*6e4,e[9]==="-"&&(c=-c)),M=new Date(Date.UTC(t,r,a,s,i,o,u)),c&&M.setTime(M.getTime()-c),M}function bl(n){return n.toISOString()}var vl=new Oe("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:yl,construct:_l,instanceOf:Date,represent:bl});function wl(n){return n==="<<"||n===null}var xl=new Oe("tag:yaml.org,2002:merge",{kind:"scalar",resolve:wl}),On=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function kl(n){if(n===null)return!1;var e,t,r=0,a=n.length,s=On;for(t=0;t<a;t++)if(e=s.indexOf(n.charAt(t)),!(e>64)){if(e<0)return!1;r+=6}return r%8===0}function El(n){var e,t,r=n.replace(/[\r\n=]/g,""),a=r.length,s=On,i=0,o=[];for(e=0;e<a;e++)e%4===0&&e&&(o.push(i>>16&255),o.push(i>>8&255),o.push(i&255)),i=i<<6|s.indexOf(r.charAt(e));return t=a%4*6,t===0?(o.push(i>>16&255),o.push(i>>8&255),o.push(i&255)):t===18?(o.push(i>>10&255),o.push(i>>2&255)):t===12&&o.push(i>>4&255),new Uint8Array(o)}function Pl(n){var e="",t=0,r,a,s=n.length,i=On;for(r=0;r<s;r++)r%3===0&&r&&(e+=i[t>>18&63],e+=i[t>>12&63],e+=i[t>>6&63],e+=i[t&63]),t=(t<<8)+n[r];return a=s%3,a===0?(e+=i[t>>18&63],e+=i[t>>12&63],e+=i[t>>6&63],e+=i[t&63]):a===2?(e+=i[t>>10&63],e+=i[t>>4&63],e+=i[t<<2&63],e+=i[64]):a===1&&(e+=i[t>>2&63],e+=i[t<<4&63],e+=i[64],e+=i[64]),e}function Ol(n){return Object.prototype.toString.call(n)==="[object Uint8Array]"}var Tl=new Oe("tag:yaml.org,2002:binary",{kind:"scalar",resolve:kl,construct:El,predicate:Ol,represent:Pl}),Sl=Object.prototype.hasOwnProperty,jl=Object.prototype.toString;function Al(n){if(n===null)return!0;var e=[],t,r,a,s,i,o=n;for(t=0,r=o.length;t<r;t+=1){if(a=o[t],i=!1,jl.call(a)!=="[object Object]")return!1;for(s in a)if(Sl.call(a,s))if(!i)i=!0;else return!1;if(!i)return!1;if(e.indexOf(s)===-1)e.push(s);else return!1}return!0}function Il(n){return n!==null?n:[]}var Cl=new Oe("tag:yaml.org,2002:omap",{kind:"sequence",resolve:Al,construct:Il}),Dl=Object.prototype.toString;function Ml(n){if(n===null)return!0;var e,t,r,a,s,i=n;for(s=new Array(i.length),e=0,t=i.length;e<t;e+=1){if(r=i[e],Dl.call(r)!=="[object Object]"||(a=Object.keys(r),a.length!==1))return!1;s[e]=[a[0],r[a[0]]]}return!0}function Nl(n){if(n===null)return[];var e,t,r,a,s,i=n;for(s=new Array(i.length),e=0,t=i.length;e<t;e+=1)r=i[e],a=Object.keys(r),s[e]=[a[0],r[a[0]]];return s}var Ll=new Oe("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:Ml,construct:Nl}),Rl=Object.prototype.hasOwnProperty;function Zl(n){if(n===null)return!0;var e,t=n;for(e in t)if(Rl.call(t,e)&&t[e]!==null)return!1;return!0}function Bl(n){return n!==null?n:{}}var Ul=new Oe("tag:yaml.org,2002:set",{kind:"mapping",resolve:Zl,construct:Bl});gl.extend({implicit:[vl,xl],explicit:[Tl,Cl,Ll,Ul]});function ha(n){return n===48?"\0":n===97?"\x07":n===98?"\b":n===116||n===9?"	":n===110?`
`:n===118?"\v":n===102?"\f":n===114?"\r":n===101?"\x1B":n===32?" ":n===34?'"':n===47?"/":n===92?"\\":n===78?"":n===95?"":n===76?"\u2028":n===80?"\u2029":""}var Vl=new Array(256),$l=new Array(256);for(var _t=0;_t<256;_t++)Vl[_t]=ha(_t)?1:0,$l[_t]=ha(_t);var Zs={exports:{}};(function(n,e){(function(t){n.exports=t()})(function(){return function t(r,a,s){function i(c,m){if(!a[c]){if(!r[c]){var k=typeof pr=="function"&&pr;if(!m&&k)return k(c,!0);if(o)return o(c,!0);throw new Error("Cannot find module '"+c+"'")}m=a[c]={exports:{}},r[c][0].call(m.exports,function(M){var q=r[c][1][M];return i(q||M)},m,m.exports,t,r,a,s)}return a[c].exports}for(var o=typeof pr=="function"&&pr,u=0;u<s.length;u++)i(s[u]);return i}({1:[function(t,r,a){(function(s,i,o,u,c,m,k,M,q){var x=t("crypto");function N(y,w){w=j(y,w);var h;return(h=w.algorithm!=="passthrough"?x.createHash(w.algorithm):new F).write===void 0&&(h.write=h.update,h.end=h.update),P(w,h).dispatch(y),h.update||h.end(""),h.digest?h.digest(w.encoding==="buffer"?void 0:w.encoding):(y=h.read(),w.encoding!=="buffer"?y.toString(w.encoding):y)}(a=r.exports=N).sha1=function(y){return N(y)},a.keys=function(y){return N(y,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})},a.MD5=function(y){return N(y,{algorithm:"md5",encoding:"hex"})},a.keysMD5=function(y){return N(y,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var b=x.getHashes?x.getHashes().slice():["sha1","md5"],O=(b.push("passthrough"),["buffer","hex","binary","base64"]);function j(y,w){var h={};if(h.algorithm=(w=w||{}).algorithm||"sha1",h.encoding=w.encoding||"hex",h.excludeValues=!!w.excludeValues,h.algorithm=h.algorithm.toLowerCase(),h.encoding=h.encoding.toLowerCase(),h.ignoreUnknown=w.ignoreUnknown===!0,h.respectType=w.respectType!==!1,h.respectFunctionNames=w.respectFunctionNames!==!1,h.respectFunctionProperties=w.respectFunctionProperties!==!1,h.unorderedArrays=w.unorderedArrays===!0,h.unorderedSets=w.unorderedSets!==!1,h.unorderedObjects=w.unorderedObjects!==!1,h.replacer=w.replacer||void 0,h.excludeKeys=w.excludeKeys||void 0,y===void 0)throw new Error("Object argument required.");for(var p=0;p<b.length;++p)b[p].toLowerCase()===h.algorithm.toLowerCase()&&(h.algorithm=b[p]);if(b.indexOf(h.algorithm)===-1)throw new Error('Algorithm "'+h.algorithm+'"  not supported. supported values: '+b.join(", "));if(O.indexOf(h.encoding)===-1&&h.algorithm!=="passthrough")throw new Error('Encoding "'+h.encoding+'"  not supported. supported values: '+O.join(", "));return h}function S(y){if(typeof y=="function")return/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(y))!=null}function P(y,w,h){h=h||[];function p(d){return w.update?w.update(d,"utf8"):w.write(d,"utf8")}return{dispatch:function(d){return this["_"+((d=y.replacer?y.replacer(d):d)===null?"null":typeof d)](d)},_object:function(d){var _,v=Object.prototype.toString.call(d),$=/\[object (.*)\]/i.exec(v);if($=($=$?$[1]:"unknown:["+v+"]").toLowerCase(),0<=(v=h.indexOf(d)))return this.dispatch("[CIRCULAR:"+v+"]");if(h.push(d),o!==void 0&&o.isBuffer&&o.isBuffer(d))return p("buffer:"),p(d);if($==="object"||$==="function"||$==="asyncfunction")return v=Object.keys(d),y.unorderedObjects&&(v=v.sort()),y.respectType===!1||S(d)||v.splice(0,0,"prototype","__proto__","constructor"),y.excludeKeys&&(v=v.filter(function(K){return!y.excludeKeys(K)})),p("object:"+v.length+":"),_=this,v.forEach(function(K){_.dispatch(K),p(":"),y.excludeValues||_.dispatch(d[K]),p(",")});if(!this["_"+$]){if(y.ignoreUnknown)return p("["+$+"]");throw new Error('Unknown object type "'+$+'"')}this["_"+$](d)},_array:function(d,K){K=K!==void 0?K:y.unorderedArrays!==!1;var v=this;if(p("array:"+d.length+":"),!K||d.length<=1)return d.forEach(function(z){return v.dispatch(z)});var $=[],K=d.map(function(z){var R=new F,W=h.slice();return P(y,R,W).dispatch(z),$=$.concat(W.slice(h.length)),R.read().toString()});return h=h.concat($),K.sort(),this._array(K,!1)},_date:function(d){return p("date:"+d.toJSON())},_symbol:function(d){return p("symbol:"+d.toString())},_error:function(d){return p("error:"+d.toString())},_boolean:function(d){return p("bool:"+d.toString())},_string:function(d){p("string:"+d.length+":"),p(d.toString())},_function:function(d){p("fn:"),S(d)?this.dispatch("[native]"):this.dispatch(d.toString()),y.respectFunctionNames!==!1&&this.dispatch("function-name:"+String(d.name)),y.respectFunctionProperties&&this._object(d)},_number:function(d){return p("number:"+d.toString())},_xml:function(d){return p("xml:"+d.toString())},_null:function(){return p("Null")},_undefined:function(){return p("Undefined")},_regexp:function(d){return p("regex:"+d.toString())},_uint8array:function(d){return p("uint8array:"),this.dispatch(Array.prototype.slice.call(d))},_uint8clampedarray:function(d){return p("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(d))},_int8array:function(d){return p("int8array:"),this.dispatch(Array.prototype.slice.call(d))},_uint16array:function(d){return p("uint16array:"),this.dispatch(Array.prototype.slice.call(d))},_int16array:function(d){return p("int16array:"),this.dispatch(Array.prototype.slice.call(d))},_uint32array:function(d){return p("uint32array:"),this.dispatch(Array.prototype.slice.call(d))},_int32array:function(d){return p("int32array:"),this.dispatch(Array.prototype.slice.call(d))},_float32array:function(d){return p("float32array:"),this.dispatch(Array.prototype.slice.call(d))},_float64array:function(d){return p("float64array:"),this.dispatch(Array.prototype.slice.call(d))},_arraybuffer:function(d){return p("arraybuffer:"),this.dispatch(new Uint8Array(d))},_url:function(d){return p("url:"+d.toString())},_map:function(d){return p("map:"),d=Array.from(d),this._array(d,y.unorderedSets!==!1)},_set:function(d){return p("set:"),d=Array.from(d),this._array(d,y.unorderedSets!==!1)},_file:function(d){return p("file:"),this.dispatch([d.name,d.size,d.type,d.lastModfied])},_blob:function(){if(y.ignoreUnknown)return p("[blob]");throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){return p("domwindow")},_bigint:function(d){return p("bigint:"+d.toString())},_process:function(){return p("process")},_timer:function(){return p("timer")},_pipe:function(){return p("pipe")},_tcp:function(){return p("tcp")},_udp:function(){return p("udp")},_tty:function(){return p("tty")},_statwatcher:function(){return p("statwatcher")},_securecontext:function(){return p("securecontext")},_connection:function(){return p("connection")},_zlib:function(){return p("zlib")},_context:function(){return p("context")},_nodescript:function(){return p("nodescript")},_httpparser:function(){return p("httpparser")},_dataview:function(){return p("dataview")},_signal:function(){return p("signal")},_fsevent:function(){return p("fsevent")},_tlswrap:function(){return p("tlswrap")}}}function F(){return{buf:"",write:function(y){this.buf+=y},end:function(y){this.buf+=y},read:function(){return this.buf}}}a.writeToStream=function(y,w,h){return h===void 0&&(h=w,w={}),P(w=j(y,w),h).dispatch(y)}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/fake_9a5aa49d.js","/")},{buffer:3,crypto:5,lYpoI2:11}],2:[function(t,r,a){(function(s,i,o,u,c,m,k,M,q){(function(x){var N=typeof Uint8Array<"u"?Uint8Array:Array,b="+".charCodeAt(0),O="/".charCodeAt(0),j="0".charCodeAt(0),S="a".charCodeAt(0),P="A".charCodeAt(0),F="-".charCodeAt(0),y="_".charCodeAt(0);function w(h){return h=h.charCodeAt(0),h===b||h===F?62:h===O||h===y?63:h<j?-1:h<j+10?h-j+26+26:h<P+26?h-P:h<S+26?h-S+26:void 0}x.toByteArray=function(h){var p,d;if(0<h.length%4)throw new Error("Invalid string. Length must be a multiple of 4");var _=h.length,_=h.charAt(_-2)==="="?2:h.charAt(_-1)==="="?1:0,v=new N(3*h.length/4-_),$=0<_?h.length-4:h.length,K=0;function z(R){v[K++]=R}for(p=0;p<$;p+=4,0)z((16711680&(d=w(h.charAt(p))<<18|w(h.charAt(p+1))<<12|w(h.charAt(p+2))<<6|w(h.charAt(p+3))))>>16),z((65280&d)>>8),z(255&d);return _==2?z(255&(d=w(h.charAt(p))<<2|w(h.charAt(p+1))>>4)):_==1&&(z((d=w(h.charAt(p))<<10|w(h.charAt(p+1))<<4|w(h.charAt(p+2))>>2)>>8&255),z(255&d)),v},x.fromByteArray=function(h){var p,d,_,v,$=h.length%3,K="";function z(R){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(R)}for(p=0,_=h.length-$;p<_;p+=3)d=(h[p]<<16)+(h[p+1]<<8)+h[p+2],K+=z((v=d)>>18&63)+z(v>>12&63)+z(v>>6&63)+z(63&v);switch($){case 1:K=(K+=z((d=h[h.length-1])>>2))+z(d<<4&63)+"==";break;case 2:K=(K=(K+=z((d=(h[h.length-2]<<8)+h[h.length-1])>>10))+z(d>>4&63))+z(d<<2&63)+"="}return K}})(a===void 0?this.base64js={}:a)}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js","/node_modules/gulp-browserify/node_modules/base64-js/lib")},{buffer:3,lYpoI2:11}],3:[function(t,r,a){(function(s,i,b,u,c,m,k,M,q){var x=t("base64-js"),N=t("ieee754");function b(l,f,g){if(!(this instanceof b))return new b(l,f,g);var I,A,B,ue,me=typeof l;if(f==="base64"&&me=="string")for(l=(ue=l).trim?ue.trim():ue.replace(/^\s+|\s+$/g,"");l.length%4!=0;)l+="=";if(me=="number")I=de(l);else if(me=="string")I=b.byteLength(l,f);else{if(me!="object")throw new Error("First argument needs to be a number, array or string.");I=de(l.length)}if(b._useTypedArrays?A=b._augment(new Uint8Array(I)):((A=this).length=I,A._isBuffer=!0),b._useTypedArrays&&typeof l.byteLength=="number")A._set(l);else if(E(ue=l)||b.isBuffer(ue)||ue&&typeof ue=="object"&&typeof ue.length=="number")for(B=0;B<I;B++)b.isBuffer(l)?A[B]=l.readUInt8(B):A[B]=l[B];else if(me=="string")A.write(l,0,f);else if(me=="number"&&!b._useTypedArrays&&!g)for(B=0;B<I;B++)A[B]=0;return A}function O(l,f,g,I){return b._charsWritten=pe(function(A){for(var B=[],ue=0;ue<A.length;ue++)B.push(255&A.charCodeAt(ue));return B}(f),l,g,I)}function j(l,f,g,I){return b._charsWritten=pe(function(A){for(var B,ue,me=[],_e=0;_e<A.length;_e++)ue=A.charCodeAt(_e),B=ue>>8,ue=ue%256,me.push(ue),me.push(B);return me}(f),l,g,I)}function S(l,f,g){var I="";g=Math.min(l.length,g);for(var A=f;A<g;A++)I+=String.fromCharCode(l[A]);return I}function P(l,f,g,B){B||(D(typeof g=="boolean","missing or invalid endian"),D(f!=null,"missing offset"),D(f+1<l.length,"Trying to read beyond buffer length"));var A,B=l.length;if(!(B<=f))return g?(A=l[f],f+1<B&&(A|=l[f+1]<<8)):(A=l[f]<<8,f+1<B&&(A|=l[f+1])),A}function F(l,f,g,B){B||(D(typeof g=="boolean","missing or invalid endian"),D(f!=null,"missing offset"),D(f+3<l.length,"Trying to read beyond buffer length"));var A,B=l.length;if(!(B<=f))return g?(f+2<B&&(A=l[f+2]<<16),f+1<B&&(A|=l[f+1]<<8),A|=l[f],f+3<B&&(A+=l[f+3]<<24>>>0)):(f+1<B&&(A=l[f+1]<<16),f+2<B&&(A|=l[f+2]<<8),f+3<B&&(A|=l[f+3]),A+=l[f]<<24>>>0),A}function y(l,f,g,I){if(I||(D(typeof g=="boolean","missing or invalid endian"),D(f!=null,"missing offset"),D(f+1<l.length,"Trying to read beyond buffer length")),!(l.length<=f))return I=P(l,f,g,!0),32768&I?-1*(65535-I+1):I}function w(l,f,g,I){if(I||(D(typeof g=="boolean","missing or invalid endian"),D(f!=null,"missing offset"),D(f+3<l.length,"Trying to read beyond buffer length")),!(l.length<=f))return I=F(l,f,g,!0),2147483648&I?-1*(4294967295-I+1):I}function h(l,f,g,I){return I||(D(typeof g=="boolean","missing or invalid endian"),D(f+3<l.length,"Trying to read beyond buffer length")),N.read(l,f,g,23,4)}function p(l,f,g,I){return I||(D(typeof g=="boolean","missing or invalid endian"),D(f+7<l.length,"Trying to read beyond buffer length")),N.read(l,f,g,52,8)}function d(l,f,g,I,A){if(A||(D(f!=null,"missing value"),D(typeof I=="boolean","missing or invalid endian"),D(g!=null,"missing offset"),D(g+1<l.length,"trying to write beyond buffer length"),oe(f,65535)),A=l.length,!(A<=g))for(var B=0,ue=Math.min(A-g,2);B<ue;B++)l[g+B]=(f&255<<8*(I?B:1-B))>>>8*(I?B:1-B)}function _(l,f,g,I,A){if(A||(D(f!=null,"missing value"),D(typeof I=="boolean","missing or invalid endian"),D(g!=null,"missing offset"),D(g+3<l.length,"trying to write beyond buffer length"),oe(f,4294967295)),A=l.length,!(A<=g))for(var B=0,ue=Math.min(A-g,4);B<ue;B++)l[g+B]=f>>>8*(I?B:3-B)&255}function v(l,f,g,I,A){A||(D(f!=null,"missing value"),D(typeof I=="boolean","missing or invalid endian"),D(g!=null,"missing offset"),D(g+1<l.length,"Trying to write beyond buffer length"),ce(f,32767,-32768)),l.length<=g||d(l,0<=f?f:65535+f+1,g,I,A)}function $(l,f,g,I,A){A||(D(f!=null,"missing value"),D(typeof I=="boolean","missing or invalid endian"),D(g!=null,"missing offset"),D(g+3<l.length,"Trying to write beyond buffer length"),ce(f,2147483647,-2147483648)),l.length<=g||_(l,0<=f?f:4294967295+f+1,g,I,A)}function K(l,f,g,I,A){A||(D(f!=null,"missing value"),D(typeof I=="boolean","missing or invalid endian"),D(g!=null,"missing offset"),D(g+3<l.length,"Trying to write beyond buffer length"),ye(f,34028234663852886e22,-34028234663852886e22)),l.length<=g||N.write(l,f,g,I,23,4)}function z(l,f,g,I,A){A||(D(f!=null,"missing value"),D(typeof I=="boolean","missing or invalid endian"),D(g!=null,"missing offset"),D(g+7<l.length,"Trying to write beyond buffer length"),ye(f,17976931348623157e292,-17976931348623157e292)),l.length<=g||N.write(l,f,g,I,52,8)}a.Buffer=b,a.SlowBuffer=b,a.INSPECT_MAX_BYTES=50,b.poolSize=8192,b._useTypedArrays=function(){try{var l=new ArrayBuffer(0),f=new Uint8Array(l);return f.foo=function(){return 42},f.foo()===42&&typeof f.subarray=="function"}catch{return!1}}(),b.isEncoding=function(l){switch(String(l).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},b.isBuffer=function(l){return!(l==null||!l._isBuffer)},b.byteLength=function(l,f){var g;switch(l+="",f||"utf8"){case"hex":g=l.length/2;break;case"utf8":case"utf-8":g=Z(l).length;break;case"ascii":case"binary":case"raw":g=l.length;break;case"base64":g=ie(l).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":g=2*l.length;break;default:throw new Error("Unknown encoding")}return g},b.concat=function(l,f){if(D(E(l),`Usage: Buffer.concat(list, [totalLength])
list should be an Array.`),l.length===0)return new b(0);if(l.length===1)return l[0];if(typeof f!="number")for(A=f=0;A<l.length;A++)f+=l[A].length;for(var g=new b(f),I=0,A=0;A<l.length;A++){var B=l[A];B.copy(g,I),I+=B.length}return g},b.prototype.write=function(l,f,g,I){isFinite(f)?isFinite(g)||(I=g,g=void 0):(_e=I,I=f,f=g,g=_e),f=Number(f)||0;var A,B,ue,me,_e=this.length-f;switch((!g||_e<(g=Number(g)))&&(g=_e),I=String(I||"utf8").toLowerCase()){case"hex":A=function(Ue,Se,je,be){je=Number(je)||0;var ge=Ue.length-je;(!be||ge<(be=Number(be)))&&(be=ge),D((ge=Se.length)%2==0,"Invalid hex string"),ge/2<be&&(be=ge/2);for(var gt=0;gt<be;gt++){var jn=parseInt(Se.substr(2*gt,2),16);D(!isNaN(jn),"Invalid hex string"),Ue[je+gt]=jn}return b._charsWritten=2*gt,gt}(this,l,f,g);break;case"utf8":case"utf-8":B=this,ue=f,me=g,A=b._charsWritten=pe(Z(l),B,ue,me);break;case"ascii":case"binary":A=O(this,l,f,g);break;case"base64":B=this,ue=f,me=g,A=b._charsWritten=pe(ie(l),B,ue,me);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":A=j(this,l,f,g);break;default:throw new Error("Unknown encoding")}return A},b.prototype.toString=function(l,f,g){var I,A,B,ue,me=this;if(l=String(l||"utf8").toLowerCase(),f=Number(f)||0,(g=g!==void 0?Number(g):me.length)===f)return"";switch(l){case"hex":I=function(_e,Ue,Se){var je=_e.length;(!Ue||Ue<0)&&(Ue=0),(!Se||Se<0||je<Se)&&(Se=je);for(var be="",ge=Ue;ge<Se;ge++)be+=L(_e[ge]);return be}(me,f,g);break;case"utf8":case"utf-8":I=function(_e,Ue,Se){var je="",be="";Se=Math.min(_e.length,Se);for(var ge=Ue;ge<Se;ge++)_e[ge]<=127?(je+=T(be)+String.fromCharCode(_e[ge]),be=""):be+="%"+_e[ge].toString(16);return je+T(be)}(me,f,g);break;case"ascii":case"binary":I=S(me,f,g);break;case"base64":A=me,ue=g,I=(B=f)===0&&ue===A.length?x.fromByteArray(A):x.fromByteArray(A.slice(B,ue));break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":I=function(_e,Ue,Se){for(var je=_e.slice(Ue,Se),be="",ge=0;ge<je.length;ge+=2)be+=String.fromCharCode(je[ge]+256*je[ge+1]);return be}(me,f,g);break;default:throw new Error("Unknown encoding")}return I},b.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},b.prototype.copy=function(l,f,g,I){if(f=f||0,(I=I||I===0?I:this.length)!==(g=g||0)&&l.length!==0&&this.length!==0){D(g<=I,"sourceEnd < sourceStart"),D(0<=f&&f<l.length,"targetStart out of bounds"),D(0<=g&&g<this.length,"sourceStart out of bounds"),D(0<=I&&I<=this.length,"sourceEnd out of bounds"),I>this.length&&(I=this.length);var A=(I=l.length-f<I-g?l.length-f+g:I)-g;if(A<100||!b._useTypedArrays)for(var B=0;B<A;B++)l[B+f]=this[B+g];else l._set(this.subarray(g,g+A),f)}},b.prototype.slice=function(l,f){var g=this.length;if(l=W(l,g,0),f=W(f,g,g),b._useTypedArrays)return b._augment(this.subarray(l,f));for(var I=f-l,A=new b(I,void 0,!0),B=0;B<I;B++)A[B]=this[B+l];return A},b.prototype.get=function(l){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(l)},b.prototype.set=function(l,f){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(l,f)},b.prototype.readUInt8=function(l,f){if(f||(D(l!=null,"missing offset"),D(l<this.length,"Trying to read beyond buffer length")),!(l>=this.length))return this[l]},b.prototype.readUInt16LE=function(l,f){return P(this,l,!0,f)},b.prototype.readUInt16BE=function(l,f){return P(this,l,!1,f)},b.prototype.readUInt32LE=function(l,f){return F(this,l,!0,f)},b.prototype.readUInt32BE=function(l,f){return F(this,l,!1,f)},b.prototype.readInt8=function(l,f){if(f||(D(l!=null,"missing offset"),D(l<this.length,"Trying to read beyond buffer length")),!(l>=this.length))return 128&this[l]?-1*(255-this[l]+1):this[l]},b.prototype.readInt16LE=function(l,f){return y(this,l,!0,f)},b.prototype.readInt16BE=function(l,f){return y(this,l,!1,f)},b.prototype.readInt32LE=function(l,f){return w(this,l,!0,f)},b.prototype.readInt32BE=function(l,f){return w(this,l,!1,f)},b.prototype.readFloatLE=function(l,f){return h(this,l,!0,f)},b.prototype.readFloatBE=function(l,f){return h(this,l,!1,f)},b.prototype.readDoubleLE=function(l,f){return p(this,l,!0,f)},b.prototype.readDoubleBE=function(l,f){return p(this,l,!1,f)},b.prototype.writeUInt8=function(l,f,g){g||(D(l!=null,"missing value"),D(f!=null,"missing offset"),D(f<this.length,"trying to write beyond buffer length"),oe(l,255)),f>=this.length||(this[f]=l)},b.prototype.writeUInt16LE=function(l,f,g){d(this,l,f,!0,g)},b.prototype.writeUInt16BE=function(l,f,g){d(this,l,f,!1,g)},b.prototype.writeUInt32LE=function(l,f,g){_(this,l,f,!0,g)},b.prototype.writeUInt32BE=function(l,f,g){_(this,l,f,!1,g)},b.prototype.writeInt8=function(l,f,g){g||(D(l!=null,"missing value"),D(f!=null,"missing offset"),D(f<this.length,"Trying to write beyond buffer length"),ce(l,127,-128)),f>=this.length||(0<=l?this.writeUInt8(l,f,g):this.writeUInt8(255+l+1,f,g))},b.prototype.writeInt16LE=function(l,f,g){v(this,l,f,!0,g)},b.prototype.writeInt16BE=function(l,f,g){v(this,l,f,!1,g)},b.prototype.writeInt32LE=function(l,f,g){$(this,l,f,!0,g)},b.prototype.writeInt32BE=function(l,f,g){$(this,l,f,!1,g)},b.prototype.writeFloatLE=function(l,f,g){K(this,l,f,!0,g)},b.prototype.writeFloatBE=function(l,f,g){K(this,l,f,!1,g)},b.prototype.writeDoubleLE=function(l,f,g){z(this,l,f,!0,g)},b.prototype.writeDoubleBE=function(l,f,g){z(this,l,f,!1,g)},b.prototype.fill=function(l,f,g){if(f=f||0,g=g||this.length,D(typeof(l=typeof(l=l||0)=="string"?l.charCodeAt(0):l)=="number"&&!isNaN(l),"value is not a number"),D(f<=g,"end < start"),g!==f&&this.length!==0){D(0<=f&&f<this.length,"start out of bounds"),D(0<=g&&g<=this.length,"end out of bounds");for(var I=f;I<g;I++)this[I]=l}},b.prototype.inspect=function(){for(var l=[],f=this.length,g=0;g<f;g++)if(l[g]=L(this[g]),g===a.INSPECT_MAX_BYTES){l[g+1]="...";break}return"<Buffer "+l.join(" ")+">"},b.prototype.toArrayBuffer=function(){if(typeof Uint8Array>"u")throw new Error("Buffer.toArrayBuffer not supported in this browser");if(b._useTypedArrays)return new b(this).buffer;for(var l=new Uint8Array(this.length),f=0,g=l.length;f<g;f+=1)l[f]=this[f];return l.buffer};var R=b.prototype;function W(l,f,g){return typeof l!="number"?g:f<=(l=~~l)?f:0<=l||0<=(l+=f)?l:0}function de(l){return(l=~~Math.ceil(+l))<0?0:l}function E(l){return(Array.isArray||function(f){return Object.prototype.toString.call(f)==="[object Array]"})(l)}function L(l){return l<16?"0"+l.toString(16):l.toString(16)}function Z(l){for(var f=[],g=0;g<l.length;g++){var I=l.charCodeAt(g);if(I<=127)f.push(l.charCodeAt(g));else for(var A=g,B=(55296<=I&&I<=57343&&g++,encodeURIComponent(l.slice(A,g+1)).substr(1).split("%")),ue=0;ue<B.length;ue++)f.push(parseInt(B[ue],16))}return f}function ie(l){return x.toByteArray(l)}function pe(l,f,g,I){for(var A=0;A<I&&!(A+g>=f.length||A>=l.length);A++)f[A+g]=l[A];return A}function T(l){try{return decodeURIComponent(l)}catch{return String.fromCharCode(65533)}}function oe(l,f){D(typeof l=="number","cannot write a non-number as a number"),D(0<=l,"specified a negative value for writing an unsigned value"),D(l<=f,"value is larger than maximum value for type"),D(Math.floor(l)===l,"value has a fractional component")}function ce(l,f,g){D(typeof l=="number","cannot write a non-number as a number"),D(l<=f,"value larger than maximum allowed value"),D(g<=l,"value smaller than minimum allowed value"),D(Math.floor(l)===l,"value has a fractional component")}function ye(l,f,g){D(typeof l=="number","cannot write a non-number as a number"),D(l<=f,"value larger than maximum allowed value"),D(g<=l,"value smaller than minimum allowed value")}function D(l,f){if(!l)throw new Error(f||"Failed assertion")}b._augment=function(l){return l._isBuffer=!0,l._get=l.get,l._set=l.set,l.get=R.get,l.set=R.set,l.write=R.write,l.toString=R.toString,l.toLocaleString=R.toString,l.toJSON=R.toJSON,l.copy=R.copy,l.slice=R.slice,l.readUInt8=R.readUInt8,l.readUInt16LE=R.readUInt16LE,l.readUInt16BE=R.readUInt16BE,l.readUInt32LE=R.readUInt32LE,l.readUInt32BE=R.readUInt32BE,l.readInt8=R.readInt8,l.readInt16LE=R.readInt16LE,l.readInt16BE=R.readInt16BE,l.readInt32LE=R.readInt32LE,l.readInt32BE=R.readInt32BE,l.readFloatLE=R.readFloatLE,l.readFloatBE=R.readFloatBE,l.readDoubleLE=R.readDoubleLE,l.readDoubleBE=R.readDoubleBE,l.writeUInt8=R.writeUInt8,l.writeUInt16LE=R.writeUInt16LE,l.writeUInt16BE=R.writeUInt16BE,l.writeUInt32LE=R.writeUInt32LE,l.writeUInt32BE=R.writeUInt32BE,l.writeInt8=R.writeInt8,l.writeInt16LE=R.writeInt16LE,l.writeInt16BE=R.writeInt16BE,l.writeInt32LE=R.writeInt32LE,l.writeInt32BE=R.writeInt32BE,l.writeFloatLE=R.writeFloatLE,l.writeFloatBE=R.writeFloatBE,l.writeDoubleLE=R.writeDoubleLE,l.writeDoubleBE=R.writeDoubleBE,l.fill=R.fill,l.inspect=R.inspect,l.toArrayBuffer=R.toArrayBuffer,l}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/buffer/index.js","/node_modules/gulp-browserify/node_modules/buffer")},{"base64-js":2,buffer:3,ieee754:10,lYpoI2:11}],4:[function(t,r,a){(function(s,i,x,u,c,m,k,M,q){var x=t("buffer").Buffer,N=4,b=new x(N);b.fill(0),r.exports={hash:function(O,j,S,P){for(var F=j(function(d,_){d.length%N!=0&&(v=d.length+(N-d.length%N),d=x.concat([d,b],v));for(var v,$=[],K=_?d.readInt32BE:d.readInt32LE,z=0;z<d.length;z+=N)$.push(K.call(d,z));return $}(O=x.isBuffer(O)?O:new x(O),P),8*O.length),j=P,y=new x(S),w=j?y.writeInt32BE:y.writeInt32LE,h=0;h<F.length;h++)w.call(y,F[h],4*h,!0);return y}}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/helpers.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],5:[function(t,r,a){(function(s,i,x,u,c,m,k,M,q){var x=t("buffer").Buffer,N=t("./sha"),b=t("./sha256"),O=t("./rng"),j={sha1:N,sha256:b,md5:t("./md5")},S=64,P=new x(S);function F(d,_){var v=j[d=d||"sha1"],$=[];return v||y("algorithm:",d,"is not yet supported"),{update:function(K){return x.isBuffer(K)||(K=new x(K)),$.push(K),K.length,this},digest:function(K){var z=x.concat($),z=_?function(R,W,de){x.isBuffer(W)||(W=new x(W)),x.isBuffer(de)||(de=new x(de)),W.length>S?W=R(W):W.length<S&&(W=x.concat([W,P],S));for(var E=new x(S),L=new x(S),Z=0;Z<S;Z++)E[Z]=54^W[Z],L[Z]=92^W[Z];return de=R(x.concat([E,de])),R(x.concat([L,de]))}(v,_,z):v(z);return $=null,K?z.toString(K):z}}}function y(){var d=[].slice.call(arguments).join(" ");throw new Error([d,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join(`
`))}P.fill(0),a.createHash=function(d){return F(d)},a.createHmac=F,a.randomBytes=function(d,_){if(!_||!_.call)return new x(O(d));try{_.call(this,void 0,new x(O(d)))}catch(v){_(v)}};var w,h=["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],p=function(d){a[d]=function(){y("sorry,",d,"is not implemented yet")}};for(w in h)p(h[w])}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/index.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./md5":6,"./rng":7,"./sha":8,"./sha256":9,buffer:3,lYpoI2:11}],6:[function(t,r,a){(function(s,i,o,u,c,m,k,M,q){var x=t("./helpers");function N(y,w){y[w>>5]|=128<<w%32,y[14+(w+64>>>9<<4)]=w;for(var h=1732584193,p=-271733879,d=-1732584194,_=271733878,v=0;v<y.length;v+=16){var $=h,K=p,z=d,R=_,h=O(h,p,d,_,y[v+0],7,-680876936),_=O(_,h,p,d,y[v+1],12,-389564586),d=O(d,_,h,p,y[v+2],17,606105819),p=O(p,d,_,h,y[v+3],22,-1044525330);h=O(h,p,d,_,y[v+4],7,-176418897),_=O(_,h,p,d,y[v+5],12,1200080426),d=O(d,_,h,p,y[v+6],17,-1473231341),p=O(p,d,_,h,y[v+7],22,-45705983),h=O(h,p,d,_,y[v+8],7,1770035416),_=O(_,h,p,d,y[v+9],12,-1958414417),d=O(d,_,h,p,y[v+10],17,-42063),p=O(p,d,_,h,y[v+11],22,-1990404162),h=O(h,p,d,_,y[v+12],7,1804603682),_=O(_,h,p,d,y[v+13],12,-40341101),d=O(d,_,h,p,y[v+14],17,-1502002290),h=j(h,p=O(p,d,_,h,y[v+15],22,1236535329),d,_,y[v+1],5,-165796510),_=j(_,h,p,d,y[v+6],9,-1069501632),d=j(d,_,h,p,y[v+11],14,643717713),p=j(p,d,_,h,y[v+0],20,-373897302),h=j(h,p,d,_,y[v+5],5,-701558691),_=j(_,h,p,d,y[v+10],9,38016083),d=j(d,_,h,p,y[v+15],14,-660478335),p=j(p,d,_,h,y[v+4],20,-405537848),h=j(h,p,d,_,y[v+9],5,568446438),_=j(_,h,p,d,y[v+14],9,-1019803690),d=j(d,_,h,p,y[v+3],14,-187363961),p=j(p,d,_,h,y[v+8],20,1163531501),h=j(h,p,d,_,y[v+13],5,-1444681467),_=j(_,h,p,d,y[v+2],9,-51403784),d=j(d,_,h,p,y[v+7],14,1735328473),h=S(h,p=j(p,d,_,h,y[v+12],20,-1926607734),d,_,y[v+5],4,-378558),_=S(_,h,p,d,y[v+8],11,-2022574463),d=S(d,_,h,p,y[v+11],16,1839030562),p=S(p,d,_,h,y[v+14],23,-35309556),h=S(h,p,d,_,y[v+1],4,-1530992060),_=S(_,h,p,d,y[v+4],11,1272893353),d=S(d,_,h,p,y[v+7],16,-155497632),p=S(p,d,_,h,y[v+10],23,-1094730640),h=S(h,p,d,_,y[v+13],4,681279174),_=S(_,h,p,d,y[v+0],11,-358537222),d=S(d,_,h,p,y[v+3],16,-722521979),p=S(p,d,_,h,y[v+6],23,76029189),h=S(h,p,d,_,y[v+9],4,-640364487),_=S(_,h,p,d,y[v+12],11,-421815835),d=S(d,_,h,p,y[v+15],16,530742520),h=P(h,p=S(p,d,_,h,y[v+2],23,-995338651),d,_,y[v+0],6,-198630844),_=P(_,h,p,d,y[v+7],10,1126891415),d=P(d,_,h,p,y[v+14],15,-1416354905),p=P(p,d,_,h,y[v+5],21,-57434055),h=P(h,p,d,_,y[v+12],6,1700485571),_=P(_,h,p,d,y[v+3],10,-1894986606),d=P(d,_,h,p,y[v+10],15,-1051523),p=P(p,d,_,h,y[v+1],21,-2054922799),h=P(h,p,d,_,y[v+8],6,1873313359),_=P(_,h,p,d,y[v+15],10,-30611744),d=P(d,_,h,p,y[v+6],15,-1560198380),p=P(p,d,_,h,y[v+13],21,1309151649),h=P(h,p,d,_,y[v+4],6,-145523070),_=P(_,h,p,d,y[v+11],10,-1120210379),d=P(d,_,h,p,y[v+2],15,718787259),p=P(p,d,_,h,y[v+9],21,-343485551),h=F(h,$),p=F(p,K),d=F(d,z),_=F(_,R)}return Array(h,p,d,_)}function b(y,w,h,p,d,_){return F((w=F(F(w,y),F(p,_)))<<d|w>>>32-d,h)}function O(y,w,h,p,d,_,v){return b(w&h|~w&p,y,w,d,_,v)}function j(y,w,h,p,d,_,v){return b(w&p|h&~p,y,w,d,_,v)}function S(y,w,h,p,d,_,v){return b(w^h^p,y,w,d,_,v)}function P(y,w,h,p,d,_,v){return b(h^(w|~p),y,w,d,_,v)}function F(y,w){var h=(65535&y)+(65535&w);return(y>>16)+(w>>16)+(h>>16)<<16|65535&h}r.exports=function(y){return x.hash(y,N,16)}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/md5.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],7:[function(t,r,a){(function(s,i,o,u,c,m,k,M,q){r.exports=function(x){for(var N,b=new Array(x),O=0;O<x;O++)!(3&O)&&(N=4294967296*Math.random()),b[O]=N>>>((3&O)<<3)&255;return b}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/rng.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],8:[function(t,r,a){(function(s,i,o,u,c,m,k,M,q){var x=t("./helpers");function N(j,S){j[S>>5]|=128<<24-S%32,j[15+(S+64>>9<<4)]=S;for(var P,F,y,w=Array(80),h=1732584193,p=-271733879,d=-1732584194,_=271733878,v=-1009589776,$=0;$<j.length;$+=16){for(var K=h,z=p,R=d,W=_,de=v,E=0;E<80;E++){w[E]=E<16?j[$+E]:O(w[E-3]^w[E-8]^w[E-14]^w[E-16],1);var L=b(b(O(h,5),(L=p,F=d,y=_,(P=E)<20?L&F|~L&y:!(P<40)&&P<60?L&F|L&y|F&y:L^F^y)),b(b(v,w[E]),(P=E)<20?1518500249:P<40?1859775393:P<60?-1894007588:-899497514)),v=_,_=d,d=O(p,30),p=h,h=L}h=b(h,K),p=b(p,z),d=b(d,R),_=b(_,W),v=b(v,de)}return Array(h,p,d,_,v)}function b(j,S){var P=(65535&j)+(65535&S);return(j>>16)+(S>>16)+(P>>16)<<16|65535&P}function O(j,S){return j<<S|j>>>32-S}r.exports=function(j){return x.hash(j,N,20,!0)}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],9:[function(t,r,a){(function(s,i,o,u,c,m,k,M,q){function x(S,P){var F=(65535&S)+(65535&P);return(S>>16)+(P>>16)+(F>>16)<<16|65535&F}function N(S,P){var F,y=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),w=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),h=new Array(64);S[P>>5]|=128<<24-P%32,S[15+(P+64>>9<<4)]=P;for(var p,d,_=0;_<S.length;_+=16){for(var v=w[0],$=w[1],K=w[2],z=w[3],R=w[4],W=w[5],de=w[6],E=w[7],L=0;L<64;L++)h[L]=L<16?S[L+_]:x(x(x((d=h[L-2],O(d,17)^O(d,19)^j(d,10)),h[L-7]),(d=h[L-15],O(d,7)^O(d,18)^j(d,3))),h[L-16]),F=x(x(x(x(E,O(d=R,6)^O(d,11)^O(d,25)),R&W^~R&de),y[L]),h[L]),p=x(O(p=v,2)^O(p,13)^O(p,22),v&$^v&K^$&K),E=de,de=W,W=R,R=x(z,F),z=K,K=$,$=v,v=x(F,p);w[0]=x(v,w[0]),w[1]=x($,w[1]),w[2]=x(K,w[2]),w[3]=x(z,w[3]),w[4]=x(R,w[4]),w[5]=x(W,w[5]),w[6]=x(de,w[6]),w[7]=x(E,w[7])}return w}var b=t("./helpers"),O=function(S,P){return S>>>P|S<<32-P},j=function(S,P){return S>>>P};r.exports=function(S){return b.hash(S,N,32,!0)}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha256.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],10:[function(t,r,a){(function(s,i,o,u,c,m,k,M,q){a.read=function(x,N,b,O,_){var S,P,F=8*_-O-1,y=(1<<F)-1,w=y>>1,h=-7,p=b?_-1:0,d=b?-1:1,_=x[N+p];for(p+=d,S=_&(1<<-h)-1,_>>=-h,h+=F;0<h;S=256*S+x[N+p],p+=d,h-=8);for(P=S&(1<<-h)-1,S>>=-h,h+=O;0<h;P=256*P+x[N+p],p+=d,h-=8);if(S===0)S=1-w;else{if(S===y)return P?NaN:1/0*(_?-1:1);P+=Math.pow(2,O),S-=w}return(_?-1:1)*P*Math.pow(2,S-O)},a.write=function(x,N,b,O,j,v){var P,F,y=8*v-j-1,w=(1<<y)-1,h=w>>1,p=j===23?Math.pow(2,-24)-Math.pow(2,-77):0,d=O?0:v-1,_=O?1:-1,v=N<0||N===0&&1/N<0?1:0;for(N=Math.abs(N),isNaN(N)||N===1/0?(F=isNaN(N)?1:0,P=w):(P=Math.floor(Math.log(N)/Math.LN2),N*(O=Math.pow(2,-P))<1&&(P--,O*=2),2<=(N+=1<=P+h?p/O:p*Math.pow(2,1-h))*O&&(P++,O/=2),w<=P+h?(F=0,P=w):1<=P+h?(F=(N*O-1)*Math.pow(2,j),P+=h):(F=N*Math.pow(2,h-1)*Math.pow(2,j),P=0));8<=j;x[b+d]=255&F,d+=_,F/=256,j-=8);for(P=P<<j|F,y+=j;0<y;x[b+d]=255&P,d+=_,P/=256,y-=8);x[b+d-_]|=128*v}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/ieee754/index.js","/node_modules/gulp-browserify/node_modules/ieee754")},{buffer:3,lYpoI2:11}],11:[function(t,r,a){(function(s,i,o,u,c,m,k,M,q){var x,N,b;function O(){}(s=r.exports={}).nextTick=(N=typeof window<"u"&&window.setImmediate,b=typeof window<"u"&&window.postMessage&&window.addEventListener,N?function(j){return window.setImmediate(j)}:b?(x=[],window.addEventListener("message",function(j){var S=j.source;S!==window&&S!==null||j.data!=="process-tick"||(j.stopPropagation(),0<x.length&&x.shift()())},!0),function(j){x.push(j),window.postMessage("process-tick","*")}):function(j){setTimeout(j,0)}),s.title="browser",s.browser=!0,s.env={},s.argv=[],s.on=O,s.addListener=O,s.once=O,s.off=O,s.removeListener=O,s.removeAllListeners=O,s.emit=O,s.binding=function(j){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(j){throw new Error("process.chdir is not supported")}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/process/browser.js","/node_modules/gulp-browserify/node_modules/process")},{buffer:3,lYpoI2:11}]},{},[1])(1)})})(Zs);var Fl=Zs.exports;const Kl=Da(Fl),fa=(...n)=>Kl(n.join("_")),ql=new Map;class Tn extends ai{constructor(e){super(),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cache=e??new Map}lookup(e,t){return Promise.resolve(this.cache.get(fa(e,t))??null)}async update(e,t,r){this.cache.set(fa(e,t),r)}static global(){return new Tn(ql)}}class zl extends Ba{constructor({cache:e,concurrency:t,...r}){super(t?{maxConcurrency:t,...r}:r),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","llms",this._llmType()]}),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof e=="object"?this.cache=e:e?this.cache=Tn.global():this.cache=void 0}async generatePrompt(e,t,r){const a=e.map(s=>s.toString());return this.generate(a,t,r)}invocationParams(e){return{}}_flattenLLMResult(e){const t=[];for(let r=0;r<e.generations.length;r+=1){const a=e.generations[r];if(r===0)t.push({generations:[a],llmOutput:e.llmOutput});else{const s=e.llmOutput?{...e.llmOutput,tokenUsage:{}}:void 0;t.push({generations:[a],llmOutput:s})}}return t}async _generateUncached(e,t,r){const a=await at.configure(r.callbacks,this.callbacks,r.tags,this.tags,r.metadata,this.metadata,{verbose:this.verbose}),s={options:t,invocation_params:this==null?void 0:this.invocationParams(t)},i=await(a==null?void 0:a.handleLLMStart(this.toJSON(),e,void 0,void 0,s));let o;try{o=await this._generate(e,t,i==null?void 0:i[0])}catch(m){throw await Promise.all((i??[]).map(k=>k==null?void 0:k.handleLLMError(m))),m}const u=this._flattenLLMResult(o);await Promise.all((i??[]).map((m,k)=>m==null?void 0:m.handleLLMEnd(u[k])));const c=(i==null?void 0:i.map(m=>m.runId))||void 0;return Object.defineProperty(o,Ta,{value:c?{runIds:c}:void 0,configurable:!0}),o}async generate(e,t,r){if(!Array.isArray(e))throw new Error("Argument 'prompts' is expected to be a string[]");let a;Array.isArray(t)?a={stop:t}:t!=null&&t.timeout&&!t.signal?a={...t,signal:AbortSignal.timeout(t.timeout)}:a=t??{};const s={tags:a.tags,metadata:a.metadata,callbacks:a.callbacks??r};if(delete a.tags,delete a.metadata,delete a.callbacks,!this.cache)return this._generateUncached(e,a,s);const{cache:i}=this,o=this.serialize();o.stop=a.stop??o.stop;const u=`${Object.entries(o).sort()}`,c=[],m=await Promise.all(e.map(async(M,q)=>{const x=await i.lookup(M,u);return x||c.push(q),x}));let k={};if(c.length>0){const M=await this._generateUncached(c.map(q=>e[q]),a,s);await Promise.all(M.generations.map(async(q,x)=>{const N=c[x];return m[N]=q,i.update(e[N],u,q)})),k=M.llmOutput??{}}return{generations:m,llmOutput:k}}async call(e,t,r){const{generations:a}=await this.generate([e],t??{},r);return a[0][0].text}async predict(e,t,r){return this.call(e,t,r)}async predictMessages(e,t,r){const a=hn(e),s=await this.call(a,t,r);return new Aa(s)}_identifyingParams(){return{}}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}_modelType(){return"base_llm"}static async deserialize(e){const{_type:t,_model:r,...a}=e;if(r&&r!=="base_llm")throw new Error(`Cannot load LLM with model ${r}`);const s={openai:(await Ae(()=>import("./openai.96da0411.js"),["./openai.96da0411.js","./NavBar.28f036ee.js","./public.9062b0fe.js","./scheduler.2364b0ad.js","./index.9f7452a2.js","./globals.7f7f1b26.js","../assets/NavBar.ffbd0f32.css","./prompt-layer.00daf386.js"],import.meta.url)).OpenAI}[t];if(s===void 0)throw new Error(`Cannot load  LLM with type ${t}`);return new s(a)}}class Hl extends zl{async _generate(e,t,r){return{generations:await Promise.all(e.map((s,i)=>this._call(s,{...t,promptIndex:i},r).then(o=>[{text:o}])))}}}class Sn extends Hl{get lc_secrets(){return{apiKey:"HUGGINGFACEHUB_API_KEY"}}constructor(e){if(super(e??{}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"gpt2"}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topK",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.model=(e==null?void 0:e.model)??this.model,this.temperature=(e==null?void 0:e.temperature)??this.temperature,this.maxTokens=(e==null?void 0:e.maxTokens)??this.maxTokens,this.topP=(e==null?void 0:e.topP)??this.topP,this.topK=(e==null?void 0:e.topK)??this.topK,this.frequencyPenalty=(e==null?void 0:e.frequencyPenalty)??this.frequencyPenalty,this.apiKey=(e==null?void 0:e.apiKey)??Ke("HUGGINGFACEHUB_API_KEY"),!this.apiKey)throw new Error("Please set an API key for HuggingFace Hub in the environment variable HUGGINGFACEHUB_API_KEY or in the apiKey field of the HuggingFaceInference constructor.")}_llmType(){return"hf"}async _call(e,t){const{HfInference:r}=await Sn.imports(),a=new r(this.apiKey);return(await this.caller.callWithOptions({signal:t.signal},a.textGeneration.bind(a),{model:this.model,parameters:{return_full_text:!1,temperature:this.temperature,max_new_tokens:this.maxTokens,top_p:this.topP,top_k:this.topK,repetition_penalty:this.frequencyPenalty},inputs:e})).generated_text}static async imports(){try{const{HfInference:e}=await Ae(()=>import("./hf.6d567cb7.js").then(t=>t.i),["./hf.6d567cb7.js","./NavBar.28f036ee.js","./public.9062b0fe.js","./scheduler.2364b0ad.js","./index.9f7452a2.js","./globals.7f7f1b26.js","../assets/NavBar.ffbd0f32.css"],import.meta.url);return{HfInference:e}}catch{throw new Error("Please install huggingface as a dependency with, e.g. `yarn add @huggingface/inference`")}}}async function pa(n,e,t,r,a){if(a==null||a==="")return"Please enter a question";{console.log("question is actually ",a);const s=new Sn({apiKey:n,model:"tiiuae/falcon-7b-instruct",maxTokens:5e3}),i=_r(vr,br),o=Qr;let u=new Wr({openAIApiKey:o});await i.auth.getUser(),new Jr(u,{client:i,tableName:"documents"});const c="{question}",m=gn.fromLLM(s,e.asRetriever(),{returnSourceDocuments:!0,questionGeneratorChainOptions:{template:c}});let k={search_distance:.9};const M=await m.call({question:a,chat_history:[],vector_db_kwargs:k});return console.log("result",M),console.log(M.text),M.text}}const{console:Yl}=ei,se="src/routes/ask/+page.svelte";function ma(n,e,t){const r=n.slice();return r[34]=e[t],r}function ga(n,e,t){const r=n.slice();return r[37]=e[t],r}function rn(n){let e,t,r,a,s,i="Select Model",o,u,c,m="tiiuae/falcon-7b-instruct",k,M="meta-llama/Llama-2-70b-chat-hf",q,x="OpenAssistant/oasst-sft-4-pythia-12b-epoch-3.5",N,b,O,j="Temperature",S,P,F,y,w,h,p,d="Chat History",_,v,$,K,z,R,W,de=xr(n[8]),E=[];for(let Z=0;Z<de.length;Z+=1)E[Z]=nn(ga(n,de,Z));const L={c:function(){e=ne("div"),t=ne("div"),r=ne("div"),a=ne("div"),s=ne("label"),s.textContent=i,o=ve(),u=ne("select"),c=ne("option"),c.textContent=m,k=ne("option"),k.textContent=M,q=ne("option"),q.textContent=x,N=ve(),b=ne("div"),O=ne("label"),O.textContent=j,S=ve(),P=ne("input"),F=ve(),y=ne("span"),w=wt(n[1]),h=ve(),p=ne("h2"),p.textContent=d,_=ve(),v=ne("button"),$=ne("i"),K=wt(" New Chat"),z=ve();for(let ie=0;ie<E.length;ie+=1)E[ie].c();this.h()},l:function(ie){e=ae(ie,"DIV",{class:!0});var pe=he(e);t=ae(pe,"DIV",{class:!0});var T=he(t);r=ae(T,"DIV",{class:!0});var oe=he(r);a=ae(oe,"DIV",{class:!0});var ce=he(a);s=ae(ce,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Ge(s)!=="svelte-1n8492e"&&(s.textContent=i),o=we(ce),u=ae(ce,"SELECT",{id:!0,style:!0,class:!0});var ye=he(u);c=ae(ye,"OPTION",{"data-svelte-h":!0}),Ge(c)!=="svelte-15kfk1a"&&(c.textContent=m),k=ae(ye,"OPTION",{"data-svelte-h":!0}),Ge(k)!=="svelte-14tx9eu"&&(k.textContent=M),q=ae(ye,"OPTION",{"data-svelte-h":!0}),Ge(q)!=="svelte-ppycc4"&&(q.textContent=x),ye.forEach(te),ce.forEach(te),N=we(oe),b=ae(oe,"DIV",{class:!0});var D=he(b);O=ae(D,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Ge(O)!=="svelte-1cqo6os"&&(O.textContent=j),S=we(D),P=ae(D,"INPUT",{type:!0,id:!0,min:!0,max:!0,step:!0,class:!0}),F=we(D),y=ae(D,"SPAN",{class:!0});var l=he(y);w=xt(l,n[1]),l.forEach(te),D.forEach(te),oe.forEach(te),h=we(T),p=ae(T,"H2",{class:!0,"data-svelte-h":!0}),Ge(p)!=="svelte-141gz04"&&(p.textContent=d),_=we(T),v=ae(T,"BUTTON",{class:!0});var f=he(v);$=ae(f,"I",{class:!0}),he($).forEach(te),K=xt(f," New Chat"),f.forEach(te),z=we(T);for(let g=0;g<E.length;g+=1)E[g].l(T);T.forEach(te),pe.forEach(te),this.h()},h:function(){Q(s,"class","block text-lg font-semibold"),Q(s,"for","model"),re(s,se,366,16,6535),c.__value="tiiuae/falcon-7b-instruct",dt(c,c.__value),re(c,se,375,18,6871),k.__value="meta-llama/Llama-2-70b-chat-hf",dt(k,k.__value),re(k,se,378,18,7006),q.__value="OpenAssistant/oasst-sft-4-pythia-12b-epoch-3.5",dt(q,q.__value),re(q,se,381,18,7151),Q(u,"id","model"),Ea(u,"width","200px"),Q(u,"class","select select-sm select-primary"),n[0]===void 0&&Ys(()=>n[16].call(u)),re(u,se,369,16,6663),Q(a,"class","mb-4"),re(a,se,365,14,6500),Q(O,"class","block text-lg font-semibold"),Q(O,"for","temperature"),re(O,se,387,16,7406),Q(P,"type","range"),Q(P,"id","temperature"),Q(P,"min","0.1"),Q(P,"max","1.0"),Q(P,"step","0.2"),Q(P,"class","input input-sm input-primary"),re(P,se,390,16,7539),Q(y,"class","text-sm ml-2"),re(y,se,399,16,7830),Q(b,"class","mb-4"),re(b,se,386,14,7371),Q(r,"class","w-full md:w-3/4 mt-14"),re(r,se,364,12,6450),Q(p,"class","text-2xl font-bold mb-4"),re(p,se,403,12,7931),Q($,"class","fas fa-plus"),re($,se,409,14,8177),Q(v,"class","btn btn-primary btn-sm mb-2"),re(v,se,405,12,8052),Q(t,"class","overflow-y-auto max-h-96"),re(t,se,363,10,6399),Q(e,"class","absolute left-0 top-0 bg-gray-800 rounded-lg p-4 sidebar s-uhtJAkW7ZDek"),re(e,se,362,8,6318)},m:function(ie,pe){Ce(ie,e,pe),Y(e,t),Y(t,r),Y(r,a),Y(a,s),Y(a,o),Y(a,u),Y(u,c),Y(u,k),Y(u,q),Mn(u,n[0],!0),Y(r,N),Y(r,b),Y(b,O),Y(b,S),Y(b,P),dt(P,n[1]),Y(b,F),Y(b,y),Y(y,w),Y(t,h),Y(t,p),Y(t,_),Y(t,v),Y(v,$),Y(v,K),Y(t,z);for(let T=0;T<E.length;T+=1)E[T]&&E[T].m(t,null);R||(W=[Qe(u,"change",n[16]),Qe(P,"change",n[17]),Qe(P,"input",n[17]),Qe(v,"click",n[11],!1,!1,!1,!1)],R=!0)},p:function(ie,pe){if(pe[0]&1&&Mn(u,ie[0]),pe[0]&2&&dt(P,ie[1]),pe[0]&2&&Tr(w,ie[1]),pe[0]&24832){de=xr(ie[8]);let T;for(T=0;T<de.length;T+=1){const oe=ga(ie,de,T);E[T]?E[T].p(oe,pe):(E[T]=nn(oe),E[T].c(),E[T].m(t,null))}for(;T<E.length;T+=1)E[T].d(1);E.length=de.length}},d:function(ie){ie&&te(e),Pa(E,ie),R=!1,un(W)}};return Ne("SvelteRegisterBlock",{block:L,id:rn.name,type:"if",source:"(189:6) {#if isChatHistorySidebarOpen}",ctx:n}),L}function Bs(n){let e,t="New Chat";const r={c:function(){e=ne("span"),e.textContent=t,this.h()},l:function(s){e=ae(s,"SPAN",{"data-svelte-h":!0}),Ge(e)!=="svelte-t9s83e"&&(e.textContent=t),this.h()},h:function(){re(e,se,421,18,8720)},m:function(s,i){Ce(s,e,i)},p:ya,d:function(s){s&&te(e)}};return Ne("SvelteRegisterBlock",{block:r,id:Bs.name,type:"else",source:"(248:16) {:else}",ctx:n}),r}function Us(n){let e,t=n[37].firstUserMessage+"",r;const a={c:function(){e=ne("span"),r=wt(t),this.h()},l:function(i){e=ae(i,"SPAN",{});var o=he(e);r=xt(o,t),o.forEach(te),this.h()},h:function(){re(e,se,419,18,8641)},m:function(i,o){Ce(i,e,o),Y(e,r)},p:function(i,o){o[0]&256&&t!==(t=i[37].firstUserMessage+"")&&Tr(r,t)},d:function(i){i&&te(e)}};return Ne("SvelteRegisterBlock",{block:a,id:Us.name,type:"if",source:'(246:16) {#if chat.firstUserMessage !== \\"\\" && chat.firstUserMessage !== null && chat.firstUserMessage !== undefined}',ctx:n}),a}function nn(n){let e,t,r,a,s,i,o;function u(x,N){return x[37].firstUserMessage!==""&&x[37].firstUserMessage!==null&&x[37].firstUserMessage!==void 0?Us:Bs}let c=u(n),m=c(n);function k(){return n[18](n[37])}function M(){return n[19](n[37])}const q={c:function(){e=ne("div"),m.c(),t=ve(),r=ne("button"),a=ne("i"),s=ve(),this.h()},l:function(N){e=ae(N,"DIV",{class:!0});var b=he(e);m.l(b),t=we(b),r=ae(b,"BUTTON",{class:!0});var O=he(r);a=ae(O,"I",{class:!0}),he(a).forEach(te),O.forEach(te),s=we(b),b.forEach(te),this.h()},h:function(){Q(a,"class","fas fa-trash-alt"),re(a,se,428,18,8988),Q(r,"class","btn btn-error btn-sm"),re(r,se,424,16,8837),Q(e,"class","flex items-center justify-between mb-2 s-uhtJAkW7ZDek"),re(e,se,414,14,8344)},m:function(N,b){Ce(N,e,b),m.m(e,null),Y(e,t),Y(e,r),Y(r,a),Y(e,s),i||(o=[Qe(r,"click",k,!1,!1,!1,!1),Qe(e,"click",M,!1,!1,!1,!1)],i=!0)},p:function(N,b){n=N,c===(c=u(n))&&m?m.p(n,b):(m.d(1),m=c(n),m&&(m.c(),m.m(e,t)))},d:function(N){N&&te(e),m.d(),i=!1,un(o)}};return Ne("SvelteRegisterBlock",{block:q,id:nn.name,type:"each",source:"(241:12) {#each $userChats as chat}",ctx:n}),q}function Vs(n){let e;const t={c:function(){e=ne("i"),this.h()},l:function(a){e=ae(a,"I",{class:!0}),he(e).forEach(te),this.h()},h:function(){Q(e,"class","chevron fas fa-chevron-right text-2xl s-uhtJAkW7ZDek"),re(e,se,444,10,9380)},m:function(a,s){Ce(a,e,s)},d:function(a){a&&te(e)}};return Ne("SvelteRegisterBlock",{block:t,id:Vs.name,type:"else",source:"(271:8) {:else}",ctx:n}),t}function $s(n){let e;const t={c:function(){e=ne("i"),this.h()},l:function(a){e=ae(a,"I",{class:!0}),he(e).forEach(te),this.h()},h:function(){Q(e,"class","chevron fas fa-chevron-left text-2xl s-uhtJAkW7ZDek"),re(e,se,442,10,9303)},m:function(a,s){Ce(a,e,s)},d:function(a){a&&te(e)}};return Ne("SvelteRegisterBlock",{block:t,id:$s.name,type:"if",source:"(269:8) {#if isChatHistorySidebarOpen}",ctx:n}),t}function Fs(n){let e,t=xr(n[7]),r=[];for(let s=0;s<t.length;s+=1)r[s]=an(ma(n,t,s));const a={c:function(){e=ne("div");for(let i=0;i<r.length;i+=1)r[i].c();this.h()},l:function(i){e=ae(i,"DIV",{class:!0});var o=he(e);for(let u=0;u<r.length;u+=1)r[u].l(o);o.forEach(te),this.h()},h:function(){Q(e,"class","chat-container overflow-y-auto h-96 s-uhtJAkW7ZDek"),re(e,se,459,12,9898)},m:function(i,o){Ce(i,e,o);for(let u=0;u<r.length;u+=1)r[u]&&r[u].m(e,null)},p:function(i,o){if(o[0]&128){t=xr(i[7]);let u;for(u=0;u<t.length;u+=1){const c=ma(i,t,u);r[u]?r[u].p(c,o):(r[u]=an(c),r[u].c(),r[u].m(e,null))}for(;u<r.length;u+=1)r[u].d(1);r.length=t.length}},d:function(i){i&&te(e),Pa(r,i)}};return Ne("SvelteRegisterBlock",{block:a,id:Fs.name,type:"else",source:"(286:10) {:else}",ctx:n}),a}function Ks(n){let e,t="Select a chat from the history to view messages.";const r={c:function(){e=ne("p"),e.textContent=t,this.h()},l:function(s){e=ae(s,"P",{class:!0,"data-svelte-h":!0}),Ge(e)!=="svelte-ulna32"&&(e.textContent=t),this.h()},h:function(){Q(e,"class","text-gray-500"),re(e,se,455,12,9762)},m:function(s,i){Ce(s,e,i)},p:ya,d:function(s){s&&te(e)}};return Ne("SvelteRegisterBlock",{block:r,id:Ks.name,type:"if",source:"(282:10) {#if selectedChatId === null}",ctx:n}),r}function an(n){let e,t=n[34].message+"",r,a;const s={c:function(){e=ne("div"),r=wt(t),a=ve(),this.h()},l:function(o){e=ae(o,"DIV",{class:!0});var u=he(e);r=xt(u,t),a=we(u),u.forEach(te),this.h()},h:function(){Q(e,"class","chat-message s-uhtJAkW7ZDek"),Nn(e,"is-user-message",n[34].is_user_message),re(e,se,461,16,10019)},m:function(o,u){Ce(o,e,u),Y(e,r),Y(e,a)},p:function(o,u){u[0]&128&&t!==(t=o[34].message+"")&&Tr(r,t),u[0]&128&&Nn(e,"is-user-message",o[34].is_user_message)},d:function(o){o&&te(e)}};return Ne("SvelteRegisterBlock",{block:s,id:an.name,type:"each",source:"(288:14) {#each $selectedChatMessages as message}",ctx:n}),s}function sn(n){let e,t;const r={c:function(){e=ne("div"),t=wt(n[4]),this.h()},l:function(s){e=ae(s,"DIV",{class:!0});var i=he(e);t=xt(i,n[4]),i.forEach(te),this.h()},h:function(){Q(e,"class","absolute top-4 left-4 right-4 bg-red-600 text-white p-2 rounded"),re(e,se,495,6,11007)},m:function(s,i){Ce(s,e,i),Y(e,t)},p:function(s,i){i[0]&16&&Tr(t,s[4])},d:function(s){s&&te(e)}};return Ne("SvelteRegisterBlock",{block:r,id:sn.name,type:"if",source:"(322:4) {#if errorText !== null}",ctx:n}),r}function qs(n){let e,t,r,a,s,i,o,u,c,m,k="Chat Messages",M,q,x,N,b,O,j,S,P,F,y,w,h,p;t=new Ca({$$inline:!0});let d=n[6]&&rn(n);function _(E,L){return E[6]?$s:Vs}let v=_(n),$=v(n);function K(E,L){return E[5]===null?Ks:Fs}let z=K(n),R=z(n),W=n[4]!==null&&sn(n);const de={c:function(){e=ne("div"),_a(t.$$.fragment),r=ve(),a=ne("div"),d&&d.c(),s=ve(),i=ne("div"),$.c(),o=ve(),u=ne("div"),c=ne("div"),m=ne("h1"),m.textContent=k,M=ve(),R.c(),q=ve(),x=ne("div"),N=ne("div"),b=ne("textarea"),j=ve(),S=ne("button"),P=wt("Ask the AI and Send Message"),y=ve(),W&&W.c(),this.h()},l:function(L){e=ae(L,"DIV",{class:!0});var Z=he(e);ba(t.$$.fragment,Z),r=we(Z),a=ae(Z,"DIV",{class:!0});var ie=he(a);d&&d.l(ie),s=we(ie),i=ae(ie,"DIV",{class:!0,style:!0});var pe=he(i);$.l(pe),pe.forEach(te),o=we(ie),u=ae(ie,"DIV",{class:!0});var T=he(u);c=ae(T,"DIV",{class:!0});var oe=he(c);m=ae(oe,"H1",{class:!0,"data-svelte-h":!0}),Ge(m)!=="svelte-fy4ok2"&&(m.textContent=k),M=we(oe),R.l(oe),oe.forEach(te),q=we(T),x=ae(T,"DIV",{class:!0});var ce=he(x);N=ae(ce,"DIV",{class:!0});var ye=he(N);b=ae(ye,"TEXTAREA",{id:!0,class:!0}),he(b).forEach(te),ye.forEach(te),j=we(ce),S=ae(ce,"BUTTON",{class:!0});var D=he(S);P=xt(D,"Ask the AI and Send Message"),D.forEach(te),ce.forEach(te),T.forEach(te),ie.forEach(te),y=we(Z),W&&W.l(Z),Z.forEach(te),this.h()},h:function(){Q(i,"class","sidebar-toggle-btn s-uhtJAkW7ZDek"),Ea(i,"left","1rem"),re(i,se,436,6,9137),Q(m,"class","text-4xl font-bold mb-8"),re(m,se,453,10,9655),Q(c,"class","w-full md:w-3/4"),re(c,se,452,8,9615),Q(b,"id","question"),Q(b,"class","textarea textarea-primary"),b.disabled=O=n[5]===null||n[3],re(b,se,475,12,10404),Q(N,"class","form-control mb-4"),re(N,se,474,10,10360),Q(S,"class","btn btn-primary mb-4"),S.disabled=F=n[5]===null,re(S,se,484,10,10705),Q(x,"class","w-full md:w-3/4 mt-4"),re(x,se,473,8,10315),Q(u,"class","flex flex-col items-center justify-center w-full md:w-3/4 mx-auto s-uhtJAkW7ZDek"),re(u,se,449,6,9512),Q(a,"class","relative flex flex-col md:flex-row min-h-screen s-uhtJAkW7ZDek"),re(a,se,358,4,6145),Q(e,"class","flex flex-col bg-gray-900 text-white p-4 s-uhtJAkW7ZDek"),re(e,se,356,2,6071)},m:function(L,Z){Ce(L,e,Z),va(t,e,null),Y(e,r),Y(e,a),d&&d.m(a,null),Y(a,s),Y(a,i),$.m(i,null),Y(a,o),Y(a,u),Y(u,c),Y(c,m),Y(c,M),R.m(c,null),Y(u,q),Y(u,x),Y(x,N),Y(N,b),dt(b,n[2]),Y(x,j),Y(x,S),Y(S,P),Y(e,y),W&&W.m(e,null),w=!0,h||(p=[Qe(i,"click",n[20],!1,!1,!1,!1),Qe(b,"input",n[21]),Qe(S,"click",n[22],!1,!1,!1,!1)],h=!0)},p:function(L,Z){L[6]?d?d.p(L,Z):(d=rn(L),d.c(),d.m(a,s)):d&&(d.d(1),d=null),v!==(v=_(L))&&($.d(1),$=v(L),$&&($.c(),$.m(i,null))),z===(z=K(L))&&R?R.p(L,Z):(R.d(1),R=z(L),R&&(R.c(),R.m(c,null))),(!w||Z[0]&40&&O!==(O=L[5]===null||L[3]))&&Dn(b,"disabled",O),Z[0]&4&&dt(b,L[2]),(!w||Z[0]&32&&F!==(F=L[5]===null))&&Dn(S,"disabled",F),L[4]!==null?W?W.p(L,Z):(W=sn(L),W.c(),W.m(e,null)):W&&(W.d(1),W=null)},i:function(L){w||(wa(t.$$.fragment,L),w=!0)},o:function(L){xa(t.$$.fragment,L),w=!1},d:function(L){L&&te(e),ka(t),d&&d.d(),$.d(),R.d(),W&&W.d(),h=!1,un(p)}};return Ne("SvelteRegisterBlock",{block:de,id:qs.name,type:"slot",source:"(183:0) <AuthCheck>",ctx:n}),de}function on(n){let e,t,r,a;r=new Ia({props:{$$slots:{default:[qs]},$$scope:{ctx:n}},$$inline:!0});const s={c:function(){e=ne("link"),t=ve(),_a(r.$$.fragment),this.h()},l:function(o){e=ae(o,"LINK",{rel:!0,href:!0}),t=we(o),ba(r.$$.fragment,o),this.h()},h:function(){Q(e,"rel","stylesheet"),Q(e,"href","https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"),re(e,se,351,0,5940)},m:function(o,u){Ce(o,e,u),Ce(o,t,u),va(r,o,u),a=!0},p:function(o,u){const c={};u[0]&511|u[1]&512&&(c.$$scope={dirty:u,ctx:o}),r.$set(c)},i:function(o){a||(wa(r.$$.fragment,o),a=!0)},o:function(o){xa(r.$$.fragment,o),a=!1},d:function(o){o&&(te(e),te(t)),ka(r,o)}};return Ne("SvelteRegisterBlock",{block:s,id:on.name,type:"component",source:"",ctx:n}),s}function Gl(n,e,t){let r,a,{$$slots:s={},$$scope:i}=e;Js("Page",s,[]);const o=_r(vr,br);let u,c,m="tiiuae/falcon-7b-instruct",k=.2,M="",q=!1,x=null,N="";const b=qr([]);An(b,"userChats"),In(n,b,T=>t(8,a=T));const O=qr([]);An(O,"selectedChatMessages"),In(n,O,T=>t(7,r=T));let j=null;async function S(){if(q)return;if(await _(),j!==null){const{data:oe,error:ce}=await o.from("chats").select("message").eq("chat_id",j);if(ce){t(4,x=ce.message),console.error("Error fetching chat messages:",ce.message);return}}const T=We();b.update(oe=>[...oe,{chat_id:T}]),t(5,j=T),O.set([])}async function P(T){const{data:oe,error:ce}=await o.from("chats").select("message").eq("chat_id",T).eq("is_user_message",!0).order("timestamp",{ascending:!0}).limit(1);return ce?(console.log("Error fetching first user message:",ce.message),t(4,x=ce.message),""):(console.log("messages",oe),oe.length>0?oe[0].message:"")}async function F(){const T=await _(),{data:oe,error:ce}=await o.from("chats").select("chat_id").eq("user_id",T);if(ce)console.error("Error fetching user chats:",ce.message),t(4,x=ce.message);else{const ye=new Set,D=[];for(const l of oe)if(!ye.has(l.chat_id)){ye.add(l.chat_id);const f=await P(l.chat_id);D.push({...l,firstUserMessage:f})}b.set(D)}}async function y(T){t(5,j=T);const{data:oe,error:ce}=await o.from("chats").select("message, is_user_message, timestamp").eq("chat_id",T).order("timestamp",{ascending:!0});ce?(console.error("Error fetching chat messages:",ce.message),t(4,x=ce.message)):O.set(oe)}async function w(T){console.log("selectedChatId",j),await o.from("chats").insert([{user_id:T,chat_id:j,message:M,is_user_message:!0,timestamp:new Date().toISOString()}]),console.log("selectedChatMessages",r),r.length===0&&F(),y(j)}async function h(){if(q)return;t(3,q=!0);const T=await _();console.log("userId",T),await w(T),console.log("finised"),console.log("selectedchatid in funciton",j),await d(T),t(3,q=!1)}async function p(T,oe){await o.from("chats").insert([{user_id:oe,chat_id:j,message:T,is_user_message:!1,timestamp:new Date().toISOString()}]),y(j)}async function d(T){const oe=_r(vr,br),ce=Qr;c=new Wr({openAIApiKey:ce}),u=new Jr(c,{client:oe,tableName:"documents"});let ye=await pa(Rn,u,m,k,M);await p(ye,T),t(2,M="")}async function _(){const T=await o.auth.getUser();return T?T.data.user.id:null}function v(T){y(T)}async function $(T){if(q)return;const oe=j===T,{data:ce,error:ye}=await o.from("chats").delete().eq("chat_id",T);if(ye)console.error("Error deleting chat:",ye.message),t(4,x=ye.message);else{const D=await _(),{data:l}=await o.from("chats").select("chat_id").eq("user_id",D).order("timestamp",{ascending:!1}).limit(1),f=l.length>0?l[0].chat_id:null;await F(),oe&&t(5,j=f)}}Cn(async()=>{await F(),await S()});let K=!1;function z(){t(6,K=!K)}const R=[];Object.keys(e).forEach(T=>{!~R.indexOf(T)&&T.slice(0,2)!=="$$"&&T!=="slot"&&Yl.warn(`<Page> was created with unknown prop '${T}'`)});function W(){m=Qs(this),t(0,m)}function de(){k=Xs(this.value),t(1,k)}const E=T=>$(T.chat_id),L=T=>v(T.chat_id.slice(0,36)),Z=()=>z();function ie(){M=this.value,t(2,M)}const pe=()=>h();return n.$capture_state=()=>({chatWithDoc:pa,AuthCheck:Ia,NavBar:Ca,onMount:Cn,onDestroy:Hs,GoTrueAdminApi:ii,createClient:_r,OpenAIEmbeddings:Wr,SupabaseVectorStore:Jr,writable:qr,HuggingFaceInferenceEmbeddings:li,PUBLIC_SUPABASE_KEY:br,PUBLIC_SUPABASE_URL:vr,PUBLIC_HUGGINGFACE_API_KEY:Rn,PUBLIC_OPENAI_API_KEY:Qr,uuidv4:We,supabaseClient:o,vector:u,embeddings:c,model:m,temperature:k,question:M,loading:q,errorText:x,responseText:N,userChats:b,selectedChatMessages:O,selectedChatId:j,createNewChat:S,getFirstUserMessage:P,loadUserChats:F,loadChatMessages:y,sendMessage:w,sendUserMessageAndAIResponse:h,saveAIResponse:p,getAIResponse:d,getCurrentUserId:_,selectChat:v,deleteChat:$,isChatHistorySidebarOpen:K,toggleSidebar:z,$selectedChatMessages:r,$userChats:a}),n.$inject_state=T=>{"vector"in T&&(u=T.vector),"embeddings"in T&&(c=T.embeddings),"model"in T&&t(0,m=T.model),"temperature"in T&&t(1,k=T.temperature),"question"in T&&t(2,M=T.question),"loading"in T&&t(3,q=T.loading),"errorText"in T&&t(4,x=T.errorText),"responseText"in T&&(N=T.responseText),"selectedChatId"in T&&t(5,j=T.selectedChatId),"isChatHistorySidebarOpen"in T&&t(6,K=T.isChatHistorySidebarOpen)},e&&"$$inject"in e&&n.$inject_state(e.$$inject),[m,k,M,q,x,j,K,r,a,b,O,S,h,v,$,z,W,de,E,L,Z,ie,pe]}class sc extends Gs{constructor(e){super(e),Ws(this,e,Gl,on,zs,{},null,[-1,-1]),Ne("SvelteRegisterComponent",{component:this,tagName:"Page",options:e,id:on.name})}}export{cr as B,at as C,De as L,ke as P,Hl as a,zl as b,ac as c,Bi as d,Hi as e,Ba as f,Ra as g,sc as h,Ao as l,Va as r,zo as z};
