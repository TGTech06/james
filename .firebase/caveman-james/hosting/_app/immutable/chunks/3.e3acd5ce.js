import{s as bs,v as en,h as tn,o as rn,i as vs,d as ue,r as Cr,j as ws,n as ea}from"./scheduler.2364b0ad.js";import{S as Is,i as Ps,d as Me,v as Ts,j as le,s as Ee,u as ta,k as ce,c as ke,w as ra,m as ae,a as Le,x as na,f as aa,t as sa,g as oe,y as ia,C as Os,D as Es,E as Ut,o as st,l as _e,A as Fe,p as it,n as oa,z as te,F as Xe,B as He,G as nn,H as an,q as Bt,I as ua,J as sn}from"./index.be5c2245.js";import{a as ot,_ as at,p as ks,b as je,c as As,d as la,R as xr,B as ca,H as $t,e as jr,f as da,h as on,i as Cs,j as un,k as xs,C as js,l as Ss,A as ha,N as fa,O as ln,S as cn,g as Ns}from"./NavBar.9cc01a6e.js";import{g as pa,_ as Ne,e as Oe,c as Zt,P as Mt,a as Rt,d as vr,G as Ds,b as dn}from"./public.41f5b175.js";import{g as Ls,T as Zs,c as jt}from"./_commonjs-dynamic-modules.6fed1697.js";import{w as ur}from"./index.db1f7a41.js";import{H as Ms}from"./hf.d76b572f.js";let St;const Rs=new Uint8Array(16);function Us(){if(!St&&(St=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!St))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return St(Rs)}const Ae=[];for(let n=0;n<256;++n)Ae.push((n+256).toString(16).slice(1));function Vs(n,e=0){return(Ae[n[e+0]]+Ae[n[e+1]]+Ae[n[e+2]]+Ae[n[e+3]]+"-"+Ae[n[e+4]]+Ae[n[e+5]]+"-"+Ae[n[e+6]]+Ae[n[e+7]]+"-"+Ae[n[e+8]]+Ae[n[e+9]]+"-"+Ae[n[e+10]]+Ae[n[e+11]]+Ae[n[e+12]]+Ae[n[e+13]]+Ae[n[e+14]]+Ae[n[e+15]]).toLowerCase()}const Bs=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),hn={randomUUID:Bs};function qe(n,e,r){if(hn.randomUUID&&!e&&!n)return hn.randomUUID();n=n||{};const t=n.random||(n.rng||Us)();if(t[6]=t[6]&15|64,t[8]=t[8]&63|128,e){r=r||0;for(let a=0;a<16;++a)e[r+a]=t[a];return e}return Vs(t)}class $s{}class Et extends $s{get lc_namespace(){return["langchain","callbacks",this.name]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}constructor(e){var r;super(),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ignoreLLM",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreChain",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreAgent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"awaitHandlers",{enumerable:!0,configurable:!0,writable:!0,value:typeof process<"u"?((r=process.env)==null?void 0:r.LANGCHAIN_CALLBACKS_BACKGROUND)!=="true":!0}),this.lc_kwargs=e||{},e&&(this.ignoreLLM=e.ignoreLLM??this.ignoreLLM,this.ignoreChain=e.ignoreChain??this.ignoreChain,this.ignoreAgent=e.ignoreAgent??this.ignoreAgent)}copy(){return new this.constructor(this)}toJSON(){return ot.prototype.toJSON.call(this)}toJSONNotImplemented(){return ot.prototype.toJSONNotImplemented.call(this)}static fromMethods(e){class r extends Et{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:qe()}),Object.assign(this,e)}}return new r}}var Sr={exports:{}};Sr.exports;(function(n){const r=(s=0)=>o=>`\x1B[${38+s};5;${o}m`,t=(s=0)=>(o,l,u)=>`\x1B[${38+s};2;${o};${l};${u}m`;function a(){const s=new Map,o={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};o.color.gray=o.color.blackBright,o.bgColor.bgGray=o.bgColor.bgBlackBright,o.color.grey=o.color.blackBright,o.bgColor.bgGrey=o.bgColor.bgBlackBright;for(const[l,u]of Object.entries(o)){for(const[d,v]of Object.entries(u))o[d]={open:`\x1B[${v[0]}m`,close:`\x1B[${v[1]}m`},u[d]=o[d],s.set(v[0],v[1]);Object.defineProperty(o,l,{value:u,enumerable:!1})}return Object.defineProperty(o,"codes",{value:s,enumerable:!1}),o.color.close="\x1B[39m",o.bgColor.close="\x1B[49m",o.color.ansi256=r(),o.color.ansi16m=t(),o.bgColor.ansi256=r(10),o.bgColor.ansi16m=t(10),Object.defineProperties(o,{rgbToAnsi256:{value:(l,u,d)=>l===u&&u===d?l<8?16:l>248?231:Math.round((l-8)/247*24)+232:16+36*Math.round(l/255*5)+6*Math.round(u/255*5)+Math.round(d/255*5),enumerable:!1},hexToRgb:{value:l=>{const u=/(?<colorString>[a-f\d]{6}|[a-f\d]{3})/i.exec(l.toString(16));if(!u)return[0,0,0];let{colorString:d}=u.groups;d.length===3&&(d=d.split("").map(C=>C+C).join(""));const v=Number.parseInt(d,16);return[v>>16&255,v>>8&255,v&255]},enumerable:!1},hexToAnsi256:{value:l=>o.rgbToAnsi256(...o.hexToRgb(l)),enumerable:!1}}),o}Object.defineProperty(n,"exports",{enumerable:!0,get:a})})(Sr);var Ks=Sr.exports;const ma=pa(Ks);class Nr extends Et{constructor(e){super(...arguments),Object.defineProperty(this,"runMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map})}copy(){return this}_addChildRun(e,r){e.child_runs.push(r)}_startTrace(e){if(e.parent_run_id!==void 0){const r=this.runMap.get(e.parent_run_id);r&&this._addChildRun(r,e)}this.runMap.set(e.id,e)}async _endTrace(e){const r=e.parent_run_id!==void 0&&this.runMap.get(e.parent_run_id);r?r.child_execution_order=Math.max(r.child_execution_order,e.child_execution_order):await this.persistRun(e),this.runMap.delete(e.id)}_getExecutionOrder(e){const r=e!==void 0&&this.runMap.get(e);return r?r.child_execution_order+1:1}async handleLLMStart(e,r,t,a,s,o,l){var V;const u=this._getExecutionOrder(a),d=Date.now(),v=l?{...s,metadata:l}:s,C={id:t,name:e.id[e.id.length-1],parent_run_id:a,start_time:d,serialized:e,events:[{name:"start",time:d}],inputs:{prompts:r},execution_order:u,child_runs:[],child_execution_order:u,run_type:"llm",extra:v??{},tags:o||[]};this._startTrace(C),await((V=this.onLLMStart)==null?void 0:V.call(this,C))}async handleChatModelStart(e,r,t,a,s,o,l){var V;const u=this._getExecutionOrder(a),d=Date.now(),v=l?{...s,metadata:l}:s,C={id:t,name:e.id[e.id.length-1],parent_run_id:a,start_time:d,serialized:e,events:[{name:"start",time:d}],inputs:{messages:r},execution_order:u,child_runs:[],child_execution_order:u,run_type:"llm",extra:v??{},tags:o||[]};this._startTrace(C),await((V=this.onLLMStart)==null?void 0:V.call(this,C))}async handleLLMEnd(e,r){var a;const t=this.runMap.get(r);if(!t||(t==null?void 0:t.run_type)!=="llm")throw new Error("No LLM run to end.");t.end_time=Date.now(),t.outputs=e,t.events.push({name:"end",time:t.end_time}),await((a=this.onLLMEnd)==null?void 0:a.call(this,t)),await this._endTrace(t)}async handleLLMError(e,r){var a;const t=this.runMap.get(r);if(!t||(t==null?void 0:t.run_type)!=="llm")throw new Error("No LLM run to end.");t.end_time=Date.now(),t.error=e.message,t.events.push({name:"error",time:t.end_time}),await((a=this.onLLMError)==null?void 0:a.call(this,t)),await this._endTrace(t)}async handleChainStart(e,r,t,a,s,o){var v;const l=this._getExecutionOrder(a),u=Date.now(),d={id:t,name:e.id[e.id.length-1],parent_run_id:a,start_time:u,serialized:e,events:[{name:"start",time:u}],inputs:r,execution_order:l,child_execution_order:l,run_type:"chain",child_runs:[],extra:o?{metadata:o}:{},tags:s||[]};this._startTrace(d),await((v=this.onChainStart)==null?void 0:v.call(this,d))}async handleChainEnd(e,r){var a;const t=this.runMap.get(r);if(!t||(t==null?void 0:t.run_type)!=="chain")throw new Error("No chain run to end.");t.end_time=Date.now(),t.outputs=e,t.events.push({name:"end",time:t.end_time}),await((a=this.onChainEnd)==null?void 0:a.call(this,t)),await this._endTrace(t)}async handleChainError(e,r){var a;const t=this.runMap.get(r);if(!t||(t==null?void 0:t.run_type)!=="chain")throw new Error("No chain run to end.");t.end_time=Date.now(),t.error=e.message,t.events.push({name:"error",time:t.end_time}),await((a=this.onChainError)==null?void 0:a.call(this,t)),await this._endTrace(t)}async handleToolStart(e,r,t,a,s,o){var v;const l=this._getExecutionOrder(a),u=Date.now(),d={id:t,name:e.id[e.id.length-1],parent_run_id:a,start_time:u,serialized:e,events:[{name:"start",time:u}],inputs:{input:r},execution_order:l,child_execution_order:l,run_type:"tool",child_runs:[],extra:o?{metadata:o}:{},tags:s||[]};this._startTrace(d),await((v=this.onToolStart)==null?void 0:v.call(this,d))}async handleToolEnd(e,r){var a;const t=this.runMap.get(r);if(!t||(t==null?void 0:t.run_type)!=="tool")throw new Error("No tool run to end");t.end_time=Date.now(),t.outputs={output:e},t.events.push({name:"end",time:t.end_time}),await((a=this.onToolEnd)==null?void 0:a.call(this,t)),await this._endTrace(t)}async handleToolError(e,r){var a;const t=this.runMap.get(r);if(!t||(t==null?void 0:t.run_type)!=="tool")throw new Error("No tool run to end");t.end_time=Date.now(),t.error=e.message,t.events.push({name:"error",time:t.end_time}),await((a=this.onToolError)==null?void 0:a.call(this,t)),await this._endTrace(t)}async handleAgentAction(e,r){var s;const t=this.runMap.get(r);if(!t||(t==null?void 0:t.run_type)!=="chain")return;const a=t;a.actions=a.actions||[],a.actions.push(e),a.events.push({name:"agent_action",time:Date.now(),kwargs:{action:e}}),await((s=this.onAgentAction)==null?void 0:s.call(this,t))}async handleAgentEnd(e,r){var a;const t=this.runMap.get(r);!t||(t==null?void 0:t.run_type)!=="chain"||(t.events.push({name:"agent_end",time:Date.now(),kwargs:{action:e}}),await((a=this.onAgentEnd)==null?void 0:a.call(this,t)))}async handleText(e,r){var a;const t=this.runMap.get(r);!t||(t==null?void 0:t.run_type)!=="chain"||(t.events.push({name:"text",time:Date.now(),kwargs:{text:e}}),await((a=this.onText)==null?void 0:a.call(this,t)))}async handleLLMNewToken(e,r,t){var s;const a=this.runMap.get(t);!a||(a==null?void 0:a.run_type)!=="llm"||(a.events.push({name:"new_token",time:Date.now(),kwargs:{token:e,idx:r}}),await((s=this.onLLMNewToken)==null?void 0:s.call(this,a)))}}function Ue(n,e){return`${n.open}${e}${n.close}`}function Ge(n,e){try{return JSON.stringify(n,null,2)}catch{return e}}function rt(n){if(!n.end_time)return"";const e=n.end_time-n.start_time;return e<1e3?`${e}ms`:`${(e/1e3).toFixed(2)}s`}const{color:Ve}=ma;class fn extends Nr{constructor(){super(...arguments),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"console_callback_handler"})}persistRun(e){return Promise.resolve()}getParents(e){const r=[];let t=e;for(;t.parent_run_id;){const a=this.runMap.get(t.parent_run_id);if(a)r.push(a),t=a;else break}return r}getBreadcrumbs(e){const t=[...this.getParents(e).reverse(),e].map((a,s,o)=>{const l=`${a.execution_order}:${a.run_type}:${a.name}`;return s===o.length-1?Ue(ma.bold,l):l}).join(" > ");return Ue(Ve.grey,t)}onChainStart(e){const r=this.getBreadcrumbs(e);console.log(`${Ue(Ve.green,"[chain/start]")} [${r}] Entering Chain run with input: ${Ge(e.inputs,"[inputs]")}`)}onChainEnd(e){const r=this.getBreadcrumbs(e);console.log(`${Ue(Ve.cyan,"[chain/end]")} [${r}] [${rt(e)}] Exiting Chain run with output: ${Ge(e.outputs,"[outputs]")}`)}onChainError(e){const r=this.getBreadcrumbs(e);console.log(`${Ue(Ve.red,"[chain/error]")} [${r}] [${rt(e)}] Chain run errored with error: ${Ge(e.error,"[error]")}`)}onLLMStart(e){const r=this.getBreadcrumbs(e),t="prompts"in e.inputs?{prompts:e.inputs.prompts.map(a=>a.trim())}:e.inputs;console.log(`${Ue(Ve.green,"[llm/start]")} [${r}] Entering LLM run with input: ${Ge(t,"[inputs]")}`)}onLLMEnd(e){const r=this.getBreadcrumbs(e);console.log(`${Ue(Ve.cyan,"[llm/end]")} [${r}] [${rt(e)}] Exiting LLM run with output: ${Ge(e.outputs,"[response]")}`)}onLLMError(e){const r=this.getBreadcrumbs(e);console.log(`${Ue(Ve.red,"[llm/error]")} [${r}] [${rt(e)}] LLM run errored with error: ${Ge(e.error,"[error]")}`)}onToolStart(e){var t;const r=this.getBreadcrumbs(e);console.log(`${Ue(Ve.green,"[tool/start]")} [${r}] Entering Tool run with input: "${(t=e.inputs.input)==null?void 0:t.trim()}"`)}onToolEnd(e){var t,a;const r=this.getBreadcrumbs(e);console.log(`${Ue(Ve.cyan,"[tool/end]")} [${r}] [${rt(e)}] Exiting Tool run with output: "${(a=(t=e.outputs)==null?void 0:t.output)==null?void 0:a.trim()}"`)}onToolError(e){const r=this.getBreadcrumbs(e);console.log(`${Ue(Ve.red,"[tool/error]")} [${r}] [${rt(e)}] Tool run errored with error: ${Ge(e.error,"[error]")}`)}onAgentAction(e){const r=e,t=this.getBreadcrumbs(e);console.log(`${Ue(Ve.blue,"[agent/action]")} [${t}] Agent selected action: ${Ge(r.actions[r.actions.length-1],"[action]")}`)}}const zs=[400,401,403,404,405,406,407,408,409];class Fs{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6;const r="default"in at?at.default:at;this.queue=new r({concurrency:this.maxConcurrency})}call(e,...r){return this.queue.add(()=>ks(()=>e(...r).catch(t=>{throw t instanceof Error?t:new Error(t)}),{onFailedAttempt(t){var s;if(t.message.startsWith("Cancel")||t.message.startsWith("TimeoutError")||t.message.startsWith("AbortError")||(t==null?void 0:t.code)==="ECONNABORTED")throw t;const a=(s=t==null?void 0:t.response)==null?void 0:s.status;if(a&&zs.includes(+a))throw t},retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,r,...t){return e.signal?Promise.race([this.call(r,...t),new Promise((a,s)=>{var o;(o=e.signal)==null||o.addEventListener("abort",()=>{s(new Error("AbortError"))})})]):this.call(r,...t)}fetch(...e){return this.call(()=>fetch(...e).then(r=>r.ok?r:Promise.reject(r)))}}const qs=()=>typeof window<"u"&&typeof window.document<"u",Hs=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",Ys=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom")),ga=()=>typeof Deno<"u",Gs=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!ga(),Ws=()=>{let n;return qs()?n="browser":Gs()?n="node":Hs()?n="webworker":Ys()?n="jsdom":ga()?n="deno":n="other",n};let lr;async function Js(){return lr===void 0&&(lr={library:"langsmith",runtime:Ws()}),lr}function pn(n){var e;try{return typeof process<"u"?(e=process.env)==null?void 0:e[n]:void 0}catch{return}}const Qs=n=>{const r=n.replace("http://","").replace("https://","").split("/")[0].split(":")[0];return r==="localhost"||r==="127.0.0.1"||r==="::1"},Nt=async(n,e)=>{const r=await n.text();if(!n.ok)throw new Error(`Failed to ${e}: ${n.status} ${n.statusText} ${r}`)};class Dr{constructor(e={}){Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout_ms",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const r=Dr.getDefaultClientConfig();this.apiUrl=e.apiUrl??r.apiUrl,this.apiKey=e.apiKey??r.apiKey,this.validateApiKeyIfHosted(),this.timeout_ms=e.timeout_ms??4e3,this.caller=new Fs(e.callerOptions??{})}static getDefaultClientConfig(){return{apiUrl:pn("LANGCHAIN_ENDPOINT")??"http://localhost:1984",apiKey:pn("LANGCHAIN_API_KEY")}}validateApiKeyIfHosted(){if(!Qs(this.apiUrl)&&!this.apiKey)throw new Error("API key must be provided when using hosted LangSmith API")}get headers(){const e={};return this.apiKey&&(e["x-api-key"]=`${this.apiKey}`),e}async _get(e,r){const t=(r==null?void 0:r.toString())??"",a=`${this.apiUrl}${e}?${t}`,s=await this.caller.call(fetch,a,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});if(!s.ok)throw new Error(`Failed to fetch ${e}: ${s.status} ${s.statusText}`);return s.json()}async createRun(e){const r={...this.headers,"Content-Type":"application/json"},t=e.extra??{},a=await Js(),s=e.project_name;delete e.project_name;const o={session_name:s,...e,extra:{...e.extra,runtime:{...a,...t.runtime}}},l=await this.caller.call(fetch,`${this.apiUrl}/runs`,{method:"POST",headers:r,body:JSON.stringify(o),signal:AbortSignal.timeout(this.timeout_ms)});await Nt(l,"create run")}async updateRun(e,r){const t={...this.headers,"Content-Type":"application/json"},a=await this.caller.call(fetch,`${this.apiUrl}/runs/${e}`,{method:"PATCH",headers:t,body:JSON.stringify(r),signal:AbortSignal.timeout(this.timeout_ms)});await Nt(a,"update run")}async readRun(e,{loadChildRuns:r}={loadChildRuns:!1}){let t=await this._get(`/runs/${e}`);return r&&t.child_run_ids&&(t=await this._loadChildRuns(t)),t}async _loadChildRuns(e){const r=await this.listRuns({id:e.child_run_ids}),t={},a={};r.sort((s,o)=>s.execution_order-o.execution_order);for(const s of r){if(s.parent_run_id===null||s.parent_run_id===void 0)throw new Error(`Child run ${s.id} has no parent`);s.parent_run_id in t||(t[s.parent_run_id]=[]),t[s.parent_run_id].push(s),a[s.id]=s}e.child_runs=t[e.id]||[];for(const s in t)s!==e.id&&(a[s].child_runs=t[s]);return e}async listRuns({projectId:e,projectName:r,executionOrder:t,runType:a,error:s,id:o,limit:l,offset:u}){const d=new URLSearchParams;let v=e;if(r){if(e)throw new Error("Only one of projectId or projectName may be given");v=(await this.readProject({projectName:r})).id}if(v&&d.append("session",v),t&&d.append("execution_order",t.toString()),a&&d.append("run_type",a),s!==void 0&&d.append("error",s.toString()),o!==void 0)for(const C of o)d.append("id",C);return l!==void 0&&d.append("limit",l.toString()),u!==void 0&&d.append("offset",u.toString()),this._get("/runs",d)}async deleteRun(e){const r=await this.caller.call(fetch,`${this.apiUrl}/runs/${e}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});await Nt(r,"delete run")}async createProject({projectName:e,projectExtra:r,upsert:t}){const a=t?"?upsert=true":"",s=`${this.apiUrl}/sessions${a}`,o={name:e};r!==void 0&&(o.extra=r);const l=await this.caller.call(fetch,s,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(o),signal:AbortSignal.timeout(this.timeout_ms)}),u=await l.json();if(!l.ok)throw new Error(`Failed to create session ${e}: ${l.status} ${l.statusText}`);return u}async readProject({projectId:e,projectName:r}){let t="/sessions";const a=new URLSearchParams;if(e!==void 0&&r!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(e!==void 0)t+=`/${e}`;else if(r!==void 0)a.append("name",r);else throw new Error("Must provide projectName or projectId");const s=await this._get(t,a);let o;if(Array.isArray(s)){if(s.length===0)throw new Error(`Project[id=${e}, name=${r}] not found`);o=s[0]}else o=s;return o}async listProjects(){return this._get("/sessions")}async deleteProject({projectId:e,projectName:r}){let t;if(e===void 0&&r===void 0)throw new Error("Must provide projectName or projectId");if(e!==void 0&&r!==void 0)throw new Error("Must provide either projectName or projectId, not both");e===void 0?t=(await this.readProject({projectName:r})).id:t=e;const a=await this.caller.call(fetch,`${this.apiUrl}/sessions/${t}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});await Nt(a,`delete session ${t} (${r})`)}async uploadCsv({csvFile:e,fileName:r,inputKeys:t,outputKeys:a,description:s,dataType:o,name:l}){const u=`${this.apiUrl}/datasets/upload`,d=new FormData;d.append("file",e,r),t.forEach(V=>{d.append("input_keys",V)}),a.forEach(V=>{d.append("output_keys",V)}),s&&d.append("description",s),o&&d.append("data_type",o),l&&d.append("name",l);const v=await this.caller.call(fetch,u,{method:"POST",headers:this.headers,body:d,signal:AbortSignal.timeout(this.timeout_ms)});if(!v.ok){const V=await v.json();throw V.detail&&V.detail.includes("already exists")?new Error(`Dataset ${r} already exists`):new Error(`Failed to upload CSV: ${v.status} ${v.statusText}`)}return await v.json()}async createDataset(e,{description:r,dataType:t}={}){const a={name:e,description:r};t&&(a.data_type=t);const s=await this.caller.call(fetch,`${this.apiUrl}/datasets`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(a),signal:AbortSignal.timeout(this.timeout_ms)});if(!s.ok){const l=await s.json();throw l.detail&&l.detail.includes("already exists")?new Error(`Dataset ${e} already exists`):new Error(`Failed to create dataset ${s.status} ${s.statusText}`)}return await s.json()}async readDataset({datasetId:e,datasetName:r}){let t="/datasets";const a=new URLSearchParams({limit:"1"});if(e!==void 0&&r!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(e!==void 0)t+=`/${e}`;else if(r!==void 0)a.append("name",r);else throw new Error("Must provide datasetName or datasetId");const s=await this._get(t,a);let o;if(Array.isArray(s)){if(s.length===0)throw new Error(`Dataset[id=${e}, name=${r}] not found`);o=s[0]}else o=s;return o}async listDatasets({limit:e=100,offset:r=0}={}){const t="/datasets",a=new URLSearchParams({limit:e.toString(),offset:r.toString()}),s=await this._get(t,a);if(!Array.isArray(s))throw new Error(`Expected ${t} to return an array, but got ${s}`);return s}async deleteDataset({datasetId:e,datasetName:r}){let t="/datasets",a=e;if(e!==void 0&&r!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(r!==void 0&&(a=(await this.readDataset({datasetName:r})).id),a!==void 0)t+=`/${a}`;else throw new Error("Must provide datasetName or datasetId");const s=await this.caller.call(fetch,this.apiUrl+t,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});if(!s.ok)throw new Error(`Failed to delete ${t}: ${s.status} ${s.statusText}`);await s.json()}async createExample(e,r,{datasetId:t,datasetName:a,createdAt:s}){let o=t;if(o===void 0&&a===void 0)throw new Error("Must provide either datasetName or datasetId");if(o!==void 0&&a!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");o===void 0&&(o=(await this.readDataset({datasetName:a})).id);const u={dataset_id:o,inputs:e,outputs:r,created_at:(s||new Date).toISOString()},d=await this.caller.call(fetch,`${this.apiUrl}/examples`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(u),signal:AbortSignal.timeout(this.timeout_ms)});if(!d.ok)throw new Error(`Failed to create example: ${d.status} ${d.statusText}`);return await d.json()}async readExample(e){const r=`/examples/${e}`;return await this._get(r)}async listExamples({datasetId:e,datasetName:r,limit:t,offset:a}={}){let s;if(e!==void 0&&r!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(e!==void 0)s=e;else if(r!==void 0)s=(await this.readDataset({datasetName:r})).id;else throw new Error("Must provide a datasetName or datasetId");const o=await this._get("/examples",new URLSearchParams({dataset:s,limit:(t==null?void 0:t.toString())??"100",offset:(a==null?void 0:a.toString())??"0"}));if(!Array.isArray(o))throw new Error(`Expected /examples to return an array, but got ${o}`);return o}async deleteExample(e){const r=`/examples/${e}`,t=await this.caller.call(fetch,this.apiUrl+r,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});if(!t.ok)throw new Error(`Failed to delete ${r}: ${t.status} ${t.statusText}`);await t.json()}async updateExample(e,r){const t=await this.caller.call(fetch,`${this.apiUrl}/examples/${e}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(r),signal:AbortSignal.timeout(this.timeout_ms)});if(!t.ok)throw new Error(`Failed to update example ${e}: ${t.status} ${t.statusText}`);return await t.json()}async evaluateRun(e,r,{sourceInfo:t,loadChildRuns:a}={loadChildRuns:!1}){let s;if(typeof e=="string")s=await this.readRun(e,{loadChildRuns:a});else if(typeof e=="object"&&"id"in e)s=e;else throw new Error(`Invalid run type: ${typeof e}`);let o;s.reference_example_id!==null&&s.reference_example_id!==void 0&&(o=await this.readExample(s.reference_example_id));const l=await r.evaluateRun(s,o);let u=t??{};return l.evaluatorInfo&&(u={...u,...l.evaluatorInfo}),await this.createFeedback(s.id,l.key,{score:l.score,value:l.value,comment:l.comment,correction:l.correction,sourceInfo:u,feedbackSourceType:"MODEL"})}async createFeedback(e,r,{score:t,value:a,correction:s,comment:o,sourceInfo:l,feedbackSourceType:u="API"}){let d;if(u==="API")d={type:"api",metadata:l??{}};else if(u==="MODEL")d={type:"model",metadata:l??{}};else throw new Error(`Unknown feedback source type ${u}`);const v={id:qe(),run_id:e,key:r,score:t,value:a,correction:s,comment:o,feedback_source:d},C=await this.caller.call(fetch,`${this.apiUrl}/feedback`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(v),signal:AbortSignal.timeout(this.timeout_ms)});if(!C.ok)throw new Error(`Failed to create feedback for run ${e}: ${C.status} ${C.statusText}`);return await C.json()}async readFeedback(e){const r=`/feedback/${e}`;return await this._get(r)}async deleteFeedback(e){const r=`/feedback/${e}`,t=await this.caller.call(fetch,this.apiUrl+r,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});if(!t.ok)throw new Error(`Failed to delete ${r}: ${t.status} ${t.statusText}`);await t.json()}async listFeedback({runIds:e,limit:r,offset:t}={}){const a=new URLSearchParams;return e&&a.append("run",e.join(",")),r!==void 0&&a.append("limit",r.toString()),t!==void 0&&a.append("offset",t.toString()),await this._get("/feedback",a)}}class Xs extends Nr{constructor(e={}){super(e),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"langchain_tracer"}),Object.defineProperty(this,"projectName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exampleId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const{exampleId:r,projectName:t,client:a}=e;this.projectName=t??je("LANGCHAIN_PROJECT")??je("LANGCHAIN_SESSION"),this.exampleId=r,this.client=a??new Dr({})}async _convertToCreate(e,r=void 0){return{...e,extra:{...e.extra,runtime:await As()},child_runs:void 0,session_name:this.projectName,reference_example_id:e.parent_run_id?void 0:r}}async persistRun(e){}async _persistRunSingle(e){const r=await this._convertToCreate(e,this.exampleId);await this.client.createRun(r)}async _updateRunSingle(e){const r={end_time:e.end_time,error:e.error,outputs:e.outputs,events:e.events};await this.client.updateRun(e.id,r)}async onLLMStart(e){await this._persistRunSingle(e)}async onLLMEnd(e){await this._updateRunSingle(e)}async onLLMError(e){await this._updateRunSingle(e)}async onChainStart(e){await this._persistRunSingle(e)}async onChainEnd(e){await this._updateRunSingle(e)}async onChainError(e){await this._updateRunSingle(e)}async onToolStart(e){await this._persistRunSingle(e)}async onToolEnd(e){await this._updateRunSingle(e)}async onToolError(e){await this._updateRunSingle(e)}}function Lr(n,e="Human",r="AI"){const t=[];for(const a of n){let s;if(a._getType()==="human")s=e;else if(a._getType()==="ai")s=r;else if(a._getType()==="system")s="System";else if(a._getType()==="function")s="Function";else if(a._getType()==="generic")s=a.role;else throw new Error(`Got unsupported message type: ${a}`);const o=a.name?`${a.name}, `:"";t.push(`${s}: ${o}${a.content}`)}return t.join(`
`)}class ei extends Nr{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"langchain_tracer"}),Object.defineProperty(this,"endpoint",{enumerable:!0,configurable:!0,writable:!0,value:je("LANGCHAIN_ENDPOINT")||"http://localhost:1984"}),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:{"Content-Type":"application/json"}}),Object.defineProperty(this,"session",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const e=je("LANGCHAIN_API_KEY");e&&(this.headers["x-api-key"]=e)}async newSession(e){const r={start_time:Date.now(),name:e},t=await this.persistSession(r);return this.session=t,t}async loadSession(e){const r=`${this.endpoint}/sessions?name=${e}`;return this._handleSessionResponse(r)}async loadDefaultSession(){const e=`${this.endpoint}/sessions?name=default`;return this._handleSessionResponse(e)}async convertV2RunToRun(e){var s;const r=this.session??await this.loadDefaultSession(),t=e.serialized;let a;if(e.run_type==="llm"){const o=e.inputs.prompts?e.inputs.prompts:e.inputs.messages.map(u=>Lr(u));a={uuid:e.id,start_time:e.start_time,end_time:e.end_time,execution_order:e.execution_order,child_execution_order:e.child_execution_order,serialized:t,type:e.run_type,session_id:r.id,prompts:o,response:e.outputs}}else if(e.run_type==="chain"){const o=await Promise.all(e.child_runs.map(u=>this.convertV2RunToRun(u)));a={uuid:e.id,start_time:e.start_time,end_time:e.end_time,execution_order:e.execution_order,child_execution_order:e.child_execution_order,serialized:t,type:e.run_type,session_id:r.id,inputs:e.inputs,outputs:e.outputs,child_llm_runs:o.filter(u=>u.type==="llm"),child_chain_runs:o.filter(u=>u.type==="chain"),child_tool_runs:o.filter(u=>u.type==="tool")}}else if(e.run_type==="tool"){const o=await Promise.all(e.child_runs.map(u=>this.convertV2RunToRun(u)));a={uuid:e.id,start_time:e.start_time,end_time:e.end_time,execution_order:e.execution_order,child_execution_order:e.child_execution_order,serialized:t,type:e.run_type,session_id:r.id,tool_input:e.inputs.input,output:(s=e.outputs)==null?void 0:s.output,action:JSON.stringify(t),child_llm_runs:o.filter(u=>u.type==="llm"),child_chain_runs:o.filter(u=>u.type==="chain"),child_tool_runs:o.filter(u=>u.type==="tool")}}else throw new Error(`Unknown run type: ${e.run_type}`);return a}async persistRun(e){let r,t;e.run_type!==void 0?t=await this.convertV2RunToRun(e):t=e,t.type==="llm"?r=`${this.endpoint}/llm-runs`:t.type==="chain"?r=`${this.endpoint}/chain-runs`:r=`${this.endpoint}/tool-runs`;const a=await fetch(r,{method:"POST",headers:this.headers,body:JSON.stringify(t)});a.ok||console.error(`Failed to persist run: ${a.status} ${a.statusText}`)}async persistSession(e){const r=`${this.endpoint}/sessions`,t=await fetch(r,{method:"POST",headers:this.headers,body:JSON.stringify(e)});return t.ok?{id:(await t.json()).id,...e}:(console.error(`Failed to persist session: ${t.status} ${t.statusText}, using default session.`),{id:1,...e})}async _handleSessionResponse(e){const r=await fetch(e,{method:"GET",headers:this.headers});let t;if(!r.ok)return console.error(`Failed to load session: ${r.status} ${r.statusText}`),t={id:1,start_time:Date.now()},this.session=t,t;const a=await r.json();return a.length===0?(t={id:1,start_time:Date.now()},this.session=t,t):([t]=a,this.session=t,t)}}async function ti(n){const e=new ei;return n?await e.loadSession(n):await e.loadDefaultSession(),e}async function ri(){return new Xs}let cr;function ni(){const n="default"in at?at.default:at;return new n({autoStart:!0,concurrency:1})}async function De(n,e){e===!0?await n():(typeof cr>"u"&&(cr=ni()),cr.add(n))}function ai(n){return n?Array.isArray(n)||"name"in n?{callbacks:n}:n:{}}class si{setHandler(e){return this.setHandlers([e])}}class Zr{constructor(e,r,t,a,s,o,l,u){Object.defineProperty(this,"runId",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:l}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:u})}async handleText(e){await Promise.all(this.handlers.map(r=>De(async()=>{var t;try{await((t=r.handleText)==null?void 0:t.call(r,e,this.runId,this._parentRunId,this.tags))}catch(a){console.error(`Error in handler ${r.constructor.name}, handleText: ${a}`)}},r.awaitHandlers)))}}class mn extends Zr{async handleLLMNewToken(e,r={prompt:0,completion:0}){await Promise.all(this.handlers.map(t=>De(async()=>{var a;if(!t.ignoreLLM)try{await((a=t.handleLLMNewToken)==null?void 0:a.call(t,e,r,this.runId,this._parentRunId,this.tags))}catch(s){console.error(`Error in handler ${t.constructor.name}, handleLLMNewToken: ${s}`)}},t.awaitHandlers)))}async handleLLMError(e){await Promise.all(this.handlers.map(r=>De(async()=>{var t;if(!r.ignoreLLM)try{await((t=r.handleLLMError)==null?void 0:t.call(r,e,this.runId,this._parentRunId,this.tags))}catch(a){console.error(`Error in handler ${r.constructor.name}, handleLLMError: ${a}`)}},r.awaitHandlers)))}async handleLLMEnd(e){await Promise.all(this.handlers.map(r=>De(async()=>{var t;if(!r.ignoreLLM)try{await((t=r.handleLLMEnd)==null?void 0:t.call(r,e,this.runId,this._parentRunId,this.tags))}catch(a){console.error(`Error in handler ${r.constructor.name}, handleLLMEnd: ${a}`)}},r.awaitHandlers)))}}class ii extends Zr{getChild(e){const r=new Ye(this.runId);return r.setHandlers(this.inheritableHandlers),r.addTags(this.inheritableTags),r.addMetadata(this.inheritableMetadata),e&&r.addTags([e],!1),r}async handleChainError(e){await Promise.all(this.handlers.map(r=>De(async()=>{var t;if(!r.ignoreChain)try{await((t=r.handleChainError)==null?void 0:t.call(r,e,this.runId,this._parentRunId,this.tags))}catch(a){console.error(`Error in handler ${r.constructor.name}, handleChainError: ${a}`)}},r.awaitHandlers)))}async handleChainEnd(e){await Promise.all(this.handlers.map(r=>De(async()=>{var t;if(!r.ignoreChain)try{await((t=r.handleChainEnd)==null?void 0:t.call(r,e,this.runId,this._parentRunId,this.tags))}catch(a){console.error(`Error in handler ${r.constructor.name}, handleChainEnd: ${a}`)}},r.awaitHandlers)))}async handleAgentAction(e){await Promise.all(this.handlers.map(r=>De(async()=>{var t;if(!r.ignoreAgent)try{await((t=r.handleAgentAction)==null?void 0:t.call(r,e,this.runId,this._parentRunId,this.tags))}catch(a){console.error(`Error in handler ${r.constructor.name}, handleAgentAction: ${a}`)}},r.awaitHandlers)))}async handleAgentEnd(e){await Promise.all(this.handlers.map(r=>De(async()=>{var t;if(!r.ignoreAgent)try{await((t=r.handleAgentEnd)==null?void 0:t.call(r,e,this.runId,this._parentRunId,this.tags))}catch(a){console.error(`Error in handler ${r.constructor.name}, handleAgentEnd: ${a}`)}},r.awaitHandlers)))}}class oi extends Zr{getChild(e){const r=new Ye(this.runId);return r.setHandlers(this.inheritableHandlers),r.addTags(this.inheritableTags),r.addMetadata(this.inheritableMetadata),e&&r.addTags([e],!1),r}async handleToolError(e){await Promise.all(this.handlers.map(r=>De(async()=>{var t;if(!r.ignoreAgent)try{await((t=r.handleToolError)==null?void 0:t.call(r,e,this.runId,this._parentRunId,this.tags))}catch(a){console.error(`Error in handler ${r.constructor.name}, handleToolError: ${a}`)}},r.awaitHandlers)))}async handleToolEnd(e){await Promise.all(this.handlers.map(r=>De(async()=>{var t;if(!r.ignoreAgent)try{await((t=r.handleToolEnd)==null?void 0:t.call(r,e,this.runId,this._parentRunId,this.tags))}catch(a){console.error(`Error in handler ${r.constructor.name}, handleToolEnd: ${a}`)}},r.awaitHandlers)))}}class Ye extends si{constructor(e){super(),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"callback_manager"}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.handlers=[],this.inheritableHandlers=[],this._parentRunId=e}async handleLLMStart(e,r,t=void 0,a=void 0,s=void 0){return Promise.all(r.map(async o=>{const l=qe();return await Promise.all(this.handlers.map(u=>De(async()=>{var d;if(!u.ignoreLLM)try{await((d=u.handleLLMStart)==null?void 0:d.call(u,e,[o],l,this._parentRunId,s,this.tags,this.metadata))}catch(v){console.error(`Error in handler ${u.constructor.name}, handleLLMStart: ${v}`)}},u.awaitHandlers))),new mn(l,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChatModelStart(e,r,t=void 0,a=void 0,s=void 0){return Promise.all(r.map(async o=>{const l=qe();return await Promise.all(this.handlers.map(u=>De(async()=>{var d,v;if(!u.ignoreLLM)try{if(u.handleChatModelStart)await((d=u.handleChatModelStart)==null?void 0:d.call(u,e,[o],l,this._parentRunId,s,this.tags,this.metadata));else if(u.handleLLMStart){const C=Lr(o);await((v=u.handleLLMStart)==null?void 0:v.call(u,e,[C],l,this._parentRunId,s,this.tags,this.metadata))}}catch(C){console.error(`Error in handler ${u.constructor.name}, handleLLMStart: ${C}`)}},u.awaitHandlers))),new mn(l,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChainStart(e,r,t=qe()){return await Promise.all(this.handlers.map(a=>De(async()=>{var s;if(!a.ignoreChain)try{await((s=a.handleChainStart)==null?void 0:s.call(a,e,r,t,this._parentRunId,this.tags,this.metadata))}catch(o){console.error(`Error in handler ${a.constructor.name}, handleChainStart: ${o}`)}},a.awaitHandlers))),new ii(t,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleToolStart(e,r,t=qe()){return await Promise.all(this.handlers.map(a=>De(async()=>{var s;if(!a.ignoreAgent)try{await((s=a.handleToolStart)==null?void 0:s.call(a,e,r,t,this._parentRunId,this.tags,this.metadata))}catch(o){console.error(`Error in handler ${a.constructor.name}, handleToolStart: ${o}`)}},a.awaitHandlers))),new oi(t,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}addHandler(e,r=!0){this.handlers.push(e),r&&this.inheritableHandlers.push(e)}removeHandler(e){this.handlers=this.handlers.filter(r=>r!==e),this.inheritableHandlers=this.inheritableHandlers.filter(r=>r!==e)}setHandlers(e,r=!0){this.handlers=[],this.inheritableHandlers=[];for(const t of e)this.addHandler(t,r)}addTags(e,r=!0){this.removeTags(e),this.tags.push(...e),r&&this.inheritableTags.push(...e)}removeTags(e){this.tags=this.tags.filter(r=>!e.includes(r)),this.inheritableTags=this.inheritableTags.filter(r=>!e.includes(r))}addMetadata(e,r=!0){this.metadata={...this.metadata,...e},r&&(this.inheritableMetadata={...this.inheritableMetadata,...e})}removeMetadata(e){for(const r of Object.keys(e))delete this.metadata[r],delete this.inheritableMetadata[r]}copy(e=[],r=!0){const t=new Ye(this._parentRunId);for(const a of this.handlers){const s=this.inheritableHandlers.includes(a);t.addHandler(a,s)}for(const a of this.tags){const s=this.inheritableTags.includes(a);t.addTags([a],s)}for(const a of Object.keys(this.metadata)){const s=Object.keys(this.inheritableMetadata).includes(a);t.addMetadata({[a]:this.metadata[a]},s)}for(const a of e)t.handlers.filter(s=>s.name==="console_callback_handler").some(s=>s.name===a.name)||t.addHandler(a,r);return t}static fromHandlers(e){class r extends Et{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:qe()}),Object.assign(this,e)}}const t=new this;return t.addHandler(new r),t}static async configure(e,r,t,a,s,o,l){let u;(e||r)&&(Array.isArray(e)||!e?(u=new Ye,u.setHandlers((e==null?void 0:e.map(gn))??[],!0)):u=e,u=u.copy(Array.isArray(r)?r.map(gn):r==null?void 0:r.handlers,!1));const d=je("LANGCHAIN_VERBOSE")||(l==null?void 0:l.verbose),v=je("LANGCHAIN_TRACING_V2")??!1,C=v||(je("LANGCHAIN_TRACING")??!1);if(d||C){if(u||(u=new Ye),d&&!u.handlers.some(V=>V.name===fn.prototype.name)){const V=new fn;u.addHandler(V,!0)}if(C&&!u.handlers.some(V=>V.name==="langchain_tracer"))if(v)u.addHandler(await ri(),!0);else{const V=je("LANGCHAIN_PROJECT")&&je("LANGCHAIN_SESSION");u.addHandler(await ti(V),!0)}}return(t||a)&&u&&(u.addTags(t??[]),u.addTags(a??[],!1)),(s||o)&&u&&(u.addMetadata(s??{}),u.addMetadata(o??{},!1)),u}}function gn(n){return"name"in n?n:Et.fromMethods(n)}const Dt={},ui=new la({});async function li(n,e){return n in Dt||(Dt[n]=ui.fetch(`https://tiktoken.pages.dev/js/${n}.json`,{signal:e==null?void 0:e.signal}).then(r=>r.json()).catch(r=>{throw delete Dt[n],r})),new Zs(await Dt[n],e==null?void 0:e.extendedSpecialTokens)}async function ya(n,e){return li(Ls(n),e)}const Vt=n=>n.startsWith("gpt-3.5-turbo-16k")?"gpt-3.5-turbo-16k":n.startsWith("gpt-3.5-turbo-")?"gpt-3.5-turbo":n.startsWith("gpt-4-32k")?"gpt-4-32k":n.startsWith("gpt-4-")?"gpt-4":n,ci=n=>{switch(Vt(n)){case"gpt-3.5-turbo-16k":return 16384;case"gpt-3.5-turbo":return 4096;case"gpt-4-32k":return 32768;case"gpt-4":return 8192;case"text-davinci-003":return 4097;case"text-curie-001":return 2048;case"text-babbage-001":return 2048;case"text-ada-001":return 2048;case"code-davinci-002":return 8e3;case"code-cushman-001":return 2048;default:return 4097}},kl=async({prompt:n,modelName:e})=>{let r;try{r=(await ya(e)).encode(n).length}catch{console.warn("Failed to calculate number of tokens, falling back to approximate count"),r=Math.ceil(n.length/4)}return ci(e)-r},di=()=>!1;class _a extends ot{get lc_attributes(){return{callbacks:void 0,verbose:void 0}}constructor(e){super(e),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.verbose=e.verbose??di(),this.callbacks=e.callbacks,this.tags=e.tags??[],this.metadata=e.metadata??{}}}class Mr extends _a{get callKeys(){return["stop","timeout","signal","tags","metadata","callbacks"]}constructor({callbacks:e,callbackManager:r,...t}){super({callbacks:e??r,...t}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_encoding",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.caller=new la(t??{})}async getNumTokens(e){let r=Math.ceil(e.length/4);if(!this._encoding)try{this._encoding=await ya("modelName"in this?Vt(this.modelName):"gpt2")}catch(t){console.warn("Failed to calculate number of tokens, falling back to approximate count",t)}return this._encoding&&(r=this._encoding.encode(e).length),r}_identifyingParams(){return{}}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}static async deserialize(e){const{_type:r,_model:t,...a}=e;if(t&&t!=="base_chat_model")throw new Error(`Cannot load LLM with model ${t}`);const s={openai:(await Ne(()=>Promise.resolve().then(()=>hl),void 0,import.meta.url)).ChatOpenAI}[r];if(s===void 0)throw new Error(`Cannot load  LLM with type ${r}`);return new s(a)}}class kt extends _a{get lc_namespace(){return["langchain","chains",this._chainType()]}constructor(e,r,t){if(arguments.length===1&&typeof e=="object"&&!("saveContext"in e)){const{memory:a,callbackManager:s,...o}=e;super({...o,callbacks:s??o.callbacks}),this.memory=a}else super({verbose:r,callbacks:t}),this.memory=e}_selectMemoryInputs(e){const r={...e};return"signal"in r&&delete r.signal,"timeout"in r&&delete r.timeout,r}serialize(){throw new Error("Method not implemented.")}async run(e,r){const t=this.inputKeys.filter(u=>{var d;return!((d=this.memory)!=null&&d.memoryKeys.includes(u))});if(!(t.length<=1))throw new Error(`Chain ${this._chainType()} expects multiple inputs, cannot use 'run' `);const s=t.length?{[t[0]]:e}:{},o=await this.call(s,r),l=Object.keys(o);if(l.length===1)return o[l[0]];throw new Error("return values have multiple keys, `run` only supported when one key currently")}async call(e,r,t){const a={...e};if(a.timeout&&!a.signal&&(a.signal=AbortSignal.timeout(a.timeout),delete a.timeout),this.memory!=null){const d=await this.memory.loadMemoryVariables(this._selectMemoryInputs(e));for(const[v,C]of Object.entries(d))a[v]=C}const s=ai(r),o=await Ye.configure(s.callbacks,this.callbacks,s.tags||t,this.tags,s.metadata,this.metadata,{verbose:this.verbose}),l=await(o==null?void 0:o.handleChainStart(this.toJSON(),a));let u;try{u=await(e.signal?Promise.race([this._call(a,l),new Promise((d,v)=>{var C;(C=e.signal)==null||C.addEventListener("abort",()=>{v(new Error("AbortError"))})})]):this._call(a,l))}catch(d){throw await(l==null?void 0:l.handleChainError(d)),d}return this.memory!=null&&await this.memory.saveContext(this._selectMemoryInputs(e),u),await(l==null?void 0:l.handleChainEnd(u)),Object.defineProperty(u,xr,{value:l?{runId:l==null?void 0:l.runId}:void 0,configurable:!0}),u}async apply(e,r){return Promise.all(e.map(async(t,a)=>this.call(t,r==null?void 0:r[a])))}static async deserialize(e,r={}){switch(e._type){case"llm_chain":{const{LLMChain:t}=await Ne(()=>Promise.resolve().then(()=>yi),void 0,import.meta.url);return t.deserialize(e)}case"sequential_chain":{const{SequentialChain:t}=await Ne(()=>import("./sequential_chain.19c27c22.js"),[],import.meta.url);return t.deserialize(e)}case"simple_sequential_chain":{const{SimpleSequentialChain:t}=await Ne(()=>import("./sequential_chain.19c27c22.js"),[],import.meta.url);return t.deserialize(e)}case"stuff_documents_chain":{const{StuffDocumentsChain:t}=await Ne(()=>Promise.resolve().then(()=>dr),void 0,import.meta.url);return t.deserialize(e)}case"map_reduce_documents_chain":{const{MapReduceDocumentsChain:t}=await Ne(()=>Promise.resolve().then(()=>dr),void 0,import.meta.url);return t.deserialize(e)}case"refine_documents_chain":{const{RefineDocumentsChain:t}=await Ne(()=>Promise.resolve().then(()=>dr),void 0,import.meta.url);return t.deserialize(e)}case"vector_db_qa":{const{VectorDBQAChain:t}=await Ne(()=>import("./vector_db_qa.3ba5114e.js"),[],import.meta.url);return t.deserialize(e,r)}case"api_chain":{const{APIChain:t}=await Ne(()=>import("./api_chain.eb6ac59c.js"),[],import.meta.url);return t.deserialize(e)}default:throw new Error(`Invalid prompt type in config: ${e._type}`)}}}class hi extends ca{constructor(e){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","prompts","base"]}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.value=e}toString(){return this.value}toChatMessages(){return[new $t(this.value)]}}class Rr extends ot{get lc_attributes(){return{partialVariables:void 0}}constructor(e){super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","prompts",this._getPromptType()]}),Object.defineProperty(this,"inputVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"partialVariables",{enumerable:!0,configurable:!0,writable:!0,value:{}});const{inputVariables:r}=e;if(r.includes("stop"))throw new Error("Cannot have an input variable named 'stop', as it is used internally, please rename.");Object.assign(this,e)}async mergePartialAndUserVariables(e){const r=this.partialVariables??{},t={};for(const[s,o]of Object.entries(r))typeof o=="string"?t[s]=o:t[s]=await o();return{...t,...e}}serialize(){throw new Error("Use .toJSON() instead")}static async deserialize(e){switch(e._type){case"prompt":{const{PromptTemplate:r}=await Ne(()=>Promise.resolve().then(()=>yn),void 0,import.meta.url);return r.deserialize(e)}case void 0:{const{PromptTemplate:r}=await Ne(()=>Promise.resolve().then(()=>yn),void 0,import.meta.url);return r.deserialize({...e,_type:"prompt"})}case"few_shot":{const{FewShotPromptTemplate:r}=await Ne(()=>import("./few_shot.04b3b565.js"),[],import.meta.url);return r.deserialize(e)}default:throw new Error(`Invalid prompt type in config: ${e._type}`)}}}class fi extends Rr{async formatPromptValue(e){const r=await this.format(e);return new hi(r)}}class pi extends ot{parseResultWithPrompt(e,r,t){return this.parseResult(e,t)}}class mi extends pi{parseResult(e,r){return this.parse(e[0].text,r)}async parseWithPrompt(e,r,t){return this.parse(e,t)}_type(){throw new Error("_type not implemented")}}class gi extends mi{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","default"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}parse(e){return Promise.resolve(e)}getFormatInstructions(){return""}}class Ze extends kt{get inputKeys(){return this.prompt.inputVariables}get outputKeys(){return[this.outputKey]}constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"prompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"llm",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"llmKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputKey",{enumerable:!0,configurable:!0,writable:!0,value:"text"}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.prompt=e.prompt,this.llm=e.llm,this.llmKwargs=e.llmKwargs,this.outputKey=e.outputKey??this.outputKey,this.outputParser=e.outputParser??new gi,this.prompt.outputParser){if(e.outputParser)throw new Error("Cannot set both outputParser and prompt.outputParser");this.outputParser=this.prompt.outputParser}}_selectMemoryInputs(e){const r=super._selectMemoryInputs(e);for(const t of this.llm.callKeys)t in e&&delete r[t];return r}async _getFinalOutput(e,r,t){let a;return this.outputParser?a=await this.outputParser.parseResultWithPrompt(e,r,t==null?void 0:t.getChild()):a=e[0].text,a}call(e,r){return super.call(e,r)}async _call(e,r){const t={...e},a={...this.llmKwargs};for(const l of this.llm.callKeys)l in e&&(a[l]=e[l],delete t[l]);const s=await this.prompt.formatPromptValue(t),{generations:o}=await this.llm.generatePrompt([s],a,r==null?void 0:r.getChild());return{[this.outputKey]:await this._getFinalOutput(o[0],s,r)}}async predict(e,r){return(await this.call(e,r))[this.outputKey]}_chainType(){return"llm"}static async deserialize(e){const{llm:r,prompt:t}=e;if(!r)throw new Error("LLMChain must have llm");if(!t)throw new Error("LLMChain must have prompt");return new Ze({llm:await Mr.deserialize(r),prompt:await Rr.deserialize(t)})}serialize(){return{_type:`${this._chainType()}_chain`,llm:this.llm.serialize(),prompt:this.prompt.serialize()}}}const yi=Object.freeze(Object.defineProperty({__proto__:null,LLMChain:Ze},Symbol.toStringTag,{value:"Module"})),ba=n=>{const e=n.split(""),r=[],t=(s,o)=>{for(let l=o;l<e.length;l+=1)if(s.includes(e[l]))return l;return-1};let a=0;for(;a<e.length;)if(e[a]==="{"&&a+1<e.length&&e[a+1]==="{")r.push({type:"literal",text:"{"}),a+=2;else if(e[a]==="}"&&a+1<e.length&&e[a+1]==="}")r.push({type:"literal",text:"}"}),a+=2;else if(e[a]==="{"){const s=t("}",a);if(s<0)throw new Error("Unclosed '{' in template.");r.push({type:"variable",name:e.slice(a+1,s).join("")}),a=s+1}else{if(e[a]==="}")throw new Error("Single '}' in template.");{const s=t("{}",a),o=(s<0?e.slice(a):e.slice(a,s)).join("");r.push({type:"literal",text:o}),a=s<0?e.length:s}}return r},_i=(n,e)=>ba(n).reduce((r,t)=>{if(t.type==="variable"){if(t.name in e)return r+e[t.name];throw new Error(`Missing value for input ${t.name}`)}return r+t.text},""),wr={"f-string":_i,jinja2:(n,e)=>""},bi={"f-string":ba,jinja2:n=>[]},va=(n,e,r)=>wr[e](n,r),vi=(n,e)=>bi[e](n),wi=(n,e,r)=>{if(!(e in wr)){const t=Object.keys(wr);throw new Error(`Invalid template format. Got \`${e}\`;
                         should be one of ${t}`)}try{const t=r.reduce((a,s)=>(a[s]="foo",a),{});va(n,e,t)}catch(t){throw new Error(`Invalid prompt schema: ${t.message}`)}};class Ce extends fi{constructor(e){if(super(e),Object.defineProperty(this,"template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.assign(this,e),this.validateTemplate){let r=this.inputVariables;this.partialVariables&&(r=r.concat(Object.keys(this.partialVariables))),wi(this.template,this.templateFormat,r)}}_getPromptType(){return"prompt"}async format(e){const r=await this.mergePartialAndUserVariables(e);return va(this.template,this.templateFormat,r)}static fromExamples(e,r,t,a=`

`,s=""){const o=[s,...e,r].join(a);return new Ce({inputVariables:t,template:o})}static fromTemplate(e,{templateFormat:r="f-string",...t}={}){const a=new Set;return vi(e,r).forEach(s=>{s.type==="variable"&&a.add(s.name)}),new Ce({inputVariables:[...a],templateFormat:r,template:e,...t})}async partial(e){const r={...this};return r.inputVariables=this.inputVariables.filter(t=>!(t in e)),r.partialVariables={...this.partialVariables??{},...e},new Ce(r)}serialize(){if(this.outputParser!==void 0)throw new Error("Cannot serialize a prompt template with an output parser");return{_type:this._getPromptType(),input_variables:this.inputVariables,template:this.template,template_format:this.templateFormat}}static async deserialize(e){if(!e.template)throw new Error("Prompt template must have a template");return new Ce({inputVariables:e.input_variables,template:e.template,templateFormat:e.template_format})}}const yn=Object.freeze(Object.defineProperty({__proto__:null,PromptTemplate:Ce},Symbol.toStringTag,{value:"Module"}));class lt extends kt{get inputKeys(){return[this.inputKey,...this.llmChain.inputKeys].filter(e=>e!==this.documentVariableName)}get outputKeys(){return this.llmChain.outputKeys}constructor(e){super(e),Object.defineProperty(this,"llmChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"input_documents"}),Object.defineProperty(this,"documentVariableName",{enumerable:!0,configurable:!0,writable:!0,value:"context"}),this.llmChain=e.llmChain,this.documentVariableName=e.documentVariableName??this.documentVariableName,this.inputKey=e.inputKey??this.inputKey}_prepInputs(e){if(!(this.inputKey in e))throw new Error(`Document key ${this.inputKey} not found.`);const{[this.inputKey]:r,...t}=e,s=r.map(({pageContent:o})=>o).join(`

`);return{...t,[this.documentVariableName]:s}}async _call(e,r){return await this.llmChain.call(this._prepInputs(e),r==null?void 0:r.getChild("combine_documents"))}_chainType(){return"stuff_documents_chain"}static async deserialize(e){if(!e.llm_chain)throw new Error("Missing llm_chain");return new lt({llmChain:await Ze.deserialize(e.llm_chain)})}serialize(){return{_type:this._chainType(),llm_chain:this.llmChain.serialize()}}}class Kt extends kt{get inputKeys(){return[this.inputKey,...this.combineDocumentChain.inputKeys]}get outputKeys(){return this.combineDocumentChain.outputKeys}constructor(e){super(e),Object.defineProperty(this,"llmChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"input_documents"}),Object.defineProperty(this,"documentVariableName",{enumerable:!0,configurable:!0,writable:!0,value:"context"}),Object.defineProperty(this,"returnIntermediateSteps",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:3e3}),Object.defineProperty(this,"maxIterations",{enumerable:!0,configurable:!0,writable:!0,value:10}),Object.defineProperty(this,"ensureMapStep",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"combineDocumentChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.llmChain=e.llmChain,this.combineDocumentChain=e.combineDocumentChain,this.documentVariableName=e.documentVariableName??this.documentVariableName,this.ensureMapStep=e.ensureMapStep??this.ensureMapStep,this.inputKey=e.inputKey??this.inputKey,this.maxTokens=e.maxTokens??this.maxTokens,this.maxIterations=e.maxIterations??this.maxIterations,this.returnIntermediateSteps=e.returnIntermediateSteps??!1}async _call(e,r){if(!(this.inputKey in e))throw new Error(`Document key ${this.inputKey} not found.`);const{[this.inputKey]:t,...a}=e;let s=t,o=[];for(let d=0;d<this.maxIterations;d+=1){const v=s.map(E=>({[this.documentVariableName]:E.pageContent,...a}));if(d!==0||!this.ensureMapStep){const E=await this.combineDocumentChain.llmChain.prompt.format(this.combineDocumentChain._prepInputs({[this.combineDocumentChain.inputKey]:s,...a}));if(await this.combineDocumentChain.llmChain.llm.getNumTokens(E)<this.maxTokens)break}const V=await this.llmChain.apply(v,r?Array.from({length:v.length},(E,N)=>r.getChild(`map_${N+1}`)):void 0),{outputKey:R}=this.llmChain;this.returnIntermediateSteps&&(o=o.concat(V.map(E=>E[R]))),s=V.map(E=>({pageContent:E[R],metadata:{}}))}const l={[this.combineDocumentChain.inputKey]:s,...a},u=await this.combineDocumentChain.call(l,r==null?void 0:r.getChild("combine_documents"));return this.returnIntermediateSteps?{...u,intermediateSteps:o}:u}_chainType(){return"map_reduce_documents_chain"}static async deserialize(e){if(!e.llm_chain)throw new Error("Missing llm_chain");if(!e.combine_document_chain)throw new Error("Missing combine_document_chain");return new Kt({llmChain:await Ze.deserialize(e.llm_chain),combineDocumentChain:await lt.deserialize(e.combine_document_chain)})}serialize(){return{_type:this._chainType(),llm_chain:this.llmChain.serialize(),combine_document_chain:this.combineDocumentChain.serialize()}}}class zt extends kt{get defaultDocumentPrompt(){return new Ce({inputVariables:["page_content"],template:"{page_content}"})}get inputKeys(){return[...new Set([this.inputKey,...this.llmChain.inputKeys,...this.refineLLMChain.inputKeys])].filter(e=>e!==this.documentVariableName&&e!==this.initialResponseName)}get outputKeys(){return[this.outputKey]}constructor(e){super(e),Object.defineProperty(this,"llmChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"input_documents"}),Object.defineProperty(this,"outputKey",{enumerable:!0,configurable:!0,writable:!0,value:"output_text"}),Object.defineProperty(this,"documentVariableName",{enumerable:!0,configurable:!0,writable:!0,value:"context"}),Object.defineProperty(this,"initialResponseName",{enumerable:!0,configurable:!0,writable:!0,value:"existing_answer"}),Object.defineProperty(this,"refineLLMChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"documentPrompt",{enumerable:!0,configurable:!0,writable:!0,value:this.defaultDocumentPrompt}),this.llmChain=e.llmChain,this.refineLLMChain=e.refineLLMChain,this.documentVariableName=e.documentVariableName??this.documentVariableName,this.inputKey=e.inputKey??this.inputKey,this.outputKey=e.outputKey??this.outputKey,this.documentPrompt=e.documentPrompt??this.documentPrompt,this.initialResponseName=e.initialResponseName??this.initialResponseName}async _constructInitialInputs(e,r){const t={page_content:e.pageContent,...e.metadata},a={};return this.documentPrompt.inputVariables.forEach(l=>{a[l]=t[l]}),{...{[this.documentVariableName]:await this.documentPrompt.format({...a})},...r}}async _constructRefineInputs(e,r){const t={page_content:e.pageContent,...e.metadata},a={};this.documentPrompt.inputVariables.forEach(l=>{a[l]=t[l]});const s={[this.documentVariableName]:await this.documentPrompt.format({...a})};return{[this.initialResponseName]:r,...s}}async _call(e,r){if(!(this.inputKey in e))throw new Error(`Document key ${this.inputKey} not found.`);const{[this.inputKey]:t,...a}=e,s=t,o=await this._constructInitialInputs(s[0],a);let l=await this.llmChain.predict({...o},r==null?void 0:r.getChild("answer"));for(let u=1;u<s.length;u+=1){const v={...await this._constructRefineInputs(s[u],l),...a};l=await this.refineLLMChain.predict({...v},r==null?void 0:r.getChild("refine"))}return{[this.outputKey]:l}}_chainType(){return"refine_documents_chain"}static async deserialize(e){const r=e.llm_chain;if(!r)throw new Error("Missing llm_chain");const t=e.refine_llm_chain;if(!t)throw new Error("Missing refine_llm_chain");return new zt({llmChain:await Ze.deserialize(r),refineLLMChain:await Ze.deserialize(t)})}serialize(){return{_type:this._chainType(),llm_chain:this.llmChain.serialize(),refine_llm_chain:this.refineLLMChain.serialize()}}}const dr=Object.freeze(Object.defineProperty({__proto__:null,MapReduceDocumentsChain:Kt,RefineDocumentsChain:zt,StuffDocumentsChain:lt},Symbol.toStringTag,{value:"Module"}));class Ii extends ot{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","prompts","chat"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}}class Pi extends ca{constructor(e){Array.isArray(e)&&(e={messages:e}),super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","prompts","chat"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"messages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.messages=e.messages}toString(){return JSON.stringify(this.messages)}toChatMessages(){return this.messages}}class Ur extends Ii{constructor(e){"prompt"in e||(e={prompt:e}),super(e),Object.defineProperty(this,"prompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.prompt=e.prompt}get inputVariables(){return this.prompt.inputVariables}async formatMessages(e){return[await this.format(e)]}}class Ti extends Rr{constructor(e){super(e)}async format(e){return(await this.formatPromptValue(e)).toString()}async formatPromptValue(e){const r=await this.formatMessages(e);return new Pi(r)}}class ut extends Ur{async format(e){return new $t(await this.prompt.format(e))}static fromTemplate(e){return new this(Ce.fromTemplate(e))}}class Oi extends Ur{async format(e){return new jr(await this.prompt.format(e))}static fromTemplate(e){return new this(Ce.fromTemplate(e))}}class Ft extends Ur{async format(e){return new da(await this.prompt.format(e))}static fromTemplate(e){return new this(Ce.fromTemplate(e))}}class $e extends Ti{get lc_aliases(){return{promptMessages:"messages"}}constructor(e){if(super(e),Object.defineProperty(this,"promptMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.assign(this,e),this.validateTemplate){const r=new Set;for(const o of this.promptMessages)for(const l of o.inputVariables)r.add(l);const t=new Set(this.partialVariables?this.inputVariables.concat(Object.keys(this.partialVariables)):this.inputVariables),a=new Set([...t].filter(o=>!r.has(o)));if(a.size>0)throw new Error(`Input variables \`${[...a]}\` are not used in any of the prompt messages.`);const s=new Set([...r].filter(o=>!t.has(o)));if(s.size>0)throw new Error(`Input variables \`${[...s]}\` are used in prompt messages but not in the prompt template.`)}}_getPromptType(){return"chat"}async formatMessages(e){const r=await this.mergePartialAndUserVariables(e);let t=[];for(const a of this.promptMessages){const s=a.inputVariables.reduce((l,u)=>{if(!(u in r))throw new Error(`Missing value for input variable \`${u}\``);return l[u]=r[u],l},{}),o=await a.formatMessages(s);t=t.concat(o)}return t}async partial(e){const r={...this};return r.inputVariables=this.inputVariables.filter(t=>!(t in e)),r.partialVariables={...this.partialVariables??{},...e},new $e(r)}static fromPromptMessages(e){const r=e.reduce((s,o)=>s.concat(o instanceof $e?o.promptMessages:[o]),[]),t=e.reduce((s,o)=>o instanceof $e?Object.assign(s,o.partialVariables):s,Object.create(null)),a=new Set;for(const s of r)for(const o of s.inputVariables)o in t||a.add(o);return new $e({inputVariables:[...a],promptMessages:r,partialVariables:t})}}class Ei{async getPromptAsync(e,r){return this.getPrompt(e).partial((r==null?void 0:r.partialVariables)??{})}}class At extends Ei{constructor(e,r=[]){super(),Object.defineProperty(this,"defaultPrompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"conditionals",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.defaultPrompt=e,this.conditionals=r}getPrompt(e){for(const[r,t]of this.conditionals)if(r(e))return t;return this.defaultPrompt}}function Ct(n){return n._modelType()==="base_chat_model"}const ki=new Ce({template:`Use the following pieces of context to answer the question at the end. If you don't know the answer, just say that you don't know, don't try to make up an answer.

{context}

Question: {question}
Helpful Answer:`,inputVariables:["context","question"]}),Ai=`Use the following pieces of context to answer the users question. 
If you don't know the answer, just say that you don't know, don't try to make up an answer.
----------------
{context}`,Ci=[Ft.fromTemplate(Ai),ut.fromTemplate("{question}")],xi=$e.fromPromptMessages(Ci),ji=new At(ki,[[Ct,xi]]),Si=`Use the following portion of a long document to see if any of the text is relevant to answer the question. 
Return any relevant text verbatim.
{context}
Question: {question}
Relevant text, if any:`,Ni=Ce.fromTemplate(Si),Di=`Use the following portion of a long document to see if any of the text is relevant to answer the question. 
Return any relevant text verbatim.
----------------
{context}`,Li=[Ft.fromTemplate(Di),ut.fromTemplate("{question}")],Zi=$e.fromPromptMessages(Li),Mi=new At(Ni,[[Ct,Zi]]),Ri=`Given the following extracted parts of a long document and a question, create a final answer. 
If you don't know the answer, just say that you don't know. Don't try to make up an answer.

QUESTION: Which state/country's law governs the interpretation of the contract?
=========
Content: This Agreement is governed by English law and the parties submit to the exclusive jurisdiction of the English courts in  relation to any dispute (contractual or non-contractual) concerning this Agreement save that either party may apply to any court for an  injunction or other relief to protect its Intellectual Property Rights.

Content: No Waiver. Failure or delay in exercising any right or remedy under this Agreement shall not constitute a waiver of such (or any other)  right or remedy.

11.7 Severability. The invalidity, illegality or unenforceability of any term (or part of a term) of this Agreement shall not affect the continuation  in force of the remainder of the term (if any) and this Agreement.

11.8 No Agency. Except as expressly stated otherwise, nothing in this Agreement shall create an agency, partnership or joint venture of any  kind between the parties.

11.9 No Third-Party Beneficiaries.

Content: (b) if Google believes, in good faith, that the Distributor has violated or caused Google to violate any Anti-Bribery Laws (as  defined in Clause 8.5) or that such a violation is reasonably likely to occur,
=========
FINAL ANSWER: This Agreement is governed by English law.

QUESTION: What did the president say about Michael Jackson?
=========
Content: Madam Speaker, Madam Vice President, our First Lady and Second Gentleman. Members of Congress and the Cabinet. Justices of the Supreme Court. My fellow Americans.  

Last year COVID-19 kept us apart. This year we are finally together again. 

Tonight, we meet as Democrats Republicans and Independents. But most importantly as Americans. 

With a duty to one another to the American people to the Constitution. 

And with an unwavering resolve that freedom will always triumph over tyranny. 

Six days ago, Russias Vladimir Putin sought to shake the foundations of the free world thinking he could make it bend to his menacing ways. But he badly miscalculated. 

He thought he could roll into Ukraine and the world would roll over. Instead he met a wall of strength he never imagined. 

He met the Ukrainian people. 

From President Zelenskyy to every Ukrainian, their fearlessness, their courage, their determination, inspires the world. 

Groups of citizens blocking tanks with their bodies. Everyone from students to retirees teachers turned soldiers defending their homeland.

Content: And we wont stop. 

We have lost so much to COVID-19. Time with one another. And worst of all, so much loss of life. 

Lets use this moment to reset. Lets stop looking at COVID-19 as a partisan dividing line and see it for what it is: A God-awful disease.  

Lets stop seeing each other as enemies, and start seeing each other for who we really are: Fellow Americans.  

We cant change how divided weve been. But we can change how we move forwardon COVID-19 and other issues we must face together. 

I recently visited the New York City Police Department days after the funerals of Officer Wilbert Mora and his partner, Officer Jason Rivera. 

They were responding to a 9-1-1 call when a man shot and killed them with a stolen gun. 

Officer Mora was 27 years old. 

Officer Rivera was 22. 

Both Dominican Americans whod grown up on the same streets they later chose to patrol as police officers. 

I spoke with their families and told them that we are forever in debt for their sacrifice, and we will carry on their mission to restore the trust and safety every community deserves.

Content: And a proud Ukrainian people, who have known 30 years  of independence, have repeatedly shown that they will not tolerate anyone who tries to take their country backwards.  

To all Americans, I will be honest with you, as Ive always promised. A Russian dictator, invading a foreign country, has costs around the world. 

And Im taking robust action to make sure the pain of our sanctions  is targeted at Russias economy. And I will use every tool at our disposal to protect American businesses and consumers. 

Tonight, I can announce that the United States has worked with 30 other countries to release 60 Million barrels of oil from reserves around the world.  

America will lead that effort, releasing 30 Million barrels from our own Strategic Petroleum Reserve. And we stand ready to do more if necessary, unified with our allies.  

These steps will help blunt gas prices here at home. And I know the news about whats happening can seem alarming. 

But I want you to know that we are going to be okay.

Content: More support for patients and families. 

To get there, I call on Congress to fund ARPA-H, the Advanced Research Projects Agency for Health. 

Its based on DARPAthe Defense Department project that led to the Internet, GPS, and so much more.  

ARPA-H will have a singular purposeto drive breakthroughs in cancer, Alzheimers, diabetes, and more. 

A unity agenda for the nation. 

We can do this. 

My fellow Americanstonight , we have gathered in a sacred spacethe citadel of our democracy. 

In this Capitol, generation after generation, Americans have debated great questions amid great strife, and have done great things. 

We have fought for freedom, expanded liberty, defeated totalitarianism and terror. 

And built the strongest, freest, and most prosperous nation the world has ever known. 

Now is the hour. 

Our moment of responsibility. 

Our test of resolve and conscience, of history itself. 

It is in this moment that our character is formed. Our purpose is found. Our future is forged. 

Well I know this nation.
=========
FINAL ANSWER: The president did not mention Michael Jackson.

QUESTION: {question}
=========
{summaries}
=========
FINAL ANSWER:`,Ui=Ce.fromTemplate(Ri),Vi=`Given the following extracted parts of a long document and a question, create a final answer. 
If you don't know the answer, just say that you don't know. Don't try to make up an answer.
----------------
{summaries}`,Bi=[Ft.fromTemplate(Vi),ut.fromTemplate("{question}")],$i=$e.fromPromptMessages(Bi),Ki=new At(Ui,[[Ct,$i]]),zi=`The original question is as follows: {question}
We have provided an existing answer: {existing_answer}
We have the opportunity to refine the existing answer
(only if needed) with some more context below.
------------
{context}
------------
Given the new context, refine the original answer to better answer the question. 
If the context isn't useful, return the original answer.`,Fi=new Ce({inputVariables:["question","existing_answer","context"],template:zi}),qi=`The original question is as follows: {question}
We have provided an existing answer: {existing_answer}
We have the opportunity to refine the existing answer
(only if needed) with some more context below.
------------
{context}
------------
Given the new context, refine the original answer to better answer the question. 
If the context isn't useful, return the original answer.`,Hi=[ut.fromTemplate("{question}"),Oi.fromTemplate("{existing_answer}"),ut.fromTemplate(qi)],Yi=$e.fromPromptMessages(Hi),Gi=new At(Fi,[[Ct,Yi]]),Wi=`Context information is below. 
---------------------
{context}
---------------------
Given the context information and not prior knowledge, answer the question: {question}`,Ji=new Ce({inputVariables:["context","question"],template:Wi}),Qi=`Context information is below. 
---------------------
{context}
---------------------
Given the context information and not prior knowledge, answer any questions`,Xi=[Ft.fromTemplate(Qi),ut.fromTemplate("{question}")],eo=$e.fromPromptMessages(Xi),to=new At(Ji,[[Ct,eo]]),ro=(n,e={type:"stuff"})=>{const{type:r}=e;if(r==="stuff")return no(n,e);if(r==="map_reduce")return ao(n,e);if(r==="refine")return so(n,e);throw new Error(`Invalid _type: ${r}`)};function no(n,e={}){const{prompt:r=ji.getPrompt(n),verbose:t}=e,a=new Ze({prompt:r,llm:n,verbose:t});return new lt({llmChain:a,verbose:t})}function ao(n,e={}){const{combineMapPrompt:r=Mi.getPrompt(n),combinePrompt:t=Ki.getPrompt(n),verbose:a,returnIntermediateSteps:s}=e,o=new Ze({prompt:r,llm:n,verbose:a}),l=new Ze({prompt:t,llm:n,verbose:a}),u=new lt({llmChain:l,documentVariableName:"summaries",verbose:a});return new Kt({llmChain:o,combineDocumentChain:u,returnIntermediateSteps:s,verbose:a})}function so(n,e={}){const{questionPrompt:r=to.getPrompt(n),refinePrompt:t=Gi.getPrompt(n),verbose:a}=e,s=new Ze({prompt:r,llm:n,verbose:a}),o=new Ze({prompt:t,llm:n,verbose:a});return new zt({llmChain:s,refineLLMChain:o,verbose:a})}const io=`Given the following conversation and a follow up question, rephrase the follow up question to be a standalone question.

Chat History:
{chat_history}
Follow Up Input: {question}
Standalone question:`;class Vr extends kt{get inputKeys(){return[this.inputKey,this.chatHistoryKey]}get outputKeys(){return this.combineDocumentsChain.outputKeys.concat(this.returnSourceDocuments?["sourceDocuments"]:[])}constructor(e){super(e),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"question"}),Object.defineProperty(this,"chatHistoryKey",{enumerable:!0,configurable:!0,writable:!0,value:"chat_history"}),Object.defineProperty(this,"retriever",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"combineDocumentsChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"questionGeneratorChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSourceDocuments",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.retriever=e.retriever,this.combineDocumentsChain=e.combineDocumentsChain,this.questionGeneratorChain=e.questionGeneratorChain,this.inputKey=e.inputKey??this.inputKey,this.returnSourceDocuments=e.returnSourceDocuments??this.returnSourceDocuments}static getChatHistoryString(e){return Array.isArray(e)?e.map(r=>r._getType()==="human"?`Human: ${r.content}`:r._getType()==="ai"?`Assistant: ${r.content}`:`${r.content}`).join(`
`):e}async _call(e,r){if(!(this.inputKey in e))throw new Error(`Question key ${this.inputKey} not found.`);if(!(this.chatHistoryKey in e))throw new Error(`Chat history key ${this.chatHistoryKey} not found.`);const t=e[this.inputKey],a=Vr.getChatHistoryString(e[this.chatHistoryKey]);let s=t;if(a.length>0){const d=await this.questionGeneratorChain.call({question:t,chat_history:a},r==null?void 0:r.getChild("question_generator")),v=Object.keys(d);if(v.length===1)s=d[v[0]];else throw new Error("Return from llm chain has multiple values, only single values supported.")}const o=await this.retriever.getRelevantDocuments(s),l={question:s,input_documents:o,chat_history:a},u=await this.combineDocumentsChain.call(l,r==null?void 0:r.getChild("combine_documents"));return this.returnSourceDocuments?{...u,sourceDocuments:o}:u}_chainType(){return"conversational_retrieval_chain"}static async deserialize(e,r){throw new Error("Not implemented.")}serialize(){throw new Error("Not implemented.")}static fromLLM(e,r,t={}){const{questionGeneratorTemplate:a,qaTemplate:s,qaChainOptions:o={type:"stuff",prompt:s?Ce.fromTemplate(s):void 0},questionGeneratorChainOptions:l,verbose:u,...d}=t,v=ro(e,o),C=Ce.fromTemplate((l==null?void 0:l.template)??a??io),V=new Ze({prompt:C,llm:(l==null?void 0:l.llm)??e,verbose:u});return new this({retriever:r,combineDocumentsChain:v,questionGeneratorChain:V,verbose:u,...d})}}var wa={},qt={},ct={},hr={},fr={},Ke={},Lt={},pr={},_n;function Ht(){return _n||(_n=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.getParsedType=n.ZodParsedType=n.objectUtil=n.util=void 0;var e;(function(t){t.assertEqual=l=>l;function a(l){}t.assertIs=a;function s(l){throw new Error}t.assertNever=s,t.arrayToEnum=l=>{const u={};for(const d of l)u[d]=d;return u},t.getValidEnumValues=l=>{const u=t.objectKeys(l).filter(v=>typeof l[l[v]]!="number"),d={};for(const v of u)d[v]=l[v];return t.objectValues(d)},t.objectValues=l=>t.objectKeys(l).map(function(u){return l[u]}),t.objectKeys=typeof Object.keys=="function"?l=>Object.keys(l):l=>{const u=[];for(const d in l)Object.prototype.hasOwnProperty.call(l,d)&&u.push(d);return u},t.find=(l,u)=>{for(const d of l)if(u(d))return d},t.isInteger=typeof Number.isInteger=="function"?l=>Number.isInteger(l):l=>typeof l=="number"&&isFinite(l)&&Math.floor(l)===l;function o(l,u=" | "){return l.map(d=>typeof d=="string"?`'${d}'`:d).join(u)}t.joinValues=o,t.jsonStringifyReplacer=(l,u)=>typeof u=="bigint"?u.toString():u})(e=n.util||(n.util={})),function(t){t.mergeShapes=(a,s)=>({...a,...s})}(n.objectUtil||(n.objectUtil={})),n.ZodParsedType=e.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]);const r=t=>{switch(typeof t){case"undefined":return n.ZodParsedType.undefined;case"string":return n.ZodParsedType.string;case"number":return isNaN(t)?n.ZodParsedType.nan:n.ZodParsedType.number;case"boolean":return n.ZodParsedType.boolean;case"function":return n.ZodParsedType.function;case"bigint":return n.ZodParsedType.bigint;case"symbol":return n.ZodParsedType.symbol;case"object":return Array.isArray(t)?n.ZodParsedType.array:t===null?n.ZodParsedType.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?n.ZodParsedType.promise:typeof Map<"u"&&t instanceof Map?n.ZodParsedType.map:typeof Set<"u"&&t instanceof Set?n.ZodParsedType.set:typeof Date<"u"&&t instanceof Date?n.ZodParsedType.date:n.ZodParsedType.object;default:return n.ZodParsedType.unknown}};n.getParsedType=r}(pr)),pr}var ze={},bn;function Br(){if(bn)return ze;bn=1,Object.defineProperty(ze,"__esModule",{value:!0}),ze.ZodError=ze.quotelessJson=ze.ZodIssueCode=void 0;const n=Ht();ze.ZodIssueCode=n.util.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);const e=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:");ze.quotelessJson=e;let r=class extends Error{constructor(a){super(),this.issues=[],this.addIssue=o=>{this.issues=[...this.issues,o]},this.addIssues=(o=[])=>{this.issues=[...this.issues,...o]};const s=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,s):this.__proto__=s,this.name="ZodError",this.issues=a}get errors(){return this.issues}format(a){const s=a||function(u){return u.message},o={_errors:[]},l=u=>{for(const d of u.issues)if(d.code==="invalid_union")d.unionErrors.map(l);else if(d.code==="invalid_return_type")l(d.returnTypeError);else if(d.code==="invalid_arguments")l(d.argumentsError);else if(d.path.length===0)o._errors.push(s(d));else{let v=o,C=0;for(;C<d.path.length;){const V=d.path[C];C===d.path.length-1?(v[V]=v[V]||{_errors:[]},v[V]._errors.push(s(d))):v[V]=v[V]||{_errors:[]},v=v[V],C++}}};return l(this),o}toString(){return this.message}get message(){return JSON.stringify(this.issues,n.util.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(a=s=>s.message){const s={},o=[];for(const l of this.issues)l.path.length>0?(s[l.path[0]]=s[l.path[0]]||[],s[l.path[0]].push(a(l))):o.push(a(l));return{formErrors:o,fieldErrors:s}}get formErrors(){return this.flatten()}};return ze.ZodError=r,r.create=t=>new r(t),ze}var vn;function Ia(){if(vn)return Lt;vn=1,Object.defineProperty(Lt,"__esModule",{value:!0});const n=Ht(),e=Br(),r=(t,a)=>{let s;switch(t.code){case e.ZodIssueCode.invalid_type:t.received===n.ZodParsedType.undefined?s="Required":s=`Expected ${t.expected}, received ${t.received}`;break;case e.ZodIssueCode.invalid_literal:s=`Invalid literal value, expected ${JSON.stringify(t.expected,n.util.jsonStringifyReplacer)}`;break;case e.ZodIssueCode.unrecognized_keys:s=`Unrecognized key(s) in object: ${n.util.joinValues(t.keys,", ")}`;break;case e.ZodIssueCode.invalid_union:s="Invalid input";break;case e.ZodIssueCode.invalid_union_discriminator:s=`Invalid discriminator value. Expected ${n.util.joinValues(t.options)}`;break;case e.ZodIssueCode.invalid_enum_value:s=`Invalid enum value. Expected ${n.util.joinValues(t.options)}, received '${t.received}'`;break;case e.ZodIssueCode.invalid_arguments:s="Invalid function arguments";break;case e.ZodIssueCode.invalid_return_type:s="Invalid function return type";break;case e.ZodIssueCode.invalid_date:s="Invalid date";break;case e.ZodIssueCode.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(s=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(s=`${s} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?s=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?s=`Invalid input: must end with "${t.validation.endsWith}"`:n.util.assertNever(t.validation):t.validation!=="regex"?s=`Invalid ${t.validation}`:s="Invalid";break;case e.ZodIssueCode.too_small:t.type==="array"?s=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?s=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?s=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?s=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:s="Invalid input";break;case e.ZodIssueCode.too_big:t.type==="array"?s=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?s=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?s=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?s=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?s=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:s="Invalid input";break;case e.ZodIssueCode.custom:s="Invalid input";break;case e.ZodIssueCode.invalid_intersection_types:s="Intersection results could not be merged";break;case e.ZodIssueCode.not_multiple_of:s=`Number must be a multiple of ${t.multipleOf}`;break;case e.ZodIssueCode.not_finite:s="Number must be finite";break;default:s=a.defaultError,n.util.assertNever(t)}return{message:s}};return Lt.default=r,Lt}var wn;function $r(){if(wn)return Ke;wn=1;var n=Oe&&Oe.__importDefault||function(s){return s&&s.__esModule?s:{default:s}};Object.defineProperty(Ke,"__esModule",{value:!0}),Ke.getErrorMap=Ke.setErrorMap=Ke.defaultErrorMap=void 0;const e=n(Ia());Ke.defaultErrorMap=e.default;let r=e.default;function t(s){r=s}Ke.setErrorMap=t;function a(){return r}return Ke.getErrorMap=a,Ke}var mr={},In;function Pa(){return In||(In=1,function(n){var e=Oe&&Oe.__importDefault||function(R){return R&&R.__esModule?R:{default:R}};Object.defineProperty(n,"__esModule",{value:!0}),n.isAsync=n.isValid=n.isDirty=n.isAborted=n.OK=n.DIRTY=n.INVALID=n.ParseStatus=n.addIssueToContext=n.EMPTY_PATH=n.makeIssue=void 0;const r=$r(),t=e(Ia()),a=R=>{const{data:E,path:N,errorMaps:P,issueData:j}=R,D=[...N,...j.path||[]],L={...j,path:D};let S="";const J=P.filter(I=>!!I).slice().reverse();for(const I of J)S=I(L,{data:E,defaultError:S}).message;return{...j,path:D,message:j.message||S}};n.makeIssue=a,n.EMPTY_PATH=[];function s(R,E){const N=(0,n.makeIssue)({issueData:E,data:R.data,path:R.path,errorMaps:[R.common.contextualErrorMap,R.schemaErrorMap,(0,r.getErrorMap)(),t.default].filter(P=>!!P)});R.common.issues.push(N)}n.addIssueToContext=s;class o{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(E,N){const P=[];for(const j of N){if(j.status==="aborted")return n.INVALID;j.status==="dirty"&&E.dirty(),P.push(j.value)}return{status:E.value,value:P}}static async mergeObjectAsync(E,N){const P=[];for(const j of N)P.push({key:await j.key,value:await j.value});return o.mergeObjectSync(E,P)}static mergeObjectSync(E,N){const P={};for(const j of N){const{key:D,value:L}=j;if(D.status==="aborted"||L.status==="aborted")return n.INVALID;D.status==="dirty"&&E.dirty(),L.status==="dirty"&&E.dirty(),(typeof L.value<"u"||j.alwaysSet)&&(P[D.value]=L.value)}return{status:E.value,value:P}}}n.ParseStatus=o,n.INVALID=Object.freeze({status:"aborted"});const l=R=>({status:"dirty",value:R});n.DIRTY=l;const u=R=>({status:"valid",value:R});n.OK=u;const d=R=>R.status==="aborted";n.isAborted=d;const v=R=>R.status==="dirty";n.isDirty=v;const C=R=>R.status==="valid";n.isValid=C;const V=R=>typeof Promise<"u"&&R instanceof Promise;n.isAsync=V}(mr)),mr}var gr={},Pn;function oo(){return Pn||(Pn=1,Object.defineProperty(gr,"__esModule",{value:!0})),gr}var yr={},_r={},Tn;function uo(){return Tn||(Tn=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.errorUtil=void 0,function(e){e.errToObj=r=>typeof r=="string"?{message:r}:r||{},e.toString=r=>typeof r=="string"?r:r==null?void 0:r.message}(n.errorUtil||(n.errorUtil={}))}(_r)),_r}var On;function lo(){return On||(On=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.discriminatedUnion=n.date=n.boolean=n.bigint=n.array=n.any=n.coerce=n.ZodFirstPartyTypeKind=n.late=n.ZodSchema=n.Schema=n.custom=n.ZodPipeline=n.ZodBranded=n.BRAND=n.ZodNaN=n.ZodCatch=n.ZodDefault=n.ZodNullable=n.ZodOptional=n.ZodTransformer=n.ZodEffects=n.ZodPromise=n.ZodNativeEnum=n.ZodEnum=n.ZodLiteral=n.ZodLazy=n.ZodFunction=n.ZodSet=n.ZodMap=n.ZodRecord=n.ZodTuple=n.ZodIntersection=n.ZodDiscriminatedUnion=n.ZodUnion=n.ZodObject=n.ZodArray=n.ZodVoid=n.ZodNever=n.ZodUnknown=n.ZodAny=n.ZodNull=n.ZodUndefined=n.ZodSymbol=n.ZodDate=n.ZodBoolean=n.ZodBigInt=n.ZodNumber=n.ZodString=n.ZodType=void 0,n.NEVER=n.void=n.unknown=n.union=n.undefined=n.tuple=n.transformer=n.symbol=n.string=n.strictObject=n.set=n.record=n.promise=n.preprocess=n.pipeline=n.ostring=n.optional=n.onumber=n.oboolean=n.object=n.number=n.nullable=n.null=n.never=n.nativeEnum=n.nan=n.map=n.literal=n.lazy=n.intersection=n.instanceof=n.function=n.enum=n.effect=void 0;const e=$r(),r=uo(),t=Pa(),a=Ht(),s=Br();class o{constructor(i,c,f,w){this._cachedPath=[],this.parent=i,this.data=c,this._path=f,this._key=w}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const l=(_,i)=>{if((0,t.isValid)(i))return{success:!0,data:i.value};if(!_.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const c=new s.ZodError(_.common.issues);return this._error=c,this._error}}};function u(_){if(!_)return{};const{errorMap:i,invalid_type_error:c,required_error:f,description:w}=_;if(i&&(c||f))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return i?{errorMap:i,description:w}:{errorMap:(z,Z)=>z.code!=="invalid_type"?{message:Z.defaultError}:typeof Z.data>"u"?{message:f??Z.defaultError}:{message:c??Z.defaultError},description:w}}class d{constructor(i){this.spa=this.safeParseAsync,this._def=i,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(i){return(0,a.getParsedType)(i.data)}_getOrReturnCtx(i,c){return c||{common:i.parent.common,data:i.data,parsedType:(0,a.getParsedType)(i.data),schemaErrorMap:this._def.errorMap,path:i.path,parent:i.parent}}_processInputParams(i){return{status:new t.ParseStatus,ctx:{common:i.parent.common,data:i.data,parsedType:(0,a.getParsedType)(i.data),schemaErrorMap:this._def.errorMap,path:i.path,parent:i.parent}}}_parseSync(i){const c=this._parse(i);if((0,t.isAsync)(c))throw new Error("Synchronous parse encountered promise.");return c}_parseAsync(i){const c=this._parse(i);return Promise.resolve(c)}parse(i,c){const f=this.safeParse(i,c);if(f.success)return f.data;throw f.error}safeParse(i,c){var f;const w={common:{issues:[],async:(f=c==null?void 0:c.async)!==null&&f!==void 0?f:!1,contextualErrorMap:c==null?void 0:c.errorMap},path:(c==null?void 0:c.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:i,parsedType:(0,a.getParsedType)(i)},b=this._parseSync({data:i,path:w.path,parent:w});return l(w,b)}async parseAsync(i,c){const f=await this.safeParseAsync(i,c);if(f.success)return f.data;throw f.error}async safeParseAsync(i,c){const f={common:{issues:[],contextualErrorMap:c==null?void 0:c.errorMap,async:!0},path:(c==null?void 0:c.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:i,parsedType:(0,a.getParsedType)(i)},w=this._parse({data:i,path:f.path,parent:f}),b=await((0,t.isAsync)(w)?w:Promise.resolve(w));return l(f,b)}refine(i,c){const f=w=>typeof c=="string"||typeof c>"u"?{message:c}:typeof c=="function"?c(w):c;return this._refinement((w,b)=>{const z=i(w),Z=()=>b.addIssue({code:s.ZodIssueCode.custom,...f(w)});return typeof Promise<"u"&&z instanceof Promise?z.then(X=>X?!0:(Z(),!1)):z?!0:(Z(),!1)})}refinement(i,c){return this._refinement((f,w)=>i(f)?!0:(w.addIssue(typeof c=="function"?c(f,w):c),!1))}_refinement(i){return new me({schema:this,typeName:ne.ZodEffects,effect:{type:"refinement",refinement:i}})}superRefine(i){return this._refinement(i)}optional(){return ge.create(this,this._def)}nullable(){return Pe.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Q.create(this,this._def)}promise(){return se.create(this,this._def)}or(i){return F.create([this,i],this._def)}and(i){return M.create(this,i,this._def)}transform(i){return new me({...u(this._def),schema:this,typeName:ne.ZodEffects,effect:{type:"transform",transform:i}})}default(i){const c=typeof i=="function"?i:()=>i;return new Ie({...u(this._def),innerType:this,defaultValue:c,typeName:ne.ZodDefault})}brand(){return new we({typeName:ne.ZodBranded,type:this,...u(this._def)})}catch(i){const c=typeof i=="function"?i:()=>i;return new Te({...u(this._def),innerType:this,catchValue:c,typeName:ne.ZodCatch})}describe(i){const c=this.constructor;return new c({...this._def,description:i})}pipe(i){return Re.create(this,i)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}n.ZodType=d,n.Schema=d,n.ZodSchema=d;const v=/^c[^\s-]{8,}$/i,C=/^[a-z][a-z0-9]*$/,V=/[0-9A-HJKMNP-TV-Z]{26}/,R=/^([a-f0-9]{8}-[a-f0-9]{4}-[1-5][a-f0-9]{3}-[a-f0-9]{4}-[a-f0-9]{12}|00000000-0000-0000-0000-000000000000)$/i,E=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\])|(\[IPv6:(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))\])|([A-Za-z0-9]([A-Za-z0-9-]*[A-Za-z0-9])*(\.[A-Za-z]{2,})+))$/,N=/^(\p{Extended_Pictographic}|\p{Emoji_Component})+$/u,P=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,j=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,D=_=>_.precision?_.offset?new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${_.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${_.precision}}Z$`):_.precision===0?_.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):_.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$");function L(_,i){return!!((i==="v4"||!i)&&P.test(_)||(i==="v6"||!i)&&j.test(_))}class S extends d{constructor(){super(...arguments),this._regex=(i,c,f)=>this.refinement(w=>i.test(w),{validation:c,code:s.ZodIssueCode.invalid_string,...r.errorUtil.errToObj(f)}),this.nonempty=i=>this.min(1,r.errorUtil.errToObj(i)),this.trim=()=>new S({...this._def,checks:[...this._def.checks,{kind:"trim"}]}),this.toLowerCase=()=>new S({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]}),this.toUpperCase=()=>new S({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}_parse(i){if(this._def.coerce&&(i.data=String(i.data)),this._getType(i)!==a.ZodParsedType.string){const b=this._getOrReturnCtx(i);return(0,t.addIssueToContext)(b,{code:s.ZodIssueCode.invalid_type,expected:a.ZodParsedType.string,received:b.parsedType}),t.INVALID}const f=new t.ParseStatus;let w;for(const b of this._def.checks)if(b.kind==="min")i.data.length<b.value&&(w=this._getOrReturnCtx(i,w),(0,t.addIssueToContext)(w,{code:s.ZodIssueCode.too_small,minimum:b.value,type:"string",inclusive:!0,exact:!1,message:b.message}),f.dirty());else if(b.kind==="max")i.data.length>b.value&&(w=this._getOrReturnCtx(i,w),(0,t.addIssueToContext)(w,{code:s.ZodIssueCode.too_big,maximum:b.value,type:"string",inclusive:!0,exact:!1,message:b.message}),f.dirty());else if(b.kind==="length"){const z=i.data.length>b.value,Z=i.data.length<b.value;(z||Z)&&(w=this._getOrReturnCtx(i,w),z?(0,t.addIssueToContext)(w,{code:s.ZodIssueCode.too_big,maximum:b.value,type:"string",inclusive:!0,exact:!0,message:b.message}):Z&&(0,t.addIssueToContext)(w,{code:s.ZodIssueCode.too_small,minimum:b.value,type:"string",inclusive:!0,exact:!0,message:b.message}),f.dirty())}else if(b.kind==="email")E.test(i.data)||(w=this._getOrReturnCtx(i,w),(0,t.addIssueToContext)(w,{validation:"email",code:s.ZodIssueCode.invalid_string,message:b.message}),f.dirty());else if(b.kind==="emoji")N.test(i.data)||(w=this._getOrReturnCtx(i,w),(0,t.addIssueToContext)(w,{validation:"emoji",code:s.ZodIssueCode.invalid_string,message:b.message}),f.dirty());else if(b.kind==="uuid")R.test(i.data)||(w=this._getOrReturnCtx(i,w),(0,t.addIssueToContext)(w,{validation:"uuid",code:s.ZodIssueCode.invalid_string,message:b.message}),f.dirty());else if(b.kind==="cuid")v.test(i.data)||(w=this._getOrReturnCtx(i,w),(0,t.addIssueToContext)(w,{validation:"cuid",code:s.ZodIssueCode.invalid_string,message:b.message}),f.dirty());else if(b.kind==="cuid2")C.test(i.data)||(w=this._getOrReturnCtx(i,w),(0,t.addIssueToContext)(w,{validation:"cuid2",code:s.ZodIssueCode.invalid_string,message:b.message}),f.dirty());else if(b.kind==="ulid")V.test(i.data)||(w=this._getOrReturnCtx(i,w),(0,t.addIssueToContext)(w,{validation:"ulid",code:s.ZodIssueCode.invalid_string,message:b.message}),f.dirty());else if(b.kind==="url")try{new URL(i.data)}catch{w=this._getOrReturnCtx(i,w),(0,t.addIssueToContext)(w,{validation:"url",code:s.ZodIssueCode.invalid_string,message:b.message}),f.dirty()}else b.kind==="regex"?(b.regex.lastIndex=0,b.regex.test(i.data)||(w=this._getOrReturnCtx(i,w),(0,t.addIssueToContext)(w,{validation:"regex",code:s.ZodIssueCode.invalid_string,message:b.message}),f.dirty())):b.kind==="trim"?i.data=i.data.trim():b.kind==="includes"?i.data.includes(b.value,b.position)||(w=this._getOrReturnCtx(i,w),(0,t.addIssueToContext)(w,{code:s.ZodIssueCode.invalid_string,validation:{includes:b.value,position:b.position},message:b.message}),f.dirty()):b.kind==="toLowerCase"?i.data=i.data.toLowerCase():b.kind==="toUpperCase"?i.data=i.data.toUpperCase():b.kind==="startsWith"?i.data.startsWith(b.value)||(w=this._getOrReturnCtx(i,w),(0,t.addIssueToContext)(w,{code:s.ZodIssueCode.invalid_string,validation:{startsWith:b.value},message:b.message}),f.dirty()):b.kind==="endsWith"?i.data.endsWith(b.value)||(w=this._getOrReturnCtx(i,w),(0,t.addIssueToContext)(w,{code:s.ZodIssueCode.invalid_string,validation:{endsWith:b.value},message:b.message}),f.dirty()):b.kind==="datetime"?D(b).test(i.data)||(w=this._getOrReturnCtx(i,w),(0,t.addIssueToContext)(w,{code:s.ZodIssueCode.invalid_string,validation:"datetime",message:b.message}),f.dirty()):b.kind==="ip"?L(i.data,b.version)||(w=this._getOrReturnCtx(i,w),(0,t.addIssueToContext)(w,{validation:"ip",code:s.ZodIssueCode.invalid_string,message:b.message}),f.dirty()):a.util.assertNever(b);return{status:f.value,value:i.data}}_addCheck(i){return new S({...this._def,checks:[...this._def.checks,i]})}email(i){return this._addCheck({kind:"email",...r.errorUtil.errToObj(i)})}url(i){return this._addCheck({kind:"url",...r.errorUtil.errToObj(i)})}emoji(i){return this._addCheck({kind:"emoji",...r.errorUtil.errToObj(i)})}uuid(i){return this._addCheck({kind:"uuid",...r.errorUtil.errToObj(i)})}cuid(i){return this._addCheck({kind:"cuid",...r.errorUtil.errToObj(i)})}cuid2(i){return this._addCheck({kind:"cuid2",...r.errorUtil.errToObj(i)})}ulid(i){return this._addCheck({kind:"ulid",...r.errorUtil.errToObj(i)})}ip(i){return this._addCheck({kind:"ip",...r.errorUtil.errToObj(i)})}datetime(i){var c;return typeof i=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,message:i}):this._addCheck({kind:"datetime",precision:typeof(i==null?void 0:i.precision)>"u"?null:i==null?void 0:i.precision,offset:(c=i==null?void 0:i.offset)!==null&&c!==void 0?c:!1,...r.errorUtil.errToObj(i==null?void 0:i.message)})}regex(i,c){return this._addCheck({kind:"regex",regex:i,...r.errorUtil.errToObj(c)})}includes(i,c){return this._addCheck({kind:"includes",value:i,position:c==null?void 0:c.position,...r.errorUtil.errToObj(c==null?void 0:c.message)})}startsWith(i,c){return this._addCheck({kind:"startsWith",value:i,...r.errorUtil.errToObj(c)})}endsWith(i,c){return this._addCheck({kind:"endsWith",value:i,...r.errorUtil.errToObj(c)})}min(i,c){return this._addCheck({kind:"min",value:i,...r.errorUtil.errToObj(c)})}max(i,c){return this._addCheck({kind:"max",value:i,...r.errorUtil.errToObj(c)})}length(i,c){return this._addCheck({kind:"length",value:i,...r.errorUtil.errToObj(c)})}get isDatetime(){return!!this._def.checks.find(i=>i.kind==="datetime")}get isEmail(){return!!this._def.checks.find(i=>i.kind==="email")}get isURL(){return!!this._def.checks.find(i=>i.kind==="url")}get isEmoji(){return!!this._def.checks.find(i=>i.kind==="emoji")}get isUUID(){return!!this._def.checks.find(i=>i.kind==="uuid")}get isCUID(){return!!this._def.checks.find(i=>i.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(i=>i.kind==="cuid2")}get isULID(){return!!this._def.checks.find(i=>i.kind==="ulid")}get isIP(){return!!this._def.checks.find(i=>i.kind==="ip")}get minLength(){let i=null;for(const c of this._def.checks)c.kind==="min"&&(i===null||c.value>i)&&(i=c.value);return i}get maxLength(){let i=null;for(const c of this._def.checks)c.kind==="max"&&(i===null||c.value<i)&&(i=c.value);return i}}n.ZodString=S,S.create=_=>{var i;return new S({checks:[],typeName:ne.ZodString,coerce:(i=_==null?void 0:_.coerce)!==null&&i!==void 0?i:!1,...u(_)})};function J(_,i){const c=(_.toString().split(".")[1]||"").length,f=(i.toString().split(".")[1]||"").length,w=c>f?c:f,b=parseInt(_.toFixed(w).replace(".","")),z=parseInt(i.toFixed(w).replace(".",""));return b%z/Math.pow(10,w)}class I extends d{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(i){if(this._def.coerce&&(i.data=Number(i.data)),this._getType(i)!==a.ZodParsedType.number){const b=this._getOrReturnCtx(i);return(0,t.addIssueToContext)(b,{code:s.ZodIssueCode.invalid_type,expected:a.ZodParsedType.number,received:b.parsedType}),t.INVALID}let f;const w=new t.ParseStatus;for(const b of this._def.checks)b.kind==="int"?a.util.isInteger(i.data)||(f=this._getOrReturnCtx(i,f),(0,t.addIssueToContext)(f,{code:s.ZodIssueCode.invalid_type,expected:"integer",received:"float",message:b.message}),w.dirty()):b.kind==="min"?(b.inclusive?i.data<b.value:i.data<=b.value)&&(f=this._getOrReturnCtx(i,f),(0,t.addIssueToContext)(f,{code:s.ZodIssueCode.too_small,minimum:b.value,type:"number",inclusive:b.inclusive,exact:!1,message:b.message}),w.dirty()):b.kind==="max"?(b.inclusive?i.data>b.value:i.data>=b.value)&&(f=this._getOrReturnCtx(i,f),(0,t.addIssueToContext)(f,{code:s.ZodIssueCode.too_big,maximum:b.value,type:"number",inclusive:b.inclusive,exact:!1,message:b.message}),w.dirty()):b.kind==="multipleOf"?J(i.data,b.value)!==0&&(f=this._getOrReturnCtx(i,f),(0,t.addIssueToContext)(f,{code:s.ZodIssueCode.not_multiple_of,multipleOf:b.value,message:b.message}),w.dirty()):b.kind==="finite"?Number.isFinite(i.data)||(f=this._getOrReturnCtx(i,f),(0,t.addIssueToContext)(f,{code:s.ZodIssueCode.not_finite,message:b.message}),w.dirty()):a.util.assertNever(b);return{status:w.value,value:i.data}}gte(i,c){return this.setLimit("min",i,!0,r.errorUtil.toString(c))}gt(i,c){return this.setLimit("min",i,!1,r.errorUtil.toString(c))}lte(i,c){return this.setLimit("max",i,!0,r.errorUtil.toString(c))}lt(i,c){return this.setLimit("max",i,!1,r.errorUtil.toString(c))}setLimit(i,c,f,w){return new I({...this._def,checks:[...this._def.checks,{kind:i,value:c,inclusive:f,message:r.errorUtil.toString(w)}]})}_addCheck(i){return new I({...this._def,checks:[...this._def.checks,i]})}int(i){return this._addCheck({kind:"int",message:r.errorUtil.toString(i)})}positive(i){return this._addCheck({kind:"min",value:0,inclusive:!1,message:r.errorUtil.toString(i)})}negative(i){return this._addCheck({kind:"max",value:0,inclusive:!1,message:r.errorUtil.toString(i)})}nonpositive(i){return this._addCheck({kind:"max",value:0,inclusive:!0,message:r.errorUtil.toString(i)})}nonnegative(i){return this._addCheck({kind:"min",value:0,inclusive:!0,message:r.errorUtil.toString(i)})}multipleOf(i,c){return this._addCheck({kind:"multipleOf",value:i,message:r.errorUtil.toString(c)})}finite(i){return this._addCheck({kind:"finite",message:r.errorUtil.toString(i)})}safe(i){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:r.errorUtil.toString(i)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:r.errorUtil.toString(i)})}get minValue(){let i=null;for(const c of this._def.checks)c.kind==="min"&&(i===null||c.value>i)&&(i=c.value);return i}get maxValue(){let i=null;for(const c of this._def.checks)c.kind==="max"&&(i===null||c.value<i)&&(i=c.value);return i}get isInt(){return!!this._def.checks.find(i=>i.kind==="int"||i.kind==="multipleOf"&&a.util.isInteger(i.value))}get isFinite(){let i=null,c=null;for(const f of this._def.checks){if(f.kind==="finite"||f.kind==="int"||f.kind==="multipleOf")return!0;f.kind==="min"?(c===null||f.value>c)&&(c=f.value):f.kind==="max"&&(i===null||f.value<i)&&(i=f.value)}return Number.isFinite(c)&&Number.isFinite(i)}}n.ZodNumber=I,I.create=_=>new I({checks:[],typeName:ne.ZodNumber,coerce:(_==null?void 0:_.coerce)||!1,...u(_)});class A extends d{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(i){if(this._def.coerce&&(i.data=BigInt(i.data)),this._getType(i)!==a.ZodParsedType.bigint){const b=this._getOrReturnCtx(i);return(0,t.addIssueToContext)(b,{code:s.ZodIssueCode.invalid_type,expected:a.ZodParsedType.bigint,received:b.parsedType}),t.INVALID}let f;const w=new t.ParseStatus;for(const b of this._def.checks)b.kind==="min"?(b.inclusive?i.data<b.value:i.data<=b.value)&&(f=this._getOrReturnCtx(i,f),(0,t.addIssueToContext)(f,{code:s.ZodIssueCode.too_small,type:"bigint",minimum:b.value,inclusive:b.inclusive,message:b.message}),w.dirty()):b.kind==="max"?(b.inclusive?i.data>b.value:i.data>=b.value)&&(f=this._getOrReturnCtx(i,f),(0,t.addIssueToContext)(f,{code:s.ZodIssueCode.too_big,type:"bigint",maximum:b.value,inclusive:b.inclusive,message:b.message}),w.dirty()):b.kind==="multipleOf"?i.data%b.value!==BigInt(0)&&(f=this._getOrReturnCtx(i,f),(0,t.addIssueToContext)(f,{code:s.ZodIssueCode.not_multiple_of,multipleOf:b.value,message:b.message}),w.dirty()):a.util.assertNever(b);return{status:w.value,value:i.data}}gte(i,c){return this.setLimit("min",i,!0,r.errorUtil.toString(c))}gt(i,c){return this.setLimit("min",i,!1,r.errorUtil.toString(c))}lte(i,c){return this.setLimit("max",i,!0,r.errorUtil.toString(c))}lt(i,c){return this.setLimit("max",i,!1,r.errorUtil.toString(c))}setLimit(i,c,f,w){return new A({...this._def,checks:[...this._def.checks,{kind:i,value:c,inclusive:f,message:r.errorUtil.toString(w)}]})}_addCheck(i){return new A({...this._def,checks:[...this._def.checks,i]})}positive(i){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:r.errorUtil.toString(i)})}negative(i){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:r.errorUtil.toString(i)})}nonpositive(i){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:r.errorUtil.toString(i)})}nonnegative(i){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:r.errorUtil.toString(i)})}multipleOf(i,c){return this._addCheck({kind:"multipleOf",value:i,message:r.errorUtil.toString(c)})}get minValue(){let i=null;for(const c of this._def.checks)c.kind==="min"&&(i===null||c.value>i)&&(i=c.value);return i}get maxValue(){let i=null;for(const c of this._def.checks)c.kind==="max"&&(i===null||c.value<i)&&(i=c.value);return i}}n.ZodBigInt=A,A.create=_=>{var i;return new A({checks:[],typeName:ne.ZodBigInt,coerce:(i=_==null?void 0:_.coerce)!==null&&i!==void 0?i:!1,...u(_)})};class m extends d{_parse(i){if(this._def.coerce&&(i.data=!!i.data),this._getType(i)!==a.ZodParsedType.boolean){const f=this._getOrReturnCtx(i);return(0,t.addIssueToContext)(f,{code:s.ZodIssueCode.invalid_type,expected:a.ZodParsedType.boolean,received:f.parsedType}),t.INVALID}return(0,t.OK)(i.data)}}n.ZodBoolean=m,m.create=_=>new m({typeName:ne.ZodBoolean,coerce:(_==null?void 0:_.coerce)||!1,...u(_)});class y extends d{_parse(i){if(this._def.coerce&&(i.data=new Date(i.data)),this._getType(i)!==a.ZodParsedType.date){const b=this._getOrReturnCtx(i);return(0,t.addIssueToContext)(b,{code:s.ZodIssueCode.invalid_type,expected:a.ZodParsedType.date,received:b.parsedType}),t.INVALID}if(isNaN(i.data.getTime())){const b=this._getOrReturnCtx(i);return(0,t.addIssueToContext)(b,{code:s.ZodIssueCode.invalid_date}),t.INVALID}const f=new t.ParseStatus;let w;for(const b of this._def.checks)b.kind==="min"?i.data.getTime()<b.value&&(w=this._getOrReturnCtx(i,w),(0,t.addIssueToContext)(w,{code:s.ZodIssueCode.too_small,message:b.message,inclusive:!0,exact:!1,minimum:b.value,type:"date"}),f.dirty()):b.kind==="max"?i.data.getTime()>b.value&&(w=this._getOrReturnCtx(i,w),(0,t.addIssueToContext)(w,{code:s.ZodIssueCode.too_big,message:b.message,inclusive:!0,exact:!1,maximum:b.value,type:"date"}),f.dirty()):a.util.assertNever(b);return{status:f.value,value:new Date(i.data.getTime())}}_addCheck(i){return new y({...this._def,checks:[...this._def.checks,i]})}min(i,c){return this._addCheck({kind:"min",value:i.getTime(),message:r.errorUtil.toString(c)})}max(i,c){return this._addCheck({kind:"max",value:i.getTime(),message:r.errorUtil.toString(c)})}get minDate(){let i=null;for(const c of this._def.checks)c.kind==="min"&&(i===null||c.value>i)&&(i=c.value);return i!=null?new Date(i):null}get maxDate(){let i=null;for(const c of this._def.checks)c.kind==="max"&&(i===null||c.value<i)&&(i=c.value);return i!=null?new Date(i):null}}n.ZodDate=y,y.create=_=>new y({checks:[],coerce:(_==null?void 0:_.coerce)||!1,typeName:ne.ZodDate,...u(_)});class p extends d{_parse(i){if(this._getType(i)!==a.ZodParsedType.symbol){const f=this._getOrReturnCtx(i);return(0,t.addIssueToContext)(f,{code:s.ZodIssueCode.invalid_type,expected:a.ZodParsedType.symbol,received:f.parsedType}),t.INVALID}return(0,t.OK)(i.data)}}n.ZodSymbol=p,p.create=_=>new p({typeName:ne.ZodSymbol,...u(_)});class O extends d{_parse(i){if(this._getType(i)!==a.ZodParsedType.undefined){const f=this._getOrReturnCtx(i);return(0,t.addIssueToContext)(f,{code:s.ZodIssueCode.invalid_type,expected:a.ZodParsedType.undefined,received:f.parsedType}),t.INVALID}return(0,t.OK)(i.data)}}n.ZodUndefined=O,O.create=_=>new O({typeName:ne.ZodUndefined,...u(_)});class k extends d{_parse(i){if(this._getType(i)!==a.ZodParsedType.null){const f=this._getOrReturnCtx(i);return(0,t.addIssueToContext)(f,{code:s.ZodIssueCode.invalid_type,expected:a.ZodParsedType.null,received:f.parsedType}),t.INVALID}return(0,t.OK)(i.data)}}n.ZodNull=k,k.create=_=>new k({typeName:ne.ZodNull,...u(_)});class Y extends d{constructor(){super(...arguments),this._any=!0}_parse(i){return(0,t.OK)(i.data)}}n.ZodAny=Y,Y.create=_=>new Y({typeName:ne.ZodAny,...u(_)});class G extends d{constructor(){super(...arguments),this._unknown=!0}_parse(i){return(0,t.OK)(i.data)}}n.ZodUnknown=G,G.create=_=>new G({typeName:ne.ZodUnknown,...u(_)});class H extends d{_parse(i){const c=this._getOrReturnCtx(i);return(0,t.addIssueToContext)(c,{code:s.ZodIssueCode.invalid_type,expected:a.ZodParsedType.never,received:c.parsedType}),t.INVALID}}n.ZodNever=H,H.create=_=>new H({typeName:ne.ZodNever,...u(_)});class B extends d{_parse(i){if(this._getType(i)!==a.ZodParsedType.undefined){const f=this._getOrReturnCtx(i);return(0,t.addIssueToContext)(f,{code:s.ZodIssueCode.invalid_type,expected:a.ZodParsedType.void,received:f.parsedType}),t.INVALID}return(0,t.OK)(i.data)}}n.ZodVoid=B,B.create=_=>new B({typeName:ne.ZodVoid,...u(_)});class Q extends d{_parse(i){const{ctx:c,status:f}=this._processInputParams(i),w=this._def;if(c.parsedType!==a.ZodParsedType.array)return(0,t.addIssueToContext)(c,{code:s.ZodIssueCode.invalid_type,expected:a.ZodParsedType.array,received:c.parsedType}),t.INVALID;if(w.exactLength!==null){const z=c.data.length>w.exactLength.value,Z=c.data.length<w.exactLength.value;(z||Z)&&((0,t.addIssueToContext)(c,{code:z?s.ZodIssueCode.too_big:s.ZodIssueCode.too_small,minimum:Z?w.exactLength.value:void 0,maximum:z?w.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:w.exactLength.message}),f.dirty())}if(w.minLength!==null&&c.data.length<w.minLength.value&&((0,t.addIssueToContext)(c,{code:s.ZodIssueCode.too_small,minimum:w.minLength.value,type:"array",inclusive:!0,exact:!1,message:w.minLength.message}),f.dirty()),w.maxLength!==null&&c.data.length>w.maxLength.value&&((0,t.addIssueToContext)(c,{code:s.ZodIssueCode.too_big,maximum:w.maxLength.value,type:"array",inclusive:!0,exact:!1,message:w.maxLength.message}),f.dirty()),c.common.async)return Promise.all([...c.data].map((z,Z)=>w.type._parseAsync(new o(c,z,c.path,Z)))).then(z=>t.ParseStatus.mergeArray(f,z));const b=[...c.data].map((z,Z)=>w.type._parseSync(new o(c,z,c.path,Z)));return t.ParseStatus.mergeArray(f,b)}get element(){return this._def.type}min(i,c){return new Q({...this._def,minLength:{value:i,message:r.errorUtil.toString(c)}})}max(i,c){return new Q({...this._def,maxLength:{value:i,message:r.errorUtil.toString(c)}})}length(i,c){return new Q({...this._def,exactLength:{value:i,message:r.errorUtil.toString(c)}})}nonempty(i){return this.min(1,i)}}n.ZodArray=Q,Q.create=(_,i)=>new Q({type:_,minLength:null,maxLength:null,exactLength:null,typeName:ne.ZodArray,...u(i)});function he(_){if(_ instanceof x){const i={};for(const c in _.shape){const f=_.shape[c];i[c]=ge.create(he(f))}return new x({..._._def,shape:()=>i})}else return _ instanceof Q?new Q({..._._def,type:he(_.element)}):_ instanceof ge?ge.create(he(_.unwrap())):_ instanceof Pe?Pe.create(he(_.unwrap())):_ instanceof re?re.create(_.items.map(i=>he(i))):_}class x extends d{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const i=this._def.shape(),c=a.util.objectKeys(i);return this._cached={shape:i,keys:c}}_parse(i){if(this._getType(i)!==a.ZodParsedType.object){const ee=this._getOrReturnCtx(i);return(0,t.addIssueToContext)(ee,{code:s.ZodIssueCode.invalid_type,expected:a.ZodParsedType.object,received:ee.parsedType}),t.INVALID}const{status:f,ctx:w}=this._processInputParams(i),{shape:b,keys:z}=this._getCached(),Z=[];if(!(this._def.catchall instanceof H&&this._def.unknownKeys==="strip"))for(const ee in w.data)z.includes(ee)||Z.push(ee);const X=[];for(const ee of z){const pe=b[ee],tt=w.data[ee];X.push({key:{status:"valid",value:ee},value:pe._parse(new o(w,tt,w.path,ee)),alwaysSet:ee in w.data})}if(this._def.catchall instanceof H){const ee=this._def.unknownKeys;if(ee==="passthrough")for(const pe of Z)X.push({key:{status:"valid",value:pe},value:{status:"valid",value:w.data[pe]}});else if(ee==="strict")Z.length>0&&((0,t.addIssueToContext)(w,{code:s.ZodIssueCode.unrecognized_keys,keys:Z}),f.dirty());else if(ee!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const ee=this._def.catchall;for(const pe of Z){const tt=w.data[pe];X.push({key:{status:"valid",value:pe},value:ee._parse(new o(w,tt,w.path,pe)),alwaysSet:pe in w.data})}}return w.common.async?Promise.resolve().then(async()=>{const ee=[];for(const pe of X){const tt=await pe.key;ee.push({key:tt,value:await pe.value,alwaysSet:pe.alwaysSet})}return ee}).then(ee=>t.ParseStatus.mergeObjectSync(f,ee)):t.ParseStatus.mergeObjectSync(f,X)}get shape(){return this._def.shape()}strict(i){return r.errorUtil.errToObj,new x({...this._def,unknownKeys:"strict",...i!==void 0?{errorMap:(c,f)=>{var w,b,z,Z;const X=(z=(b=(w=this._def).errorMap)===null||b===void 0?void 0:b.call(w,c,f).message)!==null&&z!==void 0?z:f.defaultError;return c.code==="unrecognized_keys"?{message:(Z=r.errorUtil.errToObj(i).message)!==null&&Z!==void 0?Z:X}:{message:X}}}:{}})}strip(){return new x({...this._def,unknownKeys:"strip"})}passthrough(){return new x({...this._def,unknownKeys:"passthrough"})}extend(i){return new x({...this._def,shape:()=>({...this._def.shape(),...i})})}merge(i){return new x({unknownKeys:i._def.unknownKeys,catchall:i._def.catchall,shape:()=>({...this._def.shape(),...i._def.shape()}),typeName:ne.ZodObject})}setKey(i,c){return this.augment({[i]:c})}catchall(i){return new x({...this._def,catchall:i})}pick(i){const c={};return a.util.objectKeys(i).forEach(f=>{i[f]&&this.shape[f]&&(c[f]=this.shape[f])}),new x({...this._def,shape:()=>c})}omit(i){const c={};return a.util.objectKeys(this.shape).forEach(f=>{i[f]||(c[f]=this.shape[f])}),new x({...this._def,shape:()=>c})}deepPartial(){return he(this)}partial(i){const c={};return a.util.objectKeys(this.shape).forEach(f=>{const w=this.shape[f];i&&!i[f]?c[f]=w:c[f]=w.optional()}),new x({...this._def,shape:()=>c})}required(i){const c={};return a.util.objectKeys(this.shape).forEach(f=>{if(i&&!i[f])c[f]=this.shape[f];else{let b=this.shape[f];for(;b instanceof ge;)b=b._def.innerType;c[f]=b}}),new x({...this._def,shape:()=>c})}keyof(){return K(a.util.objectKeys(this.shape))}}n.ZodObject=x,x.create=(_,i)=>new x({shape:()=>_,unknownKeys:"strip",catchall:H.create(),typeName:ne.ZodObject,...u(i)}),x.strictCreate=(_,i)=>new x({shape:()=>_,unknownKeys:"strict",catchall:H.create(),typeName:ne.ZodObject,...u(i)}),x.lazycreate=(_,i)=>new x({shape:_,unknownKeys:"strip",catchall:H.create(),typeName:ne.ZodObject,...u(i)});class F extends d{_parse(i){const{ctx:c}=this._processInputParams(i),f=this._def.options;function w(b){for(const Z of b)if(Z.result.status==="valid")return Z.result;for(const Z of b)if(Z.result.status==="dirty")return c.common.issues.push(...Z.ctx.common.issues),Z.result;const z=b.map(Z=>new s.ZodError(Z.ctx.common.issues));return(0,t.addIssueToContext)(c,{code:s.ZodIssueCode.invalid_union,unionErrors:z}),t.INVALID}if(c.common.async)return Promise.all(f.map(async b=>{const z={...c,common:{...c.common,issues:[]},parent:null};return{result:await b._parseAsync({data:c.data,path:c.path,parent:z}),ctx:z}})).then(w);{let b;const z=[];for(const X of f){const ee={...c,common:{...c.common,issues:[]},parent:null},pe=X._parseSync({data:c.data,path:c.path,parent:ee});if(pe.status==="valid")return pe;pe.status==="dirty"&&!b&&(b={result:pe,ctx:ee}),ee.common.issues.length&&z.push(ee.common.issues)}if(b)return c.common.issues.push(...b.ctx.common.issues),b.result;const Z=z.map(X=>new s.ZodError(X));return(0,t.addIssueToContext)(c,{code:s.ZodIssueCode.invalid_union,unionErrors:Z}),t.INVALID}}get options(){return this._def.options}}n.ZodUnion=F,F.create=(_,i)=>new F({options:_,typeName:ne.ZodUnion,...u(i)});const q=_=>_ instanceof g?q(_.schema):_ instanceof me?q(_.innerType()):_ instanceof T?[_.value]:_ instanceof U?_.options:_ instanceof W?Object.keys(_.enum):_ instanceof Ie?q(_._def.innerType):_ instanceof O?[void 0]:_ instanceof k?[null]:null;class ie extends d{_parse(i){const{ctx:c}=this._processInputParams(i);if(c.parsedType!==a.ZodParsedType.object)return(0,t.addIssueToContext)(c,{code:s.ZodIssueCode.invalid_type,expected:a.ZodParsedType.object,received:c.parsedType}),t.INVALID;const f=this.discriminator,w=c.data[f],b=this.optionsMap.get(w);return b?c.common.async?b._parseAsync({data:c.data,path:c.path,parent:c}):b._parseSync({data:c.data,path:c.path,parent:c}):((0,t.addIssueToContext)(c,{code:s.ZodIssueCode.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[f]}),t.INVALID)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(i,c,f){const w=new Map;for(const b of c){const z=q(b.shape[i]);if(!z)throw new Error(`A discriminator value for key \`${i}\` could not be extracted from all schema options`);for(const Z of z){if(w.has(Z))throw new Error(`Discriminator property ${String(i)} has duplicate value ${String(Z)}`);w.set(Z,b)}}return new ie({typeName:ne.ZodDiscriminatedUnion,discriminator:i,options:c,optionsMap:w,...u(f)})}}n.ZodDiscriminatedUnion=ie;function ye(_,i){const c=(0,a.getParsedType)(_),f=(0,a.getParsedType)(i);if(_===i)return{valid:!0,data:_};if(c===a.ZodParsedType.object&&f===a.ZodParsedType.object){const w=a.util.objectKeys(i),b=a.util.objectKeys(_).filter(Z=>w.indexOf(Z)!==-1),z={..._,...i};for(const Z of b){const X=ye(_[Z],i[Z]);if(!X.valid)return{valid:!1};z[Z]=X.data}return{valid:!0,data:z}}else if(c===a.ZodParsedType.array&&f===a.ZodParsedType.array){if(_.length!==i.length)return{valid:!1};const w=[];for(let b=0;b<_.length;b++){const z=_[b],Z=i[b],X=ye(z,Z);if(!X.valid)return{valid:!1};w.push(X.data)}return{valid:!0,data:w}}else return c===a.ZodParsedType.date&&f===a.ZodParsedType.date&&+_==+i?{valid:!0,data:_}:{valid:!1}}class M extends d{_parse(i){const{status:c,ctx:f}=this._processInputParams(i),w=(b,z)=>{if((0,t.isAborted)(b)||(0,t.isAborted)(z))return t.INVALID;const Z=ye(b.value,z.value);return Z.valid?(((0,t.isDirty)(b)||(0,t.isDirty)(z))&&c.dirty(),{status:c.value,value:Z.data}):((0,t.addIssueToContext)(f,{code:s.ZodIssueCode.invalid_intersection_types}),t.INVALID)};return f.common.async?Promise.all([this._def.left._parseAsync({data:f.data,path:f.path,parent:f}),this._def.right._parseAsync({data:f.data,path:f.path,parent:f})]).then(([b,z])=>w(b,z)):w(this._def.left._parseSync({data:f.data,path:f.path,parent:f}),this._def.right._parseSync({data:f.data,path:f.path,parent:f}))}}n.ZodIntersection=M,M.create=(_,i,c)=>new M({left:_,right:i,typeName:ne.ZodIntersection,...u(c)});class re extends d{_parse(i){const{status:c,ctx:f}=this._processInputParams(i);if(f.parsedType!==a.ZodParsedType.array)return(0,t.addIssueToContext)(f,{code:s.ZodIssueCode.invalid_type,expected:a.ZodParsedType.array,received:f.parsedType}),t.INVALID;if(f.data.length<this._def.items.length)return(0,t.addIssueToContext)(f,{code:s.ZodIssueCode.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.INVALID;!this._def.rest&&f.data.length>this._def.items.length&&((0,t.addIssueToContext)(f,{code:s.ZodIssueCode.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),c.dirty());const b=[...f.data].map((z,Z)=>{const X=this._def.items[Z]||this._def.rest;return X?X._parse(new o(f,z,f.path,Z)):null}).filter(z=>!!z);return f.common.async?Promise.all(b).then(z=>t.ParseStatus.mergeArray(c,z)):t.ParseStatus.mergeArray(c,b)}get items(){return this._def.items}rest(i){return new re({...this._def,rest:i})}}n.ZodTuple=re,re.create=(_,i)=>{if(!Array.isArray(_))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new re({items:_,typeName:ne.ZodTuple,rest:null,...u(i)})};class fe extends d{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(i){const{status:c,ctx:f}=this._processInputParams(i);if(f.parsedType!==a.ZodParsedType.object)return(0,t.addIssueToContext)(f,{code:s.ZodIssueCode.invalid_type,expected:a.ZodParsedType.object,received:f.parsedType}),t.INVALID;const w=[],b=this._def.keyType,z=this._def.valueType;for(const Z in f.data)w.push({key:b._parse(new o(f,Z,f.path,Z)),value:z._parse(new o(f,f.data[Z],f.path,Z))});return f.common.async?t.ParseStatus.mergeObjectAsync(c,w):t.ParseStatus.mergeObjectSync(c,w)}get element(){return this._def.valueType}static create(i,c,f){return c instanceof d?new fe({keyType:i,valueType:c,typeName:ne.ZodRecord,...u(f)}):new fe({keyType:S.create(),valueType:i,typeName:ne.ZodRecord,...u(c)})}}n.ZodRecord=fe;class be extends d{_parse(i){const{status:c,ctx:f}=this._processInputParams(i);if(f.parsedType!==a.ZodParsedType.map)return(0,t.addIssueToContext)(f,{code:s.ZodIssueCode.invalid_type,expected:a.ZodParsedType.map,received:f.parsedType}),t.INVALID;const w=this._def.keyType,b=this._def.valueType,z=[...f.data.entries()].map(([Z,X],ee)=>({key:w._parse(new o(f,Z,f.path,[ee,"key"])),value:b._parse(new o(f,X,f.path,[ee,"value"]))}));if(f.common.async){const Z=new Map;return Promise.resolve().then(async()=>{for(const X of z){const ee=await X.key,pe=await X.value;if(ee.status==="aborted"||pe.status==="aborted")return t.INVALID;(ee.status==="dirty"||pe.status==="dirty")&&c.dirty(),Z.set(ee.value,pe.value)}return{status:c.value,value:Z}})}else{const Z=new Map;for(const X of z){const ee=X.key,pe=X.value;if(ee.status==="aborted"||pe.status==="aborted")return t.INVALID;(ee.status==="dirty"||pe.status==="dirty")&&c.dirty(),Z.set(ee.value,pe.value)}return{status:c.value,value:Z}}}}n.ZodMap=be,be.create=(_,i,c)=>new be({valueType:i,keyType:_,typeName:ne.ZodMap,...u(c)});class $ extends d{_parse(i){const{status:c,ctx:f}=this._processInputParams(i);if(f.parsedType!==a.ZodParsedType.set)return(0,t.addIssueToContext)(f,{code:s.ZodIssueCode.invalid_type,expected:a.ZodParsedType.set,received:f.parsedType}),t.INVALID;const w=this._def;w.minSize!==null&&f.data.size<w.minSize.value&&((0,t.addIssueToContext)(f,{code:s.ZodIssueCode.too_small,minimum:w.minSize.value,type:"set",inclusive:!0,exact:!1,message:w.minSize.message}),c.dirty()),w.maxSize!==null&&f.data.size>w.maxSize.value&&((0,t.addIssueToContext)(f,{code:s.ZodIssueCode.too_big,maximum:w.maxSize.value,type:"set",inclusive:!0,exact:!1,message:w.maxSize.message}),c.dirty());const b=this._def.valueType;function z(X){const ee=new Set;for(const pe of X){if(pe.status==="aborted")return t.INVALID;pe.status==="dirty"&&c.dirty(),ee.add(pe.value)}return{status:c.value,value:ee}}const Z=[...f.data.values()].map((X,ee)=>b._parse(new o(f,X,f.path,ee)));return f.common.async?Promise.all(Z).then(X=>z(X)):z(Z)}min(i,c){return new $({...this._def,minSize:{value:i,message:r.errorUtil.toString(c)}})}max(i,c){return new $({...this._def,maxSize:{value:i,message:r.errorUtil.toString(c)}})}size(i,c){return this.min(i,c).max(i,c)}nonempty(i){return this.min(1,i)}}n.ZodSet=$,$.create=(_,i)=>new $({valueType:_,minSize:null,maxSize:null,typeName:ne.ZodSet,...u(i)});class h extends d{constructor(){super(...arguments),this.validate=this.implement}_parse(i){const{ctx:c}=this._processInputParams(i);if(c.parsedType!==a.ZodParsedType.function)return(0,t.addIssueToContext)(c,{code:s.ZodIssueCode.invalid_type,expected:a.ZodParsedType.function,received:c.parsedType}),t.INVALID;function f(Z,X){return(0,t.makeIssue)({data:Z,path:c.path,errorMaps:[c.common.contextualErrorMap,c.schemaErrorMap,(0,e.getErrorMap)(),e.defaultErrorMap].filter(ee=>!!ee),issueData:{code:s.ZodIssueCode.invalid_arguments,argumentsError:X}})}function w(Z,X){return(0,t.makeIssue)({data:Z,path:c.path,errorMaps:[c.common.contextualErrorMap,c.schemaErrorMap,(0,e.getErrorMap)(),e.defaultErrorMap].filter(ee=>!!ee),issueData:{code:s.ZodIssueCode.invalid_return_type,returnTypeError:X}})}const b={errorMap:c.common.contextualErrorMap},z=c.data;return this._def.returns instanceof se?(0,t.OK)(async(...Z)=>{const X=new s.ZodError([]),ee=await this._def.args.parseAsync(Z,b).catch(or=>{throw X.addIssue(f(Z,or)),X}),pe=await z(...ee);return await this._def.returns._def.type.parseAsync(pe,b).catch(or=>{throw X.addIssue(w(pe,or)),X})}):(0,t.OK)((...Z)=>{const X=this._def.args.safeParse(Z,b);if(!X.success)throw new s.ZodError([f(Z,X.error)]);const ee=z(...X.data),pe=this._def.returns.safeParse(ee,b);if(!pe.success)throw new s.ZodError([w(ee,pe.error)]);return pe.data})}parameters(){return this._def.args}returnType(){return this._def.returns}args(...i){return new h({...this._def,args:re.create(i).rest(G.create())})}returns(i){return new h({...this._def,returns:i})}implement(i){return this.parse(i)}strictImplement(i){return this.parse(i)}static create(i,c,f){return new h({args:i||re.create([]).rest(G.create()),returns:c||G.create(),typeName:ne.ZodFunction,...u(f)})}}n.ZodFunction=h;class g extends d{get schema(){return this._def.getter()}_parse(i){const{ctx:c}=this._processInputParams(i);return this._def.getter()._parse({data:c.data,path:c.path,parent:c})}}n.ZodLazy=g,g.create=(_,i)=>new g({getter:_,typeName:ne.ZodLazy,...u(i)});class T extends d{_parse(i){if(i.data!==this._def.value){const c=this._getOrReturnCtx(i);return(0,t.addIssueToContext)(c,{received:c.data,code:s.ZodIssueCode.invalid_literal,expected:this._def.value}),t.INVALID}return{status:"valid",value:i.data}}get value(){return this._def.value}}n.ZodLiteral=T,T.create=(_,i)=>new T({value:_,typeName:ne.ZodLiteral,...u(i)});function K(_,i){return new U({values:_,typeName:ne.ZodEnum,...u(i)})}class U extends d{_parse(i){if(typeof i.data!="string"){const c=this._getOrReturnCtx(i),f=this._def.values;return(0,t.addIssueToContext)(c,{expected:a.util.joinValues(f),received:c.parsedType,code:s.ZodIssueCode.invalid_type}),t.INVALID}if(this._def.values.indexOf(i.data)===-1){const c=this._getOrReturnCtx(i),f=this._def.values;return(0,t.addIssueToContext)(c,{received:c.data,code:s.ZodIssueCode.invalid_enum_value,options:f}),t.INVALID}return(0,t.OK)(i.data)}get options(){return this._def.values}get enum(){const i={};for(const c of this._def.values)i[c]=c;return i}get Values(){const i={};for(const c of this._def.values)i[c]=c;return i}get Enum(){const i={};for(const c of this._def.values)i[c]=c;return i}extract(i){return U.create(i)}exclude(i){return U.create(this.options.filter(c=>!i.includes(c)))}}n.ZodEnum=U,U.create=K;class W extends d{_parse(i){const c=a.util.getValidEnumValues(this._def.values),f=this._getOrReturnCtx(i);if(f.parsedType!==a.ZodParsedType.string&&f.parsedType!==a.ZodParsedType.number){const w=a.util.objectValues(c);return(0,t.addIssueToContext)(f,{expected:a.util.joinValues(w),received:f.parsedType,code:s.ZodIssueCode.invalid_type}),t.INVALID}if(c.indexOf(i.data)===-1){const w=a.util.objectValues(c);return(0,t.addIssueToContext)(f,{received:f.data,code:s.ZodIssueCode.invalid_enum_value,options:w}),t.INVALID}return(0,t.OK)(i.data)}get enum(){return this._def.values}}n.ZodNativeEnum=W,W.create=(_,i)=>new W({values:_,typeName:ne.ZodNativeEnum,...u(i)});class se extends d{unwrap(){return this._def.type}_parse(i){const{ctx:c}=this._processInputParams(i);if(c.parsedType!==a.ZodParsedType.promise&&c.common.async===!1)return(0,t.addIssueToContext)(c,{code:s.ZodIssueCode.invalid_type,expected:a.ZodParsedType.promise,received:c.parsedType}),t.INVALID;const f=c.parsedType===a.ZodParsedType.promise?c.data:Promise.resolve(c.data);return(0,t.OK)(f.then(w=>this._def.type.parseAsync(w,{path:c.path,errorMap:c.common.contextualErrorMap})))}}n.ZodPromise=se,se.create=(_,i)=>new se({type:_,typeName:ne.ZodPromise,...u(i)});class me extends d{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===ne.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(i){const{status:c,ctx:f}=this._processInputParams(i),w=this._def.effect||null;if(w.type==="preprocess"){const z=w.transform(f.data);return f.common.async?Promise.resolve(z).then(Z=>this._def.schema._parseAsync({data:Z,path:f.path,parent:f})):this._def.schema._parseSync({data:z,path:f.path,parent:f})}const b={addIssue:z=>{(0,t.addIssueToContext)(f,z),z.fatal?c.abort():c.dirty()},get path(){return f.path}};if(b.addIssue=b.addIssue.bind(b),w.type==="refinement"){const z=Z=>{const X=w.refinement(Z,b);if(f.common.async)return Promise.resolve(X);if(X instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return Z};if(f.common.async===!1){const Z=this._def.schema._parseSync({data:f.data,path:f.path,parent:f});return Z.status==="aborted"?t.INVALID:(Z.status==="dirty"&&c.dirty(),z(Z.value),{status:c.value,value:Z.value})}else return this._def.schema._parseAsync({data:f.data,path:f.path,parent:f}).then(Z=>Z.status==="aborted"?t.INVALID:(Z.status==="dirty"&&c.dirty(),z(Z.value).then(()=>({status:c.value,value:Z.value}))))}if(w.type==="transform")if(f.common.async===!1){const z=this._def.schema._parseSync({data:f.data,path:f.path,parent:f});if(!(0,t.isValid)(z))return z;const Z=w.transform(z.value,b);if(Z instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:c.value,value:Z}}else return this._def.schema._parseAsync({data:f.data,path:f.path,parent:f}).then(z=>(0,t.isValid)(z)?Promise.resolve(w.transform(z.value,b)).then(Z=>({status:c.value,value:Z})):z);a.util.assertNever(w)}}n.ZodEffects=me,n.ZodTransformer=me,me.create=(_,i,c)=>new me({schema:_,typeName:ne.ZodEffects,effect:i,...u(c)}),me.createWithPreprocess=(_,i,c)=>new me({schema:i,effect:{type:"preprocess",transform:_},typeName:ne.ZodEffects,...u(c)});class ge extends d{_parse(i){return this._getType(i)===a.ZodParsedType.undefined?(0,t.OK)(void 0):this._def.innerType._parse(i)}unwrap(){return this._def.innerType}}n.ZodOptional=ge,ge.create=(_,i)=>new ge({innerType:_,typeName:ne.ZodOptional,...u(i)});class Pe extends d{_parse(i){return this._getType(i)===a.ZodParsedType.null?(0,t.OK)(null):this._def.innerType._parse(i)}unwrap(){return this._def.innerType}}n.ZodNullable=Pe,Pe.create=(_,i)=>new Pe({innerType:_,typeName:ne.ZodNullable,...u(i)});class Ie extends d{_parse(i){const{ctx:c}=this._processInputParams(i);let f=c.data;return c.parsedType===a.ZodParsedType.undefined&&(f=this._def.defaultValue()),this._def.innerType._parse({data:f,path:c.path,parent:c})}removeDefault(){return this._def.innerType}}n.ZodDefault=Ie,Ie.create=(_,i)=>new Ie({innerType:_,typeName:ne.ZodDefault,defaultValue:typeof i.default=="function"?i.default:()=>i.default,...u(i)});class Te extends d{_parse(i){const{ctx:c}=this._processInputParams(i),f={...c,common:{...c.common,issues:[]}},w=this._def.innerType._parse({data:f.data,path:f.path,parent:{...f}});return(0,t.isAsync)(w)?w.then(b=>({status:"valid",value:b.status==="valid"?b.value:this._def.catchValue({get error(){return new s.ZodError(f.common.issues)},input:f.data})})):{status:"valid",value:w.status==="valid"?w.value:this._def.catchValue({get error(){return new s.ZodError(f.common.issues)},input:f.data})}}removeCatch(){return this._def.innerType}}n.ZodCatch=Te,Te.create=(_,i)=>new Te({innerType:_,typeName:ne.ZodCatch,catchValue:typeof i.catch=="function"?i.catch:()=>i.catch,...u(i)});class ve extends d{_parse(i){if(this._getType(i)!==a.ZodParsedType.nan){const f=this._getOrReturnCtx(i);return(0,t.addIssueToContext)(f,{code:s.ZodIssueCode.invalid_type,expected:a.ZodParsedType.nan,received:f.parsedType}),t.INVALID}return{status:"valid",value:i.data}}}n.ZodNaN=ve,ve.create=_=>new ve({typeName:ne.ZodNaN,...u(_)}),n.BRAND=Symbol("zod_brand");class we extends d{_parse(i){const{ctx:c}=this._processInputParams(i),f=c.data;return this._def.type._parse({data:f,path:c.path,parent:c})}unwrap(){return this._def.type}}n.ZodBranded=we;class Re extends d{_parse(i){const{status:c,ctx:f}=this._processInputParams(i);if(f.common.async)return(async()=>{const b=await this._def.in._parseAsync({data:f.data,path:f.path,parent:f});return b.status==="aborted"?t.INVALID:b.status==="dirty"?(c.dirty(),(0,t.DIRTY)(b.value)):this._def.out._parseAsync({data:b.value,path:f.path,parent:f})})();{const w=this._def.in._parseSync({data:f.data,path:f.path,parent:f});return w.status==="aborted"?t.INVALID:w.status==="dirty"?(c.dirty(),{status:"dirty",value:w.value}):this._def.out._parseSync({data:w.value,path:f.path,parent:f})}}static create(i,c){return new Re({in:i,out:c,typeName:ne.ZodPipeline})}}n.ZodPipeline=Re;const xt=(_,i={},c)=>_?Y.create().superRefine((f,w)=>{var b,z;if(!_(f)){const Z=typeof i=="function"?i(f):typeof i=="string"?{message:i}:i,X=(z=(b=Z.fatal)!==null&&b!==void 0?b:c)!==null&&z!==void 0?z:!0,ee=typeof Z=="string"?{message:Z}:Z;w.addIssue({code:"custom",...ee,fatal:X})}}):Y.create();n.custom=xt,n.late={object:x.lazycreate};var ne;(function(_){_.ZodString="ZodString",_.ZodNumber="ZodNumber",_.ZodNaN="ZodNaN",_.ZodBigInt="ZodBigInt",_.ZodBoolean="ZodBoolean",_.ZodDate="ZodDate",_.ZodSymbol="ZodSymbol",_.ZodUndefined="ZodUndefined",_.ZodNull="ZodNull",_.ZodAny="ZodAny",_.ZodUnknown="ZodUnknown",_.ZodNever="ZodNever",_.ZodVoid="ZodVoid",_.ZodArray="ZodArray",_.ZodObject="ZodObject",_.ZodUnion="ZodUnion",_.ZodDiscriminatedUnion="ZodDiscriminatedUnion",_.ZodIntersection="ZodIntersection",_.ZodTuple="ZodTuple",_.ZodRecord="ZodRecord",_.ZodMap="ZodMap",_.ZodSet="ZodSet",_.ZodFunction="ZodFunction",_.ZodLazy="ZodLazy",_.ZodLiteral="ZodLiteral",_.ZodEnum="ZodEnum",_.ZodEffects="ZodEffects",_.ZodNativeEnum="ZodNativeEnum",_.ZodOptional="ZodOptional",_.ZodNullable="ZodNullable",_.ZodDefault="ZodDefault",_.ZodCatch="ZodCatch",_.ZodPromise="ZodPromise",_.ZodBranded="ZodBranded",_.ZodPipeline="ZodPipeline"})(ne=n.ZodFirstPartyTypeKind||(n.ZodFirstPartyTypeKind={}));const Ua=(_,i={message:`Input not instance of ${_.name}`})=>(0,n.custom)(c=>c instanceof _,i);n.instanceof=Ua;const Wr=S.create;n.string=Wr;const Jr=I.create;n.number=Jr;const Va=ve.create;n.nan=Va;const Ba=A.create;n.bigint=Ba;const Qr=m.create;n.boolean=Qr;const $a=y.create;n.date=$a;const Ka=p.create;n.symbol=Ka;const za=O.create;n.undefined=za;const Fa=k.create;n.null=Fa;const qa=Y.create;n.any=qa;const Ha=G.create;n.unknown=Ha;const Ya=H.create;n.never=Ya;const Ga=B.create;n.void=Ga;const Wa=Q.create;n.array=Wa;const Ja=x.create;n.object=Ja;const Qa=x.strictCreate;n.strictObject=Qa;const Xa=F.create;n.union=Xa;const es=ie.create;n.discriminatedUnion=es;const ts=M.create;n.intersection=ts;const rs=re.create;n.tuple=rs;const ns=fe.create;n.record=ns;const as=be.create;n.map=as;const ss=$.create;n.set=ss;const is=h.create;n.function=is;const os=g.create;n.lazy=os;const us=T.create;n.literal=us;const ls=U.create;n.enum=ls;const cs=W.create;n.nativeEnum=cs;const ds=se.create;n.promise=ds;const Xr=me.create;n.effect=Xr,n.transformer=Xr;const hs=ge.create;n.optional=hs;const fs=Pe.create;n.nullable=fs;const ps=me.createWithPreprocess;n.preprocess=ps;const ms=Re.create;n.pipeline=ms;const gs=()=>Wr().optional();n.ostring=gs;const ys=()=>Jr().optional();n.onumber=ys;const _s=()=>Qr().optional();n.oboolean=_s,n.coerce={string:_=>S.create({..._,coerce:!0}),number:_=>I.create({..._,coerce:!0}),boolean:_=>m.create({..._,coerce:!0}),bigint:_=>A.create({..._,coerce:!0}),date:_=>y.create({..._,coerce:!0})},n.NEVER=t.INVALID}(yr)),yr}var En;function kn(){return En||(En=1,function(n){var e=Oe&&Oe.__createBinding||(Object.create?function(t,a,s,o){o===void 0&&(o=s),Object.defineProperty(t,o,{enumerable:!0,get:function(){return a[s]}})}:function(t,a,s,o){o===void 0&&(o=s),t[o]=a[s]}),r=Oe&&Oe.__exportStar||function(t,a){for(var s in t)s!=="default"&&!Object.prototype.hasOwnProperty.call(a,s)&&e(a,t,s)};Object.defineProperty(n,"__esModule",{value:!0}),r($r(),n),r(Pa(),n),r(oo(),n),r(Ht(),n),r(lo(),n),r(Br(),n)}(fr)),fr}var An;function Kr(){return An||(An=1,function(n){var e=Oe&&Oe.__createBinding||(Object.create?function(o,l,u,d){d===void 0&&(d=u),Object.defineProperty(o,d,{enumerable:!0,get:function(){return l[u]}})}:function(o,l,u,d){d===void 0&&(d=u),o[d]=l[u]}),r=Oe&&Oe.__setModuleDefault||(Object.create?function(o,l){Object.defineProperty(o,"default",{enumerable:!0,value:l})}:function(o,l){o.default=l}),t=Oe&&Oe.__importStar||function(o){if(o&&o.__esModule)return o;var l={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&e(l,o,u);return r(l,o),l},a=Oe&&Oe.__exportStar||function(o,l){for(var u in o)u!=="default"&&!Object.prototype.hasOwnProperty.call(l,u)&&e(l,o,u)};Object.defineProperty(n,"__esModule",{value:!0}),n.z=void 0;const s=t(kn());n.z=s,a(kn(),n),n.default=s}(hr)),hr}var Yt={};Object.defineProperty(Yt,"__esModule",{value:!0});Yt.parseAnyDef=void 0;function co(){return{}}Yt.parseAnyDef=co;var dt={},Be={};Object.defineProperty(Be,"__esModule",{value:!0});Be.setResponseValueAndErrors=Be.addErrorMessage=void 0;function Ta(n,e,r,t){t!=null&&t.errorMessages&&r&&(n.errorMessage=Object.assign(Object.assign({},n.errorMessage),{[e]:r}))}Be.addErrorMessage=Ta;function ho(n,e,r,t,a){n[e]=r,Ta(n,e,t,a)}Be.setResponseValueAndErrors=ho;var Cn;function fo(){if(Cn)return dt;Cn=1,Object.defineProperty(dt,"__esModule",{value:!0}),dt.parseArrayDef=void 0;const n=Kr(),e=Be,r=xe();function t(a,s){var o,l;const u={type:"array"};return((l=(o=a.type)===null||o===void 0?void 0:o._def)===null||l===void 0?void 0:l.typeName)!==n.ZodFirstPartyTypeKind.ZodAny&&(u.items=(0,r.parseDef)(a.type._def,Object.assign(Object.assign({},s),{currentPath:[...s.currentPath,"items"]}))),a.minLength&&(0,e.setResponseValueAndErrors)(u,"minItems",a.minLength.value,a.minLength.message,s),a.maxLength&&(0,e.setResponseValueAndErrors)(u,"maxItems",a.maxLength.value,a.maxLength.message,s),a.exactLength&&((0,e.setResponseValueAndErrors)(u,"minItems",a.exactLength.value,a.exactLength.message,s),(0,e.setResponseValueAndErrors)(u,"maxItems",a.exactLength.value,a.exactLength.message,s)),u}return dt.parseArrayDef=t,dt}var Gt={};Object.defineProperty(Gt,"__esModule",{value:!0});Gt.parseBigintDef=void 0;const Je=Be;function po(n,e){const r={type:"integer",format:"int64"};if(!n.checks)return r;for(const t of n.checks)switch(t.kind){case"min":e.target==="jsonSchema7"?t.inclusive?(0,Je.setResponseValueAndErrors)(r,"minimum",t.value,t.message,e):(0,Je.setResponseValueAndErrors)(r,"exclusiveMinimum",t.value,t.message,e):(t.inclusive||(r.exclusiveMinimum=!0),(0,Je.setResponseValueAndErrors)(r,"minimum",t.value,t.message,e));break;case"max":e.target==="jsonSchema7"?t.inclusive?(0,Je.setResponseValueAndErrors)(r,"maximum",t.value,t.message,e):(0,Je.setResponseValueAndErrors)(r,"exclusiveMaximum",t.value,t.message,e):(t.inclusive||(r.exclusiveMaximum=!0),(0,Je.setResponseValueAndErrors)(r,"maximum",t.value,t.message,e));break;case"multipleOf":(0,Je.setResponseValueAndErrors)(r,"multipleOf",t.value,t.message,e);break}return r}Gt.parseBigintDef=po;var Wt={};Object.defineProperty(Wt,"__esModule",{value:!0});Wt.parseBooleanDef=void 0;function mo(){return{type:"boolean"}}Wt.parseBooleanDef=mo;var ht={},xn;function go(){if(xn)return ht;xn=1,Object.defineProperty(ht,"__esModule",{value:!0}),ht.parseBrandedDef=void 0;const n=xe();function e(r,t){return(0,n.parseDef)(r.type._def,t)}return ht.parseBrandedDef=e,ht}var ft={},jn;function yo(){if(jn)return ft;jn=1,Object.defineProperty(ft,"__esModule",{value:!0}),ft.parseCatchDef=void 0;const n=xe(),e=(r,t)=>(0,n.parseDef)(r.innerType._def,t);return ft.parseCatchDef=e,ft}var Jt={};Object.defineProperty(Jt,"__esModule",{value:!0});Jt.parseDateDef=void 0;const Sn=Be;function _o(n,e){return e.dateStrategy=="integer"?bo(n,e):{type:"string",format:"date-time"}}Jt.parseDateDef=_o;const bo=(n,e)=>{const r={type:"integer",format:"unix-time"};for(const t of n.checks)switch(t.kind){case"min":e.target==="jsonSchema7"&&(0,Sn.setResponseValueAndErrors)(r,"minimum",t.value,t.message,e);break;case"max":e.target==="jsonSchema7"&&(0,Sn.setResponseValueAndErrors)(r,"maximum",t.value,t.message,e);break}return r};var pt={},Nn;function vo(){if(Nn)return pt;Nn=1,Object.defineProperty(pt,"__esModule",{value:!0}),pt.parseDefaultDef=void 0;const n=xe();function e(r,t){return Object.assign(Object.assign({},(0,n.parseDef)(r.innerType._def,t)),{default:r.defaultValue()})}return pt.parseDefaultDef=e,pt}var mt={},Dn;function wo(){if(Dn)return mt;Dn=1,Object.defineProperty(mt,"__esModule",{value:!0}),mt.parseEffectsDef=void 0;const n=xe();function e(r,t){return t.effectStrategy==="input"?(0,n.parseDef)(r.schema._def,t):{}}return mt.parseEffectsDef=e,mt}var Qt={};Object.defineProperty(Qt,"__esModule",{value:!0});Qt.parseEnumDef=void 0;function Io(n){return{type:"string",enum:n.values}}Qt.parseEnumDef=Io;var gt={},Ln;function Po(){if(Ln)return gt;Ln=1;var n=Oe&&Oe.__rest||function(a,s){var o={};for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&s.indexOf(l)<0&&(o[l]=a[l]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,l=Object.getOwnPropertySymbols(a);u<l.length;u++)s.indexOf(l[u])<0&&Object.prototype.propertyIsEnumerable.call(a,l[u])&&(o[l[u]]=a[l[u]]);return o};Object.defineProperty(gt,"__esModule",{value:!0}),gt.parseIntersectionDef=void 0;const e=xe(),r=a=>"type"in a&&a.type==="string"?!1:"allOf"in a;function t(a,s){const o=[(0,e.parseDef)(a.left._def,Object.assign(Object.assign({},s),{currentPath:[...s.currentPath,"allOf","0"]})),(0,e.parseDef)(a.right._def,Object.assign(Object.assign({},s),{currentPath:[...s.currentPath,"allOf","1"]}))].filter(d=>!!d);let l=s.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const u=[];return o.forEach(d=>{if(r(d))u.push(...d.allOf),d.unevaluatedProperties===void 0&&(l=void 0);else{let v=d;"additionalProperties"in d&&d.additionalProperties===!1?v=n(d,["additionalProperties"]):l=void 0,u.push(v)}}),u.length?Object.assign({allOf:u},l):void 0}return gt.parseIntersectionDef=t,gt}var Xt={};Object.defineProperty(Xt,"__esModule",{value:!0});Xt.parseLiteralDef=void 0;function To(n,e){const r=typeof n.value;return r!=="bigint"&&r!=="number"&&r!=="boolean"&&r!=="string"?{type:Array.isArray(n.value)?"array":"object"}:e.target==="openApi3"?{type:r==="bigint"?"integer":r,enum:[n.value]}:{type:r==="bigint"?"integer":r,const:n.value}}Xt.parseLiteralDef=To;var yt={},Zn;function Oo(){if(Zn)return yt;Zn=1,Object.defineProperty(yt,"__esModule",{value:!0}),yt.parseMapDef=void 0;const n=xe();function e(r,t){const a=(0,n.parseDef)(r.keyType._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"items","items","0"]}))||{},s=(0,n.parseDef)(r.valueType._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"items","items","1"]}))||{};return{type:"array",maxItems:125,items:{type:"array",items:[a,s],minItems:2,maxItems:2}}}return yt.parseMapDef=e,yt}var er={};Object.defineProperty(er,"__esModule",{value:!0});er.parseNativeEnumDef=void 0;function Eo(n){const e=n.values,t=Object.keys(n.values).filter(s=>typeof e[e[s]]!="number").map(s=>e[s]),a=Array.from(new Set(t.map(s=>typeof s)));return{type:a.length===1?a[0]==="string"?"string":"number":["string","number"],enum:t}}er.parseNativeEnumDef=Eo;var tr={};Object.defineProperty(tr,"__esModule",{value:!0});tr.parseNeverDef=void 0;function ko(){return{not:{}}}tr.parseNeverDef=ko;var rr={};Object.defineProperty(rr,"__esModule",{value:!0});rr.parseNullDef=void 0;function Ao(n){return n.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}rr.parseNullDef=Ao;var _t={},br={},Mn;function Oa(){return Mn||(Mn=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.parseUnionDef=n.primitiveMappings=void 0;const e=xe();n.primitiveMappings={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function r(a,s){if(s.target==="openApi3")return t(a,s);const o=a.options instanceof Map?Array.from(a.options.values()):a.options;if(o.every(l=>l._def.typeName in n.primitiveMappings&&(!l._def.checks||!l._def.checks.length))){const l=o.reduce((u,d)=>{const v=n.primitiveMappings[d._def.typeName];return v&&!u.includes(v)?[...u,v]:u},[]);return{type:l.length>1?l:l[0]}}else if(o.every(l=>l._def.typeName==="ZodLiteral"&&!l.description)){const l=o.reduce((u,d)=>{const v=typeof d._def.value;switch(v){case"string":case"number":case"boolean":return[...u,v];case"bigint":return[...u,"integer"];case"object":if(d._def.value===null)return[...u,"null"];case"symbol":case"undefined":case"function":default:return u}},[]);if(l.length===o.length){const u=l.filter((d,v,C)=>C.indexOf(d)===v);return{type:u.length>1?u:u[0],enum:o.reduce((d,v)=>d.includes(v._def.value)?d:[...d,v._def.value],[])}}}else if(o.every(l=>l._def.typeName==="ZodEnum"))return{type:"string",enum:o.reduce((l,u)=>[...l,...u._def.values.filter(d=>!l.includes(d))],[])};return t(a,s)}n.parseUnionDef=r;const t=(a,s)=>{const o=(a.options instanceof Map?Array.from(a.options.values()):a.options).map((l,u)=>(0,e.parseDef)(l._def,Object.assign(Object.assign({},s),{currentPath:[...s.currentPath,"anyOf",`${u}`]}))).filter(l=>!!l&&(!s.strictUnions||typeof l=="object"&&Object.keys(l).length>0));return o.length?{anyOf:o}:void 0}}(br)),br}var Rn;function Co(){if(Rn)return _t;Rn=1,Object.defineProperty(_t,"__esModule",{value:!0}),_t.parseNullableDef=void 0;const n=xe(),e=Oa();function r(t,a){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(t.innerType._def.typeName)&&(!t.innerType._def.checks||!t.innerType._def.checks.length))return a.target==="openApi3"?{type:e.primitiveMappings[t.innerType._def.typeName],nullable:!0}:{type:[e.primitiveMappings[t.innerType._def.typeName],"null"]};if(a.target==="openApi3"){const o=(0,n.parseDef)(t.innerType._def,Object.assign(Object.assign({},a),{currentPath:[...a.currentPath]}));return o&&Object.assign(Object.assign({},o),{nullable:!0})}const s=(0,n.parseDef)(t.innerType._def,Object.assign(Object.assign({},a),{currentPath:[...a.currentPath,"anyOf","0"]}));return s&&{anyOf:[s,{type:"null"}]}}return _t.parseNullableDef=r,_t}var nr={};Object.defineProperty(nr,"__esModule",{value:!0});nr.parseNumberDef=void 0;const We=Be;function xo(n,e){const r={type:"number"};if(!n.checks)return r;for(const t of n.checks)switch(t.kind){case"int":r.type="integer",(0,We.addErrorMessage)(r,"type",t.message,e);break;case"min":e.target==="jsonSchema7"?t.inclusive?(0,We.setResponseValueAndErrors)(r,"minimum",t.value,t.message,e):(0,We.setResponseValueAndErrors)(r,"exclusiveMinimum",t.value,t.message,e):(t.inclusive||(r.exclusiveMinimum=!0),(0,We.setResponseValueAndErrors)(r,"minimum",t.value,t.message,e));break;case"max":e.target==="jsonSchema7"?t.inclusive?(0,We.setResponseValueAndErrors)(r,"maximum",t.value,t.message,e):(0,We.setResponseValueAndErrors)(r,"exclusiveMaximum",t.value,t.message,e):(t.inclusive||(r.exclusiveMaximum=!0),(0,We.setResponseValueAndErrors)(r,"maximum",t.value,t.message,e));break;case"multipleOf":(0,We.setResponseValueAndErrors)(r,"multipleOf",t.value,t.message,e);break}return r}nr.parseNumberDef=xo;var Qe={},Un;function jo(){if(Un)return Qe;Un=1,Object.defineProperty(Qe,"__esModule",{value:!0}),Qe.parseObjectDef=Qe.parseObjectDefX=void 0;const n=xe();function e(t,a){var s,o;Object.keys(t.shape()).reduce((u,d)=>{let v=t.shape()[d];const C=v.isOptional();C||(v=Object.assign({},v._def.innerSchema));const V=(0,n.parseDef)(v._def,Object.assign(Object.assign({},a),{currentPath:[...a.currentPath,"properties",d],propertyPath:[...a.currentPath,"properties",d]}));return V!==void 0&&(u.properties[d]=V,C||(u.required||(u.required=[]),u.required.push(d))),u},{type:"object",properties:{},additionalProperties:t.catchall._def.typeName==="ZodNever"?t.unknownKeys==="passthrough":(s=(0,n.parseDef)(t.catchall._def,Object.assign(Object.assign({},a),{currentPath:[...a.currentPath,"additionalProperties"]})))!==null&&s!==void 0?s:!0});const l=Object.assign(Object.assign({type:"object"},Object.entries(t.shape()).reduce((u,[d,v])=>{if(v===void 0||v._def===void 0)return u;const C=(0,n.parseDef)(v._def,Object.assign(Object.assign({},a),{currentPath:[...a.currentPath,"properties",d],propertyPath:[...a.currentPath,"properties",d]}));return C===void 0?u:{properties:Object.assign(Object.assign({},u.properties),{[d]:C}),required:v.isOptional()?u.required:[...u.required,d]}},{properties:{},required:[]})),{additionalProperties:t.catchall._def.typeName==="ZodNever"?t.unknownKeys==="passthrough":(o=(0,n.parseDef)(t.catchall._def,Object.assign(Object.assign({},a),{currentPath:[...a.currentPath,"additionalProperties"]})))!==null&&o!==void 0?o:!0});return l.required.length||delete l.required,l}Qe.parseObjectDefX=e;function r(t,a){var s;const o=Object.assign(Object.assign({type:"object"},Object.entries(t.shape()).reduce((l,[u,d])=>{if(d===void 0||d._def===void 0)return l;const v=(0,n.parseDef)(d._def,Object.assign(Object.assign({},a),{currentPath:[...a.currentPath,"properties",u],propertyPath:[...a.currentPath,"properties",u]}));return v===void 0?l:{properties:Object.assign(Object.assign({},l.properties),{[u]:v}),required:d.isOptional()?l.required:[...l.required,u]}},{properties:{},required:[]})),{additionalProperties:t.catchall._def.typeName==="ZodNever"?t.unknownKeys==="passthrough":(s=(0,n.parseDef)(t.catchall._def,Object.assign(Object.assign({},a),{currentPath:[...a.currentPath,"additionalProperties"]})))!==null&&s!==void 0?s:!0});return o.required.length||delete o.required,o}return Qe.parseObjectDef=r,Qe}var bt={},Vn;function So(){if(Vn)return bt;Vn=1,Object.defineProperty(bt,"__esModule",{value:!0}),bt.parseOptionalDef=void 0;const n=xe(),e=(r,t)=>{var a;if(t.currentPath.toString()===((a=t.propertyPath)===null||a===void 0?void 0:a.toString()))return(0,n.parseDef)(r.innerType._def,t);const s=(0,n.parseDef)(r.innerType._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"anyOf","1"]}));return s?{anyOf:[{not:{}},s]}:{}};return bt.parseOptionalDef=e,bt}var vt={},Bn;function No(){if(Bn)return vt;Bn=1,Object.defineProperty(vt,"__esModule",{value:!0}),vt.parsePipelineDef=void 0;const n=xe(),e=(r,t)=>{if(t.pipeStrategy==="input")return(0,n.parseDef)(r.in._def,t);const a=(0,n.parseDef)(r.in._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"allOf","0"]})),s=(0,n.parseDef)(r.out._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"allOf",a?"1":"0"]}));return{allOf:[a,s].filter(o=>o!==void 0)}};return vt.parsePipelineDef=e,vt}var wt={},$n;function Do(){if($n)return wt;$n=1,Object.defineProperty(wt,"__esModule",{value:!0}),wt.parsePromiseDef=void 0;const n=xe();function e(r,t){return(0,n.parseDef)(r.type._def,t)}return wt.parsePromiseDef=e,wt}var It={},zr={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.parseStringDef=n.emojiPattern=n.ulidPattern=n.cuid2Pattern=n.cuidPattern=n.emailPattern=void 0;const e=Be;n.emailPattern='^(([^<>()[\\]\\\\.,;:\\s@\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\"]+)*)|(\\".+\\"))@((\\[(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\])|(\\[IPv6:(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))\\])|([A-Za-z0-9]([A-Za-z0-9-]*[A-Za-z0-9])*(\\.[A-Za-z]{2,})+))$',n.cuidPattern="^c[^\\s-]{8,}$",n.cuid2Pattern="^[a-z][a-z0-9]*$",n.ulidPattern="/[0-9A-HJKMNP-TV-Z]{26}/",n.emojiPattern="/^(p{Extended_Pictographic}|p{Emoji_Component})+$/u";function r(o,l){const u={type:"string"};if(o.checks)for(const d of o.checks)switch(d.kind){case"min":(0,e.setResponseValueAndErrors)(u,"minLength",typeof u.minLength=="number"?Math.max(u.minLength,d.value):d.value,d.message,l);break;case"max":(0,e.setResponseValueAndErrors)(u,"maxLength",typeof u.maxLength=="number"?Math.min(u.maxLength,d.value):d.value,d.message,l);break;case"email":switch(l.emailStrategy){case"format:email":a(u,"email",d.message,l);break;case"format:idn-email":a(u,"idn-email",d.message,l);break;case"pattern:zod":s(u,n.emailPattern,d.message,l);break}break;case"url":a(u,"uri",d.message,l);break;case"uuid":a(u,"uuid",d.message,l);break;case"regex":s(u,d.regex.source,d.message,l);break;case"cuid":s(u,n.cuidPattern,d.message,l);break;case"cuid2":s(u,n.cuid2Pattern,d.message,l);break;case"startsWith":s(u,"^"+t(d.value),d.message,l);break;case"endsWith":s(u,t(d.value)+"$",d.message,l);break;case"datetime":a(u,"date-time",d.message,l);break;case"length":(0,e.setResponseValueAndErrors)(u,"minLength",typeof u.minLength=="number"?Math.max(u.minLength,d.value):d.value,d.message,l),(0,e.setResponseValueAndErrors)(u,"maxLength",typeof u.maxLength=="number"?Math.min(u.maxLength,d.value):d.value,d.message,l);break;case"includes":{s(u,t(d.value),d.message,l);break}case"ip":{d.version!=="v6"&&a(u,"ipv4",d.message,l),d.version!=="v4"&&a(u,"ipv6",d.message,l);break}case"emoji":s(u,n.emojiPattern,d.message,l);break;case"ulid":{s(u,n.ulidPattern,d.message,l);break}}return u}n.parseStringDef=r;const t=o=>Array.from(o).map(l=>/[a-zA-Z0-9]/.test(l)?l:`\\${l}`).join(""),a=(o,l,u,d)=>{var v;o.format||!((v=o.anyOf)===null||v===void 0)&&v.some(C=>C.format)?(o.anyOf||(o.anyOf=[]),o.format&&(o.anyOf.push(Object.assign({format:o.format},o.errorMessage&&d.errorMessages&&{errorMessage:{format:o.errorMessage.format}})),delete o.format,o.errorMessage&&(delete o.errorMessage.format,Object.keys(o.errorMessage).length===0&&delete o.errorMessage)),o.anyOf.push(Object.assign({format:l},u&&d.errorMessages&&{errorMessage:{format:u}}))):(0,e.setResponseValueAndErrors)(o,"format",l,u,d)},s=(o,l,u,d)=>{var v;o.pattern||!((v=o.allOf)===null||v===void 0)&&v.some(C=>C.pattern)?(o.allOf||(o.allOf=[]),o.pattern&&(o.allOf.push(Object.assign({pattern:o.pattern},o.errorMessage&&d.errorMessages&&{errorMessage:{pattern:o.errorMessage.pattern}})),delete o.pattern,o.errorMessage&&(delete o.errorMessage.pattern,Object.keys(o.errorMessage).length===0&&delete o.errorMessage)),o.allOf.push(Object.assign({pattern:l},u&&d.errorMessages&&{errorMessage:{pattern:u}}))):(0,e.setResponseValueAndErrors)(o,"pattern",l,u,d)}})(zr);var Kn;function Lo(){if(Kn)return It;Kn=1,Object.defineProperty(It,"__esModule",{value:!0}),It.parseRecordDef=void 0;const n=Kr(),e=xe(),r=zr;function t(a,s){var o,l,u,d,v;if(s.target==="openApi3"&&((o=a.keyType)===null||o===void 0?void 0:o._def.typeName)===n.ZodFirstPartyTypeKind.ZodEnum)return{type:"object",required:a.keyType._def.values,properties:a.keyType._def.values.reduce((V,R)=>{var E;return Object.assign(Object.assign({},V),{[R]:(E=(0,e.parseDef)(a.valueType._def,Object.assign(Object.assign({},s),{currentPath:[...s.currentPath,"properties",R]})))!==null&&E!==void 0?E:{}})},{}),additionalProperties:!1};const C={type:"object",additionalProperties:(l=(0,e.parseDef)(a.valueType._def,Object.assign(Object.assign({},s),{currentPath:[...s.currentPath,"additionalProperties"]})))!==null&&l!==void 0?l:{}};if(s.target==="openApi3")return C;if(((u=a.keyType)===null||u===void 0?void 0:u._def.typeName)===n.ZodFirstPartyTypeKind.ZodString&&(!((d=a.keyType._def.checks)===null||d===void 0)&&d.length)){const V=Object.entries((0,r.parseStringDef)(a.keyType._def,s)).reduce((R,[E,N])=>E==="type"?R:Object.assign(Object.assign({},R),{[E]:N}),{});return Object.assign(Object.assign({},C),{propertyNames:V})}else if(((v=a.keyType)===null||v===void 0?void 0:v._def.typeName)===n.ZodFirstPartyTypeKind.ZodEnum)return Object.assign(Object.assign({},C),{propertyNames:{enum:a.keyType._def.values}});return C}return It.parseRecordDef=t,It}var Pt={},zn;function Zo(){if(zn)return Pt;zn=1,Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.parseSetDef=void 0;const n=Be,e=xe();function r(t,a){const o={type:"array",uniqueItems:!0,items:(0,e.parseDef)(t.valueType._def,Object.assign(Object.assign({},a),{currentPath:[...a.currentPath,"items"]}))};return t.minSize&&(0,n.setResponseValueAndErrors)(o,"minItems",t.minSize.value,t.minSize.message,a),t.maxSize&&(0,n.setResponseValueAndErrors)(o,"maxItems",t.maxSize.value,t.maxSize.message,a),o}return Pt.parseSetDef=r,Pt}var Tt={},Fn;function Mo(){if(Fn)return Tt;Fn=1,Object.defineProperty(Tt,"__esModule",{value:!0}),Tt.parseTupleDef=void 0;const n=xe();function e(r,t){return r.rest?{type:"array",minItems:r.items.length,items:r.items.map((a,s)=>(0,n.parseDef)(a._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"items",`${s}`]}))).reduce((a,s)=>s===void 0?a:[...a,s],[]),additionalItems:(0,n.parseDef)(r.rest._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"additionalItems"]}))}:{type:"array",minItems:r.items.length,maxItems:r.items.length,items:r.items.map((a,s)=>(0,n.parseDef)(a._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"items",`${s}`]}))).reduce((a,s)=>s===void 0?a:[...a,s],[])}}return Tt.parseTupleDef=e,Tt}var ar={};Object.defineProperty(ar,"__esModule",{value:!0});ar.parseUndefinedDef=void 0;function Ro(){return{not:{}}}ar.parseUndefinedDef=Ro;var sr={};Object.defineProperty(sr,"__esModule",{value:!0});sr.parseUnknownDef=void 0;function Uo(){return{}}sr.parseUnknownDef=Uo;var qn;function xe(){if(qn)return ct;qn=1,Object.defineProperty(ct,"__esModule",{value:!0}),ct.parseDef=void 0;const n=Kr(),e=Yt,r=fo(),t=Gt,a=Wt,s=go(),o=yo(),l=Jt,u=vo(),d=wo(),v=Qt,C=Po(),V=Xt,R=Oo(),E=er,N=tr,P=rr,j=Co(),D=nr,L=jo(),S=So(),J=No(),I=Do(),A=Lo(),m=Zo(),y=zr,p=Mo(),O=ar,k=Oa(),Y=sr;function G(x,F,q=!1){const ie=F.seen.get(x);if(ie&&!q){const re=H(ie,F);if(re!==void 0)return re}const ye={def:x,path:F.currentPath,jsonSchema:void 0};F.seen.set(x,ye);const M=Q(x,x.typeName,F);return M&&he(x,F,M),ye.jsonSchema=M,M}ct.parseDef=G;const H=(x,F)=>{switch(F.$refStrategy){case"root":return{$ref:x.path.length===0?"":x.path.length===1?`${x.path[0]}/`:x.path.join("/")};case"relative":return{$ref:B(F.currentPath,x.path)};case"none":return x.path.length<F.currentPath.length&&x.path.every((q,ie)=>F.currentPath[ie]===q)?(console.warn(`Recursive reference detected at ${F.currentPath.join("/")}! Defaulting to any`),{}):void 0;case"seen":return x.path.length<F.currentPath.length&&x.path.every((q,ie)=>F.currentPath[ie]===q)?(console.warn(`Recursive reference detected at ${F.currentPath.join("/")}! Defaulting to any`),{}):x.jsonSchema}},B=(x,F)=>{let q=0;for(;q<x.length&&q<F.length&&x[q]===F[q];q++);return[(x.length-q).toString(),...F.slice(q)].join("/")},Q=(x,F,q)=>{switch(F){case n.ZodFirstPartyTypeKind.ZodString:return(0,y.parseStringDef)(x,q);case n.ZodFirstPartyTypeKind.ZodNumber:return(0,D.parseNumberDef)(x,q);case n.ZodFirstPartyTypeKind.ZodObject:return(0,L.parseObjectDef)(x,q);case n.ZodFirstPartyTypeKind.ZodBigInt:return(0,t.parseBigintDef)(x,q);case n.ZodFirstPartyTypeKind.ZodBoolean:return(0,a.parseBooleanDef)();case n.ZodFirstPartyTypeKind.ZodDate:return(0,l.parseDateDef)(x,q);case n.ZodFirstPartyTypeKind.ZodUndefined:return(0,O.parseUndefinedDef)();case n.ZodFirstPartyTypeKind.ZodNull:return(0,P.parseNullDef)(q);case n.ZodFirstPartyTypeKind.ZodArray:return(0,r.parseArrayDef)(x,q);case n.ZodFirstPartyTypeKind.ZodUnion:case n.ZodFirstPartyTypeKind.ZodDiscriminatedUnion:return(0,k.parseUnionDef)(x,q);case n.ZodFirstPartyTypeKind.ZodIntersection:return(0,C.parseIntersectionDef)(x,q);case n.ZodFirstPartyTypeKind.ZodTuple:return(0,p.parseTupleDef)(x,q);case n.ZodFirstPartyTypeKind.ZodRecord:return(0,A.parseRecordDef)(x,q);case n.ZodFirstPartyTypeKind.ZodLiteral:return(0,V.parseLiteralDef)(x,q);case n.ZodFirstPartyTypeKind.ZodEnum:return(0,v.parseEnumDef)(x);case n.ZodFirstPartyTypeKind.ZodNativeEnum:return(0,E.parseNativeEnumDef)(x);case n.ZodFirstPartyTypeKind.ZodNullable:return(0,j.parseNullableDef)(x,q);case n.ZodFirstPartyTypeKind.ZodOptional:return(0,S.parseOptionalDef)(x,q);case n.ZodFirstPartyTypeKind.ZodMap:return(0,R.parseMapDef)(x,q);case n.ZodFirstPartyTypeKind.ZodSet:return(0,m.parseSetDef)(x,q);case n.ZodFirstPartyTypeKind.ZodLazy:return G(x.getter()._def,q);case n.ZodFirstPartyTypeKind.ZodPromise:return(0,I.parsePromiseDef)(x,q);case n.ZodFirstPartyTypeKind.ZodNaN:case n.ZodFirstPartyTypeKind.ZodNever:return(0,N.parseNeverDef)();case n.ZodFirstPartyTypeKind.ZodEffects:return(0,d.parseEffectsDef)(x,q);case n.ZodFirstPartyTypeKind.ZodAny:return(0,e.parseAnyDef)();case n.ZodFirstPartyTypeKind.ZodUnknown:return(0,Y.parseUnknownDef)();case n.ZodFirstPartyTypeKind.ZodDefault:return(0,u.parseDefaultDef)(x,q);case n.ZodFirstPartyTypeKind.ZodBranded:return(0,s.parseBrandedDef)(x,q);case n.ZodFirstPartyTypeKind.ZodCatch:return(0,o.parseCatchDef)(x,q);case n.ZodFirstPartyTypeKind.ZodPipeline:return(0,J.parsePipelineDef)(x,q);case n.ZodFirstPartyTypeKind.ZodFunction:case n.ZodFirstPartyTypeKind.ZodVoid:case n.ZodFirstPartyTypeKind.ZodSymbol:return;default:return(ie=>{})()}},he=(x,F,q)=>(x.description&&(q.description=x.description,F.markdownDescription&&(q.markdownDescription=x.description)),q);return ct}var ir={},Ea={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.getDefaultOptions=n.defaultOptions=void 0,n.defaultOptions={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"string",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,emailStrategy:"format:email"};const e=r=>typeof r=="string"?Object.assign(Object.assign({},n.defaultOptions),{name:r}):Object.assign(Object.assign({},n.defaultOptions),r);n.getDefaultOptions=e})(Ea);Object.defineProperty(ir,"__esModule",{value:!0});ir.getRefs=void 0;const Vo=Ea,Bo=n=>{const e=(0,Vo.getDefaultOptions)(n),r=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return Object.assign(Object.assign({},e),{currentPath:r,propertyPath:void 0,seen:new Map(Object.entries(e.definitions).map(([t,a])=>[a._def,{def:a._def,path:[...e.basePath,e.definitionPath,t],jsonSchema:void 0}]))})};ir.getRefs=Bo;Object.defineProperty(qt,"__esModule",{value:!0});qt.zodToJsonSchema=void 0;const Hn=xe(),$o=ir,Ko=(n,e)=>{var r;const t=(0,$o.getRefs)(e),a=typeof e=="object"&&e.definitions?Object.entries(e.definitions).reduce((u,[d,v])=>{var C;return Object.assign(Object.assign({},u),{[d]:(C=(0,Hn.parseDef)(v._def,Object.assign(Object.assign({},t),{currentPath:[...t.basePath,t.definitionPath,d]}),!0))!==null&&C!==void 0?C:{}})},{}):void 0,s=typeof e=="string"?e:e==null?void 0:e.name,o=(r=(0,Hn.parseDef)(n._def,s===void 0?t:Object.assign(Object.assign({},t),{currentPath:[...t.basePath,t.definitionPath,s]}),!1))!==null&&r!==void 0?r:{},l=s===void 0?a?Object.assign(Object.assign({},o),{[t.definitionPath]:a}):o:{$ref:[...t.$refStrategy==="relative"?[]:t.basePath,t.definitionPath,s].join("/"),[t.definitionPath]:Object.assign(Object.assign({},a),{[s]:o})};return t.target==="jsonSchema7"?l.$schema="http://json-schema.org/draft-07/schema#":t.target==="jsonSchema2019-09"&&(l.$schema="https://json-schema.org/draft/2019-09/schema#"),l};qt.zodToJsonSchema=Ko;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.zodToJsonSchema=void 0;const e=qt;Object.defineProperty(n,"zodToJsonSchema",{enumerable:!0,get:function(){return e.zodToJsonSchema}}),n.default=e.zodToJsonSchema})(wa);/*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT */function ka(n){return typeof n>"u"||n===null}function zo(n){return typeof n=="object"&&n!==null}function Fo(n){return Array.isArray(n)?n:ka(n)?[]:[n]}function qo(n,e){var r,t,a,s;if(e)for(s=Object.keys(e),r=0,t=s.length;r<t;r+=1)a=s[r],n[a]=e[a];return n}function Ho(n,e){var r="",t;for(t=0;t<e;t+=1)r+=n;return r}function Yo(n){return n===0&&Number.NEGATIVE_INFINITY===1/n}var Go=ka,Wo=zo,Jo=Fo,Qo=Ho,Xo=Yo,eu=qo,Fr={isNothing:Go,isObject:Wo,toArray:Jo,repeat:Qo,isNegativeZero:Xo,extend:eu};function Aa(n,e){var r="",t=n.reason||"(unknown reason)";return n.mark?(n.mark.name&&(r+='in "'+n.mark.name+'" '),r+="("+(n.mark.line+1)+":"+(n.mark.column+1)+")",!e&&n.mark.snippet&&(r+=`

`+n.mark.snippet),t+" "+r):t}function Ot(n,e){Error.call(this),this.name="YAMLException",this.reason=n,this.mark=e,this.message=Aa(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}Ot.prototype=Object.create(Error.prototype);Ot.prototype.constructor=Ot;Ot.prototype.toString=function(e){return this.name+": "+Aa(this,e)};var et=Ot,tu=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],ru=["scalar","sequence","mapping"];function nu(n){var e={};return n!==null&&Object.keys(n).forEach(function(r){n[r].forEach(function(t){e[String(t)]=r})}),e}function au(n,e){if(e=e||{},Object.keys(e).forEach(function(r){if(tu.indexOf(r)===-1)throw new et('Unknown option "'+r+'" is met in definition of "'+n+'" YAML type.')}),this.options=e,this.tag=n,this.kind=e.kind||null,this.resolve=e.resolve||function(){return!0},this.construct=e.construct||function(r){return r},this.instanceOf=e.instanceOf||null,this.predicate=e.predicate||null,this.represent=e.represent||null,this.representName=e.representName||null,this.defaultStyle=e.defaultStyle||null,this.multi=e.multi||!1,this.styleAliases=nu(e.styleAliases||null),ru.indexOf(this.kind)===-1)throw new et('Unknown kind "'+this.kind+'" is specified for "'+n+'" YAML type.')}var Se=au;function Yn(n,e){var r=[];return n[e].forEach(function(t){var a=r.length;r.forEach(function(s,o){s.tag===t.tag&&s.kind===t.kind&&s.multi===t.multi&&(a=o)}),r[a]=t}),r}function su(){var n={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},e,r;function t(a){a.multi?(n.multi[a.kind].push(a),n.multi.fallback.push(a)):n[a.kind][a.tag]=n.fallback[a.tag]=a}for(e=0,r=arguments.length;e<r;e+=1)arguments[e].forEach(t);return n}function Ir(n){return this.extend(n)}Ir.prototype.extend=function(e){var r=[],t=[];if(e instanceof Se)t.push(e);else if(Array.isArray(e))t=t.concat(e);else if(e&&(Array.isArray(e.implicit)||Array.isArray(e.explicit)))e.implicit&&(r=r.concat(e.implicit)),e.explicit&&(t=t.concat(e.explicit));else throw new et("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");r.forEach(function(s){if(!(s instanceof Se))throw new et("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(s.loadKind&&s.loadKind!=="scalar")throw new et("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(s.multi)throw new et("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),t.forEach(function(s){if(!(s instanceof Se))throw new et("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var a=Object.create(Ir.prototype);return a.implicit=(this.implicit||[]).concat(r),a.explicit=(this.explicit||[]).concat(t),a.compiledImplicit=Yn(a,"implicit"),a.compiledExplicit=Yn(a,"explicit"),a.compiledTypeMap=su(a.compiledImplicit,a.compiledExplicit),a};var iu=Ir,ou=new Se("tag:yaml.org,2002:str",{kind:"scalar",construct:function(n){return n!==null?n:""}}),uu=new Se("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(n){return n!==null?n:[]}}),lu=new Se("tag:yaml.org,2002:map",{kind:"mapping",construct:function(n){return n!==null?n:{}}}),cu=new iu({explicit:[ou,uu,lu]});function du(n){if(n===null)return!0;var e=n.length;return e===1&&n==="~"||e===4&&(n==="null"||n==="Null"||n==="NULL")}function hu(){return null}function fu(n){return n===null}var pu=new Se("tag:yaml.org,2002:null",{kind:"scalar",resolve:du,construct:hu,predicate:fu,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});function mu(n){if(n===null)return!1;var e=n.length;return e===4&&(n==="true"||n==="True"||n==="TRUE")||e===5&&(n==="false"||n==="False"||n==="FALSE")}function gu(n){return n==="true"||n==="True"||n==="TRUE"}function yu(n){return Object.prototype.toString.call(n)==="[object Boolean]"}var _u=new Se("tag:yaml.org,2002:bool",{kind:"scalar",resolve:mu,construct:gu,predicate:yu,represent:{lowercase:function(n){return n?"true":"false"},uppercase:function(n){return n?"TRUE":"FALSE"},camelcase:function(n){return n?"True":"False"}},defaultStyle:"lowercase"});function bu(n){return 48<=n&&n<=57||65<=n&&n<=70||97<=n&&n<=102}function vu(n){return 48<=n&&n<=55}function wu(n){return 48<=n&&n<=57}function Iu(n){if(n===null)return!1;var e=n.length,r=0,t=!1,a;if(!e)return!1;if(a=n[r],(a==="-"||a==="+")&&(a=n[++r]),a==="0"){if(r+1===e)return!0;if(a=n[++r],a==="b"){for(r++;r<e;r++)if(a=n[r],a!=="_"){if(a!=="0"&&a!=="1")return!1;t=!0}return t&&a!=="_"}if(a==="x"){for(r++;r<e;r++)if(a=n[r],a!=="_"){if(!bu(n.charCodeAt(r)))return!1;t=!0}return t&&a!=="_"}if(a==="o"){for(r++;r<e;r++)if(a=n[r],a!=="_"){if(!vu(n.charCodeAt(r)))return!1;t=!0}return t&&a!=="_"}}if(a==="_")return!1;for(;r<e;r++)if(a=n[r],a!=="_"){if(!wu(n.charCodeAt(r)))return!1;t=!0}return!(!t||a==="_")}function Pu(n){var e=n,r=1,t;if(e.indexOf("_")!==-1&&(e=e.replace(/_/g,"")),t=e[0],(t==="-"||t==="+")&&(t==="-"&&(r=-1),e=e.slice(1),t=e[0]),e==="0")return 0;if(t==="0"){if(e[1]==="b")return r*parseInt(e.slice(2),2);if(e[1]==="x")return r*parseInt(e.slice(2),16);if(e[1]==="o")return r*parseInt(e.slice(2),8)}return r*parseInt(e,10)}function Tu(n){return Object.prototype.toString.call(n)==="[object Number]"&&n%1===0&&!Fr.isNegativeZero(n)}var Ou=new Se("tag:yaml.org,2002:int",{kind:"scalar",resolve:Iu,construct:Pu,predicate:Tu,represent:{binary:function(n){return n>=0?"0b"+n.toString(2):"-0b"+n.toString(2).slice(1)},octal:function(n){return n>=0?"0o"+n.toString(8):"-0o"+n.toString(8).slice(1)},decimal:function(n){return n.toString(10)},hexadecimal:function(n){return n>=0?"0x"+n.toString(16).toUpperCase():"-0x"+n.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),Eu=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function ku(n){return!(n===null||!Eu.test(n)||n[n.length-1]==="_")}function Au(n){var e,r;return e=n.replace(/_/g,"").toLowerCase(),r=e[0]==="-"?-1:1,"+-".indexOf(e[0])>=0&&(e=e.slice(1)),e===".inf"?r===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:e===".nan"?NaN:r*parseFloat(e,10)}var Cu=/^[-+]?[0-9]+e/;function xu(n,e){var r;if(isNaN(n))switch(e){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===n)switch(e){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===n)switch(e){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(Fr.isNegativeZero(n))return"-0.0";return r=n.toString(10),Cu.test(r)?r.replace("e",".e"):r}function ju(n){return Object.prototype.toString.call(n)==="[object Number]"&&(n%1!==0||Fr.isNegativeZero(n))}var Su=new Se("tag:yaml.org,2002:float",{kind:"scalar",resolve:ku,construct:Au,predicate:ju,represent:xu,defaultStyle:"lowercase"}),Nu=cu.extend({implicit:[pu,_u,Ou,Su]}),Du=Nu,Ca=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),xa=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function Lu(n){return n===null?!1:Ca.exec(n)!==null||xa.exec(n)!==null}function Zu(n){var e,r,t,a,s,o,l,u=0,d=null,v,C,V;if(e=Ca.exec(n),e===null&&(e=xa.exec(n)),e===null)throw new Error("Date resolve error");if(r=+e[1],t=+e[2]-1,a=+e[3],!e[4])return new Date(Date.UTC(r,t,a));if(s=+e[4],o=+e[5],l=+e[6],e[7]){for(u=e[7].slice(0,3);u.length<3;)u+="0";u=+u}return e[9]&&(v=+e[10],C=+(e[11]||0),d=(v*60+C)*6e4,e[9]==="-"&&(d=-d)),V=new Date(Date.UTC(r,t,a,s,o,l,u)),d&&V.setTime(V.getTime()-d),V}function Mu(n){return n.toISOString()}var Ru=new Se("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:Lu,construct:Zu,instanceOf:Date,represent:Mu});function Uu(n){return n==="<<"||n===null}var Vu=new Se("tag:yaml.org,2002:merge",{kind:"scalar",resolve:Uu}),qr=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function Bu(n){if(n===null)return!1;var e,r,t=0,a=n.length,s=qr;for(r=0;r<a;r++)if(e=s.indexOf(n.charAt(r)),!(e>64)){if(e<0)return!1;t+=6}return t%8===0}function $u(n){var e,r,t=n.replace(/[\r\n=]/g,""),a=t.length,s=qr,o=0,l=[];for(e=0;e<a;e++)e%4===0&&e&&(l.push(o>>16&255),l.push(o>>8&255),l.push(o&255)),o=o<<6|s.indexOf(t.charAt(e));return r=a%4*6,r===0?(l.push(o>>16&255),l.push(o>>8&255),l.push(o&255)):r===18?(l.push(o>>10&255),l.push(o>>2&255)):r===12&&l.push(o>>4&255),new Uint8Array(l)}function Ku(n){var e="",r=0,t,a,s=n.length,o=qr;for(t=0;t<s;t++)t%3===0&&t&&(e+=o[r>>18&63],e+=o[r>>12&63],e+=o[r>>6&63],e+=o[r&63]),r=(r<<8)+n[t];return a=s%3,a===0?(e+=o[r>>18&63],e+=o[r>>12&63],e+=o[r>>6&63],e+=o[r&63]):a===2?(e+=o[r>>10&63],e+=o[r>>4&63],e+=o[r<<2&63],e+=o[64]):a===1&&(e+=o[r>>2&63],e+=o[r<<4&63],e+=o[64],e+=o[64]),e}function zu(n){return Object.prototype.toString.call(n)==="[object Uint8Array]"}var Fu=new Se("tag:yaml.org,2002:binary",{kind:"scalar",resolve:Bu,construct:$u,predicate:zu,represent:Ku}),qu=Object.prototype.hasOwnProperty,Hu=Object.prototype.toString;function Yu(n){if(n===null)return!0;var e=[],r,t,a,s,o,l=n;for(r=0,t=l.length;r<t;r+=1){if(a=l[r],o=!1,Hu.call(a)!=="[object Object]")return!1;for(s in a)if(qu.call(a,s))if(!o)o=!0;else return!1;if(!o)return!1;if(e.indexOf(s)===-1)e.push(s);else return!1}return!0}function Gu(n){return n!==null?n:[]}var Wu=new Se("tag:yaml.org,2002:omap",{kind:"sequence",resolve:Yu,construct:Gu}),Ju=Object.prototype.toString;function Qu(n){if(n===null)return!0;var e,r,t,a,s,o=n;for(s=new Array(o.length),e=0,r=o.length;e<r;e+=1){if(t=o[e],Ju.call(t)!=="[object Object]"||(a=Object.keys(t),a.length!==1))return!1;s[e]=[a[0],t[a[0]]]}return!0}function Xu(n){if(n===null)return[];var e,r,t,a,s,o=n;for(s=new Array(o.length),e=0,r=o.length;e<r;e+=1)t=o[e],a=Object.keys(t),s[e]=[a[0],t[a[0]]];return s}var el=new Se("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:Qu,construct:Xu}),tl=Object.prototype.hasOwnProperty;function rl(n){if(n===null)return!0;var e,r=n;for(e in r)if(tl.call(r,e)&&r[e]!==null)return!1;return!0}function nl(n){return n!==null?n:{}}var al=new Se("tag:yaml.org,2002:set",{kind:"mapping",resolve:rl,construct:nl});Du.extend({implicit:[Ru,Vu],explicit:[Fu,Wu,el,al]});function Gn(n){return n===48?"\0":n===97?"\x07":n===98?"\b":n===116||n===9?"	":n===110?`
`:n===118?"\v":n===102?"\f":n===114?"\r":n===101?"\x1B":n===32?" ":n===34?'"':n===47?"/":n===92?"\\":n===78?"":n===95?"":n===76?"\u2028":n===80?"\u2029":""}var sl=new Array(256),il=new Array(256);for(var nt=0;nt<256;nt++)sl[nt]=Gn(nt)?1:0,il[nt]=Gn(nt);class ol extends Mr{constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models",this._llmType()]})}async generate(e,r,t){var R;let a;Array.isArray(r)?a={stop:r}:r!=null&&r.timeout&&!r.signal?a={...r,signal:AbortSignal.timeout(r.timeout)}:a=r??{};const s={tags:a.tags,metadata:a.metadata,callbacks:a.callbacks??t};delete a.tags,delete a.metadata,delete a.callbacks;const o=await Ye.configure(s.callbacks,this.callbacks,s.tags,this.tags,s.metadata,this.metadata,{verbose:this.verbose}),l={options:a,invocation_params:this==null?void 0:this.invocationParams(a)},u=await(o==null?void 0:o.handleChatModelStart(this.toJSON(),e,void 0,void 0,l)),d=await Promise.allSettled(e.map((E,N)=>this._generate(E,{...a,promptIndex:N},u==null?void 0:u[N]))),v=[],C=[];await Promise.all(d.map(async(E,N)=>{var P,j;if(E.status==="fulfilled"){const D=E.value;return v[N]=D.generations,C[N]=D.llmOutput,(P=u==null?void 0:u[N])==null?void 0:P.handleLLMEnd({generations:[D.generations],llmOutput:D.llmOutput})}else return await((j=u==null?void 0:u[N])==null?void 0:j.handleLLMError(E.reason)),Promise.reject(E.reason)}));const V={generations:v,llmOutput:C.length?(R=this._combineLLMOutput)==null?void 0:R.call(this,...C):void 0};return Object.defineProperty(V,xr,{value:u?{runIds:u==null?void 0:u.map(E=>E.runId)}:void 0,configurable:!0}),V}invocationParams(e){return{}}_modelType(){return"base_chat_model"}async generatePrompt(e,r,t){const a=e.map(s=>s.toChatMessages());return this.generate(a,r,t)}async call(e,r,t){return(await this.generate([e],r,t)).generations[0][0].message}async callPrompt(e,r,t){const a=e.toChatMessages();return this.call(a,r,t)}async predictMessages(e,r,t){return this.call(e,r,t)}async predict(e,r,t){const a=new $t(e);return(await this.call([a],r,t)).content}}const ul=async(n,e,r,t,a,s,o,l,u)=>(await n.call(fetch,"https://api.promptlayer.com/track-request",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({function_name:e,provider:"langchain",args:r,kwargs:t,tags:a,request_response:s,request_start_time:Math.floor(o/1e3),request_end_time:Math.floor(l/1e3),api_key:u})})).json();function ll(n){return{name:n.name,description:n.description,parameters:wa.zodToJsonSchema(n.schema)}}function Pr(n){switch(n){case"system":return"system";case"ai":return"assistant";case"human":return"user";case"function":return"function";default:throw new Error(`Unknown message type: ${n}`)}}function cl(n){switch(n.role){case"user":return new $t(n.content||"");case"assistant":return new jr(n.content||"",{function_call:n.function_call});case"system":return new da(n.content||"");default:return new js(n.content||"",n.role??"unknown")}}class Hr extends ol{get callKeys(){return[...super.callKeys,"options","function_call","functions","tools","promptIndex"]}get lc_secrets(){return{openAIApiKey:"OPENAI_API_KEY",azureOpenAIApiKey:"AZURE_OPENAI_API_KEY"}}get lc_aliases(){return{modelName:"model",openAIApiKey:"openai_api_key",azureOpenAIApiVersion:"azure_openai_api_version",azureOpenAIApiKey:"azure_openai_api_key",azureOpenAIApiInstanceName:"azure_openai_api_instance_name",azureOpenAIApiDeploymentName:"azure_openai_api_deployment_name"}}constructor(e,r){if(super(e??{}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"presencePenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"n",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"logitBias",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"modelKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"openAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIBasePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.openAIApiKey=(e==null?void 0:e.openAIApiKey)??je("OPENAI_API_KEY"),this.azureOpenAIApiKey=(e==null?void 0:e.azureOpenAIApiKey)??je("AZURE_OPENAI_API_KEY"),!this.azureOpenAIApiKey&&!this.openAIApiKey)throw new Error("OpenAI or Azure OpenAI API key not found");if(this.azureOpenAIApiInstanceName=(e==null?void 0:e.azureOpenAIApiInstanceName)??je("AZURE_OPENAI_API_INSTANCE_NAME"),this.azureOpenAIApiDeploymentName=(e==null?void 0:e.azureOpenAIApiDeploymentName)??je("AZURE_OPENAI_API_DEPLOYMENT_NAME"),this.azureOpenAIApiVersion=(e==null?void 0:e.azureOpenAIApiVersion)??je("AZURE_OPENAI_API_VERSION"),this.azureOpenAIBasePath=(e==null?void 0:e.azureOpenAIBasePath)??je("AZURE_OPENAI_BASE_PATH"),this.modelName=(e==null?void 0:e.modelName)??this.modelName,this.modelKwargs=(e==null?void 0:e.modelKwargs)??{},this.timeout=e==null?void 0:e.timeout,this.temperature=(e==null?void 0:e.temperature)??this.temperature,this.topP=(e==null?void 0:e.topP)??this.topP,this.frequencyPenalty=(e==null?void 0:e.frequencyPenalty)??this.frequencyPenalty,this.presencePenalty=(e==null?void 0:e.presencePenalty)??this.presencePenalty,this.maxTokens=e==null?void 0:e.maxTokens,this.n=(e==null?void 0:e.n)??this.n,this.logitBias=e==null?void 0:e.logitBias,this.stop=e==null?void 0:e.stop,this.streaming=(e==null?void 0:e.streaming)??!1,this.azureOpenAIApiKey){if(!this.azureOpenAIApiInstanceName)throw new Error("Azure OpenAI API instance name not found");if(!this.azureOpenAIApiDeploymentName)throw new Error("Azure OpenAI API deployment name not found");if(!this.azureOpenAIApiVersion)throw new Error("Azure OpenAI API version not found")}this.clientConfig={apiKey:this.openAIApiKey,...r,...e==null?void 0:e.configuration}}invocationParams(e){return{model:this.modelName,temperature:this.temperature,top_p:this.topP,frequency_penalty:this.frequencyPenalty,presence_penalty:this.presencePenalty,max_tokens:this.maxTokens===-1?void 0:this.maxTokens,n:this.n,logit_bias:this.logitBias,stop:(e==null?void 0:e.stop)??this.stop,stream:this.streaming,functions:(e==null?void 0:e.functions)??(e!=null&&e.tools?e==null?void 0:e.tools.map(ll):void 0),function_call:e==null?void 0:e.function_call,...this.modelKwargs}}_identifyingParams(){return{model_name:this.modelName,...this.invocationParams(),...this.clientConfig}}identifyingParams(){return this._identifyingParams()}async _generate(e,r,t){var V;const a={},s=this.invocationParams(r),o=e.map(R=>({role:Pr(R._getType()),content:R.content,name:R.name,function_call:R.additional_kwargs.function_call})),l=s.stream?await new Promise((R,E)=>{let N,P=!1,j=!1;this.completionWithRetry({...s,messages:o},{signal:r==null?void 0:r.signal,...r==null?void 0:r.options,adapter:on,responseType:"stream",onmessage:D=>{var L,S,J,I,A,m,y,p,O,k;if(((S=(L=D.data)==null?void 0:L.trim)==null?void 0:S.call(L))==="[DONE]"){if(j||P)return;j=!0,R(N)}else{const Y=JSON.parse(D.data);if(Y!=null&&Y.error){if(P)return;P=!0,E(Y.error);return}const G=Y;N||(N={id:G.id,object:G.object,created:G.created,model:G.model,choices:[]});for(const H of G.choices??[])if(H!=null){let B=N.choices.find(Q=>Q.index===H.index);B||(B={index:H.index,finish_reason:H.finish_reason??void 0},N.choices[H.index]=B),B.message||(B.message={role:(J=H.delta)==null?void 0:J.role,content:""}),H.delta.function_call&&!B.message.function_call&&(B.message.function_call={name:"",arguments:""}),B.message.content+=((I=H.delta)==null?void 0:I.content)??"",B.message.function_call&&(B.message.function_call.name+=((m=(A=H.delta)==null?void 0:A.function_call)==null?void 0:m.name)??"",B.message.function_call.arguments+=((p=(y=H.delta)==null?void 0:y.function_call)==null?void 0:p.arguments)??""),t==null||t.handleLLMNewToken(((O=H.delta)==null?void 0:O.content)??"",{prompt:r.promptIndex??0,completion:H.index})}!j&&!P&&((k=G.choices)!=null&&k.every(H=>H.finish_reason!=null))&&(j=!0,R(N))}}}).catch(D=>{P||(P=!0,E(D))})}):await this.completionWithRetry({...s,messages:o},{signal:r==null?void 0:r.signal,...r==null?void 0:r.options}),{completion_tokens:u,prompt_tokens:d,total_tokens:v}=l.usage??{};u&&(a.completionTokens=(a.completionTokens??0)+u),d&&(a.promptTokens=(a.promptTokens??0)+d),v&&(a.totalTokens=(a.totalTokens??0)+v);const C=[];for(const R of l.choices){const E=((V=R.message)==null?void 0:V.content)??"";C.push({text:E,message:cl(R.message??{role:"assistant"})})}return{generations:C,llmOutput:{tokenUsage:a}}}async getNumTokensFromMessages(e){let r=0,t=0,a=0;Vt(this.modelName)==="gpt-3.5-turbo"?(t=4,a=-1):Vt(this.modelName).startsWith("gpt-4")&&(t=3,a=1);const s=await Promise.all(e.map(async o=>{const l=await this.getNumTokens(o.content),u=await this.getNumTokens(Pr(o._getType())),d=o.name!==void 0?a+await this.getNumTokens(o.name):0,v=l+t+u+d;return r+=v,v}));return r+=3,{totalCount:r,countPerMessage:s}}async completionWithRetry(e,r){if(!this.client){const a={azureOpenAIApiDeploymentName:this.azureOpenAIApiDeploymentName,azureOpenAIApiInstanceName:this.azureOpenAIApiInstanceName,azureOpenAIApiKey:this.azureOpenAIApiKey,azureOpenAIBasePath:this.azureOpenAIBasePath,basePath:this.clientConfig.basePath},s=Cs(a),o=new un.Configuration({...this.clientConfig,basePath:s,baseOptions:{timeout:this.timeout,...this.clientConfig.baseOptions}});this.client=new un.OpenAIApi(o)}const t={adapter:xs()?void 0:on,...this.clientConfig.baseOptions,...r};return this.azureOpenAIApiKey&&(t.headers={"api-key":this.azureOpenAIApiKey,...t.headers},t.params={"api-version":this.azureOpenAIApiVersion,...t.params}),this.caller.call(this.client.createChatCompletion.bind(this.client),e,t).then(a=>a.data)}_llmType(){return"openai"}_combineLLMOutput(...e){return e.reduce((r,t)=>(t&&t.tokenUsage&&(r.tokenUsage.completionTokens+=t.tokenUsage.completionTokens??0,r.tokenUsage.promptTokens+=t.tokenUsage.promptTokens??0,r.tokenUsage.totalTokens+=t.tokenUsage.totalTokens??0),r),{tokenUsage:{completionTokens:0,promptTokens:0,totalTokens:0}})}}class dl extends Hr{constructor(e){var r;super(e),Object.defineProperty(this,"promptLayerApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"plTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnPromptLayerId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.promptLayerApiKey=(e==null?void 0:e.promptLayerApiKey)??(typeof process<"u"?(r=process.env)==null?void 0:r.PROMPTLAYER_API_KEY:void 0),this.plTags=(e==null?void 0:e.plTags)??[],this.returnPromptLayerId=(e==null?void 0:e.returnPromptLayerId)??!1}async _generate(e,r,t){const a=Date.now();let s;Array.isArray(r)?s={stop:r}:r!=null&&r.timeout&&!r.signal?s={...r,signal:AbortSignal.timeout(r.timeout)}:s=r??{};const o=await super._generate(e,s,t),l=Date.now(),u=v=>{let C;if(v._getType()==="human")C={role:"user",content:v.content};else if(v._getType()==="ai")C={role:"assistant",content:v.content};else if(v._getType()==="function")C={role:"assistant",content:v.content};else if(v._getType()==="system")C={role:"system",content:v.content};else if(v._getType()==="generic")C={role:v.role,content:v.content};else throw new Error(`Got unknown type ${v}`);return C},d=(v,C)=>{const V={...this.invocationParams(),model:this.modelName};if(C!=null&&C.stop&&Object.keys(V).includes("stop"))throw new Error("`stop` found in both the input and default params.");return v.map(E=>u(E))};for(let v=0;v<o.generations.length;v+=1){const C=o.generations[v],V=d(e,s);let R;const E=[{content:C.text,role:Pr(C.message._getType())}],N=await ul(this.caller,"langchain.PromptLayerChatOpenAI",V,this._identifyingParams(),this.plTags,E,a,l,this.promptLayerApiKey);this.returnPromptLayerId===!0&&(N.success===!0&&(R=N.request_id),(!C.generationInfo||typeof C.generationInfo!="object")&&(C.generationInfo={}),C.generationInfo.promptLayerRequestId=R)}return o}}const hl=Object.freeze(Object.defineProperty({__proto__:null,ChatOpenAI:Hr,PromptLayerChatOpenAI:dl},Symbol.toStringTag,{value:"Module"}));var ja={exports:{}};(function(n,e){(function(r){n.exports=r()})(function(){return function r(t,a,s){function o(d,v){if(!a[d]){if(!t[d]){var C=typeof jt=="function"&&jt;if(!v&&C)return C(d,!0);if(l)return l(d,!0);throw new Error("Cannot find module '"+d+"'")}v=a[d]={exports:{}},t[d][0].call(v.exports,function(V){var R=t[d][1][V];return o(R||V)},v,v.exports,r,t,a,s)}return a[d].exports}for(var l=typeof jt=="function"&&jt,u=0;u<s.length;u++)o(s[u]);return o}({1:[function(r,t,a){(function(s,o,l,u,d,v,C,V,R){var E=r("crypto");function N(I,A){A=D(I,A);var m;return(m=A.algorithm!=="passthrough"?E.createHash(A.algorithm):new J).write===void 0&&(m.write=m.update,m.end=m.update),S(A,m).dispatch(I),m.update||m.end(""),m.digest?m.digest(A.encoding==="buffer"?void 0:A.encoding):(I=m.read(),A.encoding!=="buffer"?I.toString(A.encoding):I)}(a=t.exports=N).sha1=function(I){return N(I)},a.keys=function(I){return N(I,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})},a.MD5=function(I){return N(I,{algorithm:"md5",encoding:"hex"})},a.keysMD5=function(I){return N(I,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var P=E.getHashes?E.getHashes().slice():["sha1","md5"],j=(P.push("passthrough"),["buffer","hex","binary","base64"]);function D(I,A){var m={};if(m.algorithm=(A=A||{}).algorithm||"sha1",m.encoding=A.encoding||"hex",m.excludeValues=!!A.excludeValues,m.algorithm=m.algorithm.toLowerCase(),m.encoding=m.encoding.toLowerCase(),m.ignoreUnknown=A.ignoreUnknown===!0,m.respectType=A.respectType!==!1,m.respectFunctionNames=A.respectFunctionNames!==!1,m.respectFunctionProperties=A.respectFunctionProperties!==!1,m.unorderedArrays=A.unorderedArrays===!0,m.unorderedSets=A.unorderedSets!==!1,m.unorderedObjects=A.unorderedObjects!==!1,m.replacer=A.replacer||void 0,m.excludeKeys=A.excludeKeys||void 0,I===void 0)throw new Error("Object argument required.");for(var y=0;y<P.length;++y)P[y].toLowerCase()===m.algorithm.toLowerCase()&&(m.algorithm=P[y]);if(P.indexOf(m.algorithm)===-1)throw new Error('Algorithm "'+m.algorithm+'"  not supported. supported values: '+P.join(", "));if(j.indexOf(m.encoding)===-1&&m.algorithm!=="passthrough")throw new Error('Encoding "'+m.encoding+'"  not supported. supported values: '+j.join(", "));return m}function L(I){if(typeof I=="function")return/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(I))!=null}function S(I,A,m){m=m||[];function y(p){return A.update?A.update(p,"utf8"):A.write(p,"utf8")}return{dispatch:function(p){return this["_"+((p=I.replacer?I.replacer(p):p)===null?"null":typeof p)](p)},_object:function(p){var O,k=Object.prototype.toString.call(p),Y=/\[object (.*)\]/i.exec(k);if(Y=(Y=Y?Y[1]:"unknown:["+k+"]").toLowerCase(),0<=(k=m.indexOf(p)))return this.dispatch("[CIRCULAR:"+k+"]");if(m.push(p),l!==void 0&&l.isBuffer&&l.isBuffer(p))return y("buffer:"),y(p);if(Y==="object"||Y==="function"||Y==="asyncfunction")return k=Object.keys(p),I.unorderedObjects&&(k=k.sort()),I.respectType===!1||L(p)||k.splice(0,0,"prototype","__proto__","constructor"),I.excludeKeys&&(k=k.filter(function(G){return!I.excludeKeys(G)})),y("object:"+k.length+":"),O=this,k.forEach(function(G){O.dispatch(G),y(":"),I.excludeValues||O.dispatch(p[G]),y(",")});if(!this["_"+Y]){if(I.ignoreUnknown)return y("["+Y+"]");throw new Error('Unknown object type "'+Y+'"')}this["_"+Y](p)},_array:function(p,G){G=G!==void 0?G:I.unorderedArrays!==!1;var k=this;if(y("array:"+p.length+":"),!G||p.length<=1)return p.forEach(function(H){return k.dispatch(H)});var Y=[],G=p.map(function(H){var B=new J,Q=m.slice();return S(I,B,Q).dispatch(H),Y=Y.concat(Q.slice(m.length)),B.read().toString()});return m=m.concat(Y),G.sort(),this._array(G,!1)},_date:function(p){return y("date:"+p.toJSON())},_symbol:function(p){return y("symbol:"+p.toString())},_error:function(p){return y("error:"+p.toString())},_boolean:function(p){return y("bool:"+p.toString())},_string:function(p){y("string:"+p.length+":"),y(p.toString())},_function:function(p){y("fn:"),L(p)?this.dispatch("[native]"):this.dispatch(p.toString()),I.respectFunctionNames!==!1&&this.dispatch("function-name:"+String(p.name)),I.respectFunctionProperties&&this._object(p)},_number:function(p){return y("number:"+p.toString())},_xml:function(p){return y("xml:"+p.toString())},_null:function(){return y("Null")},_undefined:function(){return y("Undefined")},_regexp:function(p){return y("regex:"+p.toString())},_uint8array:function(p){return y("uint8array:"),this.dispatch(Array.prototype.slice.call(p))},_uint8clampedarray:function(p){return y("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(p))},_int8array:function(p){return y("int8array:"),this.dispatch(Array.prototype.slice.call(p))},_uint16array:function(p){return y("uint16array:"),this.dispatch(Array.prototype.slice.call(p))},_int16array:function(p){return y("int16array:"),this.dispatch(Array.prototype.slice.call(p))},_uint32array:function(p){return y("uint32array:"),this.dispatch(Array.prototype.slice.call(p))},_int32array:function(p){return y("int32array:"),this.dispatch(Array.prototype.slice.call(p))},_float32array:function(p){return y("float32array:"),this.dispatch(Array.prototype.slice.call(p))},_float64array:function(p){return y("float64array:"),this.dispatch(Array.prototype.slice.call(p))},_arraybuffer:function(p){return y("arraybuffer:"),this.dispatch(new Uint8Array(p))},_url:function(p){return y("url:"+p.toString())},_map:function(p){return y("map:"),p=Array.from(p),this._array(p,I.unorderedSets!==!1)},_set:function(p){return y("set:"),p=Array.from(p),this._array(p,I.unorderedSets!==!1)},_file:function(p){return y("file:"),this.dispatch([p.name,p.size,p.type,p.lastModfied])},_blob:function(){if(I.ignoreUnknown)return y("[blob]");throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){return y("domwindow")},_bigint:function(p){return y("bigint:"+p.toString())},_process:function(){return y("process")},_timer:function(){return y("timer")},_pipe:function(){return y("pipe")},_tcp:function(){return y("tcp")},_udp:function(){return y("udp")},_tty:function(){return y("tty")},_statwatcher:function(){return y("statwatcher")},_securecontext:function(){return y("securecontext")},_connection:function(){return y("connection")},_zlib:function(){return y("zlib")},_context:function(){return y("context")},_nodescript:function(){return y("nodescript")},_httpparser:function(){return y("httpparser")},_dataview:function(){return y("dataview")},_signal:function(){return y("signal")},_fsevent:function(){return y("fsevent")},_tlswrap:function(){return y("tlswrap")}}}function J(){return{buf:"",write:function(I){this.buf+=I},end:function(I){this.buf+=I},read:function(){return this.buf}}}a.writeToStream=function(I,A,m){return m===void 0&&(m=A,A={}),S(A=D(I,A),m).dispatch(I)}}).call(this,r("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/fake_9a5aa49d.js","/")},{buffer:3,crypto:5,lYpoI2:11}],2:[function(r,t,a){(function(s,o,l,u,d,v,C,V,R){(function(E){var N=typeof Uint8Array<"u"?Uint8Array:Array,P="+".charCodeAt(0),j="/".charCodeAt(0),D="0".charCodeAt(0),L="a".charCodeAt(0),S="A".charCodeAt(0),J="-".charCodeAt(0),I="_".charCodeAt(0);function A(m){return m=m.charCodeAt(0),m===P||m===J?62:m===j||m===I?63:m<D?-1:m<D+10?m-D+26+26:m<S+26?m-S:m<L+26?m-L+26:void 0}E.toByteArray=function(m){var y,p;if(0<m.length%4)throw new Error("Invalid string. Length must be a multiple of 4");var O=m.length,O=m.charAt(O-2)==="="?2:m.charAt(O-1)==="="?1:0,k=new N(3*m.length/4-O),Y=0<O?m.length-4:m.length,G=0;function H(B){k[G++]=B}for(y=0;y<Y;y+=4,0)H((16711680&(p=A(m.charAt(y))<<18|A(m.charAt(y+1))<<12|A(m.charAt(y+2))<<6|A(m.charAt(y+3))))>>16),H((65280&p)>>8),H(255&p);return O==2?H(255&(p=A(m.charAt(y))<<2|A(m.charAt(y+1))>>4)):O==1&&(H((p=A(m.charAt(y))<<10|A(m.charAt(y+1))<<4|A(m.charAt(y+2))>>2)>>8&255),H(255&p)),k},E.fromByteArray=function(m){var y,p,O,k,Y=m.length%3,G="";function H(B){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(B)}for(y=0,O=m.length-Y;y<O;y+=3)p=(m[y]<<16)+(m[y+1]<<8)+m[y+2],G+=H((k=p)>>18&63)+H(k>>12&63)+H(k>>6&63)+H(63&k);switch(Y){case 1:G=(G+=H((p=m[m.length-1])>>2))+H(p<<4&63)+"==";break;case 2:G=(G=(G+=H((p=(m[m.length-2]<<8)+m[m.length-1])>>10))+H(p>>4&63))+H(p<<2&63)+"="}return G}})(a===void 0?this.base64js={}:a)}).call(this,r("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js","/node_modules/gulp-browserify/node_modules/base64-js/lib")},{buffer:3,lYpoI2:11}],3:[function(r,t,a){(function(s,o,P,u,d,v,C,V,R){var E=r("base64-js"),N=r("ieee754");function P(h,g,T){if(!(this instanceof P))return new P(h,g,T);var K,U,W,se,me=typeof h;if(g==="base64"&&me=="string")for(h=(se=h).trim?se.trim():se.replace(/^\s+|\s+$/g,"");h.length%4!=0;)h+="=";if(me=="number")K=he(h);else if(me=="string")K=P.byteLength(h,g);else{if(me!="object")throw new Error("First argument needs to be a number, array or string.");K=he(h.length)}if(P._useTypedArrays?U=P._augment(new Uint8Array(K)):((U=this).length=K,U._isBuffer=!0),P._useTypedArrays&&typeof h.byteLength=="number")U._set(h);else if(x(se=h)||P.isBuffer(se)||se&&typeof se=="object"&&typeof se.length=="number")for(W=0;W<K;W++)P.isBuffer(h)?U[W]=h.readUInt8(W):U[W]=h[W];else if(me=="string")U.write(h,0,g);else if(me=="number"&&!P._useTypedArrays&&!T)for(W=0;W<K;W++)U[W]=0;return U}function j(h,g,T,K){return P._charsWritten=ye(function(U){for(var W=[],se=0;se<U.length;se++)W.push(255&U.charCodeAt(se));return W}(g),h,T,K)}function D(h,g,T,K){return P._charsWritten=ye(function(U){for(var W,se,me=[],ge=0;ge<U.length;ge++)se=U.charCodeAt(ge),W=se>>8,se=se%256,me.push(se),me.push(W);return me}(g),h,T,K)}function L(h,g,T){var K="";T=Math.min(h.length,T);for(var U=g;U<T;U++)K+=String.fromCharCode(h[U]);return K}function S(h,g,T,W){W||($(typeof T=="boolean","missing or invalid endian"),$(g!=null,"missing offset"),$(g+1<h.length,"Trying to read beyond buffer length"));var U,W=h.length;if(!(W<=g))return T?(U=h[g],g+1<W&&(U|=h[g+1]<<8)):(U=h[g]<<8,g+1<W&&(U|=h[g+1])),U}function J(h,g,T,W){W||($(typeof T=="boolean","missing or invalid endian"),$(g!=null,"missing offset"),$(g+3<h.length,"Trying to read beyond buffer length"));var U,W=h.length;if(!(W<=g))return T?(g+2<W&&(U=h[g+2]<<16),g+1<W&&(U|=h[g+1]<<8),U|=h[g],g+3<W&&(U+=h[g+3]<<24>>>0)):(g+1<W&&(U=h[g+1]<<16),g+2<W&&(U|=h[g+2]<<8),g+3<W&&(U|=h[g+3]),U+=h[g]<<24>>>0),U}function I(h,g,T,K){if(K||($(typeof T=="boolean","missing or invalid endian"),$(g!=null,"missing offset"),$(g+1<h.length,"Trying to read beyond buffer length")),!(h.length<=g))return K=S(h,g,T,!0),32768&K?-1*(65535-K+1):K}function A(h,g,T,K){if(K||($(typeof T=="boolean","missing or invalid endian"),$(g!=null,"missing offset"),$(g+3<h.length,"Trying to read beyond buffer length")),!(h.length<=g))return K=J(h,g,T,!0),2147483648&K?-1*(4294967295-K+1):K}function m(h,g,T,K){return K||($(typeof T=="boolean","missing or invalid endian"),$(g+3<h.length,"Trying to read beyond buffer length")),N.read(h,g,T,23,4)}function y(h,g,T,K){return K||($(typeof T=="boolean","missing or invalid endian"),$(g+7<h.length,"Trying to read beyond buffer length")),N.read(h,g,T,52,8)}function p(h,g,T,K,U){if(U||($(g!=null,"missing value"),$(typeof K=="boolean","missing or invalid endian"),$(T!=null,"missing offset"),$(T+1<h.length,"trying to write beyond buffer length"),re(g,65535)),U=h.length,!(U<=T))for(var W=0,se=Math.min(U-T,2);W<se;W++)h[T+W]=(g&255<<8*(K?W:1-W))>>>8*(K?W:1-W)}function O(h,g,T,K,U){if(U||($(g!=null,"missing value"),$(typeof K=="boolean","missing or invalid endian"),$(T!=null,"missing offset"),$(T+3<h.length,"trying to write beyond buffer length"),re(g,4294967295)),U=h.length,!(U<=T))for(var W=0,se=Math.min(U-T,4);W<se;W++)h[T+W]=g>>>8*(K?W:3-W)&255}function k(h,g,T,K,U){U||($(g!=null,"missing value"),$(typeof K=="boolean","missing or invalid endian"),$(T!=null,"missing offset"),$(T+1<h.length,"Trying to write beyond buffer length"),fe(g,32767,-32768)),h.length<=T||p(h,0<=g?g:65535+g+1,T,K,U)}function Y(h,g,T,K,U){U||($(g!=null,"missing value"),$(typeof K=="boolean","missing or invalid endian"),$(T!=null,"missing offset"),$(T+3<h.length,"Trying to write beyond buffer length"),fe(g,2147483647,-2147483648)),h.length<=T||O(h,0<=g?g:4294967295+g+1,T,K,U)}function G(h,g,T,K,U){U||($(g!=null,"missing value"),$(typeof K=="boolean","missing or invalid endian"),$(T!=null,"missing offset"),$(T+3<h.length,"Trying to write beyond buffer length"),be(g,34028234663852886e22,-34028234663852886e22)),h.length<=T||N.write(h,g,T,K,23,4)}function H(h,g,T,K,U){U||($(g!=null,"missing value"),$(typeof K=="boolean","missing or invalid endian"),$(T!=null,"missing offset"),$(T+7<h.length,"Trying to write beyond buffer length"),be(g,17976931348623157e292,-17976931348623157e292)),h.length<=T||N.write(h,g,T,K,52,8)}a.Buffer=P,a.SlowBuffer=P,a.INSPECT_MAX_BYTES=50,P.poolSize=8192,P._useTypedArrays=function(){try{var h=new ArrayBuffer(0),g=new Uint8Array(h);return g.foo=function(){return 42},g.foo()===42&&typeof g.subarray=="function"}catch{return!1}}(),P.isEncoding=function(h){switch(String(h).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},P.isBuffer=function(h){return!(h==null||!h._isBuffer)},P.byteLength=function(h,g){var T;switch(h+="",g||"utf8"){case"hex":T=h.length/2;break;case"utf8":case"utf-8":T=q(h).length;break;case"ascii":case"binary":case"raw":T=h.length;break;case"base64":T=ie(h).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":T=2*h.length;break;default:throw new Error("Unknown encoding")}return T},P.concat=function(h,g){if($(x(h),`Usage: Buffer.concat(list, [totalLength])
list should be an Array.`),h.length===0)return new P(0);if(h.length===1)return h[0];if(typeof g!="number")for(U=g=0;U<h.length;U++)g+=h[U].length;for(var T=new P(g),K=0,U=0;U<h.length;U++){var W=h[U];W.copy(T,K),K+=W.length}return T},P.prototype.write=function(h,g,T,K){isFinite(g)?isFinite(T)||(K=T,T=void 0):(ge=K,K=g,g=T,T=ge),g=Number(g)||0;var U,W,se,me,ge=this.length-g;switch((!T||ge<(T=Number(T)))&&(T=ge),K=String(K||"utf8").toLowerCase()){case"hex":U=function(Pe,Ie,Te,ve){Te=Number(Te)||0;var we=Pe.length-Te;(!ve||we<(ve=Number(ve)))&&(ve=we),$((we=Ie.length)%2==0,"Invalid hex string"),we/2<ve&&(ve=we/2);for(var Re=0;Re<ve;Re++){var xt=parseInt(Ie.substr(2*Re,2),16);$(!isNaN(xt),"Invalid hex string"),Pe[Te+Re]=xt}return P._charsWritten=2*Re,Re}(this,h,g,T);break;case"utf8":case"utf-8":W=this,se=g,me=T,U=P._charsWritten=ye(q(h),W,se,me);break;case"ascii":case"binary":U=j(this,h,g,T);break;case"base64":W=this,se=g,me=T,U=P._charsWritten=ye(ie(h),W,se,me);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":U=D(this,h,g,T);break;default:throw new Error("Unknown encoding")}return U},P.prototype.toString=function(h,g,T){var K,U,W,se,me=this;if(h=String(h||"utf8").toLowerCase(),g=Number(g)||0,(T=T!==void 0?Number(T):me.length)===g)return"";switch(h){case"hex":K=function(ge,Pe,Ie){var Te=ge.length;(!Pe||Pe<0)&&(Pe=0),(!Ie||Ie<0||Te<Ie)&&(Ie=Te);for(var ve="",we=Pe;we<Ie;we++)ve+=F(ge[we]);return ve}(me,g,T);break;case"utf8":case"utf-8":K=function(ge,Pe,Ie){var Te="",ve="";Ie=Math.min(ge.length,Ie);for(var we=Pe;we<Ie;we++)ge[we]<=127?(Te+=M(ve)+String.fromCharCode(ge[we]),ve=""):ve+="%"+ge[we].toString(16);return Te+M(ve)}(me,g,T);break;case"ascii":case"binary":K=L(me,g,T);break;case"base64":U=me,se=T,K=(W=g)===0&&se===U.length?E.fromByteArray(U):E.fromByteArray(U.slice(W,se));break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":K=function(ge,Pe,Ie){for(var Te=ge.slice(Pe,Ie),ve="",we=0;we<Te.length;we+=2)ve+=String.fromCharCode(Te[we]+256*Te[we+1]);return ve}(me,g,T);break;default:throw new Error("Unknown encoding")}return K},P.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},P.prototype.copy=function(h,g,T,K){if(g=g||0,(K=K||K===0?K:this.length)!==(T=T||0)&&h.length!==0&&this.length!==0){$(T<=K,"sourceEnd < sourceStart"),$(0<=g&&g<h.length,"targetStart out of bounds"),$(0<=T&&T<this.length,"sourceStart out of bounds"),$(0<=K&&K<=this.length,"sourceEnd out of bounds"),K>this.length&&(K=this.length);var U=(K=h.length-g<K-T?h.length-g+T:K)-T;if(U<100||!P._useTypedArrays)for(var W=0;W<U;W++)h[W+g]=this[W+T];else h._set(this.subarray(T,T+U),g)}},P.prototype.slice=function(h,g){var T=this.length;if(h=Q(h,T,0),g=Q(g,T,T),P._useTypedArrays)return P._augment(this.subarray(h,g));for(var K=g-h,U=new P(K,void 0,!0),W=0;W<K;W++)U[W]=this[W+h];return U},P.prototype.get=function(h){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(h)},P.prototype.set=function(h,g){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(h,g)},P.prototype.readUInt8=function(h,g){if(g||($(h!=null,"missing offset"),$(h<this.length,"Trying to read beyond buffer length")),!(h>=this.length))return this[h]},P.prototype.readUInt16LE=function(h,g){return S(this,h,!0,g)},P.prototype.readUInt16BE=function(h,g){return S(this,h,!1,g)},P.prototype.readUInt32LE=function(h,g){return J(this,h,!0,g)},P.prototype.readUInt32BE=function(h,g){return J(this,h,!1,g)},P.prototype.readInt8=function(h,g){if(g||($(h!=null,"missing offset"),$(h<this.length,"Trying to read beyond buffer length")),!(h>=this.length))return 128&this[h]?-1*(255-this[h]+1):this[h]},P.prototype.readInt16LE=function(h,g){return I(this,h,!0,g)},P.prototype.readInt16BE=function(h,g){return I(this,h,!1,g)},P.prototype.readInt32LE=function(h,g){return A(this,h,!0,g)},P.prototype.readInt32BE=function(h,g){return A(this,h,!1,g)},P.prototype.readFloatLE=function(h,g){return m(this,h,!0,g)},P.prototype.readFloatBE=function(h,g){return m(this,h,!1,g)},P.prototype.readDoubleLE=function(h,g){return y(this,h,!0,g)},P.prototype.readDoubleBE=function(h,g){return y(this,h,!1,g)},P.prototype.writeUInt8=function(h,g,T){T||($(h!=null,"missing value"),$(g!=null,"missing offset"),$(g<this.length,"trying to write beyond buffer length"),re(h,255)),g>=this.length||(this[g]=h)},P.prototype.writeUInt16LE=function(h,g,T){p(this,h,g,!0,T)},P.prototype.writeUInt16BE=function(h,g,T){p(this,h,g,!1,T)},P.prototype.writeUInt32LE=function(h,g,T){O(this,h,g,!0,T)},P.prototype.writeUInt32BE=function(h,g,T){O(this,h,g,!1,T)},P.prototype.writeInt8=function(h,g,T){T||($(h!=null,"missing value"),$(g!=null,"missing offset"),$(g<this.length,"Trying to write beyond buffer length"),fe(h,127,-128)),g>=this.length||(0<=h?this.writeUInt8(h,g,T):this.writeUInt8(255+h+1,g,T))},P.prototype.writeInt16LE=function(h,g,T){k(this,h,g,!0,T)},P.prototype.writeInt16BE=function(h,g,T){k(this,h,g,!1,T)},P.prototype.writeInt32LE=function(h,g,T){Y(this,h,g,!0,T)},P.prototype.writeInt32BE=function(h,g,T){Y(this,h,g,!1,T)},P.prototype.writeFloatLE=function(h,g,T){G(this,h,g,!0,T)},P.prototype.writeFloatBE=function(h,g,T){G(this,h,g,!1,T)},P.prototype.writeDoubleLE=function(h,g,T){H(this,h,g,!0,T)},P.prototype.writeDoubleBE=function(h,g,T){H(this,h,g,!1,T)},P.prototype.fill=function(h,g,T){if(g=g||0,T=T||this.length,$(typeof(h=typeof(h=h||0)=="string"?h.charCodeAt(0):h)=="number"&&!isNaN(h),"value is not a number"),$(g<=T,"end < start"),T!==g&&this.length!==0){$(0<=g&&g<this.length,"start out of bounds"),$(0<=T&&T<=this.length,"end out of bounds");for(var K=g;K<T;K++)this[K]=h}},P.prototype.inspect=function(){for(var h=[],g=this.length,T=0;T<g;T++)if(h[T]=F(this[T]),T===a.INSPECT_MAX_BYTES){h[T+1]="...";break}return"<Buffer "+h.join(" ")+">"},P.prototype.toArrayBuffer=function(){if(typeof Uint8Array>"u")throw new Error("Buffer.toArrayBuffer not supported in this browser");if(P._useTypedArrays)return new P(this).buffer;for(var h=new Uint8Array(this.length),g=0,T=h.length;g<T;g+=1)h[g]=this[g];return h.buffer};var B=P.prototype;function Q(h,g,T){return typeof h!="number"?T:g<=(h=~~h)?g:0<=h||0<=(h+=g)?h:0}function he(h){return(h=~~Math.ceil(+h))<0?0:h}function x(h){return(Array.isArray||function(g){return Object.prototype.toString.call(g)==="[object Array]"})(h)}function F(h){return h<16?"0"+h.toString(16):h.toString(16)}function q(h){for(var g=[],T=0;T<h.length;T++){var K=h.charCodeAt(T);if(K<=127)g.push(h.charCodeAt(T));else for(var U=T,W=(55296<=K&&K<=57343&&T++,encodeURIComponent(h.slice(U,T+1)).substr(1).split("%")),se=0;se<W.length;se++)g.push(parseInt(W[se],16))}return g}function ie(h){return E.toByteArray(h)}function ye(h,g,T,K){for(var U=0;U<K&&!(U+T>=g.length||U>=h.length);U++)g[U+T]=h[U];return U}function M(h){try{return decodeURIComponent(h)}catch{return String.fromCharCode(65533)}}function re(h,g){$(typeof h=="number","cannot write a non-number as a number"),$(0<=h,"specified a negative value for writing an unsigned value"),$(h<=g,"value is larger than maximum value for type"),$(Math.floor(h)===h,"value has a fractional component")}function fe(h,g,T){$(typeof h=="number","cannot write a non-number as a number"),$(h<=g,"value larger than maximum allowed value"),$(T<=h,"value smaller than minimum allowed value"),$(Math.floor(h)===h,"value has a fractional component")}function be(h,g,T){$(typeof h=="number","cannot write a non-number as a number"),$(h<=g,"value larger than maximum allowed value"),$(T<=h,"value smaller than minimum allowed value")}function $(h,g){if(!h)throw new Error(g||"Failed assertion")}P._augment=function(h){return h._isBuffer=!0,h._get=h.get,h._set=h.set,h.get=B.get,h.set=B.set,h.write=B.write,h.toString=B.toString,h.toLocaleString=B.toString,h.toJSON=B.toJSON,h.copy=B.copy,h.slice=B.slice,h.readUInt8=B.readUInt8,h.readUInt16LE=B.readUInt16LE,h.readUInt16BE=B.readUInt16BE,h.readUInt32LE=B.readUInt32LE,h.readUInt32BE=B.readUInt32BE,h.readInt8=B.readInt8,h.readInt16LE=B.readInt16LE,h.readInt16BE=B.readInt16BE,h.readInt32LE=B.readInt32LE,h.readInt32BE=B.readInt32BE,h.readFloatLE=B.readFloatLE,h.readFloatBE=B.readFloatBE,h.readDoubleLE=B.readDoubleLE,h.readDoubleBE=B.readDoubleBE,h.writeUInt8=B.writeUInt8,h.writeUInt16LE=B.writeUInt16LE,h.writeUInt16BE=B.writeUInt16BE,h.writeUInt32LE=B.writeUInt32LE,h.writeUInt32BE=B.writeUInt32BE,h.writeInt8=B.writeInt8,h.writeInt16LE=B.writeInt16LE,h.writeInt16BE=B.writeInt16BE,h.writeInt32LE=B.writeInt32LE,h.writeInt32BE=B.writeInt32BE,h.writeFloatLE=B.writeFloatLE,h.writeFloatBE=B.writeFloatBE,h.writeDoubleLE=B.writeDoubleLE,h.writeDoubleBE=B.writeDoubleBE,h.fill=B.fill,h.inspect=B.inspect,h.toArrayBuffer=B.toArrayBuffer,h}}).call(this,r("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/buffer/index.js","/node_modules/gulp-browserify/node_modules/buffer")},{"base64-js":2,buffer:3,ieee754:10,lYpoI2:11}],4:[function(r,t,a){(function(s,o,E,u,d,v,C,V,R){var E=r("buffer").Buffer,N=4,P=new E(N);P.fill(0),t.exports={hash:function(j,D,L,S){for(var J=D(function(p,O){p.length%N!=0&&(k=p.length+(N-p.length%N),p=E.concat([p,P],k));for(var k,Y=[],G=O?p.readInt32BE:p.readInt32LE,H=0;H<p.length;H+=N)Y.push(G.call(p,H));return Y}(j=E.isBuffer(j)?j:new E(j),S),8*j.length),D=S,I=new E(L),A=D?I.writeInt32BE:I.writeInt32LE,m=0;m<J.length;m++)A.call(I,J[m],4*m,!0);return I}}}).call(this,r("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/helpers.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],5:[function(r,t,a){(function(s,o,E,u,d,v,C,V,R){var E=r("buffer").Buffer,N=r("./sha"),P=r("./sha256"),j=r("./rng"),D={sha1:N,sha256:P,md5:r("./md5")},L=64,S=new E(L);function J(p,O){var k=D[p=p||"sha1"],Y=[];return k||I("algorithm:",p,"is not yet supported"),{update:function(G){return E.isBuffer(G)||(G=new E(G)),Y.push(G),G.length,this},digest:function(G){var H=E.concat(Y),H=O?function(B,Q,he){E.isBuffer(Q)||(Q=new E(Q)),E.isBuffer(he)||(he=new E(he)),Q.length>L?Q=B(Q):Q.length<L&&(Q=E.concat([Q,S],L));for(var x=new E(L),F=new E(L),q=0;q<L;q++)x[q]=54^Q[q],F[q]=92^Q[q];return he=B(E.concat([x,he])),B(E.concat([F,he]))}(k,O,H):k(H);return Y=null,G?H.toString(G):H}}}function I(){var p=[].slice.call(arguments).join(" ");throw new Error([p,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join(`
`))}S.fill(0),a.createHash=function(p){return J(p)},a.createHmac=J,a.randomBytes=function(p,O){if(!O||!O.call)return new E(j(p));try{O.call(this,void 0,new E(j(p)))}catch(k){O(k)}};var A,m=["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],y=function(p){a[p]=function(){I("sorry,",p,"is not implemented yet")}};for(A in m)y(m[A])}).call(this,r("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/index.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./md5":6,"./rng":7,"./sha":8,"./sha256":9,buffer:3,lYpoI2:11}],6:[function(r,t,a){(function(s,o,l,u,d,v,C,V,R){var E=r("./helpers");function N(I,A){I[A>>5]|=128<<A%32,I[14+(A+64>>>9<<4)]=A;for(var m=1732584193,y=-271733879,p=-1732584194,O=271733878,k=0;k<I.length;k+=16){var Y=m,G=y,H=p,B=O,m=j(m,y,p,O,I[k+0],7,-680876936),O=j(O,m,y,p,I[k+1],12,-389564586),p=j(p,O,m,y,I[k+2],17,606105819),y=j(y,p,O,m,I[k+3],22,-1044525330);m=j(m,y,p,O,I[k+4],7,-176418897),O=j(O,m,y,p,I[k+5],12,1200080426),p=j(p,O,m,y,I[k+6],17,-1473231341),y=j(y,p,O,m,I[k+7],22,-45705983),m=j(m,y,p,O,I[k+8],7,1770035416),O=j(O,m,y,p,I[k+9],12,-1958414417),p=j(p,O,m,y,I[k+10],17,-42063),y=j(y,p,O,m,I[k+11],22,-1990404162),m=j(m,y,p,O,I[k+12],7,1804603682),O=j(O,m,y,p,I[k+13],12,-40341101),p=j(p,O,m,y,I[k+14],17,-1502002290),m=D(m,y=j(y,p,O,m,I[k+15],22,1236535329),p,O,I[k+1],5,-165796510),O=D(O,m,y,p,I[k+6],9,-1069501632),p=D(p,O,m,y,I[k+11],14,643717713),y=D(y,p,O,m,I[k+0],20,-373897302),m=D(m,y,p,O,I[k+5],5,-701558691),O=D(O,m,y,p,I[k+10],9,38016083),p=D(p,O,m,y,I[k+15],14,-660478335),y=D(y,p,O,m,I[k+4],20,-405537848),m=D(m,y,p,O,I[k+9],5,568446438),O=D(O,m,y,p,I[k+14],9,-1019803690),p=D(p,O,m,y,I[k+3],14,-187363961),y=D(y,p,O,m,I[k+8],20,1163531501),m=D(m,y,p,O,I[k+13],5,-1444681467),O=D(O,m,y,p,I[k+2],9,-51403784),p=D(p,O,m,y,I[k+7],14,1735328473),m=L(m,y=D(y,p,O,m,I[k+12],20,-1926607734),p,O,I[k+5],4,-378558),O=L(O,m,y,p,I[k+8],11,-2022574463),p=L(p,O,m,y,I[k+11],16,1839030562),y=L(y,p,O,m,I[k+14],23,-35309556),m=L(m,y,p,O,I[k+1],4,-1530992060),O=L(O,m,y,p,I[k+4],11,1272893353),p=L(p,O,m,y,I[k+7],16,-155497632),y=L(y,p,O,m,I[k+10],23,-1094730640),m=L(m,y,p,O,I[k+13],4,681279174),O=L(O,m,y,p,I[k+0],11,-358537222),p=L(p,O,m,y,I[k+3],16,-722521979),y=L(y,p,O,m,I[k+6],23,76029189),m=L(m,y,p,O,I[k+9],4,-640364487),O=L(O,m,y,p,I[k+12],11,-421815835),p=L(p,O,m,y,I[k+15],16,530742520),m=S(m,y=L(y,p,O,m,I[k+2],23,-995338651),p,O,I[k+0],6,-198630844),O=S(O,m,y,p,I[k+7],10,1126891415),p=S(p,O,m,y,I[k+14],15,-1416354905),y=S(y,p,O,m,I[k+5],21,-57434055),m=S(m,y,p,O,I[k+12],6,1700485571),O=S(O,m,y,p,I[k+3],10,-1894986606),p=S(p,O,m,y,I[k+10],15,-1051523),y=S(y,p,O,m,I[k+1],21,-2054922799),m=S(m,y,p,O,I[k+8],6,1873313359),O=S(O,m,y,p,I[k+15],10,-30611744),p=S(p,O,m,y,I[k+6],15,-1560198380),y=S(y,p,O,m,I[k+13],21,1309151649),m=S(m,y,p,O,I[k+4],6,-145523070),O=S(O,m,y,p,I[k+11],10,-1120210379),p=S(p,O,m,y,I[k+2],15,718787259),y=S(y,p,O,m,I[k+9],21,-343485551),m=J(m,Y),y=J(y,G),p=J(p,H),O=J(O,B)}return Array(m,y,p,O)}function P(I,A,m,y,p,O){return J((A=J(J(A,I),J(y,O)))<<p|A>>>32-p,m)}function j(I,A,m,y,p,O,k){return P(A&m|~A&y,I,A,p,O,k)}function D(I,A,m,y,p,O,k){return P(A&y|m&~y,I,A,p,O,k)}function L(I,A,m,y,p,O,k){return P(A^m^y,I,A,p,O,k)}function S(I,A,m,y,p,O,k){return P(m^(A|~y),I,A,p,O,k)}function J(I,A){var m=(65535&I)+(65535&A);return(I>>16)+(A>>16)+(m>>16)<<16|65535&m}t.exports=function(I){return E.hash(I,N,16)}}).call(this,r("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/md5.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],7:[function(r,t,a){(function(s,o,l,u,d,v,C,V,R){t.exports=function(E){for(var N,P=new Array(E),j=0;j<E;j++)!(3&j)&&(N=4294967296*Math.random()),P[j]=N>>>((3&j)<<3)&255;return P}}).call(this,r("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/rng.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],8:[function(r,t,a){(function(s,o,l,u,d,v,C,V,R){var E=r("./helpers");function N(D,L){D[L>>5]|=128<<24-L%32,D[15+(L+64>>9<<4)]=L;for(var S,J,I,A=Array(80),m=1732584193,y=-271733879,p=-1732584194,O=271733878,k=-1009589776,Y=0;Y<D.length;Y+=16){for(var G=m,H=y,B=p,Q=O,he=k,x=0;x<80;x++){A[x]=x<16?D[Y+x]:j(A[x-3]^A[x-8]^A[x-14]^A[x-16],1);var F=P(P(j(m,5),(F=y,J=p,I=O,(S=x)<20?F&J|~F&I:!(S<40)&&S<60?F&J|F&I|J&I:F^J^I)),P(P(k,A[x]),(S=x)<20?1518500249:S<40?1859775393:S<60?-1894007588:-899497514)),k=O,O=p,p=j(y,30),y=m,m=F}m=P(m,G),y=P(y,H),p=P(p,B),O=P(O,Q),k=P(k,he)}return Array(m,y,p,O,k)}function P(D,L){var S=(65535&D)+(65535&L);return(D>>16)+(L>>16)+(S>>16)<<16|65535&S}function j(D,L){return D<<L|D>>>32-L}t.exports=function(D){return E.hash(D,N,20,!0)}}).call(this,r("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],9:[function(r,t,a){(function(s,o,l,u,d,v,C,V,R){function E(L,S){var J=(65535&L)+(65535&S);return(L>>16)+(S>>16)+(J>>16)<<16|65535&J}function N(L,S){var J,I=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),A=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),m=new Array(64);L[S>>5]|=128<<24-S%32,L[15+(S+64>>9<<4)]=S;for(var y,p,O=0;O<L.length;O+=16){for(var k=A[0],Y=A[1],G=A[2],H=A[3],B=A[4],Q=A[5],he=A[6],x=A[7],F=0;F<64;F++)m[F]=F<16?L[F+O]:E(E(E((p=m[F-2],j(p,17)^j(p,19)^D(p,10)),m[F-7]),(p=m[F-15],j(p,7)^j(p,18)^D(p,3))),m[F-16]),J=E(E(E(E(x,j(p=B,6)^j(p,11)^j(p,25)),B&Q^~B&he),I[F]),m[F]),y=E(j(y=k,2)^j(y,13)^j(y,22),k&Y^k&G^Y&G),x=he,he=Q,Q=B,B=E(H,J),H=G,G=Y,Y=k,k=E(J,y);A[0]=E(k,A[0]),A[1]=E(Y,A[1]),A[2]=E(G,A[2]),A[3]=E(H,A[3]),A[4]=E(B,A[4]),A[5]=E(Q,A[5]),A[6]=E(he,A[6]),A[7]=E(x,A[7])}return A}var P=r("./helpers"),j=function(L,S){return L>>>S|L<<32-S},D=function(L,S){return L>>>S};t.exports=function(L){return P.hash(L,N,32,!0)}}).call(this,r("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha256.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],10:[function(r,t,a){(function(s,o,l,u,d,v,C,V,R){a.read=function(E,N,P,j,O){var L,S,J=8*O-j-1,I=(1<<J)-1,A=I>>1,m=-7,y=P?O-1:0,p=P?-1:1,O=E[N+y];for(y+=p,L=O&(1<<-m)-1,O>>=-m,m+=J;0<m;L=256*L+E[N+y],y+=p,m-=8);for(S=L&(1<<-m)-1,L>>=-m,m+=j;0<m;S=256*S+E[N+y],y+=p,m-=8);if(L===0)L=1-A;else{if(L===I)return S?NaN:1/0*(O?-1:1);S+=Math.pow(2,j),L-=A}return(O?-1:1)*S*Math.pow(2,L-j)},a.write=function(E,N,P,j,D,k){var S,J,I=8*k-D-1,A=(1<<I)-1,m=A>>1,y=D===23?Math.pow(2,-24)-Math.pow(2,-77):0,p=j?0:k-1,O=j?1:-1,k=N<0||N===0&&1/N<0?1:0;for(N=Math.abs(N),isNaN(N)||N===1/0?(J=isNaN(N)?1:0,S=A):(S=Math.floor(Math.log(N)/Math.LN2),N*(j=Math.pow(2,-S))<1&&(S--,j*=2),2<=(N+=1<=S+m?y/j:y*Math.pow(2,1-m))*j&&(S++,j/=2),A<=S+m?(J=0,S=A):1<=S+m?(J=(N*j-1)*Math.pow(2,D),S+=m):(J=N*Math.pow(2,m-1)*Math.pow(2,D),S=0));8<=D;E[P+p]=255&J,p+=O,J/=256,D-=8);for(S=S<<D|J,I+=D;0<I;E[P+p]=255&S,p+=O,S/=256,I-=8);E[P+p-O]|=128*k}}).call(this,r("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/ieee754/index.js","/node_modules/gulp-browserify/node_modules/ieee754")},{buffer:3,lYpoI2:11}],11:[function(r,t,a){(function(s,o,l,u,d,v,C,V,R){var E,N,P;function j(){}(s=t.exports={}).nextTick=(N=typeof window<"u"&&window.setImmediate,P=typeof window<"u"&&window.postMessage&&window.addEventListener,N?function(D){return window.setImmediate(D)}:P?(E=[],window.addEventListener("message",function(D){var L=D.source;L!==window&&L!==null||D.data!=="process-tick"||(D.stopPropagation(),0<E.length&&E.shift()())},!0),function(D){E.push(D),window.postMessage("process-tick","*")}):function(D){setTimeout(D,0)}),s.title="browser",s.browser=!0,s.env={},s.argv=[],s.on=j,s.addListener=j,s.once=j,s.off=j,s.removeListener=j,s.removeAllListeners=j,s.emit=j,s.binding=function(D){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(D){throw new Error("process.chdir is not supported")}}).call(this,r("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/process/browser.js","/node_modules/gulp-browserify/node_modules/process")},{buffer:3,lYpoI2:11}]},{},[1])(1)})})(ja);var fl=ja.exports;const pl=pa(fl),Wn=(...n)=>pl(n.join("_")),ml=new Map;class Yr extends Ss{constructor(e){super(),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cache=e??new Map}lookup(e,r){return Promise.resolve(this.cache.get(Wn(e,r))??null)}async update(e,r,t){this.cache.set(Wn(e,r),t)}static global(){return new Yr(ml)}}class gl extends Mr{constructor({cache:e,concurrency:r,...t}){super(r?{maxConcurrency:r,...t}:t),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","llms",this._llmType()]}),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof e=="object"?this.cache=e:e?this.cache=Yr.global():this.cache=void 0}async generatePrompt(e,r,t){const a=e.map(s=>s.toString());return this.generate(a,r,t)}invocationParams(e){return{}}_flattenLLMResult(e){const r=[];for(let t=0;t<e.generations.length;t+=1){const a=e.generations[t];if(t===0)r.push({generations:[a],llmOutput:e.llmOutput});else{const s=e.llmOutput?{...e.llmOutput,tokenUsage:{}}:void 0;r.push({generations:[a],llmOutput:s})}}return r}async _generateUncached(e,r,t){const a=await Ye.configure(t.callbacks,this.callbacks,t.tags,this.tags,t.metadata,this.metadata,{verbose:this.verbose}),s={options:r,invocation_params:this==null?void 0:this.invocationParams(r)},o=await(a==null?void 0:a.handleLLMStart(this.toJSON(),e,void 0,void 0,s));let l;try{l=await this._generate(e,r,o==null?void 0:o[0])}catch(v){throw await Promise.all((o??[]).map(C=>C==null?void 0:C.handleLLMError(v))),v}const u=this._flattenLLMResult(l);await Promise.all((o??[]).map((v,C)=>v==null?void 0:v.handleLLMEnd(u[C])));const d=(o==null?void 0:o.map(v=>v.runId))||void 0;return Object.defineProperty(l,xr,{value:d?{runIds:d}:void 0,configurable:!0}),l}async generate(e,r,t){if(!Array.isArray(e))throw new Error("Argument 'prompts' is expected to be a string[]");let a;Array.isArray(r)?a={stop:r}:r!=null&&r.timeout&&!r.signal?a={...r,signal:AbortSignal.timeout(r.timeout)}:a=r??{};const s={tags:a.tags,metadata:a.metadata,callbacks:a.callbacks??t};if(delete a.tags,delete a.metadata,delete a.callbacks,!this.cache)return this._generateUncached(e,a,s);const{cache:o}=this,l=this.serialize();l.stop=a.stop??l.stop;const u=`${Object.entries(l).sort()}`,d=[],v=await Promise.all(e.map(async(V,R)=>{const E=await o.lookup(V,u);return E||d.push(R),E}));let C={};if(d.length>0){const V=await this._generateUncached(d.map(R=>e[R]),a,s);await Promise.all(V.generations.map(async(R,E)=>{const N=d[E];return v[N]=R,o.update(e[N],u,R)})),C=V.llmOutput??{}}return{generations:v,llmOutput:C}}async call(e,r,t){const{generations:a}=await this.generate([e],r??{},t);return a[0][0].text}async predict(e,r,t){return this.call(e,r,t)}async predictMessages(e,r,t){const a=Lr(e),s=await this.call(a,r,t);return new jr(s)}_identifyingParams(){return{}}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}_modelType(){return"base_llm"}static async deserialize(e){const{_type:r,_model:t,...a}=e;if(t&&t!=="base_llm")throw new Error(`Cannot load LLM with model ${t}`);const s={openai:(await Ne(()=>import("./openai.1031b7f9.js"),["./openai.1031b7f9.js","./NavBar.9cc01a6e.js","./public.41f5b175.js","./scheduler.2364b0ad.js","./index.be5c2245.js","../assets/NavBar.ffbd0f32.css"],import.meta.url)).OpenAI}[r];if(s===void 0)throw new Error(`Cannot load  LLM with type ${r}`);return new s(a)}}class yl extends gl{async _generate(e,r,t){return{generations:await Promise.all(e.map((s,o)=>this._call(s,{...r,promptIndex:o},t).then(l=>[{text:l}])))}}}class Gr extends yl{get lc_secrets(){return{apiKey:"HUGGINGFACEHUB_API_KEY"}}constructor(e){if(super(e??{}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"gpt2"}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topK",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.model=(e==null?void 0:e.model)??this.model,this.temperature=(e==null?void 0:e.temperature)??this.temperature,this.maxTokens=(e==null?void 0:e.maxTokens)??this.maxTokens,this.topP=(e==null?void 0:e.topP)??this.topP,this.topK=(e==null?void 0:e.topK)??this.topK,this.frequencyPenalty=(e==null?void 0:e.frequencyPenalty)??this.frequencyPenalty,this.apiKey=(e==null?void 0:e.apiKey)??je("HUGGINGFACEHUB_API_KEY"),!this.apiKey)throw new Error("Please set an API key for HuggingFace Hub in the environment variable HUGGINGFACEHUB_API_KEY or in the apiKey field of the HuggingFaceInference constructor.")}_llmType(){return"hf"}async _call(e,r){const{HfInference:t}=await Gr.imports(),a=new t(this.apiKey);return(await this.caller.callWithOptions({signal:r.signal},a.textGeneration.bind(a),{model:this.model,parameters:{return_full_text:!1,temperature:this.temperature,max_new_tokens:this.maxTokens,top_p:this.topP,top_k:this.topK,repetition_penalty:this.frequencyPenalty},inputs:e})).generated_text}static async imports(){try{const{HfInference:e}=await Ne(()=>import("./hf.d76b572f.js").then(r=>r.i),["./hf.d76b572f.js","./NavBar.9cc01a6e.js","./public.41f5b175.js","./scheduler.2364b0ad.js","./index.be5c2245.js","../assets/NavBar.ffbd0f32.css"],import.meta.url);return{HfInference:e}}catch{throw new Error("Please install huggingface as a dependency with, e.g. `yarn add @huggingface/inference`")}}}async function Jn(n,e,r,t,a){if(a==null||a==="")return"Please enter a question";{new Gr({apiKey:n,model:"tiiuae/falcon-7b-instruct",maxTokens:5e3}),Zt(Rt,Mt);const s=vr,o=new Hr({openAIApiKey:s,modelName:"gpt-3.5-turbo",temperature:0}),l="Answer this question, always give it a go do not say you don't know: {question}",u=Vr.fromLLM(o,e.asRetriever(),{returnSourceDocuments:!0,questionGeneratorChainOptions:{template:l}});let d={search_distance:.9};const v=await u.call({question:a,chat_history:[],vector_db_kwargs:d});return console.log("result",v),console.log(v.text),v.text}}const{console:_l}=Ns,de="src/routes/ask/+page.svelte";function Qn(n,e,r){const t=n.slice();return t[34]=e[r],t}function Xn(n,e,r){const t=n.slice();return t[37]=e[r],t}function Tr(n){let e,r,t,a,s,o="Select Model",l,u,d,v="tiiuae/falcon-7b-instruct",C,V="meta-llama/Llama-2-70b-chat-hf",R,E="OpenAssistant/oasst-sft-4-pythia-12b-epoch-3.5",N,P,j,D="Temperature",L,S,J,I,A,m,y,p="Chat History",O,k,Y,G,H,B,Q,he=Ut(n[8]),x=[];for(let q=0;q<he.length;q+=1)x[q]=Or(Xn(n,he,q));const F={c:function(){e=le("div"),r=le("div"),t=le("div"),a=le("div"),s=le("label"),s.textContent=o,l=Ee(),u=le("select"),d=le("option"),d.textContent=v,C=le("option"),C.textContent=V,R=le("option"),R.textContent=E,N=Ee(),P=le("div"),j=le("label"),j.textContent=D,L=Ee(),S=le("input"),J=Ee(),I=le("span"),A=st(n[1]),m=Ee(),y=le("h2"),y.textContent=p,O=Ee(),k=le("button"),Y=le("i"),G=st(" New Chat"),H=Ee();for(let ie=0;ie<x.length;ie+=1)x[ie].c();this.h()},l:function(ie){e=ce(ie,"DIV",{class:!0});var ye=_e(e);r=ce(ye,"DIV",{class:!0});var M=_e(r);t=ce(M,"DIV",{class:!0});var re=_e(t);a=ce(re,"DIV",{class:!0});var fe=_e(a);s=ce(fe,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Fe(s)!=="svelte-1n8492e"&&(s.textContent=o),l=ke(fe),u=ce(fe,"SELECT",{id:!0,style:!0,class:!0});var be=_e(u);d=ce(be,"OPTION",{"data-svelte-h":!0}),Fe(d)!=="svelte-15kfk1a"&&(d.textContent=v),C=ce(be,"OPTION",{"data-svelte-h":!0}),Fe(C)!=="svelte-14tx9eu"&&(C.textContent=V),R=ce(be,"OPTION",{"data-svelte-h":!0}),Fe(R)!=="svelte-ppycc4"&&(R.textContent=E),be.forEach(oe),fe.forEach(oe),N=ke(re),P=ce(re,"DIV",{class:!0});var $=_e(P);j=ce($,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),Fe(j)!=="svelte-1cqo6os"&&(j.textContent=D),L=ke($),S=ce($,"INPUT",{type:!0,id:!0,min:!0,max:!0,step:!0,class:!0}),J=ke($),I=ce($,"SPAN",{class:!0});var h=_e(I);A=it(h,n[1]),h.forEach(oe),$.forEach(oe),re.forEach(oe),m=ke(M),y=ce(M,"H2",{class:!0,"data-svelte-h":!0}),Fe(y)!=="svelte-141gz04"&&(y.textContent=p),O=ke(M),k=ce(M,"BUTTON",{class:!0});var g=_e(k);Y=ce(g,"I",{class:!0}),_e(Y).forEach(oe),G=it(g," New Chat"),g.forEach(oe),H=ke(M);for(let T=0;T<x.length;T+=1)x[T].l(M);M.forEach(oe),ye.forEach(oe),this.h()},h:function(){ae(s,"class","block text-lg font-semibold"),ae(s,"for","model"),ue(s,de,358,16,6197),d.__value="tiiuae/falcon-7b-instruct",Xe(d,d.__value),ue(d,de,367,18,6533),C.__value="meta-llama/Llama-2-70b-chat-hf",Xe(C,C.__value),ue(C,de,370,18,6668),R.__value="OpenAssistant/oasst-sft-4-pythia-12b-epoch-3.5",Xe(R,R.__value),ue(R,de,373,18,6813),ae(u,"id","model"),oa(u,"width","200px"),ae(u,"class","select select-sm select-primary"),n[0]===void 0&&ws(()=>n[16].call(u)),ue(u,de,361,16,6325),ae(a,"class","mb-4"),ue(a,de,357,14,6162),ae(j,"class","block text-lg font-semibold"),ae(j,"for","temperature"),ue(j,de,379,16,7068),ae(S,"type","range"),ae(S,"id","temperature"),ae(S,"min","0.1"),ae(S,"max","1.0"),ae(S,"step","0.2"),ae(S,"class","input input-sm input-primary"),ue(S,de,382,16,7201),ae(I,"class","text-sm ml-2"),ue(I,de,391,16,7492),ae(P,"class","mb-4"),ue(P,de,378,14,7033),ae(t,"class","w-full md:w-3/4 mt-14"),ue(t,de,356,12,6112),ae(y,"class","text-2xl font-bold mb-4"),ue(y,de,395,12,7593),ae(Y,"class","fas fa-plus"),ue(Y,de,401,14,7839),ae(k,"class","btn btn-primary btn-sm mb-2"),ue(k,de,397,12,7714),ae(r,"class","overflow-y-auto max-h-96"),ue(r,de,355,10,6061),ae(e,"class","absolute left-0 top-0 bg-gray-800 rounded-lg p-4 sidebar s-uhtJAkW7ZDek"),ue(e,de,354,8,5980)},m:function(ie,ye){Le(ie,e,ye),te(e,r),te(r,t),te(t,a),te(a,s),te(a,l),te(a,u),te(u,d),te(u,C),te(u,R),an(u,n[0],!0),te(t,N),te(t,P),te(P,j),te(P,L),te(P,S),Xe(S,n[1]),te(P,J),te(P,I),te(I,A),te(r,m),te(r,y),te(r,O),te(r,k),te(k,Y),te(k,G),te(r,H);for(let M=0;M<x.length;M+=1)x[M]&&x[M].m(r,null);B||(Q=[He(u,"change",n[16]),He(S,"change",n[17]),He(S,"input",n[17]),He(k,"click",n[11],!1,!1,!1,!1)],B=!0)},p:function(ie,ye){if(ye[0]&1&&an(u,ie[0]),ye[0]&2&&Xe(S,ie[1]),ye[0]&2&&Bt(A,ie[1]),ye[0]&24832){he=Ut(ie[8]);let M;for(M=0;M<he.length;M+=1){const re=Xn(ie,he,M);x[M]?x[M].p(re,ye):(x[M]=Or(re),x[M].c(),x[M].m(r,null))}for(;M<x.length;M+=1)x[M].d(1);x.length=he.length}},d:function(ie){ie&&oe(e),ua(x,ie),B=!1,Cr(Q)}};return Me("SvelteRegisterBlock",{block:F,id:Tr.name,type:"if",source:"(182:6) {#if isChatHistorySidebarOpen}",ctx:n}),F}function Sa(n){let e,r="New Chat";const t={c:function(){e=le("span"),e.textContent=r,this.h()},l:function(s){e=ce(s,"SPAN",{"data-svelte-h":!0}),Fe(e)!=="svelte-t9s83e"&&(e.textContent=r),this.h()},h:function(){ue(e,de,413,18,8382)},m:function(s,o){Le(s,e,o)},p:ea,d:function(s){s&&oe(e)}};return Me("SvelteRegisterBlock",{block:t,id:Sa.name,type:"else",source:"(241:16) {:else}",ctx:n}),t}function Na(n){let e,r=n[37].firstUserMessage+"",t;const a={c:function(){e=le("span"),t=st(r),this.h()},l:function(o){e=ce(o,"SPAN",{});var l=_e(e);t=it(l,r),l.forEach(oe),this.h()},h:function(){ue(e,de,411,18,8303)},m:function(o,l){Le(o,e,l),te(e,t)},p:function(o,l){l[0]&256&&r!==(r=o[37].firstUserMessage+"")&&Bt(t,r)},d:function(o){o&&oe(e)}};return Me("SvelteRegisterBlock",{block:a,id:Na.name,type:"if",source:'(239:16) {#if chat.firstUserMessage !== \\"\\" && chat.firstUserMessage !== null && chat.firstUserMessage !== undefined}',ctx:n}),a}function Or(n){let e,r,t,a,s,o,l;function u(E,N){return E[37].firstUserMessage!==""&&E[37].firstUserMessage!==null&&E[37].firstUserMessage!==void 0?Na:Sa}let d=u(n),v=d(n);function C(){return n[18](n[37])}function V(){return n[19](n[37])}const R={c:function(){e=le("div"),v.c(),r=Ee(),t=le("button"),a=le("i"),s=Ee(),this.h()},l:function(N){e=ce(N,"DIV",{class:!0});var P=_e(e);v.l(P),r=ke(P),t=ce(P,"BUTTON",{class:!0});var j=_e(t);a=ce(j,"I",{class:!0}),_e(a).forEach(oe),j.forEach(oe),s=ke(P),P.forEach(oe),this.h()},h:function(){ae(a,"class","fas fa-trash-alt"),ue(a,de,420,18,8650),ae(t,"class","btn btn-error btn-sm"),ue(t,de,416,16,8499),ae(e,"class","flex items-center justify-between mb-2 s-uhtJAkW7ZDek"),ue(e,de,406,14,8006)},m:function(N,P){Le(N,e,P),v.m(e,null),te(e,r),te(e,t),te(t,a),te(e,s),o||(l=[He(t,"click",C,!1,!1,!1,!1),He(e,"click",V,!1,!1,!1,!1)],o=!0)},p:function(N,P){n=N,d===(d=u(n))&&v?v.p(n,P):(v.d(1),v=d(n),v&&(v.c(),v.m(e,r)))},d:function(N){N&&oe(e),v.d(),o=!1,Cr(l)}};return Me("SvelteRegisterBlock",{block:R,id:Or.name,type:"each",source:"(234:12) {#each $userChats as chat}",ctx:n}),R}function Da(n){let e;const r={c:function(){e=le("i"),this.h()},l:function(a){e=ce(a,"I",{class:!0}),_e(e).forEach(oe),this.h()},h:function(){ae(e,"class","chevron fas fa-chevron-right text-2xl s-uhtJAkW7ZDek"),ue(e,de,436,10,9042)},m:function(a,s){Le(a,e,s)},d:function(a){a&&oe(e)}};return Me("SvelteRegisterBlock",{block:r,id:Da.name,type:"else",source:"(264:8) {:else}",ctx:n}),r}function La(n){let e;const r={c:function(){e=le("i"),this.h()},l:function(a){e=ce(a,"I",{class:!0}),_e(e).forEach(oe),this.h()},h:function(){ae(e,"class","chevron fas fa-chevron-left text-2xl s-uhtJAkW7ZDek"),ue(e,de,434,10,8965)},m:function(a,s){Le(a,e,s)},d:function(a){a&&oe(e)}};return Me("SvelteRegisterBlock",{block:r,id:La.name,type:"if",source:"(262:8) {#if isChatHistorySidebarOpen}",ctx:n}),r}function Za(n){let e,r=Ut(n[7]),t=[];for(let s=0;s<r.length;s+=1)t[s]=Er(Qn(n,r,s));const a={c:function(){e=le("div");for(let o=0;o<t.length;o+=1)t[o].c();this.h()},l:function(o){e=ce(o,"DIV",{class:!0});var l=_e(e);for(let u=0;u<t.length;u+=1)t[u].l(l);l.forEach(oe),this.h()},h:function(){ae(e,"class","chat-container overflow-y-auto h-96 s-uhtJAkW7ZDek"),ue(e,de,451,12,9560)},m:function(o,l){Le(o,e,l);for(let u=0;u<t.length;u+=1)t[u]&&t[u].m(e,null)},p:function(o,l){if(l[0]&128){r=Ut(o[7]);let u;for(u=0;u<r.length;u+=1){const d=Qn(o,r,u);t[u]?t[u].p(d,l):(t[u]=Er(d),t[u].c(),t[u].m(e,null))}for(;u<t.length;u+=1)t[u].d(1);t.length=r.length}},d:function(o){o&&oe(e),ua(t,o)}};return Me("SvelteRegisterBlock",{block:a,id:Za.name,type:"else",source:"(279:10) {:else}",ctx:n}),a}function Ma(n){let e,r="Select a chat from the history to view messages.";const t={c:function(){e=le("p"),e.textContent=r,this.h()},l:function(s){e=ce(s,"P",{class:!0,"data-svelte-h":!0}),Fe(e)!=="svelte-ulna32"&&(e.textContent=r),this.h()},h:function(){ae(e,"class","text-gray-500"),ue(e,de,447,12,9424)},m:function(s,o){Le(s,e,o)},p:ea,d:function(s){s&&oe(e)}};return Me("SvelteRegisterBlock",{block:t,id:Ma.name,type:"if",source:"(275:10) {#if selectedChatId === null}",ctx:n}),t}function Er(n){let e,r=n[34].message+"",t,a;const s={c:function(){e=le("div"),t=st(r),a=Ee(),this.h()},l:function(l){e=ce(l,"DIV",{class:!0});var u=_e(e);t=it(u,r),a=ke(u),u.forEach(oe),this.h()},h:function(){ae(e,"class","chat-message s-uhtJAkW7ZDek"),sn(e,"is-user-message",n[34].is_user_message),ue(e,de,453,16,9681)},m:function(l,u){Le(l,e,u),te(e,t),te(e,a)},p:function(l,u){u[0]&128&&r!==(r=l[34].message+"")&&Bt(t,r),u[0]&128&&sn(e,"is-user-message",l[34].is_user_message)},d:function(l){l&&oe(e)}};return Me("SvelteRegisterBlock",{block:s,id:Er.name,type:"each",source:"(281:14) {#each $selectedChatMessages as message}",ctx:n}),s}function kr(n){let e,r;const t={c:function(){e=le("div"),r=st(n[4]),this.h()},l:function(s){e=ce(s,"DIV",{class:!0});var o=_e(e);r=it(o,n[4]),o.forEach(oe),this.h()},h:function(){ae(e,"class","absolute top-4 left-4 right-4 bg-red-600 text-white p-2 rounded"),ue(e,de,487,6,10669)},m:function(s,o){Le(s,e,o),te(e,r)},p:function(s,o){o[0]&16&&Bt(r,s[4])},d:function(s){s&&oe(e)}};return Me("SvelteRegisterBlock",{block:t,id:kr.name,type:"if",source:"(315:4) {#if errorText !== null}",ctx:n}),t}function Ra(n){let e,r,t,a,s,o,l,u,d,v,C="Chat Messages",V,R,E,N,P,j,D,L,S,J,I,A,m,y;r=new fa({$$inline:!0});let p=n[6]&&Tr(n);function O(x,F){return x[6]?La:Da}let k=O(n),Y=k(n);function G(x,F){return x[5]===null?Ma:Za}let H=G(n),B=H(n),Q=n[4]!==null&&kr(n);const he={c:function(){e=le("div"),ta(r.$$.fragment),t=Ee(),a=le("div"),p&&p.c(),s=Ee(),o=le("div"),Y.c(),l=Ee(),u=le("div"),d=le("div"),v=le("h1"),v.textContent=C,V=Ee(),B.c(),R=Ee(),E=le("div"),N=le("div"),P=le("textarea"),D=Ee(),L=le("button"),S=st("Ask the AI and Send Message"),I=Ee(),Q&&Q.c(),this.h()},l:function(F){e=ce(F,"DIV",{class:!0});var q=_e(e);ra(r.$$.fragment,q),t=ke(q),a=ce(q,"DIV",{class:!0});var ie=_e(a);p&&p.l(ie),s=ke(ie),o=ce(ie,"DIV",{class:!0,style:!0});var ye=_e(o);Y.l(ye),ye.forEach(oe),l=ke(ie),u=ce(ie,"DIV",{class:!0});var M=_e(u);d=ce(M,"DIV",{class:!0});var re=_e(d);v=ce(re,"H1",{class:!0,"data-svelte-h":!0}),Fe(v)!=="svelte-fy4ok2"&&(v.textContent=C),V=ke(re),B.l(re),re.forEach(oe),R=ke(M),E=ce(M,"DIV",{class:!0});var fe=_e(E);N=ce(fe,"DIV",{class:!0});var be=_e(N);P=ce(be,"TEXTAREA",{id:!0,class:!0}),_e(P).forEach(oe),be.forEach(oe),D=ke(fe),L=ce(fe,"BUTTON",{class:!0});var $=_e(L);S=it($,"Ask the AI and Send Message"),$.forEach(oe),fe.forEach(oe),M.forEach(oe),ie.forEach(oe),I=ke(q),Q&&Q.l(q),q.forEach(oe),this.h()},h:function(){ae(o,"class","sidebar-toggle-btn s-uhtJAkW7ZDek"),oa(o,"left","1rem"),ue(o,de,428,6,8799),ae(v,"class","text-4xl font-bold mb-8"),ue(v,de,445,10,9317),ae(d,"class","w-full md:w-3/4"),ue(d,de,444,8,9277),ae(P,"id","question"),ae(P,"class","textarea textarea-primary"),P.disabled=j=n[5]===null||n[3],ue(P,de,467,12,10066),ae(N,"class","form-control mb-4"),ue(N,de,466,10,10022),ae(L,"class","btn btn-primary mb-4"),L.disabled=J=n[5]===null,ue(L,de,476,10,10367),ae(E,"class","w-full md:w-3/4 mt-4"),ue(E,de,465,8,9977),ae(u,"class","flex flex-col items-center justify-center w-full md:w-3/4 mx-auto s-uhtJAkW7ZDek"),ue(u,de,441,6,9174),ae(a,"class","relative flex flex-col md:flex-row min-h-screen s-uhtJAkW7ZDek"),ue(a,de,350,4,5807),ae(e,"class","flex flex-col bg-gray-900 text-white p-4 s-uhtJAkW7ZDek"),ue(e,de,348,2,5733)},m:function(F,q){Le(F,e,q),na(r,e,null),te(e,t),te(e,a),p&&p.m(a,null),te(a,s),te(a,o),Y.m(o,null),te(a,l),te(a,u),te(u,d),te(d,v),te(d,V),B.m(d,null),te(u,R),te(u,E),te(E,N),te(N,P),Xe(P,n[2]),te(E,D),te(E,L),te(L,S),te(e,I),Q&&Q.m(e,null),A=!0,m||(y=[He(o,"click",n[20],!1,!1,!1,!1),He(P,"input",n[21]),He(L,"click",n[22],!1,!1,!1,!1)],m=!0)},p:function(F,q){F[6]?p?p.p(F,q):(p=Tr(F),p.c(),p.m(a,s)):p&&(p.d(1),p=null),k!==(k=O(F))&&(Y.d(1),Y=k(F),Y&&(Y.c(),Y.m(o,null))),H===(H=G(F))&&B?B.p(F,q):(B.d(1),B=H(F),B&&(B.c(),B.m(d,null))),(!A||q[0]&40&&j!==(j=F[5]===null||F[3]))&&nn(P,"disabled",j),q[0]&4&&Xe(P,F[2]),(!A||q[0]&32&&J!==(J=F[5]===null))&&nn(L,"disabled",J),F[4]!==null?Q?Q.p(F,q):(Q=kr(F),Q.c(),Q.m(e,null)):Q&&(Q.d(1),Q=null)},i:function(F){A||(aa(r.$$.fragment,F),A=!0)},o:function(F){sa(r.$$.fragment,F),A=!1},d:function(F){F&&oe(e),ia(r),p&&p.d(),Y.d(),B.d(),Q&&Q.d(),m=!1,Cr(y)}};return Me("SvelteRegisterBlock",{block:he,id:Ra.name,type:"slot",source:"(176:0) <AuthCheck>",ctx:n}),he}function Ar(n){let e,r,t,a;t=new ha({props:{$$slots:{default:[Ra]},$$scope:{ctx:n}},$$inline:!0});const s={c:function(){e=le("link"),r=Ee(),ta(t.$$.fragment),this.h()},l:function(l){e=ce(l,"LINK",{rel:!0,href:!0}),r=ke(l),ra(t.$$.fragment,l),this.h()},h:function(){ae(e,"rel","stylesheet"),ae(e,"href","https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"),ue(e,de,343,0,5602)},m:function(l,u){Le(l,e,u),Le(l,r,u),na(t,l,u),a=!0},p:function(l,u){const d={};u[0]&511|u[1]&512&&(d.$$scope={dirty:u,ctx:l}),t.$set(d)},i:function(l){a||(aa(t.$$.fragment,l),a=!0)},o:function(l){sa(t.$$.fragment,l),a=!1},d:function(l){l&&(oe(e),oe(r)),ia(t,l)}};return Me("SvelteRegisterBlock",{block:s,id:Ar.name,type:"component",source:"",ctx:n}),s}function bl(n,e,r){let t,a,{$$slots:s={},$$scope:o}=e;Ts("Page",s,[]);const l=Zt(Rt,Mt);let u,d,v="tiiuae/falcon-7b-instruct",C=.2,V="",R=!1,E=null,N="";const P=ur([]);en(P,"userChats"),tn(n,P,M=>r(8,a=M));const j=ur([]);en(j,"selectedChatMessages"),tn(n,j,M=>r(7,t=M));let D=null;async function L(){if(R)return;if(await O(),D!==null){const{data:re,error:fe}=await l.from("chats").select("message").eq("chat_id",D);if(fe){r(4,E=fe.message),console.error("Error fetching chat messages:",fe.message);return}}const M=qe();P.update(re=>[...re,{chat_id:M}]),r(5,D=M),j.set([])}async function S(M){const{data:re,error:fe}=await l.from("chats").select("message").eq("chat_id",M).eq("is_user_message",!0).order("timestamp",{ascending:!0}).limit(1);return fe?(r(4,E=fe.message),""):re.length>0?re[0].message:""}async function J(){const M=await O(),{data:re,error:fe}=await l.from("chats").select("chat_id").eq("user_id",M);if(fe)console.error("Error fetching user chats:",fe.message),r(4,E=fe.message);else{const be=new Set,$=[];for(const h of re)if(!be.has(h.chat_id)){be.add(h.chat_id);const g=await S(h.chat_id);$.push({...h,firstUserMessage:g})}P.set($)}}async function I(M){r(5,D=M);const{data:re,error:fe}=await l.from("chats").select("message, is_user_message, timestamp").eq("chat_id",M).order("timestamp",{ascending:!0});fe?(console.error("Error fetching chat messages:",fe.message),r(4,E=fe.message)):j.set(re)}async function A(M){await l.from("chats").insert([{user_id:M,chat_id:D,message:V,is_user_message:!0,timestamp:new Date().toISOString()}]),t.length===0&&J(),I(D)}async function m(){if(R)return;r(3,R=!0);const M=await O();await A(M),await p(M),r(3,R=!1)}async function y(M,re){await l.from("chats").insert([{user_id:re,chat_id:D,message:M,is_user_message:!1,timestamp:new Date().toISOString()}]),I(D)}async function p(M){const re=Zt(Rt,Mt),fe=vr;d=new ln({openAIApiKey:fe}),u=new cn(d,{client:re,tableName:"documents"});let be=await Jn(dn,u,v,C,V);await y(be,M),r(2,V="")}async function O(){const M=await l.auth.getUser();return M?M.data.user.id:null}function k(M){I(M)}async function Y(M){if(R)return;const re=D===M,{data:fe,error:be}=await l.from("chats").delete().eq("chat_id",M);if(be)console.error("Error deleting chat:",be.message),r(4,E=be.message);else{const $=await O(),{data:h}=await l.from("chats").select("chat_id").eq("user_id",$).order("timestamp",{ascending:!1}).limit(1),g=h.length>0?h[0].chat_id:null;await J(),re&&r(5,D=g)}}rn(async()=>{await J(),await L()});let G=!1;function H(){r(6,G=!G)}const B=[];Object.keys(e).forEach(M=>{!~B.indexOf(M)&&M.slice(0,2)!=="$$"&&M!=="slot"&&_l.warn(`<Page> was created with unknown prop '${M}'`)});function Q(){v=Os(this),r(0,v)}function he(){C=Es(this.value),r(1,C)}const x=M=>Y(M.chat_id),F=M=>k(M.chat_id.slice(0,36)),q=()=>H();function ie(){V=this.value,r(2,V)}const ye=()=>m();return n.$capture_state=()=>({chatWithDoc:Jn,AuthCheck:ha,NavBar:fa,onMount:rn,onDestroy:vs,GoTrueAdminApi:Ds,createClient:Zt,OpenAIEmbeddings:ln,SupabaseVectorStore:cn,writable:ur,HuggingFaceInferenceEmbeddings:Ms,PUBLIC_SUPABASE_KEY:Mt,PUBLIC_SUPABASE_URL:Rt,PUBLIC_HUGGINGFACE_API_KEY:dn,PUBLIC_OPENAI_API_KEY:vr,uuidv4:qe,supabaseClient:l,vector:u,embeddings:d,model:v,temperature:C,question:V,loading:R,errorText:E,responseText:N,userChats:P,selectedChatMessages:j,selectedChatId:D,createNewChat:L,getFirstUserMessage:S,loadUserChats:J,loadChatMessages:I,sendMessage:A,sendUserMessageAndAIResponse:m,saveAIResponse:y,getAIResponse:p,getCurrentUserId:O,selectChat:k,deleteChat:Y,isChatHistorySidebarOpen:G,toggleSidebar:H,$selectedChatMessages:t,$userChats:a}),n.$inject_state=M=>{"vector"in M&&(u=M.vector),"embeddings"in M&&(d=M.embeddings),"model"in M&&r(0,v=M.model),"temperature"in M&&r(1,C=M.temperature),"question"in M&&r(2,V=M.question),"loading"in M&&r(3,R=M.loading),"errorText"in M&&r(4,E=M.errorText),"responseText"in M&&(N=M.responseText),"selectedChatId"in M&&r(5,D=M.selectedChatId),"isChatHistorySidebarOpen"in M&&r(6,G=M.isChatHistorySidebarOpen)},e&&"$$inject"in e&&n.$inject_state(e.$$inject),[v,C,V,R,E,D,G,t,a,P,j,L,m,k,Y,H,Q,he,x,F,q,ie,ye]}class Cl extends Is{constructor(e){super(e),Ps(this,e,bl,Ar,bs,{},null,[-1,-1]),Me("SvelteRegisterComponent",{component:this,tagName:"Page",options:e,id:Ar.name})}}export{kt as B,Ze as L,Ce as P,yl as a,gl as b,kl as c,fi as d,wi as e,Cl as f,no as l,ul as p,va as r};
