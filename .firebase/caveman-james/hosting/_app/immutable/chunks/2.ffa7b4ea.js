var Zl=Object.defineProperty;var Jl=(n,e,t)=>e in n?Zl(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var ht=(n,e,t)=>(Jl(n,typeof e!="symbol"?e+"":e,t),t);import{s as Gl,v as wn,h as On,o as Ca,d as W,n as Ia,r as Mi,i as Yl}from"./scheduler.744affc9.js";import{S as Wl,i as Ql,d as dn,A as Xl,v as ed,j as Q,s as pe,k as X,l as Ae,B as Pe,c as me,g as le,m as re,C as Be,a as yt,z,D as Ue,E as Rs,F as td,o as qn,p as zn,q as Hn,G as Ra}from"./index.f15cdbf8.js";import{_ as Te}from"./preload-helper.cf010ec4.js";import{w as Sr}from"./index.43531919.js";function rd(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in n)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(n,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}class Gr{constructor(e){Object.defineProperty(this,"pageContent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.pageContent=e.pageContent?e.pageContent.toString():this.pageContent,this.metadata=e.metadata??{}}}var nd=Object.defineProperty,sd=(n,e,t)=>e in n?nd(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,id=(n,e,t)=>(sd(n,typeof e!="symbol"?e+"":e,t),t),ut=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function hn(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function ad(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function r(){if(this instanceof r){var s=[null];s.push.apply(s,arguments);var i=Function.bind.apply(e,s);return new i}return e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var s=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:function(){return n[r]}})}),t}var Qn={};Qn.byteLength=cd;Qn.toByteArray=dd;Qn.fromByteArray=pd;var ft=[],Xe=[],od=typeof Uint8Array<"u"?Uint8Array:Array,Ds="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var tr=0,ud=Ds.length;tr<ud;++tr)ft[tr]=Ds[tr],Xe[Ds.charCodeAt(tr)]=tr;Xe["-".charCodeAt(0)]=62;Xe["_".charCodeAt(0)]=63;function vu(n){var e=n.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=n.indexOf("=");t===-1&&(t=e);var r=t===e?0:4-t%4;return[t,r]}function cd(n){var e=vu(n),t=e[0],r=e[1];return(t+r)*3/4-r}function ld(n,e,t){return(e+t)*3/4-t}function dd(n){var e,t=vu(n),r=t[0],s=t[1],i=new od(ld(n,r,s)),a=0,o=s>0?r-4:r,u;for(u=0;u<o;u+=4)e=Xe[n.charCodeAt(u)]<<18|Xe[n.charCodeAt(u+1)]<<12|Xe[n.charCodeAt(u+2)]<<6|Xe[n.charCodeAt(u+3)],i[a++]=e>>16&255,i[a++]=e>>8&255,i[a++]=e&255;return s===2&&(e=Xe[n.charCodeAt(u)]<<2|Xe[n.charCodeAt(u+1)]>>4,i[a++]=e&255),s===1&&(e=Xe[n.charCodeAt(u)]<<10|Xe[n.charCodeAt(u+1)]<<4|Xe[n.charCodeAt(u+2)]>>2,i[a++]=e>>8&255,i[a++]=e&255),i}function hd(n){return ft[n>>18&63]+ft[n>>12&63]+ft[n>>6&63]+ft[n&63]}function fd(n,e,t){for(var r,s=[],i=e;i<t;i+=3)r=(n[i]<<16&16711680)+(n[i+1]<<8&65280)+(n[i+2]&255),s.push(hd(r));return s.join("")}function pd(n){for(var e,t=n.length,r=t%3,s=[],i=16383,a=0,o=t-r;a<o;a+=i)s.push(fd(n,a,a+i>o?o:a+i));return r===1?(e=n[t-1],s.push(ft[e>>2]+ft[e<<4&63]+"==")):r===2&&(e=(n[t-2]<<8)+n[t-1],s.push(ft[e>>10]+ft[e>>4&63]+ft[e<<2&63]+"=")),s.join("")}function md(n,e){let t=Array.from({length:n.length},(r,s)=>({start:s,end:s+1}));for(;t.length>1;){let r=null;for(let s=0;s<t.length-1;s++){const i=n.slice(t[s].start,t[s+1].end),a=e.get(i.join(","));a!=null&&(r==null||a<r[0])&&(r=[a,s])}if(r!=null){const s=r[1];t[s]={start:t[s].start,end:t[s+1].end},t.splice(s+1,1)}else break}return t}function yd(n,e){return n.length===1?[e.get(n.join(","))]:md(n,e).map(t=>e.get(n.slice(t.start,t.end).join(","))).filter(t=>t!=null)}function gd(n){return n.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")}var _i=class{constructor(n,e){ht(this,"specialTokens");ht(this,"inverseSpecialTokens");ht(this,"patStr");ht(this,"textEncoder",new TextEncoder);ht(this,"textDecoder",new TextDecoder("utf-8"));ht(this,"rankMap",new Map);ht(this,"textMap",new Map);this.patStr=n.pat_str;const t=n.bpe_ranks.split(`
`).filter(Boolean).reduce((r,s)=>{const[i,a,...o]=s.split(" "),u=Number.parseInt(a,10);return o.forEach((c,l)=>r[c]=u+l),r},{});for(const[r,s]of Object.entries(t)){const i=Qn.toByteArray(r);this.rankMap.set(i.join(","),s),this.textMap.set(s,i)}this.specialTokens={...n.special_tokens,...e},this.inverseSpecialTokens=Object.entries(this.specialTokens).reduce((r,[s,i])=>(r[i]=this.textEncoder.encode(s),r),{})}encode(n,e=[],t="all"){const r=new RegExp(this.patStr,"ug"),s=_i.specialTokenRegex(Object.keys(this.specialTokens)),i=[],a=new Set(e==="all"?Object.keys(this.specialTokens):e),o=new Set(t==="all"?Object.keys(this.specialTokens).filter(c=>!a.has(c)):t);if(o.size>0){const c=_i.specialTokenRegex([...o]),l=n.match(c);if(l!=null)throw new Error(`The text contains a special token that is not allowed: ${l[0]}`)}let u=0;for(;;){let c=null,l=u;for(;s.lastIndex=l,c=s.exec(n),!(c==null||a.has(c[0]));)l=c.index+1;const d=(c==null?void 0:c.index)??n.length;for(const g of n.substring(u,d).matchAll(r)){const f=this.textEncoder.encode(g[0]),b=this.rankMap.get(f.join(","));if(b!=null){i.push(b);continue}i.push(...yd(f,this.rankMap))}if(c==null)break;let h=this.specialTokens[c[0]];i.push(h),u=c.index+c[0].length}return i}decode(n){const e=[];let t=0;for(let i=0;i<n.length;++i){const a=n[i],o=this.textMap.get(a)??this.inverseSpecialTokens[a];o!=null&&(e.push(o),t+=o.length)}const r=new Uint8Array(t);let s=0;for(const i of e)r.set(i,s),s+=i.length;return this.textDecoder.decode(r)}},wu=_i;id(wu,"specialTokenRegex",n=>new RegExp(n.map(e=>gd(e)).join("|"),"g"));function bd(n){switch(n){case"gpt2":return"gpt2";case"code-cushman-001":case"code-cushman-002":case"code-davinci-001":case"code-davinci-002":case"cushman-codex":case"davinci-codex":case"text-davinci-002":case"text-davinci-003":return"p50k_base";case"code-davinci-edit-001":case"text-davinci-edit-001":return"p50k_edit";case"ada":case"babbage":case"code-search-ada-code-001":case"code-search-babbage-code-001":case"curie":case"davinci":case"text-ada-001":case"text-babbage-001":case"text-curie-001":case"text-davinci-001":case"text-search-ada-doc-001":case"text-search-babbage-doc-001":case"text-search-curie-doc-001":case"text-search-davinci-doc-001":case"text-similarity-ada-001":case"text-similarity-babbage-001":case"text-similarity-curie-001":case"text-similarity-davinci-001":return"r50k_base";case"gpt-3.5-turbo-16k-0613":case"gpt-3.5-turbo-16k":case"gpt-3.5-turbo-0613":case"gpt-3.5-turbo-0301":case"gpt-3.5-turbo":case"gpt-4-32k-0613":case"gpt-4-32k-0314":case"gpt-4-32k":case"gpt-4-0613":case"gpt-4-0314":case"gpt-4":case"text-embedding-ada-002":return"cl100k_base";default:throw new Error("Unknown model")}}var Xn={exports:{}},Ou={};function st(n,e){typeof e=="boolean"&&(e={forever:e}),this._originalTimeouts=JSON.parse(JSON.stringify(n)),this._timeouts=n,this._options=e||{},this._maxRetryTime=e&&e.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}var _d=st;st.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)};st.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null};st.prototype.retry=function(n){if(this._timeout&&clearTimeout(this._timeout),!n)return!1;var e=new Date().getTime();if(n&&e-this._operationStart>=this._maxRetryTime)return this._errors.push(n),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(n);var t=this._timeouts.shift();if(t===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),t=this._cachedTimeouts.slice(-1);else return!1;var r=this;return this._timer=setTimeout(function(){r._attempts++,r._operationTimeoutCb&&(r._timeout=setTimeout(function(){r._operationTimeoutCb(r._attempts)},r._operationTimeout),r._options.unref&&r._timeout.unref()),r._fn(r._attempts)},t),this._options.unref&&this._timer.unref(),!0};st.prototype.attempt=function(n,e){this._fn=n,e&&(e.timeout&&(this._operationTimeout=e.timeout),e.cb&&(this._operationTimeoutCb=e.cb));var t=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){t._operationTimeoutCb()},t._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};st.prototype.try=function(n){console.log("Using RetryOperation.try() is deprecated"),this.attempt(n)};st.prototype.start=function(n){console.log("Using RetryOperation.start() is deprecated"),this.attempt(n)};st.prototype.start=st.prototype.try;st.prototype.errors=function(){return this._errors};st.prototype.attempts=function(){return this._attempts};st.prototype.mainError=function(){if(this._errors.length===0)return null;for(var n={},e=null,t=0,r=0;r<this._errors.length;r++){var s=this._errors[r],i=s.message,a=(n[i]||0)+1;n[i]=a,a>=t&&(e=s,t=a)}return e};(function(n){var e=_d;n.operation=function(t){var r=n.timeouts(t);return new e(r,{forever:t&&(t.forever||t.retries===1/0),unref:t&&t.unref,maxRetryTime:t&&t.maxRetryTime})},n.timeouts=function(t){if(t instanceof Array)return[].concat(t);var r={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var s in t)r[s]=t[s];if(r.minTimeout>r.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var i=[],a=0;a<r.retries;a++)i.push(this.createTimeout(a,r));return t&&t.forever&&!i.length&&i.push(this.createTimeout(a,r)),i.sort(function(o,u){return o-u}),i},n.createTimeout=function(t,r){var s=r.randomize?Math.random()+1:1,i=Math.round(s*Math.max(r.minTimeout,1)*Math.pow(r.factor,t));return i=Math.min(i,r.maxTimeout),i},n.wrap=function(t,r,s){if(r instanceof Array&&(s=r,r=null),!s){s=[];for(var i in t)typeof t[i]=="function"&&s.push(i)}for(var a=0;a<s.length;a++){var o=s[a],u=t[o];t[o]=(function(l){var d=n.operation(r),h=Array.prototype.slice.call(arguments,1),g=h.pop();h.push(function(f){d.retry(f)||(f&&(arguments[0]=d.mainError()),g.apply(this,arguments))}),d.attempt(function(){l.apply(t,h)})}).bind(t,u),t[o].options=r}}})(Ou);var vd=Ou;const wd=vd,Od=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"];class Eu extends Error{constructor(e){super(),e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}}const Ed=(n,e,t)=>{const r=t.retries-(e-1);return n.attemptNumber=e,n.retriesLeft=r,n},Ad=n=>Od.includes(n),Au=(n,e)=>new Promise((t,r)=>{e={onFailedAttempt:()=>{},retries:10,...e};const s=wd.operation(e);s.attempt(async i=>{try{t(await n(i))}catch(a){if(!(a instanceof Error)){r(new TypeError(`Non-error was thrown: "${a}". You should only throw errors.`));return}if(a instanceof Eu)s.stop(),r(a.originalError);else if(a instanceof TypeError&&!Ad(a.message))s.stop(),r(a);else{Ed(a,i,e);try{await e.onFailedAttempt(a)}catch(o){r(o);return}s.retry(a)||r(s.mainError())}}})});Xn.exports=Au;Xn.exports.default=Au;Xn.exports.AbortError=Eu;var Td=Xn.exports;const Tu=hn(Td);var Pu={},xu={exports:{}};(function(n){var e=Object.prototype.hasOwnProperty,t="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(t=!1));function s(u,c,l){this.fn=u,this.context=c,this.once=l||!1}function i(u,c,l,d,h){if(typeof l!="function")throw new TypeError("The listener must be a function");var g=new s(l,d||u,h),f=t?t+c:c;return u._events[f]?u._events[f].fn?u._events[f]=[u._events[f],g]:u._events[f].push(g):(u._events[f]=g,u._eventsCount++),u}function a(u,c){--u._eventsCount===0?u._events=new r:delete u._events[c]}function o(){this._events=new r,this._eventsCount=0}o.prototype.eventNames=function(){var c=[],l,d;if(this._eventsCount===0)return c;for(d in l=this._events)e.call(l,d)&&c.push(t?d.slice(1):d);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(l)):c},o.prototype.listeners=function(c){var l=t?t+c:c,d=this._events[l];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,g=d.length,f=new Array(g);h<g;h++)f[h]=d[h].fn;return f},o.prototype.listenerCount=function(c){var l=t?t+c:c,d=this._events[l];return d?d.fn?1:d.length:0},o.prototype.emit=function(c,l,d,h,g,f){var b=t?t+c:c;if(!this._events[b])return!1;var y=this._events[b],T=arguments.length,k,S;if(y.fn){switch(y.once&&this.removeListener(c,y.fn,void 0,!0),T){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,l),!0;case 3:return y.fn.call(y.context,l,d),!0;case 4:return y.fn.call(y.context,l,d,h),!0;case 5:return y.fn.call(y.context,l,d,h,g),!0;case 6:return y.fn.call(y.context,l,d,h,g,f),!0}for(S=1,k=new Array(T-1);S<T;S++)k[S-1]=arguments[S];y.fn.apply(y.context,k)}else{var x=y.length,$;for(S=0;S<x;S++)switch(y[S].once&&this.removeListener(c,y[S].fn,void 0,!0),T){case 1:y[S].fn.call(y[S].context);break;case 2:y[S].fn.call(y[S].context,l);break;case 3:y[S].fn.call(y[S].context,l,d);break;case 4:y[S].fn.call(y[S].context,l,d,h);break;default:if(!k)for($=1,k=new Array(T-1);$<T;$++)k[$-1]=arguments[$];y[S].fn.apply(y[S].context,k)}}return!0},o.prototype.on=function(c,l,d){return i(this,c,l,d,!1)},o.prototype.once=function(c,l,d){return i(this,c,l,d,!0)},o.prototype.removeListener=function(c,l,d,h){var g=t?t+c:c;if(!this._events[g])return this;if(!l)return a(this,g),this;var f=this._events[g];if(f.fn)f.fn===l&&(!h||f.once)&&(!d||f.context===d)&&a(this,g);else{for(var b=0,y=[],T=f.length;b<T;b++)(f[b].fn!==l||h&&!f[b].once||d&&f[b].context!==d)&&y.push(f[b]);y.length?this._events[g]=y.length===1?y[0]:y:a(this,g)}return this},o.prototype.removeAllListeners=function(c){var l;return c?(l=t?t+c:c,this._events[l]&&a(this,l)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=t,o.EventEmitter=o,n.exports=o})(xu);var Pd=xu.exports,es={exports:{}},xd=(n,e)=>(e=e||(()=>{}),n.then(t=>new Promise(r=>{r(e())}).then(()=>t),t=>new Promise(r=>{r(e())}).then(()=>{throw t})));const Sd=xd;class Su extends Error{constructor(e){super(e),this.name="TimeoutError"}}const ju=(n,e,t)=>new Promise((r,s)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===1/0){r(n);return}const i=setTimeout(()=>{if(typeof t=="function"){try{r(t())}catch(u){s(u)}return}const a=typeof t=="string"?t:`Promise timed out after ${e} milliseconds`,o=t instanceof Error?t:new Su(a);typeof n.cancel=="function"&&n.cancel(),s(o)},e);Sd(n.then(r,s),()=>{clearTimeout(i)})});es.exports=ju;es.exports.default=ju;es.exports.TimeoutError=Su;var jd=es.exports,Fi={},Bi={};Object.defineProperty(Bi,"__esModule",{value:!0});function kd(n,e,t){let r=0,s=n.length;for(;s>0;){const i=s/2|0;let a=r+i;t(n[a],e)<=0?(r=++a,s-=i+1):s=i}return r}Bi.default=kd;Object.defineProperty(Fi,"__esModule",{value:!0});const Cd=Bi;class Id{constructor(){this._queue=[]}enqueue(e,t){t=Object.assign({priority:0},t);const r={priority:t.priority,run:e};if(this.size&&this._queue[this.size-1].priority>=t.priority){this._queue.push(r);return}const s=Cd.default(this._queue,r,(i,a)=>a.priority-i.priority);this._queue.splice(s,0,r)}dequeue(){const e=this._queue.shift();return e==null?void 0:e.run}filter(e){return this._queue.filter(t=>t.priority===e.priority).map(t=>t.run)}get size(){return this._queue.length}}Fi.default=Id;Object.defineProperty(Pu,"__esModule",{value:!0});const Rd=Pd,ku=jd,Dd=Fi,En=()=>{},Nd=new ku.TimeoutError;class Ld extends Rd{constructor(e){var t,r,s,i;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=En,this._resolveIdle=En,e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:Dd.default},e),!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(r=(t=e.intervalCap)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(i=(s=e.interval)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||e.interval===0,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=e.throwOnTimeout===!0,this._isPaused=e.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=En,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=En,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){const e=Date.now();if(this._intervalId===void 0){const t=this._intervalEnd-e;if(t<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},t)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){const t=this._queue.dequeue();return t?(this.emit("active"),t(),e&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,t={}){return new Promise((r,s)=>{const i=async()=>{this._pendingCount++,this._intervalCount++;try{const a=this._timeout===void 0&&t.timeout===void 0?e():ku.default(Promise.resolve(e()),t.timeout===void 0?this._timeout:t.timeout,()=>{(t.throwOnTimeout===void 0?this._throwOnTimeout:t.throwOnTimeout)&&s(Nd)});r(await a)}catch(a){s(a)}this._next()};this._queue.enqueue(i,t),this._tryToStartAnother(),this.emit("add")})}async addAll(e,t){return Promise.all(e.map(async r=>this.add(r,t)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(e=>{const t=this._resolveEmpty;this._resolveEmpty=()=>{t(),e()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(e=>{const t=this._resolveIdle;this._resolveIdle=()=>{t(),e()}})}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}}var Tt=Pu.default=Ld;const $d=[400,401,403,404,405,406,407,408,409];let Vi=class{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6;const t="default"in Tt?Tt.default:Tt;this.queue=new t({concurrency:this.maxConcurrency})}call(e,...t){return this.queue.add(()=>Tu(()=>e(...t).catch(r=>{throw r instanceof Error?r:new Error(r)}),{onFailedAttempt(r){var a,o,u,c;if(r.message.startsWith("Cancel")||r.message.startsWith("TimeoutError")||r.message.startsWith("AbortError")||(r==null?void 0:r.code)==="ECONNABORTED")throw r;const s=(a=r==null?void 0:r.response)==null?void 0:a.status;if(s&&$d.includes(+s))throw r;const i=(o=r==null?void 0:r.response)==null?void 0:o.data;if(((u=i==null?void 0:i.error)==null?void 0:u.code)==="insufficient_quota"){const l=new Error((c=i==null?void 0:i.error)==null?void 0:c.message);throw l.name="InsufficientQuotaError",l}},retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,t,...r){return e.signal?Promise.race([this.call(t,...r),new Promise((s,i)=>{var a;(a=e.signal)==null||a.addEventListener("abort",()=>{i(new Error("AbortError"))})})]):this.call(t,...r)}fetch(...e){return this.call(()=>fetch(...e).then(t=>t.ok?t:Promise.reject(t)))}};const An={},Ud=new Vi({});async function Md(n,e){return n in An||(An[n]=Ud.fetch(`https://tiktoken.pages.dev/js/${n}.json`,{signal:e==null?void 0:e.signal}).then(t=>t.json()).catch(t=>{throw delete An[n],t})),new wu(await An[n],e==null?void 0:e.extendedSpecialTokens)}async function Cu(n,e){return Md(bd(n),e)}var Fd=function(n,e){if(typeof n!="string")throw new TypeError("Expected a string");return e=typeof e>"u"?"_":e,n.replace(/([a-z\d])([A-Z])/g,"$1"+e+"$2").replace(/([A-Z]+)([A-Z][a-z\d]+)/g,"$1"+e+"$2").toLowerCase()};const Bd=hn(Fd);var Iu={exports:{}};const Vd=/[\p{Lu}]/u,qd=/[\p{Ll}]/u,Da=/^[\p{Lu}](?![\p{Lu}])/gu,Ru=/([\p{Alpha}\p{N}_]|$)/u,Du=/[_.\- ]+/,zd=new RegExp("^"+Du.source),Na=new RegExp(Du.source+Ru.source,"gu"),La=new RegExp("\\d+"+Ru.source,"gu"),Hd=(n,e,t)=>{let r=!1,s=!1,i=!1;for(let a=0;a<n.length;a++){const o=n[a];r&&Vd.test(o)?(n=n.slice(0,a)+"-"+n.slice(a),r=!1,i=s,s=!0,a++):s&&i&&qd.test(o)?(n=n.slice(0,a-1)+"-"+n.slice(a-1),i=s,s=!1,r=!0):(r=e(o)===o&&t(o)!==o,i=s,s=t(o)===o&&e(o)!==o)}return n},Kd=(n,e)=>(Da.lastIndex=0,n.replace(Da,t=>e(t))),Zd=(n,e)=>(Na.lastIndex=0,La.lastIndex=0,n.replace(Na,(t,r)=>e(r)).replace(La,t=>e(t))),Nu=(n,e)=>{if(!(typeof n=="string"||Array.isArray(n)))throw new TypeError("Expected the input to be `string | string[]`");if(e={pascalCase:!1,preserveConsecutiveUppercase:!1,...e},Array.isArray(n)?n=n.map(i=>i.trim()).filter(i=>i.length).join("-"):n=n.trim(),n.length===0)return"";const t=e.locale===!1?i=>i.toLowerCase():i=>i.toLocaleLowerCase(e.locale),r=e.locale===!1?i=>i.toUpperCase():i=>i.toLocaleUpperCase(e.locale);return n.length===1?e.pascalCase?r(n):t(n):(n!==t(n)&&(n=Hd(n,t,r)),n=n.replace(zd,""),e.preserveConsecutiveUppercase?n=Kd(n,t):n=t(n),e.pascalCase&&(n=r(n.charAt(0))+n.slice(1)),Zd(n,r))};Iu.exports=Nu;Iu.exports.default=Nu;function Jd(n,e){return(e==null?void 0:e[n])||Bd(n)}function Gd(n,e,t){const r={};for(const s in n)Object.hasOwn(n,s)&&(r[e(s,t)]=n[s]);return r}function $a(n){return Array.isArray(n)?[...n]:{...n}}function Yd(n,e){const t=$a(n);for(const[r,s]of Object.entries(e)){const[i,...a]=r.split(".").reverse();let o=t;for(const u of a.reverse()){if(o[u]===void 0)break;o[u]=$a(o[u]),o=o[u]}o[i]!==void 0&&(o[i]={lc:1,type:"secret",id:[s]})}return t}class ct{get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}constructor(e,...t){Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.lc_kwargs=e||{}}toJSON(){if(!this.lc_serializable)return this.toJSONNotImplemented();if(this.lc_kwargs instanceof ct||typeof this.lc_kwargs!="object"||Array.isArray(this.lc_kwargs))return this.toJSONNotImplemented();const e={},t={},r=Object.keys(this.lc_kwargs).reduce((s,i)=>(s[i]=i in this?this[i]:this.lc_kwargs[i],s),{});for(let s=Object.getPrototypeOf(this);s;s=Object.getPrototypeOf(s))Object.assign(e,Reflect.get(s,"lc_aliases",this)),Object.assign(t,Reflect.get(s,"lc_secrets",this)),Object.assign(r,Reflect.get(s,"lc_attributes",this));for(const s in t)s in this&&this[s]!==void 0&&(r[s]=this[s]||r[s]);return{lc:1,type:"constructor",id:[...this.lc_namespace,this.constructor.name],kwargs:Gd(Object.keys(t).length?Yd(r,t):r,Jd,e)}}toJSONNotImplemented(){return{lc:1,type:"not_implemented",id:[...this.lc_namespace,this.constructor.name]}}}class Wd extends ct{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","document_transformers"]})}}class Qd extends Wd{constructor(e){if(super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","document_transformers","text_splitters"]}),Object.defineProperty(this,"chunkSize",{enumerable:!0,configurable:!0,writable:!0,value:1e3}),Object.defineProperty(this,"chunkOverlap",{enumerable:!0,configurable:!0,writable:!0,value:200}),Object.defineProperty(this,"keepSeparator",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lengthFunction",{enumerable:!0,configurable:!0,writable:!0,value:t=>t.length}),this.chunkSize=(e==null?void 0:e.chunkSize)??this.chunkSize,this.chunkOverlap=(e==null?void 0:e.chunkOverlap)??this.chunkOverlap,this.keepSeparator=(e==null?void 0:e.keepSeparator)??this.keepSeparator,this.lengthFunction=(e==null?void 0:e.lengthFunction)??(t=>t.length),this.chunkOverlap>=this.chunkSize)throw new Error("Cannot have chunkOverlap >= chunkSize")}async transformDocuments(e,t={}){return this.splitDocuments(e,t)}splitOnSeparator(e,t){let r;if(t)if(this.keepSeparator){const s=t.replace(/[/\-\\^$*+?.()|[\]{}]/g,"\\$&");r=e.split(new RegExp(`(?=${s})`))}else r=e.split(t);else r=e.split("");return r.filter(s=>s!=="")}async createDocuments(e,t=[],r={}){const s=t.length>0?t:new Array(e.length).fill({}),{chunkHeader:i="",chunkOverlapHeader:a="(cont'd) ",appendChunkOverlapHeader:o=!1}=r,u=new Array;for(let c=0;c<e.length;c+=1){const l=e[c];let d=1,h=null;for(const g of await this.splitText(l)){let f=i,b=0;if(h){const S=l.indexOf(g),x=l.indexOf(h)+this.lengthFunction(h);b=(l.slice(x,S).match(/\n/g)||[]).length,o&&(f+=a)}d+=b;const y=(g.match(/\n/g)||[]).length,T=s[c].loc&&typeof s[c].loc=="object"?{...s[c].loc}:{};T.lines={from:d,to:d+y};const k={...s[c],loc:T};f+=g,u.push(new Gr({pageContent:f,metadata:k})),d+=y,h=g}}return u}async splitDocuments(e,t={}){const r=e.filter(a=>a.pageContent!==void 0),s=r.map(a=>a.pageContent),i=r.map(a=>a.metadata);return this.createDocuments(s,i,t)}joinDocs(e,t){const r=e.join(t).trim();return r===""?null:r}mergeSplits(e,t){const r=[],s=[];let i=0;for(const o of e){const u=this.lengthFunction(o);if(i+u+(s.length>0?t.length:0)>this.chunkSize&&(i>this.chunkSize&&console.warn(`Created a chunk of size ${i}, +
which is longer than the specified ${this.chunkSize}`),s.length>0)){const c=this.joinDocs(s,t);for(c!==null&&r.push(c);i>this.chunkOverlap||i+u>this.chunkSize&&i>0;)i-=this.lengthFunction(s[0]),s.shift()}s.push(o),i+=u}const a=this.joinDocs(s,t);return a!==null&&r.push(a),r}}class Yr extends Qd{constructor(e){super(e),Object.defineProperty(this,"separators",{enumerable:!0,configurable:!0,writable:!0,value:[`

`,`
`," ",""]}),this.separators=(e==null?void 0:e.separators)??this.separators,this.keepSeparator=(e==null?void 0:e.keepSeparator)??!0}async _splitText(e,t){const r=[];let s=t[t.length-1],i;for(let c=0;c<t.length;c+=1){const l=t[c];if(l===""){s=l;break}if(e.includes(l)){s=l,i=t.slice(c+1);break}}const a=this.splitOnSeparator(e,s);let o=[];const u=this.keepSeparator?"":s;for(const c of a)if(this.lengthFunction(c)<this.chunkSize)o.push(c);else{if(o.length){const l=this.mergeSplits(o,u);r.push(...l),o=[]}if(!i)r.push(c);else{const l=await this._splitText(c,i);r.push(...l)}}if(o.length){const c=this.mergeSplits(o,u);r.push(...c)}return r}async splitText(e){return this._splitText(e,this.separators)}static fromLanguage(e,t){return new Yr({...t,separators:Yr.getSeparatorsForLanguage(e)})}static getSeparatorsForLanguage(e){if(e==="cpp")return[`
class `,`
void `,`
int `,`
float `,`
double `,`
if `,`
for `,`
while `,`
switch `,`
case `,`

`,`
`," ",""];if(e==="go")return[`
func `,`
var `,`
const `,`
type `,`
if `,`
for `,`
switch `,`
case `,`

`,`
`," ",""];if(e==="java")return[`
class `,`
public `,`
protected `,`
private `,`
static `,`
if `,`
for `,`
while `,`
switch `,`
case `,`

`,`
`," ",""];if(e==="js")return[`
function `,`
const `,`
let `,`
var `,`
class `,`
if `,`
for `,`
while `,`
switch `,`
case `,`
default `,`

`,`
`," ",""];if(e==="php")return[`
function `,`
class `,`
if `,`
foreach `,`
while `,`
do `,`
switch `,`
case `,`

`,`
`," ",""];if(e==="proto")return[`
message `,`
service `,`
enum `,`
option `,`
import `,`
syntax `,`

`,`
`," ",""];if(e==="python")return[`
class `,`
def `,`
	def `,`

`,`
`," ",""];if(e==="rst")return[`
===
`,`
---
`,`
***
`,`
.. `,`

`,`
`," ",""];if(e==="ruby")return[`
def `,`
class `,`
if `,`
unless `,`
while `,`
for `,`
do `,`
begin `,`
rescue `,`

`,`
`," ",""];if(e==="rust")return[`
fn `,`
const `,`
let `,`
if `,`
while `,`
for `,`
loop `,`
match `,`
const `,`

`,`
`," ",""];if(e==="scala")return[`
class `,`
object `,`
def `,`
val `,`
var `,`
if `,`
for `,`
while `,`
match `,`
case `,`

`,`
`," ",""];if(e==="swift")return[`
func `,`
class `,`
struct `,`
enum `,`
if `,`
for `,`
while `,`
do `,`
switch `,`
case `,`

`,`
`," ",""];if(e==="markdown")return[`
## `,`
### `,`
#### `,`
##### `,`
###### `,"```\n\n",`

***

`,`

---

`,`

___

`,`

`,`
`," ",""];if(e==="latex")return[`
\\chapter{`,`
\\section{`,`
\\subsection{`,`
\\subsubsection{`,`
\\begin{enumerate}`,`
\\begin{itemize}`,`
\\begin{description}`,`
\\begin{list}`,`
\\begin{quote}`,`
\\begin{quotation}`,`
\\begin{verse}`,`
\\begin{verbatim}`,`
\\begin{align}`,"$$","$",`

`,`
`," ",""];if(e==="html")return["<body>","<div>","<p>","<br>","<li>","<h1>","<h2>","<h3>","<h4>","<h5>","<h6>","<span>","<table>","<tr>","<td>","<th>","<ul>","<ol>","<header>","<footer>","<nav>","<head>","<style>","<script>","<meta>","<title>"," ",""];if(e==="sol")return[`
pragma `,`
using `,`
contract `,`
interface `,`
library `,`
constructor `,`
type `,`
function `,`
event `,`
modifier `,`
error `,`
struct `,`
enum `,`
if `,`
for `,`
while `,`
do while `,`
assembly `,`

`,`
`," ",""];throw new Error(`Language ${e} is not supported.`)}}async function Xd(n){const t=await(await fetch(n)).arrayBuffer(),r=await crypto.subtle.digest("SHA-1",t),i=Array.from(new Uint8Array(r)).map(a=>a.toString(16).padStart(2,"0")).join("");return console.log("readableHash from computeSHA1FromFile: ",i),i}async function Lu(n){const t=new TextEncoder().encode(n),r=await crypto.subtle.digest("SHA-1",t),i=Array.from(new Uint8Array(r)).map(a=>a.toString(16).padStart(2,"0")).join("");return console.log("readableHash from computeSHA1FromContent: ",i),i}var eh=globalThis&&globalThis.__awaiter||function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(l){try{c(r.next(l))}catch(d){a(d)}}function u(l){try{c(r.throw(l))}catch(d){a(d)}}function c(l){l.done?i(l.value):s(l.value).then(o,u)}c((r=r.apply(n,e||[])).next())})};const th=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>eh(void 0,void 0,void 0,function*(){return yield(yield Te(()=>Promise.resolve().then(()=>ts),void 0)).fetch(...t)}):e=fetch,(...t)=>e(...t)};class qi extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class rh extends qi{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class nh extends qi{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class sh extends qi{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var ih=globalThis&&globalThis.__awaiter||function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(l){try{c(r.next(l))}catch(d){a(d)}}function u(l){try{c(r.throw(l))}catch(d){a(d)}}function c(l){l.done?i(l.value):s(l.value).then(o,u)}c((r=r.apply(n,e||[])).next())})};class ah{constructor(e,{headers:t={},customFetch:r}={}){this.url=e,this.headers=t,this.fetch=th(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var r;return ih(this,void 0,void 0,function*(){try{const{headers:s,method:i,body:a}=t;let o={},u;a&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",u=a):typeof a=="string"?(o["Content-Type"]="text/plain",u=a):typeof FormData<"u"&&a instanceof FormData?u=a:(o["Content-Type"]="application/json",u=JSON.stringify(a)));const c=yield this.fetch(`${this.url}/${e}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),s),body:u}).catch(g=>{throw new rh(g)}),l=c.headers.get("x-relay-error");if(l&&l==="true")throw new nh(c);if(!c.ok)throw new sh(c);let d=((r=c.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),h;return d==="application/json"?h=yield c.json():d==="application/octet-stream"?h=yield c.blob():d==="multipart/form-data"?h=yield c.formData():h=yield c.text(),{data:h,error:null}}catch(s){return{data:null,error:s}}})}}var vi={exports:{}};(function(n,e){var t=typeof self<"u"?self:ut,r=function(){function i(){this.fetch=!1,this.DOMException=t.DOMException}return i.prototype=t,new i}();(function(i){(function(a){var o={searchParams:"URLSearchParams"in i,iterable:"Symbol"in i&&"iterator"in Symbol,blob:"FileReader"in i&&"Blob"in i&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in i,arrayBuffer:"ArrayBuffer"in i};function u(O){return O&&DataView.prototype.isPrototypeOf(O)}if(o.arrayBuffer)var c=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],l=ArrayBuffer.isView||function(O){return O&&c.indexOf(Object.prototype.toString.call(O))>-1};function d(O){if(typeof O!="string"&&(O=String(O)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(O))throw new TypeError("Invalid character in header field name");return O.toLowerCase()}function h(O){return typeof O!="string"&&(O=String(O)),O}function g(O){var I={next:function(){var D=O.shift();return{done:D===void 0,value:D}}};return o.iterable&&(I[Symbol.iterator]=function(){return I}),I}function f(O){this.map={},O instanceof f?O.forEach(function(I,D){this.append(D,I)},this):Array.isArray(O)?O.forEach(function(I){this.append(I[0],I[1])},this):O&&Object.getOwnPropertyNames(O).forEach(function(I){this.append(I,O[I])},this)}f.prototype.append=function(O,I){O=d(O),I=h(I);var D=this.map[O];this.map[O]=D?D+", "+I:I},f.prototype.delete=function(O){delete this.map[d(O)]},f.prototype.get=function(O){return O=d(O),this.has(O)?this.map[O]:null},f.prototype.has=function(O){return this.map.hasOwnProperty(d(O))},f.prototype.set=function(O,I){this.map[d(O)]=h(I)},f.prototype.forEach=function(O,I){for(var D in this.map)this.map.hasOwnProperty(D)&&O.call(I,this.map[D],D,this)},f.prototype.keys=function(){var O=[];return this.forEach(function(I,D){O.push(D)}),g(O)},f.prototype.values=function(){var O=[];return this.forEach(function(I){O.push(I)}),g(O)},f.prototype.entries=function(){var O=[];return this.forEach(function(I,D){O.push([D,I])}),g(O)},o.iterable&&(f.prototype[Symbol.iterator]=f.prototype.entries);function b(O){if(O.bodyUsed)return Promise.reject(new TypeError("Already read"));O.bodyUsed=!0}function y(O){return new Promise(function(I,D){O.onload=function(){I(O.result)},O.onerror=function(){D(O.error)}})}function T(O){var I=new FileReader,D=y(I);return I.readAsArrayBuffer(O),D}function k(O){var I=new FileReader,D=y(I);return I.readAsText(O),D}function S(O){for(var I=new Uint8Array(O),D=new Array(I.length),J=0;J<I.length;J++)D[J]=String.fromCharCode(I[J]);return D.join("")}function x(O){if(O.slice)return O.slice(0);var I=new Uint8Array(O.byteLength);return I.set(new Uint8Array(O)),I.buffer}function $(){return this.bodyUsed=!1,this._initBody=function(O){this._bodyInit=O,O?typeof O=="string"?this._bodyText=O:o.blob&&Blob.prototype.isPrototypeOf(O)?this._bodyBlob=O:o.formData&&FormData.prototype.isPrototypeOf(O)?this._bodyFormData=O:o.searchParams&&URLSearchParams.prototype.isPrototypeOf(O)?this._bodyText=O.toString():o.arrayBuffer&&o.blob&&u(O)?(this._bodyArrayBuffer=x(O.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):o.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(O)||l(O))?this._bodyArrayBuffer=x(O):this._bodyText=O=Object.prototype.toString.call(O):this._bodyText="",this.headers.get("content-type")||(typeof O=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):o.searchParams&&URLSearchParams.prototype.isPrototypeOf(O)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},o.blob&&(this.blob=function(){var O=b(this);if(O)return O;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?b(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(T)}),this.text=function(){var O=b(this);if(O)return O;if(this._bodyBlob)return k(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(S(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},o.formData&&(this.formData=function(){return this.text().then(w)}),this.json=function(){return this.text().then(JSON.parse)},this}var A=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function C(O){var I=O.toUpperCase();return A.indexOf(I)>-1?I:O}function _(O,I){I=I||{};var D=I.body;if(O instanceof _){if(O.bodyUsed)throw new TypeError("Already read");this.url=O.url,this.credentials=O.credentials,I.headers||(this.headers=new f(O.headers)),this.method=O.method,this.mode=O.mode,this.signal=O.signal,!D&&O._bodyInit!=null&&(D=O._bodyInit,O.bodyUsed=!0)}else this.url=String(O);if(this.credentials=I.credentials||this.credentials||"same-origin",(I.headers||!this.headers)&&(this.headers=new f(I.headers)),this.method=C(I.method||this.method||"GET"),this.mode=I.mode||this.mode||null,this.signal=I.signal||this.signal,this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&D)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(D)}_.prototype.clone=function(){return new _(this,{body:this._bodyInit})};function w(O){var I=new FormData;return O.trim().split("&").forEach(function(D){if(D){var J=D.split("="),G=J.shift().replace(/\+/g," "),L=J.join("=").replace(/\+/g," ");I.append(decodeURIComponent(G),decodeURIComponent(L))}}),I}function m(O){var I=new f,D=O.replace(/\r?\n[\t ]+/g," ");return D.split(/\r?\n/).forEach(function(J){var G=J.split(":"),L=G.shift().trim();if(L){var R=G.join(":").trim();I.append(L,R)}}),I}$.call(_.prototype);function E(O,I){I||(I={}),this.type="default",this.status=I.status===void 0?200:I.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in I?I.statusText:"OK",this.headers=new f(I.headers),this.url=I.url||"",this._initBody(O)}$.call(E.prototype),E.prototype.clone=function(){return new E(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new f(this.headers),url:this.url})},E.error=function(){var O=new E(null,{status:0,statusText:""});return O.type="error",O};var j=[301,302,303,307,308];E.redirect=function(O,I){if(j.indexOf(I)===-1)throw new RangeError("Invalid status code");return new E(null,{status:I,headers:{location:O}})},a.DOMException=i.DOMException;try{new a.DOMException}catch{a.DOMException=function(I,D){this.message=I,this.name=D;var J=Error(I);this.stack=J.stack},a.DOMException.prototype=Object.create(Error.prototype),a.DOMException.prototype.constructor=a.DOMException}function H(O,I){return new Promise(function(D,J){var G=new _(O,I);if(G.signal&&G.signal.aborted)return J(new a.DOMException("Aborted","AbortError"));var L=new XMLHttpRequest;function R(){L.abort()}L.onload=function(){var F={status:L.status,statusText:L.statusText,headers:m(L.getAllResponseHeaders()||"")};F.url="responseURL"in L?L.responseURL:F.headers.get("X-Request-URL");var ge="response"in L?L.response:L.responseText;D(new E(ge,F))},L.onerror=function(){J(new TypeError("Network request failed"))},L.ontimeout=function(){J(new TypeError("Network request failed"))},L.onabort=function(){J(new a.DOMException("Aborted","AbortError"))},L.open(G.method,G.url,!0),G.credentials==="include"?L.withCredentials=!0:G.credentials==="omit"&&(L.withCredentials=!1),"responseType"in L&&o.blob&&(L.responseType="blob"),G.headers.forEach(function(F,ge){L.setRequestHeader(ge,F)}),G.signal&&(G.signal.addEventListener("abort",R),L.onreadystatechange=function(){L.readyState===4&&G.signal.removeEventListener("abort",R)}),L.send(typeof G._bodyInit>"u"?null:G._bodyInit)})}return H.polyfill=!0,i.fetch||(i.fetch=H,i.Headers=f,i.Request=_,i.Response=E),a.Headers=f,a.Request=_,a.Response=E,a.fetch=H,Object.defineProperty(a,"__esModule",{value:!0}),a})({})})(r),r.fetch.ponyfill=!0,delete r.fetch.polyfill;var s=r;e=s.fetch,e.default=s.fetch,e.fetch=s.fetch,e.Headers=s.Headers,e.Request=s.Request,e.Response=s.Response,n.exports=e})(vi,vi.exports);var zi=vi.exports;const Hi=hn(zi),ts=rd({__proto__:null,default:Hi},[zi]);class oh{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=Hi:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}then(e,t){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const r=this.fetch;let s=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var a,o,u;let c=null,l=null,d=null,h=i.status,g=i.statusText;if(i.ok){if(this.method!=="HEAD"){const T=await i.text();T===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?l=T:l=JSON.parse(T))}const b=(a=this.headers.Prefer)===null||a===void 0?void 0:a.match(/count=(exact|planned|estimated)/),y=(o=i.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");b&&y&&y.length>1&&(d=parseInt(y[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(l)&&(l.length>1?(c={code:"PGRST116",details:`Results contain ${l.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},l=null,d=null,h=406,g="Not Acceptable"):l.length===1?l=l[0]:l=null)}else{const b=await i.text();try{c=JSON.parse(b),Array.isArray(c)&&i.status===404&&(l=[],c=null,h=200,g="OK")}catch{i.status===404&&b===""?(h=204,g="No Content"):c={message:b}}if(c&&this.isMaybeSingle&&(!((u=c==null?void 0:c.details)===null||u===void 0)&&u.includes("Results contain 0 rows"))&&(c=null,h=200,g="OK"),c&&this.shouldThrowOnError)throw c}return{error:c,data:l,count:d,status:h,statusText:g}});return this.shouldThrowOnError||(s=s.catch(i=>{var a,o,u;return{error:{message:`${(a=i==null?void 0:i.name)!==null&&a!==void 0?a:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(o=i==null?void 0:i.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(u=i==null?void 0:i.code)!==null&&u!==void 0?u:""}`},data:null,count:null,status:0,statusText:""}})),s.then(e,t)}}class uh extends oh{select(e){let t=!1;const r=(e??"*").split("").map(s=>/\s/.test(s)&&!t?"":(s==='"'&&(t=!t),s)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:s}={}){const i=s?`${s}.order`:"order",a=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${a?`${a},`:""}${e}.${t?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t}={}){const r=typeof t>"u"?"limit":`${t}.limit`;return this.url.searchParams.set(r,`${e}`),this}range(e,t,{foreignTable:r}={}){const s=typeof r>"u"?"offset":`${r}.offset`,i=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${e}`),this.url.searchParams.set(i,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:s=!1,wal:i=!1,format:a="text"}={}){const o=[e?"analyze":null,t?"verbose":null,r?"settings":null,s?"buffers":null,i?"wal":null].filter(Boolean).join("|"),u=this.headers.Accept;return this.headers.Accept=`application/vnd.pgrst.plan+${a}; for="${u}"; options=${o};`,a==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}}class ur extends uh{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const r=t.map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return typeof t=="string"?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return typeof t=="string"?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:s}={}){let i="";s==="plain"?i="pl":s==="phrase"?i="ph":s==="websearch"&&(i="w");const a=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${i}fts${a}.${t}`),this}match(e){return Object.entries(e).forEach(([t,r])=>{this.url.searchParams.append(t,`eq.${r}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t}={}){const r=t?`${t}.or`:"or";return this.url.searchParams.append(r,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}}class ch{constructor(e,{headers:t={},schema:r,fetch:s}){this.url=e,this.headers=t,this.schema=r,this.fetch=s}select(e,{head:t=!1,count:r}={}){const s=t?"HEAD":"GET";let i=!1;const a=(e??"*").split("").map(o=>/\s/.test(o)&&!i?"":(o==='"'&&(i=!i),o)).join("");return this.url.searchParams.set("select",a),r&&(this.headers.Prefer=`count=${r}`),new ur({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:r=!0}={}){const s="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),t&&i.push(`count=${t}`),r||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(e)){const a=e.reduce((o,u)=>o.concat(Object.keys(u)),[]);if(a.length>0){const o=[...new Set(a)].map(u=>`"${u}"`);this.url.searchParams.set("columns",o.join(","))}}return new ur({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:s,defaultToNull:i=!0}={}){const a="POST",o=[`resolution=${r?"ignore":"merge"}-duplicates`];if(t!==void 0&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&o.push(this.headers.Prefer),s&&o.push(`count=${s}`),i||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(e)){const u=e.reduce((c,l)=>c.concat(Object.keys(l)),[]);if(u.length>0){const c=[...new Set(u)].map(l=>`"${l}"`);this.url.searchParams.set("columns",c.join(","))}}return new ur({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const r="PATCH",s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),t&&s.push(`count=${t}`),this.headers.Prefer=s.join(","),new ur({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t="DELETE",r=[];return e&&r.push(`count=${e}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new ur({method:t,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}}const lh="1.7.2",dh={"X-Client-Info":`postgrest-js/${lh}`};class hh{constructor(e,{headers:t={},schema:r,fetch:s}={}){this.url=e,this.headers=Object.assign(Object.assign({},dh),t),this.schema=r,this.fetch=s}from(e){const t=new URL(`${this.url}/${e}`);return new ch(t,{headers:Object.assign({},this.headers),schema:this.schema,fetch:this.fetch})}rpc(e,t={},{head:r=!1,count:s}={}){let i;const a=new URL(`${this.url}/rpc/${e}`);let o;r?(i="HEAD",Object.entries(t).forEach(([c,l])=>{a.searchParams.append(c,`${l}`)})):(i="POST",o=t);const u=Object.assign({},this.headers);return s&&(u.Prefer=`count=${s}`),new ur({method:i,url:a,headers:u,schema:this.schema,body:o,fetch:this.fetch,allowEmpty:!1})}}var Ns,Ua;function fh(){if(Ua)return Ns;Ua=1;var n=function(){if(typeof self=="object"&&self)return self;if(typeof window=="object"&&window)return window;throw new Error("Unable to resolve global `this`")};return Ns=function(){if(this)return this;if(typeof globalThis=="object"&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch{return n()}try{return __global__||n()}finally{delete Object.prototype.__global__}}(),Ns}const ph="websocket",mh="Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.",yh=["websocket","websockets","socket","networking","comet","push","RFC-6455","realtime","server","client"],gh="Brian McKelvey <theturtle32@gmail.com> (https://github.com/theturtle32)",bh=["Iaki Baz Castillo <ibc@aliax.net> (http://dev.sipdoc.net)"],_h="1.0.34",vh={type:"git",url:"https://github.com/theturtle32/WebSocket-Node.git"},wh="https://github.com/theturtle32/WebSocket-Node",Oh={node:">=4.0.0"},Eh={bufferutil:"^4.0.1",debug:"^2.2.0","es5-ext":"^0.10.50","typedarray-to-buffer":"^3.1.5","utf-8-validate":"^5.0.2",yaeti:"^0.0.6"},Ah={"buffer-equal":"^1.0.0",gulp:"^4.0.2","gulp-jshint":"^2.0.4","jshint-stylish":"^2.2.1",jshint:"^2.0.0",tape:"^4.9.1"},Th={verbose:!1},Ph={test:"tape test/unit/*.js",gulp:"gulp"},xh="index",Sh={lib:"./lib"},jh="lib/browser.js",kh="Apache-2.0",Ch={name:ph,description:mh,keywords:yh,author:gh,contributors:bh,version:_h,repository:vh,homepage:wh,engines:Oh,dependencies:Eh,devDependencies:Ah,config:Th,scripts:Ph,main:xh,directories:Sh,browser:jh,license:kh};var Ih=Ch.version,zt;if(typeof globalThis=="object")zt=globalThis;else try{zt=fh()}catch{}finally{if(!zt&&typeof window<"u"&&(zt=window),!zt)throw new Error("Could not determine global this")}var Wr=zt.WebSocket||zt.MozWebSocket,Rh=Ih;function $u(n,e){var t;return e?t=new Wr(n,e):t=new Wr(n),t}Wr&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach(function(n){Object.defineProperty($u,n,{get:function(){return Wr[n]}})});var Dh={w3cwebsocket:Wr?$u:null,version:Rh};const Nh="2.7.3",Lh={"X-Client-Info":`realtime-js/${Nh}`},$h="1.0.0",Uu=1e4,Uh=1e3;var Zr;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(Zr||(Zr={}));var Je;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(Je||(Je={}));var ot;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(ot||(ot={}));var wi;(function(n){n.websocket="websocket"})(wi||(wi={}));var Ht;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(Ht||(Ht={}));class Mu{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}class Mh{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,t,r)}_decodeBroadcast(e,t,r){const s=t.getUint8(1),i=t.getUint8(2);let a=this.HEADER_LENGTH+2;const o=r.decode(e.slice(a,a+s));a=a+s;const u=r.decode(e.slice(a,a+i));a=a+i;const c=JSON.parse(r.decode(e.slice(a,e.byteLength)));return{ref:null,topic:o,event:u,payload:c}}}class Ls{constructor(e,t,r={},s=Uu){this.channel=e,this.event=t,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null,this.rateLimited=!1}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){if(this._hasReceived("timeout"))return;this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()})==="rate limited"&&(this.rateLimited=!0)}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Ma;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(Ma||(Ma={}));class Jr{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},s=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Jr.syncState(this.state,s,i,a),this.pendingDiffs.forEach(u=>{this.state=Jr.syncDiff(this.state,u,i,a)}),this.pendingDiffs=[],o()}),this.channel._on(r.diff,{},s=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Jr.syncDiff(this.state,s,i,a),o())}),this.onJoin((s,i,a)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:a})}),this.onLeave((s,i,a)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,s){const i=this.cloneDeep(e),a=this.transformState(t),o={},u={};return this.map(i,(c,l)=>{a[c]||(u[c]=l)}),this.map(a,(c,l)=>{const d=i[c];if(d){const h=l.map(y=>y.presence_ref),g=d.map(y=>y.presence_ref),f=l.filter(y=>g.indexOf(y.presence_ref)<0),b=d.filter(y=>h.indexOf(y.presence_ref)<0);f.length>0&&(o[c]=f),b.length>0&&(u[c]=b)}else o[c]=l}),this.syncDiff(i,{joins:o,leaves:u},r,s)}static syncDiff(e,t,r,s){const{joins:i,leaves:a}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(i,(o,u)=>{var c;const l=(c=e[o])!==null&&c!==void 0?c:[];if(e[o]=this.cloneDeep(u),l.length>0){const d=e[o].map(g=>g.presence_ref),h=l.filter(g=>d.indexOf(g.presence_ref)<0);e[o].unshift(...h)}r(o,l,u)}),this.map(a,(o,u)=>{let c=e[o];if(!c)return;const l=u.map(d=>d.presence_ref);c=c.filter(d=>l.indexOf(d.presence_ref)<0),e[o]=c,s(o,c,u),c.length===0&&delete e[o]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const s=e[r];return"metas"in s?t[r]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[r]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var _e;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(_e||(_e={}));const Fa=(n,e,t={})=>{var r;const s=(r=t.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((i,a)=>(i[a]=Fh(a,n,e,s),i),{})},Fh=(n,e,t,r)=>{const s=e.find(o=>o.name===n),i=s==null?void 0:s.type,a=t[n];return i&&!r.includes(i)?Fu(i,a):Oi(a)},Fu=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return zh(e,t)}switch(n){case _e.bool:return Bh(e);case _e.float4:case _e.float8:case _e.int2:case _e.int4:case _e.int8:case _e.numeric:case _e.oid:return Vh(e);case _e.json:case _e.jsonb:return qh(e);case _e.timestamp:return Hh(e);case _e.abstime:case _e.date:case _e.daterange:case _e.int4range:case _e.int8range:case _e.money:case _e.reltime:case _e.text:case _e.time:case _e.timestamptz:case _e.timetz:case _e.tsrange:case _e.tstzrange:return Oi(e);default:return Oi(e)}},Oi=n=>n,Bh=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},Vh=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},qh=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},zh=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,r=n[t];if(n[0]==="{"&&r==="}"){let i;const a=n.slice(1,t);try{i=JSON.parse("["+a+"]")}catch{i=a?a.split(","):[]}return i.map(o=>Fu(e,o))}return n},Hh=n=>typeof n=="string"?n.replace(" ","T"):n;var Ba=globalThis&&globalThis.__awaiter||function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(l){try{c(r.next(l))}catch(d){a(d)}}function u(l){try{c(r.throw(l))}catch(d){a(d)}}function c(l){l.done?i(l.value):s(l.value).then(o,u)}c((r=r.apply(n,e||[])).next())})},Va;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(Va||(Va={}));var qa;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes"})(qa||(qa={}));var za;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(za||(za={}));class Ki{constructor(e,t={config:{}},r){this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=Je.closed,this.joinedOnce=!1,this.pushBuffer=[],this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""}},t.config),this.timeout=this.socket.timeout,this.joinPush=new Ls(this,ot.join,this.params,this.timeout),this.rejoinTimer=new Mu(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Je.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Je.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=Je.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Je.errored,this.rejoinTimer.scheduleTimeout())}),this._on(ot.reply,{},(s,i)=>{this._trigger(this._replyEventName(i),s)}),this.presence=new Jr(this)}subscribe(e,t=this.timeout){var r,s;if(this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:i,presence:a}}=this.params;this._onError(c=>e&&e("CHANNEL_ERROR",c)),this._onClose(()=>e&&e("CLOSED"));const o={},u={broadcast:i,presence:a,postgres_changes:(s=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(c=>c.filter))!==null&&s!==void 0?s:[]};this.socket.accessToken&&(o.access_token=this.socket.accessToken),this.updateJoinPayload(Object.assign({config:u},o)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",({postgres_changes:c})=>{var l;if(this.socket.accessToken&&this.socket.setAuth(this.socket.accessToken),c===void 0){e&&e("SUBSCRIBED");return}else{const d=this.bindings.postgres_changes,h=(l=d==null?void 0:d.length)!==null&&l!==void 0?l:0,g=[];for(let f=0;f<h;f++){const b=d[f],{filter:{event:y,schema:T,table:k,filter:S}}=b,x=c&&c[f];if(x&&x.event===y&&x.schema===T&&x.table===k&&x.filter===S)g.push(Object.assign(Object.assign({},b),{id:x.id}));else{this.unsubscribe(),e&&e("CHANNEL_ERROR",new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=g,e&&e("SUBSCRIBED");return}}).receive("error",c=>{e&&e("CHANNEL_ERROR",new Error(JSON.stringify(Object.values(c).join(", ")||"error")))}).receive("timeout",()=>{e&&e("TIMED_OUT")})}return this}presenceState(){return this.presence.state}track(e,t={}){return Ba(this,void 0,void 0,function*(){return yield this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)})}untrack(e={}){return Ba(this,void 0,void 0,function*(){return yield this.send({type:"presence",event:"untrack"},e)})}on(e,t,r){return this._on(e,t,r)}send(e,t={}){return new Promise(r=>{var s,i,a;const o=this._push(e.type,e,t.timeout||this.timeout);o.rateLimited&&r("rate limited"),e.type==="broadcast"&&!(!((a=(i=(s=this.params)===null||s===void 0?void 0:s.config)===null||i===void 0?void 0:i.broadcast)===null||a===void 0)&&a.ack)&&r("ok"),o.receive("ok",()=>r("ok")),o.receive("timeout",()=>r("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Je.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(ot.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(r=>{const s=new Ls(this,ot.leave,{},e);s.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),s.send(),this._canPush()||s.trigger("ok",{})})}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Ls(this,e,t,r);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var s,i;const a=e.toLocaleLowerCase(),{close:o,error:u,leave:c,join:l}=ot;if(r&&[o,u,c,l].indexOf(a)>=0&&r!==this._joinRef())return;let h=this._onMessage(a,t,r);if(t&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(g=>{var f,b,y;return((f=g.filter)===null||f===void 0?void 0:f.event)==="*"||((y=(b=g.filter)===null||b===void 0?void 0:b.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===a}).map(g=>g.callback(h,r)):(i=this.bindings[a])===null||i===void 0||i.filter(g=>{var f,b,y,T,k,S;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in g){const x=g.id,$=(f=g.filter)===null||f===void 0?void 0:f.event;return x&&((b=t.ids)===null||b===void 0?void 0:b.includes(x))&&($==="*"||($==null?void 0:$.toLocaleLowerCase())===((y=t.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const x=(k=(T=g==null?void 0:g.filter)===null||T===void 0?void 0:T.event)===null||k===void 0?void 0:k.toLocaleLowerCase();return x==="*"||x===((S=t==null?void 0:t.event)===null||S===void 0?void 0:S.toLocaleLowerCase())}else return g.type.toLocaleLowerCase()===a}).map(g=>{if(typeof h=="object"&&"ids"in h){const f=h.data,{schema:b,table:y,commit_timestamp:T,type:k,errors:S}=f;h=Object.assign(Object.assign({},{schema:b,table:y,commit_timestamp:T,eventType:k,new:{},old:{},errors:S}),this._getPayloadRecords(f))}g.callback(h,r)})}_isClosed(){return this.state===Je.closed}_isJoined(){return this.state===Je.joined}_isJoining(){return this.state===Je.joining}_isLeaving(){return this.state===Je.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const s=e.toLocaleLowerCase(),i={type:s,filter:t,callback:r};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&Ki.isEqual(s.filter,t))}),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(ot.close,{},e)}_onError(e){this._on(ot.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Je.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=Fa(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=Fa(e.columns,e.old_record)),t}}var $s=globalThis&&globalThis.__awaiter||function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(l){try{c(r.next(l))}catch(d){a(d)}}function u(l){try{c(r.throw(l))}catch(d){a(d)}}function c(l){l.done?i(l.value):s(l.value).then(o,u)}c((r=r.apply(n,e||[])).next())})};const Kh=()=>{};class Zh{constructor(e,t){var r;this.accessToken=null,this.channels=[],this.endPoint="",this.headers=Lh,this.params={},this.timeout=Uu,this.transport=Dh.w3cwebsocket,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=Kh,this.conn=null,this.sendBuffer=[],this.serializer=new Mh,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.eventsPerSecondLimitMs=100,this.inThrottle=!1,this.endPoint=`${e}/${wi.websocket}`,t!=null&&t.params&&(this.params=t.params),t!=null&&t.headers&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),t!=null&&t.timeout&&(this.timeout=t.timeout),t!=null&&t.logger&&(this.logger=t.logger),t!=null&&t.transport&&(this.transport=t.transport),t!=null&&t.heartbeatIntervalMs&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const s=(r=t==null?void 0:t.params)===null||r===void 0?void 0:r.eventsPerSecond;s&&(this.eventsPerSecondLimitMs=Math.floor(1e3/s)),this.reconnectAfterMs=t!=null&&t.reconnectAfterMs?t.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=t!=null&&t.encode?t.encode:(i,a)=>a(JSON.stringify(i)),this.decode=t!=null&&t.decode?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Mu(()=>$s(this,void 0,void 0,function*(){this.disconnect(),this.connect()}),this.reconnectAfterMs)}connect(){this.conn||(this.conn=new this.transport(this._endPointURL(),[],null,this.headers),this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e)))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,t??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}removeChannel(e){return $s(this,void 0,void 0,function*(){const t=yield e.unsubscribe();return this.channels.length===0&&this.disconnect(),t})}removeAllChannels(){return $s(this,void 0,void 0,function*(){const e=yield Promise.all(this.channels.map(t=>t.unsubscribe()));return this.disconnect(),e})}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Zr.connecting:return Ht.Connecting;case Zr.open:return Ht.Open;case Zr.closing:return Ht.Closing;default:return Ht.Closed}}isConnected(){return this.connectionState()===Ht.Open}channel(e,t={config:{}}){this.isConnected()||this.connect();const r=new Ki(`realtime:${e}`,t,this);return this.channels.push(r),r}push(e){const{topic:t,event:r,payload:s,ref:i}=e;let a=()=>{this.encode(e,o=>{var u;(u=this.conn)===null||u===void 0||u.send(o)})};if(this.log("push",`${t} ${r} (${i})`,s),this.isConnected())if(["broadcast","presence","postgres_changes"].includes(r)){if(this._throttle(a)())return"rate limited"}else a();else this.sendBuffer.push(a)}setAuth(e){this.accessToken=e,this.channels.forEach(t=>{e&&t.updateJoinPayload({access_token:e}),t.joinedOnce&&t._isJoined()&&t._push(ot.access_token,{access_token:e})})}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t._joinRef()!==e._joinRef())}_endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:$h}))}_onConnMessage(e){this.decode(e.data,t=>{let{topic:r,event:s,payload:i,ref:a}=t;(a&&a===this.pendingHeartbeatRef||s===(i==null?void 0:i.type))&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${r} ${s} ${a&&"("+a+")"||""}`,i),this.channels.filter(o=>o._isMember(r)).forEach(o=>o._trigger(s,i,a)),this.stateChangeCallbacks.message.forEach(o=>o(t))})}_onConnOpen(){this.log("transport",`connected to ${this._endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(t=>t(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(t=>t(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(ot.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${r}${s}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(Uh,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}_throttle(e,t=this.eventsPerSecondLimitMs){return()=>this.inThrottle?!0:(e(),t>0&&(this.inThrottle=!0,setTimeout(()=>{this.inThrottle=!1},t)),!1)}}class Zi extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function $e(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class Jh extends Zi{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Ha extends Zi{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var Bu=globalThis&&globalThis.__awaiter||function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(l){try{c(r.next(l))}catch(d){a(d)}}function u(l){try{c(r.throw(l))}catch(d){a(d)}}function c(l){l.done?i(l.value):s(l.value).then(o,u)}c((r=r.apply(n,e||[])).next())})};const Vu=n=>{let e;return n?e=n:typeof fetch>"u"?e=(...t)=>Bu(void 0,void 0,void 0,function*(){return yield(yield Te(()=>Promise.resolve().then(()=>ts),void 0)).fetch(...t)}):e=fetch,(...t)=>e(...t)},Gh=()=>Bu(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Te(()=>Promise.resolve().then(()=>ts),void 0)).Response:Response});var Er=globalThis&&globalThis.__awaiter||function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(l){try{c(r.next(l))}catch(d){a(d)}}function u(l){try{c(r.throw(l))}catch(d){a(d)}}function c(l){l.done?i(l.value):s(l.value).then(o,u)}c((r=r.apply(n,e||[])).next())})};const Us=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),Yh=(n,e)=>Er(void 0,void 0,void 0,function*(){const t=yield Gh();n instanceof t?n.json().then(r=>{e(new Jh(Us(r),n.status||500))}).catch(r=>{e(new Ha(Us(r),r))}):e(new Ha(Us(n),n))}),Wh=(n,e,t,r)=>{const s={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),t))};function rs(n,e,t,r,s,i){return Er(this,void 0,void 0,function*(){return new Promise((a,o)=>{n(t,Wh(e,r,s,i)).then(u=>{if(!u.ok)throw u;return r!=null&&r.noResolveJson?u:u.json()}).then(u=>a(u)).catch(u=>Yh(u,o))})})}function Ei(n,e,t,r){return Er(this,void 0,void 0,function*(){return rs(n,"GET",e,t,r)})}function Dt(n,e,t,r,s){return Er(this,void 0,void 0,function*(){return rs(n,"POST",e,r,s,t)})}function Qh(n,e,t,r,s){return Er(this,void 0,void 0,function*(){return rs(n,"PUT",e,r,s,t)})}function qu(n,e,t,r,s){return Er(this,void 0,void 0,function*(){return rs(n,"DELETE",e,r,s,t)})}var We=globalThis&&globalThis.__awaiter||function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(l){try{c(r.next(l))}catch(d){a(d)}}function u(l){try{c(r.throw(l))}catch(d){a(d)}}function c(l){l.done?i(l.value):s(l.value).then(o,u)}c((r=r.apply(n,e||[])).next())})};const Xh={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Ka={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class ef{constructor(e,t={},r,s){this.url=e,this.headers=t,this.bucketId=r,this.fetch=Vu(s)}uploadOrUpdate(e,t,r,s){return We(this,void 0,void 0,function*(){try{let i;const a=Object.assign(Object.assign({},Ka),s),o=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(a.upsert)});typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",a.cacheControl),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.append("cacheControl",a.cacheControl)):(i=r,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType);const u=this._removeEmptyFolders(t),c=this._getFinalPath(u),l=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:e,body:i,headers:o},a!=null&&a.duplex?{duplex:a.duplex}:{}));return l.ok?{data:{path:u},error:null}:{data:null,error:yield l.json()}}catch(i){if($e(i))return{data:null,error:i};throw i}})}upload(e,t,r){return We(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,s){return We(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),a=this._getFinalPath(i),o=new URL(this.url+`/object/upload/sign/${a}`);o.searchParams.set("token",t);try{let u;const c=Object.assign({upsert:Ka.upsert},s),l=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&r instanceof Blob?(u=new FormData,u.append("cacheControl",c.cacheControl),u.append("",r)):typeof FormData<"u"&&r instanceof FormData?(u=r,u.append("cacheControl",c.cacheControl)):(u=r,l["cache-control"]=`max-age=${c.cacheControl}`,l["content-type"]=c.contentType);const d=yield this.fetch(o.toString(),{method:"PUT",body:u,headers:l});return d.ok?{data:{path:i},error:null}:{data:null,error:yield d.json()}}catch(u){if($e(u))return{data:null,error:u};throw u}})}createSignedUploadUrl(e){return We(this,void 0,void 0,function*(){try{let t=this._getFinalPath(e);const r=yield Dt(this.fetch,`${this.url}/object/upload/sign/${t}`,{},{headers:this.headers}),s=new URL(this.url+r.url),i=s.searchParams.get("token");if(!i)throw new Zi("No token returned by API");return{data:{signedUrl:s.toString(),path:e,token:i},error:null}}catch(t){if($e(t))return{data:null,error:t};throw t}})}update(e,t,r){return We(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t){return We(this,void 0,void 0,function*(){try{return{data:yield Dt(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t},{headers:this.headers}),error:null}}catch(r){if($e(r))return{data:null,error:r};throw r}})}copy(e,t){return We(this,void 0,void 0,function*(){try{return{data:{path:(yield Dt(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t},{headers:this.headers})).Key},error:null}}catch(r){if($e(r))return{data:null,error:r};throw r}})}createSignedUrl(e,t,r){return We(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),i=yield Dt(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:t},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const a=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${a}`)},{data:i,error:null}}catch(s){if($e(s))return{data:null,error:s};throw s}})}createSignedUrls(e,t,r){return We(this,void 0,void 0,function*(){try{const s=yield Dt(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:s.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${i}`):null})),error:null}}catch(s){if($e(s))return{data:null,error:s};throw s}})}download(e,t){return We(this,void 0,void 0,function*(){const s=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),a=i?`?${i}`:"";try{const o=this._getFinalPath(e);return{data:yield(yield Ei(this.fetch,`${this.url}/${s}/${o}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if($e(o))return{data:null,error:o};throw o}})}getPublicUrl(e,t){const r=this._getFinalPath(e),s=[],i=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&s.push(i);const o=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",u=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});u!==""&&s.push(u);let c=s.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${r}${c}`)}}}remove(e){return We(this,void 0,void 0,function*(){try{return{data:yield qu(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if($e(t))return{data:null,error:t};throw t}})}list(e,t,r){return We(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},Xh),t),{prefix:e||""});return{data:yield Dt(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if($e(s))return{data:null,error:s};throw s}})}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const tf="2.5.1",rf={"X-Client-Info":`storage-js/${tf}`};var rr=globalThis&&globalThis.__awaiter||function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(l){try{c(r.next(l))}catch(d){a(d)}}function u(l){try{c(r.throw(l))}catch(d){a(d)}}function c(l){l.done?i(l.value):s(l.value).then(o,u)}c((r=r.apply(n,e||[])).next())})};class nf{constructor(e,t={},r){this.url=e,this.headers=Object.assign(Object.assign({},rf),t),this.fetch=Vu(r)}listBuckets(){return rr(this,void 0,void 0,function*(){try{return{data:yield Ei(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if($e(e))return{data:null,error:e};throw e}})}getBucket(e){return rr(this,void 0,void 0,function*(){try{return{data:yield Ei(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if($e(t))return{data:null,error:t};throw t}})}createBucket(e,t={public:!1}){return rr(this,void 0,void 0,function*(){try{return{data:yield Dt(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if($e(r))return{data:null,error:r};throw r}})}updateBucket(e,t){return rr(this,void 0,void 0,function*(){try{return{data:yield Qh(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if($e(r))return{data:null,error:r};throw r}})}emptyBucket(e){return rr(this,void 0,void 0,function*(){try{return{data:yield Dt(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if($e(t))return{data:null,error:t};throw t}})}deleteBucket(e){return rr(this,void 0,void 0,function*(){try{return{data:yield qu(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if($e(t))return{data:null,error:t};throw t}})}}class sf extends nf{constructor(e,t={},r){super(e,t,r)}from(e){return new ef(this.url,this.headers,e,this.fetch)}}const af="2.26.0",of={"X-Client-Info":`supabase-js/${af}`};var uf=globalThis&&globalThis.__awaiter||function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(l){try{c(r.next(l))}catch(d){a(d)}}function u(l){try{c(r.throw(l))}catch(d){a(d)}}function c(l){l.done?i(l.value):s(l.value).then(o,u)}c((r=r.apply(n,e||[])).next())})};const cf=n=>{let e;return n?e=n:typeof fetch>"u"?e=Hi:e=fetch,(...t)=>e(...t)},lf=()=>typeof Headers>"u"?zi.Headers:Headers,df=(n,e,t)=>{const r=cf(t),s=lf();return(i,a)=>uf(void 0,void 0,void 0,function*(){var o;const u=(o=yield e())!==null&&o!==void 0?o:n;let c=new s(a==null?void 0:a.headers);return c.has("apikey")||c.set("apikey",n),c.has("Authorization")||c.set("Authorization",`Bearer ${u}`),r(i,Object.assign(Object.assign({},a),{headers:c}))})};function hf(n){return n.replace(/\/$/,"")}function ff(n,e){const{db:t,auth:r,realtime:s,global:i}=n,{db:a,auth:o,realtime:u,global:c}=e;return{db:Object.assign(Object.assign({},a),t),auth:Object.assign(Object.assign({},o),r),realtime:Object.assign(Object.assign({},u),s),global:Object.assign(Object.assign({},c),i)}}function pf(n){return Math.round(Date.now()/1e3)+n}function mf(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=Math.random()*16|0;return(n=="x"?e:e&3|8).toString(16)})}const Et=()=>typeof document<"u",Bt={tested:!1,writable:!1},Dn=()=>{if(!Et())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Bt.tested)return Bt.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),Bt.tested=!0,Bt.writable=!0}catch{Bt.tested=!0,Bt.writable=!1}return Bt.writable};function ze(n,e){var t;e||(e=((t=window==null?void 0:window.location)===null||t===void 0?void 0:t.href)||""),n=n.replace(/[\[\]]/g,"\\$&");const r=new RegExp("[?&#]"+n+"(=([^&#]*)|&|#|$)"),s=r.exec(e);return s?s[2]?decodeURIComponent(s[2].replace(/\+/g," ")):"":null}const zu=n=>{let e;return n?e=n:typeof fetch>"u"?e=async(...t)=>await(await Te(()=>Promise.resolve().then(()=>ts),void 0)).fetch(...t):e=fetch,(...t)=>e(...t)},yf=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",jr=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},Tn=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},Ms=async(n,e)=>{await n.removeItem(e)};function gf(n){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let t="",r,s,i,a,o,u,c,l=0;for(n=n.replace("-","+").replace("_","/");l<n.length;)a=e.indexOf(n.charAt(l++)),o=e.indexOf(n.charAt(l++)),u=e.indexOf(n.charAt(l++)),c=e.indexOf(n.charAt(l++)),r=a<<2|o>>4,s=(o&15)<<4|u>>2,i=(u&3)<<6|c,t=t+String.fromCharCode(r),u!=64&&s!=0&&(t=t+String.fromCharCode(s)),c!=64&&i!=0&&(t=t+String.fromCharCode(i));return t}class ns{constructor(){this.promise=new ns.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}ns.promiseConstructor=Promise;function Za(n){const e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,t=n.split(".");if(t.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(t[1]))throw new Error("JWT is not valid: payload is not in base64url format");const r=t[1];return JSON.parse(gf(r))}function bf(n){return new Promise(e=>{setTimeout(()=>e(null),n)})}function _f(n,e){return new Promise((r,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const a=await n(i);if(!e(i,null,a)){r(a);return}}catch(a){if(!e(i,a)){s(a);return}}})()})}function vf(n){return("0"+n.toString(16)).substr(-2)}function Pn(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length;let s="";for(let i=0;i<56;i++)s+=t.charAt(Math.floor(Math.random()*r));return s}return crypto.getRandomValues(e),Array.from(e,vf).join("")}async function wf(n){const t=new TextEncoder().encode(n),r=await crypto.subtle.digest("SHA-256",t),s=new Uint8Array(r);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}function Of(n){return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function xn(n){if(typeof crypto>"u")return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const e=await wf(n);return Of(e)}class Ji extends Error{constructor(e,t){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t}}function oe(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class Ef extends Ji{constructor(e,t){super(e,t),this.name="AuthApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}function Af(n){return oe(n)&&n.name==="AuthApiError"}class Hu extends Ji{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Ar extends Ji{constructor(e,t,r){super(e),this.name=t,this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class nr extends Ar{constructor(){super("Auth session missing!","AuthSessionMissingError",400)}}class Fs extends Ar{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500)}}class Sn extends Ar{constructor(e){super(e,"AuthInvalidCredentialsError",400)}}class Ot extends Ar{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Bs extends Ar{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Ai extends Ar{constructor(e,t){super(e,"AuthRetryableFetchError",t)}}function Ja(n){return oe(n)&&n.name==="AuthRetryableFetchError"}var Tf=globalThis&&globalThis.__rest||function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t};const Kr=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),Pf=[502,503,504];async function Ga(n){if(!yf(n))throw new Ai(Kr(n),0);if(Pf.includes(n.status))throw new Ai(Kr(n),n.status);let e;try{e=await n.json()}catch(t){throw new Hu(Kr(t),t)}throw new Ef(Kr(e),n.status||500)}const xf=(n,e,t,r)=>{const s={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),t))};async function fe(n,e,t,r){var s;const i=Object.assign({},r==null?void 0:r.headers);r!=null&&r.jwt&&(i.Authorization=`Bearer ${r.jwt}`);const a=(s=r==null?void 0:r.query)!==null&&s!==void 0?s:{};r!=null&&r.redirectTo&&(a.redirect_to=r.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",u=await Sf(n,e,t+o,{headers:i,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(u):{data:Object.assign({},u),error:null}}async function Sf(n,e,t,r,s,i){const a=xf(e,r,s,i);let o;try{o=await n(t,a)}catch(u){throw console.error(u),new Ai(Kr(u),0)}if(o.ok||await Ga(o),r!=null&&r.noResolveJson)return o;try{return await o.json()}catch(u){await Ga(u)}}function kt(n){var e;let t=null;If(n)&&(t=Object.assign({},n),t.expires_at=pf(n.expires_in));const r=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:r},error:null}}function Kt(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function jf(n){return{data:n,error:null}}function kf(n){const{action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:i}=n,a=Tf(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:i},u=Object.assign({},a);return{data:{properties:o,user:u},error:null}}function Cf(n){return n}function If(n){return n.access_token&&n.refresh_token&&n.expires_in}var Rf=globalThis&&globalThis.__rest||function(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t};class Df{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=zu(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await fe(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(oe(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await fe(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Kt})}catch(r){if(oe(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=Rf(e,["options"]),s=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(s.new_email=r==null?void 0:r.newEmail,delete s.newEmail),await fe(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:kf,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(oe(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await fe(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Kt})}catch(t){if(oe(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,s,i,a,o,u;try{const c={nextPage:null,lastPage:0,total:0},l=await fe(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(i=(s=e==null?void 0:e.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:Cf});if(l.error)throw l.error;const d=await l.json(),h=(a=l.headers.get("x-total-count"))!==null&&a!==void 0?a:0,g=(u=(o=l.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&u!==void 0?u:[];return g.length>0&&(g.forEach(f=>{const b=parseInt(f.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(f.split(";")[1].split("=")[1]);c[`${y}Page`]=b}),c.total=parseInt(h)),{data:Object.assign(Object.assign({},d),c),error:null}}catch(c){if(oe(c))return{data:{users:[]},error:c};throw c}}async getUserById(e){try{return await fe(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Kt})}catch(t){if(oe(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await fe(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Kt})}catch(r){if(oe(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){try{return await fe(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Kt})}catch(r){if(oe(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){try{const{data:t,error:r}=await fe(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:t,error:r}}catch(t){if(oe(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await fe(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(oe(t))return{data:null,error:t};throw t}}}const Nf="2.42.0",Lf="http://localhost:9999",$f="supabase.auth.token",Uf={"X-Client-Info":`gotrue-js/${Nf}`},Ya=10,Wa={getItem:n=>Dn()?globalThis.localStorage.getItem(n):null,setItem:(n,e)=>{Dn()&&globalThis.localStorage.setItem(n,e)},removeItem:n=>{Dn()&&globalThis.localStorage.removeItem(n)}};function Mf(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}Mf();const Ff={url:Lf,storageKey:$f,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Uf,flowType:"implicit",debug:!1},jn=30*1e3,Qa=3;class Qr{constructor(e){var t;this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.broadcastChannel=null,this.instanceID=Qr.nextInstanceID,Qr.nextInstanceID+=1,this.instanceID>0&&Et()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const r=Object.assign(Object.assign({},Ff),e);if(this.logDebugMessages=r.debug,this.inMemorySession=null,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.persistSession=r.persistSession,this.storage=r.storage||Wa,this.admin=new Df({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=zu(r.fetch),this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession&&this.storage===Wa&&!Dn()&&console.warn(`No storage option exists to persist the session, which may result in unexpected behavior when using auth.
        If you want to set persistSession to true, please provide a storage option or you may set persistSession to false to disable this warning.`),Et()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(t=this.broadcastChannel)===null||t===void 0||t.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&console.log(`GoTrueClient@${this.instanceID} ${new Date().toISOString()}`,...e),this}initialize(){return this.initializePromise||(this.initializePromise=this._initialize()),this.initializePromise}async _initialize(){if(this.initializePromise)return this.initializePromise;try{const e=Et()?await this._isPKCEFlow():!1;if(this._debug("#_initialize()","begin","is PKCE flow",e),e||this.detectSessionInUrl&&this._isImplicitGrantFlow()){const{data:t,error:r}=await this._getSessionFromUrl(e);if(r)return this._debug("#_initialize()","error detecting session from URL",r),await this._removeSession(),{error:r};const{session:s,redirectType:i}=t;return this._debug("#_initialize()","detected session in URL",s,"redirect type",i),await this._saveSession(s),setTimeout(async()=>{i==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",s):await this._notifyAllSubscribers("SIGNED_IN",s)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){return oe(e)?{error:e}:{error:new Hu("Unexpected error during initialization",e)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signUp(e){var t,r,s;try{await this._removeSession();let i;if("email"in e){const{email:l,password:d,options:h}=e;let g=null,f=null;if(this.flowType==="pkce"){const b=Pn();await jr(this.storage,`${this.storageKey}-code-verifier`,b),g=await xn(b),f=b===g?"plain":"s256"}i=await fe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:l,password:d,data:(t=h==null?void 0:h.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:g,code_challenge_method:f},xform:kt})}else if("phone"in e){const{phone:l,password:d,options:h}=e;i=await fe(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:l,password:d,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},channel:(s=h==null?void 0:h.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:kt})}else throw new Sn("You must provide either an email or phone number and a password");const{data:a,error:o}=i;if(o||!a)return{data:{user:null,session:null},error:o};const u=a.session,c=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:c,session:u},error:null}}catch(i){if(oe(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{await this._removeSession();let t;if("email"in e){const{email:i,password:a,options:o}=e;t=await fe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:kt})}else if("phone"in e){const{phone:i,password:a,options:o}=e;t=await fe(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:a,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:kt})}else throw new Sn("You must provide either an email or phone number and a password");const{data:r,error:s}=t;return s?{data:{user:null,session:null},error:s}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new Fs}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:{user:r.user,session:r.session},error:s})}catch(t){if(oe(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,r,s,i;return await this._removeSession(),await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){const t=await Tn(this.storage,`${this.storageKey}-code-verifier`),{data:r,error:s}=await fe(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:t},xform:kt});return await Ms(this.storage,`${this.storageKey}-code-verifier`),s?{data:{user:null,session:null},error:s}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new Fs}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:r,error:s})}async signInWithIdToken(e){await this._removeSession();try{const{options:t,provider:r,token:s,access_token:i,nonce:a}=e,o=await fe(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:i,nonce:a,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:kt}),{data:u,error:c}=o;return c?{data:{user:null,session:null},error:c}:!u||!u.session||!u.user?{data:{user:null,session:null},error:new Fs}:(u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",u.session)),{data:u,error:c})}catch(t){if(oe(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,r,s,i,a;try{if(await this._removeSession(),"email"in e){const{email:o,options:u}=e;let c=null,l=null;if(this.flowType==="pkce"){const h=Pn();await jr(this.storage,`${this.storageKey}-code-verifier`,h),c=await xn(h),l=h===c?"plain":"s256"}const{error:d}=await fe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(t=u==null?void 0:u.data)!==null&&t!==void 0?t:{},create_user:(r=u==null?void 0:u.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},code_challenge:c,code_challenge_method:l},redirectTo:u==null?void 0:u.emailRedirectTo});return{data:{user:null,session:null},error:d}}if("phone"in e){const{phone:o,options:u}=e,{data:c,error:l}=await fe(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(s=u==null?void 0:u.data)!==null&&s!==void 0?s:{},create_user:(i=u==null?void 0:u.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken},channel:(a=u==null?void 0:u.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:l}}throw new Sn("You must provide either an email or phone number.")}catch(o){if(oe(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(e){var t,r;try{e.type!=="email_change"&&e.type!=="phone_change"&&await this._removeSession();const{data:s,error:i}=await fe(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:(t=e.options)===null||t===void 0?void 0:t.captchaToken}}),redirectTo:(r=e.options)===null||r===void 0?void 0:r.redirectTo,xform:kt});if(i)throw i;if(!s)throw new Error("An error occurred on token verification.");const a=s.session,o=s.user;return a!=null&&a.access_token&&(await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)),{data:{user:o,session:a},error:null}}catch(s){if(oe(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(e){var t,r,s;try{return await this._removeSession(),await fe(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((s=e==null?void 0:e.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0}),headers:this.headers,xform:jf})}catch(i){if(oe(i))return{data:null,error:i};throw i}}async reauthenticate(){try{const{data:{session:e},error:t}=await this.getSession();if(t)throw t;if(!e)throw new nr;const{error:r}=await fe(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:e.access_token});return{data:{user:null,session:null},error:r}}catch(e){if(oe(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{e.type!="email_change"&&e.type!="phone_change"&&await this._removeSession();const t=`${this.url}/resend`;if("email"in e){const{email:r,type:s,options:i}=e,{error:a}=await fe(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in e){const{phone:r,type:s,options:i}=e,{data:a,error:o}=await fe(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:a==null?void 0:a.message_id},error:o}}throw new Sn("You must provide either an email or phone number and a type")}catch(t){if(oe(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){await this.initializePromise,this._debug("#getSession()","begin");try{let e=null;if(this.persistSession){const i=await Tn(this.storage,this.storageKey);this._debug("#getSession()","session from storage",i),i!==null&&(this._isValidSession(i)?e=i:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession()))}else e=this.inMemorySession,this._debug("#getSession()","session from memory",e);if(!e)return{data:{session:null},error:null};const t=e.expires_at?e.expires_at<=Date.now()/1e3:!1;if(this._debug("#getSession()",`session has${t?"":" not"} expired`,"expires_at",e.expires_at),!t)return{data:{session:e},error:null};const{session:r,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{session:null},error:s}:{data:{session:r},error:null}}finally{this._debug("#getSession()","end")}}async getUser(e){var t,r;try{if(!e){const{data:s,error:i}=await this.getSession();if(i)throw i;e=(r=(t=s.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:void 0}return await fe(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Kt})}catch(s){if(oe(s))return{data:{user:null},error:s};throw s}}async updateUser(e,t={}){try{const{data:r,error:s}=await this.getSession();if(s)throw s;if(!r.session)throw new nr;const i=r.session,{data:a,error:o}=await fe(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:e,jwt:i.access_token,xform:Kt});if(o)throw o;return i.user=a.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}}catch(r){if(oe(r))return{data:{user:null},error:r};throw r}}_decodeJWT(e){return Za(e)}async setSession(e){try{if(!e.access_token||!e.refresh_token)throw new nr;const t=Date.now()/1e3;let r=t,s=!0,i=null;const a=Za(e.access_token);if(a.exp&&(r=a.exp,s=r<=t),s){const{session:o,error:u}=await this._callRefreshToken(e.refresh_token);if(u)return{data:{user:null,session:null},error:u};if(!o)return{data:{user:null,session:null},error:null};i=o}else{const{data:o,error:u}=await this.getUser(e.access_token);if(u)throw u;i={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(t){if(oe(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){var t;try{if(!e){const{data:i,error:a}=await this.getSession();if(a)throw a;e=(t=i.session)!==null&&t!==void 0?t:void 0}if(!(e!=null&&e.refresh_token))throw new nr;const{session:r,error:s}=await this._callRefreshToken(e.refresh_token);return s?{data:{user:null,session:null},error:s}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}}catch(r){if(oe(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromUrl(e){try{if(!Et())throw new Ot("No browser detected.");if(this.flowType==="implicit"&&!this._isImplicitGrantFlow())throw new Ot("Not a valid implicit grant flow url.");if(this.flowType=="pkce"&&!e)throw new Bs("Not a valid PKCE flow url.");if(e){const y=ze("code");if(!y)throw new Bs("No code detected.");const{data:T,error:k}=await this.exchangeCodeForSession(y);if(k)throw k;if(!T.session)throw new Bs("No session detected.");let S=new URL(window.location.href);return S.searchParams.delete("code"),window.history.replaceState(window.history.state,"",S.toString()),{data:{session:T.session,redirectType:null},error:null}}const t=ze("error_description");if(t){const y=ze("error_code");if(!y)throw new Ot("No error_code detected.");const T=ze("error");throw T?new Ot(t,{error:T,code:y}):new Ot("No error detected.")}const r=ze("provider_token"),s=ze("provider_refresh_token"),i=ze("access_token");if(!i)throw new Ot("No access_token detected.");const a=ze("expires_in");if(!a)throw new Ot("No expires_in detected.");const o=ze("refresh_token");if(!o)throw new Ot("No refresh_token detected.");const u=ze("token_type");if(!u)throw new Ot("No token_type detected.");const l=Math.round(Date.now()/1e3)+parseInt(a),{data:d,error:h}=await this.getUser(i);if(h)throw h;const g=d.user,f={provider_token:r,provider_refresh_token:s,access_token:i,expires_in:parseInt(a),expires_at:l,refresh_token:o,token_type:u,user:g},b=ze("type");return window.location.hash="",this._debug("#_getSessionFromUrl()","clearing window.location.hash"),{data:{session:f,redirectType:b},error:null}}catch(t){if(oe(t))return{data:{session:null,redirectType:null},error:t};throw t}}_isImplicitGrantFlow(){return Et()&&(!!ze("access_token")||!!ze("error_description"))}async _isPKCEFlow(){const e=await Tn(this.storage,`${this.storageKey}-code-verifier`);return!!ze("code")&&!!e}async signOut({scope:e}={scope:"global"}){var t;const{data:r,error:s}=await this.getSession();if(s)return{error:s};const i=(t=r.session)===null||t===void 0?void 0:t.access_token;if(i){const{error:a}=await this.admin.signOut(i,e);if(a&&!(Af(a)&&(a.status===404||a.status===401)))return{error:a}}return e!=="others"&&(await this._removeSession(),await Ms(this.storage,`${this.storageKey}-code-verifier`),await this._notifyAllSubscribers("SIGNED_OUT",null)),{error:null}}onAuthStateChange(e){const t=mf(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),this._emitInitialSession(t),{data:{subscription:r}}}async _emitInitialSession(e){var t,r;try{const{data:{session:s},error:i}=await this.getSession();if(i)throw i;await((t=this.stateChangeEmitters.get(e))===null||t===void 0?void 0:t.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(s){await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",s),console.error(s)}}async resetPasswordForEmail(e,t={}){let r=null,s=null;if(this.flowType==="pkce"){const i=Pn();await jr(this.storage,`${this.storageKey}-code-verifier`,i),r=await xn(i),s=i===r?"plain":"s256"}try{return await fe(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(oe(i))return{data:null,error:i};throw i}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await _f(async s=>(await bf(s*200),this._debug(t,"refreshing attempt",s),await fe(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:kt})),(s,i,a)=>a&&a.error&&Ja(a.error)&&Date.now()+(s+1)*200-r<jn)}catch(r){if(this._debug(t,"error",r),oe(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),Et()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const r=await Tn(this.storage,this.storageKey);if(this._debug(t,"session from storage",r),!this._isValidSession(r)){this._debug(t,"session is not valid"),r!==null&&await this._removeSession();return}const s=Math.round(Date.now()/1e3),i=((e=r.expires_at)!==null&&e!==void 0?e:1/0)<s+Ya;if(this._debug(t,`session has${i?"":" not"} expired with margin of ${Ya}s`),i){if(this.autoRefreshToken&&r.refresh_token){const{error:a}=await this._callRefreshToken(r.refresh_token);a&&(console.error(a),Ja(a)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(t,"error",r),console.error(r);return}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new nr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new ns;const{data:i,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!i.session)throw new nr;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const o={session:i.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(i){if(this._debug(s,"error",i),oe(i)){const a={session:null,error:i};return(t=this.refreshingDeferred)===null||t===void 0||t.resolve(a),a}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,r=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,t)}catch(u){i.push(u)}});if(await Promise.all(a),i.length>0){for(let o=0;o<i.length;o+=1)console.error(i[o]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.persistSession||(this.inMemorySession=e),this.persistSession&&e.expires_at&&await this._persistSession(e)}_persistSession(e){return this._debug("#_persistSession()",e),jr(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),this.persistSession?await Ms(this.storage,this.storageKey):this.inMemorySession=null}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Et()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),jn);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),await this._autoRefreshTokenTick()}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{const e=Date.now();try{const{data:{session:t}}=await this.getSession();if(!t||!t.refresh_token||!t.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((t.expires_at*1e3-e)/jn);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${jn}ms, refresh threshold is ${Qa} ticks`),r<=Qa&&await this._callRefreshToken(t.refresh_token)}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Et()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){this._debug(`#_onVisibilityChanged(${e})`,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(e||(await this.initializePromise,await this._recoverAndRefresh(),this._debug("#_onVisibilityChanged()","finished waiting for initialize, _recoverAndRefresh")),this.autoRefreshToken&&this._startAutoRefresh()):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t){const r=[`provider=${encodeURIComponent(e)}`];if(t!=null&&t.redirectTo&&r.push(`redirect_to=${encodeURIComponent(t.redirectTo)}`),t!=null&&t.scopes&&r.push(`scopes=${encodeURIComponent(t.scopes)}`),this.flowType==="pkce"){const s=Pn();await jr(this.storage,`${this.storageKey}-code-verifier`,s);const i=await xn(s),a=s===i?"plain":"s256";this._debug("PKCE","code verifier",`${s.substring(0,5)}...`,"code challenge",i,"method",a);const o=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(a)}`});r.push(o.toString())}if(t!=null&&t.queryParams){const s=new URLSearchParams(t.queryParams);r.push(s.toString())}return`${this.url}/authorize?${r.join("&")}`}async _unenroll(e){var t;try{const{data:r,error:s}=await this.getSession();return s?{data:null,error:s}:await fe(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(t=r==null?void 0:r.session)===null||t===void 0?void 0:t.access_token})}catch(r){if(oe(r))return{data:null,error:r};throw r}}async _enroll(e){var t,r;try{const{data:s,error:i}=await this.getSession();if(i)return{data:null,error:i};const{data:a,error:o}=await fe(this.fetch,"POST",`${this.url}/factors`,{body:{friendly_name:e.friendlyName,factor_type:e.factorType,issuer:e.issuer},headers:this.headers,jwt:(t=s==null?void 0:s.session)===null||t===void 0?void 0:t.access_token});return o?{data:null,error:o}:(!((r=a==null?void 0:a.totp)===null||r===void 0)&&r.qr_code&&(a.totp.qr_code=`data:image/svg+xml;utf-8,${a.totp.qr_code}`),{data:a,error:null})}catch(s){if(oe(s))return{data:null,error:s};throw s}}async _verify(e){var t;try{const{data:r,error:s}=await this.getSession();if(s)return{data:null,error:s};const{data:i,error:a}=await fe(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(t=r==null?void 0:r.session)===null||t===void 0?void 0:t.access_token});return a?{data:null,error:a}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:a})}catch(r){if(oe(r))return{data:null,error:r};throw r}}async _challenge(e){var t;try{const{data:r,error:s}=await this.getSession();return s?{data:null,error:s}:await fe(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{headers:this.headers,jwt:(t=r==null?void 0:r.session)===null||t===void 0?void 0:t.access_token})}catch(r){if(oe(r))return{data:null,error:r};throw r}}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const r=(e==null?void 0:e.factors)||[],s=r.filter(i=>i.factor_type==="totp"&&i.status==="verified");return{data:{all:r,totp:s},error:null}}async _getAuthenticatorAssuranceLevel(){var e,t;const{data:{session:r},error:s}=await this.getSession();if(s)return{data:null,error:s};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const i=this._decodeJWT(r.access_token);let a=null;i.aal&&(a=i.aal);let o=a;((t=(e=r.user.factors)===null||e===void 0?void 0:e.filter(l=>l.status==="verified"))!==null&&t!==void 0?t:[]).length>0&&(o="aal2");const c=i.amr||[];return{data:{currentLevel:a,nextLevel:o,currentAuthenticationMethods:c},error:null}}}Qr.nextInstanceID=0;class Bf extends Qr{constructor(e){super(e)}}var Vf=globalThis&&globalThis.__awaiter||function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(l){try{c(r.next(l))}catch(d){a(d)}}function u(l){try{c(r.throw(l))}catch(d){a(d)}}function c(l){l.done?i(l.value):s(l.value).then(o,u)}c((r=r.apply(n,e||[])).next())})};const qf={headers:of},zf={schema:"public"},Hf={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},Kf={};class Zf{constructor(e,t,r){var s,i,a,o,u,c,l,d;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const h=hf(e);this.realtimeUrl=`${h}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${h}/auth/v1`,this.storageUrl=`${h}/storage/v1`,this.functionsUrl=`${h}/functions/v1`;const g=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,f={db:zf,realtime:Kf,auth:Object.assign(Object.assign({},Hf),{storageKey:g}),global:qf},b=ff(r??{},f);this.storageKey=(i=(s=b.auth)===null||s===void 0?void 0:s.storageKey)!==null&&i!==void 0?i:"",this.headers=(o=(a=b.global)===null||a===void 0?void 0:a.headers)!==null&&o!==void 0?o:{},this.auth=this._initSupabaseAuthClient((u=b.auth)!==null&&u!==void 0?u:{},this.headers,(c=b.global)===null||c===void 0?void 0:c.fetch),this.fetch=df(t,this._getAccessToken.bind(this),(l=b.global)===null||l===void 0?void 0:l.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},b.realtime)),this.rest=new hh(`${h}/rest/v1`,{headers:this.headers,schema:(d=b.db)===null||d===void 0?void 0:d.schema,fetch:this.fetch}),this._listenForAuthEvents()}get functions(){return new ah(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new sf(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}rpc(e,t={},r){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return Vf(this,void 0,void 0,function*(){const{data:r}=yield this.auth.getSession();return(t=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,storageKey:i,flowType:a},o,u){const c={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Bf({url:this.authUrl,headers:Object.assign(Object.assign({},c),o),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,flowType:a,fetch:u})}_initRealtimeClient(e){return new Zh(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.realtime.setAuth(r??null),this.changedAccessToken=r):e==="SIGNED_OUT"&&(this.realtime.setAuth(this.supabaseKey),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Gt=(n,e,t)=>new Zf(n,e,t);function Xa(n){return Array.isArray(n)?n:[n]}function Jf(n){let e,t,r,s=!1;return function(a){e===void 0?(e=a,t=0,r=-1):e=Yf(e,a);const o=e.length;let u=0;for(;t<o;){s&&(e[t]===10&&(u=++t),s=!1);let c=-1;for(;t<o&&c===-1;++t)switch(e[t]){case 58:r===-1&&(r=t-u);break;case 13:s=!0;case 10:c=t;break}if(c===-1)break;n(e.subarray(u,c),r),u=t,r=-1}u===o?e=void 0:u!==0&&(e=e.subarray(u),t-=u)}}function Gf(n,e,t){let r=eo();const s=new TextDecoder;return function(a,o){if(a.length===0)t==null||t(r),r=eo();else if(o>0){const u=s.decode(a.subarray(0,o)),c=o+(a[o+1]===32?2:1),l=s.decode(a.subarray(c));switch(u){case"data":r.data=r.data?r.data+`
`+l:l;break;case"event":r.event=l;break;case"id":n(r.id=l);break;case"retry":const d=parseInt(l,10);isNaN(d)||e(r.retry=d);break}}}}function Yf(n,e){const t=new Uint8Array(n.length+e.length);return t.set(n),t.set(e,n.length),t}function eo(){return{data:"",event:"",id:"",retry:void 0}}var Wf="https://api-inference.huggingface.co/models/",Ku=(n=>(n.Length="length",n.EndOfSequenceToken="eos_token",n.StopSequence="stop_sequence",n))(Ku||{}),Zu=class{constructor(n="",e={}){ht(this,"apiKey");ht(this,"defaultOptions");this.apiKey=n,this.defaultOptions=e}async fillMask(n,e){const t=await this.request(n,e);if(!(Array.isArray(t)&&t.every(s=>typeof s.score=="number"&&typeof s.sequence=="string"&&typeof s.token=="number"&&typeof s.token_str=="string")))throw new TypeError("Invalid inference output: output must be of type Array<score: number, sequence:string, token:number, token_str:string>");return t}async summarization(n,e){const t=await this.request(n,e);if(!(Array.isArray(t)&&t.every(s=>typeof s.summary_text=="string")))throw new TypeError("Invalid inference output: output must be of type Array<summary_text: string>");return t==null?void 0:t[0]}async questionAnswer(n,e){const t=await this.request(n,e);if(!(typeof t.answer=="string"&&typeof t.end=="number"&&typeof t.score=="number"&&typeof t.start=="number"))throw new TypeError("Invalid inference output: output must be of type <answer: string, end: number, score: number, start: number>");return t}async tableQuestionAnswer(n,e){const t=await this.request(n,e);if(!(typeof t.aggregator=="string"&&typeof t.answer=="string"&&Array.isArray(t.cells)&&t.cells.every(s=>typeof s=="string")&&Array.isArray(t.coordinates)&&t.coordinates.every(s=>Array.isArray(s)&&s.every(i=>typeof i=="number"))))throw new TypeError("Invalid inference output: output must be of type <aggregator: string, answer: string, cells: string[], coordinates: number[][]>");return t}async textClassification(n,e){var s;const t=(s=await this.request(n,e))==null?void 0:s[0];if(!(Array.isArray(t)&&t.every(i=>typeof i.label=="string"&&typeof i.score=="number")))throw new TypeError("Invalid inference output: output must be of type Array<label: string, score: number>");return t}async textGeneration(n,e){const t=await this.request(n,e);if(!(Array.isArray(t)&&t.every(s=>typeof s.generated_text=="string")))throw new TypeError("Invalid inference output: output must be of type Array<generated_text: string>");return t==null?void 0:t[0]}async*textGenerationStream(n,e){yield*this.streamingRequest(n,e)}async tokenClassification(n,e){const t=Xa(await this.request(n,e));if(!(Array.isArray(t)&&t.every(s=>typeof s.end=="number"&&typeof s.entity_group=="string"&&typeof s.score=="number"&&typeof s.start=="number"&&typeof s.word=="string")))throw new TypeError("Invalid inference output: output must be of type Array<end: number, entity_group: string, score: number, start: number, word: string>");return t}async translation(n,e){const t=await this.request(n,e);if(!(Array.isArray(t)&&t.every(s=>typeof s.translation_text=="string")))throw new TypeError("Invalid inference output: output must be of type Array<translation_text: string>");return t==null?void 0:t[0]}async zeroShotClassification(n,e){const t=Xa(await this.request(n,e));if(!(Array.isArray(t)&&t.every(s=>Array.isArray(s.labels)&&s.labels.every(i=>typeof i=="string")&&Array.isArray(s.scores)&&s.scores.every(i=>typeof i=="number")&&typeof s.sequence=="string")))throw new TypeError("Invalid inference output: output must be of type Array<labels: string[], scores: number[], sequence: string>");return t}async conversational(n,e){const t=await this.request(n,e);if(!(Array.isArray(t.conversation.generated_responses)&&t.conversation.generated_responses.every(s=>typeof s=="string")&&Array.isArray(t.conversation.past_user_inputs)&&t.conversation.past_user_inputs.every(s=>typeof s=="string")&&typeof t.generated_text=="string"&&Array.isArray(t.warnings)&&t.warnings.every(s=>typeof s=="string")))throw new TypeError("Invalid inference output: output must be of type <conversation: {generated_responses: string[], past_user_inputs: string[]}, generated_text: string, warnings: string[]>");return t}async featureExtraction(n,e){return await this.request(n,e)}async automaticSpeechRecognition(n,e){const t=await this.request(n,{...e,binary:!0});if(!(typeof t.text=="string"))throw new TypeError("Invalid inference output: output must be of type <text: string>");return t}async audioClassification(n,e){const t=await this.request(n,{...e,binary:!0});if(!(Array.isArray(t)&&t.every(s=>typeof s.label=="string"&&typeof s.score=="number")))throw new TypeError("Invalid inference output: output must be of type Array<label: string, score: number>");return t}async imageClassification(n,e){const t=await this.request(n,{...e,binary:!0});if(!(Array.isArray(t)&&t.every(s=>typeof s.label=="string"&&typeof s.score=="number")))throw new TypeError("Invalid inference output: output must be of type Array<label: string, score: number>");return t}async objectDetection(n,e){const t=await this.request(n,{...e,binary:!0});if(!(Array.isArray(t)&&t.every(s=>typeof s.label=="string"&&typeof s.score=="number"&&typeof s.box.xmin=="number"&&typeof s.box.ymin=="number"&&typeof s.box.xmax=="number"&&typeof s.box.ymax=="number")))throw new TypeError("Invalid inference output: output must be of type Array<{label:string; score:number; box:{xmin:number; ymin:number; xmax:number; ymax:number}}>");return t}async imageSegmentation(n,e){const t=await this.request(n,{...e,binary:!0});if(!(Array.isArray(t)&&t.every(s=>typeof s.label=="string"&&typeof s.mask=="string"&&typeof s.score=="number")))throw new TypeError("Invalid inference output: output must be of type Array<label: string, mask: string, score: number>");return t}async textToImage(n,e){const t=await this.request(n,{...e,blob:!0});if(!(t&&t instanceof Blob))throw new TypeError("Invalid inference output: output must be of type object & of instance Blob");return t}async imageToText(n,e){var t;return(t=await this.request(n,{...e,binary:!0}))==null?void 0:t[0]}makeRequestOptions(n,e){const t={...this.defaultOptions,...e},{model:r,...s}=n,i={};this.apiKey&&(i.Authorization=`Bearer ${this.apiKey}`),e!=null&&e.binary||(i["Content-Type"]="application/json"),e!=null&&e.binary&&(t.wait_for_model&&(i["X-Wait-For-Model"]="true"),t.use_cache===!1&&(i["X-Use-Cache"]="false"),t.dont_load_model&&(i["X-Load-Model"]="0"));const a=`${Wf}${r}`,o={headers:i,method:"POST",body:e!=null&&e.binary?n.data:JSON.stringify({...s,options:t}),credentials:e!=null&&e.includeCredentials?"include":"same-origin"};return{url:a,info:o,mergedOptions:t}}async request(n,e){const{url:t,info:r,mergedOptions:s}=this.makeRequestOptions(n,e),i=await fetch(t,r);if(s.retry_on_error!==!1&&i.status===503&&!s.wait_for_model)return this.request(n,{...s,wait_for_model:!0});if(e!=null&&e.blob){if(!i.ok)throw new Error("An error occurred while fetching the blob");return await i.blob()}const a=await i.json();if(a.error)throw new Error(a.error);return a}async*streamingRequest(n,e){var l;const{url:t,info:r,mergedOptions:s}=this.makeRequestOptions({...n,stream:!0},e),i=await fetch(t,r);if(s.retry_on_error!==!1&&i.status===503&&!s.wait_for_model)return this.streamingRequest(n,{...s,wait_for_model:!0});if(!i.ok){if((l=i.headers.get("Content-Type"))!=null&&l.startsWith("application/json")){const d=await i.json();if(d.error)throw new Error(d.error)}throw new Error(`Server response contains error: ${i.status}`)}if(i.headers.get("content-type")!=="text/event-stream")throw new Error("Server does not support event stream content type, it returned "+i.headers.get("content-type"));if(!i.body)return;const a=i.body.getReader();let o=[];const c=Jf(Gf(()=>{},()=>{},d=>{o.push(d)}));try{for(;;){const{done:d,value:h}=await a.read();if(d)return;c(h);for(const g of o)g.data.length>0&&(yield JSON.parse(g.data));o=[]}}finally{a.releaseLock()}}};const Qf=Object.freeze(Object.defineProperty({__proto__:null,HfInference:Zu,TextGenerationStreamFinishReason:Ku},Symbol.toStringTag,{value:"Module"}));class Ju{constructor(e){Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.caller=new Vi(e??{})}}const Xf=()=>typeof window<"u"&&typeof window.document<"u",ep=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",tp=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom")),Gu=()=>typeof Deno<"u",Yu=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!Gu(),Gi=()=>{let n;return Xf()?n="browser":Yu()?n="node":ep()?n="webworker":tp()?n="jsdom":Gu()?n="deno":n="other",n};let Vs;async function rp(){return Vs===void 0&&(Vs={library:"langchain-js",runtime:Gi()}),Vs}function Ce(n){var e;try{return typeof process<"u"?(e=process.env)==null?void 0:e[n]:void 0}catch{return}}class Kn extends Ju{constructor(e){super(e??{}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.model=(e==null?void 0:e.model)??"sentence-transformers/distilbert-base-nli-mean-tokens",this.apiKey=(e==null?void 0:e.apiKey)??Ce("HUGGINGFACEHUB_API_KEY"),this.client=new Zu(this.apiKey)}async _embed(e){const t=e.map(r=>r.replace(/\n/g," "));return this.caller.call(()=>this.client.featureExtraction({model:this.model,inputs:t}))}embedQuery(e){return this._embed([e]).then(t=>t[0])}embedDocuments(e){return this._embed(e)}}const Wu="__run";class ss extends ct{get text(){return this.content}constructor(e,t){typeof e=="string"&&(e={content:e,additional_kwargs:t}),e.additional_kwargs||(e.additional_kwargs={}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","schema"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"content",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"additional_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.content=e.content,this.additional_kwargs=e.additional_kwargs}toDict(){return{type:this._getType(),data:this.toJSON().kwargs}}}class Qu extends ss{_getType(){return"human"}}class Xu extends ss{_getType(){return"ai"}}class np extends ss{_getType(){return"system"}}class nw extends ss{constructor(e,t){typeof e=="string"&&(e={content:e,role:t}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}_getType(){return"generic"}}class ec extends ct{}class sp{}class ip{}class ap extends sp{constructor(e){super(),Object.defineProperty(this,"vectorStore",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"k",{enumerable:!0,configurable:!0,writable:!0,value:4}),Object.defineProperty(this,"filter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.vectorStore=e.vectorStore,this.k=e.k??this.k,this.filter=e.filter}async getRelevantDocuments(e){return await this.vectorStore.similaritySearch(e,this.k,this.filter)}async addDocuments(e,t){return this.vectorStore.addDocuments(e,t)}}class op{constructor(e,t){Object.defineProperty(this,"embeddings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.embeddings=e}async delete(e){throw new Error("Not implemented.")}async similaritySearch(e,t=4,r=void 0){return(await this.similaritySearchVectorWithScore(await this.embeddings.embedQuery(e),t,r)).map(i=>i[0])}async similaritySearchWithScore(e,t=4,r=void 0){return this.similaritySearchVectorWithScore(await this.embeddings.embedQuery(e),t,r)}static fromTexts(e,t,r,s){throw new Error("the Langchain vectorstore implementation you are using forgot to override this, please report a bug")}static fromDocuments(e,t,r){throw new Error("the Langchain vectorstore implementation you are using forgot to override this, please report a bug")}asRetriever(e,t){return new ap({vectorStore:this,k:e,filter:t})}}class Wt extends op{constructor(e,t){super(e,t),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tableName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queryName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.client=t.client,this.tableName=t.tableName||"documents",this.queryName=t.queryName||"match_documents",this.filter=t.filter}async addDocuments(e,t){const r=e.map(({pageContent:s})=>s);return this.addVectors(await this.embeddings.embedDocuments(r),e,t)}async addVectors(e,t,r){const s=e.map((o,u)=>({content:t[u].pageContent,embedding:o,metadata:t[u].metadata})),i=500;let a=[];for(let o=0;o<s.length;o+=i){const u=s.slice(o,o+i).map(l=>r!=null&&r.ids?{id:r.ids[o],...l}:l),c=await this.client.from(this.tableName).upsert(u).select();if(c.error)throw new Error(`Error inserting: ${c.error.message} ${c.status} ${c.statusText}`);c.data&&(a=a.concat(c.data.map(l=>l.id)))}return a}async delete(e){const{ids:t}=e;for(const r of t)await this.client.from(this.tableName).delete().eq("id",r)}async similaritySearchVectorWithScore(e,t,r){if(r&&this.filter)throw new Error("cannot provide both `filter` and `this.filter`");const s=r??this.filter??{},i={query_embedding:e};let a;if(typeof s=="function")a=d=>s(d).limit(t);else if(typeof s=="object")i.filter=s,i.match_count=t,a=d=>d;else throw new Error("invalid filter type");const o=this.client.rpc(this.queryName,i),{data:u,error:c}=await a(o);if(c)throw new Error(`Error searching for documents: ${c.code} ${c.message} ${c.details}`);return u.map(d=>[new Gr({metadata:d.metadata,pageContent:d.content}),d.similarity])}static async fromTexts(e,t,r,s){const i=[];for(let a=0;a<e.length;a+=1){const o=Array.isArray(t)?t[a]:t,u=new Gr({pageContent:e[a],metadata:o});i.push(u)}return Wt.fromDocuments(i,r,s)}static async fromDocuments(e,t,r){const s=new this(t,r);return await s.addDocuments(e),s}static async fromExistingIndex(e,t){return new this(e,t)}}var Ti={},tc={},Yi={exports:{}},rc=function(e,t){return function(){for(var s=new Array(arguments.length),i=0;i<s.length;i++)s[i]=arguments[i];return e.apply(t,s)}},up=rc,Ft=Object.prototype.toString;function Wi(n){return Array.isArray(n)}function Pi(n){return typeof n>"u"}function cp(n){return n!==null&&!Pi(n)&&n.constructor!==null&&!Pi(n.constructor)&&typeof n.constructor.isBuffer=="function"&&n.constructor.isBuffer(n)}function nc(n){return Ft.call(n)==="[object ArrayBuffer]"}function lp(n){return Ft.call(n)==="[object FormData]"}function dp(n){var e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(n):e=n&&n.buffer&&nc(n.buffer),e}function hp(n){return typeof n=="string"}function fp(n){return typeof n=="number"}function sc(n){return n!==null&&typeof n=="object"}function Nn(n){if(Ft.call(n)!=="[object Object]")return!1;var e=Object.getPrototypeOf(n);return e===null||e===Object.prototype}function pp(n){return Ft.call(n)==="[object Date]"}function mp(n){return Ft.call(n)==="[object File]"}function yp(n){return Ft.call(n)==="[object Blob]"}function ic(n){return Ft.call(n)==="[object Function]"}function gp(n){return sc(n)&&ic(n.pipe)}function bp(n){return Ft.call(n)==="[object URLSearchParams]"}function _p(n){return n.trim?n.trim():n.replace(/^\s+|\s+$/g,"")}function vp(){return typeof navigator<"u"&&(navigator.product==="ReactNative"||navigator.product==="NativeScript"||navigator.product==="NS")?!1:typeof window<"u"&&typeof document<"u"}function Qi(n,e){if(!(n===null||typeof n>"u"))if(typeof n!="object"&&(n=[n]),Wi(n))for(var t=0,r=n.length;t<r;t++)e.call(null,n[t],t,n);else for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.call(null,n[s],s,n)}function xi(){var n={};function e(s,i){Nn(n[i])&&Nn(s)?n[i]=xi(n[i],s):Nn(s)?n[i]=xi({},s):Wi(s)?n[i]=s.slice():n[i]=s}for(var t=0,r=arguments.length;t<r;t++)Qi(arguments[t],e);return n}function wp(n,e,t){return Qi(e,function(s,i){t&&typeof s=="function"?n[i]=up(s,t):n[i]=s}),n}function Op(n){return n.charCodeAt(0)===65279&&(n=n.slice(1)),n}var Ke={isArray:Wi,isArrayBuffer:nc,isBuffer:cp,isFormData:lp,isArrayBufferView:dp,isString:hp,isNumber:fp,isObject:sc,isPlainObject:Nn,isUndefined:Pi,isDate:pp,isFile:mp,isBlob:yp,isFunction:ic,isStream:gp,isURLSearchParams:bp,isStandardBrowserEnv:vp,forEach:Qi,merge:xi,extend:wp,trim:_p,stripBOM:Op},sr=Ke;function to(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var ac=function(e,t,r){if(!t)return e;var s;if(r)s=r(t);else if(sr.isURLSearchParams(t))s=t.toString();else{var i=[];sr.forEach(t,function(u,c){u===null||typeof u>"u"||(sr.isArray(u)?c=c+"[]":u=[u],sr.forEach(u,function(d){sr.isDate(d)?d=d.toISOString():sr.isObject(d)&&(d=JSON.stringify(d)),i.push(to(c)+"="+to(d))}))}),s=i.join("&")}if(s){var a=e.indexOf("#");a!==-1&&(e=e.slice(0,a)),e+=(e.indexOf("?")===-1?"?":"&")+s}return e},Ep=Ke;function is(){this.handlers=[]}is.prototype.use=function(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1};is.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)};is.prototype.forEach=function(e){Ep.forEach(this.handlers,function(r){r!==null&&e(r)})};var Ap=is,Tp=Ke,Pp=function(e,t){Tp.forEach(e,function(s,i){i!==t&&i.toUpperCase()===t.toUpperCase()&&(e[t]=s,delete e[i])})},oc=function(e,t,r,s,i){return e.config=t,r&&(e.code=r),e.request=s,e.response=i,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},e},uc={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},qs,ro;function cc(){if(ro)return qs;ro=1;var n=oc;return qs=function(t,r,s,i,a){var o=new Error(t);return n(o,r,s,i,a)},qs}var zs,no;function xp(){if(no)return zs;no=1;var n=cc();return zs=function(t,r,s){var i=s.config.validateStatus;!s.status||!i||i(s.status)?t(s):r(n("Request failed with status code "+s.status,s.config,null,s.request,s))},zs}var Hs,so;function Sp(){if(so)return Hs;so=1;var n=Ke;return Hs=n.isStandardBrowserEnv()?function(){return{write:function(r,s,i,a,o,u){var c=[];c.push(r+"="+encodeURIComponent(s)),n.isNumber(i)&&c.push("expires="+new Date(i).toGMTString()),n.isString(a)&&c.push("path="+a),n.isString(o)&&c.push("domain="+o),u===!0&&c.push("secure"),document.cookie=c.join("; ")},read:function(r){var s=document.cookie.match(new RegExp("(^|;\\s*)("+r+")=([^;]*)"));return s?decodeURIComponent(s[3]):null},remove:function(r){this.write(r,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}(),Hs}var Ks,io;function jp(){return io||(io=1,Ks=function(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}),Ks}var Zs,ao;function kp(){return ao||(ao=1,Zs=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}),Zs}var Js,oo;function Cp(){if(oo)return Js;oo=1;var n=jp(),e=kp();return Js=function(r,s){return r&&!n(s)?e(r,s):s},Js}var Gs,uo;function Ip(){if(uo)return Gs;uo=1;var n=Ke,e=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];return Gs=function(r){var s={},i,a,o;return r&&n.forEach(r.split(`
`),function(c){if(o=c.indexOf(":"),i=n.trim(c.substr(0,o)).toLowerCase(),a=n.trim(c.substr(o+1)),i){if(s[i]&&e.indexOf(i)>=0)return;i==="set-cookie"?s[i]=(s[i]?s[i]:[]).concat([a]):s[i]=s[i]?s[i]+", "+a:a}}),s},Gs}var Ys,co;function Rp(){if(co)return Ys;co=1;var n=Ke;return Ys=n.isStandardBrowserEnv()?function(){var t=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a"),s;function i(a){var o=a;return t&&(r.setAttribute("href",o),o=r.href),r.setAttribute("href",o),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:r.pathname.charAt(0)==="/"?r.pathname:"/"+r.pathname}}return s=i(window.location.href),function(o){var u=n.isString(o)?i(o):o;return u.protocol===s.protocol&&u.host===s.host}}():function(){return function(){return!0}}(),Ys}var Ws,lo;function as(){if(lo)return Ws;lo=1;function n(e){this.message=e}return n.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},n.prototype.__CANCEL__=!0,Ws=n,Ws}var Qs,ho;function fo(){if(ho)return Qs;ho=1;var n=Ke,e=xp(),t=Sp(),r=ac,s=Cp(),i=Ip(),a=Rp(),o=cc(),u=uc,c=as();return Qs=function(d){return new Promise(function(g,f){var b=d.data,y=d.headers,T=d.responseType,k;function S(){d.cancelToken&&d.cancelToken.unsubscribe(k),d.signal&&d.signal.removeEventListener("abort",k)}n.isFormData(b)&&delete y["Content-Type"];var x=new XMLHttpRequest;if(d.auth){var $=d.auth.username||"",A=d.auth.password?unescape(encodeURIComponent(d.auth.password)):"";y.Authorization="Basic "+btoa($+":"+A)}var C=s(d.baseURL,d.url);x.open(d.method.toUpperCase(),r(C,d.params,d.paramsSerializer),!0),x.timeout=d.timeout;function _(){if(x){var m="getAllResponseHeaders"in x?i(x.getAllResponseHeaders()):null,E=!T||T==="text"||T==="json"?x.responseText:x.response,j={data:E,status:x.status,statusText:x.statusText,headers:m,config:d,request:x};e(function(O){g(O),S()},function(O){f(O),S()},j),x=null}}if("onloadend"in x?x.onloadend=_:x.onreadystatechange=function(){!x||x.readyState!==4||x.status===0&&!(x.responseURL&&x.responseURL.indexOf("file:")===0)||setTimeout(_)},x.onabort=function(){x&&(f(o("Request aborted",d,"ECONNABORTED",x)),x=null)},x.onerror=function(){f(o("Network Error",d,null,x)),x=null},x.ontimeout=function(){var E=d.timeout?"timeout of "+d.timeout+"ms exceeded":"timeout exceeded",j=d.transitional||u;d.timeoutErrorMessage&&(E=d.timeoutErrorMessage),f(o(E,d,j.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",x)),x=null},n.isStandardBrowserEnv()){var w=(d.withCredentials||a(C))&&d.xsrfCookieName?t.read(d.xsrfCookieName):void 0;w&&(y[d.xsrfHeaderName]=w)}"setRequestHeader"in x&&n.forEach(y,function(E,j){typeof b>"u"&&j.toLowerCase()==="content-type"?delete y[j]:x.setRequestHeader(j,E)}),n.isUndefined(d.withCredentials)||(x.withCredentials=!!d.withCredentials),T&&T!=="json"&&(x.responseType=d.responseType),typeof d.onDownloadProgress=="function"&&x.addEventListener("progress",d.onDownloadProgress),typeof d.onUploadProgress=="function"&&x.upload&&x.upload.addEventListener("progress",d.onUploadProgress),(d.cancelToken||d.signal)&&(k=function(m){x&&(f(!m||m&&m.type?new c("canceled"):m),x.abort(),x=null)},d.cancelToken&&d.cancelToken.subscribe(k),d.signal&&(d.signal.aborted?k():d.signal.addEventListener("abort",k))),b||(b=null),x.send(b)})},Qs}var Re=Ke,po=Pp,Dp=oc,Np=uc,Lp={"Content-Type":"application/x-www-form-urlencoded"};function mo(n,e){!Re.isUndefined(n)&&Re.isUndefined(n["Content-Type"])&&(n["Content-Type"]=e)}function $p(){var n;return(typeof XMLHttpRequest<"u"||typeof process<"u"&&Object.prototype.toString.call(process)==="[object process]")&&(n=fo()),n}function Up(n,e,t){if(Re.isString(n))try{return(e||JSON.parse)(n),Re.trim(n)}catch(r){if(r.name!=="SyntaxError")throw r}return(t||JSON.stringify)(n)}var os={transitional:Np,adapter:$p(),transformRequest:[function(e,t){return po(t,"Accept"),po(t,"Content-Type"),Re.isFormData(e)||Re.isArrayBuffer(e)||Re.isBuffer(e)||Re.isStream(e)||Re.isFile(e)||Re.isBlob(e)?e:Re.isArrayBufferView(e)?e.buffer:Re.isURLSearchParams(e)?(mo(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):Re.isObject(e)||t&&t["Content-Type"]==="application/json"?(mo(t,"application/json"),Up(e)):e}],transformResponse:[function(e){var t=this.transitional||os.transitional,r=t&&t.silentJSONParsing,s=t&&t.forcedJSONParsing,i=!r&&this.responseType==="json";if(i||s&&Re.isString(e)&&e.length)try{return JSON.parse(e)}catch(a){if(i)throw a.name==="SyntaxError"?Dp(a,this,"E_JSON_PARSE"):a}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};Re.forEach(["delete","get","head"],function(e){os.headers[e]={}});Re.forEach(["post","put","patch"],function(e){os.headers[e]=Re.merge(Lp)});var Xi=os,Mp=Ke,Fp=Xi,Bp=function(e,t,r){var s=this||Fp;return Mp.forEach(r,function(a){e=a.call(s,e,t)}),e},Xs,yo;function lc(){return yo||(yo=1,Xs=function(e){return!!(e&&e.__CANCEL__)}),Xs}var go=Ke,ei=Bp,Vp=lc(),qp=Xi,zp=as();function ti(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new zp("canceled")}var Hp=function(e){ti(e),e.headers=e.headers||{},e.data=ei.call(e,e.data,e.headers,e.transformRequest),e.headers=go.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),go.forEach(["delete","get","head","post","put","patch","common"],function(s){delete e.headers[s]});var t=e.adapter||qp.adapter;return t(e).then(function(s){return ti(e),s.data=ei.call(e,s.data,s.headers,e.transformResponse),s},function(s){return Vp(s)||(ti(e),s&&s.response&&(s.response.data=ei.call(e,s.response.data,s.response.headers,e.transformResponse))),Promise.reject(s)})},Ze=Ke,dc=function(e,t){t=t||{};var r={};function s(l,d){return Ze.isPlainObject(l)&&Ze.isPlainObject(d)?Ze.merge(l,d):Ze.isPlainObject(d)?Ze.merge({},d):Ze.isArray(d)?d.slice():d}function i(l){if(Ze.isUndefined(t[l])){if(!Ze.isUndefined(e[l]))return s(void 0,e[l])}else return s(e[l],t[l])}function a(l){if(!Ze.isUndefined(t[l]))return s(void 0,t[l])}function o(l){if(Ze.isUndefined(t[l])){if(!Ze.isUndefined(e[l]))return s(void 0,e[l])}else return s(void 0,t[l])}function u(l){if(l in t)return s(e[l],t[l]);if(l in e)return s(void 0,e[l])}var c={url:a,method:a,data:a,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:u};return Ze.forEach(Object.keys(e).concat(Object.keys(t)),function(d){var h=c[d]||i,g=h(d);Ze.isUndefined(g)&&h!==u||(r[d]=g)}),r},ri,bo;function hc(){return bo||(bo=1,ri={version:"0.26.1"}),ri}var Kp=hc().version,ea={};["object","boolean","number","function","string","symbol"].forEach(function(n,e){ea[n]=function(r){return typeof r===n||"a"+(e<1?"n ":" ")+n}});var _o={};ea.transitional=function(e,t,r){function s(i,a){return"[Axios v"+Kp+"] Transitional option '"+i+"'"+a+(r?". "+r:"")}return function(i,a,o){if(e===!1)throw new Error(s(a," has been removed"+(t?" in "+t:"")));return t&&!_o[a]&&(_o[a]=!0,console.warn(s(a," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(i,a,o):!0}};function Zp(n,e,t){if(typeof n!="object")throw new TypeError("options must be an object");for(var r=Object.keys(n),s=r.length;s-- >0;){var i=r[s],a=e[i];if(a){var o=n[i],u=o===void 0||a(o,i,n);if(u!==!0)throw new TypeError("option "+i+" must be "+u);continue}if(t!==!0)throw Error("Unknown option "+i)}}var Jp={assertOptions:Zp,validators:ea},fc=Ke,Gp=ac,vo=Ap,wo=Hp,us=dc,pc=Jp,ir=pc.validators;function fn(n){this.defaults=n,this.interceptors={request:new vo,response:new vo}}fn.prototype.request=function(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=us(this.defaults,t),t.method?t.method=t.method.toLowerCase():this.defaults.method?t.method=this.defaults.method.toLowerCase():t.method="get";var r=t.transitional;r!==void 0&&pc.assertOptions(r,{silentJSONParsing:ir.transitional(ir.boolean),forcedJSONParsing:ir.transitional(ir.boolean),clarifyTimeoutError:ir.transitional(ir.boolean)},!1);var s=[],i=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(t)===!1||(i=i&&g.synchronous,s.unshift(g.fulfilled,g.rejected))});var a=[];this.interceptors.response.forEach(function(g){a.push(g.fulfilled,g.rejected)});var o;if(!i){var u=[wo,void 0];for(Array.prototype.unshift.apply(u,s),u=u.concat(a),o=Promise.resolve(t);u.length;)o=o.then(u.shift(),u.shift());return o}for(var c=t;s.length;){var l=s.shift(),d=s.shift();try{c=l(c)}catch(h){d(h);break}}try{o=wo(c)}catch(h){return Promise.reject(h)}for(;a.length;)o=o.then(a.shift(),a.shift());return o};fn.prototype.getUri=function(e){return e=us(this.defaults,e),Gp(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")};fc.forEach(["delete","get","head","options"],function(e){fn.prototype[e]=function(t,r){return this.request(us(r||{},{method:e,url:t,data:(r||{}).data}))}});fc.forEach(["post","put","patch"],function(e){fn.prototype[e]=function(t,r,s){return this.request(us(s||{},{method:e,url:t,data:r}))}});var Yp=fn,ni,Oo;function Wp(){if(Oo)return ni;Oo=1;var n=as();function e(t){if(typeof t!="function")throw new TypeError("executor must be a function.");var r;this.promise=new Promise(function(a){r=a});var s=this;this.promise.then(function(i){if(s._listeners){var a,o=s._listeners.length;for(a=0;a<o;a++)s._listeners[a](i);s._listeners=null}}),this.promise.then=function(i){var a,o=new Promise(function(u){s.subscribe(u),a=u}).then(i);return o.cancel=function(){s.unsubscribe(a)},o},t(function(a){s.reason||(s.reason=new n(a),r(s.reason))})}return e.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},e.prototype.subscribe=function(r){if(this.reason){r(this.reason);return}this._listeners?this._listeners.push(r):this._listeners=[r]},e.prototype.unsubscribe=function(r){if(this._listeners){var s=this._listeners.indexOf(r);s!==-1&&this._listeners.splice(s,1)}},e.source=function(){var r,s=new e(function(a){r=a});return{token:s,cancel:r}},ni=e,ni}var si,Eo;function Qp(){return Eo||(Eo=1,si=function(e){return function(r){return e.apply(null,r)}}),si}var ii,Ao;function Xp(){if(Ao)return ii;Ao=1;var n=Ke;return ii=function(t){return n.isObject(t)&&t.isAxiosError===!0},ii}var To=Ke,em=rc,Ln=Yp,tm=dc,rm=Xi;function mc(n){var e=new Ln(n),t=em(Ln.prototype.request,e);return To.extend(t,Ln.prototype,e),To.extend(t,e),t.create=function(s){return mc(tm(n,s))},t}var vt=mc(rm);vt.Axios=Ln;vt.Cancel=as();vt.CancelToken=Wp();vt.isCancel=lc();vt.VERSION=hc().version;vt.all=function(e){return Promise.all(e)};vt.spread=Qp();vt.isAxiosError=Xp();Yi.exports=vt;Yi.exports.default=vt;var nm=Yi.exports,yc=nm,Ee={},ta={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.RequiredError=n.BaseAPI=n.COLLECTION_FORMATS=n.BASE_PATH=void 0;const e=yc;n.BASE_PATH="https://api.openai.com/v1".replace(/\/+$/,""),n.COLLECTION_FORMATS={csv:",",ssv:" ",tsv:"	",pipes:"|"};class t{constructor(i,a=n.BASE_PATH,o=e.default){this.basePath=a,this.axios=o,i&&(this.configuration=i,this.basePath=i.basePath||this.basePath)}}n.BaseAPI=t;class r extends Error{constructor(i,a){super(a),this.field=i,this.name="RequiredError"}}n.RequiredError=r})(ta);var ra=ut&&ut.__awaiter||function(n,e,t,r){function s(i){return i instanceof t?i:new t(function(a){a(i)})}return new(t||(t=Promise))(function(i,a){function o(l){try{c(r.next(l))}catch(d){a(d)}}function u(l){try{c(r.throw(l))}catch(d){a(d)}}function c(l){l.done?i(l.value):s(l.value).then(o,u)}c((r=r.apply(n,e||[])).next())})};Object.defineProperty(Ee,"__esModule",{value:!0});Ee.createRequestFunction=Ee.toPathString=Ee.serializeDataIfNeeded=Ee.setSearchParams=Ee.setOAuthToObject=Ee.setBearerAuthToObject=Ee.setBasicAuthToObject=Ee.setApiKeyToObject=Ee.assertParamExists=Ee.DUMMY_BASE_URL=void 0;const sm=ta;Ee.DUMMY_BASE_URL="https://example.com";Ee.assertParamExists=function(n,e,t){if(t==null)throw new sm.RequiredError(e,`Required parameter ${e} was null or undefined when calling ${n}.`)};Ee.setApiKeyToObject=function(n,e,t){return ra(this,void 0,void 0,function*(){if(t&&t.apiKey){const r=typeof t.apiKey=="function"?yield t.apiKey(e):yield t.apiKey;n[e]=r}})};Ee.setBasicAuthToObject=function(n,e){e&&(e.username||e.password)&&(n.auth={username:e.username,password:e.password})};Ee.setBearerAuthToObject=function(n,e){return ra(this,void 0,void 0,function*(){if(e&&e.accessToken){const t=typeof e.accessToken=="function"?yield e.accessToken():yield e.accessToken;n.Authorization="Bearer "+t}})};Ee.setOAuthToObject=function(n,e,t,r){return ra(this,void 0,void 0,function*(){if(r&&r.accessToken){const s=typeof r.accessToken=="function"?yield r.accessToken(e,t):yield r.accessToken;n.Authorization="Bearer "+s}})};function Si(n,e,t=""){e!=null&&(typeof e=="object"?Array.isArray(e)?e.forEach(r=>Si(n,r,t)):Object.keys(e).forEach(r=>Si(n,e[r],`${t}${t!==""?".":""}${r}`)):n.has(t)?n.append(t,e):n.set(t,e))}Ee.setSearchParams=function(n,...e){const t=new URLSearchParams(n.search);Si(t,e),n.search=t.toString()};Ee.serializeDataIfNeeded=function(n,e,t){const r=typeof n!="string";return(r&&t&&t.isJsonMime?t.isJsonMime(e.headers["Content-Type"]):r)?JSON.stringify(n!==void 0?n:{}):n||""};Ee.toPathString=function(n){return n.pathname+n.search+n.hash};Ee.createRequestFunction=function(n,e,t,r){return(s=e,i=t)=>{const a=Object.assign(Object.assign({},n.options),{url:((r==null?void 0:r.basePath)||i)+n.url});return s.request(a)}};(function(n){var e=ut&&ut.__awaiter||function(a,o,u,c){function l(d){return d instanceof u?d:new u(function(h){h(d)})}return new(u||(u=Promise))(function(d,h){function g(y){try{b(c.next(y))}catch(T){h(T)}}function f(y){try{b(c.throw(y))}catch(T){h(T)}}function b(y){y.done?d(y.value):l(y.value).then(g,f)}b((c=c.apply(a,o||[])).next())})};Object.defineProperty(n,"__esModule",{value:!0}),n.OpenAIApi=n.OpenAIApiFactory=n.OpenAIApiFp=n.OpenAIApiAxiosParamCreator=n.CreateImageRequestResponseFormatEnum=n.CreateImageRequestSizeEnum=n.ChatCompletionResponseMessageRoleEnum=n.ChatCompletionRequestMessageRoleEnum=void 0;const t=yc,r=Ee,s=ta;n.ChatCompletionRequestMessageRoleEnum={System:"system",User:"user",Assistant:"assistant",Function:"function"},n.ChatCompletionResponseMessageRoleEnum={System:"system",User:"user",Assistant:"assistant",Function:"function"},n.CreateImageRequestSizeEnum={_256x256:"256x256",_512x512:"512x512",_1024x1024:"1024x1024"},n.CreateImageRequestResponseFormatEnum={Url:"url",B64Json:"b64_json"},n.OpenAIApiAxiosParamCreator=function(a){return{cancelFineTune:(o,u={})=>e(this,void 0,void 0,function*(){r.assertParamExists("cancelFineTune","fineTuneId",o);const c="/fine-tunes/{fine_tune_id}/cancel".replace("{fine_tune_id}",encodeURIComponent(String(o))),l=new URL(c,r.DUMMY_BASE_URL);let d;a&&(d=a.baseOptions);const h=Object.assign(Object.assign({method:"POST"},d),u),g={},f={};r.setSearchParams(l,f);let b=d&&d.headers?d.headers:{};return h.headers=Object.assign(Object.assign(Object.assign({},g),b),u.headers),{url:r.toPathString(l),options:h}}),createAnswer:(o,u={})=>e(this,void 0,void 0,function*(){r.assertParamExists("createAnswer","createAnswerRequest",o);const c="/answers",l=new URL(c,r.DUMMY_BASE_URL);let d;a&&(d=a.baseOptions);const h=Object.assign(Object.assign({method:"POST"},d),u),g={},f={};g["Content-Type"]="application/json",r.setSearchParams(l,f);let b=d&&d.headers?d.headers:{};return h.headers=Object.assign(Object.assign(Object.assign({},g),b),u.headers),h.data=r.serializeDataIfNeeded(o,h,a),{url:r.toPathString(l),options:h}}),createChatCompletion:(o,u={})=>e(this,void 0,void 0,function*(){r.assertParamExists("createChatCompletion","createChatCompletionRequest",o);const c="/chat/completions",l=new URL(c,r.DUMMY_BASE_URL);let d;a&&(d=a.baseOptions);const h=Object.assign(Object.assign({method:"POST"},d),u),g={},f={};g["Content-Type"]="application/json",r.setSearchParams(l,f);let b=d&&d.headers?d.headers:{};return h.headers=Object.assign(Object.assign(Object.assign({},g),b),u.headers),h.data=r.serializeDataIfNeeded(o,h,a),{url:r.toPathString(l),options:h}}),createClassification:(o,u={})=>e(this,void 0,void 0,function*(){r.assertParamExists("createClassification","createClassificationRequest",o);const c="/classifications",l=new URL(c,r.DUMMY_BASE_URL);let d;a&&(d=a.baseOptions);const h=Object.assign(Object.assign({method:"POST"},d),u),g={},f={};g["Content-Type"]="application/json",r.setSearchParams(l,f);let b=d&&d.headers?d.headers:{};return h.headers=Object.assign(Object.assign(Object.assign({},g),b),u.headers),h.data=r.serializeDataIfNeeded(o,h,a),{url:r.toPathString(l),options:h}}),createCompletion:(o,u={})=>e(this,void 0,void 0,function*(){r.assertParamExists("createCompletion","createCompletionRequest",o);const c="/completions",l=new URL(c,r.DUMMY_BASE_URL);let d;a&&(d=a.baseOptions);const h=Object.assign(Object.assign({method:"POST"},d),u),g={},f={};g["Content-Type"]="application/json",r.setSearchParams(l,f);let b=d&&d.headers?d.headers:{};return h.headers=Object.assign(Object.assign(Object.assign({},g),b),u.headers),h.data=r.serializeDataIfNeeded(o,h,a),{url:r.toPathString(l),options:h}}),createEdit:(o,u={})=>e(this,void 0,void 0,function*(){r.assertParamExists("createEdit","createEditRequest",o);const c="/edits",l=new URL(c,r.DUMMY_BASE_URL);let d;a&&(d=a.baseOptions);const h=Object.assign(Object.assign({method:"POST"},d),u),g={},f={};g["Content-Type"]="application/json",r.setSearchParams(l,f);let b=d&&d.headers?d.headers:{};return h.headers=Object.assign(Object.assign(Object.assign({},g),b),u.headers),h.data=r.serializeDataIfNeeded(o,h,a),{url:r.toPathString(l),options:h}}),createEmbedding:(o,u={})=>e(this,void 0,void 0,function*(){r.assertParamExists("createEmbedding","createEmbeddingRequest",o);const c="/embeddings",l=new URL(c,r.DUMMY_BASE_URL);let d;a&&(d=a.baseOptions);const h=Object.assign(Object.assign({method:"POST"},d),u),g={},f={};g["Content-Type"]="application/json",r.setSearchParams(l,f);let b=d&&d.headers?d.headers:{};return h.headers=Object.assign(Object.assign(Object.assign({},g),b),u.headers),h.data=r.serializeDataIfNeeded(o,h,a),{url:r.toPathString(l),options:h}}),createFile:(o,u,c={})=>e(this,void 0,void 0,function*(){r.assertParamExists("createFile","file",o),r.assertParamExists("createFile","purpose",u);const l="/files",d=new URL(l,r.DUMMY_BASE_URL);let h;a&&(h=a.baseOptions);const g=Object.assign(Object.assign({method:"POST"},h),c),f={},b={},y=new(a&&a.formDataCtor||FormData);o!==void 0&&y.append("file",o),u!==void 0&&y.append("purpose",u),f["Content-Type"]="multipart/form-data",r.setSearchParams(d,b);let T=h&&h.headers?h.headers:{};return g.headers=Object.assign(Object.assign(Object.assign(Object.assign({},f),y.getHeaders()),T),c.headers),g.data=y,{url:r.toPathString(d),options:g}}),createFineTune:(o,u={})=>e(this,void 0,void 0,function*(){r.assertParamExists("createFineTune","createFineTuneRequest",o);const c="/fine-tunes",l=new URL(c,r.DUMMY_BASE_URL);let d;a&&(d=a.baseOptions);const h=Object.assign(Object.assign({method:"POST"},d),u),g={},f={};g["Content-Type"]="application/json",r.setSearchParams(l,f);let b=d&&d.headers?d.headers:{};return h.headers=Object.assign(Object.assign(Object.assign({},g),b),u.headers),h.data=r.serializeDataIfNeeded(o,h,a),{url:r.toPathString(l),options:h}}),createImage:(o,u={})=>e(this,void 0,void 0,function*(){r.assertParamExists("createImage","createImageRequest",o);const c="/images/generations",l=new URL(c,r.DUMMY_BASE_URL);let d;a&&(d=a.baseOptions);const h=Object.assign(Object.assign({method:"POST"},d),u),g={},f={};g["Content-Type"]="application/json",r.setSearchParams(l,f);let b=d&&d.headers?d.headers:{};return h.headers=Object.assign(Object.assign(Object.assign({},g),b),u.headers),h.data=r.serializeDataIfNeeded(o,h,a),{url:r.toPathString(l),options:h}}),createImageEdit:(o,u,c,l,d,h,g,f={})=>e(this,void 0,void 0,function*(){r.assertParamExists("createImageEdit","image",o),r.assertParamExists("createImageEdit","prompt",u);const b="/images/edits",y=new URL(b,r.DUMMY_BASE_URL);let T;a&&(T=a.baseOptions);const k=Object.assign(Object.assign({method:"POST"},T),f),S={},x={},$=new(a&&a.formDataCtor||FormData);o!==void 0&&$.append("image",o),c!==void 0&&$.append("mask",c),u!==void 0&&$.append("prompt",u),l!==void 0&&$.append("n",l),d!==void 0&&$.append("size",d),h!==void 0&&$.append("response_format",h),g!==void 0&&$.append("user",g),S["Content-Type"]="multipart/form-data",r.setSearchParams(y,x);let A=T&&T.headers?T.headers:{};return k.headers=Object.assign(Object.assign(Object.assign(Object.assign({},S),$.getHeaders()),A),f.headers),k.data=$,{url:r.toPathString(y),options:k}}),createImageVariation:(o,u,c,l,d,h={})=>e(this,void 0,void 0,function*(){r.assertParamExists("createImageVariation","image",o);const g="/images/variations",f=new URL(g,r.DUMMY_BASE_URL);let b;a&&(b=a.baseOptions);const y=Object.assign(Object.assign({method:"POST"},b),h),T={},k={},S=new(a&&a.formDataCtor||FormData);o!==void 0&&S.append("image",o),u!==void 0&&S.append("n",u),c!==void 0&&S.append("size",c),l!==void 0&&S.append("response_format",l),d!==void 0&&S.append("user",d),T["Content-Type"]="multipart/form-data",r.setSearchParams(f,k);let x=b&&b.headers?b.headers:{};return y.headers=Object.assign(Object.assign(Object.assign(Object.assign({},T),S.getHeaders()),x),h.headers),y.data=S,{url:r.toPathString(f),options:y}}),createModeration:(o,u={})=>e(this,void 0,void 0,function*(){r.assertParamExists("createModeration","createModerationRequest",o);const c="/moderations",l=new URL(c,r.DUMMY_BASE_URL);let d;a&&(d=a.baseOptions);const h=Object.assign(Object.assign({method:"POST"},d),u),g={},f={};g["Content-Type"]="application/json",r.setSearchParams(l,f);let b=d&&d.headers?d.headers:{};return h.headers=Object.assign(Object.assign(Object.assign({},g),b),u.headers),h.data=r.serializeDataIfNeeded(o,h,a),{url:r.toPathString(l),options:h}}),createSearch:(o,u,c={})=>e(this,void 0,void 0,function*(){r.assertParamExists("createSearch","engineId",o),r.assertParamExists("createSearch","createSearchRequest",u);const l="/engines/{engine_id}/search".replace("{engine_id}",encodeURIComponent(String(o))),d=new URL(l,r.DUMMY_BASE_URL);let h;a&&(h=a.baseOptions);const g=Object.assign(Object.assign({method:"POST"},h),c),f={},b={};f["Content-Type"]="application/json",r.setSearchParams(d,b);let y=h&&h.headers?h.headers:{};return g.headers=Object.assign(Object.assign(Object.assign({},f),y),c.headers),g.data=r.serializeDataIfNeeded(u,g,a),{url:r.toPathString(d),options:g}}),createTranscription:(o,u,c,l,d,h,g={})=>e(this,void 0,void 0,function*(){r.assertParamExists("createTranscription","file",o),r.assertParamExists("createTranscription","model",u);const f="/audio/transcriptions",b=new URL(f,r.DUMMY_BASE_URL);let y;a&&(y=a.baseOptions);const T=Object.assign(Object.assign({method:"POST"},y),g),k={},S={},x=new(a&&a.formDataCtor||FormData);o!==void 0&&x.append("file",o),u!==void 0&&x.append("model",u),c!==void 0&&x.append("prompt",c),l!==void 0&&x.append("response_format",l),d!==void 0&&x.append("temperature",d),h!==void 0&&x.append("language",h),k["Content-Type"]="multipart/form-data",r.setSearchParams(b,S);let $=y&&y.headers?y.headers:{};return T.headers=Object.assign(Object.assign(Object.assign(Object.assign({},k),x.getHeaders()),$),g.headers),T.data=x,{url:r.toPathString(b),options:T}}),createTranslation:(o,u,c,l,d,h={})=>e(this,void 0,void 0,function*(){r.assertParamExists("createTranslation","file",o),r.assertParamExists("createTranslation","model",u);const g="/audio/translations",f=new URL(g,r.DUMMY_BASE_URL);let b;a&&(b=a.baseOptions);const y=Object.assign(Object.assign({method:"POST"},b),h),T={},k={},S=new(a&&a.formDataCtor||FormData);o!==void 0&&S.append("file",o),u!==void 0&&S.append("model",u),c!==void 0&&S.append("prompt",c),l!==void 0&&S.append("response_format",l),d!==void 0&&S.append("temperature",d),T["Content-Type"]="multipart/form-data",r.setSearchParams(f,k);let x=b&&b.headers?b.headers:{};return y.headers=Object.assign(Object.assign(Object.assign(Object.assign({},T),S.getHeaders()),x),h.headers),y.data=S,{url:r.toPathString(f),options:y}}),deleteFile:(o,u={})=>e(this,void 0,void 0,function*(){r.assertParamExists("deleteFile","fileId",o);const c="/files/{file_id}".replace("{file_id}",encodeURIComponent(String(o))),l=new URL(c,r.DUMMY_BASE_URL);let d;a&&(d=a.baseOptions);const h=Object.assign(Object.assign({method:"DELETE"},d),u),g={},f={};r.setSearchParams(l,f);let b=d&&d.headers?d.headers:{};return h.headers=Object.assign(Object.assign(Object.assign({},g),b),u.headers),{url:r.toPathString(l),options:h}}),deleteModel:(o,u={})=>e(this,void 0,void 0,function*(){r.assertParamExists("deleteModel","model",o);const c="/models/{model}".replace("{model}",encodeURIComponent(String(o))),l=new URL(c,r.DUMMY_BASE_URL);let d;a&&(d=a.baseOptions);const h=Object.assign(Object.assign({method:"DELETE"},d),u),g={},f={};r.setSearchParams(l,f);let b=d&&d.headers?d.headers:{};return h.headers=Object.assign(Object.assign(Object.assign({},g),b),u.headers),{url:r.toPathString(l),options:h}}),downloadFile:(o,u={})=>e(this,void 0,void 0,function*(){r.assertParamExists("downloadFile","fileId",o);const c="/files/{file_id}/content".replace("{file_id}",encodeURIComponent(String(o))),l=new URL(c,r.DUMMY_BASE_URL);let d;a&&(d=a.baseOptions);const h=Object.assign(Object.assign({method:"GET"},d),u),g={},f={};r.setSearchParams(l,f);let b=d&&d.headers?d.headers:{};return h.headers=Object.assign(Object.assign(Object.assign({},g),b),u.headers),{url:r.toPathString(l),options:h}}),listEngines:(o={})=>e(this,void 0,void 0,function*(){const u="/engines",c=new URL(u,r.DUMMY_BASE_URL);let l;a&&(l=a.baseOptions);const d=Object.assign(Object.assign({method:"GET"},l),o),h={},g={};r.setSearchParams(c,g);let f=l&&l.headers?l.headers:{};return d.headers=Object.assign(Object.assign(Object.assign({},h),f),o.headers),{url:r.toPathString(c),options:d}}),listFiles:(o={})=>e(this,void 0,void 0,function*(){const u="/files",c=new URL(u,r.DUMMY_BASE_URL);let l;a&&(l=a.baseOptions);const d=Object.assign(Object.assign({method:"GET"},l),o),h={},g={};r.setSearchParams(c,g);let f=l&&l.headers?l.headers:{};return d.headers=Object.assign(Object.assign(Object.assign({},h),f),o.headers),{url:r.toPathString(c),options:d}}),listFineTuneEvents:(o,u,c={})=>e(this,void 0,void 0,function*(){r.assertParamExists("listFineTuneEvents","fineTuneId",o);const l="/fine-tunes/{fine_tune_id}/events".replace("{fine_tune_id}",encodeURIComponent(String(o))),d=new URL(l,r.DUMMY_BASE_URL);let h;a&&(h=a.baseOptions);const g=Object.assign(Object.assign({method:"GET"},h),c),f={},b={};u!==void 0&&(b.stream=u),r.setSearchParams(d,b);let y=h&&h.headers?h.headers:{};return g.headers=Object.assign(Object.assign(Object.assign({},f),y),c.headers),{url:r.toPathString(d),options:g}}),listFineTunes:(o={})=>e(this,void 0,void 0,function*(){const u="/fine-tunes",c=new URL(u,r.DUMMY_BASE_URL);let l;a&&(l=a.baseOptions);const d=Object.assign(Object.assign({method:"GET"},l),o),h={},g={};r.setSearchParams(c,g);let f=l&&l.headers?l.headers:{};return d.headers=Object.assign(Object.assign(Object.assign({},h),f),o.headers),{url:r.toPathString(c),options:d}}),listModels:(o={})=>e(this,void 0,void 0,function*(){const u="/models",c=new URL(u,r.DUMMY_BASE_URL);let l;a&&(l=a.baseOptions);const d=Object.assign(Object.assign({method:"GET"},l),o),h={},g={};r.setSearchParams(c,g);let f=l&&l.headers?l.headers:{};return d.headers=Object.assign(Object.assign(Object.assign({},h),f),o.headers),{url:r.toPathString(c),options:d}}),retrieveEngine:(o,u={})=>e(this,void 0,void 0,function*(){r.assertParamExists("retrieveEngine","engineId",o);const c="/engines/{engine_id}".replace("{engine_id}",encodeURIComponent(String(o))),l=new URL(c,r.DUMMY_BASE_URL);let d;a&&(d=a.baseOptions);const h=Object.assign(Object.assign({method:"GET"},d),u),g={},f={};r.setSearchParams(l,f);let b=d&&d.headers?d.headers:{};return h.headers=Object.assign(Object.assign(Object.assign({},g),b),u.headers),{url:r.toPathString(l),options:h}}),retrieveFile:(o,u={})=>e(this,void 0,void 0,function*(){r.assertParamExists("retrieveFile","fileId",o);const c="/files/{file_id}".replace("{file_id}",encodeURIComponent(String(o))),l=new URL(c,r.DUMMY_BASE_URL);let d;a&&(d=a.baseOptions);const h=Object.assign(Object.assign({method:"GET"},d),u),g={},f={};r.setSearchParams(l,f);let b=d&&d.headers?d.headers:{};return h.headers=Object.assign(Object.assign(Object.assign({},g),b),u.headers),{url:r.toPathString(l),options:h}}),retrieveFineTune:(o,u={})=>e(this,void 0,void 0,function*(){r.assertParamExists("retrieveFineTune","fineTuneId",o);const c="/fine-tunes/{fine_tune_id}".replace("{fine_tune_id}",encodeURIComponent(String(o))),l=new URL(c,r.DUMMY_BASE_URL);let d;a&&(d=a.baseOptions);const h=Object.assign(Object.assign({method:"GET"},d),u),g={},f={};r.setSearchParams(l,f);let b=d&&d.headers?d.headers:{};return h.headers=Object.assign(Object.assign(Object.assign({},g),b),u.headers),{url:r.toPathString(l),options:h}}),retrieveModel:(o,u={})=>e(this,void 0,void 0,function*(){r.assertParamExists("retrieveModel","model",o);const c="/models/{model}".replace("{model}",encodeURIComponent(String(o))),l=new URL(c,r.DUMMY_BASE_URL);let d;a&&(d=a.baseOptions);const h=Object.assign(Object.assign({method:"GET"},d),u),g={},f={};r.setSearchParams(l,f);let b=d&&d.headers?d.headers:{};return h.headers=Object.assign(Object.assign(Object.assign({},g),b),u.headers),{url:r.toPathString(l),options:h}})}},n.OpenAIApiFp=function(a){const o=n.OpenAIApiAxiosParamCreator(a);return{cancelFineTune(u,c){return e(this,void 0,void 0,function*(){const l=yield o.cancelFineTune(u,c);return r.createRequestFunction(l,t.default,s.BASE_PATH,a)})},createAnswer(u,c){return e(this,void 0,void 0,function*(){const l=yield o.createAnswer(u,c);return r.createRequestFunction(l,t.default,s.BASE_PATH,a)})},createChatCompletion(u,c){return e(this,void 0,void 0,function*(){const l=yield o.createChatCompletion(u,c);return r.createRequestFunction(l,t.default,s.BASE_PATH,a)})},createClassification(u,c){return e(this,void 0,void 0,function*(){const l=yield o.createClassification(u,c);return r.createRequestFunction(l,t.default,s.BASE_PATH,a)})},createCompletion(u,c){return e(this,void 0,void 0,function*(){const l=yield o.createCompletion(u,c);return r.createRequestFunction(l,t.default,s.BASE_PATH,a)})},createEdit(u,c){return e(this,void 0,void 0,function*(){const l=yield o.createEdit(u,c);return r.createRequestFunction(l,t.default,s.BASE_PATH,a)})},createEmbedding(u,c){return e(this,void 0,void 0,function*(){const l=yield o.createEmbedding(u,c);return r.createRequestFunction(l,t.default,s.BASE_PATH,a)})},createFile(u,c,l){return e(this,void 0,void 0,function*(){const d=yield o.createFile(u,c,l);return r.createRequestFunction(d,t.default,s.BASE_PATH,a)})},createFineTune(u,c){return e(this,void 0,void 0,function*(){const l=yield o.createFineTune(u,c);return r.createRequestFunction(l,t.default,s.BASE_PATH,a)})},createImage(u,c){return e(this,void 0,void 0,function*(){const l=yield o.createImage(u,c);return r.createRequestFunction(l,t.default,s.BASE_PATH,a)})},createImageEdit(u,c,l,d,h,g,f,b){return e(this,void 0,void 0,function*(){const y=yield o.createImageEdit(u,c,l,d,h,g,f,b);return r.createRequestFunction(y,t.default,s.BASE_PATH,a)})},createImageVariation(u,c,l,d,h,g){return e(this,void 0,void 0,function*(){const f=yield o.createImageVariation(u,c,l,d,h,g);return r.createRequestFunction(f,t.default,s.BASE_PATH,a)})},createModeration(u,c){return e(this,void 0,void 0,function*(){const l=yield o.createModeration(u,c);return r.createRequestFunction(l,t.default,s.BASE_PATH,a)})},createSearch(u,c,l){return e(this,void 0,void 0,function*(){const d=yield o.createSearch(u,c,l);return r.createRequestFunction(d,t.default,s.BASE_PATH,a)})},createTranscription(u,c,l,d,h,g,f){return e(this,void 0,void 0,function*(){const b=yield o.createTranscription(u,c,l,d,h,g,f);return r.createRequestFunction(b,t.default,s.BASE_PATH,a)})},createTranslation(u,c,l,d,h,g){return e(this,void 0,void 0,function*(){const f=yield o.createTranslation(u,c,l,d,h,g);return r.createRequestFunction(f,t.default,s.BASE_PATH,a)})},deleteFile(u,c){return e(this,void 0,void 0,function*(){const l=yield o.deleteFile(u,c);return r.createRequestFunction(l,t.default,s.BASE_PATH,a)})},deleteModel(u,c){return e(this,void 0,void 0,function*(){const l=yield o.deleteModel(u,c);return r.createRequestFunction(l,t.default,s.BASE_PATH,a)})},downloadFile(u,c){return e(this,void 0,void 0,function*(){const l=yield o.downloadFile(u,c);return r.createRequestFunction(l,t.default,s.BASE_PATH,a)})},listEngines(u){return e(this,void 0,void 0,function*(){const c=yield o.listEngines(u);return r.createRequestFunction(c,t.default,s.BASE_PATH,a)})},listFiles(u){return e(this,void 0,void 0,function*(){const c=yield o.listFiles(u);return r.createRequestFunction(c,t.default,s.BASE_PATH,a)})},listFineTuneEvents(u,c,l){return e(this,void 0,void 0,function*(){const d=yield o.listFineTuneEvents(u,c,l);return r.createRequestFunction(d,t.default,s.BASE_PATH,a)})},listFineTunes(u){return e(this,void 0,void 0,function*(){const c=yield o.listFineTunes(u);return r.createRequestFunction(c,t.default,s.BASE_PATH,a)})},listModels(u){return e(this,void 0,void 0,function*(){const c=yield o.listModels(u);return r.createRequestFunction(c,t.default,s.BASE_PATH,a)})},retrieveEngine(u,c){return e(this,void 0,void 0,function*(){const l=yield o.retrieveEngine(u,c);return r.createRequestFunction(l,t.default,s.BASE_PATH,a)})},retrieveFile(u,c){return e(this,void 0,void 0,function*(){const l=yield o.retrieveFile(u,c);return r.createRequestFunction(l,t.default,s.BASE_PATH,a)})},retrieveFineTune(u,c){return e(this,void 0,void 0,function*(){const l=yield o.retrieveFineTune(u,c);return r.createRequestFunction(l,t.default,s.BASE_PATH,a)})},retrieveModel(u,c){return e(this,void 0,void 0,function*(){const l=yield o.retrieveModel(u,c);return r.createRequestFunction(l,t.default,s.BASE_PATH,a)})}}},n.OpenAIApiFactory=function(a,o,u){const c=n.OpenAIApiFp(a);return{cancelFineTune(l,d){return c.cancelFineTune(l,d).then(h=>h(u,o))},createAnswer(l,d){return c.createAnswer(l,d).then(h=>h(u,o))},createChatCompletion(l,d){return c.createChatCompletion(l,d).then(h=>h(u,o))},createClassification(l,d){return c.createClassification(l,d).then(h=>h(u,o))},createCompletion(l,d){return c.createCompletion(l,d).then(h=>h(u,o))},createEdit(l,d){return c.createEdit(l,d).then(h=>h(u,o))},createEmbedding(l,d){return c.createEmbedding(l,d).then(h=>h(u,o))},createFile(l,d,h){return c.createFile(l,d,h).then(g=>g(u,o))},createFineTune(l,d){return c.createFineTune(l,d).then(h=>h(u,o))},createImage(l,d){return c.createImage(l,d).then(h=>h(u,o))},createImageEdit(l,d,h,g,f,b,y,T){return c.createImageEdit(l,d,h,g,f,b,y,T).then(k=>k(u,o))},createImageVariation(l,d,h,g,f,b){return c.createImageVariation(l,d,h,g,f,b).then(y=>y(u,o))},createModeration(l,d){return c.createModeration(l,d).then(h=>h(u,o))},createSearch(l,d,h){return c.createSearch(l,d,h).then(g=>g(u,o))},createTranscription(l,d,h,g,f,b,y){return c.createTranscription(l,d,h,g,f,b,y).then(T=>T(u,o))},createTranslation(l,d,h,g,f,b){return c.createTranslation(l,d,h,g,f,b).then(y=>y(u,o))},deleteFile(l,d){return c.deleteFile(l,d).then(h=>h(u,o))},deleteModel(l,d){return c.deleteModel(l,d).then(h=>h(u,o))},downloadFile(l,d){return c.downloadFile(l,d).then(h=>h(u,o))},listEngines(l){return c.listEngines(l).then(d=>d(u,o))},listFiles(l){return c.listFiles(l).then(d=>d(u,o))},listFineTuneEvents(l,d,h){return c.listFineTuneEvents(l,d,h).then(g=>g(u,o))},listFineTunes(l){return c.listFineTunes(l).then(d=>d(u,o))},listModels(l){return c.listModels(l).then(d=>d(u,o))},retrieveEngine(l,d){return c.retrieveEngine(l,d).then(h=>h(u,o))},retrieveFile(l,d){return c.retrieveFile(l,d).then(h=>h(u,o))},retrieveFineTune(l,d){return c.retrieveFineTune(l,d).then(h=>h(u,o))},retrieveModel(l,d){return c.retrieveModel(l,d).then(h=>h(u,o))}}};class i extends s.BaseAPI{cancelFineTune(o,u){return n.OpenAIApiFp(this.configuration).cancelFineTune(o,u).then(c=>c(this.axios,this.basePath))}createAnswer(o,u){return n.OpenAIApiFp(this.configuration).createAnswer(o,u).then(c=>c(this.axios,this.basePath))}createChatCompletion(o,u){return n.OpenAIApiFp(this.configuration).createChatCompletion(o,u).then(c=>c(this.axios,this.basePath))}createClassification(o,u){return n.OpenAIApiFp(this.configuration).createClassification(o,u).then(c=>c(this.axios,this.basePath))}createCompletion(o,u){return n.OpenAIApiFp(this.configuration).createCompletion(o,u).then(c=>c(this.axios,this.basePath))}createEdit(o,u){return n.OpenAIApiFp(this.configuration).createEdit(o,u).then(c=>c(this.axios,this.basePath))}createEmbedding(o,u){return n.OpenAIApiFp(this.configuration).createEmbedding(o,u).then(c=>c(this.axios,this.basePath))}createFile(o,u,c){return n.OpenAIApiFp(this.configuration).createFile(o,u,c).then(l=>l(this.axios,this.basePath))}createFineTune(o,u){return n.OpenAIApiFp(this.configuration).createFineTune(o,u).then(c=>c(this.axios,this.basePath))}createImage(o,u){return n.OpenAIApiFp(this.configuration).createImage(o,u).then(c=>c(this.axios,this.basePath))}createImageEdit(o,u,c,l,d,h,g,f){return n.OpenAIApiFp(this.configuration).createImageEdit(o,u,c,l,d,h,g,f).then(b=>b(this.axios,this.basePath))}createImageVariation(o,u,c,l,d,h){return n.OpenAIApiFp(this.configuration).createImageVariation(o,u,c,l,d,h).then(g=>g(this.axios,this.basePath))}createModeration(o,u){return n.OpenAIApiFp(this.configuration).createModeration(o,u).then(c=>c(this.axios,this.basePath))}createSearch(o,u,c){return n.OpenAIApiFp(this.configuration).createSearch(o,u,c).then(l=>l(this.axios,this.basePath))}createTranscription(o,u,c,l,d,h,g){return n.OpenAIApiFp(this.configuration).createTranscription(o,u,c,l,d,h,g).then(f=>f(this.axios,this.basePath))}createTranslation(o,u,c,l,d,h){return n.OpenAIApiFp(this.configuration).createTranslation(o,u,c,l,d,h).then(g=>g(this.axios,this.basePath))}deleteFile(o,u){return n.OpenAIApiFp(this.configuration).deleteFile(o,u).then(c=>c(this.axios,this.basePath))}deleteModel(o,u){return n.OpenAIApiFp(this.configuration).deleteModel(o,u).then(c=>c(this.axios,this.basePath))}downloadFile(o,u){return n.OpenAIApiFp(this.configuration).downloadFile(o,u).then(c=>c(this.axios,this.basePath))}listEngines(o){return n.OpenAIApiFp(this.configuration).listEngines(o).then(u=>u(this.axios,this.basePath))}listFiles(o){return n.OpenAIApiFp(this.configuration).listFiles(o).then(u=>u(this.axios,this.basePath))}listFineTuneEvents(o,u,c){return n.OpenAIApiFp(this.configuration).listFineTuneEvents(o,u,c).then(l=>l(this.axios,this.basePath))}listFineTunes(o){return n.OpenAIApiFp(this.configuration).listFineTunes(o).then(u=>u(this.axios,this.basePath))}listModels(o){return n.OpenAIApiFp(this.configuration).listModels(o).then(u=>u(this.axios,this.basePath))}retrieveEngine(o,u){return n.OpenAIApiFp(this.configuration).retrieveEngine(o,u).then(c=>c(this.axios,this.basePath))}retrieveFile(o,u){return n.OpenAIApiFp(this.configuration).retrieveFile(o,u).then(c=>c(this.axios,this.basePath))}retrieveFineTune(o,u){return n.OpenAIApiFp(this.configuration).retrieveFineTune(o,u).then(c=>c(this.axios,this.basePath))}retrieveModel(o,u){return n.OpenAIApiFp(this.configuration).retrieveModel(o,u).then(c=>c(this.axios,this.basePath))}}n.OpenAIApi=i})(tc);var cs={};const im="openai",am="3.3.0",om="Node.js library for the OpenAI API",um={type:"git",url:"git@github.com:openai/openai-node.git"},cm=["openai","open","ai","gpt-3","gpt3"],lm="OpenAI",dm="MIT",hm="./dist/index.js",fm="./dist/index.d.ts",pm={build:"tsc --outDir dist/"},mm={axios:"^0.26.0","form-data":"^4.0.0"},ym={"@types/node":"^12.11.5",typescript:"^3.6.4"},gm={name:im,version:am,description:om,repository:um,keywords:cm,author:lm,license:dm,main:hm,types:fm,scripts:pm,dependencies:mm,devDependencies:ym};var ai,Po;function bm(){return Po||(Po=1,ai=typeof self=="object"?self.FormData:window.FormData),ai}Object.defineProperty(cs,"__esModule",{value:!0});cs.Configuration=void 0;const _m=gm;class vm{constructor(e={}){this.apiKey=e.apiKey,this.organization=e.organization,this.username=e.username,this.password=e.password,this.accessToken=e.accessToken,this.basePath=e.basePath,this.baseOptions=e.baseOptions,this.formDataCtor=e.formDataCtor,this.baseOptions||(this.baseOptions={}),this.baseOptions.headers=Object.assign({"User-Agent":`OpenAI/NodeJS/${_m.version}`,Authorization:`Bearer ${this.apiKey}`},this.baseOptions.headers),this.organization&&(this.baseOptions.headers["OpenAI-Organization"]=this.organization),this.formDataCtor||(this.formDataCtor=bm())}isJsonMime(e){const t=new RegExp("^(application/json|[^;/ 	]+/[^;/ 	]+[+]json)[ 	]*(;.*)?$","i");return e!==null&&(t.test(e)||e.toLowerCase()==="application/json-patch+json")}}cs.Configuration=vm;(function(n){var e=ut&&ut.__createBinding||(Object.create?function(r,s,i,a){a===void 0&&(a=i),Object.defineProperty(r,a,{enumerable:!0,get:function(){return s[i]}})}:function(r,s,i,a){a===void 0&&(a=i),r[a]=s[i]}),t=ut&&ut.__exportStar||function(r,s){for(var i in r)i!=="default"&&!s.hasOwnProperty(i)&&e(s,r,i)};Object.defineProperty(n,"__esModule",{value:!0}),t(tc,n),t(cs,n)})(Ti);function gc(n,e){return function(){return n.apply(e,arguments)}}const{toString:wm}=Object.prototype,{getPrototypeOf:na}=Object,ls=(n=>e=>{const t=wm.call(e);return n[t]||(n[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),wt=n=>(n=n.toLowerCase(),e=>ls(e)===n),ds=n=>e=>typeof e===n,{isArray:Tr}=Array,Xr=ds("undefined");function Om(n){return n!==null&&!Xr(n)&&n.constructor!==null&&!Xr(n.constructor)&&tt(n.constructor.isBuffer)&&n.constructor.isBuffer(n)}const bc=wt("ArrayBuffer");function Em(n){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(n):e=n&&n.buffer&&bc(n.buffer),e}const Am=ds("string"),tt=ds("function"),_c=ds("number"),hs=n=>n!==null&&typeof n=="object",Tm=n=>n===!0||n===!1,$n=n=>{if(ls(n)!=="object")return!1;const e=na(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},Pm=wt("Date"),xm=wt("File"),Sm=wt("Blob"),jm=wt("FileList"),km=n=>hs(n)&&tt(n.pipe),Cm=n=>{let e;return n&&(typeof FormData=="function"&&n instanceof FormData||tt(n.append)&&((e=ls(n))==="formdata"||e==="object"&&tt(n.toString)&&n.toString()==="[object FormData]"))},Im=wt("URLSearchParams"),Rm=n=>n.trim?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function pn(n,e,{allOwnKeys:t=!1}={}){if(n===null||typeof n>"u")return;let r,s;if(typeof n!="object"&&(n=[n]),Tr(n))for(r=0,s=n.length;r<s;r++)e.call(null,n[r],r,n);else{const i=t?Object.getOwnPropertyNames(n):Object.keys(n),a=i.length;let o;for(r=0;r<a;r++)o=i[r],e.call(null,n[o],o,n)}}function vc(n,e){e=e.toLowerCase();const t=Object.keys(n);let r=t.length,s;for(;r-- >0;)if(s=t[r],e===s.toLowerCase())return s;return null}const wc=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),Oc=n=>!Xr(n)&&n!==wc;function ji(){const{caseless:n}=Oc(this)&&this||{},e={},t=(r,s)=>{const i=n&&vc(e,s)||s;$n(e[i])&&$n(r)?e[i]=ji(e[i],r):$n(r)?e[i]=ji({},r):Tr(r)?e[i]=r.slice():e[i]=r};for(let r=0,s=arguments.length;r<s;r++)arguments[r]&&pn(arguments[r],t);return e}const Dm=(n,e,t,{allOwnKeys:r}={})=>(pn(e,(s,i)=>{t&&tt(s)?n[i]=gc(s,t):n[i]=s},{allOwnKeys:r}),n),Nm=n=>(n.charCodeAt(0)===65279&&(n=n.slice(1)),n),Lm=(n,e,t,r)=>{n.prototype=Object.create(e.prototype,r),n.prototype.constructor=n,Object.defineProperty(n,"super",{value:e.prototype}),t&&Object.assign(n.prototype,t)},$m=(n,e,t,r)=>{let s,i,a;const o={};if(e=e||{},n==null)return e;do{for(s=Object.getOwnPropertyNames(n),i=s.length;i-- >0;)a=s[i],(!r||r(a,n,e))&&!o[a]&&(e[a]=n[a],o[a]=!0);n=t!==!1&&na(n)}while(n&&(!t||t(n,e))&&n!==Object.prototype);return e},Um=(n,e,t)=>{n=String(n),(t===void 0||t>n.length)&&(t=n.length),t-=e.length;const r=n.indexOf(e,t);return r!==-1&&r===t},Mm=n=>{if(!n)return null;if(Tr(n))return n;let e=n.length;if(!_c(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=n[e];return t},Fm=(n=>e=>n&&e instanceof n)(typeof Uint8Array<"u"&&na(Uint8Array)),Bm=(n,e)=>{const r=(n&&n[Symbol.iterator]).call(n);let s;for(;(s=r.next())&&!s.done;){const i=s.value;e.call(n,i[0],i[1])}},Vm=(n,e)=>{let t;const r=[];for(;(t=n.exec(e))!==null;)r.push(t);return r},qm=wt("HTMLFormElement"),zm=n=>n.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,r,s){return r.toUpperCase()+s}),xo=(({hasOwnProperty:n})=>(e,t)=>n.call(e,t))(Object.prototype),Hm=wt("RegExp"),Ec=(n,e)=>{const t=Object.getOwnPropertyDescriptors(n),r={};pn(t,(s,i)=>{e(s,i,n)!==!1&&(r[i]=s)}),Object.defineProperties(n,r)},Km=n=>{Ec(n,(e,t)=>{if(tt(n)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const r=n[t];if(tt(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},Zm=(n,e)=>{const t={},r=s=>{s.forEach(i=>{t[i]=!0})};return Tr(n)?r(n):r(String(n).split(e)),t},Jm=()=>{},Gm=(n,e)=>(n=+n,Number.isFinite(n)?n:e),oi="abcdefghijklmnopqrstuvwxyz",So="0123456789",Ac={DIGIT:So,ALPHA:oi,ALPHA_DIGIT:oi+oi.toUpperCase()+So},Ym=(n=16,e=Ac.ALPHA_DIGIT)=>{let t="";const{length:r}=e;for(;n--;)t+=e[Math.random()*r|0];return t};function Wm(n){return!!(n&&tt(n.append)&&n[Symbol.toStringTag]==="FormData"&&n[Symbol.iterator])}const Qm=n=>{const e=new Array(10),t=(r,s)=>{if(hs(r)){if(e.indexOf(r)>=0)return;if(!("toJSON"in r)){e[s]=r;const i=Tr(r)?[]:{};return pn(r,(a,o)=>{const u=t(a,s+1);!Xr(u)&&(i[o]=u)}),e[s]=void 0,i}}return r};return t(n,0)},Xm=wt("AsyncFunction"),ey=n=>n&&(hs(n)||tt(n))&&tt(n.then)&&tt(n.catch),N={isArray:Tr,isArrayBuffer:bc,isBuffer:Om,isFormData:Cm,isArrayBufferView:Em,isString:Am,isNumber:_c,isBoolean:Tm,isObject:hs,isPlainObject:$n,isUndefined:Xr,isDate:Pm,isFile:xm,isBlob:Sm,isRegExp:Hm,isFunction:tt,isStream:km,isURLSearchParams:Im,isTypedArray:Fm,isFileList:jm,forEach:pn,merge:ji,extend:Dm,trim:Rm,stripBOM:Nm,inherits:Lm,toFlatObject:$m,kindOf:ls,kindOfTest:wt,endsWith:Um,toArray:Mm,forEachEntry:Bm,matchAll:Vm,isHTMLForm:qm,hasOwnProperty:xo,hasOwnProp:xo,reduceDescriptors:Ec,freezeMethods:Km,toObjectSet:Zm,toCamelCase:zm,noop:Jm,toFiniteNumber:Gm,findKey:vc,global:wc,isContextDefined:Oc,ALPHABET:Ac,generateString:Ym,isSpecCompliantForm:Wm,toJSONObject:Qm,isAsyncFn:Xm,isThenable:ey};function ue(n,e,t,r,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=n,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),r&&(this.request=r),s&&(this.response=s)}N.inherits(ue,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:N.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const Tc=ue.prototype,Pc={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(n=>{Pc[n]={value:n}});Object.defineProperties(ue,Pc);Object.defineProperty(Tc,"isAxiosError",{value:!0});ue.from=(n,e,t,r,s,i)=>{const a=Object.create(Tc);return N.toFlatObject(n,a,function(u){return u!==Error.prototype},o=>o!=="isAxiosError"),ue.call(a,n.message,e,t,r,s),a.cause=n,a.name=n.name,i&&Object.assign(a,i),a};const ty=null;function ki(n){return N.isPlainObject(n)||N.isArray(n)}function xc(n){return N.endsWith(n,"[]")?n.slice(0,-2):n}function jo(n,e,t){return n?n.concat(e).map(function(s,i){return s=xc(s),!t&&i?"["+s+"]":s}).join(t?".":""):e}function ry(n){return N.isArray(n)&&!n.some(ki)}const ny=N.toFlatObject(N,{},null,function(e){return/^is[A-Z]/.test(e)});function fs(n,e,t){if(!N.isObject(n))throw new TypeError("target must be an object");e=e||new FormData,t=N.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(b,y){return!N.isUndefined(y[b])});const r=t.metaTokens,s=t.visitor||l,i=t.dots,a=t.indexes,u=(t.Blob||typeof Blob<"u"&&Blob)&&N.isSpecCompliantForm(e);if(!N.isFunction(s))throw new TypeError("visitor must be a function");function c(f){if(f===null)return"";if(N.isDate(f))return f.toISOString();if(!u&&N.isBlob(f))throw new ue("Blob is not supported. Use a Buffer instead.");return N.isArrayBuffer(f)||N.isTypedArray(f)?u&&typeof Blob=="function"?new Blob([f]):Buffer.from(f):f}function l(f,b,y){let T=f;if(f&&!y&&typeof f=="object"){if(N.endsWith(b,"{}"))b=r?b:b.slice(0,-2),f=JSON.stringify(f);else if(N.isArray(f)&&ry(f)||(N.isFileList(f)||N.endsWith(b,"[]"))&&(T=N.toArray(f)))return b=xc(b),T.forEach(function(S,x){!(N.isUndefined(S)||S===null)&&e.append(a===!0?jo([b],x,i):a===null?b:b+"[]",c(S))}),!1}return ki(f)?!0:(e.append(jo(y,b,i),c(f)),!1)}const d=[],h=Object.assign(ny,{defaultVisitor:l,convertValue:c,isVisitable:ki});function g(f,b){if(!N.isUndefined(f)){if(d.indexOf(f)!==-1)throw Error("Circular reference detected in "+b.join("."));d.push(f),N.forEach(f,function(T,k){(!(N.isUndefined(T)||T===null)&&s.call(e,T,N.isString(k)?k.trim():k,b,h))===!0&&g(T,b?b.concat(k):[k])}),d.pop()}}if(!N.isObject(n))throw new TypeError("data must be an object");return g(n),e}function ko(n){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(n).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function sa(n,e){this._pairs=[],n&&fs(n,this,e)}const Sc=sa.prototype;Sc.append=function(e,t){this._pairs.push([e,t])};Sc.toString=function(e){const t=e?function(r){return e.call(this,r,ko)}:ko;return this._pairs.map(function(s){return t(s[0])+"="+t(s[1])},"").join("&")};function sy(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function jc(n,e,t){if(!e)return n;const r=t&&t.encode||sy,s=t&&t.serialize;let i;if(s?i=s(e,t):i=N.isURLSearchParams(e)?e.toString():new sa(e,t).toString(r),i){const a=n.indexOf("#");a!==-1&&(n=n.slice(0,a)),n+=(n.indexOf("?")===-1?"?":"&")+i}return n}class iy{constructor(){this.handlers=[]}use(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){N.forEach(this.handlers,function(r){r!==null&&e(r)})}}const Co=iy,kc={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},ay=typeof URLSearchParams<"u"?URLSearchParams:sa,oy=typeof FormData<"u"?FormData:null,uy=typeof Blob<"u"?Blob:null,cy=(()=>{let n;return typeof navigator<"u"&&((n=navigator.product)==="ReactNative"||n==="NativeScript"||n==="NS")?!1:typeof window<"u"&&typeof document<"u"})(),ly=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),pt={isBrowser:!0,classes:{URLSearchParams:ay,FormData:oy,Blob:uy},isStandardBrowserEnv:cy,isStandardBrowserWebWorkerEnv:ly,protocols:["http","https","file","blob","url","data"]};function dy(n,e){return fs(n,new pt.classes.URLSearchParams,Object.assign({visitor:function(t,r,s,i){return pt.isNode&&N.isBuffer(t)?(this.append(r,t.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)}},e))}function hy(n){return N.matchAll(/\w+|\[(\w*)]/g,n).map(e=>e[0]==="[]"?"":e[1]||e[0])}function fy(n){const e={},t=Object.keys(n);let r;const s=t.length;let i;for(r=0;r<s;r++)i=t[r],e[i]=n[i];return e}function Cc(n){function e(t,r,s,i){let a=t[i++];const o=Number.isFinite(+a),u=i>=t.length;return a=!a&&N.isArray(s)?s.length:a,u?(N.hasOwnProp(s,a)?s[a]=[s[a],r]:s[a]=r,!o):((!s[a]||!N.isObject(s[a]))&&(s[a]=[]),e(t,r,s[a],i)&&N.isArray(s[a])&&(s[a]=fy(s[a])),!o)}if(N.isFormData(n)&&N.isFunction(n.entries)){const t={};return N.forEachEntry(n,(r,s)=>{e(hy(r),s,t,0)}),t}return null}const py={"Content-Type":void 0};function my(n,e,t){if(N.isString(n))try{return(e||JSON.parse)(n),N.trim(n)}catch(r){if(r.name!=="SyntaxError")throw r}return(t||JSON.stringify)(n)}const ps={transitional:kc,adapter:["xhr","http"],transformRequest:[function(e,t){const r=t.getContentType()||"",s=r.indexOf("application/json")>-1,i=N.isObject(e);if(i&&N.isHTMLForm(e)&&(e=new FormData(e)),N.isFormData(e))return s&&s?JSON.stringify(Cc(e)):e;if(N.isArrayBuffer(e)||N.isBuffer(e)||N.isStream(e)||N.isFile(e)||N.isBlob(e))return e;if(N.isArrayBufferView(e))return e.buffer;if(N.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let o;if(i){if(r.indexOf("application/x-www-form-urlencoded")>-1)return dy(e,this.formSerializer).toString();if((o=N.isFileList(e))||r.indexOf("multipart/form-data")>-1){const u=this.env&&this.env.FormData;return fs(o?{"files[]":e}:e,u&&new u,this.formSerializer)}}return i||s?(t.setContentType("application/json",!1),my(e)):e}],transformResponse:[function(e){const t=this.transitional||ps.transitional,r=t&&t.forcedJSONParsing,s=this.responseType==="json";if(e&&N.isString(e)&&(r&&!this.responseType||s)){const a=!(t&&t.silentJSONParsing)&&s;try{return JSON.parse(e)}catch(o){if(a)throw o.name==="SyntaxError"?ue.from(o,ue.ERR_BAD_RESPONSE,this,null,this.response):o}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:pt.classes.FormData,Blob:pt.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};N.forEach(["delete","get","head"],function(e){ps.headers[e]={}});N.forEach(["post","put","patch"],function(e){ps.headers[e]=N.merge(py)});const ia=ps,yy=N.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),gy=n=>{const e={};let t,r,s;return n&&n.split(`
`).forEach(function(a){s=a.indexOf(":"),t=a.substring(0,s).trim().toLowerCase(),r=a.substring(s+1).trim(),!(!t||e[t]&&yy[t])&&(t==="set-cookie"?e[t]?e[t].push(r):e[t]=[r]:e[t]=e[t]?e[t]+", "+r:r)}),e},Io=Symbol("internals");function kr(n){return n&&String(n).trim().toLowerCase()}function Un(n){return n===!1||n==null?n:N.isArray(n)?n.map(Un):String(n)}function by(n){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=t.exec(n);)e[r[1]]=r[2];return e}const _y=n=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(n.trim());function ui(n,e,t,r,s){if(N.isFunction(r))return r.call(this,e,t);if(s&&(e=t),!!N.isString(e)){if(N.isString(r))return e.indexOf(r)!==-1;if(N.isRegExp(r))return r.test(e)}}function vy(n){return n.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,r)=>t.toUpperCase()+r)}function wy(n,e){const t=N.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(n,r+t,{value:function(s,i,a){return this[r].call(this,e,s,i,a)},configurable:!0})})}class ms{constructor(e){e&&this.set(e)}set(e,t,r){const s=this;function i(o,u,c){const l=kr(u);if(!l)throw new Error("header name must be a non-empty string");const d=N.findKey(s,l);(!d||s[d]===void 0||c===!0||c===void 0&&s[d]!==!1)&&(s[d||u]=Un(o))}const a=(o,u)=>N.forEach(o,(c,l)=>i(c,l,u));return N.isPlainObject(e)||e instanceof this.constructor?a(e,t):N.isString(e)&&(e=e.trim())&&!_y(e)?a(gy(e),t):e!=null&&i(t,e,r),this}get(e,t){if(e=kr(e),e){const r=N.findKey(this,e);if(r){const s=this[r];if(!t)return s;if(t===!0)return by(s);if(N.isFunction(t))return t.call(this,s,r);if(N.isRegExp(t))return t.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=kr(e),e){const r=N.findKey(this,e);return!!(r&&this[r]!==void 0&&(!t||ui(this,this[r],r,t)))}return!1}delete(e,t){const r=this;let s=!1;function i(a){if(a=kr(a),a){const o=N.findKey(r,a);o&&(!t||ui(r,r[o],o,t))&&(delete r[o],s=!0)}}return N.isArray(e)?e.forEach(i):i(e),s}clear(e){const t=Object.keys(this);let r=t.length,s=!1;for(;r--;){const i=t[r];(!e||ui(this,this[i],i,e,!0))&&(delete this[i],s=!0)}return s}normalize(e){const t=this,r={};return N.forEach(this,(s,i)=>{const a=N.findKey(r,i);if(a){t[a]=Un(s),delete t[i];return}const o=e?vy(i):String(i).trim();o!==i&&delete t[i],t[o]=Un(s),r[o]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return N.forEach(this,(r,s)=>{r!=null&&r!==!1&&(t[s]=e&&N.isArray(r)?r.join(", "):r)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const r=new this(e);return t.forEach(s=>r.set(s)),r}static accessor(e){const r=(this[Io]=this[Io]={accessors:{}}).accessors,s=this.prototype;function i(a){const o=kr(a);r[o]||(wy(s,a),r[o]=!0)}return N.isArray(e)?e.forEach(i):i(e),this}}ms.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);N.freezeMethods(ms.prototype);N.freezeMethods(ms);const Pt=ms;function ci(n,e){const t=this||ia,r=e||t,s=Pt.from(r.headers);let i=r.data;return N.forEach(n,function(o){i=o.call(t,i,s.normalize(),e?e.status:void 0)}),s.normalize(),i}function Ic(n){return!!(n&&n.__CANCEL__)}function mn(n,e,t){ue.call(this,n??"canceled",ue.ERR_CANCELED,e,t),this.name="CanceledError"}N.inherits(mn,ue,{__CANCEL__:!0});function Oy(n,e,t){const r=t.config.validateStatus;!t.status||!r||r(t.status)?n(t):e(new ue("Request failed with status code "+t.status,[ue.ERR_BAD_REQUEST,ue.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}const Ey=pt.isStandardBrowserEnv?function(){return{write:function(t,r,s,i,a,o){const u=[];u.push(t+"="+encodeURIComponent(r)),N.isNumber(s)&&u.push("expires="+new Date(s).toGMTString()),N.isString(i)&&u.push("path="+i),N.isString(a)&&u.push("domain="+a),o===!0&&u.push("secure"),document.cookie=u.join("; ")},read:function(t){const r=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return r?decodeURIComponent(r[3]):null},remove:function(t){this.write(t,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}();function Ay(n){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(n)}function Ty(n,e){return e?n.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):n}function Rc(n,e){return n&&!Ay(e)?Ty(n,e):e}const Py=pt.isStandardBrowserEnv?function(){const e=/(msie|trident)/i.test(navigator.userAgent),t=document.createElement("a");let r;function s(i){let a=i;return e&&(t.setAttribute("href",a),a=t.href),t.setAttribute("href",a),{href:t.href,protocol:t.protocol?t.protocol.replace(/:$/,""):"",host:t.host,search:t.search?t.search.replace(/^\?/,""):"",hash:t.hash?t.hash.replace(/^#/,""):"",hostname:t.hostname,port:t.port,pathname:t.pathname.charAt(0)==="/"?t.pathname:"/"+t.pathname}}return r=s(window.location.href),function(a){const o=N.isString(a)?s(a):a;return o.protocol===r.protocol&&o.host===r.host}}():function(){return function(){return!0}}();function xy(n){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(n);return e&&e[1]||""}function Sy(n,e){n=n||10;const t=new Array(n),r=new Array(n);let s=0,i=0,a;return e=e!==void 0?e:1e3,function(u){const c=Date.now(),l=r[i];a||(a=c),t[s]=u,r[s]=c;let d=i,h=0;for(;d!==s;)h+=t[d++],d=d%n;if(s=(s+1)%n,s===i&&(i=(i+1)%n),c-a<e)return;const g=l&&c-l;return g?Math.round(h*1e3/g):void 0}}function Ro(n,e){let t=0;const r=Sy(50,250);return s=>{const i=s.loaded,a=s.lengthComputable?s.total:void 0,o=i-t,u=r(o),c=i<=a;t=i;const l={loaded:i,total:a,progress:a?i/a:void 0,bytes:o,rate:u||void 0,estimated:u&&a&&c?(a-i)/u:void 0,event:s};l[e?"download":"upload"]=!0,n(l)}}const jy=typeof XMLHttpRequest<"u",ky=jy&&function(n){return new Promise(function(t,r){let s=n.data;const i=Pt.from(n.headers).normalize(),a=n.responseType;let o;function u(){n.cancelToken&&n.cancelToken.unsubscribe(o),n.signal&&n.signal.removeEventListener("abort",o)}N.isFormData(s)&&(pt.isStandardBrowserEnv||pt.isStandardBrowserWebWorkerEnv?i.setContentType(!1):i.setContentType("multipart/form-data;",!1));let c=new XMLHttpRequest;if(n.auth){const g=n.auth.username||"",f=n.auth.password?unescape(encodeURIComponent(n.auth.password)):"";i.set("Authorization","Basic "+btoa(g+":"+f))}const l=Rc(n.baseURL,n.url);c.open(n.method.toUpperCase(),jc(l,n.params,n.paramsSerializer),!0),c.timeout=n.timeout;function d(){if(!c)return;const g=Pt.from("getAllResponseHeaders"in c&&c.getAllResponseHeaders()),b={data:!a||a==="text"||a==="json"?c.responseText:c.response,status:c.status,statusText:c.statusText,headers:g,config:n,request:c};Oy(function(T){t(T),u()},function(T){r(T),u()},b),c=null}if("onloadend"in c?c.onloadend=d:c.onreadystatechange=function(){!c||c.readyState!==4||c.status===0&&!(c.responseURL&&c.responseURL.indexOf("file:")===0)||setTimeout(d)},c.onabort=function(){c&&(r(new ue("Request aborted",ue.ECONNABORTED,n,c)),c=null)},c.onerror=function(){r(new ue("Network Error",ue.ERR_NETWORK,n,c)),c=null},c.ontimeout=function(){let f=n.timeout?"timeout of "+n.timeout+"ms exceeded":"timeout exceeded";const b=n.transitional||kc;n.timeoutErrorMessage&&(f=n.timeoutErrorMessage),r(new ue(f,b.clarifyTimeoutError?ue.ETIMEDOUT:ue.ECONNABORTED,n,c)),c=null},pt.isStandardBrowserEnv){const g=(n.withCredentials||Py(l))&&n.xsrfCookieName&&Ey.read(n.xsrfCookieName);g&&i.set(n.xsrfHeaderName,g)}s===void 0&&i.setContentType(null),"setRequestHeader"in c&&N.forEach(i.toJSON(),function(f,b){c.setRequestHeader(b,f)}),N.isUndefined(n.withCredentials)||(c.withCredentials=!!n.withCredentials),a&&a!=="json"&&(c.responseType=n.responseType),typeof n.onDownloadProgress=="function"&&c.addEventListener("progress",Ro(n.onDownloadProgress,!0)),typeof n.onUploadProgress=="function"&&c.upload&&c.upload.addEventListener("progress",Ro(n.onUploadProgress)),(n.cancelToken||n.signal)&&(o=g=>{c&&(r(!g||g.type?new mn(null,n,c):g),c.abort(),c=null)},n.cancelToken&&n.cancelToken.subscribe(o),n.signal&&(n.signal.aborted?o():n.signal.addEventListener("abort",o)));const h=xy(l);if(h&&pt.protocols.indexOf(h)===-1){r(new ue("Unsupported protocol "+h+":",ue.ERR_BAD_REQUEST,n));return}c.send(s||null)})},Mn={http:ty,xhr:ky};N.forEach(Mn,(n,e)=>{if(n){try{Object.defineProperty(n,"name",{value:e})}catch{}Object.defineProperty(n,"adapterName",{value:e})}});const Cy={getAdapter:n=>{n=N.isArray(n)?n:[n];const{length:e}=n;let t,r;for(let s=0;s<e&&(t=n[s],!(r=N.isString(t)?Mn[t.toLowerCase()]:t));s++);if(!r)throw r===!1?new ue(`Adapter ${t} is not supported by the environment`,"ERR_NOT_SUPPORT"):new Error(N.hasOwnProp(Mn,t)?`Adapter '${t}' is not available in the build`:`Unknown adapter '${t}'`);if(!N.isFunction(r))throw new TypeError("adapter is not a function");return r},adapters:Mn};function li(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new mn(null,n)}function Do(n){return li(n),n.headers=Pt.from(n.headers),n.data=ci.call(n,n.transformRequest),["post","put","patch"].indexOf(n.method)!==-1&&n.headers.setContentType("application/x-www-form-urlencoded",!1),Cy.getAdapter(n.adapter||ia.adapter)(n).then(function(r){return li(n),r.data=ci.call(n,n.transformResponse,r),r.headers=Pt.from(r.headers),r},function(r){return Ic(r)||(li(n),r&&r.response&&(r.response.data=ci.call(n,n.transformResponse,r.response),r.response.headers=Pt.from(r.response.headers))),Promise.reject(r)})}const No=n=>n instanceof Pt?n.toJSON():n;function lr(n,e){e=e||{};const t={};function r(c,l,d){return N.isPlainObject(c)&&N.isPlainObject(l)?N.merge.call({caseless:d},c,l):N.isPlainObject(l)?N.merge({},l):N.isArray(l)?l.slice():l}function s(c,l,d){if(N.isUndefined(l)){if(!N.isUndefined(c))return r(void 0,c,d)}else return r(c,l,d)}function i(c,l){if(!N.isUndefined(l))return r(void 0,l)}function a(c,l){if(N.isUndefined(l)){if(!N.isUndefined(c))return r(void 0,c)}else return r(void 0,l)}function o(c,l,d){if(d in e)return r(c,l);if(d in n)return r(void 0,c)}const u={url:i,method:i,data:i,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:o,headers:(c,l)=>s(No(c),No(l),!0)};return N.forEach(Object.keys(Object.assign({},n,e)),function(l){const d=u[l]||s,h=d(n[l],e[l],l);N.isUndefined(h)&&d!==o||(t[l]=h)}),t}const Dc="1.4.0",aa={};["object","boolean","number","function","string","symbol"].forEach((n,e)=>{aa[n]=function(r){return typeof r===n||"a"+(e<1?"n ":" ")+n}});const Lo={};aa.transitional=function(e,t,r){function s(i,a){return"[Axios v"+Dc+"] Transitional option '"+i+"'"+a+(r?". "+r:"")}return(i,a,o)=>{if(e===!1)throw new ue(s(a," has been removed"+(t?" in "+t:"")),ue.ERR_DEPRECATED);return t&&!Lo[a]&&(Lo[a]=!0,console.warn(s(a," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(i,a,o):!0}};function Iy(n,e,t){if(typeof n!="object")throw new ue("options must be an object",ue.ERR_BAD_OPTION_VALUE);const r=Object.keys(n);let s=r.length;for(;s-- >0;){const i=r[s],a=e[i];if(a){const o=n[i],u=o===void 0||a(o,i,n);if(u!==!0)throw new ue("option "+i+" must be "+u,ue.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new ue("Unknown option "+i,ue.ERR_BAD_OPTION)}}const Ci={assertOptions:Iy,validators:aa},Ct=Ci.validators;class Zn{constructor(e){this.defaults=e,this.interceptors={request:new Co,response:new Co}}request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=lr(this.defaults,t);const{transitional:r,paramsSerializer:s,headers:i}=t;r!==void 0&&Ci.assertOptions(r,{silentJSONParsing:Ct.transitional(Ct.boolean),forcedJSONParsing:Ct.transitional(Ct.boolean),clarifyTimeoutError:Ct.transitional(Ct.boolean)},!1),s!=null&&(N.isFunction(s)?t.paramsSerializer={serialize:s}:Ci.assertOptions(s,{encode:Ct.function,serialize:Ct.function},!0)),t.method=(t.method||this.defaults.method||"get").toLowerCase();let a;a=i&&N.merge(i.common,i[t.method]),a&&N.forEach(["delete","get","head","post","put","patch","common"],f=>{delete i[f]}),t.headers=Pt.concat(a,i);const o=[];let u=!0;this.interceptors.request.forEach(function(b){typeof b.runWhen=="function"&&b.runWhen(t)===!1||(u=u&&b.synchronous,o.unshift(b.fulfilled,b.rejected))});const c=[];this.interceptors.response.forEach(function(b){c.push(b.fulfilled,b.rejected)});let l,d=0,h;if(!u){const f=[Do.bind(this),void 0];for(f.unshift.apply(f,o),f.push.apply(f,c),h=f.length,l=Promise.resolve(t);d<h;)l=l.then(f[d++],f[d++]);return l}h=o.length;let g=t;for(d=0;d<h;){const f=o[d++],b=o[d++];try{g=f(g)}catch(y){b.call(this,y);break}}try{l=Do.call(this,g)}catch(f){return Promise.reject(f)}for(d=0,h=c.length;d<h;)l=l.then(c[d++],c[d++]);return l}getUri(e){e=lr(this.defaults,e);const t=Rc(e.baseURL,e.url);return jc(t,e.params,e.paramsSerializer)}}N.forEach(["delete","get","head","options"],function(e){Zn.prototype[e]=function(t,r){return this.request(lr(r||{},{method:e,url:t,data:(r||{}).data}))}});N.forEach(["post","put","patch"],function(e){function t(r){return function(i,a,o){return this.request(lr(o||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:i,data:a}))}}Zn.prototype[e]=t(),Zn.prototype[e+"Form"]=t(!0)});const Fn=Zn;class oa{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(i){t=i});const r=this;this.promise.then(s=>{if(!r._listeners)return;let i=r._listeners.length;for(;i-- >0;)r._listeners[i](s);r._listeners=null}),this.promise.then=s=>{let i;const a=new Promise(o=>{r.subscribe(o),i=o}).then(s);return a.cancel=function(){r.unsubscribe(i)},a},e(function(i,a,o){r.reason||(r.reason=new mn(i,a,o),t(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}static source(){let e;return{token:new oa(function(s){e=s}),cancel:e}}}const Ry=oa;function Dy(n){return function(t){return n.apply(null,t)}}function Ny(n){return N.isObject(n)&&n.isAxiosError===!0}const Ii={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(Ii).forEach(([n,e])=>{Ii[e]=n});const Ly=Ii;function Nc(n){const e=new Fn(n),t=gc(Fn.prototype.request,e);return N.extend(t,Fn.prototype,e,{allOwnKeys:!0}),N.extend(t,e,null,{allOwnKeys:!0}),t.create=function(s){return Nc(lr(n,s))},t}const Se=Nc(ia);Se.Axios=Fn;Se.CanceledError=mn;Se.CancelToken=Ry;Se.isCancel=Ic;Se.VERSION=Dc;Se.toFormData=fs;Se.AxiosError=ue;Se.Cancel=Se.CanceledError;Se.all=function(e){return Promise.all(e)};Se.spread=Dy;Se.isAxiosError=Ny;Se.mergeConfig=lr;Se.AxiosHeaders=Pt;Se.formToJSON=n=>Cc(N.isHTMLForm(n)?new FormData(n):n);Se.HttpStatusCode=Ly;Se.default=Se;const kn=Se,Ri="text/event-stream";async function $y(n,e){const t=n.getReader();for(;;){const r=await t.read();if(r.done){e(new Uint8Array,!0);break}e(r.value)}}function Uy(n){let e,t,r,s=!1;return function(a,o){if(o){n(a,0,!0);return}e===void 0?(e=a,t=0,r=-1):e=Fy(e,a);const u=e.length;let c=0;for(;t<u;){s&&(e[t]===10&&(c=++t),s=!1);let l=-1;for(;t<u&&l===-1;++t)switch(e[t]){case 58:r===-1&&(r=t-c);break;case 13:s=!0;case 10:l=t;break}if(l===-1)break;n(e.subarray(c,l),r),c=t,r=-1}c===u?e=void 0:c!==0&&(e=e.subarray(c),t-=c)}}function My(n,e,t){let r=di();const s=new TextDecoder;return function(a,o,u){if(u){By(r)||(n==null||n(r),r=di());return}if(a.length===0)n==null||n(r),r=di();else if(o>0){const c=s.decode(a.subarray(0,o)),l=o+(a[o+1]===32?2:1),d=s.decode(a.subarray(l));switch(c){case"data":r.data=r.data?r.data+`
`+d:d;break;case"event":r.event=d;break;case"id":e==null||e(r.id=d);break;case"retry":{const h=parseInt(d,10);Number.isNaN(h)||t==null||t(r.retry=h);break}}}}}function Fy(n,e){const t=new Uint8Array(n.length+e.length);return t.set(n),t.set(e,n.length),t}function di(){return{data:"",event:"",id:"",retry:void 0}}function By(n){return n.data===""&&n.event===""&&n.id===""&&n.retry===void 0}function Vy(n){try{return JSON.stringify(n)}catch{return n}}function qy(n,e,t){const{validateStatus:r}=t.config;!t.status||!r||r(t.status)?n(t):e(Bn(`Request failed with status code ${t.status} and body ${typeof t.data=="string"?t.data:Vy(t.data)}`,t.config,null,t.request,t))}function zy(n){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(n)}function Hy(n,e){return e?n.replace(/\/+$/,"")+"/"+e.replace(/^\/+/,""):n}function $o(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Ky(n,e,t){if(!e)return n;var r;if(t)r=t(e);else if(Wy(e))r=e.toString();else{var s=[];Uo(e,function(o,u){o===null||typeof o>"u"||(Lc(o)?u=`${u}[]`:o=[o],Uo(o,function(l){Yy(l)?l=l.toISOString():Gy(l)&&(l=JSON.stringify(l)),s.push(`${$o(u)}=${$o(l)}`)}))}),r=s.join("&")}if(r){var i=n.indexOf("#");i!==-1&&(n=n.slice(0,i)),n+=(n.indexOf("?")===-1?"?":"&")+r}return n}function Zy(n,e){return n&&!zy(e)?Hy(n,e):e}function Jy(n){return typeof n>"u"}function Gy(n){return n!==null&&typeof n=="object"}function Yy(n){return toString.call(n)==="[object Date]"}function Wy(n){return toString.call(n)==="[object URLSearchParams]"}function Lc(n){return Array.isArray(n)}function Uo(n,e){if(!(n===null||typeof n>"u"))if(typeof n!="object"&&(n=[n]),Lc(n))for(var t=0,r=n.length;t<r;t++)e.call(null,n[t],t,n);else for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.call(null,n[s],s,n)}function Qy(n){return toString.call(n)==="[object FormData]"}function Xy(){return typeof navigator<"u"&&(navigator.product==="ReactNative"||navigator.product==="NativeScript"||navigator.product==="NS")?!1:typeof window<"u"&&typeof document<"u"}async function eg(n){const e=rg(n),t=await tg(e,n);return new Promise((r,s)=>{t instanceof Error?s(t):Object.prototype.toString.call(n.settle)==="[object Function]"?n.settle(r,s,t):qy(r,s,t)})}async function tg(n,e){let t;try{t=await fetch(n)}catch(i){return i&&i.name==="AbortError"?Bn("Request aborted",e,"ECONNABORTED",n):i&&i.name==="TimeoutError"?Bn("Request timeout",e,"ECONNABORTED",n):Bn("Network Error",e,"ERR_NETWORK",n)}const r={};t.headers.forEach((i,a)=>{r[a]=i});const s={ok:t.ok,status:t.status,statusText:t.statusText,headers:r,config:e,request:n};if(t.status>=200&&t.status!==204)if(e.responseType==="stream"){const i=t.headers.get("content-type");if(!(i!=null&&i.startsWith(Ri))){if(t.status>=400)return i!=null&&i.startsWith("application/json")?(s.data=await t.json(),s):(s.data=await t.text(),s);throw new Error(`Expected content-type to be ${Ri}, Actual: ${i}`)}await $y(t.body,Uy(My(e.onmessage)))}else switch(e.responseType){case"arraybuffer":s.data=await t.arrayBuffer();break;case"blob":s.data=await t.blob();break;case"json":s.data=await t.json();break;case"formData":s.data=await t.formData();break;default:s.data=await t.text();break}return s}function rg(n){const e=new Headers(n.headers);if(n.auth){const a=n.auth.username||"",o=n.auth.password?decodeURI(encodeURIComponent(n.auth.password)):"";e.set("Authorization",`Basic ${btoa(`${a}:${o}`)}`)}const t=n.method.toUpperCase(),r={headers:e,method:t};t!=="GET"&&t!=="HEAD"&&(r.body=n.data,Qy(r.body)&&Xy()&&e.delete("Content-Type")),typeof r.body=="string"&&(r.body=new TextEncoder().encode(r.body)),n.mode&&(r.mode=n.mode),n.cache&&(r.cache=n.cache),n.integrity&&(r.integrity=n.integrity),n.redirect&&(r.redirect=n.redirect),n.referrer&&(r.referrer=n.referrer),n.timeout&&n.timeout>0&&(r.signal=AbortSignal.timeout(n.timeout)),n.signal&&(r.signal=n.signal),Jy(n.withCredentials)||(r.credentials=n.withCredentials?"include":"omit"),n.responseType==="stream"&&r.headers.set("Accept",Ri);const s=Zy(n.baseURL,n.url),i=Ky(s,n.params,n.paramsSerializer);return new Request(i,r)}function Bn(n,e,t,r,s){if(kn.AxiosError&&typeof kn.AxiosError=="function")return new kn.AxiosError(n,kn.AxiosError[t],e,r,s);const i=new Error(n);return ng(i,e,t,r,s)}function ng(n,e,t,r,s){return n.config=e,t&&(n.code=t),n.request=r,n.response=s,n.isAxiosError=!0,n.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},n}const sg=(n,e)=>n.reduce((t,r,s)=>{const i=Math.floor(s/e),a=t[i]||[];return t[i]=a.concat([r]),t},[]);function ig(n){const{azureOpenAIApiDeploymentName:e,azureOpenAIApiInstanceName:t,azureOpenAIApiKey:r,azureOpenAIBasePath:s,basePath:i}=n;if(r&&s&&e)return`${s}/${e}`;if(r){if(!t)throw new Error("azureOpenAIApiInstanceName is required when using azureOpenAIApiKey");if(!e)throw new Error("azureOpenAIApiDeploymentName is a required parameter when using azureOpenAIApiKey");return`https://${t}.openai.azure.com/openai/deployments/${e}`}return i}class $c extends Ju{constructor(e,t){super(e??{}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"text-embedding-ada-002"}),Object.defineProperty(this,"batchSize",{enumerable:!0,configurable:!0,writable:!0,value:512}),Object.defineProperty(this,"stripNewLines",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIBasePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const r=(e==null?void 0:e.openAIApiKey)??Ce("OPENAI_API_KEY"),s=(e==null?void 0:e.azureOpenAIApiKey)??Ce("AZURE_OPENAI_API_KEY");if(!s&&!r)throw new Error("OpenAI or Azure OpenAI API key not found");const i=(e==null?void 0:e.azureOpenAIApiInstanceName)??Ce("AZURE_OPENAI_API_INSTANCE_NAME"),a=((e==null?void 0:e.azureOpenAIApiEmbeddingsDeploymentName)||(e==null?void 0:e.azureOpenAIApiDeploymentName))??(Ce("AZURE_OPENAI_API_EMBEDDINGS_DEPLOYMENT_NAME")||Ce("AZURE_OPENAI_API_DEPLOYMENT_NAME")),o=(e==null?void 0:e.azureOpenAIApiVersion)??Ce("AZURE_OPENAI_API_VERSION");if(this.azureOpenAIBasePath=(e==null?void 0:e.azureOpenAIBasePath)??Ce("AZURE_OPENAI_BASE_PATH"),this.modelName=(e==null?void 0:e.modelName)??this.modelName,this.batchSize=(e==null?void 0:e.batchSize)??(s?1:this.batchSize),this.stripNewLines=(e==null?void 0:e.stripNewLines)??this.stripNewLines,this.timeout=e==null?void 0:e.timeout,this.azureOpenAIApiVersion=o,this.azureOpenAIApiKey=s,this.azureOpenAIApiInstanceName=i,this.azureOpenAIApiDeploymentName=a,this.azureOpenAIApiKey){if(!this.azureOpenAIApiInstanceName)throw new Error("Azure OpenAI API instance name not found");if(!this.azureOpenAIApiDeploymentName)throw new Error("Azure OpenAI API deployment name not found");if(!this.azureOpenAIApiVersion)throw new Error("Azure OpenAI API version not found")}this.clientConfig={apiKey:r,...t}}async embedDocuments(e){const t=sg(this.stripNewLines?e.map(s=>s.replace(/\n/g," ")):e,this.batchSize),r=[];for(let s=0;s<t.length;s+=1){const i=t[s],{data:a}=await this.embeddingWithRetry({model:this.modelName,input:i});for(let o=0;o<i.length;o+=1)r.push(a.data[o].embedding)}return r}async embedQuery(e){const{data:t}=await this.embeddingWithRetry({model:this.modelName,input:this.stripNewLines?e.replace(/\n/g," "):e});return t.data[0].embedding}async embeddingWithRetry(e){if(!this.client){const r={azureOpenAIApiDeploymentName:this.azureOpenAIApiDeploymentName,azureOpenAIApiInstanceName:this.azureOpenAIApiInstanceName,azureOpenAIApiKey:this.azureOpenAIApiKey,azureOpenAIBasePath:this.azureOpenAIBasePath,basePath:this.clientConfig.basePath},s=ig(r),i=new Ti.Configuration({...this.clientConfig,basePath:s,baseOptions:{timeout:this.timeout,adapter:Yu()?void 0:eg,...this.clientConfig.baseOptions}});this.client=new Ti.OpenAIApi(i)}const t={};return this.azureOpenAIApiKey&&(t.headers={"api-key":this.azureOpenAIApiKey,...t.headers},t.params={"api-version":this.azureOpenAIApiVersion,...t.params}),this.caller.call(this.client.createEmbedding.bind(this.client),e,t)}}let Cn;const ag=new Uint8Array(16);function og(){if(!Cn&&(Cn=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Cn))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Cn(ag)}const Ie=[];for(let n=0;n<256;++n)Ie.push((n+256).toString(16).slice(1));function ug(n,e=0){return(Ie[n[e+0]]+Ie[n[e+1]]+Ie[n[e+2]]+Ie[n[e+3]]+"-"+Ie[n[e+4]]+Ie[n[e+5]]+"-"+Ie[n[e+6]]+Ie[n[e+7]]+"-"+Ie[n[e+8]]+Ie[n[e+9]]+"-"+Ie[n[e+10]]+Ie[n[e+11]]+Ie[n[e+12]]+Ie[n[e+13]]+Ie[n[e+14]]+Ie[n[e+15]]).toLowerCase()}const cg=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Mo={randomUUID:cg};function Zt(n,e,t){if(Mo.randomUUID&&!e&&!n)return Mo.randomUUID();n=n||{};const r=n.random||(n.rng||og)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){t=t||0;for(let s=0;s<16;++s)e[t+s]=r[s];return e}return ug(r)}async function ua(n,e,t,r,s,i,a){const o=e.name,u=e.size,c=new Date;let l;const d=s,h=i,g=new Yr({chunkSize:d,chunkOverlap:h});let f;if(console.log("isUrl",a),a===!0){console.log("isUrl",a);const $=new FileReader;$.onload=async function(A){const C=A.target.result;console.log("fileContent",C);const _={pageContent:C.toString(),metadata:{file_sha1:l,file_size:u,file_name:o,chunk_size:s,chunk_overlap:i,date:c}};f=await g.splitDocuments([_]),console.log("splittedDocuments",f),l=await Lu(C);const w=[];for(const I of f){const D={pageContent:I.pageContent,metadata:{file_sha1:l,file_size:u,file_name:o,chunk_size:s,chunk_overlap:i,date:c}};w.push(D)}const j=Gt("https://jqfandcxceztebtpwzxd.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpxZmFuZGN4Y2V6dGVidHB3enhkIiwicm9sZSI6ImFub24iLCJpYXQiOjE2ODkzNzI0NzUsImV4cCI6MjAwNDk0ODQ3NX0.MXs4u_1XMM-foNe08LLYHQLENjmwTF3jqUmNXCSbOU4"),H=new Kn({apiKey:"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"});let O=new Wt(H,{client:j,tableName:"documents"});console.log(w),O.addDocuments(w)},await $.readAsText(e)}else{const $=new File([e],o,{type:e.type});l=await Xd($);const C=await new t($).load();f=await g.splitDocuments(C)}const b=[];for(const $ of f){const A={pageContent:$.pageContent,metadata:{file_sha1:l,file_size:u,file_name:o,chunk_size:s,chunk_overlap:i,date:c}};b.push(A)}const k=Gt("https://jqfandcxceztebtpwzxd.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpxZmFuZGN4Y2V6dGVidHB3enhkIiwicm9sZSI6ImFub24iLCJpYXQiOjE2ODkzNzI0NzUsImV4cCI6MjAwNDk0ODQ3NX0.MXs4u_1XMM-foNe08LLYHQLENjmwTF3jqUmNXCSbOU4"),S=new Kn({apiKey:"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"});let x=new Wt(S,{client:k,tableName:"documents"});console.log(b),x.addDocuments(b)}class Uc{async loadAndSplit(e=new Yr){const t=await this.load();return e.splitDocuments(t)}}class ca extends Uc{constructor(e){super(),Object.defineProperty(this,"filePathOrBlob",{enumerable:!0,configurable:!0,writable:!0,value:e})}async parse(e){return[e]}async load(){let e,t;if(typeof this.filePathOrBlob=="string"){const{readFile:s}=await ca.imports();e=await s(this.filePathOrBlob,"utf8"),t={source:this.filePathOrBlob}}else e=await this.filePathOrBlob.text(),t={source:"blob",blobType:this.filePathOrBlob.type};const r=await this.parse(e);return r.forEach((s,i)=>{if(typeof s!="string")throw new Error(`Expected string, at position ${i} got ${typeof s}`)}),r.map((s,i)=>new Gr({pageContent:s,metadata:r.length===1?t:{...t,line:i+1}}))}static async imports(){try{const{readFile:e}=await Te(()=>import("./promises.0ef77ad7.js"),[]);return{readFile:e}}catch(e){throw console.error(e),new Error(`Failed to load fs/promises. TextLoader available only on environment 'node'. It appears you are running environment '${Gi()}'. See https://<link to docs> for alternatives.`)}}}function lg(n,e){return ua(n,e,ca,".txt",500,0)}class Mc extends Uc{constructor(e,t={}){super(),Object.defineProperty(this,"filePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiUrl",{enumerable:!0,configurable:!0,writable:!0,value:"https://api.unstructured.io/general/v0/general"}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"strategy",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof t=="string"?(this.filePath=t,this.apiUrl=e):(this.filePath=e,this.apiKey=t.apiKey,this.apiUrl=t.apiUrl??this.apiUrl,this.strategy=t.strategy??"hi_res")}async _partition(){const{readFile:e,basename:t}=await this.imports(),r=await e(this.filePath),s=t(this.filePath),i=new FormData;i.append("files",new Blob([r]),s),i.append("strategy",this.strategy);const a={"UNSTRUCTURED-API-KEY":this.apiKey??""},o=await fetch(this.apiUrl,{method:"POST",body:i,headers:a});if(!o.ok)throw new Error(`Failed to partition file ${this.filePath} with error ${o.status} and message ${await o.text()}`);const u=await o.json();if(!Array.isArray(u))throw new Error(`Expected partitioning request to return an array, but got ${u}`);return u.filter(c=>typeof c.text=="string")}async load(){const e=await this._partition(),t=[];for(const r of e){const{metadata:s,text:i}=r;t.push(new Gr({pageContent:i,metadata:{...s,category:r.type}}))}return t}async imports(){try{const{readFile:e}=await Te(()=>import("./promises.0ef77ad7.js"),[]),{basename:t}=await Te(()=>import("./__vite-browser-external_node_path.042c5bd1.js"),[]);return{readFile:e,basename:t}}catch(e){throw console.error(e),new Error(`Failed to load fs/promises. TextLoader available only on environment 'node'. It appears you are running environment '${Gi()}'. See https://<link to docs> for alternatives.`)}}}new Proxy({},{get(n,e){throw new Error(`Module "fs" has been externalized for browser compatibility. Cannot access "fs.${e}" in client code.  See http://vitejs.dev/guide/troubleshooting.html#module-externalized-for-browser-compatibility for more details.`)}});async function dg(n,e){return ua(n,e,Mc)}async function hg(n){try{const t=`/api?${new URLSearchParams({url:n}).toString()}`,r=await fetch(t,{method:"GET"});return r.status===200?await r.text():null}catch{return null}}class fg extends Blob{constructor(e,t){super(e,t),this.name=t.name,this.lastModifiedDate=new Date}}function pg(n,e){const t=mg(n)+".html";return new fg([e],{type:"text/html",name:t})}function mg(n){return n=n.normalize("NFKD").replace(/[\u0300-\u036f]/g,""),n=n.replace(/[^\w\s-]/g,"").trim().toLowerCase(),n=n.replace(/[-\s]+/g,"-"),n}const Fo={".txt":lg,".html":dg};async function Bo(n,e,t,r){Array.isArray(r)||(r=[r]),console.log(r);for(const s of r)await gg(s,n)}async function yg(n,e){const t=Lu(e);let r=Gt("https://jqfandcxceztebtpwzxd.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpxZmFuZGN4Y2V6dGVidHB3enhkIiwicm9sZSI6ImFub24iLCJpYXQiOjE2ODkzNzI0NzUsImV4cCI6MjAwNDk0ODQ3NX0.MXs4u_1XMM-foNe08LLYHQLENjmwTF3jqUmNXCSbOU4");const{data:s,error:i}=await r.from("documents").select("id").eq("metadata->>file_sha1",t);return i?(console.log(`Error retrieving data: ${i.message}`),!1):s.length>0}async function gg(n,e,t){if(await yg(e,n))return console.log(` ${n.name} is already in the database.`),!1;if(n.size<1)return console.log(` ${n.name} is empty.`),!1;{const r=`.${n.name.split(".").pop()}`;if(console.log(n.name,r),r in Fo){const s="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";let i=Gt("https://jqfandcxceztebtpwzxd.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpxZmFuZGN4Y2V6dGVidHB3enhkIiwicm9sZSI6ImFub24iLCJpYXQiOjE2ODkzNzI0NzUsImV4cCI6MjAwNDk0ODQ3NX0.MXs4u_1XMM-foNe08LLYHQLENjmwTF3jqUmNXCSbOU4"),a=new $c({openAIApiKey:s}),o=new Wt(a,{client:i,tableName:"documents"});return await Fo[r](o,n),console.log(` ${n.name}`),!0}else return console.log(` ${n.name} is not a valid file type.`),!1}}async function Vo(n,e,t,r){const s=await hg(r);console.log(s);const i=pg(r,s);console.log(i),await ua(t,i,Mc,".html",500,0,!0)}class bg{}class yn extends bg{get lc_namespace(){return["langchain","callbacks",this.name]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}constructor(e){var t;super(),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ignoreLLM",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreChain",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreAgent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"awaitHandlers",{enumerable:!0,configurable:!0,writable:!0,value:typeof process<"u"?((t=process.env)==null?void 0:t.LANGCHAIN_CALLBACKS_BACKGROUND)!=="true":!0}),this.lc_kwargs=e||{},e&&(this.ignoreLLM=e.ignoreLLM??this.ignoreLLM,this.ignoreChain=e.ignoreChain??this.ignoreChain,this.ignoreAgent=e.ignoreAgent??this.ignoreAgent)}copy(){return new this.constructor(this)}toJSON(){return ct.prototype.toJSON.call(this)}toJSONNotImplemented(){return ct.prototype.toJSONNotImplemented.call(this)}static fromMethods(e){class t extends yn{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:Zt()}),Object.assign(this,e)}}return new t}}var la={exports:{}};la.exports;(function(n){const t=(i=0)=>a=>`\x1B[${38+i};5;${a}m`,r=(i=0)=>(a,o,u)=>`\x1B[${38+i};2;${a};${o};${u}m`;function s(){const i=new Map,a={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};a.color.gray=a.color.blackBright,a.bgColor.bgGray=a.bgColor.bgBlackBright,a.color.grey=a.color.blackBright,a.bgColor.bgGrey=a.bgColor.bgBlackBright;for(const[o,u]of Object.entries(a)){for(const[c,l]of Object.entries(u))a[c]={open:`\x1B[${l[0]}m`,close:`\x1B[${l[1]}m`},u[c]=a[c],i.set(l[0],l[1]);Object.defineProperty(a,o,{value:u,enumerable:!1})}return Object.defineProperty(a,"codes",{value:i,enumerable:!1}),a.color.close="\x1B[39m",a.bgColor.close="\x1B[49m",a.color.ansi256=t(),a.color.ansi16m=r(),a.bgColor.ansi256=t(10),a.bgColor.ansi16m=r(10),Object.defineProperties(a,{rgbToAnsi256:{value:(o,u,c)=>o===u&&u===c?o<8?16:o>248?231:Math.round((o-8)/247*24)+232:16+36*Math.round(o/255*5)+6*Math.round(u/255*5)+Math.round(c/255*5),enumerable:!1},hexToRgb:{value:o=>{const u=/(?<colorString>[a-f\d]{6}|[a-f\d]{3})/i.exec(o.toString(16));if(!u)return[0,0,0];let{colorString:c}=u.groups;c.length===3&&(c=c.split("").map(d=>d+d).join(""));const l=Number.parseInt(c,16);return[l>>16&255,l>>8&255,l&255]},enumerable:!1},hexToAnsi256:{value:o=>a.rgbToAnsi256(...a.hexToRgb(o)),enumerable:!1}}),a}Object.defineProperty(n,"exports",{enumerable:!0,get:s})})(la);var _g=la.exports;const Fc=hn(_g);class da extends yn{constructor(e){super(...arguments),Object.defineProperty(this,"runMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map})}copy(){return this}_addChildRun(e,t){e.child_runs.push(t)}_startTrace(e){if(e.parent_run_id!==void 0){const t=this.runMap.get(e.parent_run_id);t&&this._addChildRun(t,e)}this.runMap.set(e.id,e)}async _endTrace(e){const t=e.parent_run_id!==void 0&&this.runMap.get(e.parent_run_id);t?t.child_execution_order=Math.max(t.child_execution_order,e.child_execution_order):await this.persistRun(e),this.runMap.delete(e.id)}_getExecutionOrder(e){const t=e!==void 0&&this.runMap.get(e);return t?t.child_execution_order+1:1}async handleLLMStart(e,t,r,s,i,a,o){var h;const u=this._getExecutionOrder(s),c=Date.now(),l=o?{...i,metadata:o}:i,d={id:r,name:e.id[e.id.length-1],parent_run_id:s,start_time:c,serialized:e,events:[{name:"start",time:c}],inputs:{prompts:t},execution_order:u,child_runs:[],child_execution_order:u,run_type:"llm",extra:l??{},tags:a||[]};this._startTrace(d),await((h=this.onLLMStart)==null?void 0:h.call(this,d))}async handleChatModelStart(e,t,r,s,i,a,o){var h;const u=this._getExecutionOrder(s),c=Date.now(),l=o?{...i,metadata:o}:i,d={id:r,name:e.id[e.id.length-1],parent_run_id:s,start_time:c,serialized:e,events:[{name:"start",time:c}],inputs:{messages:t},execution_order:u,child_runs:[],child_execution_order:u,run_type:"llm",extra:l??{},tags:a||[]};this._startTrace(d),await((h=this.onLLMStart)==null?void 0:h.call(this,d))}async handleLLMEnd(e,t){var s;const r=this.runMap.get(t);if(!r||(r==null?void 0:r.run_type)!=="llm")throw new Error("No LLM run to end.");r.end_time=Date.now(),r.outputs=e,r.events.push({name:"end",time:r.end_time}),await((s=this.onLLMEnd)==null?void 0:s.call(this,r)),await this._endTrace(r)}async handleLLMError(e,t){var s;const r=this.runMap.get(t);if(!r||(r==null?void 0:r.run_type)!=="llm")throw new Error("No LLM run to end.");r.end_time=Date.now(),r.error=e.message,r.events.push({name:"error",time:r.end_time}),await((s=this.onLLMError)==null?void 0:s.call(this,r)),await this._endTrace(r)}async handleChainStart(e,t,r,s,i,a){var l;const o=this._getExecutionOrder(s),u=Date.now(),c={id:r,name:e.id[e.id.length-1],parent_run_id:s,start_time:u,serialized:e,events:[{name:"start",time:u}],inputs:t,execution_order:o,child_execution_order:o,run_type:"chain",child_runs:[],extra:a?{metadata:a}:{},tags:i||[]};this._startTrace(c),await((l=this.onChainStart)==null?void 0:l.call(this,c))}async handleChainEnd(e,t){var s;const r=this.runMap.get(t);if(!r||(r==null?void 0:r.run_type)!=="chain")throw new Error("No chain run to end.");r.end_time=Date.now(),r.outputs=e,r.events.push({name:"end",time:r.end_time}),await((s=this.onChainEnd)==null?void 0:s.call(this,r)),await this._endTrace(r)}async handleChainError(e,t){var s;const r=this.runMap.get(t);if(!r||(r==null?void 0:r.run_type)!=="chain")throw new Error("No chain run to end.");r.end_time=Date.now(),r.error=e.message,r.events.push({name:"error",time:r.end_time}),await((s=this.onChainError)==null?void 0:s.call(this,r)),await this._endTrace(r)}async handleToolStart(e,t,r,s,i,a){var l;const o=this._getExecutionOrder(s),u=Date.now(),c={id:r,name:e.id[e.id.length-1],parent_run_id:s,start_time:u,serialized:e,events:[{name:"start",time:u}],inputs:{input:t},execution_order:o,child_execution_order:o,run_type:"tool",child_runs:[],extra:a?{metadata:a}:{},tags:i||[]};this._startTrace(c),await((l=this.onToolStart)==null?void 0:l.call(this,c))}async handleToolEnd(e,t){var s;const r=this.runMap.get(t);if(!r||(r==null?void 0:r.run_type)!=="tool")throw new Error("No tool run to end");r.end_time=Date.now(),r.outputs={output:e},r.events.push({name:"end",time:r.end_time}),await((s=this.onToolEnd)==null?void 0:s.call(this,r)),await this._endTrace(r)}async handleToolError(e,t){var s;const r=this.runMap.get(t);if(!r||(r==null?void 0:r.run_type)!=="tool")throw new Error("No tool run to end");r.end_time=Date.now(),r.error=e.message,r.events.push({name:"error",time:r.end_time}),await((s=this.onToolError)==null?void 0:s.call(this,r)),await this._endTrace(r)}async handleAgentAction(e,t){var i;const r=this.runMap.get(t);if(!r||(r==null?void 0:r.run_type)!=="chain")return;const s=r;s.actions=s.actions||[],s.actions.push(e),s.events.push({name:"agent_action",time:Date.now(),kwargs:{action:e}}),await((i=this.onAgentAction)==null?void 0:i.call(this,r))}async handleAgentEnd(e,t){var s;const r=this.runMap.get(t);!r||(r==null?void 0:r.run_type)!=="chain"||(r.events.push({name:"agent_end",time:Date.now(),kwargs:{action:e}}),await((s=this.onAgentEnd)==null?void 0:s.call(this,r)))}async handleText(e,t){var s;const r=this.runMap.get(t);!r||(r==null?void 0:r.run_type)!=="chain"||(r.events.push({name:"text",time:Date.now(),kwargs:{text:e}}),await((s=this.onText)==null?void 0:s.call(this,r)))}async handleLLMNewToken(e,t,r){var i;const s=this.runMap.get(r);!s||(s==null?void 0:s.run_type)!=="llm"||(s.events.push({name:"new_token",time:Date.now(),kwargs:{token:e,idx:t}}),await((i=this.onLLMNewToken)==null?void 0:i.call(this,s)))}}function Qe(n,e){return`${n.open}${e}${n.close}`}function It(n,e){try{return JSON.stringify(n,null,2)}catch{return e}}function ar(n){if(!n.end_time)return"";const e=n.end_time-n.start_time;return e<1e3?`${e}ms`:`${(e/1e3).toFixed(2)}s`}const{color:at}=Fc;class qo extends da{constructor(){super(...arguments),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"console_callback_handler"})}persistRun(e){return Promise.resolve()}getParents(e){const t=[];let r=e;for(;r.parent_run_id;){const s=this.runMap.get(r.parent_run_id);if(s)t.push(s),r=s;else break}return t}getBreadcrumbs(e){const r=[...this.getParents(e).reverse(),e].map((s,i,a)=>{const o=`${s.execution_order}:${s.run_type}:${s.name}`;return i===a.length-1?Qe(Fc.bold,o):o}).join(" > ");return Qe(at.grey,r)}onChainStart(e){const t=this.getBreadcrumbs(e);console.log(`${Qe(at.green,"[chain/start]")} [${t}] Entering Chain run with input: ${It(e.inputs,"[inputs]")}`)}onChainEnd(e){const t=this.getBreadcrumbs(e);console.log(`${Qe(at.cyan,"[chain/end]")} [${t}] [${ar(e)}] Exiting Chain run with output: ${It(e.outputs,"[outputs]")}`)}onChainError(e){const t=this.getBreadcrumbs(e);console.log(`${Qe(at.red,"[chain/error]")} [${t}] [${ar(e)}] Chain run errored with error: ${It(e.error,"[error]")}`)}onLLMStart(e){const t=this.getBreadcrumbs(e),r="prompts"in e.inputs?{prompts:e.inputs.prompts.map(s=>s.trim())}:e.inputs;console.log(`${Qe(at.green,"[llm/start]")} [${t}] Entering LLM run with input: ${It(r,"[inputs]")}`)}onLLMEnd(e){const t=this.getBreadcrumbs(e);console.log(`${Qe(at.cyan,"[llm/end]")} [${t}] [${ar(e)}] Exiting LLM run with output: ${It(e.outputs,"[response]")}`)}onLLMError(e){const t=this.getBreadcrumbs(e);console.log(`${Qe(at.red,"[llm/error]")} [${t}] [${ar(e)}] LLM run errored with error: ${It(e.error,"[error]")}`)}onToolStart(e){var r;const t=this.getBreadcrumbs(e);console.log(`${Qe(at.green,"[tool/start]")} [${t}] Entering Tool run with input: "${(r=e.inputs.input)==null?void 0:r.trim()}"`)}onToolEnd(e){var r,s;const t=this.getBreadcrumbs(e);console.log(`${Qe(at.cyan,"[tool/end]")} [${t}] [${ar(e)}] Exiting Tool run with output: "${(s=(r=e.outputs)==null?void 0:r.output)==null?void 0:s.trim()}"`)}onToolError(e){const t=this.getBreadcrumbs(e);console.log(`${Qe(at.red,"[tool/error]")} [${t}] [${ar(e)}] Tool run errored with error: ${It(e.error,"[error]")}`)}onAgentAction(e){const t=e,r=this.getBreadcrumbs(e);console.log(`${Qe(at.blue,"[agent/action]")} [${r}] Agent selected action: ${It(t.actions[t.actions.length-1],"[action]")}`)}}const vg=[400,401,403,404,405,406,407,408,409];class wg{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6;const t="default"in Tt?Tt.default:Tt;this.queue=new t({concurrency:this.maxConcurrency})}call(e,...t){return this.queue.add(()=>Tu(()=>e(...t).catch(r=>{throw r instanceof Error?r:new Error(r)}),{onFailedAttempt(r){var i;if(r.message.startsWith("Cancel")||r.message.startsWith("TimeoutError")||r.message.startsWith("AbortError")||(r==null?void 0:r.code)==="ECONNABORTED")throw r;const s=(i=r==null?void 0:r.response)==null?void 0:i.status;if(s&&vg.includes(+s))throw r},retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,t,...r){return e.signal?Promise.race([this.call(t,...r),new Promise((s,i)=>{var a;(a=e.signal)==null||a.addEventListener("abort",()=>{i(new Error("AbortError"))})})]):this.call(t,...r)}fetch(...e){return this.call(()=>fetch(...e).then(t=>t.ok?t:Promise.reject(t)))}}const Og=()=>typeof window<"u"&&typeof window.document<"u",Eg=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",Ag=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom")),Bc=()=>typeof Deno<"u",Tg=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!Bc(),Pg=()=>{let n;return Og()?n="browser":Tg()?n="node":Eg()?n="webworker":Ag()?n="jsdom":Bc()?n="deno":n="other",n};let hi;async function xg(){return hi===void 0&&(hi={library:"langsmith",runtime:Pg()}),hi}function zo(n){var e;try{return typeof process<"u"?(e=process.env)==null?void 0:e[n]:void 0}catch{return}}const Sg=n=>{const t=n.replace("http://","").replace("https://","").split("/")[0].split(":")[0];return t==="localhost"||t==="127.0.0.1"||t==="::1"},In=async(n,e)=>{const t=await n.text();if(!n.ok)throw new Error(`Failed to ${e}: ${n.status} ${n.statusText} ${t}`)};class ha{constructor(e={}){Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout_ms",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const t=ha.getDefaultClientConfig();this.apiUrl=e.apiUrl??t.apiUrl,this.apiKey=e.apiKey??t.apiKey,this.validateApiKeyIfHosted(),this.timeout_ms=e.timeout_ms??4e3,this.caller=new wg(e.callerOptions??{})}static getDefaultClientConfig(){return{apiUrl:zo("LANGCHAIN_ENDPOINT")??"http://localhost:1984",apiKey:zo("LANGCHAIN_API_KEY")}}validateApiKeyIfHosted(){if(!Sg(this.apiUrl)&&!this.apiKey)throw new Error("API key must be provided when using hosted LangSmith API")}get headers(){const e={};return this.apiKey&&(e["x-api-key"]=`${this.apiKey}`),e}async _get(e,t){const r=(t==null?void 0:t.toString())??"",s=`${this.apiUrl}${e}?${r}`,i=await this.caller.call(fetch,s,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});if(!i.ok)throw new Error(`Failed to fetch ${e}: ${i.status} ${i.statusText}`);return i.json()}async createRun(e){const t={...this.headers,"Content-Type":"application/json"},r=e.extra??{},s=await xg(),i=e.project_name;delete e.project_name;const a={session_name:i,...e,extra:{...e.extra,runtime:{...s,...r.runtime}}},o=await this.caller.call(fetch,`${this.apiUrl}/runs`,{method:"POST",headers:t,body:JSON.stringify(a),signal:AbortSignal.timeout(this.timeout_ms)});await In(o,"create run")}async updateRun(e,t){const r={...this.headers,"Content-Type":"application/json"},s=await this.caller.call(fetch,`${this.apiUrl}/runs/${e}`,{method:"PATCH",headers:r,body:JSON.stringify(t),signal:AbortSignal.timeout(this.timeout_ms)});await In(s,"update run")}async readRun(e,{loadChildRuns:t}={loadChildRuns:!1}){let r=await this._get(`/runs/${e}`);return t&&r.child_run_ids&&(r=await this._loadChildRuns(r)),r}async _loadChildRuns(e){const t=await this.listRuns({id:e.child_run_ids}),r={},s={};t.sort((i,a)=>i.execution_order-a.execution_order);for(const i of t){if(i.parent_run_id===null||i.parent_run_id===void 0)throw new Error(`Child run ${i.id} has no parent`);i.parent_run_id in r||(r[i.parent_run_id]=[]),r[i.parent_run_id].push(i),s[i.id]=i}e.child_runs=r[e.id]||[];for(const i in r)i!==e.id&&(s[i].child_runs=r[i]);return e}async listRuns({projectId:e,projectName:t,executionOrder:r,runType:s,error:i,id:a,limit:o,offset:u}){const c=new URLSearchParams;let l=e;if(t){if(e)throw new Error("Only one of projectId or projectName may be given");l=(await this.readProject({projectName:t})).id}if(l&&c.append("session",l),r&&c.append("execution_order",r.toString()),s&&c.append("run_type",s),i!==void 0&&c.append("error",i.toString()),a!==void 0)for(const d of a)c.append("id",d);return o!==void 0&&c.append("limit",o.toString()),u!==void 0&&c.append("offset",u.toString()),this._get("/runs",c)}async deleteRun(e){const t=await this.caller.call(fetch,`${this.apiUrl}/runs/${e}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});await In(t,"delete run")}async createProject({projectName:e,projectExtra:t,upsert:r}){const s=r?"?upsert=true":"",i=`${this.apiUrl}/sessions${s}`,a={name:e};t!==void 0&&(a.extra=t);const o=await this.caller.call(fetch,i,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(a),signal:AbortSignal.timeout(this.timeout_ms)}),u=await o.json();if(!o.ok)throw new Error(`Failed to create session ${e}: ${o.status} ${o.statusText}`);return u}async readProject({projectId:e,projectName:t}){let r="/sessions";const s=new URLSearchParams;if(e!==void 0&&t!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(e!==void 0)r+=`/${e}`;else if(t!==void 0)s.append("name",t);else throw new Error("Must provide projectName or projectId");const i=await this._get(r,s);let a;if(Array.isArray(i)){if(i.length===0)throw new Error(`Project[id=${e}, name=${t}] not found`);a=i[0]}else a=i;return a}async listProjects(){return this._get("/sessions")}async deleteProject({projectId:e,projectName:t}){let r;if(e===void 0&&t===void 0)throw new Error("Must provide projectName or projectId");if(e!==void 0&&t!==void 0)throw new Error("Must provide either projectName or projectId, not both");e===void 0?r=(await this.readProject({projectName:t})).id:r=e;const s=await this.caller.call(fetch,`${this.apiUrl}/sessions/${r}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});await In(s,`delete session ${r} (${t})`)}async uploadCsv({csvFile:e,fileName:t,inputKeys:r,outputKeys:s,description:i,dataType:a,name:o}){const u=`${this.apiUrl}/datasets/upload`,c=new FormData;c.append("file",e,t),r.forEach(h=>{c.append("input_keys",h)}),s.forEach(h=>{c.append("output_keys",h)}),i&&c.append("description",i),a&&c.append("data_type",a),o&&c.append("name",o);const l=await this.caller.call(fetch,u,{method:"POST",headers:this.headers,body:c,signal:AbortSignal.timeout(this.timeout_ms)});if(!l.ok){const h=await l.json();throw h.detail&&h.detail.includes("already exists")?new Error(`Dataset ${t} already exists`):new Error(`Failed to upload CSV: ${l.status} ${l.statusText}`)}return await l.json()}async createDataset(e,{description:t,dataType:r}={}){const s={name:e,description:t};r&&(s.data_type=r);const i=await this.caller.call(fetch,`${this.apiUrl}/datasets`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(s),signal:AbortSignal.timeout(this.timeout_ms)});if(!i.ok){const o=await i.json();throw o.detail&&o.detail.includes("already exists")?new Error(`Dataset ${e} already exists`):new Error(`Failed to create dataset ${i.status} ${i.statusText}`)}return await i.json()}async readDataset({datasetId:e,datasetName:t}){let r="/datasets";const s=new URLSearchParams({limit:"1"});if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(e!==void 0)r+=`/${e}`;else if(t!==void 0)s.append("name",t);else throw new Error("Must provide datasetName or datasetId");const i=await this._get(r,s);let a;if(Array.isArray(i)){if(i.length===0)throw new Error(`Dataset[id=${e}, name=${t}] not found`);a=i[0]}else a=i;return a}async listDatasets({limit:e=100,offset:t=0}={}){const r="/datasets",s=new URLSearchParams({limit:e.toString(),offset:t.toString()}),i=await this._get(r,s);if(!Array.isArray(i))throw new Error(`Expected ${r} to return an array, but got ${i}`);return i}async deleteDataset({datasetId:e,datasetName:t}){let r="/datasets",s=e;if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(t!==void 0&&(s=(await this.readDataset({datasetName:t})).id),s!==void 0)r+=`/${s}`;else throw new Error("Must provide datasetName or datasetId");const i=await this.caller.call(fetch,this.apiUrl+r,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});if(!i.ok)throw new Error(`Failed to delete ${r}: ${i.status} ${i.statusText}`);await i.json()}async createExample(e,t,{datasetId:r,datasetName:s,createdAt:i}){let a=r;if(a===void 0&&s===void 0)throw new Error("Must provide either datasetName or datasetId");if(a!==void 0&&s!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");a===void 0&&(a=(await this.readDataset({datasetName:s})).id);const u={dataset_id:a,inputs:e,outputs:t,created_at:(i||new Date).toISOString()},c=await this.caller.call(fetch,`${this.apiUrl}/examples`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(u),signal:AbortSignal.timeout(this.timeout_ms)});if(!c.ok)throw new Error(`Failed to create example: ${c.status} ${c.statusText}`);return await c.json()}async readExample(e){const t=`/examples/${e}`;return await this._get(t)}async listExamples({datasetId:e,datasetName:t,limit:r,offset:s}={}){let i;if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(e!==void 0)i=e;else if(t!==void 0)i=(await this.readDataset({datasetName:t})).id;else throw new Error("Must provide a datasetName or datasetId");const a=await this._get("/examples",new URLSearchParams({dataset:i,limit:(r==null?void 0:r.toString())??"100",offset:(s==null?void 0:s.toString())??"0"}));if(!Array.isArray(a))throw new Error(`Expected /examples to return an array, but got ${a}`);return a}async deleteExample(e){const t=`/examples/${e}`,r=await this.caller.call(fetch,this.apiUrl+t,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});if(!r.ok)throw new Error(`Failed to delete ${t}: ${r.status} ${r.statusText}`);await r.json()}async updateExample(e,t){const r=await this.caller.call(fetch,`${this.apiUrl}/examples/${e}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(t),signal:AbortSignal.timeout(this.timeout_ms)});if(!r.ok)throw new Error(`Failed to update example ${e}: ${r.status} ${r.statusText}`);return await r.json()}async evaluateRun(e,t,{sourceInfo:r,loadChildRuns:s}={loadChildRuns:!1}){let i;if(typeof e=="string")i=await this.readRun(e,{loadChildRuns:s});else if(typeof e=="object"&&"id"in e)i=e;else throw new Error(`Invalid run type: ${typeof e}`);let a;i.reference_example_id!==null&&i.reference_example_id!==void 0&&(a=await this.readExample(i.reference_example_id));const o=await t.evaluateRun(i,a);let u=r??{};return o.evaluatorInfo&&(u={...u,...o.evaluatorInfo}),await this.createFeedback(i.id,o.key,{score:o.score,value:o.value,comment:o.comment,correction:o.correction,sourceInfo:u,feedbackSourceType:"MODEL"})}async createFeedback(e,t,{score:r,value:s,correction:i,comment:a,sourceInfo:o,feedbackSourceType:u="API"}){let c;if(u==="API")c={type:"api",metadata:o??{}};else if(u==="MODEL")c={type:"model",metadata:o??{}};else throw new Error(`Unknown feedback source type ${u}`);const l={id:Zt(),run_id:e,key:t,score:r,value:s,correction:i,comment:a,feedback_source:c},d=await this.caller.call(fetch,`${this.apiUrl}/feedback`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(l),signal:AbortSignal.timeout(this.timeout_ms)});if(!d.ok)throw new Error(`Failed to create feedback for run ${e}: ${d.status} ${d.statusText}`);return await d.json()}async readFeedback(e){const t=`/feedback/${e}`;return await this._get(t)}async deleteFeedback(e){const t=`/feedback/${e}`,r=await this.caller.call(fetch,this.apiUrl+t,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});if(!r.ok)throw new Error(`Failed to delete ${t}: ${r.status} ${r.statusText}`);await r.json()}async listFeedback({runIds:e,limit:t,offset:r}={}){const s=new URLSearchParams;return e&&s.append("run",e.join(",")),t!==void 0&&s.append("limit",t.toString()),r!==void 0&&s.append("offset",r.toString()),await this._get("/feedback",s)}}class jg extends da{constructor(e={}){super(e),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"langchain_tracer"}),Object.defineProperty(this,"projectName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exampleId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const{exampleId:t,projectName:r,client:s}=e;this.projectName=r??Ce("LANGCHAIN_PROJECT")??Ce("LANGCHAIN_SESSION"),this.exampleId=t,this.client=s??new ha({})}async _convertToCreate(e,t=void 0){return{...e,extra:{...e.extra,runtime:await rp()},child_runs:void 0,session_name:this.projectName,reference_example_id:e.parent_run_id?void 0:t}}async persistRun(e){}async _persistRunSingle(e){const t=await this._convertToCreate(e,this.exampleId);await this.client.createRun(t)}async _updateRunSingle(e){const t={end_time:e.end_time,error:e.error,outputs:e.outputs,events:e.events};await this.client.updateRun(e.id,t)}async onLLMStart(e){await this._persistRunSingle(e)}async onLLMEnd(e){await this._updateRunSingle(e)}async onLLMError(e){await this._updateRunSingle(e)}async onChainStart(e){await this._persistRunSingle(e)}async onChainEnd(e){await this._updateRunSingle(e)}async onChainError(e){await this._updateRunSingle(e)}async onToolStart(e){await this._persistRunSingle(e)}async onToolEnd(e){await this._updateRunSingle(e)}async onToolError(e){await this._updateRunSingle(e)}}function fa(n,e="Human",t="AI"){const r=[];for(const s of n){let i;if(s._getType()==="human")i=e;else if(s._getType()==="ai")i=t;else if(s._getType()==="system")i="System";else if(s._getType()==="function")i="Function";else if(s._getType()==="generic")i=s.role;else throw new Error(`Got unsupported message type: ${s}`);const a=s.name?`${s.name}, `:"";r.push(`${i}: ${a}${s.content}`)}return r.join(`
`)}class kg extends da{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"langchain_tracer"}),Object.defineProperty(this,"endpoint",{enumerable:!0,configurable:!0,writable:!0,value:Ce("LANGCHAIN_ENDPOINT")||"http://localhost:1984"}),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:{"Content-Type":"application/json"}}),Object.defineProperty(this,"session",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const e=Ce("LANGCHAIN_API_KEY");e&&(this.headers["x-api-key"]=e)}async newSession(e){const t={start_time:Date.now(),name:e},r=await this.persistSession(t);return this.session=r,r}async loadSession(e){const t=`${this.endpoint}/sessions?name=${e}`;return this._handleSessionResponse(t)}async loadDefaultSession(){const e=`${this.endpoint}/sessions?name=default`;return this._handleSessionResponse(e)}async convertV2RunToRun(e){var i;const t=this.session??await this.loadDefaultSession(),r=e.serialized;let s;if(e.run_type==="llm"){const a=e.inputs.prompts?e.inputs.prompts:e.inputs.messages.map(u=>fa(u));s={uuid:e.id,start_time:e.start_time,end_time:e.end_time,execution_order:e.execution_order,child_execution_order:e.child_execution_order,serialized:r,type:e.run_type,session_id:t.id,prompts:a,response:e.outputs}}else if(e.run_type==="chain"){const a=await Promise.all(e.child_runs.map(u=>this.convertV2RunToRun(u)));s={uuid:e.id,start_time:e.start_time,end_time:e.end_time,execution_order:e.execution_order,child_execution_order:e.child_execution_order,serialized:r,type:e.run_type,session_id:t.id,inputs:e.inputs,outputs:e.outputs,child_llm_runs:a.filter(u=>u.type==="llm"),child_chain_runs:a.filter(u=>u.type==="chain"),child_tool_runs:a.filter(u=>u.type==="tool")}}else if(e.run_type==="tool"){const a=await Promise.all(e.child_runs.map(u=>this.convertV2RunToRun(u)));s={uuid:e.id,start_time:e.start_time,end_time:e.end_time,execution_order:e.execution_order,child_execution_order:e.child_execution_order,serialized:r,type:e.run_type,session_id:t.id,tool_input:e.inputs.input,output:(i=e.outputs)==null?void 0:i.output,action:JSON.stringify(r),child_llm_runs:a.filter(u=>u.type==="llm"),child_chain_runs:a.filter(u=>u.type==="chain"),child_tool_runs:a.filter(u=>u.type==="tool")}}else throw new Error(`Unknown run type: ${e.run_type}`);return s}async persistRun(e){let t,r;e.run_type!==void 0?r=await this.convertV2RunToRun(e):r=e,r.type==="llm"?t=`${this.endpoint}/llm-runs`:r.type==="chain"?t=`${this.endpoint}/chain-runs`:t=`${this.endpoint}/tool-runs`;const s=await fetch(t,{method:"POST",headers:this.headers,body:JSON.stringify(r)});s.ok||console.error(`Failed to persist run: ${s.status} ${s.statusText}`)}async persistSession(e){const t=`${this.endpoint}/sessions`,r=await fetch(t,{method:"POST",headers:this.headers,body:JSON.stringify(e)});return r.ok?{id:(await r.json()).id,...e}:(console.error(`Failed to persist session: ${r.status} ${r.statusText}, using default session.`),{id:1,...e})}async _handleSessionResponse(e){const t=await fetch(e,{method:"GET",headers:this.headers});let r;if(!t.ok)return console.error(`Failed to load session: ${t.status} ${t.statusText}`),r={id:1,start_time:Date.now()},this.session=r,r;const s=await t.json();return s.length===0?(r={id:1,start_time:Date.now()},this.session=r,r):([r]=s,this.session=r,r)}}async function Cg(n){const e=new kg;return n?await e.loadSession(n):await e.loadDefaultSession(),e}async function Ig(){return new jg}let fi;function Rg(){const n="default"in Tt?Tt.default:Tt;return new n({autoStart:!0,concurrency:1})}async function He(n,e){e===!0?await n():(typeof fi>"u"&&(fi=Rg()),fi.add(n))}function Dg(n){return n?Array.isArray(n)||"name"in n?{callbacks:n}:n:{}}class Ng{setHandler(e){return this.setHandlers([e])}}class pa{constructor(e,t,r,s,i,a,o,u){Object.defineProperty(this,"runId",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:u})}async handleText(e){await Promise.all(this.handlers.map(t=>He(async()=>{var r;try{await((r=t.handleText)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(s){console.error(`Error in handler ${t.constructor.name}, handleText: ${s}`)}},t.awaitHandlers)))}}class Ho extends pa{async handleLLMNewToken(e,t={prompt:0,completion:0}){await Promise.all(this.handlers.map(r=>He(async()=>{var s;if(!r.ignoreLLM)try{await((s=r.handleLLMNewToken)==null?void 0:s.call(r,e,t,this.runId,this._parentRunId,this.tags))}catch(i){console.error(`Error in handler ${r.constructor.name}, handleLLMNewToken: ${i}`)}},r.awaitHandlers)))}async handleLLMError(e){await Promise.all(this.handlers.map(t=>He(async()=>{var r;if(!t.ignoreLLM)try{await((r=t.handleLLMError)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(s){console.error(`Error in handler ${t.constructor.name}, handleLLMError: ${s}`)}},t.awaitHandlers)))}async handleLLMEnd(e){await Promise.all(this.handlers.map(t=>He(async()=>{var r;if(!t.ignoreLLM)try{await((r=t.handleLLMEnd)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(s){console.error(`Error in handler ${t.constructor.name}, handleLLMEnd: ${s}`)}},t.awaitHandlers)))}}class Lg extends pa{getChild(e){const t=new Nt(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleChainError(e){await Promise.all(this.handlers.map(t=>He(async()=>{var r;if(!t.ignoreChain)try{await((r=t.handleChainError)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(s){console.error(`Error in handler ${t.constructor.name}, handleChainError: ${s}`)}},t.awaitHandlers)))}async handleChainEnd(e){await Promise.all(this.handlers.map(t=>He(async()=>{var r;if(!t.ignoreChain)try{await((r=t.handleChainEnd)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(s){console.error(`Error in handler ${t.constructor.name}, handleChainEnd: ${s}`)}},t.awaitHandlers)))}async handleAgentAction(e){await Promise.all(this.handlers.map(t=>He(async()=>{var r;if(!t.ignoreAgent)try{await((r=t.handleAgentAction)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(s){console.error(`Error in handler ${t.constructor.name}, handleAgentAction: ${s}`)}},t.awaitHandlers)))}async handleAgentEnd(e){await Promise.all(this.handlers.map(t=>He(async()=>{var r;if(!t.ignoreAgent)try{await((r=t.handleAgentEnd)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(s){console.error(`Error in handler ${t.constructor.name}, handleAgentEnd: ${s}`)}},t.awaitHandlers)))}}class $g extends pa{getChild(e){const t=new Nt(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleToolError(e){await Promise.all(this.handlers.map(t=>He(async()=>{var r;if(!t.ignoreAgent)try{await((r=t.handleToolError)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(s){console.error(`Error in handler ${t.constructor.name}, handleToolError: ${s}`)}},t.awaitHandlers)))}async handleToolEnd(e){await Promise.all(this.handlers.map(t=>He(async()=>{var r;if(!t.ignoreAgent)try{await((r=t.handleToolEnd)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(s){console.error(`Error in handler ${t.constructor.name}, handleToolEnd: ${s}`)}},t.awaitHandlers)))}}class Nt extends Ng{constructor(e){super(),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"callback_manager"}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.handlers=[],this.inheritableHandlers=[],this._parentRunId=e}async handleLLMStart(e,t,r=void 0,s=void 0,i=void 0){return Promise.all(t.map(async a=>{const o=Zt();return await Promise.all(this.handlers.map(u=>He(async()=>{var c;if(!u.ignoreLLM)try{await((c=u.handleLLMStart)==null?void 0:c.call(u,e,[a],o,this._parentRunId,i,this.tags,this.metadata))}catch(l){console.error(`Error in handler ${u.constructor.name}, handleLLMStart: ${l}`)}},u.awaitHandlers))),new Ho(o,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChatModelStart(e,t,r=void 0,s=void 0,i=void 0){return Promise.all(t.map(async a=>{const o=Zt();return await Promise.all(this.handlers.map(u=>He(async()=>{var c,l;if(!u.ignoreLLM)try{if(u.handleChatModelStart)await((c=u.handleChatModelStart)==null?void 0:c.call(u,e,[a],o,this._parentRunId,i,this.tags,this.metadata));else if(u.handleLLMStart){const d=fa(a);await((l=u.handleLLMStart)==null?void 0:l.call(u,e,[d],o,this._parentRunId,i,this.tags,this.metadata))}}catch(d){console.error(`Error in handler ${u.constructor.name}, handleLLMStart: ${d}`)}},u.awaitHandlers))),new Ho(o,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChainStart(e,t,r=Zt()){return await Promise.all(this.handlers.map(s=>He(async()=>{var i;if(!s.ignoreChain)try{await((i=s.handleChainStart)==null?void 0:i.call(s,e,t,r,this._parentRunId,this.tags,this.metadata))}catch(a){console.error(`Error in handler ${s.constructor.name}, handleChainStart: ${a}`)}},s.awaitHandlers))),new Lg(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleToolStart(e,t,r=Zt()){return await Promise.all(this.handlers.map(s=>He(async()=>{var i;if(!s.ignoreAgent)try{await((i=s.handleToolStart)==null?void 0:i.call(s,e,t,r,this._parentRunId,this.tags,this.metadata))}catch(a){console.error(`Error in handler ${s.constructor.name}, handleToolStart: ${a}`)}},s.awaitHandlers))),new $g(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}addHandler(e,t=!0){this.handlers.push(e),t&&this.inheritableHandlers.push(e)}removeHandler(e){this.handlers=this.handlers.filter(t=>t!==e),this.inheritableHandlers=this.inheritableHandlers.filter(t=>t!==e)}setHandlers(e,t=!0){this.handlers=[],this.inheritableHandlers=[];for(const r of e)this.addHandler(r,t)}addTags(e,t=!0){this.removeTags(e),this.tags.push(...e),t&&this.inheritableTags.push(...e)}removeTags(e){this.tags=this.tags.filter(t=>!e.includes(t)),this.inheritableTags=this.inheritableTags.filter(t=>!e.includes(t))}addMetadata(e,t=!0){this.metadata={...this.metadata,...e},t&&(this.inheritableMetadata={...this.inheritableMetadata,...e})}removeMetadata(e){for(const t of Object.keys(e))delete this.metadata[t],delete this.inheritableMetadata[t]}copy(e=[],t=!0){const r=new Nt(this._parentRunId);for(const s of this.handlers){const i=this.inheritableHandlers.includes(s);r.addHandler(s,i)}for(const s of this.tags){const i=this.inheritableTags.includes(s);r.addTags([s],i)}for(const s of Object.keys(this.metadata)){const i=Object.keys(this.inheritableMetadata).includes(s);r.addMetadata({[s]:this.metadata[s]},i)}for(const s of e)r.handlers.filter(i=>i.name==="console_callback_handler").some(i=>i.name===s.name)||r.addHandler(s,t);return r}static fromHandlers(e){class t extends yn{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:Zt()}),Object.assign(this,e)}}const r=new this;return r.addHandler(new t),r}static async configure(e,t,r,s,i,a,o){let u;(e||t)&&(Array.isArray(e)||!e?(u=new Nt,u.setHandlers((e==null?void 0:e.map(Ko))??[],!0)):u=e,u=u.copy(Array.isArray(t)?t.map(Ko):t==null?void 0:t.handlers,!1));const c=Ce("LANGCHAIN_VERBOSE")||(o==null?void 0:o.verbose),l=Ce("LANGCHAIN_TRACING_V2")??!1,d=l||(Ce("LANGCHAIN_TRACING")??!1);if(c||d){if(u||(u=new Nt),c&&!u.handlers.some(h=>h.name===qo.prototype.name)){const h=new qo;u.addHandler(h,!0)}if(d&&!u.handlers.some(h=>h.name==="langchain_tracer"))if(l)u.addHandler(await Ig(),!0);else{const h=Ce("LANGCHAIN_PROJECT")&&Ce("LANGCHAIN_SESSION");u.addHandler(await Cg(h),!0)}}return(r||s)&&u&&(u.addTags(r??[]),u.addTags(s??[],!1)),(i||a)&&u&&(u.addMetadata(i??{}),u.addMetadata(a??{},!1)),u}}function Ko(n){return"name"in n?n:yn.fromMethods(n)}const Vc=n=>n.startsWith("gpt-3.5-turbo-16k")?"gpt-3.5-turbo-16k":n.startsWith("gpt-3.5-turbo-")?"gpt-3.5-turbo":n.startsWith("gpt-4-32k")?"gpt-4-32k":n.startsWith("gpt-4-")?"gpt-4":n,Ug=n=>{switch(Vc(n)){case"gpt-3.5-turbo-16k":return 16384;case"gpt-3.5-turbo":return 4096;case"gpt-4-32k":return 32768;case"gpt-4":return 8192;case"text-davinci-003":return 4097;case"text-curie-001":return 2048;case"text-babbage-001":return 2048;case"text-ada-001":return 2048;case"code-davinci-002":return 8e3;case"code-cushman-001":return 2048;default:return 4097}},sw=async({prompt:n,modelName:e})=>{let t;try{t=(await Cu(e)).encode(n).length}catch{console.warn("Failed to calculate number of tokens, falling back to approximate count"),t=Math.ceil(n.length/4)}return Ug(e)-t},Mg=()=>!1;class qc extends ct{get lc_attributes(){return{callbacks:void 0,verbose:void 0}}constructor(e){super(e),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.verbose=e.verbose??Mg(),this.callbacks=e.callbacks,this.tags=e.tags??[],this.metadata=e.metadata??{}}}class zc extends qc{get callKeys(){return["stop","timeout","signal","tags","metadata","callbacks"]}constructor({callbacks:e,callbackManager:t,...r}){super({callbacks:e??t,...r}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_encoding",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.caller=new Vi(r??{})}async getNumTokens(e){let t=Math.ceil(e.length/4);if(!this._encoding)try{this._encoding=await Cu("modelName"in this?Vc(this.modelName):"gpt2")}catch(r){console.warn("Failed to calculate number of tokens, falling back to approximate count",r)}return this._encoding&&(t=this._encoding.encode(e).length),t}_identifyingParams(){return{}}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}static async deserialize(e){const{_type:t,_model:r,...s}=e;if(r&&r!=="base_chat_model")throw new Error(`Cannot load LLM with model ${r}`);const i={openai:(await Te(()=>import("./openai.97f3b310.js"),["_app/immutable/chunks/openai.97f3b310.js","_app/immutable/chunks/prompt-layer.00daf386.js"])).ChatOpenAI}[t];if(i===void 0)throw new Error(`Cannot load  LLM with type ${t}`);return new i(s)}}class gn extends qc{get lc_namespace(){return["langchain","chains",this._chainType()]}constructor(e,t,r){if(arguments.length===1&&typeof e=="object"&&!("saveContext"in e)){const{memory:s,callbackManager:i,...a}=e;super({...a,callbacks:i??a.callbacks}),this.memory=s}else super({verbose:t,callbacks:r}),this.memory=e}_selectMemoryInputs(e){const t={...e};return"signal"in t&&delete t.signal,"timeout"in t&&delete t.timeout,t}serialize(){throw new Error("Method not implemented.")}async run(e,t){const r=this.inputKeys.filter(u=>{var c;return!((c=this.memory)!=null&&c.memoryKeys.includes(u))});if(!(r.length<=1))throw new Error(`Chain ${this._chainType()} expects multiple inputs, cannot use 'run' `);const i=r.length?{[r[0]]:e}:{},a=await this.call(i,t),o=Object.keys(a);if(o.length===1)return a[o[0]];throw new Error("return values have multiple keys, `run` only supported when one key currently")}async call(e,t,r){const s={...e};if(s.timeout&&!s.signal&&(s.signal=AbortSignal.timeout(s.timeout),delete s.timeout),this.memory!=null){const c=await this.memory.loadMemoryVariables(this._selectMemoryInputs(e));for(const[l,d]of Object.entries(c))s[l]=d}const i=Dg(t),a=await Nt.configure(i.callbacks,this.callbacks,i.tags||r,this.tags,i.metadata,this.metadata,{verbose:this.verbose}),o=await(a==null?void 0:a.handleChainStart(this.toJSON(),s));let u;try{u=await(e.signal?Promise.race([this._call(s,o),new Promise((c,l)=>{var d;(d=e.signal)==null||d.addEventListener("abort",()=>{l(new Error("AbortError"))})})]):this._call(s,o))}catch(c){throw await(o==null?void 0:o.handleChainError(c)),c}return this.memory!=null&&await this.memory.saveContext(this._selectMemoryInputs(e),u),await(o==null?void 0:o.handleChainEnd(u)),Object.defineProperty(u,Wu,{value:o?{runId:o==null?void 0:o.runId}:void 0,configurable:!0}),u}async apply(e,t){return Promise.all(e.map(async(r,s)=>this.call(r,t==null?void 0:t[s])))}static async deserialize(e,t={}){switch(e._type){case"llm_chain":{const{LLMChain:r}=await Te(()=>Promise.resolve().then(()=>Hg),void 0);return r.deserialize(e)}case"sequential_chain":{const{SequentialChain:r}=await Te(()=>import("./sequential_chain.4ae29aed.js"),[]);return r.deserialize(e)}case"simple_sequential_chain":{const{SimpleSequentialChain:r}=await Te(()=>import("./sequential_chain.4ae29aed.js"),[]);return r.deserialize(e)}case"stuff_documents_chain":{const{StuffDocumentsChain:r}=await Te(()=>Promise.resolve().then(()=>pi),void 0);return r.deserialize(e)}case"map_reduce_documents_chain":{const{MapReduceDocumentsChain:r}=await Te(()=>Promise.resolve().then(()=>pi),void 0);return r.deserialize(e)}case"refine_documents_chain":{const{RefineDocumentsChain:r}=await Te(()=>Promise.resolve().then(()=>pi),void 0);return r.deserialize(e)}case"vector_db_qa":{const{VectorDBQAChain:r}=await Te(()=>import("./vector_db_qa.eea7cb32.js"),[]);return r.deserialize(e,t)}case"api_chain":{const{APIChain:r}=await Te(()=>import("./api_chain.b8078314.js"),[]);return r.deserialize(e)}default:throw new Error(`Invalid prompt type in config: ${e._type}`)}}}class Fg extends ec{constructor(e){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","prompts","base"]}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.value=e}toString(){return this.value}toChatMessages(){return[new Qu(this.value)]}}class ma extends ct{get lc_attributes(){return{partialVariables:void 0}}constructor(e){super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","prompts",this._getPromptType()]}),Object.defineProperty(this,"inputVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"partialVariables",{enumerable:!0,configurable:!0,writable:!0,value:{}});const{inputVariables:t}=e;if(t.includes("stop"))throw new Error("Cannot have an input variable named 'stop', as it is used internally, please rename.");Object.assign(this,e)}async mergePartialAndUserVariables(e){const t=this.partialVariables??{},r={};for(const[i,a]of Object.entries(t))typeof a=="string"?r[i]=a:r[i]=await a();return{...r,...e}}serialize(){throw new Error("Use .toJSON() instead")}static async deserialize(e){switch(e._type){case"prompt":{const{PromptTemplate:t}=await Te(()=>Promise.resolve().then(()=>Zo),void 0);return t.deserialize(e)}case void 0:{const{PromptTemplate:t}=await Te(()=>Promise.resolve().then(()=>Zo),void 0);return t.deserialize({...e,_type:"prompt"})}case"few_shot":{const{FewShotPromptTemplate:t}=await Te(()=>import("./few_shot.de51fe99.js"),[]);return t.deserialize(e)}default:throw new Error(`Invalid prompt type in config: ${e._type}`)}}}class Bg extends ma{async formatPromptValue(e){const t=await this.format(e);return new Fg(t)}}class Vg extends ct{parseResultWithPrompt(e,t,r){return this.parseResult(e,r)}}class qg extends Vg{parseResult(e,t){return this.parse(e[0].text,t)}async parseWithPrompt(e,t,r){return this.parse(e,r)}_type(){throw new Error("_type not implemented")}}class zg extends qg{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","default"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}parse(e){return Promise.resolve(e)}getFormatInstructions(){return""}}class Ge extends gn{get inputKeys(){return this.prompt.inputVariables}get outputKeys(){return[this.outputKey]}constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"prompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"llm",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"llmKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputKey",{enumerable:!0,configurable:!0,writable:!0,value:"text"}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.prompt=e.prompt,this.llm=e.llm,this.llmKwargs=e.llmKwargs,this.outputKey=e.outputKey??this.outputKey,this.outputParser=e.outputParser??new zg,this.prompt.outputParser){if(e.outputParser)throw new Error("Cannot set both outputParser and prompt.outputParser");this.outputParser=this.prompt.outputParser}}_selectMemoryInputs(e){const t=super._selectMemoryInputs(e);for(const r of this.llm.callKeys)r in e&&delete t[r];return t}async _getFinalOutput(e,t,r){let s;return this.outputParser?s=await this.outputParser.parseResultWithPrompt(e,t,r==null?void 0:r.getChild()):s=e[0].text,s}call(e,t){return super.call(e,t)}async _call(e,t){const r={...e},s={...this.llmKwargs};for(const o of this.llm.callKeys)o in e&&(s[o]=e[o],delete r[o]);const i=await this.prompt.formatPromptValue(r),{generations:a}=await this.llm.generatePrompt([i],s,t==null?void 0:t.getChild());return{[this.outputKey]:await this._getFinalOutput(a[0],i,t)}}async predict(e,t){return(await this.call(e,t))[this.outputKey]}_chainType(){return"llm"}static async deserialize(e){const{llm:t,prompt:r}=e;if(!t)throw new Error("LLMChain must have llm");if(!r)throw new Error("LLMChain must have prompt");return new Ge({llm:await zc.deserialize(t),prompt:await ma.deserialize(r)})}serialize(){return{_type:`${this._chainType()}_chain`,llm:this.llm.serialize(),prompt:this.prompt.serialize()}}}const Hg=Object.freeze(Object.defineProperty({__proto__:null,LLMChain:Ge},Symbol.toStringTag,{value:"Module"})),Hc=n=>{const e=n.split(""),t=[],r=(i,a)=>{for(let o=a;o<e.length;o+=1)if(i.includes(e[o]))return o;return-1};let s=0;for(;s<e.length;)if(e[s]==="{"&&s+1<e.length&&e[s+1]==="{")t.push({type:"literal",text:"{"}),s+=2;else if(e[s]==="}"&&s+1<e.length&&e[s+1]==="}")t.push({type:"literal",text:"}"}),s+=2;else if(e[s]==="{"){const i=r("}",s);if(i<0)throw new Error("Unclosed '{' in template.");t.push({type:"variable",name:e.slice(s+1,i).join("")}),s=i+1}else{if(e[s]==="}")throw new Error("Single '}' in template.");{const i=r("{}",s),a=(i<0?e.slice(s):e.slice(s,i)).join("");t.push({type:"literal",text:a}),s=i<0?e.length:i}}return t},Kg=(n,e)=>Hc(n).reduce((t,r)=>{if(r.type==="variable"){if(r.name in e)return t+e[r.name];throw new Error(`Missing value for input ${r.name}`)}return t+r.text},""),Di={"f-string":Kg,jinja2:(n,e)=>""},Zg={"f-string":Hc,jinja2:n=>[]},Kc=(n,e,t)=>Di[e](n,t),Jg=(n,e)=>Zg[e](n),Gg=(n,e,t)=>{if(!(e in Di)){const r=Object.keys(Di);throw new Error(`Invalid template format. Got \`${e}\`;
                         should be one of ${r}`)}try{const r=t.reduce((s,i)=>(s[i]="foo",s),{});Kc(n,e,r)}catch(r){throw new Error(`Invalid prompt schema: ${r.message}`)}};class De extends Bg{constructor(e){if(super(e),Object.defineProperty(this,"template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.assign(this,e),this.validateTemplate){let t=this.inputVariables;this.partialVariables&&(t=t.concat(Object.keys(this.partialVariables))),Gg(this.template,this.templateFormat,t)}}_getPromptType(){return"prompt"}async format(e){const t=await this.mergePartialAndUserVariables(e);return Kc(this.template,this.templateFormat,t)}static fromExamples(e,t,r,s=`

`,i=""){const a=[i,...e,t].join(s);return new De({inputVariables:r,template:a})}static fromTemplate(e,{templateFormat:t="f-string",...r}={}){const s=new Set;return Jg(e,t).forEach(i=>{i.type==="variable"&&s.add(i.name)}),new De({inputVariables:[...s],templateFormat:t,template:e,...r})}async partial(e){const t={...this};return t.inputVariables=this.inputVariables.filter(r=>!(r in e)),t.partialVariables={...this.partialVariables??{},...e},new De(t)}serialize(){if(this.outputParser!==void 0)throw new Error("Cannot serialize a prompt template with an output parser");return{_type:this._getPromptType(),input_variables:this.inputVariables,template:this.template,template_format:this.templateFormat}}static async deserialize(e){if(!e.template)throw new Error("Prompt template must have a template");return new De({inputVariables:e.input_variables,template:e.template,templateFormat:e.template_format})}}const Zo=Object.freeze(Object.defineProperty({__proto__:null,PromptTemplate:De},Symbol.toStringTag,{value:"Module"}));class Pr extends gn{get inputKeys(){return[this.inputKey,...this.llmChain.inputKeys].filter(e=>e!==this.documentVariableName)}get outputKeys(){return this.llmChain.outputKeys}constructor(e){super(e),Object.defineProperty(this,"llmChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"input_documents"}),Object.defineProperty(this,"documentVariableName",{enumerable:!0,configurable:!0,writable:!0,value:"context"}),this.llmChain=e.llmChain,this.documentVariableName=e.documentVariableName??this.documentVariableName,this.inputKey=e.inputKey??this.inputKey}_prepInputs(e){if(!(this.inputKey in e))throw new Error(`Document key ${this.inputKey} not found.`);const{[this.inputKey]:t,...r}=e,i=t.map(({pageContent:a})=>a).join(`

`);return{...r,[this.documentVariableName]:i}}async _call(e,t){return await this.llmChain.call(this._prepInputs(e),t==null?void 0:t.getChild("combine_documents"))}_chainType(){return"stuff_documents_chain"}static async deserialize(e){if(!e.llm_chain)throw new Error("Missing llm_chain");return new Pr({llmChain:await Ge.deserialize(e.llm_chain)})}serialize(){return{_type:this._chainType(),llm_chain:this.llmChain.serialize()}}}class ys extends gn{get inputKeys(){return[this.inputKey,...this.combineDocumentChain.inputKeys]}get outputKeys(){return this.combineDocumentChain.outputKeys}constructor(e){super(e),Object.defineProperty(this,"llmChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"input_documents"}),Object.defineProperty(this,"documentVariableName",{enumerable:!0,configurable:!0,writable:!0,value:"context"}),Object.defineProperty(this,"returnIntermediateSteps",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:3e3}),Object.defineProperty(this,"maxIterations",{enumerable:!0,configurable:!0,writable:!0,value:10}),Object.defineProperty(this,"ensureMapStep",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"combineDocumentChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.llmChain=e.llmChain,this.combineDocumentChain=e.combineDocumentChain,this.documentVariableName=e.documentVariableName??this.documentVariableName,this.ensureMapStep=e.ensureMapStep??this.ensureMapStep,this.inputKey=e.inputKey??this.inputKey,this.maxTokens=e.maxTokens??this.maxTokens,this.maxIterations=e.maxIterations??this.maxIterations,this.returnIntermediateSteps=e.returnIntermediateSteps??!1}async _call(e,t){if(!(this.inputKey in e))throw new Error(`Document key ${this.inputKey} not found.`);const{[this.inputKey]:r,...s}=e;let i=r,a=[];for(let c=0;c<this.maxIterations;c+=1){const l=i.map(f=>({[this.documentVariableName]:f.pageContent,...s}));if(c!==0||!this.ensureMapStep){const f=await this.combineDocumentChain.llmChain.prompt.format(this.combineDocumentChain._prepInputs({[this.combineDocumentChain.inputKey]:i,...s}));if(await this.combineDocumentChain.llmChain.llm.getNumTokens(f)<this.maxTokens)break}const h=await this.llmChain.apply(l,t?Array.from({length:l.length},(f,b)=>t.getChild(`map_${b+1}`)):void 0),{outputKey:g}=this.llmChain;this.returnIntermediateSteps&&(a=a.concat(h.map(f=>f[g]))),i=h.map(f=>({pageContent:f[g],metadata:{}}))}const o={[this.combineDocumentChain.inputKey]:i,...s},u=await this.combineDocumentChain.call(o,t==null?void 0:t.getChild("combine_documents"));return this.returnIntermediateSteps?{...u,intermediateSteps:a}:u}_chainType(){return"map_reduce_documents_chain"}static async deserialize(e){if(!e.llm_chain)throw new Error("Missing llm_chain");if(!e.combine_document_chain)throw new Error("Missing combine_document_chain");return new ys({llmChain:await Ge.deserialize(e.llm_chain),combineDocumentChain:await Pr.deserialize(e.combine_document_chain)})}serialize(){return{_type:this._chainType(),llm_chain:this.llmChain.serialize(),combine_document_chain:this.combineDocumentChain.serialize()}}}class gs extends gn{get defaultDocumentPrompt(){return new De({inputVariables:["page_content"],template:"{page_content}"})}get inputKeys(){return[...new Set([this.inputKey,...this.llmChain.inputKeys,...this.refineLLMChain.inputKeys])].filter(e=>e!==this.documentVariableName&&e!==this.initialResponseName)}get outputKeys(){return[this.outputKey]}constructor(e){super(e),Object.defineProperty(this,"llmChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"input_documents"}),Object.defineProperty(this,"outputKey",{enumerable:!0,configurable:!0,writable:!0,value:"output_text"}),Object.defineProperty(this,"documentVariableName",{enumerable:!0,configurable:!0,writable:!0,value:"context"}),Object.defineProperty(this,"initialResponseName",{enumerable:!0,configurable:!0,writable:!0,value:"existing_answer"}),Object.defineProperty(this,"refineLLMChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"documentPrompt",{enumerable:!0,configurable:!0,writable:!0,value:this.defaultDocumentPrompt}),this.llmChain=e.llmChain,this.refineLLMChain=e.refineLLMChain,this.documentVariableName=e.documentVariableName??this.documentVariableName,this.inputKey=e.inputKey??this.inputKey,this.outputKey=e.outputKey??this.outputKey,this.documentPrompt=e.documentPrompt??this.documentPrompt,this.initialResponseName=e.initialResponseName??this.initialResponseName}async _constructInitialInputs(e,t){const r={page_content:e.pageContent,...e.metadata},s={};return this.documentPrompt.inputVariables.forEach(o=>{s[o]=r[o]}),{...{[this.documentVariableName]:await this.documentPrompt.format({...s})},...t}}async _constructRefineInputs(e,t){const r={page_content:e.pageContent,...e.metadata},s={};this.documentPrompt.inputVariables.forEach(o=>{s[o]=r[o]});const i={[this.documentVariableName]:await this.documentPrompt.format({...s})};return{[this.initialResponseName]:t,...i}}async _call(e,t){if(!(this.inputKey in e))throw new Error(`Document key ${this.inputKey} not found.`);const{[this.inputKey]:r,...s}=e,i=r,a=await this._constructInitialInputs(i[0],s);let o=await this.llmChain.predict({...a},t==null?void 0:t.getChild("answer"));for(let u=1;u<i.length;u+=1){const l={...await this._constructRefineInputs(i[u],o),...s};o=await this.refineLLMChain.predict({...l},t==null?void 0:t.getChild("refine"))}return{[this.outputKey]:o}}_chainType(){return"refine_documents_chain"}static async deserialize(e){const t=e.llm_chain;if(!t)throw new Error("Missing llm_chain");const r=e.refine_llm_chain;if(!r)throw new Error("Missing refine_llm_chain");return new gs({llmChain:await Ge.deserialize(t),refineLLMChain:await Ge.deserialize(r)})}serialize(){return{_type:this._chainType(),llm_chain:this.llmChain.serialize(),refine_llm_chain:this.refineLLMChain.serialize()}}}const pi=Object.freeze(Object.defineProperty({__proto__:null,MapReduceDocumentsChain:ys,RefineDocumentsChain:gs,StuffDocumentsChain:Pr},Symbol.toStringTag,{value:"Module"}));class Yg extends ct{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","prompts","chat"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}}class Wg extends ec{constructor(e){Array.isArray(e)&&(e={messages:e}),super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","prompts","chat"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"messages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.messages=e.messages}toString(){return JSON.stringify(this.messages)}toChatMessages(){return this.messages}}class ya extends Yg{constructor(e){"prompt"in e||(e={prompt:e}),super(e),Object.defineProperty(this,"prompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.prompt=e.prompt}get inputVariables(){return this.prompt.inputVariables}async formatMessages(e){return[await this.format(e)]}}class Qg extends ma{constructor(e){super(e)}async format(e){return(await this.formatPromptValue(e)).toString()}async formatPromptValue(e){const t=await this.formatMessages(e);return new Wg(t)}}class dr extends ya{async format(e){return new Qu(await this.prompt.format(e))}static fromTemplate(e){return new this(De.fromTemplate(e))}}class Xg extends ya{async format(e){return new Xu(await this.prompt.format(e))}static fromTemplate(e){return new this(De.fromTemplate(e))}}class bs extends ya{async format(e){return new np(await this.prompt.format(e))}static fromTemplate(e){return new this(De.fromTemplate(e))}}class mt extends Qg{get lc_aliases(){return{promptMessages:"messages"}}constructor(e){if(super(e),Object.defineProperty(this,"promptMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.assign(this,e),this.validateTemplate){const t=new Set;for(const a of this.promptMessages)for(const o of a.inputVariables)t.add(o);const r=new Set(this.partialVariables?this.inputVariables.concat(Object.keys(this.partialVariables)):this.inputVariables),s=new Set([...r].filter(a=>!t.has(a)));if(s.size>0)throw new Error(`Input variables \`${[...s]}\` are not used in any of the prompt messages.`);const i=new Set([...t].filter(a=>!r.has(a)));if(i.size>0)throw new Error(`Input variables \`${[...i]}\` are used in prompt messages but not in the prompt template.`)}}_getPromptType(){return"chat"}async formatMessages(e){const t=await this.mergePartialAndUserVariables(e);let r=[];for(const s of this.promptMessages){const i=s.inputVariables.reduce((o,u)=>{if(!(u in t))throw new Error(`Missing value for input variable \`${u}\``);return o[u]=t[u],o},{}),a=await s.formatMessages(i);r=r.concat(a)}return r}async partial(e){const t={...this};return t.inputVariables=this.inputVariables.filter(r=>!(r in e)),t.partialVariables={...this.partialVariables??{},...e},new mt(t)}static fromPromptMessages(e){const t=e.reduce((i,a)=>i.concat(a instanceof mt?a.promptMessages:[a]),[]),r=e.reduce((i,a)=>a instanceof mt?Object.assign(i,a.partialVariables):i,Object.create(null)),s=new Set;for(const i of t)for(const a of i.inputVariables)a in r||s.add(a);return new mt({inputVariables:[...s],promptMessages:t,partialVariables:r})}}class eb{async getPromptAsync(e,t){return this.getPrompt(e).partial((t==null?void 0:t.partialVariables)??{})}}class bn extends eb{constructor(e,t=[]){super(),Object.defineProperty(this,"defaultPrompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"conditionals",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.defaultPrompt=e,this.conditionals=t}getPrompt(e){for(const[t,r]of this.conditionals)if(t(e))return r;return this.defaultPrompt}}function _n(n){return n._modelType()==="base_chat_model"}const tb=new De({template:`Use the following pieces of context to answer the question at the end. If you don't know the answer, just say that you don't know, don't try to make up an answer.

{context}

Question: {question}
Helpful Answer:`,inputVariables:["context","question"]}),rb=`Use the following pieces of context to answer the users question. 
If you don't know the answer, just say that you don't know, don't try to make up an answer.
----------------
{context}`,nb=[bs.fromTemplate(rb),dr.fromTemplate("{question}")],sb=mt.fromPromptMessages(nb),ib=new bn(tb,[[_n,sb]]),ab=`Use the following portion of a long document to see if any of the text is relevant to answer the question. 
Return any relevant text verbatim.
{context}
Question: {question}
Relevant text, if any:`,ob=De.fromTemplate(ab),ub=`Use the following portion of a long document to see if any of the text is relevant to answer the question. 
Return any relevant text verbatim.
----------------
{context}`,cb=[bs.fromTemplate(ub),dr.fromTemplate("{question}")],lb=mt.fromPromptMessages(cb),db=new bn(ob,[[_n,lb]]),hb=`Given the following extracted parts of a long document and a question, create a final answer. 
If you don't know the answer, just say that you don't know. Don't try to make up an answer.

QUESTION: Which state/country's law governs the interpretation of the contract?
=========
Content: This Agreement is governed by English law and the parties submit to the exclusive jurisdiction of the English courts in  relation to any dispute (contractual or non-contractual) concerning this Agreement save that either party may apply to any court for an  injunction or other relief to protect its Intellectual Property Rights.

Content: No Waiver. Failure or delay in exercising any right or remedy under this Agreement shall not constitute a waiver of such (or any other)  right or remedy.

11.7 Severability. The invalidity, illegality or unenforceability of any term (or part of a term) of this Agreement shall not affect the continuation  in force of the remainder of the term (if any) and this Agreement.

11.8 No Agency. Except as expressly stated otherwise, nothing in this Agreement shall create an agency, partnership or joint venture of any  kind between the parties.

11.9 No Third-Party Beneficiaries.

Content: (b) if Google believes, in good faith, that the Distributor has violated or caused Google to violate any Anti-Bribery Laws (as  defined in Clause 8.5) or that such a violation is reasonably likely to occur,
=========
FINAL ANSWER: This Agreement is governed by English law.

QUESTION: What did the president say about Michael Jackson?
=========
Content: Madam Speaker, Madam Vice President, our First Lady and Second Gentleman. Members of Congress and the Cabinet. Justices of the Supreme Court. My fellow Americans.  

Last year COVID-19 kept us apart. This year we are finally together again. 

Tonight, we meet as Democrats Republicans and Independents. But most importantly as Americans. 

With a duty to one another to the American people to the Constitution. 

And with an unwavering resolve that freedom will always triumph over tyranny. 

Six days ago, Russias Vladimir Putin sought to shake the foundations of the free world thinking he could make it bend to his menacing ways. But he badly miscalculated. 

He thought he could roll into Ukraine and the world would roll over. Instead he met a wall of strength he never imagined. 

He met the Ukrainian people. 

From President Zelenskyy to every Ukrainian, their fearlessness, their courage, their determination, inspires the world. 

Groups of citizens blocking tanks with their bodies. Everyone from students to retirees teachers turned soldiers defending their homeland.

Content: And we wont stop. 

We have lost so much to COVID-19. Time with one another. And worst of all, so much loss of life. 

Lets use this moment to reset. Lets stop looking at COVID-19 as a partisan dividing line and see it for what it is: A God-awful disease.  

Lets stop seeing each other as enemies, and start seeing each other for who we really are: Fellow Americans.  

We cant change how divided weve been. But we can change how we move forwardon COVID-19 and other issues we must face together. 

I recently visited the New York City Police Department days after the funerals of Officer Wilbert Mora and his partner, Officer Jason Rivera. 

They were responding to a 9-1-1 call when a man shot and killed them with a stolen gun. 

Officer Mora was 27 years old. 

Officer Rivera was 22. 

Both Dominican Americans whod grown up on the same streets they later chose to patrol as police officers. 

I spoke with their families and told them that we are forever in debt for their sacrifice, and we will carry on their mission to restore the trust and safety every community deserves.

Content: And a proud Ukrainian people, who have known 30 years  of independence, have repeatedly shown that they will not tolerate anyone who tries to take their country backwards.  

To all Americans, I will be honest with you, as Ive always promised. A Russian dictator, invading a foreign country, has costs around the world. 

And Im taking robust action to make sure the pain of our sanctions  is targeted at Russias economy. And I will use every tool at our disposal to protect American businesses and consumers. 

Tonight, I can announce that the United States has worked with 30 other countries to release 60 Million barrels of oil from reserves around the world.  

America will lead that effort, releasing 30 Million barrels from our own Strategic Petroleum Reserve. And we stand ready to do more if necessary, unified with our allies.  

These steps will help blunt gas prices here at home. And I know the news about whats happening can seem alarming. 

But I want you to know that we are going to be okay.

Content: More support for patients and families. 

To get there, I call on Congress to fund ARPA-H, the Advanced Research Projects Agency for Health. 

Its based on DARPAthe Defense Department project that led to the Internet, GPS, and so much more.  

ARPA-H will have a singular purposeto drive breakthroughs in cancer, Alzheimers, diabetes, and more. 

A unity agenda for the nation. 

We can do this. 

My fellow Americanstonight , we have gathered in a sacred spacethe citadel of our democracy. 

In this Capitol, generation after generation, Americans have debated great questions amid great strife, and have done great things. 

We have fought for freedom, expanded liberty, defeated totalitarianism and terror. 

And built the strongest, freest, and most prosperous nation the world has ever known. 

Now is the hour. 

Our moment of responsibility. 

Our test of resolve and conscience, of history itself. 

It is in this moment that our character is formed. Our purpose is found. Our future is forged. 

Well I know this nation.
=========
FINAL ANSWER: The president did not mention Michael Jackson.

QUESTION: {question}
=========
{summaries}
=========
FINAL ANSWER:`,fb=De.fromTemplate(hb),pb=`Given the following extracted parts of a long document and a question, create a final answer. 
If you don't know the answer, just say that you don't know. Don't try to make up an answer.
----------------
{summaries}`,mb=[bs.fromTemplate(pb),dr.fromTemplate("{question}")],yb=mt.fromPromptMessages(mb),gb=new bn(fb,[[_n,yb]]),bb=`The original question is as follows: {question}
We have provided an existing answer: {existing_answer}
We have the opportunity to refine the existing answer
(only if needed) with some more context below.
------------
{context}
------------
Given the new context, refine the original answer to better answer the question. 
If the context isn't useful, return the original answer.`,_b=new De({inputVariables:["question","existing_answer","context"],template:bb}),vb=`The original question is as follows: {question}
We have provided an existing answer: {existing_answer}
We have the opportunity to refine the existing answer
(only if needed) with some more context below.
------------
{context}
------------
Given the new context, refine the original answer to better answer the question. 
If the context isn't useful, return the original answer.`,wb=[dr.fromTemplate("{question}"),Xg.fromTemplate("{existing_answer}"),dr.fromTemplate(vb)],Ob=mt.fromPromptMessages(wb),Eb=new bn(_b,[[_n,Ob]]),Ab=`Context information is below. 
---------------------
{context}
---------------------
Given the context information and not prior knowledge, answer the question: {question}`,Tb=new De({inputVariables:["context","question"],template:Ab}),Pb=`Context information is below. 
---------------------
{context}
---------------------
Given the context information and not prior knowledge, answer any questions`,xb=[bs.fromTemplate(Pb),dr.fromTemplate("{question}")],Sb=mt.fromPromptMessages(xb),jb=new bn(Tb,[[_n,Sb]]),kb=(n,e={type:"stuff"})=>{const{type:t}=e;if(t==="stuff")return Cb(n,e);if(t==="map_reduce")return Ib(n,e);if(t==="refine")return Rb(n,e);throw new Error(`Invalid _type: ${t}`)};function Cb(n,e={}){const{prompt:t=ib.getPrompt(n),verbose:r}=e,s=new Ge({prompt:t,llm:n,verbose:r});return new Pr({llmChain:s,verbose:r})}function Ib(n,e={}){const{combineMapPrompt:t=db.getPrompt(n),combinePrompt:r=gb.getPrompt(n),verbose:s,returnIntermediateSteps:i}=e,a=new Ge({prompt:t,llm:n,verbose:s}),o=new Ge({prompt:r,llm:n,verbose:s}),u=new Pr({llmChain:o,documentVariableName:"summaries",verbose:s});return new ys({llmChain:a,combineDocumentChain:u,returnIntermediateSteps:i,verbose:s})}function Rb(n,e={}){const{questionPrompt:t=jb.getPrompt(n),refinePrompt:r=Eb.getPrompt(n),verbose:s}=e,i=new Ge({prompt:t,llm:n,verbose:s}),a=new Ge({prompt:r,llm:n,verbose:s});return new gs({llmChain:i,refineLLMChain:a,verbose:s})}const Db=`Given the following conversation and a follow up question, rephrase the follow up question to be a standalone question.

Chat History:
{chat_history}
Follow Up Input: {question}
Standalone question:`;class ga extends gn{get inputKeys(){return[this.inputKey,this.chatHistoryKey]}get outputKeys(){return this.combineDocumentsChain.outputKeys.concat(this.returnSourceDocuments?["sourceDocuments"]:[])}constructor(e){super(e),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"question"}),Object.defineProperty(this,"chatHistoryKey",{enumerable:!0,configurable:!0,writable:!0,value:"chat_history"}),Object.defineProperty(this,"retriever",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"combineDocumentsChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"questionGeneratorChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSourceDocuments",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.retriever=e.retriever,this.combineDocumentsChain=e.combineDocumentsChain,this.questionGeneratorChain=e.questionGeneratorChain,this.inputKey=e.inputKey??this.inputKey,this.returnSourceDocuments=e.returnSourceDocuments??this.returnSourceDocuments}static getChatHistoryString(e){return Array.isArray(e)?e.map(t=>t._getType()==="human"?`Human: ${t.content}`:t._getType()==="ai"?`Assistant: ${t.content}`:`${t.content}`).join(`
`):e}async _call(e,t){if(!(this.inputKey in e))throw new Error(`Question key ${this.inputKey} not found.`);if(!(this.chatHistoryKey in e))throw new Error(`Chat history key ${this.chatHistoryKey} not found.`);const r=e[this.inputKey],s=ga.getChatHistoryString(e[this.chatHistoryKey]);let i=r;if(s.length>0){const c=await this.questionGeneratorChain.call({question:r,chat_history:s},t==null?void 0:t.getChild("question_generator")),l=Object.keys(c);if(l.length===1)i=c[l[0]];else throw new Error("Return from llm chain has multiple values, only single values supported.")}const a=await this.retriever.getRelevantDocuments(i),o={question:i,input_documents:a,chat_history:s},u=await this.combineDocumentsChain.call(o,t==null?void 0:t.getChild("combine_documents"));return this.returnSourceDocuments?{...u,sourceDocuments:a}:u}_chainType(){return"conversational_retrieval_chain"}static async deserialize(e,t){throw new Error("Not implemented.")}serialize(){throw new Error("Not implemented.")}static fromLLM(e,t,r={}){const{questionGeneratorTemplate:s,qaTemplate:i,qaChainOptions:a={type:"stuff",prompt:i?De.fromTemplate(i):void 0},questionGeneratorChainOptions:o,verbose:u,...c}=r,l=kb(e,a),d=De.fromTemplate((o==null?void 0:o.template)??s??Db),h=new Ge({prompt:d,llm:(o==null?void 0:o.llm)??e,verbose:u});return new this({retriever:t,combineDocumentsChain:l,questionGeneratorChain:h,verbose:u,...c})}}var ce;(function(n){n.assertEqual=s=>s;function e(s){}n.assertIs=e;function t(s){throw new Error}n.assertNever=t,n.arrayToEnum=s=>{const i={};for(const a of s)i[a]=a;return i},n.getValidEnumValues=s=>{const i=n.objectKeys(s).filter(o=>typeof s[s[o]]!="number"),a={};for(const o of i)a[o]=s[o];return n.objectValues(a)},n.objectValues=s=>n.objectKeys(s).map(function(i){return s[i]}),n.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const a in s)Object.prototype.hasOwnProperty.call(s,a)&&i.push(a);return i},n.find=(s,i)=>{for(const a of s)if(i(a))return a},n.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&isFinite(s)&&Math.floor(s)===s;function r(s,i=" | "){return s.map(a=>typeof a=="string"?`'${a}'`:a).join(i)}n.joinValues=r,n.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(ce||(ce={}));var Jn;(function(n){n.mergeShapes=(e,t)=>({...e,...t})})(Jn||(Jn={}));const K=ce.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),At=n=>{switch(typeof n){case"undefined":return K.undefined;case"string":return K.string;case"number":return isNaN(n)?K.nan:K.number;case"boolean":return K.boolean;case"function":return K.function;case"bigint":return K.bigint;case"symbol":return K.symbol;case"object":return Array.isArray(n)?K.array:n===null?K.null:n.then&&typeof n.then=="function"&&n.catch&&typeof n.catch=="function"?K.promise:typeof Map<"u"&&n instanceof Map?K.map:typeof Set<"u"&&n instanceof Set?K.set:typeof Date<"u"&&n instanceof Date?K.date:K.object;default:return K.unknown}},V=ce.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),Zc=n=>JSON.stringify(n,null,2).replace(/"([^"]+)":/g,"$1:");class rt extends Error{constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const t=e||function(i){return i.message},r={_errors:[]},s=i=>{for(const a of i.issues)if(a.code==="invalid_union")a.unionErrors.map(s);else if(a.code==="invalid_return_type")s(a.returnTypeError);else if(a.code==="invalid_arguments")s(a.argumentsError);else if(a.path.length===0)r._errors.push(t(a));else{let o=r,u=0;for(;u<a.path.length;){const c=a.path[u];u===a.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(t(a))):o[c]=o[c]||{_errors:[]},o=o[c],u++}}};return s(this),r}toString(){return this.message}get message(){return JSON.stringify(this.issues,ce.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},r=[];for(const s of this.issues)s.path.length>0?(t[s.path[0]]=t[s.path[0]]||[],t[s.path[0]].push(e(s))):r.push(e(s));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}rt.create=n=>new rt(n);const hr=(n,e)=>{let t;switch(n.code){case V.invalid_type:n.received===K.undefined?t="Required":t=`Expected ${n.expected}, received ${n.received}`;break;case V.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(n.expected,ce.jsonStringifyReplacer)}`;break;case V.unrecognized_keys:t=`Unrecognized key(s) in object: ${ce.joinValues(n.keys,", ")}`;break;case V.invalid_union:t="Invalid input";break;case V.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${ce.joinValues(n.options)}`;break;case V.invalid_enum_value:t=`Invalid enum value. Expected ${ce.joinValues(n.options)}, received '${n.received}'`;break;case V.invalid_arguments:t="Invalid function arguments";break;case V.invalid_return_type:t="Invalid function return type";break;case V.invalid_date:t="Invalid date";break;case V.invalid_string:typeof n.validation=="object"?"includes"in n.validation?(t=`Invalid input: must include "${n.validation.includes}"`,typeof n.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${n.validation.position}`)):"startsWith"in n.validation?t=`Invalid input: must start with "${n.validation.startsWith}"`:"endsWith"in n.validation?t=`Invalid input: must end with "${n.validation.endsWith}"`:ce.assertNever(n.validation):n.validation!=="regex"?t=`Invalid ${n.validation}`:t="Invalid";break;case V.too_small:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at least":"more than"} ${n.minimum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at least":"over"} ${n.minimum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(n.minimum))}`:t="Invalid input";break;case V.too_big:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at most":"less than"} ${n.maximum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at most":"under"} ${n.maximum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="bigint"?t=`BigInt must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly":n.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(n.maximum))}`:t="Invalid input";break;case V.custom:t="Invalid input";break;case V.invalid_intersection_types:t="Intersection results could not be merged";break;case V.not_multiple_of:t=`Number must be a multiple of ${n.multipleOf}`;break;case V.not_finite:t="Number must be finite";break;default:t=e.defaultError,ce.assertNever(n)}return{message:t}};let Jc=hr;function Gc(n){Jc=n}function en(){return Jc}const tn=n=>{const{data:e,path:t,errorMaps:r,issueData:s}=n,i=[...t,...s.path||[]],a={...s,path:i};let o="";const u=r.filter(c=>!!c).slice().reverse();for(const c of u)o=c(a,{data:e,defaultError:o}).message;return{...s,path:i,message:s.message||o}},Yc=[];function Z(n,e){const t=tn({issueData:e,data:n.data,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,en(),hr].filter(r=>!!r)});n.common.issues.push(t)}class Ne{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const r=[];for(const s of t){if(s.status==="aborted")return ne;s.status==="dirty"&&e.dirty(),r.push(s.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,t){const r=[];for(const s of t)r.push({key:await s.key,value:await s.value});return Ne.mergeObjectSync(e,r)}static mergeObjectSync(e,t){const r={};for(const s of t){const{key:i,value:a}=s;if(i.status==="aborted"||a.status==="aborted")return ne;i.status==="dirty"&&e.dirty(),a.status==="dirty"&&e.dirty(),(typeof a.value<"u"||s.alwaysSet)&&(r[i.value]=a.value)}return{status:e.value,value:r}}}const ne=Object.freeze({status:"aborted"}),ba=n=>({status:"dirty",value:n}),Fe=n=>({status:"valid",value:n}),Gn=n=>n.status==="aborted",Yn=n=>n.status==="dirty",rn=n=>n.status==="valid",nn=n=>typeof Promise<"u"&&n instanceof Promise;var Y;(function(n){n.errToObj=e=>typeof e=="string"?{message:e}:e||{},n.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(Y||(Y={}));class bt{constructor(e,t,r,s){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Jo=(n,e)=>{if(rn(e))return{success:!0,data:e.value};if(!n.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new rt(n.common.issues);return this._error=t,this._error}}};function ie(n){if(!n)return{};const{errorMap:e,invalid_type_error:t,required_error:r,description:s}=n;if(e&&(t||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(a,o)=>a.code!=="invalid_type"?{message:o.defaultError}:typeof o.data>"u"?{message:r??o.defaultError}:{message:t??o.defaultError},description:s}}class se{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return At(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:At(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Ne,ctx:{common:e.parent.common,data:e.data,parsedType:At(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(nn(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){var r;const s={common:{issues:[],async:(r=t==null?void 0:t.async)!==null&&r!==void 0?r:!1,contextualErrorMap:t==null?void 0:t.errorMap},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:At(e)},i=this._parseSync({data:e,path:s.path,parent:s});return Jo(s,i)}async parseAsync(e,t){const r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){const r={common:{issues:[],contextualErrorMap:t==null?void 0:t.errorMap,async:!0},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:At(e)},s=this._parse({data:e,path:r.path,parent:r}),i=await(nn(s)?s:Promise.resolve(s));return Jo(r,i)}refine(e,t){const r=s=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(s):t;return this._refinement((s,i)=>{const a=e(s),o=()=>i.addIssue({code:V.custom,...r(s)});return typeof Promise<"u"&&a instanceof Promise?a.then(u=>u?!0:(o(),!1)):a?!0:(o(),!1)})}refinement(e,t){return this._refinement((r,s)=>e(r)?!0:(s.addIssue(typeof t=="function"?t(r,s):t),!1))}_refinement(e){return new Ye({schema:this,typeName:te.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return gt.create(this,this._def)}nullable(){return Mt.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return nt.create(this,this._def)}promise(){return Xt.create(this,this._def)}or(e){return yr.create([this,e],this._def)}and(e){return gr.create(this,e,this._def)}transform(e){return new Ye({...ie(this._def),schema:this,typeName:te.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new Or({...ie(this._def),innerType:this,defaultValue:t,typeName:te.ZodDefault})}brand(){return new _a({typeName:te.ZodBranded,type:this,...ie(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new un({...ie(this._def),innerType:this,catchValue:t,typeName:te.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return xr.create(this,e)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Nb=/^c[^\s-]{8,}$/i,Lb=/^[a-z][a-z0-9]*$/,$b=/[0-9A-HJKMNP-TV-Z]{26}/,Ub=/^([a-f0-9]{8}-[a-f0-9]{4}-[1-5][a-f0-9]{3}-[a-f0-9]{4}-[a-f0-9]{12}|00000000-0000-0000-0000-000000000000)$/i,Mb=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\])|(\[IPv6:(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))\])|([A-Za-z0-9]([A-Za-z0-9-]*[A-Za-z0-9])*(\.[A-Za-z]{2,})+))$/,Fb=/^(\p{Extended_Pictographic}|\p{Emoji_Component})+$/u,Bb=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,Vb=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,qb=n=>n.precision?n.offset?new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${n.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${n.precision}}Z$`):n.precision===0?n.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):n.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$");function zb(n,e){return!!((e==="v4"||!e)&&Bb.test(n)||(e==="v6"||!e)&&Vb.test(n))}class et extends se{constructor(){super(...arguments),this._regex=(e,t,r)=>this.refinement(s=>e.test(s),{validation:t,code:V.invalid_string,...Y.errToObj(r)}),this.nonempty=e=>this.min(1,Y.errToObj(e)),this.trim=()=>new et({...this._def,checks:[...this._def.checks,{kind:"trim"}]}),this.toLowerCase=()=>new et({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]}),this.toUpperCase=()=>new et({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==K.string){const i=this._getOrReturnCtx(e);return Z(i,{code:V.invalid_type,expected:K.string,received:i.parsedType}),ne}const r=new Ne;let s;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(s=this._getOrReturnCtx(e,s),Z(s,{code:V.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="max")e.data.length>i.value&&(s=this._getOrReturnCtx(e,s),Z(s,{code:V.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="length"){const a=e.data.length>i.value,o=e.data.length<i.value;(a||o)&&(s=this._getOrReturnCtx(e,s),a?Z(s,{code:V.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):o&&Z(s,{code:V.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if(i.kind==="email")Mb.test(e.data)||(s=this._getOrReturnCtx(e,s),Z(s,{validation:"email",code:V.invalid_string,message:i.message}),r.dirty());else if(i.kind==="emoji")Fb.test(e.data)||(s=this._getOrReturnCtx(e,s),Z(s,{validation:"emoji",code:V.invalid_string,message:i.message}),r.dirty());else if(i.kind==="uuid")Ub.test(e.data)||(s=this._getOrReturnCtx(e,s),Z(s,{validation:"uuid",code:V.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid")Nb.test(e.data)||(s=this._getOrReturnCtx(e,s),Z(s,{validation:"cuid",code:V.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid2")Lb.test(e.data)||(s=this._getOrReturnCtx(e,s),Z(s,{validation:"cuid2",code:V.invalid_string,message:i.message}),r.dirty());else if(i.kind==="ulid")$b.test(e.data)||(s=this._getOrReturnCtx(e,s),Z(s,{validation:"ulid",code:V.invalid_string,message:i.message}),r.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),Z(s,{validation:"url",code:V.invalid_string,message:i.message}),r.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),Z(s,{validation:"regex",code:V.invalid_string,message:i.message}),r.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(e,s),Z(s,{code:V.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(s=this._getOrReturnCtx(e,s),Z(s,{code:V.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(s=this._getOrReturnCtx(e,s),Z(s,{code:V.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):i.kind==="datetime"?qb(i).test(e.data)||(s=this._getOrReturnCtx(e,s),Z(s,{code:V.invalid_string,validation:"datetime",message:i.message}),r.dirty()):i.kind==="ip"?zb(e.data,i.version)||(s=this._getOrReturnCtx(e,s),Z(s,{validation:"ip",code:V.invalid_string,message:i.message}),r.dirty()):ce.assertNever(i);return{status:r.value,value:e.data}}_addCheck(e){return new et({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...Y.errToObj(e)})}url(e){return this._addCheck({kind:"url",...Y.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...Y.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...Y.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...Y.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...Y.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...Y.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...Y.errToObj(e)})}datetime(e){var t;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(t=e==null?void 0:e.offset)!==null&&t!==void 0?t:!1,...Y.errToObj(e==null?void 0:e.message)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...Y.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t==null?void 0:t.position,...Y.errToObj(t==null?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...Y.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...Y.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...Y.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...Y.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...Y.errToObj(t)})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}et.create=n=>{var e;return new et({checks:[],typeName:te.ZodString,coerce:(e=n==null?void 0:n.coerce)!==null&&e!==void 0?e:!1,...ie(n)})};function Hb(n,e){const t=(n.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,s=t>r?t:r,i=parseInt(n.toFixed(s).replace(".","")),a=parseInt(e.toFixed(s).replace(".",""));return i%a/Math.pow(10,s)}class xt extends se{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==K.number){const i=this._getOrReturnCtx(e);return Z(i,{code:V.invalid_type,expected:K.number,received:i.parsedType}),ne}let r;const s=new Ne;for(const i of this._def.checks)i.kind==="int"?ce.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),Z(r,{code:V.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),Z(r,{code:V.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),Z(r,{code:V.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?Hb(e.data,i.value)!==0&&(r=this._getOrReturnCtx(e,r),Z(r,{code:V.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),Z(r,{code:V.not_finite,message:i.message}),s.dirty()):ce.assertNever(i);return{status:s.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,Y.toString(t))}gt(e,t){return this.setLimit("min",e,!1,Y.toString(t))}lte(e,t){return this.setLimit("max",e,!0,Y.toString(t))}lt(e,t){return this.setLimit("max",e,!1,Y.toString(t))}setLimit(e,t,r,s){return new xt({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:Y.toString(s)}]})}_addCheck(e){return new xt({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:Y.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Y.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Y.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Y.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Y.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:Y.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:Y.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Y.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Y.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&ce.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(t===null||r.value>t)&&(t=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}}xt.create=n=>new xt({checks:[],typeName:te.ZodNumber,coerce:(n==null?void 0:n.coerce)||!1,...ie(n)});class St extends se{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==K.bigint){const i=this._getOrReturnCtx(e);return Z(i,{code:V.invalid_type,expected:K.bigint,received:i.parsedType}),ne}let r;const s=new Ne;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),Z(r,{code:V.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),Z(r,{code:V.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),Z(r,{code:V.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):ce.assertNever(i);return{status:s.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,Y.toString(t))}gt(e,t){return this.setLimit("min",e,!1,Y.toString(t))}lte(e,t){return this.setLimit("max",e,!0,Y.toString(t))}lt(e,t){return this.setLimit("max",e,!1,Y.toString(t))}setLimit(e,t,r,s){return new St({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:Y.toString(s)}]})}_addCheck(e){return new St({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Y.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Y.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Y.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Y.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:Y.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}St.create=n=>{var e;return new St({checks:[],typeName:te.ZodBigInt,coerce:(e=n==null?void 0:n.coerce)!==null&&e!==void 0?e:!1,...ie(n)})};class fr extends se{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==K.boolean){const r=this._getOrReturnCtx(e);return Z(r,{code:V.invalid_type,expected:K.boolean,received:r.parsedType}),ne}return Fe(e.data)}}fr.create=n=>new fr({typeName:te.ZodBoolean,coerce:(n==null?void 0:n.coerce)||!1,...ie(n)});class $t extends se{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==K.date){const i=this._getOrReturnCtx(e);return Z(i,{code:V.invalid_type,expected:K.date,received:i.parsedType}),ne}if(isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return Z(i,{code:V.invalid_date}),ne}const r=new Ne;let s;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(s=this._getOrReturnCtx(e,s),Z(s,{code:V.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(s=this._getOrReturnCtx(e,s),Z(s,{code:V.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):ce.assertNever(i);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new $t({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:Y.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:Y.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}$t.create=n=>new $t({checks:[],coerce:(n==null?void 0:n.coerce)||!1,typeName:te.ZodDate,...ie(n)});class sn extends se{_parse(e){if(this._getType(e)!==K.symbol){const r=this._getOrReturnCtx(e);return Z(r,{code:V.invalid_type,expected:K.symbol,received:r.parsedType}),ne}return Fe(e.data)}}sn.create=n=>new sn({typeName:te.ZodSymbol,...ie(n)});class pr extends se{_parse(e){if(this._getType(e)!==K.undefined){const r=this._getOrReturnCtx(e);return Z(r,{code:V.invalid_type,expected:K.undefined,received:r.parsedType}),ne}return Fe(e.data)}}pr.create=n=>new pr({typeName:te.ZodUndefined,...ie(n)});class mr extends se{_parse(e){if(this._getType(e)!==K.null){const r=this._getOrReturnCtx(e);return Z(r,{code:V.invalid_type,expected:K.null,received:r.parsedType}),ne}return Fe(e.data)}}mr.create=n=>new mr({typeName:te.ZodNull,...ie(n)});class Qt extends se{constructor(){super(...arguments),this._any=!0}_parse(e){return Fe(e.data)}}Qt.create=n=>new Qt({typeName:te.ZodAny,...ie(n)});class Lt extends se{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Fe(e.data)}}Lt.create=n=>new Lt({typeName:te.ZodUnknown,...ie(n)});class _t extends se{_parse(e){const t=this._getOrReturnCtx(e);return Z(t,{code:V.invalid_type,expected:K.never,received:t.parsedType}),ne}}_t.create=n=>new _t({typeName:te.ZodNever,...ie(n)});class an extends se{_parse(e){if(this._getType(e)!==K.undefined){const r=this._getOrReturnCtx(e);return Z(r,{code:V.invalid_type,expected:K.void,received:r.parsedType}),ne}return Fe(e.data)}}an.create=n=>new an({typeName:te.ZodVoid,...ie(n)});class nt extends se{_parse(e){const{ctx:t,status:r}=this._processInputParams(e),s=this._def;if(t.parsedType!==K.array)return Z(t,{code:V.invalid_type,expected:K.array,received:t.parsedType}),ne;if(s.exactLength!==null){const a=t.data.length>s.exactLength.value,o=t.data.length<s.exactLength.value;(a||o)&&(Z(t,{code:a?V.too_big:V.too_small,minimum:o?s.exactLength.value:void 0,maximum:a?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&t.data.length<s.minLength.value&&(Z(t,{code:V.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&t.data.length>s.maxLength.value&&(Z(t,{code:V.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((a,o)=>s.type._parseAsync(new bt(t,a,t.path,o)))).then(a=>Ne.mergeArray(r,a));const i=[...t.data].map((a,o)=>s.type._parseSync(new bt(t,a,t.path,o)));return Ne.mergeArray(r,i)}get element(){return this._def.type}min(e,t){return new nt({...this._def,minLength:{value:e,message:Y.toString(t)}})}max(e,t){return new nt({...this._def,maxLength:{value:e,message:Y.toString(t)}})}length(e,t){return new nt({...this._def,exactLength:{value:e,message:Y.toString(t)}})}nonempty(e){return this.min(1,e)}}nt.create=(n,e)=>new nt({type:n,minLength:null,maxLength:null,exactLength:null,typeName:te.ZodArray,...ie(e)});function cr(n){if(n instanceof we){const e={};for(const t in n.shape){const r=n.shape[t];e[t]=gt.create(cr(r))}return new we({...n._def,shape:()=>e})}else return n instanceof nt?new nt({...n._def,type:cr(n.element)}):n instanceof gt?gt.create(cr(n.unwrap())):n instanceof Mt?Mt.create(cr(n.unwrap())):n instanceof lt?lt.create(n.items.map(e=>cr(e))):n}class we extends se{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=ce.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==K.object){const c=this._getOrReturnCtx(e);return Z(c,{code:V.invalid_type,expected:K.object,received:c.parsedType}),ne}const{status:r,ctx:s}=this._processInputParams(e),{shape:i,keys:a}=this._getCached(),o=[];if(!(this._def.catchall instanceof _t&&this._def.unknownKeys==="strip"))for(const c in s.data)a.includes(c)||o.push(c);const u=[];for(const c of a){const l=i[c],d=s.data[c];u.push({key:{status:"valid",value:c},value:l._parse(new bt(s,d,s.path,c)),alwaysSet:c in s.data})}if(this._def.catchall instanceof _t){const c=this._def.unknownKeys;if(c==="passthrough")for(const l of o)u.push({key:{status:"valid",value:l},value:{status:"valid",value:s.data[l]}});else if(c==="strict")o.length>0&&(Z(s,{code:V.unrecognized_keys,keys:o}),r.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const l of o){const d=s.data[l];u.push({key:{status:"valid",value:l},value:c._parse(new bt(s,d,s.path,l)),alwaysSet:l in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const c=[];for(const l of u){const d=await l.key;c.push({key:d,value:await l.value,alwaysSet:l.alwaysSet})}return c}).then(c=>Ne.mergeObjectSync(r,c)):Ne.mergeObjectSync(r,u)}get shape(){return this._def.shape()}strict(e){return Y.errToObj,new we({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,r)=>{var s,i,a,o;const u=(a=(i=(s=this._def).errorMap)===null||i===void 0?void 0:i.call(s,t,r).message)!==null&&a!==void 0?a:r.defaultError;return t.code==="unrecognized_keys"?{message:(o=Y.errToObj(e).message)!==null&&o!==void 0?o:u}:{message:u}}}:{}})}strip(){return new we({...this._def,unknownKeys:"strip"})}passthrough(){return new we({...this._def,unknownKeys:"passthrough"})}extend(e){return new we({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new we({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:te.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new we({...this._def,catchall:e})}pick(e){const t={};return ce.objectKeys(e).forEach(r=>{e[r]&&this.shape[r]&&(t[r]=this.shape[r])}),new we({...this._def,shape:()=>t})}omit(e){const t={};return ce.objectKeys(this.shape).forEach(r=>{e[r]||(t[r]=this.shape[r])}),new we({...this._def,shape:()=>t})}deepPartial(){return cr(this)}partial(e){const t={};return ce.objectKeys(this.shape).forEach(r=>{const s=this.shape[r];e&&!e[r]?t[r]=s:t[r]=s.optional()}),new we({...this._def,shape:()=>t})}required(e){const t={};return ce.objectKeys(this.shape).forEach(r=>{if(e&&!e[r])t[r]=this.shape[r];else{let i=this.shape[r];for(;i instanceof gt;)i=i._def.innerType;t[r]=i}}),new we({...this._def,shape:()=>t})}keyof(){return Wc(ce.objectKeys(this.shape))}}we.create=(n,e)=>new we({shape:()=>n,unknownKeys:"strip",catchall:_t.create(),typeName:te.ZodObject,...ie(e)});we.strictCreate=(n,e)=>new we({shape:()=>n,unknownKeys:"strict",catchall:_t.create(),typeName:te.ZodObject,...ie(e)});we.lazycreate=(n,e)=>new we({shape:n,unknownKeys:"strip",catchall:_t.create(),typeName:te.ZodObject,...ie(e)});class yr extends se{_parse(e){const{ctx:t}=this._processInputParams(e),r=this._def.options;function s(i){for(const o of i)if(o.result.status==="valid")return o.result;for(const o of i)if(o.result.status==="dirty")return t.common.issues.push(...o.ctx.common.issues),o.result;const a=i.map(o=>new rt(o.ctx.common.issues));return Z(t,{code:V.invalid_union,unionErrors:a}),ne}if(t.common.async)return Promise.all(r.map(async i=>{const a={...t,common:{...t.common,issues:[]},parent:null};return{result:await i._parseAsync({data:t.data,path:t.path,parent:a}),ctx:a}})).then(s);{let i;const a=[];for(const u of r){const c={...t,common:{...t.common,issues:[]},parent:null},l=u._parseSync({data:t.data,path:t.path,parent:c});if(l.status==="valid")return l;l.status==="dirty"&&!i&&(i={result:l,ctx:c}),c.common.issues.length&&a.push(c.common.issues)}if(i)return t.common.issues.push(...i.ctx.common.issues),i.result;const o=a.map(u=>new rt(u));return Z(t,{code:V.invalid_union,unionErrors:o}),ne}}get options(){return this._def.options}}yr.create=(n,e)=>new yr({options:n,typeName:te.ZodUnion,...ie(e)});const Vn=n=>n instanceof _r?Vn(n.schema):n instanceof Ye?Vn(n.innerType()):n instanceof vr?[n.value]:n instanceof jt?n.options:n instanceof wr?Object.keys(n.enum):n instanceof Or?Vn(n._def.innerType):n instanceof pr?[void 0]:n instanceof mr?[null]:null;class vn extends se{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==K.object)return Z(t,{code:V.invalid_type,expected:K.object,received:t.parsedType}),ne;const r=this.discriminator,s=t.data[r],i=this.optionsMap.get(s);return i?t.common.async?i._parseAsync({data:t.data,path:t.path,parent:t}):i._parseSync({data:t.data,path:t.path,parent:t}):(Z(t,{code:V.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),ne)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,r){const s=new Map;for(const i of t){const a=Vn(i.shape[e]);if(!a)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const o of a){if(s.has(o))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(o)}`);s.set(o,i)}}return new vn({typeName:te.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:s,...ie(r)})}}function Ni(n,e){const t=At(n),r=At(e);if(n===e)return{valid:!0,data:n};if(t===K.object&&r===K.object){const s=ce.objectKeys(e),i=ce.objectKeys(n).filter(o=>s.indexOf(o)!==-1),a={...n,...e};for(const o of i){const u=Ni(n[o],e[o]);if(!u.valid)return{valid:!1};a[o]=u.data}return{valid:!0,data:a}}else if(t===K.array&&r===K.array){if(n.length!==e.length)return{valid:!1};const s=[];for(let i=0;i<n.length;i++){const a=n[i],o=e[i],u=Ni(a,o);if(!u.valid)return{valid:!1};s.push(u.data)}return{valid:!0,data:s}}else return t===K.date&&r===K.date&&+n==+e?{valid:!0,data:n}:{valid:!1}}class gr extends se{_parse(e){const{status:t,ctx:r}=this._processInputParams(e),s=(i,a)=>{if(Gn(i)||Gn(a))return ne;const o=Ni(i.value,a.value);return o.valid?((Yn(i)||Yn(a))&&t.dirty(),{status:t.value,value:o.data}):(Z(r,{code:V.invalid_intersection_types}),ne)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,a])=>s(i,a)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}gr.create=(n,e,t)=>new gr({left:n,right:e,typeName:te.ZodIntersection,...ie(t)});class lt extends se{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==K.array)return Z(r,{code:V.invalid_type,expected:K.array,received:r.parsedType}),ne;if(r.data.length<this._def.items.length)return Z(r,{code:V.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),ne;!this._def.rest&&r.data.length>this._def.items.length&&(Z(r,{code:V.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const i=[...r.data].map((a,o)=>{const u=this._def.items[o]||this._def.rest;return u?u._parse(new bt(r,a,r.path,o)):null}).filter(a=>!!a);return r.common.async?Promise.all(i).then(a=>Ne.mergeArray(t,a)):Ne.mergeArray(t,i)}get items(){return this._def.items}rest(e){return new lt({...this._def,rest:e})}}lt.create=(n,e)=>{if(!Array.isArray(n))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new lt({items:n,typeName:te.ZodTuple,rest:null,...ie(e)})};class br extends se{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==K.object)return Z(r,{code:V.invalid_type,expected:K.object,received:r.parsedType}),ne;const s=[],i=this._def.keyType,a=this._def.valueType;for(const o in r.data)s.push({key:i._parse(new bt(r,o,r.path,o)),value:a._parse(new bt(r,r.data[o],r.path,o))});return r.common.async?Ne.mergeObjectAsync(t,s):Ne.mergeObjectSync(t,s)}get element(){return this._def.valueType}static create(e,t,r){return t instanceof se?new br({keyType:e,valueType:t,typeName:te.ZodRecord,...ie(r)}):new br({keyType:et.create(),valueType:e,typeName:te.ZodRecord,...ie(t)})}}class on extends se{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==K.map)return Z(r,{code:V.invalid_type,expected:K.map,received:r.parsedType}),ne;const s=this._def.keyType,i=this._def.valueType,a=[...r.data.entries()].map(([o,u],c)=>({key:s._parse(new bt(r,o,r.path,[c,"key"])),value:i._parse(new bt(r,u,r.path,[c,"value"]))}));if(r.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const u of a){const c=await u.key,l=await u.value;if(c.status==="aborted"||l.status==="aborted")return ne;(c.status==="dirty"||l.status==="dirty")&&t.dirty(),o.set(c.value,l.value)}return{status:t.value,value:o}})}else{const o=new Map;for(const u of a){const c=u.key,l=u.value;if(c.status==="aborted"||l.status==="aborted")return ne;(c.status==="dirty"||l.status==="dirty")&&t.dirty(),o.set(c.value,l.value)}return{status:t.value,value:o}}}}on.create=(n,e,t)=>new on({valueType:e,keyType:n,typeName:te.ZodMap,...ie(t)});class Ut extends se{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==K.set)return Z(r,{code:V.invalid_type,expected:K.set,received:r.parsedType}),ne;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&(Z(r,{code:V.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),t.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&(Z(r,{code:V.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),t.dirty());const i=this._def.valueType;function a(u){const c=new Set;for(const l of u){if(l.status==="aborted")return ne;l.status==="dirty"&&t.dirty(),c.add(l.value)}return{status:t.value,value:c}}const o=[...r.data.values()].map((u,c)=>i._parse(new bt(r,u,r.path,c)));return r.common.async?Promise.all(o).then(u=>a(u)):a(o)}min(e,t){return new Ut({...this._def,minSize:{value:e,message:Y.toString(t)}})}max(e,t){return new Ut({...this._def,maxSize:{value:e,message:Y.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}Ut.create=(n,e)=>new Ut({valueType:n,minSize:null,maxSize:null,typeName:te.ZodSet,...ie(e)});class Yt extends se{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==K.function)return Z(t,{code:V.invalid_type,expected:K.function,received:t.parsedType}),ne;function r(o,u){return tn({data:o,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,en(),hr].filter(c=>!!c),issueData:{code:V.invalid_arguments,argumentsError:u}})}function s(o,u){return tn({data:o,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,en(),hr].filter(c=>!!c),issueData:{code:V.invalid_return_type,returnTypeError:u}})}const i={errorMap:t.common.contextualErrorMap},a=t.data;return this._def.returns instanceof Xt?Fe(async(...o)=>{const u=new rt([]),c=await this._def.args.parseAsync(o,i).catch(h=>{throw u.addIssue(r(o,h)),u}),l=await a(...c);return await this._def.returns._def.type.parseAsync(l,i).catch(h=>{throw u.addIssue(s(l,h)),u})}):Fe((...o)=>{const u=this._def.args.safeParse(o,i);if(!u.success)throw new rt([r(o,u.error)]);const c=a(...u.data),l=this._def.returns.safeParse(c,i);if(!l.success)throw new rt([s(c,l.error)]);return l.data})}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Yt({...this._def,args:lt.create(e).rest(Lt.create())})}returns(e){return new Yt({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,r){return new Yt({args:e||lt.create([]).rest(Lt.create()),returns:t||Lt.create(),typeName:te.ZodFunction,...ie(r)})}}class _r extends se{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}_r.create=(n,e)=>new _r({getter:n,typeName:te.ZodLazy,...ie(e)});class vr extends se{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return Z(t,{received:t.data,code:V.invalid_literal,expected:this._def.value}),ne}return{status:"valid",value:e.data}}get value(){return this._def.value}}vr.create=(n,e)=>new vr({value:n,typeName:te.ZodLiteral,...ie(e)});function Wc(n,e){return new jt({values:n,typeName:te.ZodEnum,...ie(e)})}class jt extends se{_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),r=this._def.values;return Z(t,{expected:ce.joinValues(r),received:t.parsedType,code:V.invalid_type}),ne}if(this._def.values.indexOf(e.data)===-1){const t=this._getOrReturnCtx(e),r=this._def.values;return Z(t,{received:t.data,code:V.invalid_enum_value,options:r}),ne}return Fe(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e){return jt.create(e)}exclude(e){return jt.create(this.options.filter(t=>!e.includes(t)))}}jt.create=Wc;class wr extends se{_parse(e){const t=ce.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==K.string&&r.parsedType!==K.number){const s=ce.objectValues(t);return Z(r,{expected:ce.joinValues(s),received:r.parsedType,code:V.invalid_type}),ne}if(t.indexOf(e.data)===-1){const s=ce.objectValues(t);return Z(r,{received:r.data,code:V.invalid_enum_value,options:s}),ne}return Fe(e.data)}get enum(){return this._def.values}}wr.create=(n,e)=>new wr({values:n,typeName:te.ZodNativeEnum,...ie(e)});class Xt extends se{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==K.promise&&t.common.async===!1)return Z(t,{code:V.invalid_type,expected:K.promise,received:t.parsedType}),ne;const r=t.parsedType===K.promise?t.data:Promise.resolve(t.data);return Fe(r.then(s=>this._def.type.parseAsync(s,{path:t.path,errorMap:t.common.contextualErrorMap})))}}Xt.create=(n,e)=>new Xt({type:n,typeName:te.ZodPromise,...ie(e)});class Ye extends se{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===te.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:r}=this._processInputParams(e),s=this._def.effect||null;if(s.type==="preprocess"){const a=s.transform(r.data);return r.common.async?Promise.resolve(a).then(o=>this._def.schema._parseAsync({data:o,path:r.path,parent:r})):this._def.schema._parseSync({data:a,path:r.path,parent:r})}const i={addIssue:a=>{Z(r,a),a.fatal?t.abort():t.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="refinement"){const a=o=>{const u=s.refinement(o,i);if(r.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return o.status==="aborted"?ne:(o.status==="dirty"&&t.dirty(),a(o.value),{status:t.value,value:o.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>o.status==="aborted"?ne:(o.status==="dirty"&&t.dirty(),a(o.value).then(()=>({status:t.value,value:o.value}))))}if(s.type==="transform")if(r.common.async===!1){const a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!rn(a))return a;const o=s.transform(a.value,i);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:o}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(a=>rn(a)?Promise.resolve(s.transform(a.value,i)).then(o=>({status:t.value,value:o})):a);ce.assertNever(s)}}Ye.create=(n,e,t)=>new Ye({schema:n,typeName:te.ZodEffects,effect:e,...ie(t)});Ye.createWithPreprocess=(n,e,t)=>new Ye({schema:e,effect:{type:"preprocess",transform:n},typeName:te.ZodEffects,...ie(t)});class gt extends se{_parse(e){return this._getType(e)===K.undefined?Fe(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}gt.create=(n,e)=>new gt({innerType:n,typeName:te.ZodOptional,...ie(e)});class Mt extends se{_parse(e){return this._getType(e)===K.null?Fe(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Mt.create=(n,e)=>new Mt({innerType:n,typeName:te.ZodNullable,...ie(e)});class Or extends se{_parse(e){const{ctx:t}=this._processInputParams(e);let r=t.data;return t.parsedType===K.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}Or.create=(n,e)=>new Or({innerType:n,typeName:te.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...ie(e)});class un extends se{_parse(e){const{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return nn(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new rt(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new rt(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}un.create=(n,e)=>new un({innerType:n,typeName:te.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...ie(e)});class cn extends se{_parse(e){if(this._getType(e)!==K.nan){const r=this._getOrReturnCtx(e);return Z(r,{code:V.invalid_type,expected:K.nan,received:r.parsedType}),ne}return{status:"valid",value:e.data}}}cn.create=n=>new cn({typeName:te.ZodNaN,...ie(n)});const Qc=Symbol("zod_brand");class _a extends se{_parse(e){const{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}class xr extends se{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?ne:i.status==="dirty"?(t.dirty(),ba(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?ne:s.status==="dirty"?(t.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(e,t){return new xr({in:e,out:t,typeName:te.ZodPipeline})}}const va=(n,e={},t)=>n?Qt.create().superRefine((r,s)=>{var i,a;if(!n(r)){const o=typeof e=="function"?e(r):typeof e=="string"?{message:e}:e,u=(a=(i=o.fatal)!==null&&i!==void 0?i:t)!==null&&a!==void 0?a:!0,c=typeof o=="string"?{message:o}:o;s.addIssue({code:"custom",...c,fatal:u})}}):Qt.create(),Xc={object:we.lazycreate};var te;(function(n){n.ZodString="ZodString",n.ZodNumber="ZodNumber",n.ZodNaN="ZodNaN",n.ZodBigInt="ZodBigInt",n.ZodBoolean="ZodBoolean",n.ZodDate="ZodDate",n.ZodSymbol="ZodSymbol",n.ZodUndefined="ZodUndefined",n.ZodNull="ZodNull",n.ZodAny="ZodAny",n.ZodUnknown="ZodUnknown",n.ZodNever="ZodNever",n.ZodVoid="ZodVoid",n.ZodArray="ZodArray",n.ZodObject="ZodObject",n.ZodUnion="ZodUnion",n.ZodDiscriminatedUnion="ZodDiscriminatedUnion",n.ZodIntersection="ZodIntersection",n.ZodTuple="ZodTuple",n.ZodRecord="ZodRecord",n.ZodMap="ZodMap",n.ZodSet="ZodSet",n.ZodFunction="ZodFunction",n.ZodLazy="ZodLazy",n.ZodLiteral="ZodLiteral",n.ZodEnum="ZodEnum",n.ZodEffects="ZodEffects",n.ZodNativeEnum="ZodNativeEnum",n.ZodOptional="ZodOptional",n.ZodNullable="ZodNullable",n.ZodDefault="ZodDefault",n.ZodCatch="ZodCatch",n.ZodPromise="ZodPromise",n.ZodBranded="ZodBranded",n.ZodPipeline="ZodPipeline"})(te||(te={}));const el=(n,e={message:`Input not instance of ${n.name}`})=>va(t=>t instanceof n,e),wa=et.create,Oa=xt.create,tl=cn.create,rl=St.create,Ea=fr.create,nl=$t.create,sl=sn.create,il=pr.create,al=mr.create,ol=Qt.create,ul=Lt.create,cl=_t.create,ll=an.create,dl=nt.create,hl=we.create,fl=we.strictCreate,pl=yr.create,ml=vn.create,yl=gr.create,gl=lt.create,bl=br.create,_l=on.create,vl=Ut.create,wl=Yt.create,Ol=_r.create,El=vr.create,Al=jt.create,Tl=wr.create,Pl=Xt.create,Wn=Ye.create,xl=gt.create,Sl=Mt.create,jl=Ye.createWithPreprocess,kl=xr.create,Cl=()=>wa().optional(),Il=()=>Oa().optional(),Rl=()=>Ea().optional(),Dl={string:n=>et.create({...n,coerce:!0}),number:n=>xt.create({...n,coerce:!0}),boolean:n=>fr.create({...n,coerce:!0}),bigint:n=>St.create({...n,coerce:!0}),date:n=>$t.create({...n,coerce:!0})},Nl=ne;var Go=Object.freeze({__proto__:null,defaultErrorMap:hr,setErrorMap:Gc,getErrorMap:en,makeIssue:tn,EMPTY_PATH:Yc,addIssueToContext:Z,ParseStatus:Ne,INVALID:ne,DIRTY:ba,OK:Fe,isAborted:Gn,isDirty:Yn,isValid:rn,isAsync:nn,get util(){return ce},get objectUtil(){return Jn},ZodParsedType:K,getParsedType:At,ZodType:se,ZodString:et,ZodNumber:xt,ZodBigInt:St,ZodBoolean:fr,ZodDate:$t,ZodSymbol:sn,ZodUndefined:pr,ZodNull:mr,ZodAny:Qt,ZodUnknown:Lt,ZodNever:_t,ZodVoid:an,ZodArray:nt,ZodObject:we,ZodUnion:yr,ZodDiscriminatedUnion:vn,ZodIntersection:gr,ZodTuple:lt,ZodRecord:br,ZodMap:on,ZodSet:Ut,ZodFunction:Yt,ZodLazy:_r,ZodLiteral:vr,ZodEnum:jt,ZodNativeEnum:wr,ZodPromise:Xt,ZodEffects:Ye,ZodTransformer:Ye,ZodOptional:gt,ZodNullable:Mt,ZodDefault:Or,ZodCatch:un,ZodNaN:cn,BRAND:Qc,ZodBranded:_a,ZodPipeline:xr,custom:va,Schema:se,ZodSchema:se,late:Xc,get ZodFirstPartyTypeKind(){return te},coerce:Dl,any:ol,array:dl,bigint:rl,boolean:Ea,date:nl,discriminatedUnion:ml,effect:Wn,enum:Al,function:wl,instanceof:el,intersection:yl,lazy:Ol,literal:El,map:_l,nan:tl,nativeEnum:Tl,never:cl,null:al,nullable:Sl,number:Oa,object:hl,oboolean:Rl,onumber:Il,optional:xl,ostring:Cl,pipeline:kl,preprocess:jl,promise:Pl,record:bl,set:vl,strictObject:fl,string:wa,symbol:sl,transformer:Wn,tuple:gl,undefined:il,union:pl,unknown:ul,void:ll,NEVER:Nl,ZodIssueCode:V,quotelessJson:Zc,ZodError:rt});const Kb=Object.freeze(Object.defineProperty({__proto__:null,BRAND:Qc,DIRTY:ba,EMPTY_PATH:Yc,INVALID:ne,NEVER:Nl,OK:Fe,ParseStatus:Ne,Schema:se,ZodAny:Qt,ZodArray:nt,ZodBigInt:St,ZodBoolean:fr,ZodBranded:_a,ZodCatch:un,ZodDate:$t,ZodDefault:Or,ZodDiscriminatedUnion:vn,ZodEffects:Ye,ZodEnum:jt,ZodError:rt,get ZodFirstPartyTypeKind(){return te},ZodFunction:Yt,ZodIntersection:gr,ZodIssueCode:V,ZodLazy:_r,ZodLiteral:vr,ZodMap:on,ZodNaN:cn,ZodNativeEnum:wr,ZodNever:_t,ZodNull:mr,ZodNullable:Mt,ZodNumber:xt,ZodObject:we,ZodOptional:gt,ZodParsedType:K,ZodPipeline:xr,ZodPromise:Xt,ZodRecord:br,ZodSchema:se,ZodSet:Ut,ZodString:et,ZodSymbol:sn,ZodTransformer:Ye,ZodTuple:lt,ZodType:se,ZodUndefined:pr,ZodUnion:yr,ZodUnknown:Lt,ZodVoid:an,addIssueToContext:Z,any:ol,array:dl,bigint:rl,boolean:Ea,coerce:Dl,custom:va,date:nl,default:Go,defaultErrorMap:hr,discriminatedUnion:ml,effect:Wn,enum:Al,function:wl,getErrorMap:en,getParsedType:At,instanceof:el,intersection:yl,isAborted:Gn,isAsync:nn,isDirty:Yn,isValid:rn,late:Xc,lazy:Ol,literal:El,makeIssue:tn,map:_l,nan:tl,nativeEnum:Tl,never:cl,null:al,nullable:Sl,number:Oa,object:hl,get objectUtil(){return Jn},oboolean:Rl,onumber:Il,optional:xl,ostring:Cl,pipeline:kl,preprocess:jl,promise:Pl,quotelessJson:Zc,record:bl,set:vl,setErrorMap:Gc,strictObject:fl,string:wa,symbol:sl,transformer:Wn,tuple:gl,undefined:il,union:pl,unknown:ul,get util(){return ce},void:ll,z:Go},Symbol.toStringTag,{value:"Module"}));var Zb={},_s={},Cr={};const Aa=ad(Kb);var vs={};Object.defineProperty(vs,"__esModule",{value:!0});vs.parseAnyDef=void 0;function Jb(){return{}}vs.parseAnyDef=Jb;var Ir={},dt={};Object.defineProperty(dt,"__esModule",{value:!0});dt.setResponseValueAndErrors=dt.addErrorMessage=void 0;function Ll(n,e,t,r){r!=null&&r.errorMessages&&t&&(n.errorMessage=Object.assign(Object.assign({},n.errorMessage),{[e]:t}))}dt.addErrorMessage=Ll;function Gb(n,e,t,r,s){n[e]=t,Ll(n,e,r,s)}dt.setResponseValueAndErrors=Gb;var Yo;function Yb(){if(Yo)return Ir;Yo=1,Object.defineProperty(Ir,"__esModule",{value:!0}),Ir.parseArrayDef=void 0;const n=Aa,e=dt,t=Le();function r(s,i){var a,o;const u={type:"array"};return((o=(a=s.type)===null||a===void 0?void 0:a._def)===null||o===void 0?void 0:o.typeName)!==n.ZodFirstPartyTypeKind.ZodAny&&(u.items=(0,t.parseDef)(s.type._def,Object.assign(Object.assign({},i),{currentPath:[...i.currentPath,"items"]}))),s.minLength&&(0,e.setResponseValueAndErrors)(u,"minItems",s.minLength.value,s.minLength.message,i),s.maxLength&&(0,e.setResponseValueAndErrors)(u,"maxItems",s.maxLength.value,s.maxLength.message,i),s.exactLength&&((0,e.setResponseValueAndErrors)(u,"minItems",s.exactLength.value,s.exactLength.message,i),(0,e.setResponseValueAndErrors)(u,"maxItems",s.exactLength.value,s.exactLength.message,i)),u}return Ir.parseArrayDef=r,Ir}var ws={};Object.defineProperty(ws,"__esModule",{value:!0});ws.parseBigintDef=void 0;const Vt=dt;function Wb(n,e){const t={type:"integer",format:"int64"};if(!n.checks)return t;for(const r of n.checks)switch(r.kind){case"min":e.target==="jsonSchema7"?r.inclusive?(0,Vt.setResponseValueAndErrors)(t,"minimum",r.value,r.message,e):(0,Vt.setResponseValueAndErrors)(t,"exclusiveMinimum",r.value,r.message,e):(r.inclusive||(t.exclusiveMinimum=!0),(0,Vt.setResponseValueAndErrors)(t,"minimum",r.value,r.message,e));break;case"max":e.target==="jsonSchema7"?r.inclusive?(0,Vt.setResponseValueAndErrors)(t,"maximum",r.value,r.message,e):(0,Vt.setResponseValueAndErrors)(t,"exclusiveMaximum",r.value,r.message,e):(r.inclusive||(t.exclusiveMaximum=!0),(0,Vt.setResponseValueAndErrors)(t,"maximum",r.value,r.message,e));break;case"multipleOf":(0,Vt.setResponseValueAndErrors)(t,"multipleOf",r.value,r.message,e);break}return t}ws.parseBigintDef=Wb;var Os={};Object.defineProperty(Os,"__esModule",{value:!0});Os.parseBooleanDef=void 0;function Qb(){return{type:"boolean"}}Os.parseBooleanDef=Qb;var Rr={},Wo;function Xb(){if(Wo)return Rr;Wo=1,Object.defineProperty(Rr,"__esModule",{value:!0}),Rr.parseBrandedDef=void 0;const n=Le();function e(t,r){return(0,n.parseDef)(t.type._def,r)}return Rr.parseBrandedDef=e,Rr}var Dr={},Qo;function e_(){if(Qo)return Dr;Qo=1,Object.defineProperty(Dr,"__esModule",{value:!0}),Dr.parseCatchDef=void 0;const n=Le(),e=(t,r)=>(0,n.parseDef)(t.innerType._def,r);return Dr.parseCatchDef=e,Dr}var Es={};Object.defineProperty(Es,"__esModule",{value:!0});Es.parseDateDef=void 0;const Xo=dt;function t_(n,e){return e.dateStrategy=="integer"?r_(n,e):{type:"string",format:"date-time"}}Es.parseDateDef=t_;const r_=(n,e)=>{const t={type:"integer",format:"unix-time"};for(const r of n.checks)switch(r.kind){case"min":e.target==="jsonSchema7"&&(0,Xo.setResponseValueAndErrors)(t,"minimum",r.value,r.message,e);break;case"max":e.target==="jsonSchema7"&&(0,Xo.setResponseValueAndErrors)(t,"maximum",r.value,r.message,e);break}return t};var Nr={},eu;function n_(){if(eu)return Nr;eu=1,Object.defineProperty(Nr,"__esModule",{value:!0}),Nr.parseDefaultDef=void 0;const n=Le();function e(t,r){return Object.assign(Object.assign({},(0,n.parseDef)(t.innerType._def,r)),{default:t.defaultValue()})}return Nr.parseDefaultDef=e,Nr}var Lr={},tu;function s_(){if(tu)return Lr;tu=1,Object.defineProperty(Lr,"__esModule",{value:!0}),Lr.parseEffectsDef=void 0;const n=Le();function e(t,r){return r.effectStrategy==="input"?(0,n.parseDef)(t.schema._def,r):{}}return Lr.parseEffectsDef=e,Lr}var As={};Object.defineProperty(As,"__esModule",{value:!0});As.parseEnumDef=void 0;function i_(n){return{type:"string",enum:n.values}}As.parseEnumDef=i_;var $r={},ru;function a_(){if(ru)return $r;ru=1;var n=ut&&ut.__rest||function(s,i){var a={};for(var o in s)Object.prototype.hasOwnProperty.call(s,o)&&i.indexOf(o)<0&&(a[o]=s[o]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,o=Object.getOwnPropertySymbols(s);u<o.length;u++)i.indexOf(o[u])<0&&Object.prototype.propertyIsEnumerable.call(s,o[u])&&(a[o[u]]=s[o[u]]);return a};Object.defineProperty($r,"__esModule",{value:!0}),$r.parseIntersectionDef=void 0;const e=Le(),t=s=>"type"in s&&s.type==="string"?!1:"allOf"in s;function r(s,i){const a=[(0,e.parseDef)(s.left._def,Object.assign(Object.assign({},i),{currentPath:[...i.currentPath,"allOf","0"]})),(0,e.parseDef)(s.right._def,Object.assign(Object.assign({},i),{currentPath:[...i.currentPath,"allOf","1"]}))].filter(c=>!!c);let o=i.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const u=[];return a.forEach(c=>{if(t(c))u.push(...c.allOf),c.unevaluatedProperties===void 0&&(o=void 0);else{let l=c;"additionalProperties"in c&&c.additionalProperties===!1?l=n(c,["additionalProperties"]):o=void 0,u.push(l)}}),u.length?Object.assign({allOf:u},o):void 0}return $r.parseIntersectionDef=r,$r}var Ts={};Object.defineProperty(Ts,"__esModule",{value:!0});Ts.parseLiteralDef=void 0;function o_(n,e){const t=typeof n.value;return t!=="bigint"&&t!=="number"&&t!=="boolean"&&t!=="string"?{type:Array.isArray(n.value)?"array":"object"}:e.target==="openApi3"?{type:t==="bigint"?"integer":t,enum:[n.value]}:{type:t==="bigint"?"integer":t,const:n.value}}Ts.parseLiteralDef=o_;var Ur={},nu;function u_(){if(nu)return Ur;nu=1,Object.defineProperty(Ur,"__esModule",{value:!0}),Ur.parseMapDef=void 0;const n=Le();function e(t,r){const s=(0,n.parseDef)(t.keyType._def,Object.assign(Object.assign({},r),{currentPath:[...r.currentPath,"items","items","0"]}))||{},i=(0,n.parseDef)(t.valueType._def,Object.assign(Object.assign({},r),{currentPath:[...r.currentPath,"items","items","1"]}))||{};return{type:"array",maxItems:125,items:{type:"array",items:[s,i],minItems:2,maxItems:2}}}return Ur.parseMapDef=e,Ur}var Ps={};Object.defineProperty(Ps,"__esModule",{value:!0});Ps.parseNativeEnumDef=void 0;function c_(n){const e=n.values,r=Object.keys(n.values).filter(i=>typeof e[e[i]]!="number").map(i=>e[i]),s=Array.from(new Set(r.map(i=>typeof i)));return{type:s.length===1?s[0]==="string"?"string":"number":["string","number"],enum:r}}Ps.parseNativeEnumDef=c_;var xs={};Object.defineProperty(xs,"__esModule",{value:!0});xs.parseNeverDef=void 0;function l_(){return{not:{}}}xs.parseNeverDef=l_;var Ss={};Object.defineProperty(Ss,"__esModule",{value:!0});Ss.parseNullDef=void 0;function d_(n){return n.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}Ss.parseNullDef=d_;var Mr={},mi={},su;function $l(){return su||(su=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.parseUnionDef=n.primitiveMappings=void 0;const e=Le();n.primitiveMappings={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function t(s,i){if(i.target==="openApi3")return r(s,i);const a=s.options instanceof Map?Array.from(s.options.values()):s.options;if(a.every(o=>o._def.typeName in n.primitiveMappings&&(!o._def.checks||!o._def.checks.length))){const o=a.reduce((u,c)=>{const l=n.primitiveMappings[c._def.typeName];return l&&!u.includes(l)?[...u,l]:u},[]);return{type:o.length>1?o:o[0]}}else if(a.every(o=>o._def.typeName==="ZodLiteral"&&!o.description)){const o=a.reduce((u,c)=>{const l=typeof c._def.value;switch(l){case"string":case"number":case"boolean":return[...u,l];case"bigint":return[...u,"integer"];case"object":if(c._def.value===null)return[...u,"null"];case"symbol":case"undefined":case"function":default:return u}},[]);if(o.length===a.length){const u=o.filter((c,l,d)=>d.indexOf(c)===l);return{type:u.length>1?u:u[0],enum:a.reduce((c,l)=>c.includes(l._def.value)?c:[...c,l._def.value],[])}}}else if(a.every(o=>o._def.typeName==="ZodEnum"))return{type:"string",enum:a.reduce((o,u)=>[...o,...u._def.values.filter(c=>!o.includes(c))],[])};return r(s,i)}n.parseUnionDef=t;const r=(s,i)=>{const a=(s.options instanceof Map?Array.from(s.options.values()):s.options).map((o,u)=>(0,e.parseDef)(o._def,Object.assign(Object.assign({},i),{currentPath:[...i.currentPath,"anyOf",`${u}`]}))).filter(o=>!!o&&(!i.strictUnions||typeof o=="object"&&Object.keys(o).length>0));return a.length?{anyOf:a}:void 0}}(mi)),mi}var iu;function h_(){if(iu)return Mr;iu=1,Object.defineProperty(Mr,"__esModule",{value:!0}),Mr.parseNullableDef=void 0;const n=Le(),e=$l();function t(r,s){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(r.innerType._def.typeName)&&(!r.innerType._def.checks||!r.innerType._def.checks.length))return s.target==="openApi3"?{type:e.primitiveMappings[r.innerType._def.typeName],nullable:!0}:{type:[e.primitiveMappings[r.innerType._def.typeName],"null"]};if(s.target==="openApi3"){const a=(0,n.parseDef)(r.innerType._def,Object.assign(Object.assign({},s),{currentPath:[...s.currentPath]}));return a&&Object.assign(Object.assign({},a),{nullable:!0})}const i=(0,n.parseDef)(r.innerType._def,Object.assign(Object.assign({},s),{currentPath:[...s.currentPath,"anyOf","0"]}));return i&&{anyOf:[i,{type:"null"}]}}return Mr.parseNullableDef=t,Mr}var js={};Object.defineProperty(js,"__esModule",{value:!0});js.parseNumberDef=void 0;const Rt=dt;function f_(n,e){const t={type:"number"};if(!n.checks)return t;for(const r of n.checks)switch(r.kind){case"int":t.type="integer",(0,Rt.addErrorMessage)(t,"type",r.message,e);break;case"min":e.target==="jsonSchema7"?r.inclusive?(0,Rt.setResponseValueAndErrors)(t,"minimum",r.value,r.message,e):(0,Rt.setResponseValueAndErrors)(t,"exclusiveMinimum",r.value,r.message,e):(r.inclusive||(t.exclusiveMinimum=!0),(0,Rt.setResponseValueAndErrors)(t,"minimum",r.value,r.message,e));break;case"max":e.target==="jsonSchema7"?r.inclusive?(0,Rt.setResponseValueAndErrors)(t,"maximum",r.value,r.message,e):(0,Rt.setResponseValueAndErrors)(t,"exclusiveMaximum",r.value,r.message,e):(r.inclusive||(t.exclusiveMaximum=!0),(0,Rt.setResponseValueAndErrors)(t,"maximum",r.value,r.message,e));break;case"multipleOf":(0,Rt.setResponseValueAndErrors)(t,"multipleOf",r.value,r.message,e);break}return t}js.parseNumberDef=f_;var qt={},au;function p_(){if(au)return qt;au=1,Object.defineProperty(qt,"__esModule",{value:!0}),qt.parseObjectDef=qt.parseObjectDefX=void 0;const n=Le();function e(r,s){var i,a;Object.keys(r.shape()).reduce((u,c)=>{let l=r.shape()[c];const d=l.isOptional();d||(l=Object.assign({},l._def.innerSchema));const h=(0,n.parseDef)(l._def,Object.assign(Object.assign({},s),{currentPath:[...s.currentPath,"properties",c],propertyPath:[...s.currentPath,"properties",c]}));return h!==void 0&&(u.properties[c]=h,d||(u.required||(u.required=[]),u.required.push(c))),u},{type:"object",properties:{},additionalProperties:r.catchall._def.typeName==="ZodNever"?r.unknownKeys==="passthrough":(i=(0,n.parseDef)(r.catchall._def,Object.assign(Object.assign({},s),{currentPath:[...s.currentPath,"additionalProperties"]})))!==null&&i!==void 0?i:!0});const o=Object.assign(Object.assign({type:"object"},Object.entries(r.shape()).reduce((u,[c,l])=>{if(l===void 0||l._def===void 0)return u;const d=(0,n.parseDef)(l._def,Object.assign(Object.assign({},s),{currentPath:[...s.currentPath,"properties",c],propertyPath:[...s.currentPath,"properties",c]}));return d===void 0?u:{properties:Object.assign(Object.assign({},u.properties),{[c]:d}),required:l.isOptional()?u.required:[...u.required,c]}},{properties:{},required:[]})),{additionalProperties:r.catchall._def.typeName==="ZodNever"?r.unknownKeys==="passthrough":(a=(0,n.parseDef)(r.catchall._def,Object.assign(Object.assign({},s),{currentPath:[...s.currentPath,"additionalProperties"]})))!==null&&a!==void 0?a:!0});return o.required.length||delete o.required,o}qt.parseObjectDefX=e;function t(r,s){var i;const a=Object.assign(Object.assign({type:"object"},Object.entries(r.shape()).reduce((o,[u,c])=>{if(c===void 0||c._def===void 0)return o;const l=(0,n.parseDef)(c._def,Object.assign(Object.assign({},s),{currentPath:[...s.currentPath,"properties",u],propertyPath:[...s.currentPath,"properties",u]}));return l===void 0?o:{properties:Object.assign(Object.assign({},o.properties),{[u]:l}),required:c.isOptional()?o.required:[...o.required,u]}},{properties:{},required:[]})),{additionalProperties:r.catchall._def.typeName==="ZodNever"?r.unknownKeys==="passthrough":(i=(0,n.parseDef)(r.catchall._def,Object.assign(Object.assign({},s),{currentPath:[...s.currentPath,"additionalProperties"]})))!==null&&i!==void 0?i:!0});return a.required.length||delete a.required,a}return qt.parseObjectDef=t,qt}var Fr={},ou;function m_(){if(ou)return Fr;ou=1,Object.defineProperty(Fr,"__esModule",{value:!0}),Fr.parseOptionalDef=void 0;const n=Le(),e=(t,r)=>{var s;if(r.currentPath.toString()===((s=r.propertyPath)===null||s===void 0?void 0:s.toString()))return(0,n.parseDef)(t.innerType._def,r);const i=(0,n.parseDef)(t.innerType._def,Object.assign(Object.assign({},r),{currentPath:[...r.currentPath,"anyOf","1"]}));return i?{anyOf:[{not:{}},i]}:{}};return Fr.parseOptionalDef=e,Fr}var Br={},uu;function y_(){if(uu)return Br;uu=1,Object.defineProperty(Br,"__esModule",{value:!0}),Br.parsePipelineDef=void 0;const n=Le(),e=(t,r)=>{if(r.pipeStrategy==="input")return(0,n.parseDef)(t.in._def,r);const s=(0,n.parseDef)(t.in._def,Object.assign(Object.assign({},r),{currentPath:[...r.currentPath,"allOf","0"]})),i=(0,n.parseDef)(t.out._def,Object.assign(Object.assign({},r),{currentPath:[...r.currentPath,"allOf",s?"1":"0"]}));return{allOf:[s,i].filter(a=>a!==void 0)}};return Br.parsePipelineDef=e,Br}var Vr={},cu;function g_(){if(cu)return Vr;cu=1,Object.defineProperty(Vr,"__esModule",{value:!0}),Vr.parsePromiseDef=void 0;const n=Le();function e(t,r){return(0,n.parseDef)(t.type._def,r)}return Vr.parsePromiseDef=e,Vr}var qr={},Ta={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.parseStringDef=n.emojiPattern=n.ulidPattern=n.cuid2Pattern=n.cuidPattern=n.emailPattern=void 0;const e=dt;n.emailPattern='^(([^<>()[\\]\\\\.,;:\\s@\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\"]+)*)|(\\".+\\"))@((\\[(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\])|(\\[IPv6:(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))\\])|([A-Za-z0-9]([A-Za-z0-9-]*[A-Za-z0-9])*(\\.[A-Za-z]{2,})+))$',n.cuidPattern="^c[^\\s-]{8,}$",n.cuid2Pattern="^[a-z][a-z0-9]*$",n.ulidPattern="/[0-9A-HJKMNP-TV-Z]{26}/",n.emojiPattern="/^(p{Extended_Pictographic}|p{Emoji_Component})+$/u";function t(a,o){const u={type:"string"};if(a.checks)for(const c of a.checks)switch(c.kind){case"min":(0,e.setResponseValueAndErrors)(u,"minLength",typeof u.minLength=="number"?Math.max(u.minLength,c.value):c.value,c.message,o);break;case"max":(0,e.setResponseValueAndErrors)(u,"maxLength",typeof u.maxLength=="number"?Math.min(u.maxLength,c.value):c.value,c.message,o);break;case"email":switch(o.emailStrategy){case"format:email":s(u,"email",c.message,o);break;case"format:idn-email":s(u,"idn-email",c.message,o);break;case"pattern:zod":i(u,n.emailPattern,c.message,o);break}break;case"url":s(u,"uri",c.message,o);break;case"uuid":s(u,"uuid",c.message,o);break;case"regex":i(u,c.regex.source,c.message,o);break;case"cuid":i(u,n.cuidPattern,c.message,o);break;case"cuid2":i(u,n.cuid2Pattern,c.message,o);break;case"startsWith":i(u,"^"+r(c.value),c.message,o);break;case"endsWith":i(u,r(c.value)+"$",c.message,o);break;case"datetime":s(u,"date-time",c.message,o);break;case"length":(0,e.setResponseValueAndErrors)(u,"minLength",typeof u.minLength=="number"?Math.max(u.minLength,c.value):c.value,c.message,o),(0,e.setResponseValueAndErrors)(u,"maxLength",typeof u.maxLength=="number"?Math.min(u.maxLength,c.value):c.value,c.message,o);break;case"includes":{i(u,r(c.value),c.message,o);break}case"ip":{c.version!=="v6"&&s(u,"ipv4",c.message,o),c.version!=="v4"&&s(u,"ipv6",c.message,o);break}case"emoji":i(u,n.emojiPattern,c.message,o);break;case"ulid":{i(u,n.ulidPattern,c.message,o);break}}return u}n.parseStringDef=t;const r=a=>Array.from(a).map(o=>/[a-zA-Z0-9]/.test(o)?o:`\\${o}`).join(""),s=(a,o,u,c)=>{var l;a.format||!((l=a.anyOf)===null||l===void 0)&&l.some(d=>d.format)?(a.anyOf||(a.anyOf=[]),a.format&&(a.anyOf.push(Object.assign({format:a.format},a.errorMessage&&c.errorMessages&&{errorMessage:{format:a.errorMessage.format}})),delete a.format,a.errorMessage&&(delete a.errorMessage.format,Object.keys(a.errorMessage).length===0&&delete a.errorMessage)),a.anyOf.push(Object.assign({format:o},u&&c.errorMessages&&{errorMessage:{format:u}}))):(0,e.setResponseValueAndErrors)(a,"format",o,u,c)},i=(a,o,u,c)=>{var l;a.pattern||!((l=a.allOf)===null||l===void 0)&&l.some(d=>d.pattern)?(a.allOf||(a.allOf=[]),a.pattern&&(a.allOf.push(Object.assign({pattern:a.pattern},a.errorMessage&&c.errorMessages&&{errorMessage:{pattern:a.errorMessage.pattern}})),delete a.pattern,a.errorMessage&&(delete a.errorMessage.pattern,Object.keys(a.errorMessage).length===0&&delete a.errorMessage)),a.allOf.push(Object.assign({pattern:o},u&&c.errorMessages&&{errorMessage:{pattern:u}}))):(0,e.setResponseValueAndErrors)(a,"pattern",o,u,c)}})(Ta);var lu;function b_(){if(lu)return qr;lu=1,Object.defineProperty(qr,"__esModule",{value:!0}),qr.parseRecordDef=void 0;const n=Aa,e=Le(),t=Ta;function r(s,i){var a,o,u,c,l;if(i.target==="openApi3"&&((a=s.keyType)===null||a===void 0?void 0:a._def.typeName)===n.ZodFirstPartyTypeKind.ZodEnum)return{type:"object",required:s.keyType._def.values,properties:s.keyType._def.values.reduce((h,g)=>{var f;return Object.assign(Object.assign({},h),{[g]:(f=(0,e.parseDef)(s.valueType._def,Object.assign(Object.assign({},i),{currentPath:[...i.currentPath,"properties",g]})))!==null&&f!==void 0?f:{}})},{}),additionalProperties:!1};const d={type:"object",additionalProperties:(o=(0,e.parseDef)(s.valueType._def,Object.assign(Object.assign({},i),{currentPath:[...i.currentPath,"additionalProperties"]})))!==null&&o!==void 0?o:{}};if(i.target==="openApi3")return d;if(((u=s.keyType)===null||u===void 0?void 0:u._def.typeName)===n.ZodFirstPartyTypeKind.ZodString&&(!((c=s.keyType._def.checks)===null||c===void 0)&&c.length)){const h=Object.entries((0,t.parseStringDef)(s.keyType._def,i)).reduce((g,[f,b])=>f==="type"?g:Object.assign(Object.assign({},g),{[f]:b}),{});return Object.assign(Object.assign({},d),{propertyNames:h})}else if(((l=s.keyType)===null||l===void 0?void 0:l._def.typeName)===n.ZodFirstPartyTypeKind.ZodEnum)return Object.assign(Object.assign({},d),{propertyNames:{enum:s.keyType._def.values}});return d}return qr.parseRecordDef=r,qr}var zr={},du;function __(){if(du)return zr;du=1,Object.defineProperty(zr,"__esModule",{value:!0}),zr.parseSetDef=void 0;const n=dt,e=Le();function t(r,s){const a={type:"array",uniqueItems:!0,items:(0,e.parseDef)(r.valueType._def,Object.assign(Object.assign({},s),{currentPath:[...s.currentPath,"items"]}))};return r.minSize&&(0,n.setResponseValueAndErrors)(a,"minItems",r.minSize.value,r.minSize.message,s),r.maxSize&&(0,n.setResponseValueAndErrors)(a,"maxItems",r.maxSize.value,r.maxSize.message,s),a}return zr.parseSetDef=t,zr}var Hr={},hu;function v_(){if(hu)return Hr;hu=1,Object.defineProperty(Hr,"__esModule",{value:!0}),Hr.parseTupleDef=void 0;const n=Le();function e(t,r){return t.rest?{type:"array",minItems:t.items.length,items:t.items.map((s,i)=>(0,n.parseDef)(s._def,Object.assign(Object.assign({},r),{currentPath:[...r.currentPath,"items",`${i}`]}))).reduce((s,i)=>i===void 0?s:[...s,i],[]),additionalItems:(0,n.parseDef)(t.rest._def,Object.assign(Object.assign({},r),{currentPath:[...r.currentPath,"additionalItems"]}))}:{type:"array",minItems:t.items.length,maxItems:t.items.length,items:t.items.map((s,i)=>(0,n.parseDef)(s._def,Object.assign(Object.assign({},r),{currentPath:[...r.currentPath,"items",`${i}`]}))).reduce((s,i)=>i===void 0?s:[...s,i],[])}}return Hr.parseTupleDef=e,Hr}var ks={};Object.defineProperty(ks,"__esModule",{value:!0});ks.parseUndefinedDef=void 0;function w_(){return{not:{}}}ks.parseUndefinedDef=w_;var Cs={};Object.defineProperty(Cs,"__esModule",{value:!0});Cs.parseUnknownDef=void 0;function O_(){return{}}Cs.parseUnknownDef=O_;var fu;function Le(){if(fu)return Cr;fu=1,Object.defineProperty(Cr,"__esModule",{value:!0}),Cr.parseDef=void 0;const n=Aa,e=vs,t=Yb(),r=ws,s=Os,i=Xb(),a=e_(),o=Es,u=n_(),c=s_(),l=As,d=a_(),h=Ts,g=u_(),f=Ps,b=xs,y=Ss,T=h_(),k=js,S=p_(),x=m_(),$=y_(),A=g_(),C=b_(),_=__(),w=Ta,m=v_(),E=ks,j=$l(),H=Cs;function O(L,R,F=!1){const ge=R.seen.get(L);if(ge&&!F){const ye=I(ge,R);if(ye!==void 0)return ye}const ve={def:L,path:R.currentPath,jsonSchema:void 0};R.seen.set(L,ve);const de=J(L,L.typeName,R);return de&&G(L,R,de),ve.jsonSchema=de,de}Cr.parseDef=O;const I=(L,R)=>{switch(R.$refStrategy){case"root":return{$ref:L.path.length===0?"":L.path.length===1?`${L.path[0]}/`:L.path.join("/")};case"relative":return{$ref:D(R.currentPath,L.path)};case"none":return L.path.length<R.currentPath.length&&L.path.every((F,ge)=>R.currentPath[ge]===F)?(console.warn(`Recursive reference detected at ${R.currentPath.join("/")}! Defaulting to any`),{}):void 0;case"seen":return L.path.length<R.currentPath.length&&L.path.every((F,ge)=>R.currentPath[ge]===F)?(console.warn(`Recursive reference detected at ${R.currentPath.join("/")}! Defaulting to any`),{}):L.jsonSchema}},D=(L,R)=>{let F=0;for(;F<L.length&&F<R.length&&L[F]===R[F];F++);return[(L.length-F).toString(),...R.slice(F)].join("/")},J=(L,R,F)=>{switch(R){case n.ZodFirstPartyTypeKind.ZodString:return(0,w.parseStringDef)(L,F);case n.ZodFirstPartyTypeKind.ZodNumber:return(0,k.parseNumberDef)(L,F);case n.ZodFirstPartyTypeKind.ZodObject:return(0,S.parseObjectDef)(L,F);case n.ZodFirstPartyTypeKind.ZodBigInt:return(0,r.parseBigintDef)(L,F);case n.ZodFirstPartyTypeKind.ZodBoolean:return(0,s.parseBooleanDef)();case n.ZodFirstPartyTypeKind.ZodDate:return(0,o.parseDateDef)(L,F);case n.ZodFirstPartyTypeKind.ZodUndefined:return(0,E.parseUndefinedDef)();case n.ZodFirstPartyTypeKind.ZodNull:return(0,y.parseNullDef)(F);case n.ZodFirstPartyTypeKind.ZodArray:return(0,t.parseArrayDef)(L,F);case n.ZodFirstPartyTypeKind.ZodUnion:case n.ZodFirstPartyTypeKind.ZodDiscriminatedUnion:return(0,j.parseUnionDef)(L,F);case n.ZodFirstPartyTypeKind.ZodIntersection:return(0,d.parseIntersectionDef)(L,F);case n.ZodFirstPartyTypeKind.ZodTuple:return(0,m.parseTupleDef)(L,F);case n.ZodFirstPartyTypeKind.ZodRecord:return(0,C.parseRecordDef)(L,F);case n.ZodFirstPartyTypeKind.ZodLiteral:return(0,h.parseLiteralDef)(L,F);case n.ZodFirstPartyTypeKind.ZodEnum:return(0,l.parseEnumDef)(L);case n.ZodFirstPartyTypeKind.ZodNativeEnum:return(0,f.parseNativeEnumDef)(L);case n.ZodFirstPartyTypeKind.ZodNullable:return(0,T.parseNullableDef)(L,F);case n.ZodFirstPartyTypeKind.ZodOptional:return(0,x.parseOptionalDef)(L,F);case n.ZodFirstPartyTypeKind.ZodMap:return(0,g.parseMapDef)(L,F);case n.ZodFirstPartyTypeKind.ZodSet:return(0,_.parseSetDef)(L,F);case n.ZodFirstPartyTypeKind.ZodLazy:return O(L.getter()._def,F);case n.ZodFirstPartyTypeKind.ZodPromise:return(0,A.parsePromiseDef)(L,F);case n.ZodFirstPartyTypeKind.ZodNaN:case n.ZodFirstPartyTypeKind.ZodNever:return(0,b.parseNeverDef)();case n.ZodFirstPartyTypeKind.ZodEffects:return(0,c.parseEffectsDef)(L,F);case n.ZodFirstPartyTypeKind.ZodAny:return(0,e.parseAnyDef)();case n.ZodFirstPartyTypeKind.ZodUnknown:return(0,H.parseUnknownDef)();case n.ZodFirstPartyTypeKind.ZodDefault:return(0,u.parseDefaultDef)(L,F);case n.ZodFirstPartyTypeKind.ZodBranded:return(0,i.parseBrandedDef)(L,F);case n.ZodFirstPartyTypeKind.ZodCatch:return(0,a.parseCatchDef)(L,F);case n.ZodFirstPartyTypeKind.ZodPipeline:return(0,$.parsePipelineDef)(L,F);case n.ZodFirstPartyTypeKind.ZodFunction:case n.ZodFirstPartyTypeKind.ZodVoid:case n.ZodFirstPartyTypeKind.ZodSymbol:return;default:return(ge=>{})()}},G=(L,R,F)=>(L.description&&(F.description=L.description,R.markdownDescription&&(F.markdownDescription=L.description)),F);return Cr}var Is={},Ul={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.getDefaultOptions=n.defaultOptions=void 0,n.defaultOptions={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"string",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,emailStrategy:"format:email"};const e=t=>typeof t=="string"?Object.assign(Object.assign({},n.defaultOptions),{name:t}):Object.assign(Object.assign({},n.defaultOptions),t);n.getDefaultOptions=e})(Ul);Object.defineProperty(Is,"__esModule",{value:!0});Is.getRefs=void 0;const E_=Ul,A_=n=>{const e=(0,E_.getDefaultOptions)(n),t=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return Object.assign(Object.assign({},e),{currentPath:t,propertyPath:void 0,seen:new Map(Object.entries(e.definitions).map(([r,s])=>[s._def,{def:s._def,path:[...e.basePath,e.definitionPath,r],jsonSchema:void 0}]))})};Is.getRefs=A_;Object.defineProperty(_s,"__esModule",{value:!0});_s.zodToJsonSchema=void 0;const pu=Le(),T_=Is,P_=(n,e)=>{var t;const r=(0,T_.getRefs)(e),s=typeof e=="object"&&e.definitions?Object.entries(e.definitions).reduce((u,[c,l])=>{var d;return Object.assign(Object.assign({},u),{[c]:(d=(0,pu.parseDef)(l._def,Object.assign(Object.assign({},r),{currentPath:[...r.basePath,r.definitionPath,c]}),!0))!==null&&d!==void 0?d:{}})},{}):void 0,i=typeof e=="string"?e:e==null?void 0:e.name,a=(t=(0,pu.parseDef)(n._def,i===void 0?r:Object.assign(Object.assign({},r),{currentPath:[...r.basePath,r.definitionPath,i]}),!1))!==null&&t!==void 0?t:{},o=i===void 0?s?Object.assign(Object.assign({},a),{[r.definitionPath]:s}):a:{$ref:[...r.$refStrategy==="relative"?[]:r.basePath,r.definitionPath,i].join("/"),[r.definitionPath]:Object.assign(Object.assign({},s),{[i]:a})};return r.target==="jsonSchema7"?o.$schema="http://json-schema.org/draft-07/schema#":r.target==="jsonSchema2019-09"&&(o.$schema="https://json-schema.org/draft/2019-09/schema#"),o};_s.zodToJsonSchema=P_;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.zodToJsonSchema=void 0;const e=_s;Object.defineProperty(n,"zodToJsonSchema",{enumerable:!0,get:function(){return e.zodToJsonSchema}}),n.default=e.zodToJsonSchema})(Zb);/*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT */function Ml(n){return typeof n>"u"||n===null}function x_(n){return typeof n=="object"&&n!==null}function S_(n){return Array.isArray(n)?n:Ml(n)?[]:[n]}function j_(n,e){var t,r,s,i;if(e)for(i=Object.keys(e),t=0,r=i.length;t<r;t+=1)s=i[t],n[s]=e[s];return n}function k_(n,e){var t="",r;for(r=0;r<e;r+=1)t+=n;return t}function C_(n){return n===0&&Number.NEGATIVE_INFINITY===1/n}var I_=Ml,R_=x_,D_=S_,N_=k_,L_=C_,$_=j_,Pa={isNothing:I_,isObject:R_,toArray:D_,repeat:N_,isNegativeZero:L_,extend:$_};function Fl(n,e){var t="",r=n.reason||"(unknown reason)";return n.mark?(n.mark.name&&(t+='in "'+n.mark.name+'" '),t+="("+(n.mark.line+1)+":"+(n.mark.column+1)+")",!e&&n.mark.snippet&&(t+=`

`+n.mark.snippet),r+" "+t):r}function ln(n,e){Error.call(this),this.name="YAMLException",this.reason=n,this.mark=e,this.message=Fl(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}ln.prototype=Object.create(Error.prototype);ln.prototype.constructor=ln;ln.prototype.toString=function(e){return this.name+": "+Fl(this,e)};var Jt=ln,U_=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],M_=["scalar","sequence","mapping"];function F_(n){var e={};return n!==null&&Object.keys(n).forEach(function(t){n[t].forEach(function(r){e[String(r)]=t})}),e}function B_(n,e){if(e=e||{},Object.keys(e).forEach(function(t){if(U_.indexOf(t)===-1)throw new Jt('Unknown option "'+t+'" is met in definition of "'+n+'" YAML type.')}),this.options=e,this.tag=n,this.kind=e.kind||null,this.resolve=e.resolve||function(){return!0},this.construct=e.construct||function(t){return t},this.instanceOf=e.instanceOf||null,this.predicate=e.predicate||null,this.represent=e.represent||null,this.representName=e.representName||null,this.defaultStyle=e.defaultStyle||null,this.multi=e.multi||!1,this.styleAliases=F_(e.styleAliases||null),M_.indexOf(this.kind)===-1)throw new Jt('Unknown kind "'+this.kind+'" is specified for "'+n+'" YAML type.')}var Me=B_;function mu(n,e){var t=[];return n[e].forEach(function(r){var s=t.length;t.forEach(function(i,a){i.tag===r.tag&&i.kind===r.kind&&i.multi===r.multi&&(s=a)}),t[s]=r}),t}function V_(){var n={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},e,t;function r(s){s.multi?(n.multi[s.kind].push(s),n.multi.fallback.push(s)):n[s.kind][s.tag]=n.fallback[s.tag]=s}for(e=0,t=arguments.length;e<t;e+=1)arguments[e].forEach(r);return n}function Li(n){return this.extend(n)}Li.prototype.extend=function(e){var t=[],r=[];if(e instanceof Me)r.push(e);else if(Array.isArray(e))r=r.concat(e);else if(e&&(Array.isArray(e.implicit)||Array.isArray(e.explicit)))e.implicit&&(t=t.concat(e.implicit)),e.explicit&&(r=r.concat(e.explicit));else throw new Jt("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");t.forEach(function(i){if(!(i instanceof Me))throw new Jt("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(i.loadKind&&i.loadKind!=="scalar")throw new Jt("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(i.multi)throw new Jt("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),r.forEach(function(i){if(!(i instanceof Me))throw new Jt("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var s=Object.create(Li.prototype);return s.implicit=(this.implicit||[]).concat(t),s.explicit=(this.explicit||[]).concat(r),s.compiledImplicit=mu(s,"implicit"),s.compiledExplicit=mu(s,"explicit"),s.compiledTypeMap=V_(s.compiledImplicit,s.compiledExplicit),s};var q_=Li,z_=new Me("tag:yaml.org,2002:str",{kind:"scalar",construct:function(n){return n!==null?n:""}}),H_=new Me("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(n){return n!==null?n:[]}}),K_=new Me("tag:yaml.org,2002:map",{kind:"mapping",construct:function(n){return n!==null?n:{}}}),Z_=new q_({explicit:[z_,H_,K_]});function J_(n){if(n===null)return!0;var e=n.length;return e===1&&n==="~"||e===4&&(n==="null"||n==="Null"||n==="NULL")}function G_(){return null}function Y_(n){return n===null}var W_=new Me("tag:yaml.org,2002:null",{kind:"scalar",resolve:J_,construct:G_,predicate:Y_,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});function Q_(n){if(n===null)return!1;var e=n.length;return e===4&&(n==="true"||n==="True"||n==="TRUE")||e===5&&(n==="false"||n==="False"||n==="FALSE")}function X_(n){return n==="true"||n==="True"||n==="TRUE"}function ev(n){return Object.prototype.toString.call(n)==="[object Boolean]"}var tv=new Me("tag:yaml.org,2002:bool",{kind:"scalar",resolve:Q_,construct:X_,predicate:ev,represent:{lowercase:function(n){return n?"true":"false"},uppercase:function(n){return n?"TRUE":"FALSE"},camelcase:function(n){return n?"True":"False"}},defaultStyle:"lowercase"});function rv(n){return 48<=n&&n<=57||65<=n&&n<=70||97<=n&&n<=102}function nv(n){return 48<=n&&n<=55}function sv(n){return 48<=n&&n<=57}function iv(n){if(n===null)return!1;var e=n.length,t=0,r=!1,s;if(!e)return!1;if(s=n[t],(s==="-"||s==="+")&&(s=n[++t]),s==="0"){if(t+1===e)return!0;if(s=n[++t],s==="b"){for(t++;t<e;t++)if(s=n[t],s!=="_"){if(s!=="0"&&s!=="1")return!1;r=!0}return r&&s!=="_"}if(s==="x"){for(t++;t<e;t++)if(s=n[t],s!=="_"){if(!rv(n.charCodeAt(t)))return!1;r=!0}return r&&s!=="_"}if(s==="o"){for(t++;t<e;t++)if(s=n[t],s!=="_"){if(!nv(n.charCodeAt(t)))return!1;r=!0}return r&&s!=="_"}}if(s==="_")return!1;for(;t<e;t++)if(s=n[t],s!=="_"){if(!sv(n.charCodeAt(t)))return!1;r=!0}return!(!r||s==="_")}function av(n){var e=n,t=1,r;if(e.indexOf("_")!==-1&&(e=e.replace(/_/g,"")),r=e[0],(r==="-"||r==="+")&&(r==="-"&&(t=-1),e=e.slice(1),r=e[0]),e==="0")return 0;if(r==="0"){if(e[1]==="b")return t*parseInt(e.slice(2),2);if(e[1]==="x")return t*parseInt(e.slice(2),16);if(e[1]==="o")return t*parseInt(e.slice(2),8)}return t*parseInt(e,10)}function ov(n){return Object.prototype.toString.call(n)==="[object Number]"&&n%1===0&&!Pa.isNegativeZero(n)}var uv=new Me("tag:yaml.org,2002:int",{kind:"scalar",resolve:iv,construct:av,predicate:ov,represent:{binary:function(n){return n>=0?"0b"+n.toString(2):"-0b"+n.toString(2).slice(1)},octal:function(n){return n>=0?"0o"+n.toString(8):"-0o"+n.toString(8).slice(1)},decimal:function(n){return n.toString(10)},hexadecimal:function(n){return n>=0?"0x"+n.toString(16).toUpperCase():"-0x"+n.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),cv=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function lv(n){return!(n===null||!cv.test(n)||n[n.length-1]==="_")}function dv(n){var e,t;return e=n.replace(/_/g,"").toLowerCase(),t=e[0]==="-"?-1:1,"+-".indexOf(e[0])>=0&&(e=e.slice(1)),e===".inf"?t===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:e===".nan"?NaN:t*parseFloat(e,10)}var hv=/^[-+]?[0-9]+e/;function fv(n,e){var t;if(isNaN(n))switch(e){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===n)switch(e){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===n)switch(e){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(Pa.isNegativeZero(n))return"-0.0";return t=n.toString(10),hv.test(t)?t.replace("e",".e"):t}function pv(n){return Object.prototype.toString.call(n)==="[object Number]"&&(n%1!==0||Pa.isNegativeZero(n))}var mv=new Me("tag:yaml.org,2002:float",{kind:"scalar",resolve:lv,construct:dv,predicate:pv,represent:fv,defaultStyle:"lowercase"}),yv=Z_.extend({implicit:[W_,tv,uv,mv]}),gv=yv,Bl=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),Vl=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function bv(n){return n===null?!1:Bl.exec(n)!==null||Vl.exec(n)!==null}function _v(n){var e,t,r,s,i,a,o,u=0,c=null,l,d,h;if(e=Bl.exec(n),e===null&&(e=Vl.exec(n)),e===null)throw new Error("Date resolve error");if(t=+e[1],r=+e[2]-1,s=+e[3],!e[4])return new Date(Date.UTC(t,r,s));if(i=+e[4],a=+e[5],o=+e[6],e[7]){for(u=e[7].slice(0,3);u.length<3;)u+="0";u=+u}return e[9]&&(l=+e[10],d=+(e[11]||0),c=(l*60+d)*6e4,e[9]==="-"&&(c=-c)),h=new Date(Date.UTC(t,r,s,i,a,o,u)),c&&h.setTime(h.getTime()-c),h}function vv(n){return n.toISOString()}var wv=new Me("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:bv,construct:_v,instanceOf:Date,represent:vv});function Ov(n){return n==="<<"||n===null}var Ev=new Me("tag:yaml.org,2002:merge",{kind:"scalar",resolve:Ov}),xa=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function Av(n){if(n===null)return!1;var e,t,r=0,s=n.length,i=xa;for(t=0;t<s;t++)if(e=i.indexOf(n.charAt(t)),!(e>64)){if(e<0)return!1;r+=6}return r%8===0}function Tv(n){var e,t,r=n.replace(/[\r\n=]/g,""),s=r.length,i=xa,a=0,o=[];for(e=0;e<s;e++)e%4===0&&e&&(o.push(a>>16&255),o.push(a>>8&255),o.push(a&255)),a=a<<6|i.indexOf(r.charAt(e));return t=s%4*6,t===0?(o.push(a>>16&255),o.push(a>>8&255),o.push(a&255)):t===18?(o.push(a>>10&255),o.push(a>>2&255)):t===12&&o.push(a>>4&255),new Uint8Array(o)}function Pv(n){var e="",t=0,r,s,i=n.length,a=xa;for(r=0;r<i;r++)r%3===0&&r&&(e+=a[t>>18&63],e+=a[t>>12&63],e+=a[t>>6&63],e+=a[t&63]),t=(t<<8)+n[r];return s=i%3,s===0?(e+=a[t>>18&63],e+=a[t>>12&63],e+=a[t>>6&63],e+=a[t&63]):s===2?(e+=a[t>>10&63],e+=a[t>>4&63],e+=a[t<<2&63],e+=a[64]):s===1&&(e+=a[t>>2&63],e+=a[t<<4&63],e+=a[64],e+=a[64]),e}function xv(n){return Object.prototype.toString.call(n)==="[object Uint8Array]"}var Sv=new Me("tag:yaml.org,2002:binary",{kind:"scalar",resolve:Av,construct:Tv,predicate:xv,represent:Pv}),jv=Object.prototype.hasOwnProperty,kv=Object.prototype.toString;function Cv(n){if(n===null)return!0;var e=[],t,r,s,i,a,o=n;for(t=0,r=o.length;t<r;t+=1){if(s=o[t],a=!1,kv.call(s)!=="[object Object]")return!1;for(i in s)if(jv.call(s,i))if(!a)a=!0;else return!1;if(!a)return!1;if(e.indexOf(i)===-1)e.push(i);else return!1}return!0}function Iv(n){return n!==null?n:[]}var Rv=new Me("tag:yaml.org,2002:omap",{kind:"sequence",resolve:Cv,construct:Iv}),Dv=Object.prototype.toString;function Nv(n){if(n===null)return!0;var e,t,r,s,i,a=n;for(i=new Array(a.length),e=0,t=a.length;e<t;e+=1){if(r=a[e],Dv.call(r)!=="[object Object]"||(s=Object.keys(r),s.length!==1))return!1;i[e]=[s[0],r[s[0]]]}return!0}function Lv(n){if(n===null)return[];var e,t,r,s,i,a=n;for(i=new Array(a.length),e=0,t=a.length;e<t;e+=1)r=a[e],s=Object.keys(r),i[e]=[s[0],r[s[0]]];return i}var $v=new Me("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:Nv,construct:Lv}),Uv=Object.prototype.hasOwnProperty;function Mv(n){if(n===null)return!0;var e,t=n;for(e in t)if(Uv.call(t,e)&&t[e]!==null)return!1;return!0}function Fv(n){return n!==null?n:{}}var Bv=new Me("tag:yaml.org,2002:set",{kind:"mapping",resolve:Mv,construct:Fv});gv.extend({implicit:[wv,Ev],explicit:[Sv,Rv,$v,Bv]});function yu(n){return n===48?"\0":n===97?"\x07":n===98?"\b":n===116||n===9?"	":n===110?`
`:n===118?"\v":n===102?"\f":n===114?"\r":n===101?"\x1B":n===32?" ":n===34?'"':n===47?"/":n===92?"\\":n===78?"":n===95?"":n===76?"\u2028":n===80?"\u2029":""}var Vv=new Array(256),qv=new Array(256);for(var or=0;or<256;or++)Vv[or]=yu(or)?1:0,qv[or]=yu(or);function Rn(n){throw new Error('Could not dynamically require "'+n+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ql={exports:{}};(function(n,e){(function(t){n.exports=t()})(function(){return function t(r,s,i){function a(c,l){if(!s[c]){if(!r[c]){var d=typeof Rn=="function"&&Rn;if(!l&&d)return d(c,!0);if(o)return o(c,!0);throw new Error("Cannot find module '"+c+"'")}l=s[c]={exports:{}},r[c][0].call(l.exports,function(h){var g=r[c][1][h];return a(g||h)},l,l.exports,t,r,s,i)}return s[c].exports}for(var o=typeof Rn=="function"&&Rn,u=0;u<i.length;u++)a(i[u]);return a}({1:[function(t,r,s){(function(i,a,o,u,c,l,d,h,g){var f=t("crypto");function b(A,C){C=k(A,C);var _;return(_=C.algorithm!=="passthrough"?f.createHash(C.algorithm):new $).write===void 0&&(_.write=_.update,_.end=_.update),x(C,_).dispatch(A),_.update||_.end(""),_.digest?_.digest(C.encoding==="buffer"?void 0:C.encoding):(A=_.read(),C.encoding!=="buffer"?A.toString(C.encoding):A)}(s=r.exports=b).sha1=function(A){return b(A)},s.keys=function(A){return b(A,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})},s.MD5=function(A){return b(A,{algorithm:"md5",encoding:"hex"})},s.keysMD5=function(A){return b(A,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var y=f.getHashes?f.getHashes().slice():["sha1","md5"],T=(y.push("passthrough"),["buffer","hex","binary","base64"]);function k(A,C){var _={};if(_.algorithm=(C=C||{}).algorithm||"sha1",_.encoding=C.encoding||"hex",_.excludeValues=!!C.excludeValues,_.algorithm=_.algorithm.toLowerCase(),_.encoding=_.encoding.toLowerCase(),_.ignoreUnknown=C.ignoreUnknown===!0,_.respectType=C.respectType!==!1,_.respectFunctionNames=C.respectFunctionNames!==!1,_.respectFunctionProperties=C.respectFunctionProperties!==!1,_.unorderedArrays=C.unorderedArrays===!0,_.unorderedSets=C.unorderedSets!==!1,_.unorderedObjects=C.unorderedObjects!==!1,_.replacer=C.replacer||void 0,_.excludeKeys=C.excludeKeys||void 0,A===void 0)throw new Error("Object argument required.");for(var w=0;w<y.length;++w)y[w].toLowerCase()===_.algorithm.toLowerCase()&&(_.algorithm=y[w]);if(y.indexOf(_.algorithm)===-1)throw new Error('Algorithm "'+_.algorithm+'"  not supported. supported values: '+y.join(", "));if(T.indexOf(_.encoding)===-1&&_.algorithm!=="passthrough")throw new Error('Encoding "'+_.encoding+'"  not supported. supported values: '+T.join(", "));return _}function S(A){if(typeof A=="function")return/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(A))!=null}function x(A,C,_){_=_||[];function w(m){return C.update?C.update(m,"utf8"):C.write(m,"utf8")}return{dispatch:function(m){return this["_"+((m=A.replacer?A.replacer(m):m)===null?"null":typeof m)](m)},_object:function(m){var E,j=Object.prototype.toString.call(m),H=/\[object (.*)\]/i.exec(j);if(H=(H=H?H[1]:"unknown:["+j+"]").toLowerCase(),0<=(j=_.indexOf(m)))return this.dispatch("[CIRCULAR:"+j+"]");if(_.push(m),o!==void 0&&o.isBuffer&&o.isBuffer(m))return w("buffer:"),w(m);if(H==="object"||H==="function"||H==="asyncfunction")return j=Object.keys(m),A.unorderedObjects&&(j=j.sort()),A.respectType===!1||S(m)||j.splice(0,0,"prototype","__proto__","constructor"),A.excludeKeys&&(j=j.filter(function(O){return!A.excludeKeys(O)})),w("object:"+j.length+":"),E=this,j.forEach(function(O){E.dispatch(O),w(":"),A.excludeValues||E.dispatch(m[O]),w(",")});if(!this["_"+H]){if(A.ignoreUnknown)return w("["+H+"]");throw new Error('Unknown object type "'+H+'"')}this["_"+H](m)},_array:function(m,O){O=O!==void 0?O:A.unorderedArrays!==!1;var j=this;if(w("array:"+m.length+":"),!O||m.length<=1)return m.forEach(function(I){return j.dispatch(I)});var H=[],O=m.map(function(I){var D=new $,J=_.slice();return x(A,D,J).dispatch(I),H=H.concat(J.slice(_.length)),D.read().toString()});return _=_.concat(H),O.sort(),this._array(O,!1)},_date:function(m){return w("date:"+m.toJSON())},_symbol:function(m){return w("symbol:"+m.toString())},_error:function(m){return w("error:"+m.toString())},_boolean:function(m){return w("bool:"+m.toString())},_string:function(m){w("string:"+m.length+":"),w(m.toString())},_function:function(m){w("fn:"),S(m)?this.dispatch("[native]"):this.dispatch(m.toString()),A.respectFunctionNames!==!1&&this.dispatch("function-name:"+String(m.name)),A.respectFunctionProperties&&this._object(m)},_number:function(m){return w("number:"+m.toString())},_xml:function(m){return w("xml:"+m.toString())},_null:function(){return w("Null")},_undefined:function(){return w("Undefined")},_regexp:function(m){return w("regex:"+m.toString())},_uint8array:function(m){return w("uint8array:"),this.dispatch(Array.prototype.slice.call(m))},_uint8clampedarray:function(m){return w("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(m))},_int8array:function(m){return w("int8array:"),this.dispatch(Array.prototype.slice.call(m))},_uint16array:function(m){return w("uint16array:"),this.dispatch(Array.prototype.slice.call(m))},_int16array:function(m){return w("int16array:"),this.dispatch(Array.prototype.slice.call(m))},_uint32array:function(m){return w("uint32array:"),this.dispatch(Array.prototype.slice.call(m))},_int32array:function(m){return w("int32array:"),this.dispatch(Array.prototype.slice.call(m))},_float32array:function(m){return w("float32array:"),this.dispatch(Array.prototype.slice.call(m))},_float64array:function(m){return w("float64array:"),this.dispatch(Array.prototype.slice.call(m))},_arraybuffer:function(m){return w("arraybuffer:"),this.dispatch(new Uint8Array(m))},_url:function(m){return w("url:"+m.toString())},_map:function(m){return w("map:"),m=Array.from(m),this._array(m,A.unorderedSets!==!1)},_set:function(m){return w("set:"),m=Array.from(m),this._array(m,A.unorderedSets!==!1)},_file:function(m){return w("file:"),this.dispatch([m.name,m.size,m.type,m.lastModfied])},_blob:function(){if(A.ignoreUnknown)return w("[blob]");throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){return w("domwindow")},_bigint:function(m){return w("bigint:"+m.toString())},_process:function(){return w("process")},_timer:function(){return w("timer")},_pipe:function(){return w("pipe")},_tcp:function(){return w("tcp")},_udp:function(){return w("udp")},_tty:function(){return w("tty")},_statwatcher:function(){return w("statwatcher")},_securecontext:function(){return w("securecontext")},_connection:function(){return w("connection")},_zlib:function(){return w("zlib")},_context:function(){return w("context")},_nodescript:function(){return w("nodescript")},_httpparser:function(){return w("httpparser")},_dataview:function(){return w("dataview")},_signal:function(){return w("signal")},_fsevent:function(){return w("fsevent")},_tlswrap:function(){return w("tlswrap")}}}function $(){return{buf:"",write:function(A){this.buf+=A},end:function(A){this.buf+=A},read:function(){return this.buf}}}s.writeToStream=function(A,C,_){return _===void 0&&(_=C,C={}),x(C=k(A,C),_).dispatch(A)}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/fake_9a5aa49d.js","/")},{buffer:3,crypto:5,lYpoI2:11}],2:[function(t,r,s){(function(i,a,o,u,c,l,d,h,g){(function(f){var b=typeof Uint8Array<"u"?Uint8Array:Array,y="+".charCodeAt(0),T="/".charCodeAt(0),k="0".charCodeAt(0),S="a".charCodeAt(0),x="A".charCodeAt(0),$="-".charCodeAt(0),A="_".charCodeAt(0);function C(_){return _=_.charCodeAt(0),_===y||_===$?62:_===T||_===A?63:_<k?-1:_<k+10?_-k+26+26:_<x+26?_-x:_<S+26?_-S+26:void 0}f.toByteArray=function(_){var w,m;if(0<_.length%4)throw new Error("Invalid string. Length must be a multiple of 4");var E=_.length,E=_.charAt(E-2)==="="?2:_.charAt(E-1)==="="?1:0,j=new b(3*_.length/4-E),H=0<E?_.length-4:_.length,O=0;function I(D){j[O++]=D}for(w=0;w<H;w+=4,0)I((16711680&(m=C(_.charAt(w))<<18|C(_.charAt(w+1))<<12|C(_.charAt(w+2))<<6|C(_.charAt(w+3))))>>16),I((65280&m)>>8),I(255&m);return E==2?I(255&(m=C(_.charAt(w))<<2|C(_.charAt(w+1))>>4)):E==1&&(I((m=C(_.charAt(w))<<10|C(_.charAt(w+1))<<4|C(_.charAt(w+2))>>2)>>8&255),I(255&m)),j},f.fromByteArray=function(_){var w,m,E,j,H=_.length%3,O="";function I(D){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(D)}for(w=0,E=_.length-H;w<E;w+=3)m=(_[w]<<16)+(_[w+1]<<8)+_[w+2],O+=I((j=m)>>18&63)+I(j>>12&63)+I(j>>6&63)+I(63&j);switch(H){case 1:O=(O+=I((m=_[_.length-1])>>2))+I(m<<4&63)+"==";break;case 2:O=(O=(O+=I((m=(_[_.length-2]<<8)+_[_.length-1])>>10))+I(m>>4&63))+I(m<<2&63)+"="}return O}})(s===void 0?this.base64js={}:s)}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js","/node_modules/gulp-browserify/node_modules/base64-js/lib")},{buffer:3,lYpoI2:11}],3:[function(t,r,s){(function(i,a,y,u,c,l,d,h,g){var f=t("base64-js"),b=t("ieee754");function y(p,v,P){if(!(this instanceof y))return new y(p,v,P);var M,U,q,ae,Oe=typeof p;if(v==="base64"&&Oe=="string")for(p=(ae=p).trim?ae.trim():ae.replace(/^\s+|\s+$/g,"");p.length%4!=0;)p+="=";if(Oe=="number")M=G(p);else if(Oe=="string")M=y.byteLength(p,v);else{if(Oe!="object")throw new Error("First argument needs to be a number, array or string.");M=G(p.length)}if(y._useTypedArrays?U=y._augment(new Uint8Array(M)):((U=this).length=M,U._isBuffer=!0),y._useTypedArrays&&typeof p.byteLength=="number")U._set(p);else if(L(ae=p)||y.isBuffer(ae)||ae&&typeof ae=="object"&&typeof ae.length=="number")for(q=0;q<M;q++)y.isBuffer(p)?U[q]=p.readUInt8(q):U[q]=p[q];else if(Oe=="string")U.write(p,0,v);else if(Oe=="number"&&!y._useTypedArrays&&!P)for(q=0;q<M;q++)U[q]=0;return U}function T(p,v,P,M){return y._charsWritten=ve(function(U){for(var q=[],ae=0;ae<U.length;ae++)q.push(255&U.charCodeAt(ae));return q}(v),p,P,M)}function k(p,v,P,M){return y._charsWritten=ve(function(U){for(var q,ae,Oe=[],je=0;je<U.length;je++)ae=U.charCodeAt(je),q=ae>>8,ae=ae%256,Oe.push(ae),Oe.push(q);return Oe}(v),p,P,M)}function S(p,v,P){var M="";P=Math.min(p.length,P);for(var U=v;U<P;U++)M+=String.fromCharCode(p[U]);return M}function x(p,v,P,q){q||(B(typeof P=="boolean","missing or invalid endian"),B(v!=null,"missing offset"),B(v+1<p.length,"Trying to read beyond buffer length"));var U,q=p.length;if(!(q<=v))return P?(U=p[v],v+1<q&&(U|=p[v+1]<<8)):(U=p[v]<<8,v+1<q&&(U|=p[v+1])),U}function $(p,v,P,q){q||(B(typeof P=="boolean","missing or invalid endian"),B(v!=null,"missing offset"),B(v+3<p.length,"Trying to read beyond buffer length"));var U,q=p.length;if(!(q<=v))return P?(v+2<q&&(U=p[v+2]<<16),v+1<q&&(U|=p[v+1]<<8),U|=p[v],v+3<q&&(U+=p[v+3]<<24>>>0)):(v+1<q&&(U=p[v+1]<<16),v+2<q&&(U|=p[v+2]<<8),v+3<q&&(U|=p[v+3]),U+=p[v]<<24>>>0),U}function A(p,v,P,M){if(M||(B(typeof P=="boolean","missing or invalid endian"),B(v!=null,"missing offset"),B(v+1<p.length,"Trying to read beyond buffer length")),!(p.length<=v))return M=x(p,v,P,!0),32768&M?-1*(65535-M+1):M}function C(p,v,P,M){if(M||(B(typeof P=="boolean","missing or invalid endian"),B(v!=null,"missing offset"),B(v+3<p.length,"Trying to read beyond buffer length")),!(p.length<=v))return M=$(p,v,P,!0),2147483648&M?-1*(4294967295-M+1):M}function _(p,v,P,M){return M||(B(typeof P=="boolean","missing or invalid endian"),B(v+3<p.length,"Trying to read beyond buffer length")),b.read(p,v,P,23,4)}function w(p,v,P,M){return M||(B(typeof P=="boolean","missing or invalid endian"),B(v+7<p.length,"Trying to read beyond buffer length")),b.read(p,v,P,52,8)}function m(p,v,P,M,U){if(U||(B(v!=null,"missing value"),B(typeof M=="boolean","missing or invalid endian"),B(P!=null,"missing offset"),B(P+1<p.length,"trying to write beyond buffer length"),ye(v,65535)),U=p.length,!(U<=P))for(var q=0,ae=Math.min(U-P,2);q<ae;q++)p[P+q]=(v&255<<8*(M?q:1-q))>>>8*(M?q:1-q)}function E(p,v,P,M,U){if(U||(B(v!=null,"missing value"),B(typeof M=="boolean","missing or invalid endian"),B(P!=null,"missing offset"),B(P+3<p.length,"trying to write beyond buffer length"),ye(v,4294967295)),U=p.length,!(U<=P))for(var q=0,ae=Math.min(U-P,4);q<ae;q++)p[P+q]=v>>>8*(M?q:3-q)&255}function j(p,v,P,M,U){U||(B(v!=null,"missing value"),B(typeof M=="boolean","missing or invalid endian"),B(P!=null,"missing offset"),B(P+1<p.length,"Trying to write beyond buffer length"),he(v,32767,-32768)),p.length<=P||m(p,0<=v?v:65535+v+1,P,M,U)}function H(p,v,P,M,U){U||(B(v!=null,"missing value"),B(typeof M=="boolean","missing or invalid endian"),B(P!=null,"missing offset"),B(P+3<p.length,"Trying to write beyond buffer length"),he(v,2147483647,-2147483648)),p.length<=P||E(p,0<=v?v:4294967295+v+1,P,M,U)}function O(p,v,P,M,U){U||(B(v!=null,"missing value"),B(typeof M=="boolean","missing or invalid endian"),B(P!=null,"missing offset"),B(P+3<p.length,"Trying to write beyond buffer length"),be(v,34028234663852886e22,-34028234663852886e22)),p.length<=P||b.write(p,v,P,M,23,4)}function I(p,v,P,M,U){U||(B(v!=null,"missing value"),B(typeof M=="boolean","missing or invalid endian"),B(P!=null,"missing offset"),B(P+7<p.length,"Trying to write beyond buffer length"),be(v,17976931348623157e292,-17976931348623157e292)),p.length<=P||b.write(p,v,P,M,52,8)}s.Buffer=y,s.SlowBuffer=y,s.INSPECT_MAX_BYTES=50,y.poolSize=8192,y._useTypedArrays=function(){try{var p=new ArrayBuffer(0),v=new Uint8Array(p);return v.foo=function(){return 42},v.foo()===42&&typeof v.subarray=="function"}catch{return!1}}(),y.isEncoding=function(p){switch(String(p).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},y.isBuffer=function(p){return!(p==null||!p._isBuffer)},y.byteLength=function(p,v){var P;switch(p+="",v||"utf8"){case"hex":P=p.length/2;break;case"utf8":case"utf-8":P=F(p).length;break;case"ascii":case"binary":case"raw":P=p.length;break;case"base64":P=ge(p).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":P=2*p.length;break;default:throw new Error("Unknown encoding")}return P},y.concat=function(p,v){if(B(L(p),`Usage: Buffer.concat(list, [totalLength])
list should be an Array.`),p.length===0)return new y(0);if(p.length===1)return p[0];if(typeof v!="number")for(U=v=0;U<p.length;U++)v+=p[U].length;for(var P=new y(v),M=0,U=0;U<p.length;U++){var q=p[U];q.copy(P,M),M+=q.length}return P},y.prototype.write=function(p,v,P,M){isFinite(v)?isFinite(P)||(M=P,P=void 0):(je=M,M=v,v=P,P=je),v=Number(v)||0;var U,q,ae,Oe,je=this.length-v;switch((!P||je<(P=Number(P)))&&(P=je),M=String(M||"utf8").toLowerCase()){case"hex":U=function(it,Ve,qe,ke){qe=Number(qe)||0;var xe=it.length-qe;(!ke||xe<(ke=Number(ke)))&&(ke=xe),B((xe=Ve.length)%2==0,"Invalid hex string"),xe/2<ke&&(ke=xe/2);for(var er=0;er<ke;er++){var ka=parseInt(Ve.substr(2*er,2),16);B(!isNaN(ka),"Invalid hex string"),it[qe+er]=ka}return y._charsWritten=2*er,er}(this,p,v,P);break;case"utf8":case"utf-8":q=this,ae=v,Oe=P,U=y._charsWritten=ve(F(p),q,ae,Oe);break;case"ascii":case"binary":U=T(this,p,v,P);break;case"base64":q=this,ae=v,Oe=P,U=y._charsWritten=ve(ge(p),q,ae,Oe);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":U=k(this,p,v,P);break;default:throw new Error("Unknown encoding")}return U},y.prototype.toString=function(p,v,P){var M,U,q,ae,Oe=this;if(p=String(p||"utf8").toLowerCase(),v=Number(v)||0,(P=P!==void 0?Number(P):Oe.length)===v)return"";switch(p){case"hex":M=function(je,it,Ve){var qe=je.length;(!it||it<0)&&(it=0),(!Ve||Ve<0||qe<Ve)&&(Ve=qe);for(var ke="",xe=it;xe<Ve;xe++)ke+=R(je[xe]);return ke}(Oe,v,P);break;case"utf8":case"utf-8":M=function(je,it,Ve){var qe="",ke="";Ve=Math.min(je.length,Ve);for(var xe=it;xe<Ve;xe++)je[xe]<=127?(qe+=de(ke)+String.fromCharCode(je[xe]),ke=""):ke+="%"+je[xe].toString(16);return qe+de(ke)}(Oe,v,P);break;case"ascii":case"binary":M=S(Oe,v,P);break;case"base64":U=Oe,ae=P,M=(q=v)===0&&ae===U.length?f.fromByteArray(U):f.fromByteArray(U.slice(q,ae));break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":M=function(je,it,Ve){for(var qe=je.slice(it,Ve),ke="",xe=0;xe<qe.length;xe+=2)ke+=String.fromCharCode(qe[xe]+256*qe[xe+1]);return ke}(Oe,v,P);break;default:throw new Error("Unknown encoding")}return M},y.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},y.prototype.copy=function(p,v,P,M){if(v=v||0,(M=M||M===0?M:this.length)!==(P=P||0)&&p.length!==0&&this.length!==0){B(P<=M,"sourceEnd < sourceStart"),B(0<=v&&v<p.length,"targetStart out of bounds"),B(0<=P&&P<this.length,"sourceStart out of bounds"),B(0<=M&&M<=this.length,"sourceEnd out of bounds"),M>this.length&&(M=this.length);var U=(M=p.length-v<M-P?p.length-v+P:M)-P;if(U<100||!y._useTypedArrays)for(var q=0;q<U;q++)p[q+v]=this[q+P];else p._set(this.subarray(P,P+U),v)}},y.prototype.slice=function(p,v){var P=this.length;if(p=J(p,P,0),v=J(v,P,P),y._useTypedArrays)return y._augment(this.subarray(p,v));for(var M=v-p,U=new y(M,void 0,!0),q=0;q<M;q++)U[q]=this[q+p];return U},y.prototype.get=function(p){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(p)},y.prototype.set=function(p,v){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(p,v)},y.prototype.readUInt8=function(p,v){if(v||(B(p!=null,"missing offset"),B(p<this.length,"Trying to read beyond buffer length")),!(p>=this.length))return this[p]},y.prototype.readUInt16LE=function(p,v){return x(this,p,!0,v)},y.prototype.readUInt16BE=function(p,v){return x(this,p,!1,v)},y.prototype.readUInt32LE=function(p,v){return $(this,p,!0,v)},y.prototype.readUInt32BE=function(p,v){return $(this,p,!1,v)},y.prototype.readInt8=function(p,v){if(v||(B(p!=null,"missing offset"),B(p<this.length,"Trying to read beyond buffer length")),!(p>=this.length))return 128&this[p]?-1*(255-this[p]+1):this[p]},y.prototype.readInt16LE=function(p,v){return A(this,p,!0,v)},y.prototype.readInt16BE=function(p,v){return A(this,p,!1,v)},y.prototype.readInt32LE=function(p,v){return C(this,p,!0,v)},y.prototype.readInt32BE=function(p,v){return C(this,p,!1,v)},y.prototype.readFloatLE=function(p,v){return _(this,p,!0,v)},y.prototype.readFloatBE=function(p,v){return _(this,p,!1,v)},y.prototype.readDoubleLE=function(p,v){return w(this,p,!0,v)},y.prototype.readDoubleBE=function(p,v){return w(this,p,!1,v)},y.prototype.writeUInt8=function(p,v,P){P||(B(p!=null,"missing value"),B(v!=null,"missing offset"),B(v<this.length,"trying to write beyond buffer length"),ye(p,255)),v>=this.length||(this[v]=p)},y.prototype.writeUInt16LE=function(p,v,P){m(this,p,v,!0,P)},y.prototype.writeUInt16BE=function(p,v,P){m(this,p,v,!1,P)},y.prototype.writeUInt32LE=function(p,v,P){E(this,p,v,!0,P)},y.prototype.writeUInt32BE=function(p,v,P){E(this,p,v,!1,P)},y.prototype.writeInt8=function(p,v,P){P||(B(p!=null,"missing value"),B(v!=null,"missing offset"),B(v<this.length,"Trying to write beyond buffer length"),he(p,127,-128)),v>=this.length||(0<=p?this.writeUInt8(p,v,P):this.writeUInt8(255+p+1,v,P))},y.prototype.writeInt16LE=function(p,v,P){j(this,p,v,!0,P)},y.prototype.writeInt16BE=function(p,v,P){j(this,p,v,!1,P)},y.prototype.writeInt32LE=function(p,v,P){H(this,p,v,!0,P)},y.prototype.writeInt32BE=function(p,v,P){H(this,p,v,!1,P)},y.prototype.writeFloatLE=function(p,v,P){O(this,p,v,!0,P)},y.prototype.writeFloatBE=function(p,v,P){O(this,p,v,!1,P)},y.prototype.writeDoubleLE=function(p,v,P){I(this,p,v,!0,P)},y.prototype.writeDoubleBE=function(p,v,P){I(this,p,v,!1,P)},y.prototype.fill=function(p,v,P){if(v=v||0,P=P||this.length,B(typeof(p=typeof(p=p||0)=="string"?p.charCodeAt(0):p)=="number"&&!isNaN(p),"value is not a number"),B(v<=P,"end < start"),P!==v&&this.length!==0){B(0<=v&&v<this.length,"start out of bounds"),B(0<=P&&P<=this.length,"end out of bounds");for(var M=v;M<P;M++)this[M]=p}},y.prototype.inspect=function(){for(var p=[],v=this.length,P=0;P<v;P++)if(p[P]=R(this[P]),P===s.INSPECT_MAX_BYTES){p[P+1]="...";break}return"<Buffer "+p.join(" ")+">"},y.prototype.toArrayBuffer=function(){if(typeof Uint8Array>"u")throw new Error("Buffer.toArrayBuffer not supported in this browser");if(y._useTypedArrays)return new y(this).buffer;for(var p=new Uint8Array(this.length),v=0,P=p.length;v<P;v+=1)p[v]=this[v];return p.buffer};var D=y.prototype;function J(p,v,P){return typeof p!="number"?P:v<=(p=~~p)?v:0<=p||0<=(p+=v)?p:0}function G(p){return(p=~~Math.ceil(+p))<0?0:p}function L(p){return(Array.isArray||function(v){return Object.prototype.toString.call(v)==="[object Array]"})(p)}function R(p){return p<16?"0"+p.toString(16):p.toString(16)}function F(p){for(var v=[],P=0;P<p.length;P++){var M=p.charCodeAt(P);if(M<=127)v.push(p.charCodeAt(P));else for(var U=P,q=(55296<=M&&M<=57343&&P++,encodeURIComponent(p.slice(U,P+1)).substr(1).split("%")),ae=0;ae<q.length;ae++)v.push(parseInt(q[ae],16))}return v}function ge(p){return f.toByteArray(p)}function ve(p,v,P,M){for(var U=0;U<M&&!(U+P>=v.length||U>=p.length);U++)v[U+P]=p[U];return U}function de(p){try{return decodeURIComponent(p)}catch{return String.fromCharCode(65533)}}function ye(p,v){B(typeof p=="number","cannot write a non-number as a number"),B(0<=p,"specified a negative value for writing an unsigned value"),B(p<=v,"value is larger than maximum value for type"),B(Math.floor(p)===p,"value has a fractional component")}function he(p,v,P){B(typeof p=="number","cannot write a non-number as a number"),B(p<=v,"value larger than maximum allowed value"),B(P<=p,"value smaller than minimum allowed value"),B(Math.floor(p)===p,"value has a fractional component")}function be(p,v,P){B(typeof p=="number","cannot write a non-number as a number"),B(p<=v,"value larger than maximum allowed value"),B(P<=p,"value smaller than minimum allowed value")}function B(p,v){if(!p)throw new Error(v||"Failed assertion")}y._augment=function(p){return p._isBuffer=!0,p._get=p.get,p._set=p.set,p.get=D.get,p.set=D.set,p.write=D.write,p.toString=D.toString,p.toLocaleString=D.toString,p.toJSON=D.toJSON,p.copy=D.copy,p.slice=D.slice,p.readUInt8=D.readUInt8,p.readUInt16LE=D.readUInt16LE,p.readUInt16BE=D.readUInt16BE,p.readUInt32LE=D.readUInt32LE,p.readUInt32BE=D.readUInt32BE,p.readInt8=D.readInt8,p.readInt16LE=D.readInt16LE,p.readInt16BE=D.readInt16BE,p.readInt32LE=D.readInt32LE,p.readInt32BE=D.readInt32BE,p.readFloatLE=D.readFloatLE,p.readFloatBE=D.readFloatBE,p.readDoubleLE=D.readDoubleLE,p.readDoubleBE=D.readDoubleBE,p.writeUInt8=D.writeUInt8,p.writeUInt16LE=D.writeUInt16LE,p.writeUInt16BE=D.writeUInt16BE,p.writeUInt32LE=D.writeUInt32LE,p.writeUInt32BE=D.writeUInt32BE,p.writeInt8=D.writeInt8,p.writeInt16LE=D.writeInt16LE,p.writeInt16BE=D.writeInt16BE,p.writeInt32LE=D.writeInt32LE,p.writeInt32BE=D.writeInt32BE,p.writeFloatLE=D.writeFloatLE,p.writeFloatBE=D.writeFloatBE,p.writeDoubleLE=D.writeDoubleLE,p.writeDoubleBE=D.writeDoubleBE,p.fill=D.fill,p.inspect=D.inspect,p.toArrayBuffer=D.toArrayBuffer,p}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/buffer/index.js","/node_modules/gulp-browserify/node_modules/buffer")},{"base64-js":2,buffer:3,ieee754:10,lYpoI2:11}],4:[function(t,r,s){(function(i,a,f,u,c,l,d,h,g){var f=t("buffer").Buffer,b=4,y=new f(b);y.fill(0),r.exports={hash:function(T,k,S,x){for(var $=k(function(m,E){m.length%b!=0&&(j=m.length+(b-m.length%b),m=f.concat([m,y],j));for(var j,H=[],O=E?m.readInt32BE:m.readInt32LE,I=0;I<m.length;I+=b)H.push(O.call(m,I));return H}(T=f.isBuffer(T)?T:new f(T),x),8*T.length),k=x,A=new f(S),C=k?A.writeInt32BE:A.writeInt32LE,_=0;_<$.length;_++)C.call(A,$[_],4*_,!0);return A}}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/helpers.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],5:[function(t,r,s){(function(i,a,f,u,c,l,d,h,g){var f=t("buffer").Buffer,b=t("./sha"),y=t("./sha256"),T=t("./rng"),k={sha1:b,sha256:y,md5:t("./md5")},S=64,x=new f(S);function $(m,E){var j=k[m=m||"sha1"],H=[];return j||A("algorithm:",m,"is not yet supported"),{update:function(O){return f.isBuffer(O)||(O=new f(O)),H.push(O),O.length,this},digest:function(O){var I=f.concat(H),I=E?function(D,J,G){f.isBuffer(J)||(J=new f(J)),f.isBuffer(G)||(G=new f(G)),J.length>S?J=D(J):J.length<S&&(J=f.concat([J,x],S));for(var L=new f(S),R=new f(S),F=0;F<S;F++)L[F]=54^J[F],R[F]=92^J[F];return G=D(f.concat([L,G])),D(f.concat([R,G]))}(j,E,I):j(I);return H=null,O?I.toString(O):I}}}function A(){var m=[].slice.call(arguments).join(" ");throw new Error([m,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join(`
`))}x.fill(0),s.createHash=function(m){return $(m)},s.createHmac=$,s.randomBytes=function(m,E){if(!E||!E.call)return new f(T(m));try{E.call(this,void 0,new f(T(m)))}catch(j){E(j)}};var C,_=["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],w=function(m){s[m]=function(){A("sorry,",m,"is not implemented yet")}};for(C in _)w(_[C])}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/index.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./md5":6,"./rng":7,"./sha":8,"./sha256":9,buffer:3,lYpoI2:11}],6:[function(t,r,s){(function(i,a,o,u,c,l,d,h,g){var f=t("./helpers");function b(A,C){A[C>>5]|=128<<C%32,A[14+(C+64>>>9<<4)]=C;for(var _=1732584193,w=-271733879,m=-1732584194,E=271733878,j=0;j<A.length;j+=16){var H=_,O=w,I=m,D=E,_=T(_,w,m,E,A[j+0],7,-680876936),E=T(E,_,w,m,A[j+1],12,-389564586),m=T(m,E,_,w,A[j+2],17,606105819),w=T(w,m,E,_,A[j+3],22,-1044525330);_=T(_,w,m,E,A[j+4],7,-176418897),E=T(E,_,w,m,A[j+5],12,1200080426),m=T(m,E,_,w,A[j+6],17,-1473231341),w=T(w,m,E,_,A[j+7],22,-45705983),_=T(_,w,m,E,A[j+8],7,1770035416),E=T(E,_,w,m,A[j+9],12,-1958414417),m=T(m,E,_,w,A[j+10],17,-42063),w=T(w,m,E,_,A[j+11],22,-1990404162),_=T(_,w,m,E,A[j+12],7,1804603682),E=T(E,_,w,m,A[j+13],12,-40341101),m=T(m,E,_,w,A[j+14],17,-1502002290),_=k(_,w=T(w,m,E,_,A[j+15],22,1236535329),m,E,A[j+1],5,-165796510),E=k(E,_,w,m,A[j+6],9,-1069501632),m=k(m,E,_,w,A[j+11],14,643717713),w=k(w,m,E,_,A[j+0],20,-373897302),_=k(_,w,m,E,A[j+5],5,-701558691),E=k(E,_,w,m,A[j+10],9,38016083),m=k(m,E,_,w,A[j+15],14,-660478335),w=k(w,m,E,_,A[j+4],20,-405537848),_=k(_,w,m,E,A[j+9],5,568446438),E=k(E,_,w,m,A[j+14],9,-1019803690),m=k(m,E,_,w,A[j+3],14,-187363961),w=k(w,m,E,_,A[j+8],20,1163531501),_=k(_,w,m,E,A[j+13],5,-1444681467),E=k(E,_,w,m,A[j+2],9,-51403784),m=k(m,E,_,w,A[j+7],14,1735328473),_=S(_,w=k(w,m,E,_,A[j+12],20,-1926607734),m,E,A[j+5],4,-378558),E=S(E,_,w,m,A[j+8],11,-2022574463),m=S(m,E,_,w,A[j+11],16,1839030562),w=S(w,m,E,_,A[j+14],23,-35309556),_=S(_,w,m,E,A[j+1],4,-1530992060),E=S(E,_,w,m,A[j+4],11,1272893353),m=S(m,E,_,w,A[j+7],16,-155497632),w=S(w,m,E,_,A[j+10],23,-1094730640),_=S(_,w,m,E,A[j+13],4,681279174),E=S(E,_,w,m,A[j+0],11,-358537222),m=S(m,E,_,w,A[j+3],16,-722521979),w=S(w,m,E,_,A[j+6],23,76029189),_=S(_,w,m,E,A[j+9],4,-640364487),E=S(E,_,w,m,A[j+12],11,-421815835),m=S(m,E,_,w,A[j+15],16,530742520),_=x(_,w=S(w,m,E,_,A[j+2],23,-995338651),m,E,A[j+0],6,-198630844),E=x(E,_,w,m,A[j+7],10,1126891415),m=x(m,E,_,w,A[j+14],15,-1416354905),w=x(w,m,E,_,A[j+5],21,-57434055),_=x(_,w,m,E,A[j+12],6,1700485571),E=x(E,_,w,m,A[j+3],10,-1894986606),m=x(m,E,_,w,A[j+10],15,-1051523),w=x(w,m,E,_,A[j+1],21,-2054922799),_=x(_,w,m,E,A[j+8],6,1873313359),E=x(E,_,w,m,A[j+15],10,-30611744),m=x(m,E,_,w,A[j+6],15,-1560198380),w=x(w,m,E,_,A[j+13],21,1309151649),_=x(_,w,m,E,A[j+4],6,-145523070),E=x(E,_,w,m,A[j+11],10,-1120210379),m=x(m,E,_,w,A[j+2],15,718787259),w=x(w,m,E,_,A[j+9],21,-343485551),_=$(_,H),w=$(w,O),m=$(m,I),E=$(E,D)}return Array(_,w,m,E)}function y(A,C,_,w,m,E){return $((C=$($(C,A),$(w,E)))<<m|C>>>32-m,_)}function T(A,C,_,w,m,E,j){return y(C&_|~C&w,A,C,m,E,j)}function k(A,C,_,w,m,E,j){return y(C&w|_&~w,A,C,m,E,j)}function S(A,C,_,w,m,E,j){return y(C^_^w,A,C,m,E,j)}function x(A,C,_,w,m,E,j){return y(_^(C|~w),A,C,m,E,j)}function $(A,C){var _=(65535&A)+(65535&C);return(A>>16)+(C>>16)+(_>>16)<<16|65535&_}r.exports=function(A){return f.hash(A,b,16)}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/md5.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],7:[function(t,r,s){(function(i,a,o,u,c,l,d,h,g){r.exports=function(f){for(var b,y=new Array(f),T=0;T<f;T++)!(3&T)&&(b=4294967296*Math.random()),y[T]=b>>>((3&T)<<3)&255;return y}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/rng.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],8:[function(t,r,s){(function(i,a,o,u,c,l,d,h,g){var f=t("./helpers");function b(k,S){k[S>>5]|=128<<24-S%32,k[15+(S+64>>9<<4)]=S;for(var x,$,A,C=Array(80),_=1732584193,w=-271733879,m=-1732584194,E=271733878,j=-1009589776,H=0;H<k.length;H+=16){for(var O=_,I=w,D=m,J=E,G=j,L=0;L<80;L++){C[L]=L<16?k[H+L]:T(C[L-3]^C[L-8]^C[L-14]^C[L-16],1);var R=y(y(T(_,5),(R=w,$=m,A=E,(x=L)<20?R&$|~R&A:!(x<40)&&x<60?R&$|R&A|$&A:R^$^A)),y(y(j,C[L]),(x=L)<20?1518500249:x<40?1859775393:x<60?-1894007588:-899497514)),j=E,E=m,m=T(w,30),w=_,_=R}_=y(_,O),w=y(w,I),m=y(m,D),E=y(E,J),j=y(j,G)}return Array(_,w,m,E,j)}function y(k,S){var x=(65535&k)+(65535&S);return(k>>16)+(S>>16)+(x>>16)<<16|65535&x}function T(k,S){return k<<S|k>>>32-S}r.exports=function(k){return f.hash(k,b,20,!0)}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],9:[function(t,r,s){(function(i,a,o,u,c,l,d,h,g){function f(S,x){var $=(65535&S)+(65535&x);return(S>>16)+(x>>16)+($>>16)<<16|65535&$}function b(S,x){var $,A=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),C=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),_=new Array(64);S[x>>5]|=128<<24-x%32,S[15+(x+64>>9<<4)]=x;for(var w,m,E=0;E<S.length;E+=16){for(var j=C[0],H=C[1],O=C[2],I=C[3],D=C[4],J=C[5],G=C[6],L=C[7],R=0;R<64;R++)_[R]=R<16?S[R+E]:f(f(f((m=_[R-2],T(m,17)^T(m,19)^k(m,10)),_[R-7]),(m=_[R-15],T(m,7)^T(m,18)^k(m,3))),_[R-16]),$=f(f(f(f(L,T(m=D,6)^T(m,11)^T(m,25)),D&J^~D&G),A[R]),_[R]),w=f(T(w=j,2)^T(w,13)^T(w,22),j&H^j&O^H&O),L=G,G=J,J=D,D=f(I,$),I=O,O=H,H=j,j=f($,w);C[0]=f(j,C[0]),C[1]=f(H,C[1]),C[2]=f(O,C[2]),C[3]=f(I,C[3]),C[4]=f(D,C[4]),C[5]=f(J,C[5]),C[6]=f(G,C[6]),C[7]=f(L,C[7])}return C}var y=t("./helpers"),T=function(S,x){return S>>>x|S<<32-x},k=function(S,x){return S>>>x};r.exports=function(S){return y.hash(S,b,32,!0)}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha256.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],10:[function(t,r,s){(function(i,a,o,u,c,l,d,h,g){s.read=function(f,b,y,T,E){var S,x,$=8*E-T-1,A=(1<<$)-1,C=A>>1,_=-7,w=y?E-1:0,m=y?-1:1,E=f[b+w];for(w+=m,S=E&(1<<-_)-1,E>>=-_,_+=$;0<_;S=256*S+f[b+w],w+=m,_-=8);for(x=S&(1<<-_)-1,S>>=-_,_+=T;0<_;x=256*x+f[b+w],w+=m,_-=8);if(S===0)S=1-C;else{if(S===A)return x?NaN:1/0*(E?-1:1);x+=Math.pow(2,T),S-=C}return(E?-1:1)*x*Math.pow(2,S-T)},s.write=function(f,b,y,T,k,j){var x,$,A=8*j-k-1,C=(1<<A)-1,_=C>>1,w=k===23?Math.pow(2,-24)-Math.pow(2,-77):0,m=T?0:j-1,E=T?1:-1,j=b<0||b===0&&1/b<0?1:0;for(b=Math.abs(b),isNaN(b)||b===1/0?($=isNaN(b)?1:0,x=C):(x=Math.floor(Math.log(b)/Math.LN2),b*(T=Math.pow(2,-x))<1&&(x--,T*=2),2<=(b+=1<=x+_?w/T:w*Math.pow(2,1-_))*T&&(x++,T/=2),C<=x+_?($=0,x=C):1<=x+_?($=(b*T-1)*Math.pow(2,k),x+=_):($=b*Math.pow(2,_-1)*Math.pow(2,k),x=0));8<=k;f[y+m]=255&$,m+=E,$/=256,k-=8);for(x=x<<k|$,A+=k;0<A;f[y+m]=255&x,m+=E,x/=256,A-=8);f[y+m-E]|=128*j}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/ieee754/index.js","/node_modules/gulp-browserify/node_modules/ieee754")},{buffer:3,lYpoI2:11}],11:[function(t,r,s){(function(i,a,o,u,c,l,d,h,g){var f,b,y;function T(){}(i=r.exports={}).nextTick=(b=typeof window<"u"&&window.setImmediate,y=typeof window<"u"&&window.postMessage&&window.addEventListener,b?function(k){return window.setImmediate(k)}:y?(f=[],window.addEventListener("message",function(k){var S=k.source;S!==window&&S!==null||k.data!=="process-tick"||(k.stopPropagation(),0<f.length&&f.shift()())},!0),function(k){f.push(k),window.postMessage("process-tick","*")}):function(k){setTimeout(k,0)}),i.title="browser",i.browser=!0,i.env={},i.argv=[],i.on=T,i.addListener=T,i.once=T,i.off=T,i.removeListener=T,i.removeAllListeners=T,i.emit=T,i.binding=function(k){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(k){throw new Error("process.chdir is not supported")}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/process/browser.js","/node_modules/gulp-browserify/node_modules/process")},{buffer:3,lYpoI2:11}]},{},[1])(1)})})(ql);var zv=ql.exports;const Hv=hn(zv),gu=(...n)=>Hv(n.join("_")),Kv=new Map;class Sa extends ip{constructor(e){super(),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cache=e??new Map}lookup(e,t){return Promise.resolve(this.cache.get(gu(e,t))??null)}async update(e,t,r){this.cache.set(gu(e,t),r)}static global(){return new Sa(Kv)}}class Zv extends zc{constructor({cache:e,concurrency:t,...r}){super(t?{maxConcurrency:t,...r}:r),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","llms",this._llmType()]}),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof e=="object"?this.cache=e:e?this.cache=Sa.global():this.cache=void 0}async generatePrompt(e,t,r){const s=e.map(i=>i.toString());return this.generate(s,t,r)}invocationParams(e){return{}}_flattenLLMResult(e){const t=[];for(let r=0;r<e.generations.length;r+=1){const s=e.generations[r];if(r===0)t.push({generations:[s],llmOutput:e.llmOutput});else{const i=e.llmOutput?{...e.llmOutput,tokenUsage:{}}:void 0;t.push({generations:[s],llmOutput:i})}}return t}async _generateUncached(e,t,r){const s=await Nt.configure(r.callbacks,this.callbacks,r.tags,this.tags,r.metadata,this.metadata,{verbose:this.verbose}),i={options:t,invocation_params:this==null?void 0:this.invocationParams(t)},a=await(s==null?void 0:s.handleLLMStart(this.toJSON(),e,void 0,void 0,i));let o;try{o=await this._generate(e,t,a==null?void 0:a[0])}catch(l){throw await Promise.all((a??[]).map(d=>d==null?void 0:d.handleLLMError(l))),l}const u=this._flattenLLMResult(o);await Promise.all((a??[]).map((l,d)=>l==null?void 0:l.handleLLMEnd(u[d])));const c=(a==null?void 0:a.map(l=>l.runId))||void 0;return Object.defineProperty(o,Wu,{value:c?{runIds:c}:void 0,configurable:!0}),o}async generate(e,t,r){if(!Array.isArray(e))throw new Error("Argument 'prompts' is expected to be a string[]");let s;Array.isArray(t)?s={stop:t}:t!=null&&t.timeout&&!t.signal?s={...t,signal:AbortSignal.timeout(t.timeout)}:s=t??{};const i={tags:s.tags,metadata:s.metadata,callbacks:s.callbacks??r};if(delete s.tags,delete s.metadata,delete s.callbacks,!this.cache)return this._generateUncached(e,s,i);const{cache:a}=this,o=this.serialize();o.stop=s.stop??o.stop;const u=`${Object.entries(o).sort()}`,c=[],l=await Promise.all(e.map(async(h,g)=>{const f=await a.lookup(h,u);return f||c.push(g),f}));let d={};if(c.length>0){const h=await this._generateUncached(c.map(g=>e[g]),s,i);await Promise.all(h.generations.map(async(g,f)=>{const b=c[f];return l[b]=g,a.update(e[b],u,g)})),d=h.llmOutput??{}}return{generations:l,llmOutput:d}}async call(e,t,r){const{generations:s}=await this.generate([e],t??{},r);return s[0][0].text}async predict(e,t,r){return this.call(e,t,r)}async predictMessages(e,t,r){const s=fa(e),i=await this.call(s,t,r);return new Xu(i)}_identifyingParams(){return{}}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}_modelType(){return"base_llm"}static async deserialize(e){const{_type:t,_model:r,...s}=e;if(r&&r!=="base_llm")throw new Error(`Cannot load LLM with model ${r}`);const i={openai:(await Te(()=>import("./openai.c68c8f3d.js"),["_app/immutable/chunks/openai.c68c8f3d.js","_app/immutable/chunks/prompt-layer.00daf386.js"])).OpenAI}[t];if(i===void 0)throw new Error(`Cannot load  LLM with type ${t}`);return new i(s)}}class Jv extends Zv{async _generate(e,t,r){return{generations:await Promise.all(e.map((i,a)=>this._call(i,{...t,promptIndex:a},r).then(o=>[{text:o}])))}}}class ja extends Jv{get lc_secrets(){return{apiKey:"HUGGINGFACEHUB_API_KEY"}}constructor(e){if(super(e??{}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"gpt2"}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topK",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.model=(e==null?void 0:e.model)??this.model,this.temperature=(e==null?void 0:e.temperature)??this.temperature,this.maxTokens=(e==null?void 0:e.maxTokens)??this.maxTokens,this.topP=(e==null?void 0:e.topP)??this.topP,this.topK=(e==null?void 0:e.topK)??this.topK,this.frequencyPenalty=(e==null?void 0:e.frequencyPenalty)??this.frequencyPenalty,this.apiKey=(e==null?void 0:e.apiKey)??Ce("HUGGINGFACEHUB_API_KEY"),!this.apiKey)throw new Error("Please set an API key for HuggingFace Hub in the environment variable HUGGINGFACEHUB_API_KEY or in the apiKey field of the HuggingFaceInference constructor.")}_llmType(){return"hf"}async _call(e,t){const{HfInference:r}=await ja.imports(),s=new r(this.apiKey);return(await this.caller.callWithOptions({signal:t.signal},s.textGeneration.bind(s),{model:this.model,parameters:{return_full_text:!1,temperature:this.temperature,max_new_tokens:this.maxTokens,top_p:this.topP,top_k:this.topK,repetition_penalty:this.frequencyPenalty},inputs:e})).generated_text}static async imports(){try{const{HfInference:e}=await Te(()=>Promise.resolve().then(()=>Qf),void 0);return{HfInference:e}}catch{throw new Error("Please install huggingface as a dependency with, e.g. `yarn add @huggingface/inference`")}}}async function bu(n,e,t,r,s){const i=s,a=new ja({apiKey:n,model:"tiiuae/falcon-7b-instruct",maxTokens:5e3}),u=await ga.fromLLM(a,e.asRetriever(),{returnSourceDocuments:!0}).call({question:i,chat_history:[]});console.log("result",u),console.log(u.text)}function $i(n){n.from("documents").select("name:metadata->>file_name, size:metadata->>file_size",{count:"exact"}).then(e=>{const r=e.data.reduce((a,o)=>(a.find(c=>c.name===o.name)||a.push(o),a),[]);r.sort((a,o)=>parseInt(o.size)-parseInt(a.size));const s=r.length,i=r.reduce((a,o)=>a+parseInt(o.size),0);console.log("Total Documents:",s),console.log("Total Size (bytes):",i),r.forEach(a=>{`${a.name}`,console.log(`**${a.name}** (${a.size} bytes)`),console.log("")})}).catch(e=>{console.error("Error:",e)})}const ee="src/routes/+page.svelte";function zl(n){let e,t,r="Configuration",s,i,a=$i(n[4])+"",o;const u={c:function(){e=Q("div"),t=Q("h2"),t.textContent=r,s=pe(),i=Q("div"),o=qn(a),this.h()},l:function(l){e=X(l,"DIV",{class:!0});var d=Ae(e);t=X(d,"H2",{"data-svelte-h":!0}),Pe(t)!=="svelte-bx2tqs"&&(t.textContent=r),d.forEach(le),s=me(l),i=X(l,"DIV",{class:!0});var h=Ae(i);o=zn(h,a),h.forEach(le),this.h()},h:function(){W(t,ee,243,8,6249),re(e,"class","sidebar"),W(e,ee,242,6,6219),re(i,"class","content"),W(i,ee,248,6,6428)},m:function(l,d){yt(l,e,d),z(e,t),yt(l,s,d),yt(l,i,d),z(i,o)},p:function(l,d){d&16&&a!==(a=$i(l[4])+"")&&Hn(o,a)},d:function(l){l&&(le(e),le(s),le(i))}};return dn("SvelteRegisterBlock",{block:u,id:zl.name,type:"if",source:"(181:32) ",ctx:n}),u}function Hl(n){let e,t,r="Configuration",s,i,a="Choose your model and temperature for asking questions.",o,u,c,l="Model",d,h,g,f="tiiuae/falcon-7b-instruct",b,y="OpenAssistant/oasst-sft-4-pythia-12b-epoch-3.5",T,k,S,x="Temperature",$,A,C,_,w,m,E,j,H,O,I="Add the URL to the database",D,J;const G={c:function(){e=Q("div"),t=Q("h2"),t.textContent=r,s=pe(),i=Q("p"),i.textContent=a,o=pe(),u=Q("div"),c=Q("label"),c.textContent=l,d=pe(),h=Q("select"),g=Q("option"),g.textContent=f,b=Q("option"),b.textContent=y,T=pe(),k=Q("div"),S=Q("label"),S.textContent=x,$=pe(),A=Q("input"),C=pe(),_=Q("span"),w=qn(n[9]),m=pe(),E=Q("div"),j=Q("textarea"),H=pe(),O=Q("button"),O.textContent=I,this.h()},l:function(R){e=X(R,"DIV",{class:!0});var F=Ae(e);t=X(F,"H2",{"data-svelte-h":!0}),Pe(t)!=="svelte-bx2tqs"&&(t.textContent=r),s=me(F),i=X(F,"P",{"data-svelte-h":!0}),Pe(i)!=="svelte-1o6n24x"&&(i.textContent=a),o=me(F),u=X(F,"DIV",{class:!0});var ge=Ae(u);c=X(ge,"LABEL",{for:!0,"data-svelte-h":!0}),Pe(c)!=="svelte-6cjlpw"&&(c.textContent=l),d=me(ge),h=X(ge,"SELECT",{id:!0});var ve=Ae(h);g=X(ve,"OPTION",{"data-svelte-h":!0}),Pe(g)!=="svelte-m8jcxa"&&(g.textContent=f),b=X(ve,"OPTION",{"data-svelte-h":!0}),Pe(b)!=="svelte-1epjw1g"&&(b.textContent=y),ve.forEach(le),ge.forEach(le),T=me(F),k=X(F,"DIV",{class:!0});var de=Ae(k);S=X(de,"LABEL",{for:!0,"data-svelte-h":!0}),Pe(S)!=="svelte-11sobei"&&(S.textContent=x),$=me(de),A=X(de,"INPUT",{type:!0,id:!0,min:!0,max:!0,step:!0}),C=me(de),_=X(de,"SPAN",{});var ye=Ae(_);w=zn(ye,n[9]),ye.forEach(le),de.forEach(le),F.forEach(le),m=me(R),E=X(R,"DIV",{class:!0});var he=Ae(E);j=X(he,"TEXTAREA",{}),Ae(j).forEach(le),H=me(he),O=X(he,"BUTTON",{"data-svelte-h":!0}),Pe(O)!=="svelte-1ul8iy1"&&(O.textContent=I),he.forEach(le),this.h()},h:function(){W(t,ee,199,8,4837),W(i,ee,200,8,4868),re(c,"for","model"),W(c,ee,202,10,4970),g.__value="tiiuae/falcon-7b-instruct",Be(g,g.__value),W(g,ee,204,12,5065),b.__value="OpenAssistant/oasst-sft-4-pythia-12b-epoch-3.5",Be(b,b.__value),W(b,ee,207,12,5182),re(h,"id","model"),n[8]===void 0&&Yl(()=>n[24].call(h)),W(h,ee,203,10,5013),re(u,"class","select"),W(u,ee,201,8,4939),re(S,"for","temperature"),W(S,ee,213,10,5403),re(A,"type","range"),re(A,"id","temperature"),re(A,"min","0.1"),re(A,"max","1.0"),re(A,"step","0.2"),W(A,ee,214,10,5458),W(_,ee,222,10,5647),re(k,"class","slider"),W(k,ee,212,8,5372),re(e,"class","sidebar"),W(e,ee,198,6,4807),W(j,ee,228,8,5797),W(O,ee,229,8,5840),re(E,"class","content"),W(E,ee,227,6,5767)},m:function(R,F){yt(R,e,F),z(e,t),z(e,s),z(e,i),z(e,o),z(e,u),z(u,c),z(u,d),z(u,h),z(h,g),z(h,b),Ra(h,n[8],!0),z(e,T),z(e,k),z(k,S),z(k,$),z(k,A),Be(A,n[9]),z(k,C),z(k,_),z(_,w),yt(R,m,F),yt(R,E,F),z(E,j),Be(j,n[3]),z(E,H),z(E,O),D||(J=[Ue(h,"change",n[24]),Ue(A,"change",n[25]),Ue(A,"input",n[25]),Ue(j,"input",n[26]),Ue(O,"click",n[27],!1,!1,!1,!1)],D=!0)},p:function(R,F){F&256&&Ra(h,R[8]),F&512&&Be(A,R[9]),F&512&&Hn(w,R[9]),F&8&&Be(j,R[3])},d:function(R){R&&(le(e),le(m),le(E)),D=!1,Mi(J)}};return dn("SvelteRegisterBlock",{block:G,id:Hl.name,type:"if",source:"(137:46) ",ctx:n}),G}function Kl(n){let e,t,r="Configuration",s,i,a="Choose your chunk size and overlap for adding knowledge.",o,u,c,l="Chunk Size",d,h,g,f,b,y,T,k,S="Chunk Overlap",x,$,A,C,_,w,m,E,j,H,O,I="Upload Files",D,J,G,L,R,F="Add the URL to the database",ge,ve;const de={c:function(){e=Q("div"),t=Q("h2"),t.textContent=r,s=pe(),i=Q("p"),i.textContent=a,o=pe(),u=Q("div"),c=Q("label"),c.textContent=l,d=pe(),h=Q("input"),g=pe(),f=Q("span"),b=qn(n[6]),y=pe(),T=Q("div"),k=Q("label"),k.textContent=S,x=pe(),$=Q("input"),A=pe(),C=Q("span"),_=qn(n[7]),w=pe(),m=Q("div"),E=Q("div"),j=Q("input"),H=pe(),O=Q("button"),O.textContent=I,D=pe(),J=Q("div"),G=Q("textarea"),L=pe(),R=Q("button"),R.textContent=F,this.h()},l:function(he){e=X(he,"DIV",{class:!0});var be=Ae(e);t=X(be,"H2",{"data-svelte-h":!0}),Pe(t)!=="svelte-bx2tqs"&&(t.textContent=r),s=me(be),i=X(be,"P",{"data-svelte-h":!0}),Pe(i)!=="svelte-gxt4ze"&&(i.textContent=a),o=me(be),u=X(be,"DIV",{class:!0});var B=Ae(u);c=X(B,"LABEL",{for:!0,"data-svelte-h":!0}),Pe(c)!=="svelte-xcnf9x"&&(c.textContent=l),d=me(B),h=X(B,"INPUT",{type:!0,id:!0,min:!0,max:!0,step:!0}),g=me(B),f=X(B,"SPAN",{});var p=Ae(f);b=zn(p,n[6]),p.forEach(le),B.forEach(le),y=me(be),T=X(be,"DIV",{class:!0});var v=Ae(T);k=X(v,"LABEL",{for:!0,"data-svelte-h":!0}),Pe(k)!=="svelte-1yjlqk5"&&(k.textContent=S),x=me(v),$=X(v,"INPUT",{type:!0,id:!0,min:!0,max:!0,step:!0}),A=me(v),C=X(v,"SPAN",{});var P=Ae(C);_=zn(P,n[7]),P.forEach(le),v.forEach(le),be.forEach(le),w=me(he),m=X(he,"DIV",{class:!0});var M=Ae(m);E=X(M,"DIV",{class:!0});var U=Ae(E);j=X(U,"INPUT",{type:!0}),H=me(U),O=X(U,"BUTTON",{"data-svelte-h":!0}),Pe(O)!=="svelte-1f0holf"&&(O.textContent=I),U.forEach(le),D=me(M),J=X(M,"DIV",{class:!0});var q=Ae(J);G=X(q,"TEXTAREA",{}),Ae(G).forEach(le),L=me(q),R=X(q,"BUTTON",{"data-svelte-h":!0}),Pe(R)!=="svelte-1y0kmke"&&(R.textContent=F),q.forEach(le),M.forEach(le),this.h()},h:function(){W(t,ee,144,8,3064),W(i,ee,145,8,3095),re(c,"for","chunk-size"),W(c,ee,147,10,3198),re(h,"type","range"),re(h,"id","chunk-size"),re(h,"min","100"),re(h,"max","1000"),re(h,"step","50"),W(h,ee,148,10,3251),W(f,ee,156,10,3437),re(u,"class","slider"),W(u,ee,146,8,3167),re(k,"for","chunk-overlap"),W(k,ee,159,10,3517),re($,"type","range"),re($,"id","chunk-overlap"),re($,"min","0"),re($,"max","100"),re($,"step","10"),W($,ee,160,10,3576),W(C,ee,168,10,3765),re(T,"class","slider"),W(T,ee,158,8,3486),re(e,"class","sidebar"),W(e,ee,143,6,3034),re(j,"type","file"),j.multiple=!0,W(j,ee,175,10,3955),W(O,ee,176,10,4015),re(E,"class","file-uploader"),W(E,ee,174,8,3917),W(G,ee,183,10,4227),W(R,ee,184,10,4267),re(J,"class","url-uploader"),W(J,ee,182,8,4190),re(m,"class","content"),W(m,ee,173,6,3887)},m:function(he,be){yt(he,e,be),z(e,t),z(e,s),z(e,i),z(e,o),z(e,u),z(u,c),z(u,d),z(u,h),Be(h,n[6]),z(u,g),z(u,f),z(f,b),z(e,y),z(e,T),z(T,k),z(T,x),z(T,$),Be($,n[7]),z(T,A),z(T,C),z(C,_),yt(he,w,be),yt(he,m,be),z(m,E),z(E,j),z(E,H),z(E,O),z(m,D),z(m,J),z(J,G),Be(G,n[2]),z(J,L),z(J,R),ge||(ve=[Ue(h,"change",n[19]),Ue(h,"input",n[19]),Ue($,"change",n[20]),Ue($,"input",n[20]),Ue(j,"change",n[14],!1,!1,!1,!1),Ue(O,"click",n[21],!1,!1,!1,!1),Ue(G,"input",n[22]),Ue(R,"click",n[23],!1,!1,!1,!1)],ge=!0)},p:function(he,be){be&64&&Be(h,he[6]),be&64&&Hn(b,he[6]),be&128&&Be($,he[7]),be&128&&Hn(_,he[7]),be&4&&Be(G,he[2])},d:function(he){he&&(le(e),le(w),le(m)),ge=!1,Mi(ve)}};return dn("SvelteRegisterBlock",{block:de,id:Kl.name,type:"if",source:'(82:4) {#if mode === \\"Add Knowledge\\"}',ctx:n}),de}function Ui(n){let e,t,r,s=" James ",i,a,o=`He will remember everything you tell him and answer your questions.
      (Please let me know if I have to discipline him. He's still learning, and
      any feedback is welcome!)`,u,c,l="retrievedText",d,h,g="",f,b,y,T,k,S,x="Add Knowledge",$,A,C,_,w="Chat with your Brain",m,E,j,H,O="Forget",I,D,J,G;function L(ve,de){if(ve[0]==="Add Knowledge")return Kl;if(ve[0]==="Chat with your Brain")return Hl;if(ve[0]==="Forget")return zl}let R=L(n),F=R&&R(n);D=Xl(n[16][0]);const ge={c:function(){e=Q("div"),t=Q("div"),r=Q("h1"),r.textContent=s,i=pe(),a=Q("p"),a.textContent=o,u=pe(),c=Q("p"),c.textContent=l,d=pe(),h=Q("div"),h.innerHTML=g,f=pe(),b=Q("div"),y=Q("div"),T=Q("input"),k=pe(),S=Q("label"),S.textContent=x,$=pe(),A=Q("input"),C=pe(),_=Q("label"),_.textContent=w,m=pe(),E=Q("input"),j=pe(),H=Q("label"),H.textContent=O,I=pe(),F&&F.c(),this.h()},l:function(de){e=X(de,"DIV",{class:!0});var ye=Ae(e);t=X(ye,"DIV",{class:!0});var he=Ae(t);r=X(he,"H1",{"data-svelte-h":!0}),Pe(r)!=="svelte-la326"&&(r.textContent=s),i=me(he),a=X(he,"P",{"data-svelte-h":!0}),Pe(a)!=="svelte-1esjus8"&&(a.textContent=o),u=me(he),c=X(he,"P",{"data-svelte-h":!0}),Pe(c)!=="svelte-ndpfvj"&&(c.textContent=l),he.forEach(le),d=me(ye),h=X(ye,"DIV",{id:!0,"data-svelte-h":!0}),Pe(h)!=="svelte-vwek72"&&(h.innerHTML=g),f=me(ye),b=X(ye,"DIV",{class:!0});var be=Ae(b);y=X(be,"DIV",{class:!0});var B=Ae(y);T=X(B,"INPUT",{type:!0,id:!0}),k=me(B),S=X(B,"LABEL",{for:!0,"data-svelte-h":!0}),Pe(S)!=="svelte-112aynz"&&(S.textContent=x),$=me(B),A=X(B,"INPUT",{type:!0,id:!0}),C=me(B),_=X(B,"LABEL",{for:!0,"data-svelte-h":!0}),Pe(_)!=="svelte-41acxd"&&(_.textContent=w),m=me(B),E=X(B,"INPUT",{type:!0,id:!0}),j=me(B),H=X(B,"LABEL",{for:!0,"data-svelte-h":!0}),Pe(H)!=="svelte-1h6y6ie"&&(H.textContent=O),B.forEach(le),I=me(be),F&&F.l(be),be.forEach(le),ye.forEach(le),this.h()},h:function(){W(r,ee,107,4,1912),W(a,ee,108,4,1941),W(c,ee,113,4,2144),re(t,"class","app-header"),W(t,ee,106,2,1883),re(h,"id","displayTextContainer"),W(h,ee,115,2,2176),re(T,"type","radio"),T.__value="Add Knowledge",Be(T,T.__value),re(T,"id","add-knowledge"),W(T,ee,121,6,2420),re(S,"for","add-knowledge"),W(S,ee,127,6,2546),re(A,"type","radio"),A.__value="Chat with your Brain",Be(A,A.__value),re(A,"id","chat-with-brain"),W(A,ee,129,6,2602),re(_,"for","chat-with-brain"),W(_,ee,135,6,2737),re(E,"type","radio"),E.__value="Forget",Be(E,E.__value),re(E,"id","forget"),W(E,ee,137,6,2802),re(H,"for","forget"),W(H,ee,138,6,2876),re(y,"class","action-selection"),W(y,ee,120,4,2383),re(b,"class","app-content"),W(b,ee,118,2,2297),re(e,"class","app-container"),W(e,ee,105,0,1853),D.p(T,A,E)},m:function(de,ye){yt(de,e,ye),z(e,t),z(t,r),z(t,i),z(t,a),z(t,u),z(t,c),z(e,d),z(e,h),z(e,f),z(e,b),z(b,y),z(y,T),T.checked=T.__value===n[0],z(y,k),z(y,S),z(y,$),z(y,A),A.checked=A.__value===n[0],z(y,C),z(y,_),z(y,m),z(y,E),E.checked=E.__value===n[0],z(y,j),z(y,H),z(b,I),F&&F.m(b,null),J||(G=[Ue(T,"change",n[15]),Ue(A,"change",n[17]),Ue(E,"change",n[18])],J=!0)},p:function(de,[ye]){ye&1&&(T.checked=T.__value===de[0]),ye&1&&(A.checked=A.__value===de[0]),ye&1&&(E.checked=E.__value===de[0]),R===(R=L(de))&&F?F.p(de,ye):(F&&F.d(1),F=R&&R(de),F&&(F.c(),F.m(b,null)))},i:Ia,o:Ia,d:function(de){de&&le(e),F&&F.d(),D.r(),J=!1,Mi(G)}};return dn("SvelteRegisterBlock",{block:ge,id:Ui.name,type:"component",source:"",ctx:n}),ge}const yi="https://jqfandcxceztebtpwzxd.supabase.co",gi="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpxZmFuZGN4Y2V6dGVidHB3enhkIiwicm9sZSI6ImFub24iLCJpYXQiOjE2ODkzNzI0NzUsImV4cCI6MjAwNDk0ODQ3NX0.MXs4u_1XMM-foNe08LLYHQLENjmwTF3jqUmNXCSbOU4",bi="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",Gv="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",_u="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";function Yv(n,e,t){let r,s,i,a,{$$slots:o={},$$scope:u}=e;ed("Page",o,[]);let c,l=Sr("tiiuae/falcon-7b-instruct");wn(l,"model"),On(n,l,R=>t(8,i=R));let d=Sr(.2);wn(d,"temperature"),On(n,d,R=>t(9,a=R));let h=Sr(500);wn(h,"chunkSize"),On(n,h,R=>t(6,r=R));let g=Sr(0);wn(g,"chunkOverlap"),On(n,g,R=>t(7,s=R));let f,b,y="",T,k,S,x="";Ca(()=>{t(4,T=Gt(yi,gi));const R=Gt(yi,gi);S=new Kn({apiKey:"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"}),t(5,k=new Wt(S,{client:R,tableName:"documents"}))});async function $(R){t(1,f=R.target.files[0])}const A=[];Object.keys(e).forEach(R=>{!~A.indexOf(R)&&R.slice(0,2)!=="$$"&&R!=="slot"&&console.warn(`<Page> was created with unknown prop '${R}'`)});const C=[[]];function _(){c=this.__value,t(0,c)}function w(){c=this.__value,t(0,c)}function m(){c=this.__value,t(0,c)}function E(){r=Rs(this.value),h.set(r)}function j(){s=Rs(this.value),g.set(s)}const H=()=>Bo(T,bi,k,f);function O(){b=this.value,t(2,b)}const I=()=>Vo(T,bi,k,b);function D(){i=td(this),l.set(i)}function J(){a=Rs(this.value),d.set(a)}function G(){y=this.value,t(3,y)}const L=()=>bu(_u,k,l,d,y);return n.$capture_state=()=>({onMount:Ca,file_uploader:Bo,url_uploader:Vo,chatWithDoc:bu,brain:$i,createClient:Gt,OpenAIEmbeddings:$c,SupabaseVectorStore:Wt,writable:Sr,HuggingFaceInferenceEmbeddings:Kn,mode:c,model:l,temperature:d,chunkSize:h,chunkOverlap:g,files:f,url:b,question:y,supabase_url:yi,supabase_key:gi,openai_api_key:bi,openAIApiKey:Gv,huggingfacehub_api_token:_u,supabase:T,vector:k,embeddings:S,retrievedText:x,upload:$,$chunkSize:r,$chunkOverlap:s,$model:i,$temperature:a}),n.$inject_state=R=>{"mode"in R&&t(0,c=R.mode),"model"in R&&t(10,l=R.model),"temperature"in R&&t(11,d=R.temperature),"chunkSize"in R&&t(12,h=R.chunkSize),"chunkOverlap"in R&&t(13,g=R.chunkOverlap),"files"in R&&t(1,f=R.files),"url"in R&&t(2,b=R.url),"question"in R&&t(3,y=R.question),"supabase"in R&&t(4,T=R.supabase),"vector"in R&&t(5,k=R.vector),"embeddings"in R&&(S=R.embeddings),"retrievedText"in R&&(x=R.retrievedText)},e&&"$$inject"in e&&n.$inject_state(e.$$inject),[c,f,b,y,T,k,r,s,i,a,l,d,h,g,$,_,C,w,m,E,j,H,O,I,D,J,G,L]}class iw extends Wl{constructor(e){super(e),Ql(this,e,Yv,Ui,Gl,{}),dn("SvelteRegisterComponent",{component:this,tagName:"Page",options:e,id:Ui.name})}}export{Xu as A,gn as B,Nt as C,Qu as H,Ge as L,De as P,Wu as R,np as S,Jv as a,ig as b,Zv as c,Ti as d,sg as e,eg as f,Ce as g,sw as h,Yu as i,Bg as j,Gg as k,Cb as l,zc as m,Vc as n,nw as o,iw as p,Kc as r,Zb as z};
