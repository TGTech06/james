var je=Object.defineProperty;var Ve=(r,e,t)=>e in r?je(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var M=(r,e,t)=>(Ve(r,typeof e!="symbol"?e+"":e,t),t);import{g as he,c as Z,P as ee,a as te}from"./public.8bae8052.js";import{s as de,o as re,b as ne,e as Le,d as w,n as R,u as De,g as $e,f as ze}from"./scheduler.98e03797.js";import{S as pe,i as me,d as j,v as ye,e as se,a as $,r as Be,t as Q,b as Ue,f as K,g as x,j as E,s as V,k as C,l as S,A as P,c as L,m as _,z as b}from"./index.e99f61eb.js";import{g as Je}from"./globals.7f7f1b26.js";class ie{constructor(e){Object.defineProperty(this,"pageContent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.pageContent=e.pageContent?e.pageContent.toString():this.pageContent,this.metadata=e.metadata??{}}}var z={exports:{}},_e={};function O(r,e){typeof e=="boolean"&&(e={forever:e}),this._originalTimeouts=JSON.parse(JSON.stringify(r)),this._timeouts=r,this._options=e||{},this._maxRetryTime=e&&e.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}var Me=O;O.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)};O.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null};O.prototype.retry=function(r){if(this._timeout&&clearTimeout(this._timeout),!r)return!1;var e=new Date().getTime();if(r&&e-this._operationStart>=this._maxRetryTime)return this._errors.push(r),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(r);var t=this._timeouts.shift();if(t===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),t=this._cachedTimeouts.slice(-1);else return!1;var n=this;return this._timer=setTimeout(function(){n._attempts++,n._operationTimeoutCb&&(n._timeout=setTimeout(function(){n._operationTimeoutCb(n._attempts)},n._operationTimeout),n._options.unref&&n._timeout.unref()),n._fn(n._attempts)},t),this._options.unref&&this._timer.unref(),!0};O.prototype.attempt=function(r,e){this._fn=r,e&&(e.timeout&&(this._operationTimeout=e.timeout),e.cb&&(this._operationTimeoutCb=e.cb));var t=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){t._operationTimeoutCb()},t._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};O.prototype.try=function(r){console.log("Using RetryOperation.try() is deprecated"),this.attempt(r)};O.prototype.start=function(r){console.log("Using RetryOperation.start() is deprecated"),this.attempt(r)};O.prototype.start=O.prototype.try;O.prototype.errors=function(){return this._errors};O.prototype.attempts=function(){return this._attempts};O.prototype.mainError=function(){if(this._errors.length===0)return null;for(var r={},e=null,t=0,n=0;n<this._errors.length;n++){var s=this._errors[n],i=s.message,a=(r[i]||0)+1;r[i]=a,a>=t&&(e=s,t=a)}return e};(function(r){var e=Me;r.operation=function(t){var n=r.timeouts(t);return new e(n,{forever:t&&(t.forever||t.retries===1/0),unref:t&&t.unref,maxRetryTime:t&&t.maxRetryTime})},r.timeouts=function(t){if(t instanceof Array)return[].concat(t);var n={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var s in t)n[s]=t[s];if(n.minTimeout>n.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var i=[],a=0;a<n.retries;a++)i.push(this.createTimeout(a,n));return t&&t.forever&&!i.length&&i.push(this.createTimeout(a,n)),i.sort(function(o,l){return o-l}),i},r.createTimeout=function(t,n){var s=n.randomize?Math.random()+1:1,i=Math.round(s*Math.max(n.minTimeout,1)*Math.pow(n.factor,t));return i=Math.min(i,n.maxTimeout),i},r.wrap=function(t,n,s){if(n instanceof Array&&(s=n,n=null),!s){s=[];for(var i in t)typeof t[i]=="function"&&s.push(i)}for(var a=0;a<s.length;a++){var o=s[a],l=t[o];t[o]=(function(c){var f=r.operation(n),p=Array.prototype.slice.call(arguments,1),m=p.pop();p.push(function(d){f.retry(d)||(d&&(arguments[0]=f.mainError()),m.apply(this,arguments))}),f.attempt(function(){c.apply(t,p)})}).bind(t,l),t[o].options=n}}})(_e);var Fe=_e;const We=Fe,Qe=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"];class ve extends Error{constructor(e){super(),e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}}const Ke=(r,e,t)=>{const n=t.retries-(e-1);return r.attemptNumber=e,r.retriesLeft=n,r},Xe=r=>Qe.includes(r),ge=(r,e)=>new Promise((t,n)=>{e={onFailedAttempt:()=>{},retries:10,...e};const s=We.operation(e);s.attempt(async i=>{try{t(await r(i))}catch(a){if(!(a instanceof Error)){n(new TypeError(`Non-error was thrown: "${a}". You should only throw errors.`));return}if(a instanceof ve)s.stop(),n(a.originalError);else if(a instanceof TypeError&&!Xe(a.message))s.stop(),n(a);else{Ke(a,i,e);try{await e.onFailedAttempt(a)}catch(o){n(o);return}s.retry(a)||n(s.mainError())}}})});z.exports=ge;z.exports.default=ge;z.exports.AbortError=ve;var He=z.exports;const Ge=he(He);var be={},we={exports:{}};(function(r){var e=Object.prototype.hasOwnProperty,t="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(t=!1));function s(l,u,c){this.fn=l,this.context=u,this.once=c||!1}function i(l,u,c,f,p){if(typeof c!="function")throw new TypeError("The listener must be a function");var m=new s(c,f||l,p),d=t?t+u:u;return l._events[d]?l._events[d].fn?l._events[d]=[l._events[d],m]:l._events[d].push(m):(l._events[d]=m,l._eventsCount++),l}function a(l,u){--l._eventsCount===0?l._events=new n:delete l._events[u]}function o(){this._events=new n,this._eventsCount=0}o.prototype.eventNames=function(){var u=[],c,f;if(this._eventsCount===0)return u;for(f in c=this._events)e.call(c,f)&&u.push(t?f.slice(1):f);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(c)):u},o.prototype.listeners=function(u){var c=t?t+u:u,f=this._events[c];if(!f)return[];if(f.fn)return[f.fn];for(var p=0,m=f.length,d=new Array(m);p<m;p++)d[p]=f[p].fn;return d},o.prototype.listenerCount=function(u){var c=t?t+u:u,f=this._events[c];return f?f.fn?1:f.length:0},o.prototype.emit=function(u,c,f,p,m,d){var g=t?t+u:u;if(!this._events[g])return!1;var h=this._events[g],v=arguments.length,A,y;if(h.fn){switch(h.once&&this.removeListener(u,h.fn,void 0,!0),v){case 1:return h.fn.call(h.context),!0;case 2:return h.fn.call(h.context,c),!0;case 3:return h.fn.call(h.context,c,f),!0;case 4:return h.fn.call(h.context,c,f,p),!0;case 5:return h.fn.call(h.context,c,f,p,m),!0;case 6:return h.fn.call(h.context,c,f,p,m,d),!0}for(y=1,A=new Array(v-1);y<v;y++)A[y-1]=arguments[y];h.fn.apply(h.context,A)}else{var q=h.length,T;for(y=0;y<q;y++)switch(h[y].once&&this.removeListener(u,h[y].fn,void 0,!0),v){case 1:h[y].fn.call(h[y].context);break;case 2:h[y].fn.call(h[y].context,c);break;case 3:h[y].fn.call(h[y].context,c,f);break;case 4:h[y].fn.call(h[y].context,c,f,p);break;default:if(!A)for(T=1,A=new Array(v-1);T<v;T++)A[T-1]=arguments[T];h[y].fn.apply(h[y].context,A)}}return!0},o.prototype.on=function(u,c,f){return i(this,u,c,f,!1)},o.prototype.once=function(u,c,f){return i(this,u,c,f,!0)},o.prototype.removeListener=function(u,c,f,p){var m=t?t+u:u;if(!this._events[m])return this;if(!c)return a(this,m),this;var d=this._events[m];if(d.fn)d.fn===c&&(!p||d.once)&&(!f||d.context===f)&&a(this,m);else{for(var g=0,h=[],v=d.length;g<v;g++)(d[g].fn!==c||p&&!d[g].once||f&&d[g].context!==f)&&h.push(d[g]);h.length?this._events[m]=h.length===1?h[0]:h:a(this,m)}return this},o.prototype.removeAllListeners=function(u){var c;return u?(c=t?t+u:u,this._events[c]&&a(this,c)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=t,o.EventEmitter=o,r.exports=o})(we);var Ye=we.exports,B={exports:{}},Ze=(r,e)=>(e=e||(()=>{}),r.then(t=>new Promise(n=>{n(e())}).then(()=>t),t=>new Promise(n=>{n(e())}).then(()=>{throw t})));const et=Ze;class Ee extends Error{constructor(e){super(e),this.name="TimeoutError"}}const Ce=(r,e,t)=>new Promise((n,s)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===1/0){n(r);return}const i=setTimeout(()=>{if(typeof t=="function"){try{n(t())}catch(l){s(l)}return}const a=typeof t=="string"?t:`Promise timed out after ${e} milliseconds`,o=t instanceof Error?t:new Ee(a);typeof r.cancel=="function"&&r.cancel(),s(o)},e);et(r.then(n,s),()=>{clearTimeout(i)})});B.exports=Ce;B.exports.default=Ce;B.exports.TimeoutError=Ee;var tt=B.exports,G={},Y={};Object.defineProperty(Y,"__esModule",{value:!0});function rt(r,e,t){let n=0,s=r.length;for(;s>0;){const i=s/2|0;let a=n+i;t(r[a],e)<=0?(n=++a,s-=i+1):s=i}return n}Y.default=rt;Object.defineProperty(G,"__esModule",{value:!0});const nt=Y;class st{constructor(){this._queue=[]}enqueue(e,t){t=Object.assign({priority:0},t);const n={priority:t.priority,run:e};if(this.size&&this._queue[this.size-1].priority>=t.priority){this._queue.push(n);return}const s=nt.default(this._queue,n,(i,a)=>a.priority-i.priority);this._queue.splice(s,0,n)}dequeue(){const e=this._queue.shift();return e==null?void 0:e.run}filter(e){return this._queue.filter(t=>t.priority===e.priority).map(t=>t.run)}get size(){return this._queue.length}}G.default=st;Object.defineProperty(be,"__esModule",{value:!0});const it=Ye,Ae=tt,at=G,D=()=>{},ot=new Ae.TimeoutError;class ut extends it{constructor(e){var t,n,s,i;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=D,this._resolveIdle=D,e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:at.default},e),!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(n=(t=e.intervalCap)===null||t===void 0?void 0:t.toString())!==null&&n!==void 0?n:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(i=(s=e.interval)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||e.interval===0,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=e.throwOnTimeout===!0,this._isPaused=e.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=D,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=D,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){const e=Date.now();if(this._intervalId===void 0){const t=this._intervalEnd-e;if(t<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},t)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){const t=this._queue.dequeue();return t?(this.emit("active"),t(),e&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,t={}){return new Promise((n,s)=>{const i=async()=>{this._pendingCount++,this._intervalCount++;try{const a=this._timeout===void 0&&t.timeout===void 0?e():Ae.default(Promise.resolve(e()),t.timeout===void 0?this._timeout:t.timeout,()=>{(t.throwOnTimeout===void 0?this._throwOnTimeout:t.throwOnTimeout)&&s(ot)});n(await a)}catch(a){s(a)}this._next()};this._queue.enqueue(i,t),this._tryToStartAnother(),this.emit("add")})}async addAll(e,t){return Promise.all(e.map(async n=>this.add(n,t)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(e=>{const t=this._resolveEmpty;this._resolveEmpty=()=>{t(),e()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(e=>{const t=this._resolveIdle;this._resolveIdle=()=>{t(),e()}})}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}}var F=be.default=ut;const ct=[400,401,403,404,405,406,407,408,409];class lt{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6;const t="default"in F?F.default:F;this.queue=new t({concurrency:this.maxConcurrency})}call(e,...t){return this.queue.add(()=>Ge(()=>e(...t).catch(n=>{throw n instanceof Error?n:new Error(n)}),{onFailedAttempt(n){var a,o,l,u;if(n.message.startsWith("Cancel")||n.message.startsWith("TimeoutError")||n.message.startsWith("AbortError")||(n==null?void 0:n.code)==="ECONNABORTED")throw n;const s=(a=n==null?void 0:n.response)==null?void 0:a.status;if(s&&ct.includes(+s))throw n;const i=(o=n==null?void 0:n.response)==null?void 0:o.data;if(((l=i==null?void 0:i.error)==null?void 0:l.code)==="insufficient_quota"){const c=new Error((u=i==null?void 0:i.error)==null?void 0:u.message);throw c.name="InsufficientQuotaError",c}},retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,t,...n){return e.signal?Promise.race([this.call(t,...n),new Promise((s,i)=>{var a;(a=e.signal)==null||a.addEventListener("abort",()=>{i(new Error("AbortError"))})})]):this.call(t,...n)}fetch(...e){return this.call(()=>fetch(...e).then(t=>t.ok?t:Promise.reject(t)))}}var ft=function(r,e){if(typeof r!="string")throw new TypeError("Expected a string");return e=typeof e>"u"?"_":e,r.replace(/([a-z\d])([A-Z])/g,"$1"+e+"$2").replace(/([A-Z]+)([A-Z][a-z\d]+)/g,"$1"+e+"$2").toLowerCase()};const ht=he(ft);var xe={exports:{}};const dt=/[\p{Lu}]/u,pt=/[\p{Ll}]/u,ae=/^[\p{Lu}](?![\p{Lu}])/gu,Oe=/([\p{Alpha}\p{N}_]|$)/u,Te=/[_.\- ]+/,mt=new RegExp("^"+Te.source),oe=new RegExp(Te.source+Oe.source,"gu"),ue=new RegExp("\\d+"+Oe.source,"gu"),yt=(r,e,t)=>{let n=!1,s=!1,i=!1;for(let a=0;a<r.length;a++){const o=r[a];n&&dt.test(o)?(r=r.slice(0,a)+"-"+r.slice(a),n=!1,i=s,s=!0,a++):s&&i&&pt.test(o)?(r=r.slice(0,a-1)+"-"+r.slice(a-1),i=s,s=!1,n=!0):(n=e(o)===o&&t(o)!==o,i=s,s=t(o)===o&&e(o)!==o)}return r},_t=(r,e)=>(ae.lastIndex=0,r.replace(ae,t=>e(t))),vt=(r,e)=>(oe.lastIndex=0,ue.lastIndex=0,r.replace(oe,(t,n)=>e(n)).replace(ue,t=>e(t))),Ie=(r,e)=>{if(!(typeof r=="string"||Array.isArray(r)))throw new TypeError("Expected the input to be `string | string[]`");if(e={pascalCase:!1,preserveConsecutiveUppercase:!1,...e},Array.isArray(r)?r=r.map(i=>i.trim()).filter(i=>i.length).join("-"):r=r.trim(),r.length===0)return"";const t=e.locale===!1?i=>i.toLowerCase():i=>i.toLocaleLowerCase(e.locale),n=e.locale===!1?i=>i.toUpperCase():i=>i.toLocaleUpperCase(e.locale);return r.length===1?e.pascalCase?n(r):t(r):(r!==t(r)&&(r=yt(r,t,n)),r=r.replace(mt,""),e.preserveConsecutiveUppercase?r=_t(r,t):r=t(r),e.pascalCase&&(r=n(r.charAt(0))+r.slice(1)),vt(r,n))};xe.exports=Ie;xe.exports.default=Ie;function gt(r,e){return(e==null?void 0:e[r])||ht(r)}function bt(r,e,t){const n={};for(const s in r)Object.hasOwn(r,s)&&(n[e(s,t)]=r[s]);return n}function ce(r){return Array.isArray(r)?[...r]:{...r}}function wt(r,e){const t=ce(r);for(const[n,s]of Object.entries(e)){const[i,...a]=n.split(".").reverse();let o=t;for(const l of a.reverse()){if(o[l]===void 0)break;o[l]=ce(o[l]),o=o[l]}o[i]!==void 0&&(o[i]={lc:1,type:"secret",id:[s]})}return t}class U{get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}constructor(e,...t){Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.lc_kwargs=e||{}}toJSON(){if(!this.lc_serializable)return this.toJSONNotImplemented();if(this.lc_kwargs instanceof U||typeof this.lc_kwargs!="object"||Array.isArray(this.lc_kwargs))return this.toJSONNotImplemented();const e={},t={},n=Object.keys(this.lc_kwargs).reduce((s,i)=>(s[i]=i in this?this[i]:this.lc_kwargs[i],s),{});for(let s=Object.getPrototypeOf(this);s;s=Object.getPrototypeOf(s))Object.assign(e,Reflect.get(s,"lc_aliases",this)),Object.assign(t,Reflect.get(s,"lc_secrets",this)),Object.assign(n,Reflect.get(s,"lc_attributes",this));for(const s in t)s in this&&this[s]!==void 0&&(n[s]=this[s]||n[s]);return{lc:1,type:"constructor",id:[...this.lc_namespace,this.constructor.name],kwargs:bt(Object.keys(t).length?wt(n,t):n,gt,e)}}toJSONNotImplemented(){return{lc:1,type:"not_implemented",id:[...this.lc_namespace,this.constructor.name]}}}function le(r){return Array.isArray(r)?r:[r]}function Et(r){let e,t,n,s=!1;return function(a){e===void 0?(e=a,t=0,n=-1):e=At(e,a);const o=e.length;let l=0;for(;t<o;){s&&(e[t]===10&&(l=++t),s=!1);let u=-1;for(;t<o&&u===-1;++t)switch(e[t]){case 58:n===-1&&(n=t-l);break;case 13:s=!0;case 10:u=t;break}if(u===-1)break;r(e.subarray(l,u),n),l=t,n=-1}l===o?e=void 0:l!==0&&(e=e.subarray(l),t-=l)}}function Ct(r,e,t){let n=fe();const s=new TextDecoder;return function(a,o){if(a.length===0)t==null||t(n),n=fe();else if(o>0){const l=s.decode(a.subarray(0,o)),u=o+(a[o+1]===32?2:1),c=s.decode(a.subarray(u));switch(l){case"data":n.data=n.data?n.data+`
`+c:c;break;case"event":n.event=c;break;case"id":r(n.id=c);break;case"retry":const f=parseInt(c,10);isNaN(f)||e(n.retry=f);break}}}}function At(r,e){const t=new Uint8Array(r.length+e.length);return t.set(r),t.set(e,r.length),t}function fe(){return{data:"",event:"",id:"",retry:void 0}}var xt="https://api-inference.huggingface.co/models/",Se=(r=>(r.Length="length",r.EndOfSequenceToken="eos_token",r.StopSequence="stop_sequence",r))(Se||{}),ke=class{constructor(r="",e={}){M(this,"apiKey");M(this,"defaultOptions");this.apiKey=r,this.defaultOptions=e}async fillMask(r,e){const t=await this.request(r,e);if(!(Array.isArray(t)&&t.every(s=>typeof s.score=="number"&&typeof s.sequence=="string"&&typeof s.token=="number"&&typeof s.token_str=="string")))throw new TypeError("Invalid inference output: output must be of type Array<score: number, sequence:string, token:number, token_str:string>");return t}async summarization(r,e){const t=await this.request(r,e);if(!(Array.isArray(t)&&t.every(s=>typeof s.summary_text=="string")))throw new TypeError("Invalid inference output: output must be of type Array<summary_text: string>");return t==null?void 0:t[0]}async questionAnswer(r,e){const t=await this.request(r,e);if(!(typeof t.answer=="string"&&typeof t.end=="number"&&typeof t.score=="number"&&typeof t.start=="number"))throw new TypeError("Invalid inference output: output must be of type <answer: string, end: number, score: number, start: number>");return t}async tableQuestionAnswer(r,e){const t=await this.request(r,e);if(!(typeof t.aggregator=="string"&&typeof t.answer=="string"&&Array.isArray(t.cells)&&t.cells.every(s=>typeof s=="string")&&Array.isArray(t.coordinates)&&t.coordinates.every(s=>Array.isArray(s)&&s.every(i=>typeof i=="number"))))throw new TypeError("Invalid inference output: output must be of type <aggregator: string, answer: string, cells: string[], coordinates: number[][]>");return t}async textClassification(r,e){var s;const t=(s=await this.request(r,e))==null?void 0:s[0];if(!(Array.isArray(t)&&t.every(i=>typeof i.label=="string"&&typeof i.score=="number")))throw new TypeError("Invalid inference output: output must be of type Array<label: string, score: number>");return t}async textGeneration(r,e){const t=await this.request(r,e);if(!(Array.isArray(t)&&t.every(s=>typeof s.generated_text=="string")))throw new TypeError("Invalid inference output: output must be of type Array<generated_text: string>");return t==null?void 0:t[0]}async*textGenerationStream(r,e){yield*this.streamingRequest(r,e)}async tokenClassification(r,e){const t=le(await this.request(r,e));if(!(Array.isArray(t)&&t.every(s=>typeof s.end=="number"&&typeof s.entity_group=="string"&&typeof s.score=="number"&&typeof s.start=="number"&&typeof s.word=="string")))throw new TypeError("Invalid inference output: output must be of type Array<end: number, entity_group: string, score: number, start: number, word: string>");return t}async translation(r,e){const t=await this.request(r,e);if(!(Array.isArray(t)&&t.every(s=>typeof s.translation_text=="string")))throw new TypeError("Invalid inference output: output must be of type Array<translation_text: string>");return t==null?void 0:t[0]}async zeroShotClassification(r,e){const t=le(await this.request(r,e));if(!(Array.isArray(t)&&t.every(s=>Array.isArray(s.labels)&&s.labels.every(i=>typeof i=="string")&&Array.isArray(s.scores)&&s.scores.every(i=>typeof i=="number")&&typeof s.sequence=="string")))throw new TypeError("Invalid inference output: output must be of type Array<labels: string[], scores: number[], sequence: string>");return t}async conversational(r,e){const t=await this.request(r,e);if(!(Array.isArray(t.conversation.generated_responses)&&t.conversation.generated_responses.every(s=>typeof s=="string")&&Array.isArray(t.conversation.past_user_inputs)&&t.conversation.past_user_inputs.every(s=>typeof s=="string")&&typeof t.generated_text=="string"&&Array.isArray(t.warnings)&&t.warnings.every(s=>typeof s=="string")))throw new TypeError("Invalid inference output: output must be of type <conversation: {generated_responses: string[], past_user_inputs: string[]}, generated_text: string, warnings: string[]>");return t}async featureExtraction(r,e){return await this.request(r,e)}async automaticSpeechRecognition(r,e){const t=await this.request(r,{...e,binary:!0});if(!(typeof t.text=="string"))throw new TypeError("Invalid inference output: output must be of type <text: string>");return t}async audioClassification(r,e){const t=await this.request(r,{...e,binary:!0});if(!(Array.isArray(t)&&t.every(s=>typeof s.label=="string"&&typeof s.score=="number")))throw new TypeError("Invalid inference output: output must be of type Array<label: string, score: number>");return t}async imageClassification(r,e){const t=await this.request(r,{...e,binary:!0});if(!(Array.isArray(t)&&t.every(s=>typeof s.label=="string"&&typeof s.score=="number")))throw new TypeError("Invalid inference output: output must be of type Array<label: string, score: number>");return t}async objectDetection(r,e){const t=await this.request(r,{...e,binary:!0});if(!(Array.isArray(t)&&t.every(s=>typeof s.label=="string"&&typeof s.score=="number"&&typeof s.box.xmin=="number"&&typeof s.box.ymin=="number"&&typeof s.box.xmax=="number"&&typeof s.box.ymax=="number")))throw new TypeError("Invalid inference output: output must be of type Array<{label:string; score:number; box:{xmin:number; ymin:number; xmax:number; ymax:number}}>");return t}async imageSegmentation(r,e){const t=await this.request(r,{...e,binary:!0});if(!(Array.isArray(t)&&t.every(s=>typeof s.label=="string"&&typeof s.mask=="string"&&typeof s.score=="number")))throw new TypeError("Invalid inference output: output must be of type Array<label: string, mask: string, score: number>");return t}async textToImage(r,e){const t=await this.request(r,{...e,blob:!0});if(!(t&&t instanceof Blob))throw new TypeError("Invalid inference output: output must be of type object & of instance Blob");return t}async imageToText(r,e){var t;return(t=await this.request(r,{...e,binary:!0}))==null?void 0:t[0]}makeRequestOptions(r,e){const t={...this.defaultOptions,...e},{model:n,...s}=r,i={};this.apiKey&&(i.Authorization=`Bearer ${this.apiKey}`),e!=null&&e.binary||(i["Content-Type"]="application/json"),e!=null&&e.binary&&(t.wait_for_model&&(i["X-Wait-For-Model"]="true"),t.use_cache===!1&&(i["X-Use-Cache"]="false"),t.dont_load_model&&(i["X-Load-Model"]="0"));const a=`${xt}${n}`,o={headers:i,method:"POST",body:e!=null&&e.binary?r.data:JSON.stringify({...s,options:t}),credentials:e!=null&&e.includeCredentials?"include":"same-origin"};return{url:a,info:o,mergedOptions:t}}async request(r,e){const{url:t,info:n,mergedOptions:s}=this.makeRequestOptions(r,e),i=await fetch(t,n);if(s.retry_on_error!==!1&&i.status===503&&!s.wait_for_model)return this.request(r,{...s,wait_for_model:!0});if(e!=null&&e.blob){if(!i.ok)throw new Error("An error occurred while fetching the blob");return await i.blob()}const a=await i.json();if(a.error)throw new Error(a.error);return a}async*streamingRequest(r,e){var c;const{url:t,info:n,mergedOptions:s}=this.makeRequestOptions({...r,stream:!0},e),i=await fetch(t,n);if(s.retry_on_error!==!1&&i.status===503&&!s.wait_for_model)return this.streamingRequest(r,{...s,wait_for_model:!0});if(!i.ok){if((c=i.headers.get("Content-Type"))!=null&&c.startsWith("application/json")){const f=await i.json();if(f.error)throw new Error(f.error)}throw new Error(`Server response contains error: ${i.status}`)}if(i.headers.get("content-type")!=="text/event-stream")throw new Error("Server does not support event stream content type, it returned "+i.headers.get("content-type"));if(!i.body)return;const a=i.body.getReader();let o=[];const u=Et(Ct(()=>{},()=>{},f=>{o.push(f)}));try{for(;;){const{done:f,value:p}=await a.read();if(f)return;u(p);for(const m of o)m.data.length>0&&(yield JSON.parse(m.data));o=[]}}finally{a.releaseLock()}}};const Mt=Object.freeze(Object.defineProperty({__proto__:null,HfInference:ke,TextGenerationStreamFinishReason:Se},Symbol.toStringTag,{value:"Module"}));class Ot{constructor(e){Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.caller=new lt(e??{})}}const Tt=()=>typeof window<"u"&&typeof window.document<"u",It=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",St=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom")),Pe=()=>typeof Deno<"u",kt=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!Pe(),Pt=()=>{let r;return Tt()?r="browser":kt()?r="node":It()?r="webworker":St()?r="jsdom":Pe()?r="deno":r="other",r};let W;async function Ft(){return W===void 0&&(W={library:"langchain-js",runtime:Pt()}),W}function qt(r){var e;try{return typeof process<"u"?(e=process.env)==null?void 0:e[r]:void 0}catch{return}}class Wt extends Ot{constructor(e){super(e??{}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.model=(e==null?void 0:e.model)??"sentence-transformers/distilbert-base-nli-mean-tokens",this.apiKey=(e==null?void 0:e.apiKey)??qt("HUGGINGFACEHUB_API_KEY"),this.client=new ke(this.apiKey)}async _embed(e){const t=e.map(n=>n.replace(/\n/g," "));return this.caller.call(()=>this.client.featureExtraction({model:this.model,inputs:t}))}embedQuery(e){return this._embed([e]).then(t=>t[0])}embedDocuments(e){return this._embed(e)}}const Qt="__run";class J extends U{get text(){return this.content}constructor(e,t){typeof e=="string"&&(e={content:e,additional_kwargs:t}),e.additional_kwargs||(e.additional_kwargs={}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","schema"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"content",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"additional_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.content=e.content,this.additional_kwargs=e.additional_kwargs}toDict(){return{type:this._getType(),data:this.toJSON().kwargs}}}class Kt extends J{_getType(){return"human"}}class Xt extends J{_getType(){return"ai"}}class Ht extends J{_getType(){return"system"}}class Gt extends J{constructor(e,t){typeof e=="string"&&(e={content:e,role:t}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}_getType(){return"generic"}}class Yt extends U{}class Nt{}class Zt{}class Rt extends Nt{constructor(e){super(),Object.defineProperty(this,"vectorStore",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"k",{enumerable:!0,configurable:!0,writable:!0,value:4}),Object.defineProperty(this,"filter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.vectorStore=e.vectorStore,this.k=e.k??this.k,this.filter=e.filter}async getRelevantDocuments(e){return await this.vectorStore.similaritySearch(e,this.k,this.filter)}async addDocuments(e,t){return this.vectorStore.addDocuments(e,t)}}class jt{constructor(e,t){Object.defineProperty(this,"embeddings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.embeddings=e}async delete(e){throw new Error("Not implemented.")}async similaritySearch(e,t=4,n=void 0){return(await this.similaritySearchVectorWithScore(await this.embeddings.embedQuery(e),t,n)).map(i=>i[0])}async similaritySearchWithScore(e,t=4,n=void 0){return this.similaritySearchVectorWithScore(await this.embeddings.embedQuery(e),t,n)}static fromTexts(e,t,n,s){throw new Error("the Langchain vectorstore implementation you are using forgot to override this, please report a bug")}static fromDocuments(e,t,n){throw new Error("the Langchain vectorstore implementation you are using forgot to override this, please report a bug")}asRetriever(e,t){return new Rt({vectorStore:this,k:e,filter:t})}}class qe extends jt{constructor(e,t){super(e,t),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tableName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queryName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.client=t.client,this.tableName=t.tableName||"documents",this.queryName=t.queryName||"match_documents",this.filter=t.filter}async addDocuments(e,t){const n=e.map(({pageContent:s})=>s);return this.addVectors(await this.embeddings.embedDocuments(n),e,t)}async addVectors(e,t,n){const s=e.map((o,l)=>({content:t[l].pageContent,embedding:o,metadata:t[l].metadata})),i=500;let a=[];for(let o=0;o<s.length;o+=i){const l=s.slice(o,o+i).map(c=>n!=null&&n.ids?{id:n.ids[o],...c}:c),u=await this.client.from(this.tableName).upsert(l).select();if(u.error)throw new Error(`Error inserting: ${u.error.message} ${u.status} ${u.statusText}`);u.data&&(a=a.concat(u.data.map(c=>c.id)))}return a}async delete(e){const{ids:t}=e;for(const n of t)await this.client.from(this.tableName).delete().eq("id",n)}async similaritySearchVectorWithScore(e,t,n){if(n&&this.filter)throw new Error("cannot provide both `filter` and `this.filter`");const s=n??this.filter??{},i={query_embedding:e};let a;if(typeof s=="function")a=f=>s(f).limit(t);else if(typeof s=="object")i.filter=s,i.match_count=t,a=f=>f;else throw new Error("invalid filter type");const o=this.client.rpc(this.queryName,i),{data:l,error:u}=await a(o);if(u)throw new Error(`Error searching for documents: ${u.code} ${u.message} ${u.details}`);return l.map(f=>[new ie({metadata:f.metadata,pageContent:f.content}),f.similarity])}static async fromTexts(e,t,n,s){const i=[];for(let a=0;a<e.length;a+=1){const o=Array.isArray(t)?t[a]:t,l=new ie({pageContent:e[a],metadata:o});i.push(l)}return qe.fromDocuments(i,n,s)}static async fromDocuments(e,t,n){const s=new this(t,n);return await s.addDocuments(e),s}static async fromExistingIndex(e,t){return new this(e,t)}}const{console:Vt}=Je,k="src/lib/AuthCheck.svelte";function Ne(r){let e,t,n,s="You must be signed in to view this page.",i,a,o,l="Login",u,c,f="Register";const p={c:function(){e=E("div"),t=E("div"),n=E("p"),n.textContent=s,i=V(),a=E("div"),o=E("a"),o.textContent=l,u=V(),c=E("a"),c.textContent=f,this.h()},l:function(d){e=C(d,"DIV",{id:!0});var g=S(e);t=C(g,"DIV",{class:!0});var h=S(t);n=C(h,"P",{class:!0,"data-svelte-h":!0}),P(n)!=="svelte-1qn0ppa"&&(n.textContent=s),i=L(h),a=C(h,"DIV",{class:!0});var v=S(a);o=C(v,"A",{href:!0,class:!0,"data-svelte-h":!0}),P(o)!=="svelte-wpey69"&&(o.textContent=l),u=L(v),c=C(v,"A",{href:!0,class:!0,"data-svelte-h":!0}),P(c)!=="svelte-129aygp"&&(c.textContent=f),v.forEach(x),h.forEach(x),g.forEach(x),this.h()},h:function(){_(n,"class","auth-message s-NSJxguceXFrJ"),w(n,k,43,6,957),_(o,"href","/login"),_(o,"class","auth-button auth-button-primary s-NSJxguceXFrJ"),w(o,k,45,8,1067),_(c,"href","/register"),_(c,"class","auth-button auth-button-secondary s-NSJxguceXFrJ"),w(c,k,46,8,1142),_(a,"class","auth-buttons s-NSJxguceXFrJ"),w(a,k,44,6,1032),_(t,"class","auth-container s-NSJxguceXFrJ"),w(t,k,42,4,922),_(e,"id","error-message"),w(e,k,40,2,831)},m:function(d,g){$(d,e,g),b(e,t),b(t,n),b(t,i),b(t,a),b(a,o),b(a,u),b(a,c)},p:R,i:R,o:R,d:function(d){d&&x(e)}};return j("SvelteRegisterBlock",{block:p,id:Ne.name,type:"else",source:"(30:0) {:else}",ctx:r}),p}function Re(r){let e,t;const n=r[2].default,s=Le(n,r,r[1],null),i={c:function(){e=E("div"),s&&s.c(),this.h()},l:function(o){e=C(o,"DIV",{id:!0});var l=S(e);s&&s.l(l),l.forEach(x),this.h()},h:function(){_(e,"id","content"),w(e,k,35,2,717)},m:function(o,l){$(o,e,l),s&&s.m(e,null),t=!0},p:function(o,l){s&&s.p&&(!t||l&2)&&De(s,n,o,o[1],t?ze(n,o[1],l,null):$e(o[1]),null)},i:function(o){t||(K(s,o),t=!0)},o:function(o){Q(s,o),t=!1},d:function(o){o&&x(e),s&&s.d(o)}};return j("SvelteRegisterBlock",{block:i,id:Re.name,type:"if",source:"(25:0) {#if isLoggedIn}",ctx:r}),i}function X(r){let e,t,n,s;const i=[Re,Ne],a=[];function o(u,c){return u[0]?0:1}e=o(r),t=a[e]=i[e](r);const l={c:function(){t.c(),n=se()},l:function(c){t.l(c),n=se()},m:function(c,f){a[e].m(c,f),$(c,n,f),s=!0},p:function(c,[f]){let p=e;e=o(c),e===p?a[e].p(c,f):(Be(),Q(a[p],1,1,()=>{a[p]=null}),Ue(),t=a[e],t?t.p(c,f):(t=a[e]=i[e](c),t.c()),K(t,1),t.m(n.parentNode,n))},i:function(c){s||(K(t),s=!0)},o:function(c){Q(t),s=!1},d:function(c){c&&x(n),a[e].d(c)}};return j("SvelteRegisterBlock",{block:l,id:X.name,type:"component",source:"",ctx:r}),l}function Lt(r,e,t){let{$$slots:n={},$$scope:s}=e;ye("AuthCheck",n,["default"]);const i=Z(te,ee);let a=!0;const o=async()=>{const{data:{session:u},error:c}=await i.auth.getSession();c?console.log(c):u!=null&&u.user?t(0,a=!0):t(0,a=!1)};re(()=>{o()}),ne("isLoggedIn",a);const l=[];return Object.keys(e).forEach(u=>{!~l.indexOf(u)&&u.slice(0,2)!=="$$"&&u!=="slot"&&Vt.warn(`<AuthCheck> was created with unknown prop '${u}'`)}),r.$$set=u=>{"$$scope"in u&&t(1,s=u.$$scope)},r.$capture_state=()=>({createClient:Z,PUBLIC_SUPABASE_KEY:ee,PUBLIC_SUPABASE_URL:te,onMount:re,setContext:ne,supabaseClient:i,isLoggedIn:a,loadContent:o}),r.$inject_state=u=>{"isLoggedIn"in u&&t(0,a=u.isLoggedIn)},e&&"$$inject"in e&&r.$inject_state(e.$$inject),[a,s,n]}class er extends pe{constructor(e){super(e),me(this,e,Lt,X,de,{}),j("SvelteRegisterComponent",{component:this,tagName:"AuthCheck",options:e,id:X.name})}}const I="src/lib/NavBar.svelte";function H(r){let e,t,n,s,i="James ðŸ§ ðŸ§ ",a,o,l,u="Upload Data",c,f,p="Chat with James",m,d,g="Profile";const h={c:function(){e=E("nav"),t=E("div"),n=E("div"),s=E("a"),s.textContent=i,a=V(),o=E("div"),l=E("a"),l.textContent=u,c=V(),f=E("a"),f.textContent=p,m=V(),d=E("a"),d.textContent=g,this.h()},l:function(A){e=C(A,"NAV",{class:!0});var y=S(e);t=C(y,"DIV",{class:!0});var q=S(t);n=C(q,"DIV",{class:!0});var T=S(n);s=C(T,"A",{href:!0,class:!0,"data-svelte-h":!0}),P(s)!=="svelte-navb93"&&(s.textContent=i),T.forEach(x),a=L(q),o=C(q,"DIV",{class:!0});var N=S(o);l=C(N,"A",{href:!0,class:!0,"data-svelte-h":!0}),P(l)!=="svelte-tqzldn"&&(l.textContent=u),c=L(N),f=C(N,"A",{href:!0,class:!0,"data-svelte-h":!0}),P(f)!=="svelte-1nlktao"&&(f.textContent=p),m=L(N),d=C(N,"A",{href:!0,class:!0,"data-svelte-h":!0}),P(d)!=="svelte-zixgzz"&&(d.textContent=g),N.forEach(x),q.forEach(x),y.forEach(x),this.h()},h:function(){_(s,"href","/"),_(s,"class","text-3xl font-bold hover:text-blue-400 cursor-pointer"),w(s,I,5,6,226),_(n,"class","flex items-center justify-center flex-1"),w(n,I,4,4,166),_(l,"href","/upload"),_(l,"class","text-lg text-white hover:text-blue-400"),w(l,I,10,6,416),_(f,"href","/ask"),_(f,"class","text-lg text-white hover:text-blue-400"),w(f,I,13,6,519),_(d,"href","/profile"),_(d,"class","text-lg text-white hover:text-blue-400"),w(d,I,16,6,623),_(o,"class","flex items-center justify-center flex-1 space-x-4"),w(o,I,9,4,346),_(t,"class","navbar p-4 bg-gray-900 text-white rounded-t-lg rounded-b-lg border border-white"),w(t,I,1,2,61),_(e,"class","w-full bg-gray-900 rounded-lg mb-6 shadow-md"),w(e,I,0,0,0)},m:function(A,y){$(A,e,y),b(e,t),b(t,n),b(n,s),b(t,a),b(t,o),b(o,l),b(o,c),b(o,f),b(o,m),b(o,d)},p:R,i:R,o:R,d:function(A){A&&x(e)}};return j("SvelteRegisterBlock",{block:h,id:H.name,type:"component",source:"",ctx:r}),h}function Dt(r,e){let{$$slots:t={},$$scope:n}=e;ye("NavBar",t,[]);const s=[];return Object.keys(e).forEach(i=>{!~s.indexOf(i)&&i.slice(0,2)!=="$$"&&i!=="slot"&&console.warn(`<NavBar> was created with unknown prop '${i}'`)}),[]}class tr extends pe{constructor(e){super(e),me(this,e,Dt,H,de,{}),j("SvelteRegisterComponent",{component:this,tagName:"NavBar",options:e,id:H.name})}}export{er as A,Yt as B,Gt as C,ie as D,Ot as E,Wt as H,tr as N,Qt as R,qe as S,F as _,lt as a,U as b,Ft as c,Kt as d,Ht as e,Zt as f,qt as g,Xt as h,kt as i,Pt as j,Mt as k,Ge as p};
