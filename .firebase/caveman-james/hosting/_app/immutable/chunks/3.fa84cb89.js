import{s as rs,v as Dn,h as Mn,o as Ln,i as ns,d as re,r as ln,j as as,n as Oa}from"./scheduler.2364b0ad.js";import{S as is,i as ss,d as Le,v as os,j as ne,s as we,u as Pa,k as ae,c as Oe,w as Aa,m as Q,a as Ne,x as xa,f as Ea,t as ka,g as te,y as Ia,C as us,D as cs,E as Or,o as wt,l as he,A as We,p as Ot,n as Ta,z as Y,F as dt,B as Qe,G as Rn,H as Bn,q as Tr,I as ja,J as Zn}from"./index.9f7452a2.js";import{a as Pt,_ as vt,p as ls,b as pe,c as ds,d as Sa,R as Ca,B as Na,H as Da,e as Ma,f as hs,h as ps,i as Pr,j as La,k as Ar,l as Ra,m as Un,O as Qr,S as Xr,A as Ba,N as Za,g as fs}from"./NavBar.f58cf5a8.js";import{g as Ua,_ as Se,e as ms,f as Kn,c as br,P as _r,a as vr,d as en,G as gs,b as Vn}from"./public.9062b0fe.js";import{g as ys,T as bs,c as fr}from"./_commonjs-dynamic-modules.6fed1697.js";import{w as Hr}from"./index.db1f7a41.js";import{H as _s}from"./hf.dac6bdab.js";let mr;const vs=new Uint8Array(16);function ws(){if(!mr&&(mr=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!mr))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return mr(vs)}const Pe=[];for(let n=0;n<256;++n)Pe.push((n+256).toString(16).slice(1));function Os(n,e=0){return(Pe[n[e+0]]+Pe[n[e+1]]+Pe[n[e+2]]+Pe[n[e+3]]+"-"+Pe[n[e+4]]+Pe[n[e+5]]+"-"+Pe[n[e+6]]+Pe[n[e+7]]+"-"+Pe[n[e+8]]+Pe[n[e+9]]+"-"+Pe[n[e+10]]+Pe[n[e+11]]+Pe[n[e+12]]+Pe[n[e+13]]+Pe[n[e+14]]+Pe[n[e+15]]).toLowerCase()}const Ps=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),zn={randomUUID:Ps};function Ge(n,e,t){if(zn.randomUUID&&!e&&!n)return zn.randomUUID();n=n||{};const r=n.random||(n.rng||ws)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){t=t||0;for(let a=0;a<16;++a)e[t+a]=r[a];return e}return Os(r)}class As{}class cr extends As{get lc_namespace(){return["langchain","callbacks",this.name]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}constructor(e){var t;super(),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ignoreLLM",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreChain",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreAgent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"awaitHandlers",{enumerable:!0,configurable:!0,writable:!0,value:typeof process<"u"?((t=process.env)==null?void 0:t.LANGCHAIN_CALLBACKS_BACKGROUND)!=="true":!0}),this.lc_kwargs=e||{},e&&(this.ignoreLLM=e.ignoreLLM??this.ignoreLLM,this.ignoreChain=e.ignoreChain??this.ignoreChain,this.ignoreAgent=e.ignoreAgent??this.ignoreAgent)}copy(){return new this.constructor(this)}toJSON(){return Pt.prototype.toJSON.call(this)}toJSONNotImplemented(){return Pt.prototype.toJSONNotImplemented.call(this)}static fromMethods(e){class t extends cr{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:Ge()}),Object.assign(this,e)}}return new t}}var dn={exports:{}};dn.exports;(function(n){const t=(i=0)=>s=>`\x1B[${38+i};5;${s}m`,r=(i=0)=>(s,o,u)=>`\x1B[${38+i};2;${s};${o};${u}m`;function a(){const i=new Map,s={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};s.color.gray=s.color.blackBright,s.bgColor.bgGray=s.bgColor.bgBlackBright,s.color.grey=s.color.blackBright,s.bgColor.bgGrey=s.bgColor.bgBlackBright;for(const[o,u]of Object.entries(s)){for(const[c,m]of Object.entries(u))s[c]={open:`\x1B[${m[0]}m`,close:`\x1B[${m[1]}m`},u[c]=s[c],i.set(m[0],m[1]);Object.defineProperty(s,o,{value:u,enumerable:!1})}return Object.defineProperty(s,"codes",{value:i,enumerable:!1}),s.color.close="\x1B[39m",s.bgColor.close="\x1B[49m",s.color.ansi256=t(),s.color.ansi16m=r(),s.bgColor.ansi256=t(10),s.bgColor.ansi16m=r(10),Object.defineProperties(s,{rgbToAnsi256:{value:(o,u,c)=>o===u&&u===c?o<8?16:o>248?231:Math.round((o-8)/247*24)+232:16+36*Math.round(o/255*5)+6*Math.round(u/255*5)+Math.round(c/255*5),enumerable:!1},hexToRgb:{value:o=>{const u=/(?<colorString>[a-f\d]{6}|[a-f\d]{3})/i.exec(o.toString(16));if(!u)return[0,0,0];let{colorString:c}=u.groups;c.length===3&&(c=c.split("").map(P=>P+P).join(""));const m=Number.parseInt(c,16);return[m>>16&255,m>>8&255,m&255]},enumerable:!1},hexToAnsi256:{value:o=>s.rgbToAnsi256(...s.hexToRgb(o)),enumerable:!1}}),s}Object.defineProperty(n,"exports",{enumerable:!0,get:a})})(dn);var xs=dn.exports;const Ka=Ua(xs);class hn extends cr{constructor(e){super(...arguments),Object.defineProperty(this,"runMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map})}copy(){return this}_addChildRun(e,t){e.child_runs.push(t)}_startTrace(e){if(e.parent_run_id!==void 0){const t=this.runMap.get(e.parent_run_id);t&&this._addChildRun(t,e)}this.runMap.set(e.id,e)}async _endTrace(e){const t=e.parent_run_id!==void 0&&this.runMap.get(e.parent_run_id);t?t.child_execution_order=Math.max(t.child_execution_order,e.child_execution_order):await this.persistRun(e),this.runMap.delete(e.id)}_getExecutionOrder(e){const t=e!==void 0&&this.runMap.get(e);return t?t.child_execution_order+1:1}async handleLLMStart(e,t,r,a,i,s,o){var j;const u=this._getExecutionOrder(a),c=Date.now(),m=o?{...i,metadata:o}:i,P={id:r,name:e.id[e.id.length-1],parent_run_id:a,start_time:c,serialized:e,events:[{name:"start",time:c}],inputs:{prompts:t},execution_order:u,child_runs:[],child_execution_order:u,run_type:"llm",extra:m??{},tags:s||[]};this._startTrace(P),await((j=this.onLLMStart)==null?void 0:j.call(this,P))}async handleChatModelStart(e,t,r,a,i,s,o){var j;const u=this._getExecutionOrder(a),c=Date.now(),m=o?{...i,metadata:o}:i,P={id:r,name:e.id[e.id.length-1],parent_run_id:a,start_time:c,serialized:e,events:[{name:"start",time:c}],inputs:{messages:t},execution_order:u,child_runs:[],child_execution_order:u,run_type:"llm",extra:m??{},tags:s||[]};this._startTrace(P),await((j=this.onLLMStart)==null?void 0:j.call(this,P))}async handleLLMEnd(e,t){var a;const r=this.runMap.get(t);if(!r||(r==null?void 0:r.run_type)!=="llm")throw new Error("No LLM run to end.");r.end_time=Date.now(),r.outputs=e,r.events.push({name:"end",time:r.end_time}),await((a=this.onLLMEnd)==null?void 0:a.call(this,r)),await this._endTrace(r)}async handleLLMError(e,t){var a;const r=this.runMap.get(t);if(!r||(r==null?void 0:r.run_type)!=="llm")throw new Error("No LLM run to end.");r.end_time=Date.now(),r.error=e.message,r.events.push({name:"error",time:r.end_time}),await((a=this.onLLMError)==null?void 0:a.call(this,r)),await this._endTrace(r)}async handleChainStart(e,t,r,a,i,s){var m;const o=this._getExecutionOrder(a),u=Date.now(),c={id:r,name:e.id[e.id.length-1],parent_run_id:a,start_time:u,serialized:e,events:[{name:"start",time:u}],inputs:t,execution_order:o,child_execution_order:o,run_type:"chain",child_runs:[],extra:s?{metadata:s}:{},tags:i||[]};this._startTrace(c),await((m=this.onChainStart)==null?void 0:m.call(this,c))}async handleChainEnd(e,t){var a;const r=this.runMap.get(t);if(!r||(r==null?void 0:r.run_type)!=="chain")throw new Error("No chain run to end.");r.end_time=Date.now(),r.outputs=e,r.events.push({name:"end",time:r.end_time}),await((a=this.onChainEnd)==null?void 0:a.call(this,r)),await this._endTrace(r)}async handleChainError(e,t){var a;const r=this.runMap.get(t);if(!r||(r==null?void 0:r.run_type)!=="chain")throw new Error("No chain run to end.");r.end_time=Date.now(),r.error=e.message,r.events.push({name:"error",time:r.end_time}),await((a=this.onChainError)==null?void 0:a.call(this,r)),await this._endTrace(r)}async handleToolStart(e,t,r,a,i,s){var m;const o=this._getExecutionOrder(a),u=Date.now(),c={id:r,name:e.id[e.id.length-1],parent_run_id:a,start_time:u,serialized:e,events:[{name:"start",time:u}],inputs:{input:t},execution_order:o,child_execution_order:o,run_type:"tool",child_runs:[],extra:s?{metadata:s}:{},tags:i||[]};this._startTrace(c),await((m=this.onToolStart)==null?void 0:m.call(this,c))}async handleToolEnd(e,t){var a;const r=this.runMap.get(t);if(!r||(r==null?void 0:r.run_type)!=="tool")throw new Error("No tool run to end");r.end_time=Date.now(),r.outputs={output:e},r.events.push({name:"end",time:r.end_time}),await((a=this.onToolEnd)==null?void 0:a.call(this,r)),await this._endTrace(r)}async handleToolError(e,t){var a;const r=this.runMap.get(t);if(!r||(r==null?void 0:r.run_type)!=="tool")throw new Error("No tool run to end");r.end_time=Date.now(),r.error=e.message,r.events.push({name:"error",time:r.end_time}),await((a=this.onToolError)==null?void 0:a.call(this,r)),await this._endTrace(r)}async handleAgentAction(e,t){var i;const r=this.runMap.get(t);if(!r||(r==null?void 0:r.run_type)!=="chain")return;const a=r;a.actions=a.actions||[],a.actions.push(e),a.events.push({name:"agent_action",time:Date.now(),kwargs:{action:e}}),await((i=this.onAgentAction)==null?void 0:i.call(this,r))}async handleAgentEnd(e,t){var a;const r=this.runMap.get(t);!r||(r==null?void 0:r.run_type)!=="chain"||(r.events.push({name:"agent_end",time:Date.now(),kwargs:{action:e}}),await((a=this.onAgentEnd)==null?void 0:a.call(this,r)))}async handleText(e,t){var a;const r=this.runMap.get(t);!r||(r==null?void 0:r.run_type)!=="chain"||(r.events.push({name:"text",time:Date.now(),kwargs:{text:e}}),await((a=this.onText)==null?void 0:a.call(this,r)))}async handleLLMNewToken(e,t,r){var i;const a=this.runMap.get(r);!a||(a==null?void 0:a.run_type)!=="llm"||(a.events.push({name:"new_token",time:Date.now(),kwargs:{token:e,idx:t}}),await((i=this.onLLMNewToken)==null?void 0:i.call(this,a)))}}function Re(n,e){return`${n.open}${e}${n.close}`}function rt(n,e){try{return JSON.stringify(n,null,2)}catch{return e}}function yt(n){if(!n.end_time)return"";const e=n.end_time-n.start_time;return e<1e3?`${e}ms`:`${(e/1e3).toFixed(2)}s`}const{color:Ve}=Ka;class $n extends hn{constructor(){super(...arguments),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"console_callback_handler"})}persistRun(e){return Promise.resolve()}getParents(e){const t=[];let r=e;for(;r.parent_run_id;){const a=this.runMap.get(r.parent_run_id);if(a)t.push(a),r=a;else break}return t}getBreadcrumbs(e){const r=[...this.getParents(e).reverse(),e].map((a,i,s)=>{const o=`${a.execution_order}:${a.run_type}:${a.name}`;return i===s.length-1?Re(Ka.bold,o):o}).join(" > ");return Re(Ve.grey,r)}onChainStart(e){const t=this.getBreadcrumbs(e);console.log(`${Re(Ve.green,"[chain/start]")} [${t}] Entering Chain run with input: ${rt(e.inputs,"[inputs]")}`)}onChainEnd(e){const t=this.getBreadcrumbs(e);console.log(`${Re(Ve.cyan,"[chain/end]")} [${t}] [${yt(e)}] Exiting Chain run with output: ${rt(e.outputs,"[outputs]")}`)}onChainError(e){const t=this.getBreadcrumbs(e);console.log(`${Re(Ve.red,"[chain/error]")} [${t}] [${yt(e)}] Chain run errored with error: ${rt(e.error,"[error]")}`)}onLLMStart(e){const t=this.getBreadcrumbs(e),r="prompts"in e.inputs?{prompts:e.inputs.prompts.map(a=>a.trim())}:e.inputs;console.log(`${Re(Ve.green,"[llm/start]")} [${t}] Entering LLM run with input: ${rt(r,"[inputs]")}`)}onLLMEnd(e){const t=this.getBreadcrumbs(e);console.log(`${Re(Ve.cyan,"[llm/end]")} [${t}] [${yt(e)}] Exiting LLM run with output: ${rt(e.outputs,"[response]")}`)}onLLMError(e){const t=this.getBreadcrumbs(e);console.log(`${Re(Ve.red,"[llm/error]")} [${t}] [${yt(e)}] LLM run errored with error: ${rt(e.error,"[error]")}`)}onToolStart(e){var r;const t=this.getBreadcrumbs(e);console.log(`${Re(Ve.green,"[tool/start]")} [${t}] Entering Tool run with input: "${(r=e.inputs.input)==null?void 0:r.trim()}"`)}onToolEnd(e){var r,a;const t=this.getBreadcrumbs(e);console.log(`${Re(Ve.cyan,"[tool/end]")} [${t}] [${yt(e)}] Exiting Tool run with output: "${(a=(r=e.outputs)==null?void 0:r.output)==null?void 0:a.trim()}"`)}onToolError(e){const t=this.getBreadcrumbs(e);console.log(`${Re(Ve.red,"[tool/error]")} [${t}] [${yt(e)}] Tool run errored with error: ${rt(e.error,"[error]")}`)}onAgentAction(e){const t=e,r=this.getBreadcrumbs(e);console.log(`${Re(Ve.blue,"[agent/action]")} [${r}] Agent selected action: ${rt(t.actions[t.actions.length-1],"[action]")}`)}}const Es=[400,401,403,404,405,406,407,408,409];class ks{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6;const t="default"in vt?vt.default:vt;this.queue=new t({concurrency:this.maxConcurrency})}call(e,...t){return this.queue.add(()=>ls(()=>e(...t).catch(r=>{throw r instanceof Error?r:new Error(r)}),{onFailedAttempt(r){var i;if(r.message.startsWith("Cancel")||r.message.startsWith("TimeoutError")||r.message.startsWith("AbortError")||(r==null?void 0:r.code)==="ECONNABORTED")throw r;const a=(i=r==null?void 0:r.response)==null?void 0:i.status;if(a&&Es.includes(+a))throw r},retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,t,...r){return e.signal?Promise.race([this.call(t,...r),new Promise((a,i)=>{var s;(s=e.signal)==null||s.addEventListener("abort",()=>{i(new Error("AbortError"))})})]):this.call(t,...r)}fetch(...e){return this.call(()=>fetch(...e).then(t=>t.ok?t:Promise.reject(t)))}}const Is=()=>typeof window<"u"&&typeof window.document<"u",Ts=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",js=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom")),Va=()=>typeof Deno<"u",Ss=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!Va(),Cs=()=>{let n;return Is()?n="browser":Ss()?n="node":Ts()?n="webworker":js()?n="jsdom":Va()?n="deno":n="other",n};let Yr;async function Ns(){return Yr===void 0&&(Yr={library:"langsmith",runtime:Cs()}),Yr}function Fn(n){var e;try{return typeof process<"u"?(e=process.env)==null?void 0:e[n]:void 0}catch{return}}const Ds=n=>{const t=n.replace("http://","").replace("https://","").split("/")[0].split(":")[0];return t==="localhost"||t==="127.0.0.1"||t==="::1"},gr=async(n,e)=>{const t=await n.text();if(!n.ok)throw new Error(`Failed to ${e}: ${n.status} ${n.statusText} ${t}`)};class pn{constructor(e={}){Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout_ms",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const t=pn.getDefaultClientConfig();this.apiUrl=e.apiUrl??t.apiUrl,this.apiKey=e.apiKey??t.apiKey,this.validateApiKeyIfHosted(),this.timeout_ms=e.timeout_ms??4e3,this.caller=new ks(e.callerOptions??{})}static getDefaultClientConfig(){return{apiUrl:Fn("LANGCHAIN_ENDPOINT")??"http://localhost:1984",apiKey:Fn("LANGCHAIN_API_KEY")}}validateApiKeyIfHosted(){if(!Ds(this.apiUrl)&&!this.apiKey)throw new Error("API key must be provided when using hosted LangSmith API")}get headers(){const e={};return this.apiKey&&(e["x-api-key"]=`${this.apiKey}`),e}async _get(e,t){const r=(t==null?void 0:t.toString())??"",a=`${this.apiUrl}${e}?${r}`,i=await this.caller.call(fetch,a,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});if(!i.ok)throw new Error(`Failed to fetch ${e}: ${i.status} ${i.statusText}`);return i.json()}async createRun(e){const t={...this.headers,"Content-Type":"application/json"},r=e.extra??{},a=await Ns(),i=e.project_name;delete e.project_name;const s={session_name:i,...e,extra:{...e.extra,runtime:{...a,...r.runtime}}},o=await this.caller.call(fetch,`${this.apiUrl}/runs`,{method:"POST",headers:t,body:JSON.stringify(s),signal:AbortSignal.timeout(this.timeout_ms)});await gr(o,"create run")}async updateRun(e,t){const r={...this.headers,"Content-Type":"application/json"},a=await this.caller.call(fetch,`${this.apiUrl}/runs/${e}`,{method:"PATCH",headers:r,body:JSON.stringify(t),signal:AbortSignal.timeout(this.timeout_ms)});await gr(a,"update run")}async readRun(e,{loadChildRuns:t}={loadChildRuns:!1}){let r=await this._get(`/runs/${e}`);return t&&r.child_run_ids&&(r=await this._loadChildRuns(r)),r}async _loadChildRuns(e){const t=await this.listRuns({id:e.child_run_ids}),r={},a={};t.sort((i,s)=>i.execution_order-s.execution_order);for(const i of t){if(i.parent_run_id===null||i.parent_run_id===void 0)throw new Error(`Child run ${i.id} has no parent`);i.parent_run_id in r||(r[i.parent_run_id]=[]),r[i.parent_run_id].push(i),a[i.id]=i}e.child_runs=r[e.id]||[];for(const i in r)i!==e.id&&(a[i].child_runs=r[i]);return e}async listRuns({projectId:e,projectName:t,executionOrder:r,runType:a,error:i,id:s,limit:o,offset:u}){const c=new URLSearchParams;let m=e;if(t){if(e)throw new Error("Only one of projectId or projectName may be given");m=(await this.readProject({projectName:t})).id}if(m&&c.append("session",m),r&&c.append("execution_order",r.toString()),a&&c.append("run_type",a),i!==void 0&&c.append("error",i.toString()),s!==void 0)for(const P of s)c.append("id",P);return o!==void 0&&c.append("limit",o.toString()),u!==void 0&&c.append("offset",u.toString()),this._get("/runs",c)}async deleteRun(e){const t=await this.caller.call(fetch,`${this.apiUrl}/runs/${e}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});await gr(t,"delete run")}async createProject({projectName:e,projectExtra:t,upsert:r}){const a=r?"?upsert=true":"",i=`${this.apiUrl}/sessions${a}`,s={name:e};t!==void 0&&(s.extra=t);const o=await this.caller.call(fetch,i,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(s),signal:AbortSignal.timeout(this.timeout_ms)}),u=await o.json();if(!o.ok)throw new Error(`Failed to create session ${e}: ${o.status} ${o.statusText}`);return u}async readProject({projectId:e,projectName:t}){let r="/sessions";const a=new URLSearchParams;if(e!==void 0&&t!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(e!==void 0)r+=`/${e}`;else if(t!==void 0)a.append("name",t);else throw new Error("Must provide projectName or projectId");const i=await this._get(r,a);let s;if(Array.isArray(i)){if(i.length===0)throw new Error(`Project[id=${e}, name=${t}] not found`);s=i[0]}else s=i;return s}async listProjects(){return this._get("/sessions")}async deleteProject({projectId:e,projectName:t}){let r;if(e===void 0&&t===void 0)throw new Error("Must provide projectName or projectId");if(e!==void 0&&t!==void 0)throw new Error("Must provide either projectName or projectId, not both");e===void 0?r=(await this.readProject({projectName:t})).id:r=e;const a=await this.caller.call(fetch,`${this.apiUrl}/sessions/${r}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});await gr(a,`delete session ${r} (${t})`)}async uploadCsv({csvFile:e,fileName:t,inputKeys:r,outputKeys:a,description:i,dataType:s,name:o}){const u=`${this.apiUrl}/datasets/upload`,c=new FormData;c.append("file",e,t),r.forEach(j=>{c.append("input_keys",j)}),a.forEach(j=>{c.append("output_keys",j)}),i&&c.append("description",i),s&&c.append("data_type",s),o&&c.append("name",o);const m=await this.caller.call(fetch,u,{method:"POST",headers:this.headers,body:c,signal:AbortSignal.timeout(this.timeout_ms)});if(!m.ok){const j=await m.json();throw j.detail&&j.detail.includes("already exists")?new Error(`Dataset ${t} already exists`):new Error(`Failed to upload CSV: ${m.status} ${m.statusText}`)}return await m.json()}async createDataset(e,{description:t,dataType:r}={}){const a={name:e,description:t};r&&(a.data_type=r);const i=await this.caller.call(fetch,`${this.apiUrl}/datasets`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(a),signal:AbortSignal.timeout(this.timeout_ms)});if(!i.ok){const o=await i.json();throw o.detail&&o.detail.includes("already exists")?new Error(`Dataset ${e} already exists`):new Error(`Failed to create dataset ${i.status} ${i.statusText}`)}return await i.json()}async readDataset({datasetId:e,datasetName:t}){let r="/datasets";const a=new URLSearchParams({limit:"1"});if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(e!==void 0)r+=`/${e}`;else if(t!==void 0)a.append("name",t);else throw new Error("Must provide datasetName or datasetId");const i=await this._get(r,a);let s;if(Array.isArray(i)){if(i.length===0)throw new Error(`Dataset[id=${e}, name=${t}] not found`);s=i[0]}else s=i;return s}async listDatasets({limit:e=100,offset:t=0}={}){const r="/datasets",a=new URLSearchParams({limit:e.toString(),offset:t.toString()}),i=await this._get(r,a);if(!Array.isArray(i))throw new Error(`Expected ${r} to return an array, but got ${i}`);return i}async deleteDataset({datasetId:e,datasetName:t}){let r="/datasets",a=e;if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(t!==void 0&&(a=(await this.readDataset({datasetName:t})).id),a!==void 0)r+=`/${a}`;else throw new Error("Must provide datasetName or datasetId");const i=await this.caller.call(fetch,this.apiUrl+r,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});if(!i.ok)throw new Error(`Failed to delete ${r}: ${i.status} ${i.statusText}`);await i.json()}async createExample(e,t,{datasetId:r,datasetName:a,createdAt:i}){let s=r;if(s===void 0&&a===void 0)throw new Error("Must provide either datasetName or datasetId");if(s!==void 0&&a!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");s===void 0&&(s=(await this.readDataset({datasetName:a})).id);const u={dataset_id:s,inputs:e,outputs:t,created_at:(i||new Date).toISOString()},c=await this.caller.call(fetch,`${this.apiUrl}/examples`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(u),signal:AbortSignal.timeout(this.timeout_ms)});if(!c.ok)throw new Error(`Failed to create example: ${c.status} ${c.statusText}`);return await c.json()}async readExample(e){const t=`/examples/${e}`;return await this._get(t)}async listExamples({datasetId:e,datasetName:t,limit:r,offset:a}={}){let i;if(e!==void 0&&t!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(e!==void 0)i=e;else if(t!==void 0)i=(await this.readDataset({datasetName:t})).id;else throw new Error("Must provide a datasetName or datasetId");const s=await this._get("/examples",new URLSearchParams({dataset:i,limit:(r==null?void 0:r.toString())??"100",offset:(a==null?void 0:a.toString())??"0"}));if(!Array.isArray(s))throw new Error(`Expected /examples to return an array, but got ${s}`);return s}async deleteExample(e){const t=`/examples/${e}`,r=await this.caller.call(fetch,this.apiUrl+t,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});if(!r.ok)throw new Error(`Failed to delete ${t}: ${r.status} ${r.statusText}`);await r.json()}async updateExample(e,t){const r=await this.caller.call(fetch,`${this.apiUrl}/examples/${e}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(t),signal:AbortSignal.timeout(this.timeout_ms)});if(!r.ok)throw new Error(`Failed to update example ${e}: ${r.status} ${r.statusText}`);return await r.json()}async evaluateRun(e,t,{sourceInfo:r,loadChildRuns:a}={loadChildRuns:!1}){let i;if(typeof e=="string")i=await this.readRun(e,{loadChildRuns:a});else if(typeof e=="object"&&"id"in e)i=e;else throw new Error(`Invalid run type: ${typeof e}`);let s;i.reference_example_id!==null&&i.reference_example_id!==void 0&&(s=await this.readExample(i.reference_example_id));const o=await t.evaluateRun(i,s);let u=r??{};return o.evaluatorInfo&&(u={...u,...o.evaluatorInfo}),await this.createFeedback(i.id,o.key,{score:o.score,value:o.value,comment:o.comment,correction:o.correction,sourceInfo:u,feedbackSourceType:"MODEL"})}async createFeedback(e,t,{score:r,value:a,correction:i,comment:s,sourceInfo:o,feedbackSourceType:u="API"}){let c;if(u==="API")c={type:"api",metadata:o??{}};else if(u==="MODEL")c={type:"model",metadata:o??{}};else throw new Error(`Unknown feedback source type ${u}`);const m={id:Ge(),run_id:e,key:t,score:r,value:a,correction:i,comment:s,feedback_source:c},P=await this.caller.call(fetch,`${this.apiUrl}/feedback`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(m),signal:AbortSignal.timeout(this.timeout_ms)});if(!P.ok)throw new Error(`Failed to create feedback for run ${e}: ${P.status} ${P.statusText}`);return await P.json()}async readFeedback(e){const t=`/feedback/${e}`;return await this._get(t)}async deleteFeedback(e){const t=`/feedback/${e}`,r=await this.caller.call(fetch,this.apiUrl+t,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});if(!r.ok)throw new Error(`Failed to delete ${t}: ${r.status} ${r.statusText}`);await r.json()}async listFeedback({runIds:e,limit:t,offset:r}={}){const a=new URLSearchParams;return e&&a.append("run",e.join(",")),t!==void 0&&a.append("limit",t.toString()),r!==void 0&&a.append("offset",r.toString()),await this._get("/feedback",a)}}class Ms extends hn{constructor(e={}){super(e),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"langchain_tracer"}),Object.defineProperty(this,"projectName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exampleId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const{exampleId:t,projectName:r,client:a}=e;this.projectName=r??pe("LANGCHAIN_PROJECT")??pe("LANGCHAIN_SESSION"),this.exampleId=t,this.client=a??new pn({})}async _convertToCreate(e,t=void 0){return{...e,extra:{...e.extra,runtime:await ds()},child_runs:void 0,session_name:this.projectName,reference_example_id:e.parent_run_id?void 0:t}}async persistRun(e){}async _persistRunSingle(e){const t=await this._convertToCreate(e,this.exampleId);await this.client.createRun(t)}async _updateRunSingle(e){const t={end_time:e.end_time,error:e.error,outputs:e.outputs,events:e.events};await this.client.updateRun(e.id,t)}async onLLMStart(e){await this._persistRunSingle(e)}async onLLMEnd(e){await this._updateRunSingle(e)}async onLLMError(e){await this._updateRunSingle(e)}async onChainStart(e){await this._persistRunSingle(e)}async onChainEnd(e){await this._updateRunSingle(e)}async onChainError(e){await this._updateRunSingle(e)}async onToolStart(e){await this._persistRunSingle(e)}async onToolEnd(e){await this._updateRunSingle(e)}async onToolError(e){await this._updateRunSingle(e)}}function fn(n,e="Human",t="AI"){const r=[];for(const a of n){let i;if(a._getType()==="human")i=e;else if(a._getType()==="ai")i=t;else if(a._getType()==="system")i="System";else if(a._getType()==="function")i="Function";else if(a._getType()==="generic")i=a.role;else throw new Error(`Got unsupported message type: ${a}`);const s=a.name?`${a.name}, `:"";r.push(`${i}: ${s}${a.content}`)}return r.join(`
`)}class Ls extends hn{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"langchain_tracer"}),Object.defineProperty(this,"endpoint",{enumerable:!0,configurable:!0,writable:!0,value:pe("LANGCHAIN_ENDPOINT")||"http://localhost:1984"}),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:{"Content-Type":"application/json"}}),Object.defineProperty(this,"session",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const e=pe("LANGCHAIN_API_KEY");e&&(this.headers["x-api-key"]=e)}async newSession(e){const t={start_time:Date.now(),name:e},r=await this.persistSession(t);return this.session=r,r}async loadSession(e){const t=`${this.endpoint}/sessions?name=${e}`;return this._handleSessionResponse(t)}async loadDefaultSession(){const e=`${this.endpoint}/sessions?name=default`;return this._handleSessionResponse(e)}async convertV2RunToRun(e){var i;const t=this.session??await this.loadDefaultSession(),r=e.serialized;let a;if(e.run_type==="llm"){const s=e.inputs.prompts?e.inputs.prompts:e.inputs.messages.map(u=>fn(u));a={uuid:e.id,start_time:e.start_time,end_time:e.end_time,execution_order:e.execution_order,child_execution_order:e.child_execution_order,serialized:r,type:e.run_type,session_id:t.id,prompts:s,response:e.outputs}}else if(e.run_type==="chain"){const s=await Promise.all(e.child_runs.map(u=>this.convertV2RunToRun(u)));a={uuid:e.id,start_time:e.start_time,end_time:e.end_time,execution_order:e.execution_order,child_execution_order:e.child_execution_order,serialized:r,type:e.run_type,session_id:t.id,inputs:e.inputs,outputs:e.outputs,child_llm_runs:s.filter(u=>u.type==="llm"),child_chain_runs:s.filter(u=>u.type==="chain"),child_tool_runs:s.filter(u=>u.type==="tool")}}else if(e.run_type==="tool"){const s=await Promise.all(e.child_runs.map(u=>this.convertV2RunToRun(u)));a={uuid:e.id,start_time:e.start_time,end_time:e.end_time,execution_order:e.execution_order,child_execution_order:e.child_execution_order,serialized:r,type:e.run_type,session_id:t.id,tool_input:e.inputs.input,output:(i=e.outputs)==null?void 0:i.output,action:JSON.stringify(r),child_llm_runs:s.filter(u=>u.type==="llm"),child_chain_runs:s.filter(u=>u.type==="chain"),child_tool_runs:s.filter(u=>u.type==="tool")}}else throw new Error(`Unknown run type: ${e.run_type}`);return a}async persistRun(e){let t,r;e.run_type!==void 0?r=await this.convertV2RunToRun(e):r=e,r.type==="llm"?t=`${this.endpoint}/llm-runs`:r.type==="chain"?t=`${this.endpoint}/chain-runs`:t=`${this.endpoint}/tool-runs`;const a=await fetch(t,{method:"POST",headers:this.headers,body:JSON.stringify(r)});a.ok||console.error(`Failed to persist run: ${a.status} ${a.statusText}`)}async persistSession(e){const t=`${this.endpoint}/sessions`,r=await fetch(t,{method:"POST",headers:this.headers,body:JSON.stringify(e)});return r.ok?{id:(await r.json()).id,...e}:(console.error(`Failed to persist session: ${r.status} ${r.statusText}, using default session.`),{id:1,...e})}async _handleSessionResponse(e){const t=await fetch(e,{method:"GET",headers:this.headers});let r;if(!t.ok)return console.error(`Failed to load session: ${t.status} ${t.statusText}`),r={id:1,start_time:Date.now()},this.session=r,r;const a=await t.json();return a.length===0?(r={id:1,start_time:Date.now()},this.session=r,r):([r]=a,this.session=r,r)}}async function Rs(n){const e=new Ls;return n?await e.loadSession(n):await e.loadDefaultSession(),e}async function Bs(){return new Ms}let Wr;function Zs(){const n="default"in vt?vt.default:vt;return new n({autoStart:!0,concurrency:1})}async function Ce(n,e){e===!0?await n():(typeof Wr>"u"&&(Wr=Zs()),Wr.add(n))}function Us(n){return n?Array.isArray(n)||"name"in n?{callbacks:n}:n:{}}class Ks{setHandler(e){return this.setHandlers([e])}}class mn{constructor(e,t,r,a,i,s,o,u){Object.defineProperty(this,"runId",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:u})}async handleText(e){await Promise.all(this.handlers.map(t=>Ce(async()=>{var r;try{await((r=t.handleText)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(a){console.error(`Error in handler ${t.constructor.name}, handleText: ${a}`)}},t.awaitHandlers)))}}class qn extends mn{async handleLLMNewToken(e,t={prompt:0,completion:0}){await Promise.all(this.handlers.map(r=>Ce(async()=>{var a;if(!r.ignoreLLM)try{await((a=r.handleLLMNewToken)==null?void 0:a.call(r,e,t,this.runId,this._parentRunId,this.tags))}catch(i){console.error(`Error in handler ${r.constructor.name}, handleLLMNewToken: ${i}`)}},r.awaitHandlers)))}async handleLLMError(e){await Promise.all(this.handlers.map(t=>Ce(async()=>{var r;if(!t.ignoreLLM)try{await((r=t.handleLLMError)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(a){console.error(`Error in handler ${t.constructor.name}, handleLLMError: ${a}`)}},t.awaitHandlers)))}async handleLLMEnd(e){await Promise.all(this.handlers.map(t=>Ce(async()=>{var r;if(!t.ignoreLLM)try{await((r=t.handleLLMEnd)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(a){console.error(`Error in handler ${t.constructor.name}, handleLLMEnd: ${a}`)}},t.awaitHandlers)))}}class Vs extends mn{getChild(e){const t=new at(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleChainError(e){await Promise.all(this.handlers.map(t=>Ce(async()=>{var r;if(!t.ignoreChain)try{await((r=t.handleChainError)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(a){console.error(`Error in handler ${t.constructor.name}, handleChainError: ${a}`)}},t.awaitHandlers)))}async handleChainEnd(e){await Promise.all(this.handlers.map(t=>Ce(async()=>{var r;if(!t.ignoreChain)try{await((r=t.handleChainEnd)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(a){console.error(`Error in handler ${t.constructor.name}, handleChainEnd: ${a}`)}},t.awaitHandlers)))}async handleAgentAction(e){await Promise.all(this.handlers.map(t=>Ce(async()=>{var r;if(!t.ignoreAgent)try{await((r=t.handleAgentAction)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(a){console.error(`Error in handler ${t.constructor.name}, handleAgentAction: ${a}`)}},t.awaitHandlers)))}async handleAgentEnd(e){await Promise.all(this.handlers.map(t=>Ce(async()=>{var r;if(!t.ignoreAgent)try{await((r=t.handleAgentEnd)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(a){console.error(`Error in handler ${t.constructor.name}, handleAgentEnd: ${a}`)}},t.awaitHandlers)))}}class zs extends mn{getChild(e){const t=new at(this.runId);return t.setHandlers(this.inheritableHandlers),t.addTags(this.inheritableTags),t.addMetadata(this.inheritableMetadata),e&&t.addTags([e],!1),t}async handleToolError(e){await Promise.all(this.handlers.map(t=>Ce(async()=>{var r;if(!t.ignoreAgent)try{await((r=t.handleToolError)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(a){console.error(`Error in handler ${t.constructor.name}, handleToolError: ${a}`)}},t.awaitHandlers)))}async handleToolEnd(e){await Promise.all(this.handlers.map(t=>Ce(async()=>{var r;if(!t.ignoreAgent)try{await((r=t.handleToolEnd)==null?void 0:r.call(t,e,this.runId,this._parentRunId,this.tags))}catch(a){console.error(`Error in handler ${t.constructor.name}, handleToolEnd: ${a}`)}},t.awaitHandlers)))}}class at extends Ks{constructor(e){super(),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"callback_manager"}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.handlers=[],this.inheritableHandlers=[],this._parentRunId=e}async handleLLMStart(e,t,r=void 0,a=void 0,i=void 0){return Promise.all(t.map(async s=>{const o=Ge();return await Promise.all(this.handlers.map(u=>Ce(async()=>{var c;if(!u.ignoreLLM)try{await((c=u.handleLLMStart)==null?void 0:c.call(u,e,[s],o,this._parentRunId,i,this.tags,this.metadata))}catch(m){console.error(`Error in handler ${u.constructor.name}, handleLLMStart: ${m}`)}},u.awaitHandlers))),new qn(o,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChatModelStart(e,t,r=void 0,a=void 0,i=void 0){return Promise.all(t.map(async s=>{const o=Ge();return await Promise.all(this.handlers.map(u=>Ce(async()=>{var c,m;if(!u.ignoreLLM)try{if(u.handleChatModelStart)await((c=u.handleChatModelStart)==null?void 0:c.call(u,e,[s],o,this._parentRunId,i,this.tags,this.metadata));else if(u.handleLLMStart){const P=fn(s);await((m=u.handleLLMStart)==null?void 0:m.call(u,e,[P],o,this._parentRunId,i,this.tags,this.metadata))}}catch(P){console.error(`Error in handler ${u.constructor.name}, handleLLMStart: ${P}`)}},u.awaitHandlers))),new qn(o,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChainStart(e,t,r=Ge()){return await Promise.all(this.handlers.map(a=>Ce(async()=>{var i;if(!a.ignoreChain)try{await((i=a.handleChainStart)==null?void 0:i.call(a,e,t,r,this._parentRunId,this.tags,this.metadata))}catch(s){console.error(`Error in handler ${a.constructor.name}, handleChainStart: ${s}`)}},a.awaitHandlers))),new Vs(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleToolStart(e,t,r=Ge()){return await Promise.all(this.handlers.map(a=>Ce(async()=>{var i;if(!a.ignoreAgent)try{await((i=a.handleToolStart)==null?void 0:i.call(a,e,t,r,this._parentRunId,this.tags,this.metadata))}catch(s){console.error(`Error in handler ${a.constructor.name}, handleToolStart: ${s}`)}},a.awaitHandlers))),new zs(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}addHandler(e,t=!0){this.handlers.push(e),t&&this.inheritableHandlers.push(e)}removeHandler(e){this.handlers=this.handlers.filter(t=>t!==e),this.inheritableHandlers=this.inheritableHandlers.filter(t=>t!==e)}setHandlers(e,t=!0){this.handlers=[],this.inheritableHandlers=[];for(const r of e)this.addHandler(r,t)}addTags(e,t=!0){this.removeTags(e),this.tags.push(...e),t&&this.inheritableTags.push(...e)}removeTags(e){this.tags=this.tags.filter(t=>!e.includes(t)),this.inheritableTags=this.inheritableTags.filter(t=>!e.includes(t))}addMetadata(e,t=!0){this.metadata={...this.metadata,...e},t&&(this.inheritableMetadata={...this.inheritableMetadata,...e})}removeMetadata(e){for(const t of Object.keys(e))delete this.metadata[t],delete this.inheritableMetadata[t]}copy(e=[],t=!0){const r=new at(this._parentRunId);for(const a of this.handlers){const i=this.inheritableHandlers.includes(a);r.addHandler(a,i)}for(const a of this.tags){const i=this.inheritableTags.includes(a);r.addTags([a],i)}for(const a of Object.keys(this.metadata)){const i=Object.keys(this.inheritableMetadata).includes(a);r.addMetadata({[a]:this.metadata[a]},i)}for(const a of e)r.handlers.filter(i=>i.name==="console_callback_handler").some(i=>i.name===a.name)||r.addHandler(a,t);return r}static fromHandlers(e){class t extends cr{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:Ge()}),Object.assign(this,e)}}const r=new this;return r.addHandler(new t),r}static async configure(e,t,r,a,i,s,o){let u;(e||t)&&(Array.isArray(e)||!e?(u=new at,u.setHandlers((e==null?void 0:e.map(Hn))??[],!0)):u=e,u=u.copy(Array.isArray(t)?t.map(Hn):t==null?void 0:t.handlers,!1));const c=pe("LANGCHAIN_VERBOSE")||(o==null?void 0:o.verbose),m=pe("LANGCHAIN_TRACING_V2")??!1,P=m||(pe("LANGCHAIN_TRACING")??!1);if(c||P){if(u||(u=new at),c&&!u.handlers.some(j=>j.name===$n.prototype.name)){const j=new $n;u.addHandler(j,!0)}if(P&&!u.handlers.some(j=>j.name==="langchain_tracer"))if(m)u.addHandler(await Bs(),!0);else{const j=pe("LANGCHAIN_PROJECT")&&pe("LANGCHAIN_SESSION");u.addHandler(await Rs(j),!0)}}return(r||a)&&u&&(u.addTags(r??[]),u.addTags(a??[],!1)),(i||s)&&u&&(u.addMetadata(i??{}),u.addMetadata(s??{},!1)),u}}function Hn(n){return"name"in n?n:cr.fromMethods(n)}const yr={},$s=new Sa({});async function Fs(n,e){return n in yr||(yr[n]=$s.fetch(`https://tiktoken.pages.dev/js/${n}.json`,{signal:e==null?void 0:e.signal}).then(t=>t.json()).catch(t=>{throw delete yr[n],t})),new bs(await yr[n],e==null?void 0:e.extendedSpecialTokens)}async function za(n,e){return Fs(ys(n),e)}const $a=n=>n.startsWith("gpt-3.5-turbo-16k")?"gpt-3.5-turbo-16k":n.startsWith("gpt-3.5-turbo-")?"gpt-3.5-turbo":n.startsWith("gpt-4-32k")?"gpt-4-32k":n.startsWith("gpt-4-")?"gpt-4":n,qs=n=>{switch($a(n)){case"gpt-3.5-turbo-16k":return 16384;case"gpt-3.5-turbo":return 4096;case"gpt-4-32k":return 32768;case"gpt-4":return 8192;case"text-davinci-003":return 4097;case"text-curie-001":return 2048;case"text-babbage-001":return 2048;case"text-ada-001":return 2048;case"code-davinci-002":return 8e3;case"code-cushman-001":return 2048;default:return 4097}},Hs=async({prompt:n,modelName:e})=>{let t;try{t=(await za(e)).encode(n).length}catch{console.warn("Failed to calculate number of tokens, falling back to approximate count"),t=Math.ceil(n.length/4)}return qs(e)-t},Ys=()=>!1;class Fa extends Pt{get lc_attributes(){return{callbacks:void 0,verbose:void 0}}constructor(e){super(e),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.verbose=e.verbose??Ys(),this.callbacks=e.callbacks,this.tags=e.tags??[],this.metadata=e.metadata??{}}}class qa extends Fa{get callKeys(){return["stop","timeout","signal","tags","metadata","callbacks"]}constructor({callbacks:e,callbackManager:t,...r}){super({callbacks:e??t,...r}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_encoding",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.caller=new Sa(r??{})}async getNumTokens(e){let t=Math.ceil(e.length/4);if(!this._encoding)try{this._encoding=await za("modelName"in this?$a(this.modelName):"gpt2")}catch(r){console.warn("Failed to calculate number of tokens, falling back to approximate count",r)}return this._encoding&&(t=this._encoding.encode(e).length),t}_identifyingParams(){return{}}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}static async deserialize(e){const{_type:t,_model:r,...a}=e;if(r&&r!=="base_chat_model")throw new Error(`Cannot load LLM with model ${r}`);const i={openai:(await Se(()=>import("./openai.e343b7ce.js"),["./openai.e343b7ce.js","./NavBar.f58cf5a8.js","./public.9062b0fe.js","./scheduler.2364b0ad.js","./index.9f7452a2.js","../assets/NavBar.ffbd0f32.css"],import.meta.url)).ChatOpenAI}[t];if(i===void 0)throw new Error(`Cannot load  LLM with type ${t}`);return new i(a)}}class lr extends Fa{get lc_namespace(){return["langchain","chains",this._chainType()]}constructor(e,t,r){if(arguments.length===1&&typeof e=="object"&&!("saveContext"in e)){const{memory:a,callbackManager:i,...s}=e;super({...s,callbacks:i??s.callbacks}),this.memory=a}else super({verbose:t,callbacks:r}),this.memory=e}_selectMemoryInputs(e){const t={...e};return"signal"in t&&delete t.signal,"timeout"in t&&delete t.timeout,t}serialize(){throw new Error("Method not implemented.")}async run(e,t){const r=this.inputKeys.filter(u=>{var c;return!((c=this.memory)!=null&&c.memoryKeys.includes(u))});if(!(r.length<=1))throw new Error(`Chain ${this._chainType()} expects multiple inputs, cannot use 'run' `);const i=r.length?{[r[0]]:e}:{},s=await this.call(i,t),o=Object.keys(s);if(o.length===1)return s[o[0]];throw new Error("return values have multiple keys, `run` only supported when one key currently")}async call(e,t,r){const a={...e};if(a.timeout&&!a.signal&&(a.signal=AbortSignal.timeout(a.timeout),delete a.timeout),this.memory!=null){const c=await this.memory.loadMemoryVariables(this._selectMemoryInputs(e));for(const[m,P]of Object.entries(c))a[m]=P}const i=Us(t),s=await at.configure(i.callbacks,this.callbacks,i.tags||r,this.tags,i.metadata,this.metadata,{verbose:this.verbose}),o=await(s==null?void 0:s.handleChainStart(this.toJSON(),a));let u;try{u=await(e.signal?Promise.race([this._call(a,o),new Promise((c,m)=>{var P;(P=e.signal)==null||P.addEventListener("abort",()=>{m(new Error("AbortError"))})})]):this._call(a,o))}catch(c){throw await(o==null?void 0:o.handleChainError(c)),c}return this.memory!=null&&await this.memory.saveContext(this._selectMemoryInputs(e),u),await(o==null?void 0:o.handleChainEnd(u)),Object.defineProperty(u,Ca,{value:o?{runId:o==null?void 0:o.runId}:void 0,configurable:!0}),u}async apply(e,t){return Promise.all(e.map(async(r,a)=>this.call(r,t==null?void 0:t[a])))}static async deserialize(e,t={}){switch(e._type){case"llm_chain":{const{LLMChain:r}=await Se(()=>Promise.resolve().then(()=>eo),void 0,import.meta.url);return r.deserialize(e)}case"sequential_chain":{const{SequentialChain:r}=await Se(()=>import("./sequential_chain.c802dcf3.js"),[],import.meta.url);return r.deserialize(e)}case"simple_sequential_chain":{const{SimpleSequentialChain:r}=await Se(()=>import("./sequential_chain.c802dcf3.js"),[],import.meta.url);return r.deserialize(e)}case"stuff_documents_chain":{const{StuffDocumentsChain:r}=await Se(()=>Promise.resolve().then(()=>Gr),void 0,import.meta.url);return r.deserialize(e)}case"map_reduce_documents_chain":{const{MapReduceDocumentsChain:r}=await Se(()=>Promise.resolve().then(()=>Gr),void 0,import.meta.url);return r.deserialize(e)}case"refine_documents_chain":{const{RefineDocumentsChain:r}=await Se(()=>Promise.resolve().then(()=>Gr),void 0,import.meta.url);return r.deserialize(e)}case"vector_db_qa":{const{VectorDBQAChain:r}=await Se(()=>import("./vector_db_qa.43031be8.js"),[],import.meta.url);return r.deserialize(e,t)}case"api_chain":{const{APIChain:r}=await Se(()=>import("./api_chain.a46bf737.js"),[],import.meta.url);return r.deserialize(e)}default:throw new Error(`Invalid prompt type in config: ${e._type}`)}}}class Ws extends Na{constructor(e){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","prompts","base"]}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.value=e}toString(){return this.value}toChatMessages(){return[new Da(this.value)]}}class gn extends Pt{get lc_attributes(){return{partialVariables:void 0}}constructor(e){super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","prompts",this._getPromptType()]}),Object.defineProperty(this,"inputVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"partialVariables",{enumerable:!0,configurable:!0,writable:!0,value:{}});const{inputVariables:t}=e;if(t.includes("stop"))throw new Error("Cannot have an input variable named 'stop', as it is used internally, please rename.");Object.assign(this,e)}async mergePartialAndUserVariables(e){const t=this.partialVariables??{},r={};for(const[i,s]of Object.entries(t))typeof s=="string"?r[i]=s:r[i]=await s();return{...r,...e}}serialize(){throw new Error("Use .toJSON() instead")}static async deserialize(e){switch(e._type){case"prompt":{const{PromptTemplate:t}=await Se(()=>Promise.resolve().then(()=>Yn),void 0,import.meta.url);return t.deserialize(e)}case void 0:{const{PromptTemplate:t}=await Se(()=>Promise.resolve().then(()=>Yn),void 0,import.meta.url);return t.deserialize({...e,_type:"prompt"})}case"few_shot":{const{FewShotPromptTemplate:t}=await Se(()=>import("./few_shot.863ddfc3.js"),[],import.meta.url);return t.deserialize(e)}default:throw new Error(`Invalid prompt type in config: ${e._type}`)}}}class Gs extends gn{async formatPromptValue(e){const t=await this.format(e);return new Ws(t)}}class Js extends Pt{parseResultWithPrompt(e,t,r){return this.parseResult(e,r)}}class Qs extends Js{parseResult(e,t){return this.parse(e[0].text,t)}async parseWithPrompt(e,t,r){return this.parse(e,r)}_type(){throw new Error("_type not implemented")}}class Xs extends Qs{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","default"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}parse(e){return Promise.resolve(e)}getFormatInstructions(){return""}}class De extends lr{get inputKeys(){return this.prompt.inputVariables}get outputKeys(){return[this.outputKey]}constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"prompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"llm",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"llmKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputKey",{enumerable:!0,configurable:!0,writable:!0,value:"text"}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.prompt=e.prompt,this.llm=e.llm,this.llmKwargs=e.llmKwargs,this.outputKey=e.outputKey??this.outputKey,this.outputParser=e.outputParser??new Xs,this.prompt.outputParser){if(e.outputParser)throw new Error("Cannot set both outputParser and prompt.outputParser");this.outputParser=this.prompt.outputParser}}_selectMemoryInputs(e){const t=super._selectMemoryInputs(e);for(const r of this.llm.callKeys)r in e&&delete t[r];return t}async _getFinalOutput(e,t,r){let a;return this.outputParser?a=await this.outputParser.parseResultWithPrompt(e,t,r==null?void 0:r.getChild()):a=e[0].text,a}call(e,t){return super.call(e,t)}async _call(e,t){const r={...e},a={...this.llmKwargs};for(const o of this.llm.callKeys)o in e&&(a[o]=e[o],delete r[o]);const i=await this.prompt.formatPromptValue(r),{generations:s}=await this.llm.generatePrompt([i],a,t==null?void 0:t.getChild());return{[this.outputKey]:await this._getFinalOutput(s[0],i,t)}}async predict(e,t){return(await this.call(e,t))[this.outputKey]}_chainType(){return"llm"}static async deserialize(e){const{llm:t,prompt:r}=e;if(!t)throw new Error("LLMChain must have llm");if(!r)throw new Error("LLMChain must have prompt");return new De({llm:await qa.deserialize(t),prompt:await gn.deserialize(r)})}serialize(){return{_type:`${this._chainType()}_chain`,llm:this.llm.serialize(),prompt:this.prompt.serialize()}}}const eo=Object.freeze(Object.defineProperty({__proto__:null,LLMChain:De},Symbol.toStringTag,{value:"Module"})),Ha=n=>{const e=n.split(""),t=[],r=(i,s)=>{for(let o=s;o<e.length;o+=1)if(i.includes(e[o]))return o;return-1};let a=0;for(;a<e.length;)if(e[a]==="{"&&a+1<e.length&&e[a+1]==="{")t.push({type:"literal",text:"{"}),a+=2;else if(e[a]==="}"&&a+1<e.length&&e[a+1]==="}")t.push({type:"literal",text:"}"}),a+=2;else if(e[a]==="{"){const i=r("}",a);if(i<0)throw new Error("Unclosed '{' in template.");t.push({type:"variable",name:e.slice(a+1,i).join("")}),a=i+1}else{if(e[a]==="}")throw new Error("Single '}' in template.");{const i=r("{}",a),s=(i<0?e.slice(a):e.slice(a,i)).join("");t.push({type:"literal",text:s}),a=i<0?e.length:i}}return t},to=(n,e)=>Ha(n).reduce((t,r)=>{if(r.type==="variable"){if(r.name in e)return t+e[r.name];throw new Error(`Missing value for input ${r.name}`)}return t+r.text},""),tn={"f-string":to,jinja2:(n,e)=>""},ro={"f-string":Ha,jinja2:n=>[]},Ya=(n,e,t)=>tn[e](n,t),no=(n,e)=>ro[e](n),ao=(n,e,t)=>{if(!(e in tn)){const r=Object.keys(tn);throw new Error(`Invalid template format. Got \`${e}\`;
                         should be one of ${r}`)}try{const r=t.reduce((a,i)=>(a[i]="foo",a),{});Ya(n,e,r)}catch(r){throw new Error(`Invalid prompt schema: ${r.message}`)}};class Ae extends Gs{constructor(e){if(super(e),Object.defineProperty(this,"template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.assign(this,e),this.validateTemplate){let t=this.inputVariables;this.partialVariables&&(t=t.concat(Object.keys(this.partialVariables))),ao(this.template,this.templateFormat,t)}}_getPromptType(){return"prompt"}async format(e){const t=await this.mergePartialAndUserVariables(e);return Ya(this.template,this.templateFormat,t)}static fromExamples(e,t,r,a=`

`,i=""){const s=[i,...e,t].join(a);return new Ae({inputVariables:r,template:s})}static fromTemplate(e,{templateFormat:t="f-string",...r}={}){const a=new Set;return no(e,t).forEach(i=>{i.type==="variable"&&a.add(i.name)}),new Ae({inputVariables:[...a],templateFormat:t,template:e,...r})}async partial(e){const t={...this};return t.inputVariables=this.inputVariables.filter(r=>!(r in e)),t.partialVariables={...this.partialVariables??{},...e},new Ae(t)}serialize(){if(this.outputParser!==void 0)throw new Error("Cannot serialize a prompt template with an output parser");return{_type:this._getPromptType(),input_variables:this.inputVariables,template:this.template,template_format:this.templateFormat}}static async deserialize(e){if(!e.template)throw new Error("Prompt template must have a template");return new Ae({inputVariables:e.input_variables,template:e.template,templateFormat:e.template_format})}}const Yn=Object.freeze(Object.defineProperty({__proto__:null,PromptTemplate:Ae},Symbol.toStringTag,{value:"Module"}));class Lt extends lr{get inputKeys(){return[this.inputKey,...this.llmChain.inputKeys].filter(e=>e!==this.documentVariableName)}get outputKeys(){return this.llmChain.outputKeys}constructor(e){super(e),Object.defineProperty(this,"llmChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"input_documents"}),Object.defineProperty(this,"documentVariableName",{enumerable:!0,configurable:!0,writable:!0,value:"context"}),this.llmChain=e.llmChain,this.documentVariableName=e.documentVariableName??this.documentVariableName,this.inputKey=e.inputKey??this.inputKey}_prepInputs(e){if(!(this.inputKey in e))throw new Error(`Document key ${this.inputKey} not found.`);const{[this.inputKey]:t,...r}=e,i=t.map(({pageContent:s})=>s).join(`

`);return{...r,[this.documentVariableName]:i}}async _call(e,t){return await this.llmChain.call(this._prepInputs(e),t==null?void 0:t.getChild("combine_documents"))}_chainType(){return"stuff_documents_chain"}static async deserialize(e){if(!e.llm_chain)throw new Error("Missing llm_chain");return new Lt({llmChain:await De.deserialize(e.llm_chain)})}serialize(){return{_type:this._chainType(),llm_chain:this.llmChain.serialize()}}}class jr extends lr{get inputKeys(){return[this.inputKey,...this.combineDocumentChain.inputKeys]}get outputKeys(){return this.combineDocumentChain.outputKeys}constructor(e){super(e),Object.defineProperty(this,"llmChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"input_documents"}),Object.defineProperty(this,"documentVariableName",{enumerable:!0,configurable:!0,writable:!0,value:"context"}),Object.defineProperty(this,"returnIntermediateSteps",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:3e3}),Object.defineProperty(this,"maxIterations",{enumerable:!0,configurable:!0,writable:!0,value:10}),Object.defineProperty(this,"ensureMapStep",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"combineDocumentChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.llmChain=e.llmChain,this.combineDocumentChain=e.combineDocumentChain,this.documentVariableName=e.documentVariableName??this.documentVariableName,this.ensureMapStep=e.ensureMapStep??this.ensureMapStep,this.inputKey=e.inputKey??this.inputKey,this.maxTokens=e.maxTokens??this.maxTokens,this.maxIterations=e.maxIterations??this.maxIterations,this.returnIntermediateSteps=e.returnIntermediateSteps??!1}async _call(e,t){if(!(this.inputKey in e))throw new Error(`Document key ${this.inputKey} not found.`);const{[this.inputKey]:r,...a}=e;let i=r,s=[];for(let c=0;c<this.maxIterations;c+=1){const m=i.map(O=>({[this.documentVariableName]:O.pageContent,...a}));if(c!==0||!this.ensureMapStep){const O=await this.combineDocumentChain.llmChain.prompt.format(this.combineDocumentChain._prepInputs({[this.combineDocumentChain.inputKey]:i,...a}));if(await this.combineDocumentChain.llmChain.llm.getNumTokens(O)<this.maxTokens)break}const j=await this.llmChain.apply(m,t?Array.from({length:m.length},(O,N)=>t.getChild(`map_${N+1}`)):void 0),{outputKey:z}=this.llmChain;this.returnIntermediateSteps&&(s=s.concat(j.map(O=>O[z]))),i=j.map(O=>({pageContent:O[z],metadata:{}}))}const o={[this.combineDocumentChain.inputKey]:i,...a},u=await this.combineDocumentChain.call(o,t==null?void 0:t.getChild("combine_documents"));return this.returnIntermediateSteps?{...u,intermediateSteps:s}:u}_chainType(){return"map_reduce_documents_chain"}static async deserialize(e){if(!e.llm_chain)throw new Error("Missing llm_chain");if(!e.combine_document_chain)throw new Error("Missing combine_document_chain");return new jr({llmChain:await De.deserialize(e.llm_chain),combineDocumentChain:await Lt.deserialize(e.combine_document_chain)})}serialize(){return{_type:this._chainType(),llm_chain:this.llmChain.serialize(),combine_document_chain:this.combineDocumentChain.serialize()}}}class Sr extends lr{get defaultDocumentPrompt(){return new Ae({inputVariables:["page_content"],template:"{page_content}"})}get inputKeys(){return[...new Set([this.inputKey,...this.llmChain.inputKeys,...this.refineLLMChain.inputKeys])].filter(e=>e!==this.documentVariableName&&e!==this.initialResponseName)}get outputKeys(){return[this.outputKey]}constructor(e){super(e),Object.defineProperty(this,"llmChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"input_documents"}),Object.defineProperty(this,"outputKey",{enumerable:!0,configurable:!0,writable:!0,value:"output_text"}),Object.defineProperty(this,"documentVariableName",{enumerable:!0,configurable:!0,writable:!0,value:"context"}),Object.defineProperty(this,"initialResponseName",{enumerable:!0,configurable:!0,writable:!0,value:"existing_answer"}),Object.defineProperty(this,"refineLLMChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"documentPrompt",{enumerable:!0,configurable:!0,writable:!0,value:this.defaultDocumentPrompt}),this.llmChain=e.llmChain,this.refineLLMChain=e.refineLLMChain,this.documentVariableName=e.documentVariableName??this.documentVariableName,this.inputKey=e.inputKey??this.inputKey,this.outputKey=e.outputKey??this.outputKey,this.documentPrompt=e.documentPrompt??this.documentPrompt,this.initialResponseName=e.initialResponseName??this.initialResponseName}async _constructInitialInputs(e,t){const r={page_content:e.pageContent,...e.metadata},a={};return this.documentPrompt.inputVariables.forEach(o=>{a[o]=r[o]}),{...{[this.documentVariableName]:await this.documentPrompt.format({...a})},...t}}async _constructRefineInputs(e,t){const r={page_content:e.pageContent,...e.metadata},a={};this.documentPrompt.inputVariables.forEach(o=>{a[o]=r[o]});const i={[this.documentVariableName]:await this.documentPrompt.format({...a})};return{[this.initialResponseName]:t,...i}}async _call(e,t){if(!(this.inputKey in e))throw new Error(`Document key ${this.inputKey} not found.`);const{[this.inputKey]:r,...a}=e,i=r,s=await this._constructInitialInputs(i[0],a);let o=await this.llmChain.predict({...s},t==null?void 0:t.getChild("answer"));for(let u=1;u<i.length;u+=1){const m={...await this._constructRefineInputs(i[u],o),...a};o=await this.refineLLMChain.predict({...m},t==null?void 0:t.getChild("refine"))}return{[this.outputKey]:o}}_chainType(){return"refine_documents_chain"}static async deserialize(e){const t=e.llm_chain;if(!t)throw new Error("Missing llm_chain");const r=e.refine_llm_chain;if(!r)throw new Error("Missing refine_llm_chain");return new Sr({llmChain:await De.deserialize(t),refineLLMChain:await De.deserialize(r)})}serialize(){return{_type:this._chainType(),llm_chain:this.llmChain.serialize(),refine_llm_chain:this.refineLLMChain.serialize()}}}const Gr=Object.freeze(Object.defineProperty({__proto__:null,MapReduceDocumentsChain:jr,RefineDocumentsChain:Sr,StuffDocumentsChain:Lt},Symbol.toStringTag,{value:"Module"}));class io extends Pt{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","prompts","chat"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}}class so extends Na{constructor(e){Array.isArray(e)&&(e={messages:e}),super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","prompts","chat"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"messages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.messages=e.messages}toString(){return JSON.stringify(this.messages)}toChatMessages(){return this.messages}}class yn extends io{constructor(e){"prompt"in e||(e={prompt:e}),super(e),Object.defineProperty(this,"prompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.prompt=e.prompt}get inputVariables(){return this.prompt.inputVariables}async formatMessages(e){return[await this.format(e)]}}class oo extends gn{constructor(e){super(e)}async format(e){return(await this.formatPromptValue(e)).toString()}async formatPromptValue(e){const t=await this.formatMessages(e);return new so(t)}}class At extends yn{async format(e){return new Da(await this.prompt.format(e))}static fromTemplate(e){return new this(Ae.fromTemplate(e))}}class uo extends yn{async format(e){return new Ma(await this.prompt.format(e))}static fromTemplate(e){return new this(Ae.fromTemplate(e))}}class Cr extends yn{async format(e){return new hs(await this.prompt.format(e))}static fromTemplate(e){return new this(Ae.fromTemplate(e))}}class Fe extends oo{get lc_aliases(){return{promptMessages:"messages"}}constructor(e){if(super(e),Object.defineProperty(this,"promptMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.assign(this,e),this.validateTemplate){const t=new Set;for(const s of this.promptMessages)for(const o of s.inputVariables)t.add(o);const r=new Set(this.partialVariables?this.inputVariables.concat(Object.keys(this.partialVariables)):this.inputVariables),a=new Set([...r].filter(s=>!t.has(s)));if(a.size>0)throw new Error(`Input variables \`${[...a]}\` are not used in any of the prompt messages.`);const i=new Set([...t].filter(s=>!r.has(s)));if(i.size>0)throw new Error(`Input variables \`${[...i]}\` are used in prompt messages but not in the prompt template.`)}}_getPromptType(){return"chat"}async formatMessages(e){const t=await this.mergePartialAndUserVariables(e);let r=[];for(const a of this.promptMessages){const i=a.inputVariables.reduce((o,u)=>{if(!(u in t))throw new Error(`Missing value for input variable \`${u}\``);return o[u]=t[u],o},{}),s=await a.formatMessages(i);r=r.concat(s)}return r}async partial(e){const t={...this};return t.inputVariables=this.inputVariables.filter(r=>!(r in e)),t.partialVariables={...this.partialVariables??{},...e},new Fe(t)}static fromPromptMessages(e){const t=e.reduce((i,s)=>i.concat(s instanceof Fe?s.promptMessages:[s]),[]),r=e.reduce((i,s)=>s instanceof Fe?Object.assign(i,s.partialVariables):i,Object.create(null)),a=new Set;for(const i of t)for(const s of i.inputVariables)s in r||a.add(s);return new Fe({inputVariables:[...a],promptMessages:t,partialVariables:r})}}class co{async getPromptAsync(e,t){return this.getPrompt(e).partial((t==null?void 0:t.partialVariables)??{})}}class dr extends co{constructor(e,t=[]){super(),Object.defineProperty(this,"defaultPrompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"conditionals",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.defaultPrompt=e,this.conditionals=t}getPrompt(e){for(const[t,r]of this.conditionals)if(t(e))return r;return this.defaultPrompt}}function hr(n){return n._modelType()==="base_chat_model"}const lo=new Ae({template:`Use the following pieces of context to answer the question at the end. If you don't know the answer, just say that you don't know, don't try to make up an answer.

{context}

Question: {question}
Helpful Answer:`,inputVariables:["context","question"]}),ho=`Use the following pieces of context to answer the users question. 
If you don't know the answer, just say that you don't know, don't try to make up an answer.
----------------
{context}`,po=[Cr.fromTemplate(ho),At.fromTemplate("{question}")],fo=Fe.fromPromptMessages(po),mo=new dr(lo,[[hr,fo]]),go=`Use the following portion of a long document to see if any of the text is relevant to answer the question. 
Return any relevant text verbatim.
{context}
Question: {question}
Relevant text, if any:`,yo=Ae.fromTemplate(go),bo=`Use the following portion of a long document to see if any of the text is relevant to answer the question. 
Return any relevant text verbatim.
----------------
{context}`,_o=[Cr.fromTemplate(bo),At.fromTemplate("{question}")],vo=Fe.fromPromptMessages(_o),wo=new dr(yo,[[hr,vo]]),Oo=`Given the following extracted parts of a long document and a question, create a final answer. 
If you don't know the answer, just say that you don't know. Don't try to make up an answer.

QUESTION: Which state/country's law governs the interpretation of the contract?
=========
Content: This Agreement is governed by English law and the parties submit to the exclusive jurisdiction of the English courts in  relation to any dispute (contractual or non-contractual) concerning this Agreement save that either party may apply to any court for an  injunction or other relief to protect its Intellectual Property Rights.

Content: No Waiver. Failure or delay in exercising any right or remedy under this Agreement shall not constitute a waiver of such (or any other)  right or remedy.

11.7 Severability. The invalidity, illegality or unenforceability of any term (or part of a term) of this Agreement shall not affect the continuation  in force of the remainder of the term (if any) and this Agreement.

11.8 No Agency. Except as expressly stated otherwise, nothing in this Agreement shall create an agency, partnership or joint venture of any  kind between the parties.

11.9 No Third-Party Beneficiaries.

Content: (b) if Google believes, in good faith, that the Distributor has violated or caused Google to violate any Anti-Bribery Laws (as  defined in Clause 8.5) or that such a violation is reasonably likely to occur,
=========
FINAL ANSWER: This Agreement is governed by English law.

QUESTION: What did the president say about Michael Jackson?
=========
Content: Madam Speaker, Madam Vice President, our First Lady and Second Gentleman. Members of Congress and the Cabinet. Justices of the Supreme Court. My fellow Americans.  

Last year COVID-19 kept us apart. This year we are finally together again. 

Tonight, we meet as Democrats Republicans and Independents. But most importantly as Americans. 

With a duty to one another to the American people to the Constitution. 

And with an unwavering resolve that freedom will always triumph over tyranny. 

Six days ago, Russias Vladimir Putin sought to shake the foundations of the free world thinking he could make it bend to his menacing ways. But he badly miscalculated. 

He thought he could roll into Ukraine and the world would roll over. Instead he met a wall of strength he never imagined. 

He met the Ukrainian people. 

From President Zelenskyy to every Ukrainian, their fearlessness, their courage, their determination, inspires the world. 

Groups of citizens blocking tanks with their bodies. Everyone from students to retirees teachers turned soldiers defending their homeland.

Content: And we wont stop. 

We have lost so much to COVID-19. Time with one another. And worst of all, so much loss of life. 

Lets use this moment to reset. Lets stop looking at COVID-19 as a partisan dividing line and see it for what it is: A God-awful disease.  

Lets stop seeing each other as enemies, and start seeing each other for who we really are: Fellow Americans.  

We cant change how divided weve been. But we can change how we move forwardon COVID-19 and other issues we must face together. 

I recently visited the New York City Police Department days after the funerals of Officer Wilbert Mora and his partner, Officer Jason Rivera. 

They were responding to a 9-1-1 call when a man shot and killed them with a stolen gun. 

Officer Mora was 27 years old. 

Officer Rivera was 22. 

Both Dominican Americans whod grown up on the same streets they later chose to patrol as police officers. 

I spoke with their families and told them that we are forever in debt for their sacrifice, and we will carry on their mission to restore the trust and safety every community deserves.

Content: And a proud Ukrainian people, who have known 30 years  of independence, have repeatedly shown that they will not tolerate anyone who tries to take their country backwards.  

To all Americans, I will be honest with you, as Ive always promised. A Russian dictator, invading a foreign country, has costs around the world. 

And Im taking robust action to make sure the pain of our sanctions  is targeted at Russias economy. And I will use every tool at our disposal to protect American businesses and consumers. 

Tonight, I can announce that the United States has worked with 30 other countries to release 60 Million barrels of oil from reserves around the world.  

America will lead that effort, releasing 30 Million barrels from our own Strategic Petroleum Reserve. And we stand ready to do more if necessary, unified with our allies.  

These steps will help blunt gas prices here at home. And I know the news about whats happening can seem alarming. 

But I want you to know that we are going to be okay.

Content: More support for patients and families. 

To get there, I call on Congress to fund ARPA-H, the Advanced Research Projects Agency for Health. 

Its based on DARPAthe Defense Department project that led to the Internet, GPS, and so much more.  

ARPA-H will have a singular purposeto drive breakthroughs in cancer, Alzheimers, diabetes, and more. 

A unity agenda for the nation. 

We can do this. 

My fellow Americanstonight , we have gathered in a sacred spacethe citadel of our democracy. 

In this Capitol, generation after generation, Americans have debated great questions amid great strife, and have done great things. 

We have fought for freedom, expanded liberty, defeated totalitarianism and terror. 

And built the strongest, freest, and most prosperous nation the world has ever known. 

Now is the hour. 

Our moment of responsibility. 

Our test of resolve and conscience, of history itself. 

It is in this moment that our character is formed. Our purpose is found. Our future is forged. 

Well I know this nation.
=========
FINAL ANSWER: The president did not mention Michael Jackson.

QUESTION: {question}
=========
{summaries}
=========
FINAL ANSWER:`,Po=Ae.fromTemplate(Oo),Ao=`Given the following extracted parts of a long document and a question, create a final answer. 
If you don't know the answer, just say that you don't know. Don't try to make up an answer.
----------------
{summaries}`,xo=[Cr.fromTemplate(Ao),At.fromTemplate("{question}")],Eo=Fe.fromPromptMessages(xo),ko=new dr(Po,[[hr,Eo]]),Io=`The original question is as follows: {question}
We have provided an existing answer: {existing_answer}
We have the opportunity to refine the existing answer
(only if needed) with some more context below.
------------
{context}
------------
Given the new context, refine the original answer to better answer the question. 
If the context isn't useful, return the original answer.`,To=new Ae({inputVariables:["question","existing_answer","context"],template:Io}),jo=`The original question is as follows: {question}
We have provided an existing answer: {existing_answer}
We have the opportunity to refine the existing answer
(only if needed) with some more context below.
------------
{context}
------------
Given the new context, refine the original answer to better answer the question. 
If the context isn't useful, return the original answer.`,So=[At.fromTemplate("{question}"),uo.fromTemplate("{existing_answer}"),At.fromTemplate(jo)],Co=Fe.fromPromptMessages(So),No=new dr(To,[[hr,Co]]),Do=`Context information is below. 
---------------------
{context}
---------------------
Given the context information and not prior knowledge, answer the question: {question}`,Mo=new Ae({inputVariables:["context","question"],template:Do}),Lo=`Context information is below. 
---------------------
{context}
---------------------
Given the context information and not prior knowledge, answer any questions`,Ro=[Cr.fromTemplate(Lo),At.fromTemplate("{question}")],Bo=Fe.fromPromptMessages(Ro),Zo=new dr(Mo,[[hr,Bo]]),Uo=(n,e={type:"stuff"})=>{const{type:t}=e;if(t==="stuff")return Ko(n,e);if(t==="map_reduce")return Vo(n,e);if(t==="refine")return zo(n,e);throw new Error(`Invalid _type: ${t}`)};function Ko(n,e={}){const{prompt:t=mo.getPrompt(n),verbose:r}=e,a=new De({prompt:t,llm:n,verbose:r});return new Lt({llmChain:a,verbose:r})}function Vo(n,e={}){const{combineMapPrompt:t=wo.getPrompt(n),combinePrompt:r=ko.getPrompt(n),verbose:a,returnIntermediateSteps:i}=e,s=new De({prompt:t,llm:n,verbose:a}),o=new De({prompt:r,llm:n,verbose:a}),u=new Lt({llmChain:o,documentVariableName:"summaries",verbose:a});return new jr({llmChain:s,combineDocumentChain:u,returnIntermediateSteps:i,verbose:a})}function zo(n,e={}){const{questionPrompt:t=Zo.getPrompt(n),refinePrompt:r=No.getPrompt(n),verbose:a}=e,i=new De({prompt:t,llm:n,verbose:a}),s=new De({prompt:r,llm:n,verbose:a});return new Sr({llmChain:i,refineLLMChain:s,verbose:a})}const $o=`Given the following conversation and a follow up question, rephrase the follow up question to be a standalone question.

Chat History:
{chat_history}
Follow Up Input: {question}
Standalone question:`;class bn extends lr{get inputKeys(){return[this.inputKey,this.chatHistoryKey]}get outputKeys(){return this.combineDocumentsChain.outputKeys.concat(this.returnSourceDocuments?["sourceDocuments"]:[])}constructor(e){super(e),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"question"}),Object.defineProperty(this,"chatHistoryKey",{enumerable:!0,configurable:!0,writable:!0,value:"chat_history"}),Object.defineProperty(this,"retriever",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"combineDocumentsChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"questionGeneratorChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSourceDocuments",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.retriever=e.retriever,this.combineDocumentsChain=e.combineDocumentsChain,this.questionGeneratorChain=e.questionGeneratorChain,this.inputKey=e.inputKey??this.inputKey,this.returnSourceDocuments=e.returnSourceDocuments??this.returnSourceDocuments}static getChatHistoryString(e){return Array.isArray(e)?e.map(t=>t._getType()==="human"?`Human: ${t.content}`:t._getType()==="ai"?`Assistant: ${t.content}`:`${t.content}`).join(`
`):e}async _call(e,t){if(!(this.inputKey in e))throw new Error(`Question key ${this.inputKey} not found.`);if(!(this.chatHistoryKey in e))throw new Error(`Chat history key ${this.chatHistoryKey} not found.`);const r=e[this.inputKey],a=bn.getChatHistoryString(e[this.chatHistoryKey]);let i=r;if(a.length>0){const c=await this.questionGeneratorChain.call({question:r,chat_history:a},t==null?void 0:t.getChild("question_generator")),m=Object.keys(c);if(m.length===1)i=c[m[0]];else throw new Error("Return from llm chain has multiple values, only single values supported.")}const s=await this.retriever.getRelevantDocuments(i),o={question:i,input_documents:s,chat_history:a},u=await this.combineDocumentsChain.call(o,t==null?void 0:t.getChild("combine_documents"));return this.returnSourceDocuments?{...u,sourceDocuments:s}:u}_chainType(){return"conversational_retrieval_chain"}static async deserialize(e,t){throw new Error("Not implemented.")}serialize(){throw new Error("Not implemented.")}static fromLLM(e,t,r={}){const{questionGeneratorTemplate:a,qaTemplate:i,qaChainOptions:s={type:"stuff",prompt:i?Ae.fromTemplate(i):void 0},questionGeneratorChainOptions:o,verbose:u,...c}=r,m=Uo(e,s),P=Ae.fromTemplate((o==null?void 0:o.template)??a??$o),j=new De({prompt:P,llm:(o==null?void 0:o.llm)??e,verbose:u});return new this({retriever:t,combineDocumentsChain:m,questionGeneratorChain:j,verbose:u,...c})}}var ce;(function(n){n.assertEqual=a=>a;function e(a){}n.assertIs=e;function t(a){throw new Error}n.assertNever=t,n.arrayToEnum=a=>{const i={};for(const s of a)i[s]=s;return i},n.getValidEnumValues=a=>{const i=n.objectKeys(a).filter(o=>typeof a[a[o]]!="number"),s={};for(const o of i)s[o]=a[o];return n.objectValues(s)},n.objectValues=a=>n.objectKeys(a).map(function(i){return a[i]}),n.objectKeys=typeof Object.keys=="function"?a=>Object.keys(a):a=>{const i=[];for(const s in a)Object.prototype.hasOwnProperty.call(a,s)&&i.push(s);return i},n.find=(a,i)=>{for(const s of a)if(i(s))return s},n.isInteger=typeof Number.isInteger=="function"?a=>Number.isInteger(a):a=>typeof a=="number"&&isFinite(a)&&Math.floor(a)===a;function r(a,i=" | "){return a.map(s=>typeof s=="string"?`'${s}'`:s).join(i)}n.joinValues=r,n.jsonStringifyReplacer=(a,i)=>typeof i=="bigint"?i.toString():i})(ce||(ce={}));var xr;(function(n){n.mergeShapes=(e,t)=>({...e,...t})})(xr||(xr={}));const K=ce.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Je=n=>{switch(typeof n){case"undefined":return K.undefined;case"string":return K.string;case"number":return isNaN(n)?K.nan:K.number;case"boolean":return K.boolean;case"function":return K.function;case"bigint":return K.bigint;case"symbol":return K.symbol;case"object":return Array.isArray(n)?K.array:n===null?K.null:n.then&&typeof n.then=="function"&&n.catch&&typeof n.catch=="function"?K.promise:typeof Map<"u"&&n instanceof Map?K.map:typeof Set<"u"&&n instanceof Set?K.set:typeof Date<"u"&&n instanceof Date?K.date:K.object;default:return K.unknown}},D=ce.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),Wa=n=>JSON.stringify(n,null,2).replace(/"([^"]+)":/g,"$1:");class Ze extends Error{constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}get errors(){return this.issues}format(e){const t=e||function(i){return i.message},r={_errors:[]},a=i=>{for(const s of i.issues)if(s.code==="invalid_union")s.unionErrors.map(a);else if(s.code==="invalid_return_type")a(s.returnTypeError);else if(s.code==="invalid_arguments")a(s.argumentsError);else if(s.path.length===0)r._errors.push(t(s));else{let o=r,u=0;for(;u<s.path.length;){const c=s.path[u];u===s.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(t(s))):o[c]=o[c]||{_errors:[]},o=o[c],u++}}};return a(this),r}toString(){return this.message}get message(){return JSON.stringify(this.issues,ce.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},r=[];for(const a of this.issues)a.path.length>0?(t[a.path[0]]=t[a.path[0]]||[],t[a.path[0]].push(e(a))):r.push(e(a));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}Ze.create=n=>new Ze(n);const xt=(n,e)=>{let t;switch(n.code){case D.invalid_type:n.received===K.undefined?t="Required":t=`Expected ${n.expected}, received ${n.received}`;break;case D.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(n.expected,ce.jsonStringifyReplacer)}`;break;case D.unrecognized_keys:t=`Unrecognized key(s) in object: ${ce.joinValues(n.keys,", ")}`;break;case D.invalid_union:t="Invalid input";break;case D.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${ce.joinValues(n.options)}`;break;case D.invalid_enum_value:t=`Invalid enum value. Expected ${ce.joinValues(n.options)}, received '${n.received}'`;break;case D.invalid_arguments:t="Invalid function arguments";break;case D.invalid_return_type:t="Invalid function return type";break;case D.invalid_date:t="Invalid date";break;case D.invalid_string:typeof n.validation=="object"?"includes"in n.validation?(t=`Invalid input: must include "${n.validation.includes}"`,typeof n.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${n.validation.position}`)):"startsWith"in n.validation?t=`Invalid input: must start with "${n.validation.startsWith}"`:"endsWith"in n.validation?t=`Invalid input: must end with "${n.validation.endsWith}"`:ce.assertNever(n.validation):n.validation!=="regex"?t=`Invalid ${n.validation}`:t="Invalid";break;case D.too_small:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at least":"more than"} ${n.minimum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at least":"over"} ${n.minimum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(n.minimum))}`:t="Invalid input";break;case D.too_big:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at most":"less than"} ${n.maximum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at most":"under"} ${n.maximum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="bigint"?t=`BigInt must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly":n.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(n.maximum))}`:t="Invalid input";break;case D.custom:t="Invalid input";break;case D.invalid_intersection_types:t="Intersection results could not be merged";break;case D.not_multiple_of:t=`Number must be a multiple of ${n.multipleOf}`;break;case D.not_finite:t="Number must be finite";break;default:t=e.defaultError,ce.assertNever(n)}return{message:t}};let Ga=xt;function Ja(n){Ga=n}function Xt(){return Ga}const er=n=>{const{data:e,path:t,errorMaps:r,issueData:a}=n,i=[...t,...a.path||[]],s={...a,path:i};let o="";const u=r.filter(c=>!!c).slice().reverse();for(const c of u)o=c(s,{data:e,defaultError:o}).message;return{...a,path:i,message:a.message||o}},Qa=[];function V(n,e){const t=er({issueData:e,data:n.data,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,Xt(),xt].filter(r=>!!r)});n.common.issues.push(t)}class xe{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const r=[];for(const a of t){if(a.status==="aborted")return J;a.status==="dirty"&&e.dirty(),r.push(a.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,t){const r=[];for(const a of t)r.push({key:await a.key,value:await a.value});return xe.mergeObjectSync(e,r)}static mergeObjectSync(e,t){const r={};for(const a of t){const{key:i,value:s}=a;if(i.status==="aborted"||s.status==="aborted")return J;i.status==="dirty"&&e.dirty(),s.status==="dirty"&&e.dirty(),(typeof s.value<"u"||a.alwaysSet)&&(r[i.value]=s.value)}return{status:e.value,value:r}}}const J=Object.freeze({status:"aborted"}),_n=n=>({status:"dirty",value:n}),Ie=n=>({status:"valid",value:n}),Er=n=>n.status==="aborted",kr=n=>n.status==="dirty",tr=n=>n.status==="valid",rr=n=>typeof Promise<"u"&&n instanceof Promise;var H;(function(n){n.errToObj=e=>typeof e=="string"?{message:e}:e||{},n.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(H||(H={}));class He{constructor(e,t,r,a){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=a}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Wn=(n,e)=>{if(tr(e))return{success:!0,data:e.value};if(!n.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new Ze(n.common.issues);return this._error=t,this._error}}};function ee(n){if(!n)return{};const{errorMap:e,invalid_type_error:t,required_error:r,description:a}=n;if(e&&(t||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:a}:{errorMap:(s,o)=>s.code!=="invalid_type"?{message:o.defaultError}:typeof o.data>"u"?{message:r??o.defaultError}:{message:t??o.defaultError},description:a}}class X{constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(e){return Je(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:Je(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new xe,ctx:{common:e.parent.common,data:e.data,parsedType:Je(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(rr(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){var r;const a={common:{issues:[],async:(r=t==null?void 0:t.async)!==null&&r!==void 0?r:!1,contextualErrorMap:t==null?void 0:t.errorMap},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Je(e)},i=this._parseSync({data:e,path:a.path,parent:a});return Wn(a,i)}async parseAsync(e,t){const r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){const r={common:{issues:[],contextualErrorMap:t==null?void 0:t.errorMap,async:!0},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Je(e)},a=this._parse({data:e,path:r.path,parent:r}),i=await(rr(a)?a:Promise.resolve(a));return Wn(r,i)}refine(e,t){const r=a=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(a):t;return this._refinement((a,i)=>{const s=e(a),o=()=>i.addIssue({code:D.custom,...r(a)});return typeof Promise<"u"&&s instanceof Promise?s.then(u=>u?!0:(o(),!1)):s?!0:(o(),!1)})}refinement(e,t){return this._refinement((r,a)=>e(r)?!0:(a.addIssue(typeof t=="function"?t(r,a):t),!1))}_refinement(e){return new Me({schema:this,typeName:W.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}optional(){return qe.create(this,this._def)}nullable(){return ut.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Ue.create(this,this._def)}promise(){return mt.create(this,this._def)}or(e){return Tt.create([this,e],this._def)}and(e){return jt.create(this,e,this._def)}transform(e){return new Me({...ee(this._def),schema:this,typeName:W.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new Mt({...ee(this._def),innerType:this,defaultValue:t,typeName:W.ZodDefault})}brand(){return new vn({typeName:W.ZodBranded,type:this,...ee(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new sr({...ee(this._def),innerType:this,catchValue:t,typeName:W.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return Rt.create(this,e)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Fo=/^c[^\s-]{8,}$/i,qo=/^[a-z][a-z0-9]*$/,Ho=/[0-9A-HJKMNP-TV-Z]{26}/,Yo=/^([a-f0-9]{8}-[a-f0-9]{4}-[1-5][a-f0-9]{3}-[a-f0-9]{4}-[a-f0-9]{12}|00000000-0000-0000-0000-000000000000)$/i,Wo=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\])|(\[IPv6:(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))\])|([A-Za-z0-9]([A-Za-z0-9-]*[A-Za-z0-9])*(\.[A-Za-z]{2,})+))$/,Go=/^(\p{Extended_Pictographic}|\p{Emoji_Component})+$/u,Jo=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,Qo=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,Xo=n=>n.precision?n.offset?new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${n.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${n.precision}}Z$`):n.precision===0?n.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):n.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$");function eu(n,e){return!!((e==="v4"||!e)&&Jo.test(n)||(e==="v6"||!e)&&Qo.test(n))}class Be extends X{constructor(){super(...arguments),this._regex=(e,t,r)=>this.refinement(a=>e.test(a),{validation:t,code:D.invalid_string,...H.errToObj(r)}),this.nonempty=e=>this.min(1,H.errToObj(e)),this.trim=()=>new Be({...this._def,checks:[...this._def.checks,{kind:"trim"}]}),this.toLowerCase=()=>new Be({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]}),this.toUpperCase=()=>new Be({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==K.string){const i=this._getOrReturnCtx(e);return V(i,{code:D.invalid_type,expected:K.string,received:i.parsedType}),J}const r=new xe;let a;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(a=this._getOrReturnCtx(e,a),V(a,{code:D.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="max")e.data.length>i.value&&(a=this._getOrReturnCtx(e,a),V(a,{code:D.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="length"){const s=e.data.length>i.value,o=e.data.length<i.value;(s||o)&&(a=this._getOrReturnCtx(e,a),s?V(a,{code:D.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):o&&V(a,{code:D.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if(i.kind==="email")Wo.test(e.data)||(a=this._getOrReturnCtx(e,a),V(a,{validation:"email",code:D.invalid_string,message:i.message}),r.dirty());else if(i.kind==="emoji")Go.test(e.data)||(a=this._getOrReturnCtx(e,a),V(a,{validation:"emoji",code:D.invalid_string,message:i.message}),r.dirty());else if(i.kind==="uuid")Yo.test(e.data)||(a=this._getOrReturnCtx(e,a),V(a,{validation:"uuid",code:D.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid")Fo.test(e.data)||(a=this._getOrReturnCtx(e,a),V(a,{validation:"cuid",code:D.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid2")qo.test(e.data)||(a=this._getOrReturnCtx(e,a),V(a,{validation:"cuid2",code:D.invalid_string,message:i.message}),r.dirty());else if(i.kind==="ulid")Ho.test(e.data)||(a=this._getOrReturnCtx(e,a),V(a,{validation:"ulid",code:D.invalid_string,message:i.message}),r.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{a=this._getOrReturnCtx(e,a),V(a,{validation:"url",code:D.invalid_string,message:i.message}),r.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(a=this._getOrReturnCtx(e,a),V(a,{validation:"regex",code:D.invalid_string,message:i.message}),r.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(a=this._getOrReturnCtx(e,a),V(a,{code:D.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(a=this._getOrReturnCtx(e,a),V(a,{code:D.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(a=this._getOrReturnCtx(e,a),V(a,{code:D.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):i.kind==="datetime"?Xo(i).test(e.data)||(a=this._getOrReturnCtx(e,a),V(a,{code:D.invalid_string,validation:"datetime",message:i.message}),r.dirty()):i.kind==="ip"?eu(e.data,i.version)||(a=this._getOrReturnCtx(e,a),V(a,{validation:"ip",code:D.invalid_string,message:i.message}),r.dirty()):ce.assertNever(i);return{status:r.value,value:e.data}}_addCheck(e){return new Be({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...H.errToObj(e)})}url(e){return this._addCheck({kind:"url",...H.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...H.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...H.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...H.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...H.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...H.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...H.errToObj(e)})}datetime(e){var t;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(t=e==null?void 0:e.offset)!==null&&t!==void 0?t:!1,...H.errToObj(e==null?void 0:e.message)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...H.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t==null?void 0:t.position,...H.errToObj(t==null?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...H.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...H.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...H.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...H.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...H.errToObj(t)})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}Be.create=n=>{var e;return new Be({checks:[],typeName:W.ZodString,coerce:(e=n==null?void 0:n.coerce)!==null&&e!==void 0?e:!1,...ee(n)})};function tu(n,e){const t=(n.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,a=t>r?t:r,i=parseInt(n.toFixed(a).replace(".","")),s=parseInt(e.toFixed(a).replace(".",""));return i%s/Math.pow(10,a)}class Xe extends X{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==K.number){const i=this._getOrReturnCtx(e);return V(i,{code:D.invalid_type,expected:K.number,received:i.parsedType}),J}let r;const a=new xe;for(const i of this._def.checks)i.kind==="int"?ce.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),V(r,{code:D.invalid_type,expected:"integer",received:"float",message:i.message}),a.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),V(r,{code:D.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),V(r,{code:D.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),a.dirty()):i.kind==="multipleOf"?tu(e.data,i.value)!==0&&(r=this._getOrReturnCtx(e,r),V(r,{code:D.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),V(r,{code:D.not_finite,message:i.message}),a.dirty()):ce.assertNever(i);return{status:a.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,H.toString(t))}gt(e,t){return this.setLimit("min",e,!1,H.toString(t))}lte(e,t){return this.setLimit("max",e,!0,H.toString(t))}lt(e,t){return this.setLimit("max",e,!1,H.toString(t))}setLimit(e,t,r,a){return new Xe({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:H.toString(a)}]})}_addCheck(e){return new Xe({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:H.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:H.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:H.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:H.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:H.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:H.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:H.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:H.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:H.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&ce.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(t===null||r.value>t)&&(t=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}}Xe.create=n=>new Xe({checks:[],typeName:W.ZodNumber,coerce:(n==null?void 0:n.coerce)||!1,...ee(n)});class et extends X{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce&&(e.data=BigInt(e.data)),this._getType(e)!==K.bigint){const i=this._getOrReturnCtx(e);return V(i,{code:D.invalid_type,expected:K.bigint,received:i.parsedType}),J}let r;const a=new xe;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),V(r,{code:D.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),V(r,{code:D.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),a.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),V(r,{code:D.not_multiple_of,multipleOf:i.value,message:i.message}),a.dirty()):ce.assertNever(i);return{status:a.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,H.toString(t))}gt(e,t){return this.setLimit("min",e,!1,H.toString(t))}lte(e,t){return this.setLimit("max",e,!0,H.toString(t))}lt(e,t){return this.setLimit("max",e,!1,H.toString(t))}setLimit(e,t,r,a){return new et({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:H.toString(a)}]})}_addCheck(e){return new et({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:H.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:H.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:H.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:H.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:H.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}et.create=n=>{var e;return new et({checks:[],typeName:W.ZodBigInt,coerce:(e=n==null?void 0:n.coerce)!==null&&e!==void 0?e:!1,...ee(n)})};class Et extends X{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==K.boolean){const r=this._getOrReturnCtx(e);return V(r,{code:D.invalid_type,expected:K.boolean,received:r.parsedType}),J}return Ie(e.data)}}Et.create=n=>new Et({typeName:W.ZodBoolean,coerce:(n==null?void 0:n.coerce)||!1,...ee(n)});class st extends X{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==K.date){const i=this._getOrReturnCtx(e);return V(i,{code:D.invalid_type,expected:K.date,received:i.parsedType}),J}if(isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return V(i,{code:D.invalid_date}),J}const r=new xe;let a;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(a=this._getOrReturnCtx(e,a),V(a,{code:D.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(a=this._getOrReturnCtx(e,a),V(a,{code:D.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):ce.assertNever(i);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new st({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:H.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:H.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}st.create=n=>new st({checks:[],coerce:(n==null?void 0:n.coerce)||!1,typeName:W.ZodDate,...ee(n)});class nr extends X{_parse(e){if(this._getType(e)!==K.symbol){const r=this._getOrReturnCtx(e);return V(r,{code:D.invalid_type,expected:K.symbol,received:r.parsedType}),J}return Ie(e.data)}}nr.create=n=>new nr({typeName:W.ZodSymbol,...ee(n)});class kt extends X{_parse(e){if(this._getType(e)!==K.undefined){const r=this._getOrReturnCtx(e);return V(r,{code:D.invalid_type,expected:K.undefined,received:r.parsedType}),J}return Ie(e.data)}}kt.create=n=>new kt({typeName:W.ZodUndefined,...ee(n)});class It extends X{_parse(e){if(this._getType(e)!==K.null){const r=this._getOrReturnCtx(e);return V(r,{code:D.invalid_type,expected:K.null,received:r.parsedType}),J}return Ie(e.data)}}It.create=n=>new It({typeName:W.ZodNull,...ee(n)});class ft extends X{constructor(){super(...arguments),this._any=!0}_parse(e){return Ie(e.data)}}ft.create=n=>new ft({typeName:W.ZodAny,...ee(n)});class it extends X{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Ie(e.data)}}it.create=n=>new it({typeName:W.ZodUnknown,...ee(n)});class Ye extends X{_parse(e){const t=this._getOrReturnCtx(e);return V(t,{code:D.invalid_type,expected:K.never,received:t.parsedType}),J}}Ye.create=n=>new Ye({typeName:W.ZodNever,...ee(n)});class ar extends X{_parse(e){if(this._getType(e)!==K.undefined){const r=this._getOrReturnCtx(e);return V(r,{code:D.invalid_type,expected:K.void,received:r.parsedType}),J}return Ie(e.data)}}ar.create=n=>new ar({typeName:W.ZodVoid,...ee(n)});class Ue extends X{_parse(e){const{ctx:t,status:r}=this._processInputParams(e),a=this._def;if(t.parsedType!==K.array)return V(t,{code:D.invalid_type,expected:K.array,received:t.parsedType}),J;if(a.exactLength!==null){const s=t.data.length>a.exactLength.value,o=t.data.length<a.exactLength.value;(s||o)&&(V(t,{code:s?D.too_big:D.too_small,minimum:o?a.exactLength.value:void 0,maximum:s?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),r.dirty())}if(a.minLength!==null&&t.data.length<a.minLength.value&&(V(t,{code:D.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),r.dirty()),a.maxLength!==null&&t.data.length>a.maxLength.value&&(V(t,{code:D.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((s,o)=>a.type._parseAsync(new He(t,s,t.path,o)))).then(s=>xe.mergeArray(r,s));const i=[...t.data].map((s,o)=>a.type._parseSync(new He(t,s,t.path,o)));return xe.mergeArray(r,i)}get element(){return this._def.type}min(e,t){return new Ue({...this._def,minLength:{value:e,message:H.toString(t)}})}max(e,t){return new Ue({...this._def,maxLength:{value:e,message:H.toString(t)}})}length(e,t){return new Ue({...this._def,exactLength:{value:e,message:H.toString(t)}})}nonempty(e){return this.min(1,e)}}Ue.create=(n,e)=>new Ue({type:n,minLength:null,maxLength:null,exactLength:null,typeName:W.ZodArray,...ee(e)});function _t(n){if(n instanceof fe){const e={};for(const t in n.shape){const r=n.shape[t];e[t]=qe.create(_t(r))}return new fe({...n._def,shape:()=>e})}else return n instanceof Ue?new Ue({...n._def,type:_t(n.element)}):n instanceof qe?qe.create(_t(n.unwrap())):n instanceof ut?ut.create(_t(n.unwrap())):n instanceof ze?ze.create(n.items.map(e=>_t(e))):n}class fe extends X{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=ce.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==K.object){const c=this._getOrReturnCtx(e);return V(c,{code:D.invalid_type,expected:K.object,received:c.parsedType}),J}const{status:r,ctx:a}=this._processInputParams(e),{shape:i,keys:s}=this._getCached(),o=[];if(!(this._def.catchall instanceof Ye&&this._def.unknownKeys==="strip"))for(const c in a.data)s.includes(c)||o.push(c);const u=[];for(const c of s){const m=i[c],P=a.data[c];u.push({key:{status:"valid",value:c},value:m._parse(new He(a,P,a.path,c)),alwaysSet:c in a.data})}if(this._def.catchall instanceof Ye){const c=this._def.unknownKeys;if(c==="passthrough")for(const m of o)u.push({key:{status:"valid",value:m},value:{status:"valid",value:a.data[m]}});else if(c==="strict")o.length>0&&(V(a,{code:D.unrecognized_keys,keys:o}),r.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const m of o){const P=a.data[m];u.push({key:{status:"valid",value:m},value:c._parse(new He(a,P,a.path,m)),alwaysSet:m in a.data})}}return a.common.async?Promise.resolve().then(async()=>{const c=[];for(const m of u){const P=await m.key;c.push({key:P,value:await m.value,alwaysSet:m.alwaysSet})}return c}).then(c=>xe.mergeObjectSync(r,c)):xe.mergeObjectSync(r,u)}get shape(){return this._def.shape()}strict(e){return H.errToObj,new fe({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,r)=>{var a,i,s,o;const u=(s=(i=(a=this._def).errorMap)===null||i===void 0?void 0:i.call(a,t,r).message)!==null&&s!==void 0?s:r.defaultError;return t.code==="unrecognized_keys"?{message:(o=H.errToObj(e).message)!==null&&o!==void 0?o:u}:{message:u}}}:{}})}strip(){return new fe({...this._def,unknownKeys:"strip"})}passthrough(){return new fe({...this._def,unknownKeys:"passthrough"})}extend(e){return new fe({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new fe({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:W.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new fe({...this._def,catchall:e})}pick(e){const t={};return ce.objectKeys(e).forEach(r=>{e[r]&&this.shape[r]&&(t[r]=this.shape[r])}),new fe({...this._def,shape:()=>t})}omit(e){const t={};return ce.objectKeys(this.shape).forEach(r=>{e[r]||(t[r]=this.shape[r])}),new fe({...this._def,shape:()=>t})}deepPartial(){return _t(this)}partial(e){const t={};return ce.objectKeys(this.shape).forEach(r=>{const a=this.shape[r];e&&!e[r]?t[r]=a:t[r]=a.optional()}),new fe({...this._def,shape:()=>t})}required(e){const t={};return ce.objectKeys(this.shape).forEach(r=>{if(e&&!e[r])t[r]=this.shape[r];else{let i=this.shape[r];for(;i instanceof qe;)i=i._def.innerType;t[r]=i}}),new fe({...this._def,shape:()=>t})}keyof(){return Xa(ce.objectKeys(this.shape))}}fe.create=(n,e)=>new fe({shape:()=>n,unknownKeys:"strip",catchall:Ye.create(),typeName:W.ZodObject,...ee(e)});fe.strictCreate=(n,e)=>new fe({shape:()=>n,unknownKeys:"strict",catchall:Ye.create(),typeName:W.ZodObject,...ee(e)});fe.lazycreate=(n,e)=>new fe({shape:n,unknownKeys:"strip",catchall:Ye.create(),typeName:W.ZodObject,...ee(e)});class Tt extends X{_parse(e){const{ctx:t}=this._processInputParams(e),r=this._def.options;function a(i){for(const o of i)if(o.result.status==="valid")return o.result;for(const o of i)if(o.result.status==="dirty")return t.common.issues.push(...o.ctx.common.issues),o.result;const s=i.map(o=>new Ze(o.ctx.common.issues));return V(t,{code:D.invalid_union,unionErrors:s}),J}if(t.common.async)return Promise.all(r.map(async i=>{const s={...t,common:{...t.common,issues:[]},parent:null};return{result:await i._parseAsync({data:t.data,path:t.path,parent:s}),ctx:s}})).then(a);{let i;const s=[];for(const u of r){const c={...t,common:{...t.common,issues:[]},parent:null},m=u._parseSync({data:t.data,path:t.path,parent:c});if(m.status==="valid")return m;m.status==="dirty"&&!i&&(i={result:m,ctx:c}),c.common.issues.length&&s.push(c.common.issues)}if(i)return t.common.issues.push(...i.ctx.common.issues),i.result;const o=s.map(u=>new Ze(u));return V(t,{code:D.invalid_union,unionErrors:o}),J}}get options(){return this._def.options}}Tt.create=(n,e)=>new Tt({options:n,typeName:W.ZodUnion,...ee(e)});const wr=n=>n instanceof Ct?wr(n.schema):n instanceof Me?wr(n.innerType()):n instanceof Nt?[n.value]:n instanceof tt?n.options:n instanceof Dt?Object.keys(n.enum):n instanceof Mt?wr(n._def.innerType):n instanceof kt?[void 0]:n instanceof It?[null]:null;class pr extends X{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==K.object)return V(t,{code:D.invalid_type,expected:K.object,received:t.parsedType}),J;const r=this.discriminator,a=t.data[r],i=this.optionsMap.get(a);return i?t.common.async?i._parseAsync({data:t.data,path:t.path,parent:t}):i._parseSync({data:t.data,path:t.path,parent:t}):(V(t,{code:D.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),J)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,r){const a=new Map;for(const i of t){const s=wr(i.shape[e]);if(!s)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const o of s){if(a.has(o))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(o)}`);a.set(o,i)}}return new pr({typeName:W.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:a,...ee(r)})}}function rn(n,e){const t=Je(n),r=Je(e);if(n===e)return{valid:!0,data:n};if(t===K.object&&r===K.object){const a=ce.objectKeys(e),i=ce.objectKeys(n).filter(o=>a.indexOf(o)!==-1),s={...n,...e};for(const o of i){const u=rn(n[o],e[o]);if(!u.valid)return{valid:!1};s[o]=u.data}return{valid:!0,data:s}}else if(t===K.array&&r===K.array){if(n.length!==e.length)return{valid:!1};const a=[];for(let i=0;i<n.length;i++){const s=n[i],o=e[i],u=rn(s,o);if(!u.valid)return{valid:!1};a.push(u.data)}return{valid:!0,data:a}}else return t===K.date&&r===K.date&&+n==+e?{valid:!0,data:n}:{valid:!1}}class jt extends X{_parse(e){const{status:t,ctx:r}=this._processInputParams(e),a=(i,s)=>{if(Er(i)||Er(s))return J;const o=rn(i.value,s.value);return o.valid?((kr(i)||kr(s))&&t.dirty(),{status:t.value,value:o.data}):(V(r,{code:D.invalid_intersection_types}),J)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,s])=>a(i,s)):a(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}jt.create=(n,e,t)=>new jt({left:n,right:e,typeName:W.ZodIntersection,...ee(t)});class ze extends X{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==K.array)return V(r,{code:D.invalid_type,expected:K.array,received:r.parsedType}),J;if(r.data.length<this._def.items.length)return V(r,{code:D.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),J;!this._def.rest&&r.data.length>this._def.items.length&&(V(r,{code:D.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const i=[...r.data].map((s,o)=>{const u=this._def.items[o]||this._def.rest;return u?u._parse(new He(r,s,r.path,o)):null}).filter(s=>!!s);return r.common.async?Promise.all(i).then(s=>xe.mergeArray(t,s)):xe.mergeArray(t,i)}get items(){return this._def.items}rest(e){return new ze({...this._def,rest:e})}}ze.create=(n,e)=>{if(!Array.isArray(n))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ze({items:n,typeName:W.ZodTuple,rest:null,...ee(e)})};class St extends X{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==K.object)return V(r,{code:D.invalid_type,expected:K.object,received:r.parsedType}),J;const a=[],i=this._def.keyType,s=this._def.valueType;for(const o in r.data)a.push({key:i._parse(new He(r,o,r.path,o)),value:s._parse(new He(r,r.data[o],r.path,o))});return r.common.async?xe.mergeObjectAsync(t,a):xe.mergeObjectSync(t,a)}get element(){return this._def.valueType}static create(e,t,r){return t instanceof X?new St({keyType:e,valueType:t,typeName:W.ZodRecord,...ee(r)}):new St({keyType:Be.create(),valueType:e,typeName:W.ZodRecord,...ee(t)})}}class ir extends X{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==K.map)return V(r,{code:D.invalid_type,expected:K.map,received:r.parsedType}),J;const a=this._def.keyType,i=this._def.valueType,s=[...r.data.entries()].map(([o,u],c)=>({key:a._parse(new He(r,o,r.path,[c,"key"])),value:i._parse(new He(r,u,r.path,[c,"value"]))}));if(r.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const u of s){const c=await u.key,m=await u.value;if(c.status==="aborted"||m.status==="aborted")return J;(c.status==="dirty"||m.status==="dirty")&&t.dirty(),o.set(c.value,m.value)}return{status:t.value,value:o}})}else{const o=new Map;for(const u of s){const c=u.key,m=u.value;if(c.status==="aborted"||m.status==="aborted")return J;(c.status==="dirty"||m.status==="dirty")&&t.dirty(),o.set(c.value,m.value)}return{status:t.value,value:o}}}}ir.create=(n,e,t)=>new ir({valueType:e,keyType:n,typeName:W.ZodMap,...ee(t)});class ot extends X{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==K.set)return V(r,{code:D.invalid_type,expected:K.set,received:r.parsedType}),J;const a=this._def;a.minSize!==null&&r.data.size<a.minSize.value&&(V(r,{code:D.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),t.dirty()),a.maxSize!==null&&r.data.size>a.maxSize.value&&(V(r,{code:D.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),t.dirty());const i=this._def.valueType;function s(u){const c=new Set;for(const m of u){if(m.status==="aborted")return J;m.status==="dirty"&&t.dirty(),c.add(m.value)}return{status:t.value,value:c}}const o=[...r.data.values()].map((u,c)=>i._parse(new He(r,u,r.path,c)));return r.common.async?Promise.all(o).then(u=>s(u)):s(o)}min(e,t){return new ot({...this._def,minSize:{value:e,message:H.toString(t)}})}max(e,t){return new ot({...this._def,maxSize:{value:e,message:H.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}ot.create=(n,e)=>new ot({valueType:n,minSize:null,maxSize:null,typeName:W.ZodSet,...ee(e)});class pt extends X{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==K.function)return V(t,{code:D.invalid_type,expected:K.function,received:t.parsedType}),J;function r(o,u){return er({data:o,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Xt(),xt].filter(c=>!!c),issueData:{code:D.invalid_arguments,argumentsError:u}})}function a(o,u){return er({data:o,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,Xt(),xt].filter(c=>!!c),issueData:{code:D.invalid_return_type,returnTypeError:u}})}const i={errorMap:t.common.contextualErrorMap},s=t.data;return this._def.returns instanceof mt?Ie(async(...o)=>{const u=new Ze([]),c=await this._def.args.parseAsync(o,i).catch(j=>{throw u.addIssue(r(o,j)),u}),m=await s(...c);return await this._def.returns._def.type.parseAsync(m,i).catch(j=>{throw u.addIssue(a(m,j)),u})}):Ie((...o)=>{const u=this._def.args.safeParse(o,i);if(!u.success)throw new Ze([r(o,u.error)]);const c=s(...u.data),m=this._def.returns.safeParse(c,i);if(!m.success)throw new Ze([a(c,m.error)]);return m.data})}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new pt({...this._def,args:ze.create(e).rest(it.create())})}returns(e){return new pt({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,r){return new pt({args:e||ze.create([]).rest(it.create()),returns:t||it.create(),typeName:W.ZodFunction,...ee(r)})}}class Ct extends X{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}Ct.create=(n,e)=>new Ct({getter:n,typeName:W.ZodLazy,...ee(e)});class Nt extends X{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return V(t,{received:t.data,code:D.invalid_literal,expected:this._def.value}),J}return{status:"valid",value:e.data}}get value(){return this._def.value}}Nt.create=(n,e)=>new Nt({value:n,typeName:W.ZodLiteral,...ee(e)});function Xa(n,e){return new tt({values:n,typeName:W.ZodEnum,...ee(e)})}class tt extends X{_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),r=this._def.values;return V(t,{expected:ce.joinValues(r),received:t.parsedType,code:D.invalid_type}),J}if(this._def.values.indexOf(e.data)===-1){const t=this._getOrReturnCtx(e),r=this._def.values;return V(t,{received:t.data,code:D.invalid_enum_value,options:r}),J}return Ie(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e){return tt.create(e)}exclude(e){return tt.create(this.options.filter(t=>!e.includes(t)))}}tt.create=Xa;class Dt extends X{_parse(e){const t=ce.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==K.string&&r.parsedType!==K.number){const a=ce.objectValues(t);return V(r,{expected:ce.joinValues(a),received:r.parsedType,code:D.invalid_type}),J}if(t.indexOf(e.data)===-1){const a=ce.objectValues(t);return V(r,{received:r.data,code:D.invalid_enum_value,options:a}),J}return Ie(e.data)}get enum(){return this._def.values}}Dt.create=(n,e)=>new Dt({values:n,typeName:W.ZodNativeEnum,...ee(e)});class mt extends X{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==K.promise&&t.common.async===!1)return V(t,{code:D.invalid_type,expected:K.promise,received:t.parsedType}),J;const r=t.parsedType===K.promise?t.data:Promise.resolve(t.data);return Ie(r.then(a=>this._def.type.parseAsync(a,{path:t.path,errorMap:t.common.contextualErrorMap})))}}mt.create=(n,e)=>new mt({type:n,typeName:W.ZodPromise,...ee(e)});class Me extends X{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===W.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:r}=this._processInputParams(e),a=this._def.effect||null;if(a.type==="preprocess"){const s=a.transform(r.data);return r.common.async?Promise.resolve(s).then(o=>this._def.schema._parseAsync({data:o,path:r.path,parent:r})):this._def.schema._parseSync({data:s,path:r.path,parent:r})}const i={addIssue:s=>{V(r,s),s.fatal?t.abort():t.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),a.type==="refinement"){const s=o=>{const u=a.refinement(o,i);if(r.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return o.status==="aborted"?J:(o.status==="dirty"&&t.dirty(),s(o.value),{status:t.value,value:o.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>o.status==="aborted"?J:(o.status==="dirty"&&t.dirty(),s(o.value).then(()=>({status:t.value,value:o.value}))))}if(a.type==="transform")if(r.common.async===!1){const s=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!tr(s))return s;const o=a.transform(s.value,i);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:o}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(s=>tr(s)?Promise.resolve(a.transform(s.value,i)).then(o=>({status:t.value,value:o})):s);ce.assertNever(a)}}Me.create=(n,e,t)=>new Me({schema:n,typeName:W.ZodEffects,effect:e,...ee(t)});Me.createWithPreprocess=(n,e,t)=>new Me({schema:e,effect:{type:"preprocess",transform:n},typeName:W.ZodEffects,...ee(t)});class qe extends X{_parse(e){return this._getType(e)===K.undefined?Ie(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}qe.create=(n,e)=>new qe({innerType:n,typeName:W.ZodOptional,...ee(e)});class ut extends X{_parse(e){return this._getType(e)===K.null?Ie(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ut.create=(n,e)=>new ut({innerType:n,typeName:W.ZodNullable,...ee(e)});class Mt extends X{_parse(e){const{ctx:t}=this._processInputParams(e);let r=t.data;return t.parsedType===K.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}Mt.create=(n,e)=>new Mt({innerType:n,typeName:W.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...ee(e)});class sr extends X{_parse(e){const{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},a=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return rr(a)?a.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Ze(r.common.issues)},input:r.data})})):{status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new Ze(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}sr.create=(n,e)=>new sr({innerType:n,typeName:W.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...ee(e)});class or extends X{_parse(e){if(this._getType(e)!==K.nan){const r=this._getOrReturnCtx(e);return V(r,{code:D.invalid_type,expected:K.nan,received:r.parsedType}),J}return{status:"valid",value:e.data}}}or.create=n=>new or({typeName:W.ZodNaN,...ee(n)});const ei=Symbol("zod_brand");class vn extends X{_parse(e){const{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}class Rt extends X{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?J:i.status==="dirty"?(t.dirty(),_n(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{const a=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?J:a.status==="dirty"?(t.dirty(),{status:"dirty",value:a.value}):this._def.out._parseSync({data:a.value,path:r.path,parent:r})}}static create(e,t){return new Rt({in:e,out:t,typeName:W.ZodPipeline})}}const wn=(n,e={},t)=>n?ft.create().superRefine((r,a)=>{var i,s;if(!n(r)){const o=typeof e=="function"?e(r):typeof e=="string"?{message:e}:e,u=(s=(i=o.fatal)!==null&&i!==void 0?i:t)!==null&&s!==void 0?s:!0,c=typeof o=="string"?{message:o}:o;a.addIssue({code:"custom",...c,fatal:u})}}):ft.create(),ti={object:fe.lazycreate};var W;(function(n){n.ZodString="ZodString",n.ZodNumber="ZodNumber",n.ZodNaN="ZodNaN",n.ZodBigInt="ZodBigInt",n.ZodBoolean="ZodBoolean",n.ZodDate="ZodDate",n.ZodSymbol="ZodSymbol",n.ZodUndefined="ZodUndefined",n.ZodNull="ZodNull",n.ZodAny="ZodAny",n.ZodUnknown="ZodUnknown",n.ZodNever="ZodNever",n.ZodVoid="ZodVoid",n.ZodArray="ZodArray",n.ZodObject="ZodObject",n.ZodUnion="ZodUnion",n.ZodDiscriminatedUnion="ZodDiscriminatedUnion",n.ZodIntersection="ZodIntersection",n.ZodTuple="ZodTuple",n.ZodRecord="ZodRecord",n.ZodMap="ZodMap",n.ZodSet="ZodSet",n.ZodFunction="ZodFunction",n.ZodLazy="ZodLazy",n.ZodLiteral="ZodLiteral",n.ZodEnum="ZodEnum",n.ZodEffects="ZodEffects",n.ZodNativeEnum="ZodNativeEnum",n.ZodOptional="ZodOptional",n.ZodNullable="ZodNullable",n.ZodDefault="ZodDefault",n.ZodCatch="ZodCatch",n.ZodPromise="ZodPromise",n.ZodBranded="ZodBranded",n.ZodPipeline="ZodPipeline"})(W||(W={}));const ri=(n,e={message:`Input not instance of ${n.name}`})=>wn(t=>t instanceof n,e),On=Be.create,Pn=Xe.create,ni=or.create,ai=et.create,An=Et.create,ii=st.create,si=nr.create,oi=kt.create,ui=It.create,ci=ft.create,li=it.create,di=Ye.create,hi=ar.create,pi=Ue.create,fi=fe.create,mi=fe.strictCreate,gi=Tt.create,yi=pr.create,bi=jt.create,_i=ze.create,vi=St.create,wi=ir.create,Oi=ot.create,Pi=pt.create,Ai=Ct.create,xi=Nt.create,Ei=tt.create,ki=Dt.create,Ii=mt.create,Ir=Me.create,Ti=qe.create,ji=ut.create,Si=Me.createWithPreprocess,Ci=Rt.create,Ni=()=>On().optional(),Di=()=>Pn().optional(),Mi=()=>An().optional(),Li={string:n=>Be.create({...n,coerce:!0}),number:n=>Xe.create({...n,coerce:!0}),boolean:n=>Et.create({...n,coerce:!0}),bigint:n=>et.create({...n,coerce:!0}),date:n=>st.create({...n,coerce:!0})},Ri=J;var Gn=Object.freeze({__proto__:null,defaultErrorMap:xt,setErrorMap:Ja,getErrorMap:Xt,makeIssue:er,EMPTY_PATH:Qa,addIssueToContext:V,ParseStatus:xe,INVALID:J,DIRTY:_n,OK:Ie,isAborted:Er,isDirty:kr,isValid:tr,isAsync:rr,get util(){return ce},get objectUtil(){return xr},ZodParsedType:K,getParsedType:Je,ZodType:X,ZodString:Be,ZodNumber:Xe,ZodBigInt:et,ZodBoolean:Et,ZodDate:st,ZodSymbol:nr,ZodUndefined:kt,ZodNull:It,ZodAny:ft,ZodUnknown:it,ZodNever:Ye,ZodVoid:ar,ZodArray:Ue,ZodObject:fe,ZodUnion:Tt,ZodDiscriminatedUnion:pr,ZodIntersection:jt,ZodTuple:ze,ZodRecord:St,ZodMap:ir,ZodSet:ot,ZodFunction:pt,ZodLazy:Ct,ZodLiteral:Nt,ZodEnum:tt,ZodNativeEnum:Dt,ZodPromise:mt,ZodEffects:Me,ZodTransformer:Me,ZodOptional:qe,ZodNullable:ut,ZodDefault:Mt,ZodCatch:sr,ZodNaN:or,BRAND:ei,ZodBranded:vn,ZodPipeline:Rt,custom:wn,Schema:X,ZodSchema:X,late:ti,get ZodFirstPartyTypeKind(){return W},coerce:Li,any:ci,array:pi,bigint:ai,boolean:An,date:ii,discriminatedUnion:yi,effect:Ir,enum:Ei,function:Pi,instanceof:ri,intersection:bi,lazy:Ai,literal:xi,map:wi,nan:ni,nativeEnum:ki,never:di,null:ui,nullable:ji,number:Pn,object:fi,oboolean:Mi,onumber:Di,optional:Ti,ostring:Ni,pipeline:Ci,preprocess:Si,promise:Ii,record:vi,set:Oi,strictObject:mi,string:On,symbol:si,transformer:Ir,tuple:_i,undefined:oi,union:gi,unknown:li,void:hi,NEVER:Ri,ZodIssueCode:D,quotelessJson:Wa,ZodError:Ze});const ru=Object.freeze(Object.defineProperty({__proto__:null,BRAND:ei,DIRTY:_n,EMPTY_PATH:Qa,INVALID:J,NEVER:Ri,OK:Ie,ParseStatus:xe,Schema:X,ZodAny:ft,ZodArray:Ue,ZodBigInt:et,ZodBoolean:Et,ZodBranded:vn,ZodCatch:sr,ZodDate:st,ZodDefault:Mt,ZodDiscriminatedUnion:pr,ZodEffects:Me,ZodEnum:tt,ZodError:Ze,get ZodFirstPartyTypeKind(){return W},ZodFunction:pt,ZodIntersection:jt,ZodIssueCode:D,ZodLazy:Ct,ZodLiteral:Nt,ZodMap:ir,ZodNaN:or,ZodNativeEnum:Dt,ZodNever:Ye,ZodNull:It,ZodNullable:ut,ZodNumber:Xe,ZodObject:fe,ZodOptional:qe,ZodParsedType:K,ZodPipeline:Rt,ZodPromise:mt,ZodRecord:St,ZodSchema:X,ZodSet:ot,ZodString:Be,ZodSymbol:nr,ZodTransformer:Me,ZodTuple:ze,ZodType:X,ZodUndefined:kt,ZodUnion:Tt,ZodUnknown:it,ZodVoid:ar,addIssueToContext:V,any:ci,array:pi,bigint:ai,boolean:An,coerce:Li,custom:wn,date:ii,default:Gn,defaultErrorMap:xt,discriminatedUnion:yi,effect:Ir,enum:Ei,function:Pi,getErrorMap:Xt,getParsedType:Je,instanceof:ri,intersection:bi,isAborted:Er,isAsync:rr,isDirty:kr,isValid:tr,late:ti,lazy:Ai,literal:xi,makeIssue:er,map:wi,nan:ni,nativeEnum:ki,never:di,null:ui,nullable:ji,number:Pn,object:fi,get objectUtil(){return xr},oboolean:Mi,onumber:Di,optional:Ti,ostring:Ni,pipeline:Ci,preprocess:Si,promise:Ii,quotelessJson:Wa,record:vi,set:Oi,setErrorMap:Ja,strictObject:mi,string:On,symbol:si,transformer:Ir,tuple:_i,undefined:oi,union:gi,unknown:li,get util(){return ce},void:hi,z:Gn},Symbol.toStringTag,{value:"Module"}));var nu={},Nr={},Bt={};const xn=ms(ru);var Dr={};Object.defineProperty(Dr,"__esModule",{value:!0});Dr.parseAnyDef=void 0;function au(){return{}}Dr.parseAnyDef=au;var Zt={},$e={};Object.defineProperty($e,"__esModule",{value:!0});$e.setResponseValueAndErrors=$e.addErrorMessage=void 0;function Bi(n,e,t,r){r!=null&&r.errorMessages&&t&&(n.errorMessage=Object.assign(Object.assign({},n.errorMessage),{[e]:t}))}$e.addErrorMessage=Bi;function iu(n,e,t,r,a){n[e]=t,Bi(n,e,r,a)}$e.setResponseValueAndErrors=iu;var Jn;function su(){if(Jn)return Zt;Jn=1,Object.defineProperty(Zt,"__esModule",{value:!0}),Zt.parseArrayDef=void 0;const n=xn,e=$e,t=Ee();function r(a,i){var s,o;const u={type:"array"};return((o=(s=a.type)===null||s===void 0?void 0:s._def)===null||o===void 0?void 0:o.typeName)!==n.ZodFirstPartyTypeKind.ZodAny&&(u.items=(0,t.parseDef)(a.type._def,Object.assign(Object.assign({},i),{currentPath:[...i.currentPath,"items"]}))),a.minLength&&(0,e.setResponseValueAndErrors)(u,"minItems",a.minLength.value,a.minLength.message,i),a.maxLength&&(0,e.setResponseValueAndErrors)(u,"maxItems",a.maxLength.value,a.maxLength.message,i),a.exactLength&&((0,e.setResponseValueAndErrors)(u,"minItems",a.exactLength.value,a.exactLength.message,i),(0,e.setResponseValueAndErrors)(u,"maxItems",a.exactLength.value,a.exactLength.message,i)),u}return Zt.parseArrayDef=r,Zt}var Mr={};Object.defineProperty(Mr,"__esModule",{value:!0});Mr.parseBigintDef=void 0;const ct=$e;function ou(n,e){const t={type:"integer",format:"int64"};if(!n.checks)return t;for(const r of n.checks)switch(r.kind){case"min":e.target==="jsonSchema7"?r.inclusive?(0,ct.setResponseValueAndErrors)(t,"minimum",r.value,r.message,e):(0,ct.setResponseValueAndErrors)(t,"exclusiveMinimum",r.value,r.message,e):(r.inclusive||(t.exclusiveMinimum=!0),(0,ct.setResponseValueAndErrors)(t,"minimum",r.value,r.message,e));break;case"max":e.target==="jsonSchema7"?r.inclusive?(0,ct.setResponseValueAndErrors)(t,"maximum",r.value,r.message,e):(0,ct.setResponseValueAndErrors)(t,"exclusiveMaximum",r.value,r.message,e):(r.inclusive||(t.exclusiveMaximum=!0),(0,ct.setResponseValueAndErrors)(t,"maximum",r.value,r.message,e));break;case"multipleOf":(0,ct.setResponseValueAndErrors)(t,"multipleOf",r.value,r.message,e);break}return t}Mr.parseBigintDef=ou;var Lr={};Object.defineProperty(Lr,"__esModule",{value:!0});Lr.parseBooleanDef=void 0;function uu(){return{type:"boolean"}}Lr.parseBooleanDef=uu;var Ut={},Qn;function cu(){if(Qn)return Ut;Qn=1,Object.defineProperty(Ut,"__esModule",{value:!0}),Ut.parseBrandedDef=void 0;const n=Ee();function e(t,r){return(0,n.parseDef)(t.type._def,r)}return Ut.parseBrandedDef=e,Ut}var Kt={},Xn;function lu(){if(Xn)return Kt;Xn=1,Object.defineProperty(Kt,"__esModule",{value:!0}),Kt.parseCatchDef=void 0;const n=Ee(),e=(t,r)=>(0,n.parseDef)(t.innerType._def,r);return Kt.parseCatchDef=e,Kt}var Rr={};Object.defineProperty(Rr,"__esModule",{value:!0});Rr.parseDateDef=void 0;const ea=$e;function du(n,e){return e.dateStrategy=="integer"?hu(n,e):{type:"string",format:"date-time"}}Rr.parseDateDef=du;const hu=(n,e)=>{const t={type:"integer",format:"unix-time"};for(const r of n.checks)switch(r.kind){case"min":e.target==="jsonSchema7"&&(0,ea.setResponseValueAndErrors)(t,"minimum",r.value,r.message,e);break;case"max":e.target==="jsonSchema7"&&(0,ea.setResponseValueAndErrors)(t,"maximum",r.value,r.message,e);break}return t};var Vt={},ta;function pu(){if(ta)return Vt;ta=1,Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.parseDefaultDef=void 0;const n=Ee();function e(t,r){return Object.assign(Object.assign({},(0,n.parseDef)(t.innerType._def,r)),{default:t.defaultValue()})}return Vt.parseDefaultDef=e,Vt}var zt={},ra;function fu(){if(ra)return zt;ra=1,Object.defineProperty(zt,"__esModule",{value:!0}),zt.parseEffectsDef=void 0;const n=Ee();function e(t,r){return r.effectStrategy==="input"?(0,n.parseDef)(t.schema._def,r):{}}return zt.parseEffectsDef=e,zt}var Br={};Object.defineProperty(Br,"__esModule",{value:!0});Br.parseEnumDef=void 0;function mu(n){return{type:"string",enum:n.values}}Br.parseEnumDef=mu;var $t={},na;function gu(){if(na)return $t;na=1;var n=Kn&&Kn.__rest||function(a,i){var s={};for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&i.indexOf(o)<0&&(s[o]=a[o]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,o=Object.getOwnPropertySymbols(a);u<o.length;u++)i.indexOf(o[u])<0&&Object.prototype.propertyIsEnumerable.call(a,o[u])&&(s[o[u]]=a[o[u]]);return s};Object.defineProperty($t,"__esModule",{value:!0}),$t.parseIntersectionDef=void 0;const e=Ee(),t=a=>"type"in a&&a.type==="string"?!1:"allOf"in a;function r(a,i){const s=[(0,e.parseDef)(a.left._def,Object.assign(Object.assign({},i),{currentPath:[...i.currentPath,"allOf","0"]})),(0,e.parseDef)(a.right._def,Object.assign(Object.assign({},i),{currentPath:[...i.currentPath,"allOf","1"]}))].filter(c=>!!c);let o=i.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const u=[];return s.forEach(c=>{if(t(c))u.push(...c.allOf),c.unevaluatedProperties===void 0&&(o=void 0);else{let m=c;"additionalProperties"in c&&c.additionalProperties===!1?m=n(c,["additionalProperties"]):o=void 0,u.push(m)}}),u.length?Object.assign({allOf:u},o):void 0}return $t.parseIntersectionDef=r,$t}var Zr={};Object.defineProperty(Zr,"__esModule",{value:!0});Zr.parseLiteralDef=void 0;function yu(n,e){const t=typeof n.value;return t!=="bigint"&&t!=="number"&&t!=="boolean"&&t!=="string"?{type:Array.isArray(n.value)?"array":"object"}:e.target==="openApi3"?{type:t==="bigint"?"integer":t,enum:[n.value]}:{type:t==="bigint"?"integer":t,const:n.value}}Zr.parseLiteralDef=yu;var Ft={},aa;function bu(){if(aa)return Ft;aa=1,Object.defineProperty(Ft,"__esModule",{value:!0}),Ft.parseMapDef=void 0;const n=Ee();function e(t,r){const a=(0,n.parseDef)(t.keyType._def,Object.assign(Object.assign({},r),{currentPath:[...r.currentPath,"items","items","0"]}))||{},i=(0,n.parseDef)(t.valueType._def,Object.assign(Object.assign({},r),{currentPath:[...r.currentPath,"items","items","1"]}))||{};return{type:"array",maxItems:125,items:{type:"array",items:[a,i],minItems:2,maxItems:2}}}return Ft.parseMapDef=e,Ft}var Ur={};Object.defineProperty(Ur,"__esModule",{value:!0});Ur.parseNativeEnumDef=void 0;function _u(n){const e=n.values,r=Object.keys(n.values).filter(i=>typeof e[e[i]]!="number").map(i=>e[i]),a=Array.from(new Set(r.map(i=>typeof i)));return{type:a.length===1?a[0]==="string"?"string":"number":["string","number"],enum:r}}Ur.parseNativeEnumDef=_u;var Kr={};Object.defineProperty(Kr,"__esModule",{value:!0});Kr.parseNeverDef=void 0;function vu(){return{not:{}}}Kr.parseNeverDef=vu;var Vr={};Object.defineProperty(Vr,"__esModule",{value:!0});Vr.parseNullDef=void 0;function wu(n){return n.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}Vr.parseNullDef=wu;var qt={},Jr={},ia;function Zi(){return ia||(ia=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.parseUnionDef=n.primitiveMappings=void 0;const e=Ee();n.primitiveMappings={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function t(a,i){if(i.target==="openApi3")return r(a,i);const s=a.options instanceof Map?Array.from(a.options.values()):a.options;if(s.every(o=>o._def.typeName in n.primitiveMappings&&(!o._def.checks||!o._def.checks.length))){const o=s.reduce((u,c)=>{const m=n.primitiveMappings[c._def.typeName];return m&&!u.includes(m)?[...u,m]:u},[]);return{type:o.length>1?o:o[0]}}else if(s.every(o=>o._def.typeName==="ZodLiteral"&&!o.description)){const o=s.reduce((u,c)=>{const m=typeof c._def.value;switch(m){case"string":case"number":case"boolean":return[...u,m];case"bigint":return[...u,"integer"];case"object":if(c._def.value===null)return[...u,"null"];case"symbol":case"undefined":case"function":default:return u}},[]);if(o.length===s.length){const u=o.filter((c,m,P)=>P.indexOf(c)===m);return{type:u.length>1?u:u[0],enum:s.reduce((c,m)=>c.includes(m._def.value)?c:[...c,m._def.value],[])}}}else if(s.every(o=>o._def.typeName==="ZodEnum"))return{type:"string",enum:s.reduce((o,u)=>[...o,...u._def.values.filter(c=>!o.includes(c))],[])};return r(a,i)}n.parseUnionDef=t;const r=(a,i)=>{const s=(a.options instanceof Map?Array.from(a.options.values()):a.options).map((o,u)=>(0,e.parseDef)(o._def,Object.assign(Object.assign({},i),{currentPath:[...i.currentPath,"anyOf",`${u}`]}))).filter(o=>!!o&&(!i.strictUnions||typeof o=="object"&&Object.keys(o).length>0));return s.length?{anyOf:s}:void 0}}(Jr)),Jr}var sa;function Ou(){if(sa)return qt;sa=1,Object.defineProperty(qt,"__esModule",{value:!0}),qt.parseNullableDef=void 0;const n=Ee(),e=Zi();function t(r,a){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(r.innerType._def.typeName)&&(!r.innerType._def.checks||!r.innerType._def.checks.length))return a.target==="openApi3"?{type:e.primitiveMappings[r.innerType._def.typeName],nullable:!0}:{type:[e.primitiveMappings[r.innerType._def.typeName],"null"]};if(a.target==="openApi3"){const s=(0,n.parseDef)(r.innerType._def,Object.assign(Object.assign({},a),{currentPath:[...a.currentPath]}));return s&&Object.assign(Object.assign({},s),{nullable:!0})}const i=(0,n.parseDef)(r.innerType._def,Object.assign(Object.assign({},a),{currentPath:[...a.currentPath,"anyOf","0"]}));return i&&{anyOf:[i,{type:"null"}]}}return qt.parseNullableDef=t,qt}var zr={};Object.defineProperty(zr,"__esModule",{value:!0});zr.parseNumberDef=void 0;const nt=$e;function Pu(n,e){const t={type:"number"};if(!n.checks)return t;for(const r of n.checks)switch(r.kind){case"int":t.type="integer",(0,nt.addErrorMessage)(t,"type",r.message,e);break;case"min":e.target==="jsonSchema7"?r.inclusive?(0,nt.setResponseValueAndErrors)(t,"minimum",r.value,r.message,e):(0,nt.setResponseValueAndErrors)(t,"exclusiveMinimum",r.value,r.message,e):(r.inclusive||(t.exclusiveMinimum=!0),(0,nt.setResponseValueAndErrors)(t,"minimum",r.value,r.message,e));break;case"max":e.target==="jsonSchema7"?r.inclusive?(0,nt.setResponseValueAndErrors)(t,"maximum",r.value,r.message,e):(0,nt.setResponseValueAndErrors)(t,"exclusiveMaximum",r.value,r.message,e):(r.inclusive||(t.exclusiveMaximum=!0),(0,nt.setResponseValueAndErrors)(t,"maximum",r.value,r.message,e));break;case"multipleOf":(0,nt.setResponseValueAndErrors)(t,"multipleOf",r.value,r.message,e);break}return t}zr.parseNumberDef=Pu;var lt={},oa;function Au(){if(oa)return lt;oa=1,Object.defineProperty(lt,"__esModule",{value:!0}),lt.parseObjectDef=lt.parseObjectDefX=void 0;const n=Ee();function e(r,a){var i,s;Object.keys(r.shape()).reduce((u,c)=>{let m=r.shape()[c];const P=m.isOptional();P||(m=Object.assign({},m._def.innerSchema));const j=(0,n.parseDef)(m._def,Object.assign(Object.assign({},a),{currentPath:[...a.currentPath,"properties",c],propertyPath:[...a.currentPath,"properties",c]}));return j!==void 0&&(u.properties[c]=j,P||(u.required||(u.required=[]),u.required.push(c))),u},{type:"object",properties:{},additionalProperties:r.catchall._def.typeName==="ZodNever"?r.unknownKeys==="passthrough":(i=(0,n.parseDef)(r.catchall._def,Object.assign(Object.assign({},a),{currentPath:[...a.currentPath,"additionalProperties"]})))!==null&&i!==void 0?i:!0});const o=Object.assign(Object.assign({type:"object"},Object.entries(r.shape()).reduce((u,[c,m])=>{if(m===void 0||m._def===void 0)return u;const P=(0,n.parseDef)(m._def,Object.assign(Object.assign({},a),{currentPath:[...a.currentPath,"properties",c],propertyPath:[...a.currentPath,"properties",c]}));return P===void 0?u:{properties:Object.assign(Object.assign({},u.properties),{[c]:P}),required:m.isOptional()?u.required:[...u.required,c]}},{properties:{},required:[]})),{additionalProperties:r.catchall._def.typeName==="ZodNever"?r.unknownKeys==="passthrough":(s=(0,n.parseDef)(r.catchall._def,Object.assign(Object.assign({},a),{currentPath:[...a.currentPath,"additionalProperties"]})))!==null&&s!==void 0?s:!0});return o.required.length||delete o.required,o}lt.parseObjectDefX=e;function t(r,a){var i;const s=Object.assign(Object.assign({type:"object"},Object.entries(r.shape()).reduce((o,[u,c])=>{if(c===void 0||c._def===void 0)return o;const m=(0,n.parseDef)(c._def,Object.assign(Object.assign({},a),{currentPath:[...a.currentPath,"properties",u],propertyPath:[...a.currentPath,"properties",u]}));return m===void 0?o:{properties:Object.assign(Object.assign({},o.properties),{[u]:m}),required:c.isOptional()?o.required:[...o.required,u]}},{properties:{},required:[]})),{additionalProperties:r.catchall._def.typeName==="ZodNever"?r.unknownKeys==="passthrough":(i=(0,n.parseDef)(r.catchall._def,Object.assign(Object.assign({},a),{currentPath:[...a.currentPath,"additionalProperties"]})))!==null&&i!==void 0?i:!0});return s.required.length||delete s.required,s}return lt.parseObjectDef=t,lt}var Ht={},ua;function xu(){if(ua)return Ht;ua=1,Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.parseOptionalDef=void 0;const n=Ee(),e=(t,r)=>{var a;if(r.currentPath.toString()===((a=r.propertyPath)===null||a===void 0?void 0:a.toString()))return(0,n.parseDef)(t.innerType._def,r);const i=(0,n.parseDef)(t.innerType._def,Object.assign(Object.assign({},r),{currentPath:[...r.currentPath,"anyOf","1"]}));return i?{anyOf:[{not:{}},i]}:{}};return Ht.parseOptionalDef=e,Ht}var Yt={},ca;function Eu(){if(ca)return Yt;ca=1,Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.parsePipelineDef=void 0;const n=Ee(),e=(t,r)=>{if(r.pipeStrategy==="input")return(0,n.parseDef)(t.in._def,r);const a=(0,n.parseDef)(t.in._def,Object.assign(Object.assign({},r),{currentPath:[...r.currentPath,"allOf","0"]})),i=(0,n.parseDef)(t.out._def,Object.assign(Object.assign({},r),{currentPath:[...r.currentPath,"allOf",a?"1":"0"]}));return{allOf:[a,i].filter(s=>s!==void 0)}};return Yt.parsePipelineDef=e,Yt}var Wt={},la;function ku(){if(la)return Wt;la=1,Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.parsePromiseDef=void 0;const n=Ee();function e(t,r){return(0,n.parseDef)(t.type._def,r)}return Wt.parsePromiseDef=e,Wt}var Gt={},En={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.parseStringDef=n.emojiPattern=n.ulidPattern=n.cuid2Pattern=n.cuidPattern=n.emailPattern=void 0;const e=$e;n.emailPattern='^(([^<>()[\\]\\\\.,;:\\s@\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\"]+)*)|(\\".+\\"))@((\\[(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\])|(\\[IPv6:(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))\\])|([A-Za-z0-9]([A-Za-z0-9-]*[A-Za-z0-9])*(\\.[A-Za-z]{2,})+))$',n.cuidPattern="^c[^\\s-]{8,}$",n.cuid2Pattern="^[a-z][a-z0-9]*$",n.ulidPattern="/[0-9A-HJKMNP-TV-Z]{26}/",n.emojiPattern="/^(p{Extended_Pictographic}|p{Emoji_Component})+$/u";function t(s,o){const u={type:"string"};if(s.checks)for(const c of s.checks)switch(c.kind){case"min":(0,e.setResponseValueAndErrors)(u,"minLength",typeof u.minLength=="number"?Math.max(u.minLength,c.value):c.value,c.message,o);break;case"max":(0,e.setResponseValueAndErrors)(u,"maxLength",typeof u.maxLength=="number"?Math.min(u.maxLength,c.value):c.value,c.message,o);break;case"email":switch(o.emailStrategy){case"format:email":a(u,"email",c.message,o);break;case"format:idn-email":a(u,"idn-email",c.message,o);break;case"pattern:zod":i(u,n.emailPattern,c.message,o);break}break;case"url":a(u,"uri",c.message,o);break;case"uuid":a(u,"uuid",c.message,o);break;case"regex":i(u,c.regex.source,c.message,o);break;case"cuid":i(u,n.cuidPattern,c.message,o);break;case"cuid2":i(u,n.cuid2Pattern,c.message,o);break;case"startsWith":i(u,"^"+r(c.value),c.message,o);break;case"endsWith":i(u,r(c.value)+"$",c.message,o);break;case"datetime":a(u,"date-time",c.message,o);break;case"length":(0,e.setResponseValueAndErrors)(u,"minLength",typeof u.minLength=="number"?Math.max(u.minLength,c.value):c.value,c.message,o),(0,e.setResponseValueAndErrors)(u,"maxLength",typeof u.maxLength=="number"?Math.min(u.maxLength,c.value):c.value,c.message,o);break;case"includes":{i(u,r(c.value),c.message,o);break}case"ip":{c.version!=="v6"&&a(u,"ipv4",c.message,o),c.version!=="v4"&&a(u,"ipv6",c.message,o);break}case"emoji":i(u,n.emojiPattern,c.message,o);break;case"ulid":{i(u,n.ulidPattern,c.message,o);break}}return u}n.parseStringDef=t;const r=s=>Array.from(s).map(o=>/[a-zA-Z0-9]/.test(o)?o:`\\${o}`).join(""),a=(s,o,u,c)=>{var m;s.format||!((m=s.anyOf)===null||m===void 0)&&m.some(P=>P.format)?(s.anyOf||(s.anyOf=[]),s.format&&(s.anyOf.push(Object.assign({format:s.format},s.errorMessage&&c.errorMessages&&{errorMessage:{format:s.errorMessage.format}})),delete s.format,s.errorMessage&&(delete s.errorMessage.format,Object.keys(s.errorMessage).length===0&&delete s.errorMessage)),s.anyOf.push(Object.assign({format:o},u&&c.errorMessages&&{errorMessage:{format:u}}))):(0,e.setResponseValueAndErrors)(s,"format",o,u,c)},i=(s,o,u,c)=>{var m;s.pattern||!((m=s.allOf)===null||m===void 0)&&m.some(P=>P.pattern)?(s.allOf||(s.allOf=[]),s.pattern&&(s.allOf.push(Object.assign({pattern:s.pattern},s.errorMessage&&c.errorMessages&&{errorMessage:{pattern:s.errorMessage.pattern}})),delete s.pattern,s.errorMessage&&(delete s.errorMessage.pattern,Object.keys(s.errorMessage).length===0&&delete s.errorMessage)),s.allOf.push(Object.assign({pattern:o},u&&c.errorMessages&&{errorMessage:{pattern:u}}))):(0,e.setResponseValueAndErrors)(s,"pattern",o,u,c)}})(En);var da;function Iu(){if(da)return Gt;da=1,Object.defineProperty(Gt,"__esModule",{value:!0}),Gt.parseRecordDef=void 0;const n=xn,e=Ee(),t=En;function r(a,i){var s,o,u,c,m;if(i.target==="openApi3"&&((s=a.keyType)===null||s===void 0?void 0:s._def.typeName)===n.ZodFirstPartyTypeKind.ZodEnum)return{type:"object",required:a.keyType._def.values,properties:a.keyType._def.values.reduce((j,z)=>{var O;return Object.assign(Object.assign({},j),{[z]:(O=(0,e.parseDef)(a.valueType._def,Object.assign(Object.assign({},i),{currentPath:[...i.currentPath,"properties",z]})))!==null&&O!==void 0?O:{}})},{}),additionalProperties:!1};const P={type:"object",additionalProperties:(o=(0,e.parseDef)(a.valueType._def,Object.assign(Object.assign({},i),{currentPath:[...i.currentPath,"additionalProperties"]})))!==null&&o!==void 0?o:{}};if(i.target==="openApi3")return P;if(((u=a.keyType)===null||u===void 0?void 0:u._def.typeName)===n.ZodFirstPartyTypeKind.ZodString&&(!((c=a.keyType._def.checks)===null||c===void 0)&&c.length)){const j=Object.entries((0,t.parseStringDef)(a.keyType._def,i)).reduce((z,[O,N])=>O==="type"?z:Object.assign(Object.assign({},z),{[O]:N}),{});return Object.assign(Object.assign({},P),{propertyNames:j})}else if(((m=a.keyType)===null||m===void 0?void 0:m._def.typeName)===n.ZodFirstPartyTypeKind.ZodEnum)return Object.assign(Object.assign({},P),{propertyNames:{enum:a.keyType._def.values}});return P}return Gt.parseRecordDef=r,Gt}var Jt={},ha;function Tu(){if(ha)return Jt;ha=1,Object.defineProperty(Jt,"__esModule",{value:!0}),Jt.parseSetDef=void 0;const n=$e,e=Ee();function t(r,a){const s={type:"array",uniqueItems:!0,items:(0,e.parseDef)(r.valueType._def,Object.assign(Object.assign({},a),{currentPath:[...a.currentPath,"items"]}))};return r.minSize&&(0,n.setResponseValueAndErrors)(s,"minItems",r.minSize.value,r.minSize.message,a),r.maxSize&&(0,n.setResponseValueAndErrors)(s,"maxItems",r.maxSize.value,r.maxSize.message,a),s}return Jt.parseSetDef=t,Jt}var Qt={},pa;function ju(){if(pa)return Qt;pa=1,Object.defineProperty(Qt,"__esModule",{value:!0}),Qt.parseTupleDef=void 0;const n=Ee();function e(t,r){return t.rest?{type:"array",minItems:t.items.length,items:t.items.map((a,i)=>(0,n.parseDef)(a._def,Object.assign(Object.assign({},r),{currentPath:[...r.currentPath,"items",`${i}`]}))).reduce((a,i)=>i===void 0?a:[...a,i],[]),additionalItems:(0,n.parseDef)(t.rest._def,Object.assign(Object.assign({},r),{currentPath:[...r.currentPath,"additionalItems"]}))}:{type:"array",minItems:t.items.length,maxItems:t.items.length,items:t.items.map((a,i)=>(0,n.parseDef)(a._def,Object.assign(Object.assign({},r),{currentPath:[...r.currentPath,"items",`${i}`]}))).reduce((a,i)=>i===void 0?a:[...a,i],[])}}return Qt.parseTupleDef=e,Qt}var $r={};Object.defineProperty($r,"__esModule",{value:!0});$r.parseUndefinedDef=void 0;function Su(){return{not:{}}}$r.parseUndefinedDef=Su;var Fr={};Object.defineProperty(Fr,"__esModule",{value:!0});Fr.parseUnknownDef=void 0;function Cu(){return{}}Fr.parseUnknownDef=Cu;var fa;function Ee(){if(fa)return Bt;fa=1,Object.defineProperty(Bt,"__esModule",{value:!0}),Bt.parseDef=void 0;const n=xn,e=Dr,t=su(),r=Mr,a=Lr,i=cu(),s=lu(),o=Rr,u=pu(),c=fu(),m=Br,P=gu(),j=Zr,z=bu(),O=Ur,N=Kr,b=Vr,x=Ou(),I=zr,E=Au(),A=xu(),B=Eu(),g=ku(),w=Iu(),h=Tu(),f=En,d=ju(),_=$r,v=Zi(),$=Fr;function F(k,L,Z=!1){const se=L.seen.get(k);if(se&&!Z){const oe=q(se,L);if(oe!==void 0)return oe}const me={def:k,path:L.currentPath,jsonSchema:void 0};L.seen.set(k,me);const T=G(k,k.typeName,L);return T&&de(k,L,T),me.jsonSchema=T,T}Bt.parseDef=F;const q=(k,L)=>{switch(L.$refStrategy){case"root":return{$ref:k.path.length===0?"":k.path.length===1?`${k.path[0]}/`:k.path.join("/")};case"relative":return{$ref:R(L.currentPath,k.path)};case"none":return k.path.length<L.currentPath.length&&k.path.every((Z,se)=>L.currentPath[se]===Z)?(console.warn(`Recursive reference detected at ${L.currentPath.join("/")}! Defaulting to any`),{}):void 0;case"seen":return k.path.length<L.currentPath.length&&k.path.every((Z,se)=>L.currentPath[se]===Z)?(console.warn(`Recursive reference detected at ${L.currentPath.join("/")}! Defaulting to any`),{}):k.jsonSchema}},R=(k,L)=>{let Z=0;for(;Z<k.length&&Z<L.length&&k[Z]===L[Z];Z++);return[(k.length-Z).toString(),...L.slice(Z)].join("/")},G=(k,L,Z)=>{switch(L){case n.ZodFirstPartyTypeKind.ZodString:return(0,f.parseStringDef)(k,Z);case n.ZodFirstPartyTypeKind.ZodNumber:return(0,I.parseNumberDef)(k,Z);case n.ZodFirstPartyTypeKind.ZodObject:return(0,E.parseObjectDef)(k,Z);case n.ZodFirstPartyTypeKind.ZodBigInt:return(0,r.parseBigintDef)(k,Z);case n.ZodFirstPartyTypeKind.ZodBoolean:return(0,a.parseBooleanDef)();case n.ZodFirstPartyTypeKind.ZodDate:return(0,o.parseDateDef)(k,Z);case n.ZodFirstPartyTypeKind.ZodUndefined:return(0,_.parseUndefinedDef)();case n.ZodFirstPartyTypeKind.ZodNull:return(0,b.parseNullDef)(Z);case n.ZodFirstPartyTypeKind.ZodArray:return(0,t.parseArrayDef)(k,Z);case n.ZodFirstPartyTypeKind.ZodUnion:case n.ZodFirstPartyTypeKind.ZodDiscriminatedUnion:return(0,v.parseUnionDef)(k,Z);case n.ZodFirstPartyTypeKind.ZodIntersection:return(0,P.parseIntersectionDef)(k,Z);case n.ZodFirstPartyTypeKind.ZodTuple:return(0,d.parseTupleDef)(k,Z);case n.ZodFirstPartyTypeKind.ZodRecord:return(0,w.parseRecordDef)(k,Z);case n.ZodFirstPartyTypeKind.ZodLiteral:return(0,j.parseLiteralDef)(k,Z);case n.ZodFirstPartyTypeKind.ZodEnum:return(0,m.parseEnumDef)(k);case n.ZodFirstPartyTypeKind.ZodNativeEnum:return(0,O.parseNativeEnumDef)(k);case n.ZodFirstPartyTypeKind.ZodNullable:return(0,x.parseNullableDef)(k,Z);case n.ZodFirstPartyTypeKind.ZodOptional:return(0,A.parseOptionalDef)(k,Z);case n.ZodFirstPartyTypeKind.ZodMap:return(0,z.parseMapDef)(k,Z);case n.ZodFirstPartyTypeKind.ZodSet:return(0,h.parseSetDef)(k,Z);case n.ZodFirstPartyTypeKind.ZodLazy:return F(k.getter()._def,Z);case n.ZodFirstPartyTypeKind.ZodPromise:return(0,g.parsePromiseDef)(k,Z);case n.ZodFirstPartyTypeKind.ZodNaN:case n.ZodFirstPartyTypeKind.ZodNever:return(0,N.parseNeverDef)();case n.ZodFirstPartyTypeKind.ZodEffects:return(0,c.parseEffectsDef)(k,Z);case n.ZodFirstPartyTypeKind.ZodAny:return(0,e.parseAnyDef)();case n.ZodFirstPartyTypeKind.ZodUnknown:return(0,$.parseUnknownDef)();case n.ZodFirstPartyTypeKind.ZodDefault:return(0,u.parseDefaultDef)(k,Z);case n.ZodFirstPartyTypeKind.ZodBranded:return(0,i.parseBrandedDef)(k,Z);case n.ZodFirstPartyTypeKind.ZodCatch:return(0,s.parseCatchDef)(k,Z);case n.ZodFirstPartyTypeKind.ZodPipeline:return(0,B.parsePipelineDef)(k,Z);case n.ZodFirstPartyTypeKind.ZodFunction:case n.ZodFirstPartyTypeKind.ZodVoid:case n.ZodFirstPartyTypeKind.ZodSymbol:return;default:return(se=>{})()}},de=(k,L,Z)=>(k.description&&(Z.description=k.description,L.markdownDescription&&(Z.markdownDescription=k.description)),Z);return Bt}var qr={},Ui={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.getDefaultOptions=n.defaultOptions=void 0,n.defaultOptions={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"string",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,emailStrategy:"format:email"};const e=t=>typeof t=="string"?Object.assign(Object.assign({},n.defaultOptions),{name:t}):Object.assign(Object.assign({},n.defaultOptions),t);n.getDefaultOptions=e})(Ui);Object.defineProperty(qr,"__esModule",{value:!0});qr.getRefs=void 0;const Nu=Ui,Du=n=>{const e=(0,Nu.getDefaultOptions)(n),t=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return Object.assign(Object.assign({},e),{currentPath:t,propertyPath:void 0,seen:new Map(Object.entries(e.definitions).map(([r,a])=>[a._def,{def:a._def,path:[...e.basePath,e.definitionPath,r],jsonSchema:void 0}]))})};qr.getRefs=Du;Object.defineProperty(Nr,"__esModule",{value:!0});Nr.zodToJsonSchema=void 0;const ma=Ee(),Mu=qr,Lu=(n,e)=>{var t;const r=(0,Mu.getRefs)(e),a=typeof e=="object"&&e.definitions?Object.entries(e.definitions).reduce((u,[c,m])=>{var P;return Object.assign(Object.assign({},u),{[c]:(P=(0,ma.parseDef)(m._def,Object.assign(Object.assign({},r),{currentPath:[...r.basePath,r.definitionPath,c]}),!0))!==null&&P!==void 0?P:{}})},{}):void 0,i=typeof e=="string"?e:e==null?void 0:e.name,s=(t=(0,ma.parseDef)(n._def,i===void 0?r:Object.assign(Object.assign({},r),{currentPath:[...r.basePath,r.definitionPath,i]}),!1))!==null&&t!==void 0?t:{},o=i===void 0?a?Object.assign(Object.assign({},s),{[r.definitionPath]:a}):s:{$ref:[...r.$refStrategy==="relative"?[]:r.basePath,r.definitionPath,i].join("/"),[r.definitionPath]:Object.assign(Object.assign({},a),{[i]:s})};return r.target==="jsonSchema7"?o.$schema="http://json-schema.org/draft-07/schema#":r.target==="jsonSchema2019-09"&&(o.$schema="https://json-schema.org/draft/2019-09/schema#"),o};Nr.zodToJsonSchema=Lu;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.zodToJsonSchema=void 0;const e=Nr;Object.defineProperty(n,"zodToJsonSchema",{enumerable:!0,get:function(){return e.zodToJsonSchema}}),n.default=e.zodToJsonSchema})(nu);/*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT */function Ki(n){return typeof n>"u"||n===null}function Ru(n){return typeof n=="object"&&n!==null}function Bu(n){return Array.isArray(n)?n:Ki(n)?[]:[n]}function Zu(n,e){var t,r,a,i;if(e)for(i=Object.keys(e),t=0,r=i.length;t<r;t+=1)a=i[t],n[a]=e[a];return n}function Uu(n,e){var t="",r;for(r=0;r<e;r+=1)t+=n;return t}function Ku(n){return n===0&&Number.NEGATIVE_INFINITY===1/n}var Vu=Ki,zu=Ru,$u=Bu,Fu=Uu,qu=Ku,Hu=Zu,kn={isNothing:Vu,isObject:zu,toArray:$u,repeat:Fu,isNegativeZero:qu,extend:Hu};function Vi(n,e){var t="",r=n.reason||"(unknown reason)";return n.mark?(n.mark.name&&(t+='in "'+n.mark.name+'" '),t+="("+(n.mark.line+1)+":"+(n.mark.column+1)+")",!e&&n.mark.snippet&&(t+=`

`+n.mark.snippet),r+" "+t):r}function ur(n,e){Error.call(this),this.name="YAMLException",this.reason=n,this.mark=e,this.message=Vi(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}ur.prototype=Object.create(Error.prototype);ur.prototype.constructor=ur;ur.prototype.toString=function(e){return this.name+": "+Vi(this,e)};var ht=ur,Yu=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],Wu=["scalar","sequence","mapping"];function Gu(n){var e={};return n!==null&&Object.keys(n).forEach(function(t){n[t].forEach(function(r){e[String(r)]=t})}),e}function Ju(n,e){if(e=e||{},Object.keys(e).forEach(function(t){if(Yu.indexOf(t)===-1)throw new ht('Unknown option "'+t+'" is met in definition of "'+n+'" YAML type.')}),this.options=e,this.tag=n,this.kind=e.kind||null,this.resolve=e.resolve||function(){return!0},this.construct=e.construct||function(t){return t},this.instanceOf=e.instanceOf||null,this.predicate=e.predicate||null,this.represent=e.represent||null,this.representName=e.representName||null,this.defaultStyle=e.defaultStyle||null,this.multi=e.multi||!1,this.styleAliases=Gu(e.styleAliases||null),Wu.indexOf(this.kind)===-1)throw new ht('Unknown kind "'+this.kind+'" is specified for "'+n+'" YAML type.')}var ke=Ju;function ga(n,e){var t=[];return n[e].forEach(function(r){var a=t.length;t.forEach(function(i,s){i.tag===r.tag&&i.kind===r.kind&&i.multi===r.multi&&(a=s)}),t[a]=r}),t}function Qu(){var n={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},e,t;function r(a){a.multi?(n.multi[a.kind].push(a),n.multi.fallback.push(a)):n[a.kind][a.tag]=n.fallback[a.tag]=a}for(e=0,t=arguments.length;e<t;e+=1)arguments[e].forEach(r);return n}function nn(n){return this.extend(n)}nn.prototype.extend=function(e){var t=[],r=[];if(e instanceof ke)r.push(e);else if(Array.isArray(e))r=r.concat(e);else if(e&&(Array.isArray(e.implicit)||Array.isArray(e.explicit)))e.implicit&&(t=t.concat(e.implicit)),e.explicit&&(r=r.concat(e.explicit));else throw new ht("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");t.forEach(function(i){if(!(i instanceof ke))throw new ht("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(i.loadKind&&i.loadKind!=="scalar")throw new ht("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(i.multi)throw new ht("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),r.forEach(function(i){if(!(i instanceof ke))throw new ht("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var a=Object.create(nn.prototype);return a.implicit=(this.implicit||[]).concat(t),a.explicit=(this.explicit||[]).concat(r),a.compiledImplicit=ga(a,"implicit"),a.compiledExplicit=ga(a,"explicit"),a.compiledTypeMap=Qu(a.compiledImplicit,a.compiledExplicit),a};var Xu=nn,ec=new ke("tag:yaml.org,2002:str",{kind:"scalar",construct:function(n){return n!==null?n:""}}),tc=new ke("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(n){return n!==null?n:[]}}),rc=new ke("tag:yaml.org,2002:map",{kind:"mapping",construct:function(n){return n!==null?n:{}}}),nc=new Xu({explicit:[ec,tc,rc]});function ac(n){if(n===null)return!0;var e=n.length;return e===1&&n==="~"||e===4&&(n==="null"||n==="Null"||n==="NULL")}function ic(){return null}function sc(n){return n===null}var oc=new ke("tag:yaml.org,2002:null",{kind:"scalar",resolve:ac,construct:ic,predicate:sc,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});function uc(n){if(n===null)return!1;var e=n.length;return e===4&&(n==="true"||n==="True"||n==="TRUE")||e===5&&(n==="false"||n==="False"||n==="FALSE")}function cc(n){return n==="true"||n==="True"||n==="TRUE"}function lc(n){return Object.prototype.toString.call(n)==="[object Boolean]"}var dc=new ke("tag:yaml.org,2002:bool",{kind:"scalar",resolve:uc,construct:cc,predicate:lc,represent:{lowercase:function(n){return n?"true":"false"},uppercase:function(n){return n?"TRUE":"FALSE"},camelcase:function(n){return n?"True":"False"}},defaultStyle:"lowercase"});function hc(n){return 48<=n&&n<=57||65<=n&&n<=70||97<=n&&n<=102}function pc(n){return 48<=n&&n<=55}function fc(n){return 48<=n&&n<=57}function mc(n){if(n===null)return!1;var e=n.length,t=0,r=!1,a;if(!e)return!1;if(a=n[t],(a==="-"||a==="+")&&(a=n[++t]),a==="0"){if(t+1===e)return!0;if(a=n[++t],a==="b"){for(t++;t<e;t++)if(a=n[t],a!=="_"){if(a!=="0"&&a!=="1")return!1;r=!0}return r&&a!=="_"}if(a==="x"){for(t++;t<e;t++)if(a=n[t],a!=="_"){if(!hc(n.charCodeAt(t)))return!1;r=!0}return r&&a!=="_"}if(a==="o"){for(t++;t<e;t++)if(a=n[t],a!=="_"){if(!pc(n.charCodeAt(t)))return!1;r=!0}return r&&a!=="_"}}if(a==="_")return!1;for(;t<e;t++)if(a=n[t],a!=="_"){if(!fc(n.charCodeAt(t)))return!1;r=!0}return!(!r||a==="_")}function gc(n){var e=n,t=1,r;if(e.indexOf("_")!==-1&&(e=e.replace(/_/g,"")),r=e[0],(r==="-"||r==="+")&&(r==="-"&&(t=-1),e=e.slice(1),r=e[0]),e==="0")return 0;if(r==="0"){if(e[1]==="b")return t*parseInt(e.slice(2),2);if(e[1]==="x")return t*parseInt(e.slice(2),16);if(e[1]==="o")return t*parseInt(e.slice(2),8)}return t*parseInt(e,10)}function yc(n){return Object.prototype.toString.call(n)==="[object Number]"&&n%1===0&&!kn.isNegativeZero(n)}var bc=new ke("tag:yaml.org,2002:int",{kind:"scalar",resolve:mc,construct:gc,predicate:yc,represent:{binary:function(n){return n>=0?"0b"+n.toString(2):"-0b"+n.toString(2).slice(1)},octal:function(n){return n>=0?"0o"+n.toString(8):"-0o"+n.toString(8).slice(1)},decimal:function(n){return n.toString(10)},hexadecimal:function(n){return n>=0?"0x"+n.toString(16).toUpperCase():"-0x"+n.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),_c=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function vc(n){return!(n===null||!_c.test(n)||n[n.length-1]==="_")}function wc(n){var e,t;return e=n.replace(/_/g,"").toLowerCase(),t=e[0]==="-"?-1:1,"+-".indexOf(e[0])>=0&&(e=e.slice(1)),e===".inf"?t===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:e===".nan"?NaN:t*parseFloat(e,10)}var Oc=/^[-+]?[0-9]+e/;function Pc(n,e){var t;if(isNaN(n))switch(e){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===n)switch(e){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===n)switch(e){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(kn.isNegativeZero(n))return"-0.0";return t=n.toString(10),Oc.test(t)?t.replace("e",".e"):t}function Ac(n){return Object.prototype.toString.call(n)==="[object Number]"&&(n%1!==0||kn.isNegativeZero(n))}var xc=new ke("tag:yaml.org,2002:float",{kind:"scalar",resolve:vc,construct:wc,predicate:Ac,represent:Pc,defaultStyle:"lowercase"}),Ec=nc.extend({implicit:[oc,dc,bc,xc]}),kc=Ec,zi=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),$i=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function Ic(n){return n===null?!1:zi.exec(n)!==null||$i.exec(n)!==null}function Tc(n){var e,t,r,a,i,s,o,u=0,c=null,m,P,j;if(e=zi.exec(n),e===null&&(e=$i.exec(n)),e===null)throw new Error("Date resolve error");if(t=+e[1],r=+e[2]-1,a=+e[3],!e[4])return new Date(Date.UTC(t,r,a));if(i=+e[4],s=+e[5],o=+e[6],e[7]){for(u=e[7].slice(0,3);u.length<3;)u+="0";u=+u}return e[9]&&(m=+e[10],P=+(e[11]||0),c=(m*60+P)*6e4,e[9]==="-"&&(c=-c)),j=new Date(Date.UTC(t,r,a,i,s,o,u)),c&&j.setTime(j.getTime()-c),j}function jc(n){return n.toISOString()}var Sc=new ke("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:Ic,construct:Tc,instanceOf:Date,represent:jc});function Cc(n){return n==="<<"||n===null}var Nc=new ke("tag:yaml.org,2002:merge",{kind:"scalar",resolve:Cc}),In=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function Dc(n){if(n===null)return!1;var e,t,r=0,a=n.length,i=In;for(t=0;t<a;t++)if(e=i.indexOf(n.charAt(t)),!(e>64)){if(e<0)return!1;r+=6}return r%8===0}function Mc(n){var e,t,r=n.replace(/[\r\n=]/g,""),a=r.length,i=In,s=0,o=[];for(e=0;e<a;e++)e%4===0&&e&&(o.push(s>>16&255),o.push(s>>8&255),o.push(s&255)),s=s<<6|i.indexOf(r.charAt(e));return t=a%4*6,t===0?(o.push(s>>16&255),o.push(s>>8&255),o.push(s&255)):t===18?(o.push(s>>10&255),o.push(s>>2&255)):t===12&&o.push(s>>4&255),new Uint8Array(o)}function Lc(n){var e="",t=0,r,a,i=n.length,s=In;for(r=0;r<i;r++)r%3===0&&r&&(e+=s[t>>18&63],e+=s[t>>12&63],e+=s[t>>6&63],e+=s[t&63]),t=(t<<8)+n[r];return a=i%3,a===0?(e+=s[t>>18&63],e+=s[t>>12&63],e+=s[t>>6&63],e+=s[t&63]):a===2?(e+=s[t>>10&63],e+=s[t>>4&63],e+=s[t<<2&63],e+=s[64]):a===1&&(e+=s[t>>2&63],e+=s[t<<4&63],e+=s[64],e+=s[64]),e}function Rc(n){return Object.prototype.toString.call(n)==="[object Uint8Array]"}var Bc=new ke("tag:yaml.org,2002:binary",{kind:"scalar",resolve:Dc,construct:Mc,predicate:Rc,represent:Lc}),Zc=Object.prototype.hasOwnProperty,Uc=Object.prototype.toString;function Kc(n){if(n===null)return!0;var e=[],t,r,a,i,s,o=n;for(t=0,r=o.length;t<r;t+=1){if(a=o[t],s=!1,Uc.call(a)!=="[object Object]")return!1;for(i in a)if(Zc.call(a,i))if(!s)s=!0;else return!1;if(!s)return!1;if(e.indexOf(i)===-1)e.push(i);else return!1}return!0}function Vc(n){return n!==null?n:[]}var zc=new ke("tag:yaml.org,2002:omap",{kind:"sequence",resolve:Kc,construct:Vc}),$c=Object.prototype.toString;function Fc(n){if(n===null)return!0;var e,t,r,a,i,s=n;for(i=new Array(s.length),e=0,t=s.length;e<t;e+=1){if(r=s[e],$c.call(r)!=="[object Object]"||(a=Object.keys(r),a.length!==1))return!1;i[e]=[a[0],r[a[0]]]}return!0}function qc(n){if(n===null)return[];var e,t,r,a,i,s=n;for(i=new Array(s.length),e=0,t=s.length;e<t;e+=1)r=s[e],a=Object.keys(r),i[e]=[a[0],r[a[0]]];return i}var Hc=new ke("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:Fc,construct:qc}),Yc=Object.prototype.hasOwnProperty;function Wc(n){if(n===null)return!0;var e,t=n;for(e in t)if(Yc.call(t,e)&&t[e]!==null)return!1;return!0}function Gc(n){return n!==null?n:{}}var Jc=new ke("tag:yaml.org,2002:set",{kind:"mapping",resolve:Wc,construct:Gc});kc.extend({implicit:[Sc,Nc],explicit:[Bc,zc,Hc,Jc]});function ya(n){return n===48?"\0":n===97?"\x07":n===98?"\b":n===116||n===9?"	":n===110?`
`:n===118?"\v":n===102?"\f":n===114?"\r":n===101?"\x1B":n===32?" ":n===34?'"':n===47?"/":n===92?"\\":n===78?"":n===95?"":n===76?"\u2028":n===80?"\u2029":""}var Qc=new Array(256),Xc=new Array(256);for(var bt=0;bt<256;bt++)Qc[bt]=ya(bt)?1:0,Xc[bt]=ya(bt);const Fi=async(n,e,t,r,a,i,s,o,u)=>(await n.call(fetch,"https://api.promptlayer.com/track-request",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({function_name:e,provider:"langchain",args:t,kwargs:r,tags:a,request_response:i,request_start_time:Math.floor(s/1e3),request_end_time:Math.floor(o/1e3),api_key:u})})).json();var qi={exports:{}};(function(n,e){(function(t){n.exports=t()})(function(){return function t(r,a,i){function s(c,m){if(!a[c]){if(!r[c]){var P=typeof fr=="function"&&fr;if(!m&&P)return P(c,!0);if(o)return o(c,!0);throw new Error("Cannot find module '"+c+"'")}m=a[c]={exports:{}},r[c][0].call(m.exports,function(j){var z=r[c][1][j];return s(z||j)},m,m.exports,t,r,a,i)}return a[c].exports}for(var o=typeof fr=="function"&&fr,u=0;u<i.length;u++)s(i[u]);return s}({1:[function(t,r,a){(function(i,s,o,u,c,m,P,j,z){var O=t("crypto");function N(g,w){w=I(g,w);var h;return(h=w.algorithm!=="passthrough"?O.createHash(w.algorithm):new B).write===void 0&&(h.write=h.update,h.end=h.update),A(w,h).dispatch(g),h.update||h.end(""),h.digest?h.digest(w.encoding==="buffer"?void 0:w.encoding):(g=h.read(),w.encoding!=="buffer"?g.toString(w.encoding):g)}(a=r.exports=N).sha1=function(g){return N(g)},a.keys=function(g){return N(g,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})},a.MD5=function(g){return N(g,{algorithm:"md5",encoding:"hex"})},a.keysMD5=function(g){return N(g,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var b=O.getHashes?O.getHashes().slice():["sha1","md5"],x=(b.push("passthrough"),["buffer","hex","binary","base64"]);function I(g,w){var h={};if(h.algorithm=(w=w||{}).algorithm||"sha1",h.encoding=w.encoding||"hex",h.excludeValues=!!w.excludeValues,h.algorithm=h.algorithm.toLowerCase(),h.encoding=h.encoding.toLowerCase(),h.ignoreUnknown=w.ignoreUnknown===!0,h.respectType=w.respectType!==!1,h.respectFunctionNames=w.respectFunctionNames!==!1,h.respectFunctionProperties=w.respectFunctionProperties!==!1,h.unorderedArrays=w.unorderedArrays===!0,h.unorderedSets=w.unorderedSets!==!1,h.unorderedObjects=w.unorderedObjects!==!1,h.replacer=w.replacer||void 0,h.excludeKeys=w.excludeKeys||void 0,g===void 0)throw new Error("Object argument required.");for(var f=0;f<b.length;++f)b[f].toLowerCase()===h.algorithm.toLowerCase()&&(h.algorithm=b[f]);if(b.indexOf(h.algorithm)===-1)throw new Error('Algorithm "'+h.algorithm+'"  not supported. supported values: '+b.join(", "));if(x.indexOf(h.encoding)===-1&&h.algorithm!=="passthrough")throw new Error('Encoding "'+h.encoding+'"  not supported. supported values: '+x.join(", "));return h}function E(g){if(typeof g=="function")return/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(g))!=null}function A(g,w,h){h=h||[];function f(d){return w.update?w.update(d,"utf8"):w.write(d,"utf8")}return{dispatch:function(d){return this["_"+((d=g.replacer?g.replacer(d):d)===null?"null":typeof d)](d)},_object:function(d){var _,v=Object.prototype.toString.call(d),$=/\[object (.*)\]/i.exec(v);if($=($=$?$[1]:"unknown:["+v+"]").toLowerCase(),0<=(v=h.indexOf(d)))return this.dispatch("[CIRCULAR:"+v+"]");if(h.push(d),o!==void 0&&o.isBuffer&&o.isBuffer(d))return f("buffer:"),f(d);if($==="object"||$==="function"||$==="asyncfunction")return v=Object.keys(d),g.unorderedObjects&&(v=v.sort()),g.respectType===!1||E(d)||v.splice(0,0,"prototype","__proto__","constructor"),g.excludeKeys&&(v=v.filter(function(F){return!g.excludeKeys(F)})),f("object:"+v.length+":"),_=this,v.forEach(function(F){_.dispatch(F),f(":"),g.excludeValues||_.dispatch(d[F]),f(",")});if(!this["_"+$]){if(g.ignoreUnknown)return f("["+$+"]");throw new Error('Unknown object type "'+$+'"')}this["_"+$](d)},_array:function(d,F){F=F!==void 0?F:g.unorderedArrays!==!1;var v=this;if(f("array:"+d.length+":"),!F||d.length<=1)return d.forEach(function(q){return v.dispatch(q)});var $=[],F=d.map(function(q){var R=new B,G=h.slice();return A(g,R,G).dispatch(q),$=$.concat(G.slice(h.length)),R.read().toString()});return h=h.concat($),F.sort(),this._array(F,!1)},_date:function(d){return f("date:"+d.toJSON())},_symbol:function(d){return f("symbol:"+d.toString())},_error:function(d){return f("error:"+d.toString())},_boolean:function(d){return f("bool:"+d.toString())},_string:function(d){f("string:"+d.length+":"),f(d.toString())},_function:function(d){f("fn:"),E(d)?this.dispatch("[native]"):this.dispatch(d.toString()),g.respectFunctionNames!==!1&&this.dispatch("function-name:"+String(d.name)),g.respectFunctionProperties&&this._object(d)},_number:function(d){return f("number:"+d.toString())},_xml:function(d){return f("xml:"+d.toString())},_null:function(){return f("Null")},_undefined:function(){return f("Undefined")},_regexp:function(d){return f("regex:"+d.toString())},_uint8array:function(d){return f("uint8array:"),this.dispatch(Array.prototype.slice.call(d))},_uint8clampedarray:function(d){return f("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(d))},_int8array:function(d){return f("int8array:"),this.dispatch(Array.prototype.slice.call(d))},_uint16array:function(d){return f("uint16array:"),this.dispatch(Array.prototype.slice.call(d))},_int16array:function(d){return f("int16array:"),this.dispatch(Array.prototype.slice.call(d))},_uint32array:function(d){return f("uint32array:"),this.dispatch(Array.prototype.slice.call(d))},_int32array:function(d){return f("int32array:"),this.dispatch(Array.prototype.slice.call(d))},_float32array:function(d){return f("float32array:"),this.dispatch(Array.prototype.slice.call(d))},_float64array:function(d){return f("float64array:"),this.dispatch(Array.prototype.slice.call(d))},_arraybuffer:function(d){return f("arraybuffer:"),this.dispatch(new Uint8Array(d))},_url:function(d){return f("url:"+d.toString())},_map:function(d){return f("map:"),d=Array.from(d),this._array(d,g.unorderedSets!==!1)},_set:function(d){return f("set:"),d=Array.from(d),this._array(d,g.unorderedSets!==!1)},_file:function(d){return f("file:"),this.dispatch([d.name,d.size,d.type,d.lastModfied])},_blob:function(){if(g.ignoreUnknown)return f("[blob]");throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){return f("domwindow")},_bigint:function(d){return f("bigint:"+d.toString())},_process:function(){return f("process")},_timer:function(){return f("timer")},_pipe:function(){return f("pipe")},_tcp:function(){return f("tcp")},_udp:function(){return f("udp")},_tty:function(){return f("tty")},_statwatcher:function(){return f("statwatcher")},_securecontext:function(){return f("securecontext")},_connection:function(){return f("connection")},_zlib:function(){return f("zlib")},_context:function(){return f("context")},_nodescript:function(){return f("nodescript")},_httpparser:function(){return f("httpparser")},_dataview:function(){return f("dataview")},_signal:function(){return f("signal")},_fsevent:function(){return f("fsevent")},_tlswrap:function(){return f("tlswrap")}}}function B(){return{buf:"",write:function(g){this.buf+=g},end:function(g){this.buf+=g},read:function(){return this.buf}}}a.writeToStream=function(g,w,h){return h===void 0&&(h=w,w={}),A(w=I(g,w),h).dispatch(g)}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/fake_9a5aa49d.js","/")},{buffer:3,crypto:5,lYpoI2:11}],2:[function(t,r,a){(function(i,s,o,u,c,m,P,j,z){(function(O){var N=typeof Uint8Array<"u"?Uint8Array:Array,b="+".charCodeAt(0),x="/".charCodeAt(0),I="0".charCodeAt(0),E="a".charCodeAt(0),A="A".charCodeAt(0),B="-".charCodeAt(0),g="_".charCodeAt(0);function w(h){return h=h.charCodeAt(0),h===b||h===B?62:h===x||h===g?63:h<I?-1:h<I+10?h-I+26+26:h<A+26?h-A:h<E+26?h-E+26:void 0}O.toByteArray=function(h){var f,d;if(0<h.length%4)throw new Error("Invalid string. Length must be a multiple of 4");var _=h.length,_=h.charAt(_-2)==="="?2:h.charAt(_-1)==="="?1:0,v=new N(3*h.length/4-_),$=0<_?h.length-4:h.length,F=0;function q(R){v[F++]=R}for(f=0;f<$;f+=4,0)q((16711680&(d=w(h.charAt(f))<<18|w(h.charAt(f+1))<<12|w(h.charAt(f+2))<<6|w(h.charAt(f+3))))>>16),q((65280&d)>>8),q(255&d);return _==2?q(255&(d=w(h.charAt(f))<<2|w(h.charAt(f+1))>>4)):_==1&&(q((d=w(h.charAt(f))<<10|w(h.charAt(f+1))<<4|w(h.charAt(f+2))>>2)>>8&255),q(255&d)),v},O.fromByteArray=function(h){var f,d,_,v,$=h.length%3,F="";function q(R){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(R)}for(f=0,_=h.length-$;f<_;f+=3)d=(h[f]<<16)+(h[f+1]<<8)+h[f+2],F+=q((v=d)>>18&63)+q(v>>12&63)+q(v>>6&63)+q(63&v);switch($){case 1:F=(F+=q((d=h[h.length-1])>>2))+q(d<<4&63)+"==";break;case 2:F=(F=(F+=q((d=(h[h.length-2]<<8)+h[h.length-1])>>10))+q(d>>4&63))+q(d<<2&63)+"="}return F}})(a===void 0?this.base64js={}:a)}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js","/node_modules/gulp-browserify/node_modules/base64-js/lib")},{buffer:3,lYpoI2:11}],3:[function(t,r,a){(function(i,s,b,u,c,m,P,j,z){var O=t("base64-js"),N=t("ieee754");function b(l,p,y){if(!(this instanceof b))return new b(l,p,y);var C,S,U,ue,ge=typeof l;if(p==="base64"&&ge=="string")for(l=(ue=l).trim?ue.trim():ue.replace(/^\s+|\s+$/g,"");l.length%4!=0;)l+="=";if(ge=="number")C=de(l);else if(ge=="string")C=b.byteLength(l,p);else{if(ge!="object")throw new Error("First argument needs to be a number, array or string.");C=de(l.length)}if(b._useTypedArrays?S=b._augment(new Uint8Array(C)):((S=this).length=C,S._isBuffer=!0),b._useTypedArrays&&typeof l.byteLength=="number")S._set(l);else if(k(ue=l)||b.isBuffer(ue)||ue&&typeof ue=="object"&&typeof ue.length=="number")for(U=0;U<C;U++)b.isBuffer(l)?S[U]=l.readUInt8(U):S[U]=l[U];else if(ge=="string")S.write(l,0,p);else if(ge=="number"&&!b._useTypedArrays&&!y)for(U=0;U<C;U++)S[U]=0;return S}function x(l,p,y,C){return b._charsWritten=me(function(S){for(var U=[],ue=0;ue<S.length;ue++)U.push(255&S.charCodeAt(ue));return U}(p),l,y,C)}function I(l,p,y,C){return b._charsWritten=me(function(S){for(var U,ue,ge=[],_e=0;_e<S.length;_e++)ue=S.charCodeAt(_e),U=ue>>8,ue=ue%256,ge.push(ue),ge.push(U);return ge}(p),l,y,C)}function E(l,p,y){var C="";y=Math.min(l.length,y);for(var S=p;S<y;S++)C+=String.fromCharCode(l[S]);return C}function A(l,p,y,U){U||(M(typeof y=="boolean","missing or invalid endian"),M(p!=null,"missing offset"),M(p+1<l.length,"Trying to read beyond buffer length"));var S,U=l.length;if(!(U<=p))return y?(S=l[p],p+1<U&&(S|=l[p+1]<<8)):(S=l[p]<<8,p+1<U&&(S|=l[p+1])),S}function B(l,p,y,U){U||(M(typeof y=="boolean","missing or invalid endian"),M(p!=null,"missing offset"),M(p+3<l.length,"Trying to read beyond buffer length"));var S,U=l.length;if(!(U<=p))return y?(p+2<U&&(S=l[p+2]<<16),p+1<U&&(S|=l[p+1]<<8),S|=l[p],p+3<U&&(S+=l[p+3]<<24>>>0)):(p+1<U&&(S=l[p+1]<<16),p+2<U&&(S|=l[p+2]<<8),p+3<U&&(S|=l[p+3]),S+=l[p]<<24>>>0),S}function g(l,p,y,C){if(C||(M(typeof y=="boolean","missing or invalid endian"),M(p!=null,"missing offset"),M(p+1<l.length,"Trying to read beyond buffer length")),!(l.length<=p))return C=A(l,p,y,!0),32768&C?-1*(65535-C+1):C}function w(l,p,y,C){if(C||(M(typeof y=="boolean","missing or invalid endian"),M(p!=null,"missing offset"),M(p+3<l.length,"Trying to read beyond buffer length")),!(l.length<=p))return C=B(l,p,y,!0),2147483648&C?-1*(4294967295-C+1):C}function h(l,p,y,C){return C||(M(typeof y=="boolean","missing or invalid endian"),M(p+3<l.length,"Trying to read beyond buffer length")),N.read(l,p,y,23,4)}function f(l,p,y,C){return C||(M(typeof y=="boolean","missing or invalid endian"),M(p+7<l.length,"Trying to read beyond buffer length")),N.read(l,p,y,52,8)}function d(l,p,y,C,S){if(S||(M(p!=null,"missing value"),M(typeof C=="boolean","missing or invalid endian"),M(y!=null,"missing offset"),M(y+1<l.length,"trying to write beyond buffer length"),oe(p,65535)),S=l.length,!(S<=y))for(var U=0,ue=Math.min(S-y,2);U<ue;U++)l[y+U]=(p&255<<8*(C?U:1-U))>>>8*(C?U:1-U)}function _(l,p,y,C,S){if(S||(M(p!=null,"missing value"),M(typeof C=="boolean","missing or invalid endian"),M(y!=null,"missing offset"),M(y+3<l.length,"trying to write beyond buffer length"),oe(p,4294967295)),S=l.length,!(S<=y))for(var U=0,ue=Math.min(S-y,4);U<ue;U++)l[y+U]=p>>>8*(C?U:3-U)&255}function v(l,p,y,C,S){S||(M(p!=null,"missing value"),M(typeof C=="boolean","missing or invalid endian"),M(y!=null,"missing offset"),M(y+1<l.length,"Trying to write beyond buffer length"),le(p,32767,-32768)),l.length<=y||d(l,0<=p?p:65535+p+1,y,C,S)}function $(l,p,y,C,S){S||(M(p!=null,"missing value"),M(typeof C=="boolean","missing or invalid endian"),M(y!=null,"missing offset"),M(y+3<l.length,"Trying to write beyond buffer length"),le(p,2147483647,-2147483648)),l.length<=y||_(l,0<=p?p:4294967295+p+1,y,C,S)}function F(l,p,y,C,S){S||(M(p!=null,"missing value"),M(typeof C=="boolean","missing or invalid endian"),M(y!=null,"missing offset"),M(y+3<l.length,"Trying to write beyond buffer length"),be(p,34028234663852886e22,-34028234663852886e22)),l.length<=y||N.write(l,p,y,C,23,4)}function q(l,p,y,C,S){S||(M(p!=null,"missing value"),M(typeof C=="boolean","missing or invalid endian"),M(y!=null,"missing offset"),M(y+7<l.length,"Trying to write beyond buffer length"),be(p,17976931348623157e292,-17976931348623157e292)),l.length<=y||N.write(l,p,y,C,52,8)}a.Buffer=b,a.SlowBuffer=b,a.INSPECT_MAX_BYTES=50,b.poolSize=8192,b._useTypedArrays=function(){try{var l=new ArrayBuffer(0),p=new Uint8Array(l);return p.foo=function(){return 42},p.foo()===42&&typeof p.subarray=="function"}catch{return!1}}(),b.isEncoding=function(l){switch(String(l).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},b.isBuffer=function(l){return!(l==null||!l._isBuffer)},b.byteLength=function(l,p){var y;switch(l+="",p||"utf8"){case"hex":y=l.length/2;break;case"utf8":case"utf-8":y=Z(l).length;break;case"ascii":case"binary":case"raw":y=l.length;break;case"base64":y=se(l).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":y=2*l.length;break;default:throw new Error("Unknown encoding")}return y},b.concat=function(l,p){if(M(k(l),`Usage: Buffer.concat(list, [totalLength])
list should be an Array.`),l.length===0)return new b(0);if(l.length===1)return l[0];if(typeof p!="number")for(S=p=0;S<l.length;S++)p+=l[S].length;for(var y=new b(p),C=0,S=0;S<l.length;S++){var U=l[S];U.copy(y,C),C+=U.length}return y},b.prototype.write=function(l,p,y,C){isFinite(p)?isFinite(y)||(C=y,y=void 0):(_e=C,C=p,p=y,y=_e),p=Number(p)||0;var S,U,ue,ge,_e=this.length-p;switch((!y||_e<(y=Number(y)))&&(y=_e),C=String(C||"utf8").toLowerCase()){case"hex":S=function(Ke,Te,je,ve){je=Number(je)||0;var ye=Ke.length-je;(!ve||ye<(ve=Number(ve)))&&(ve=ye),M((ye=Te.length)%2==0,"Invalid hex string"),ye/2<ve&&(ve=ye/2);for(var gt=0;gt<ve;gt++){var Nn=parseInt(Te.substr(2*gt,2),16);M(!isNaN(Nn),"Invalid hex string"),Ke[je+gt]=Nn}return b._charsWritten=2*gt,gt}(this,l,p,y);break;case"utf8":case"utf-8":U=this,ue=p,ge=y,S=b._charsWritten=me(Z(l),U,ue,ge);break;case"ascii":case"binary":S=x(this,l,p,y);break;case"base64":U=this,ue=p,ge=y,S=b._charsWritten=me(se(l),U,ue,ge);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":S=I(this,l,p,y);break;default:throw new Error("Unknown encoding")}return S},b.prototype.toString=function(l,p,y){var C,S,U,ue,ge=this;if(l=String(l||"utf8").toLowerCase(),p=Number(p)||0,(y=y!==void 0?Number(y):ge.length)===p)return"";switch(l){case"hex":C=function(_e,Ke,Te){var je=_e.length;(!Ke||Ke<0)&&(Ke=0),(!Te||Te<0||je<Te)&&(Te=je);for(var ve="",ye=Ke;ye<Te;ye++)ve+=L(_e[ye]);return ve}(ge,p,y);break;case"utf8":case"utf-8":C=function(_e,Ke,Te){var je="",ve="";Te=Math.min(_e.length,Te);for(var ye=Ke;ye<Te;ye++)_e[ye]<=127?(je+=T(ve)+String.fromCharCode(_e[ye]),ve=""):ve+="%"+_e[ye].toString(16);return je+T(ve)}(ge,p,y);break;case"ascii":case"binary":C=E(ge,p,y);break;case"base64":S=ge,ue=y,C=(U=p)===0&&ue===S.length?O.fromByteArray(S):O.fromByteArray(S.slice(U,ue));break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":C=function(_e,Ke,Te){for(var je=_e.slice(Ke,Te),ve="",ye=0;ye<je.length;ye+=2)ve+=String.fromCharCode(je[ye]+256*je[ye+1]);return ve}(ge,p,y);break;default:throw new Error("Unknown encoding")}return C},b.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},b.prototype.copy=function(l,p,y,C){if(p=p||0,(C=C||C===0?C:this.length)!==(y=y||0)&&l.length!==0&&this.length!==0){M(y<=C,"sourceEnd < sourceStart"),M(0<=p&&p<l.length,"targetStart out of bounds"),M(0<=y&&y<this.length,"sourceStart out of bounds"),M(0<=C&&C<=this.length,"sourceEnd out of bounds"),C>this.length&&(C=this.length);var S=(C=l.length-p<C-y?l.length-p+y:C)-y;if(S<100||!b._useTypedArrays)for(var U=0;U<S;U++)l[U+p]=this[U+y];else l._set(this.subarray(y,y+S),p)}},b.prototype.slice=function(l,p){var y=this.length;if(l=G(l,y,0),p=G(p,y,y),b._useTypedArrays)return b._augment(this.subarray(l,p));for(var C=p-l,S=new b(C,void 0,!0),U=0;U<C;U++)S[U]=this[U+l];return S},b.prototype.get=function(l){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(l)},b.prototype.set=function(l,p){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(l,p)},b.prototype.readUInt8=function(l,p){if(p||(M(l!=null,"missing offset"),M(l<this.length,"Trying to read beyond buffer length")),!(l>=this.length))return this[l]},b.prototype.readUInt16LE=function(l,p){return A(this,l,!0,p)},b.prototype.readUInt16BE=function(l,p){return A(this,l,!1,p)},b.prototype.readUInt32LE=function(l,p){return B(this,l,!0,p)},b.prototype.readUInt32BE=function(l,p){return B(this,l,!1,p)},b.prototype.readInt8=function(l,p){if(p||(M(l!=null,"missing offset"),M(l<this.length,"Trying to read beyond buffer length")),!(l>=this.length))return 128&this[l]?-1*(255-this[l]+1):this[l]},b.prototype.readInt16LE=function(l,p){return g(this,l,!0,p)},b.prototype.readInt16BE=function(l,p){return g(this,l,!1,p)},b.prototype.readInt32LE=function(l,p){return w(this,l,!0,p)},b.prototype.readInt32BE=function(l,p){return w(this,l,!1,p)},b.prototype.readFloatLE=function(l,p){return h(this,l,!0,p)},b.prototype.readFloatBE=function(l,p){return h(this,l,!1,p)},b.prototype.readDoubleLE=function(l,p){return f(this,l,!0,p)},b.prototype.readDoubleBE=function(l,p){return f(this,l,!1,p)},b.prototype.writeUInt8=function(l,p,y){y||(M(l!=null,"missing value"),M(p!=null,"missing offset"),M(p<this.length,"trying to write beyond buffer length"),oe(l,255)),p>=this.length||(this[p]=l)},b.prototype.writeUInt16LE=function(l,p,y){d(this,l,p,!0,y)},b.prototype.writeUInt16BE=function(l,p,y){d(this,l,p,!1,y)},b.prototype.writeUInt32LE=function(l,p,y){_(this,l,p,!0,y)},b.prototype.writeUInt32BE=function(l,p,y){_(this,l,p,!1,y)},b.prototype.writeInt8=function(l,p,y){y||(M(l!=null,"missing value"),M(p!=null,"missing offset"),M(p<this.length,"Trying to write beyond buffer length"),le(l,127,-128)),p>=this.length||(0<=l?this.writeUInt8(l,p,y):this.writeUInt8(255+l+1,p,y))},b.prototype.writeInt16LE=function(l,p,y){v(this,l,p,!0,y)},b.prototype.writeInt16BE=function(l,p,y){v(this,l,p,!1,y)},b.prototype.writeInt32LE=function(l,p,y){$(this,l,p,!0,y)},b.prototype.writeInt32BE=function(l,p,y){$(this,l,p,!1,y)},b.prototype.writeFloatLE=function(l,p,y){F(this,l,p,!0,y)},b.prototype.writeFloatBE=function(l,p,y){F(this,l,p,!1,y)},b.prototype.writeDoubleLE=function(l,p,y){q(this,l,p,!0,y)},b.prototype.writeDoubleBE=function(l,p,y){q(this,l,p,!1,y)},b.prototype.fill=function(l,p,y){if(p=p||0,y=y||this.length,M(typeof(l=typeof(l=l||0)=="string"?l.charCodeAt(0):l)=="number"&&!isNaN(l),"value is not a number"),M(p<=y,"end < start"),y!==p&&this.length!==0){M(0<=p&&p<this.length,"start out of bounds"),M(0<=y&&y<=this.length,"end out of bounds");for(var C=p;C<y;C++)this[C]=l}},b.prototype.inspect=function(){for(var l=[],p=this.length,y=0;y<p;y++)if(l[y]=L(this[y]),y===a.INSPECT_MAX_BYTES){l[y+1]="...";break}return"<Buffer "+l.join(" ")+">"},b.prototype.toArrayBuffer=function(){if(typeof Uint8Array>"u")throw new Error("Buffer.toArrayBuffer not supported in this browser");if(b._useTypedArrays)return new b(this).buffer;for(var l=new Uint8Array(this.length),p=0,y=l.length;p<y;p+=1)l[p]=this[p];return l.buffer};var R=b.prototype;function G(l,p,y){return typeof l!="number"?y:p<=(l=~~l)?p:0<=l||0<=(l+=p)?l:0}function de(l){return(l=~~Math.ceil(+l))<0?0:l}function k(l){return(Array.isArray||function(p){return Object.prototype.toString.call(p)==="[object Array]"})(l)}function L(l){return l<16?"0"+l.toString(16):l.toString(16)}function Z(l){for(var p=[],y=0;y<l.length;y++){var C=l.charCodeAt(y);if(C<=127)p.push(l.charCodeAt(y));else for(var S=y,U=(55296<=C&&C<=57343&&y++,encodeURIComponent(l.slice(S,y+1)).substr(1).split("%")),ue=0;ue<U.length;ue++)p.push(parseInt(U[ue],16))}return p}function se(l){return O.toByteArray(l)}function me(l,p,y,C){for(var S=0;S<C&&!(S+y>=p.length||S>=l.length);S++)p[S+y]=l[S];return S}function T(l){try{return decodeURIComponent(l)}catch{return String.fromCharCode(65533)}}function oe(l,p){M(typeof l=="number","cannot write a non-number as a number"),M(0<=l,"specified a negative value for writing an unsigned value"),M(l<=p,"value is larger than maximum value for type"),M(Math.floor(l)===l,"value has a fractional component")}function le(l,p,y){M(typeof l=="number","cannot write a non-number as a number"),M(l<=p,"value larger than maximum allowed value"),M(y<=l,"value smaller than minimum allowed value"),M(Math.floor(l)===l,"value has a fractional component")}function be(l,p,y){M(typeof l=="number","cannot write a non-number as a number"),M(l<=p,"value larger than maximum allowed value"),M(y<=l,"value smaller than minimum allowed value")}function M(l,p){if(!l)throw new Error(p||"Failed assertion")}b._augment=function(l){return l._isBuffer=!0,l._get=l.get,l._set=l.set,l.get=R.get,l.set=R.set,l.write=R.write,l.toString=R.toString,l.toLocaleString=R.toString,l.toJSON=R.toJSON,l.copy=R.copy,l.slice=R.slice,l.readUInt8=R.readUInt8,l.readUInt16LE=R.readUInt16LE,l.readUInt16BE=R.readUInt16BE,l.readUInt32LE=R.readUInt32LE,l.readUInt32BE=R.readUInt32BE,l.readInt8=R.readInt8,l.readInt16LE=R.readInt16LE,l.readInt16BE=R.readInt16BE,l.readInt32LE=R.readInt32LE,l.readInt32BE=R.readInt32BE,l.readFloatLE=R.readFloatLE,l.readFloatBE=R.readFloatBE,l.readDoubleLE=R.readDoubleLE,l.readDoubleBE=R.readDoubleBE,l.writeUInt8=R.writeUInt8,l.writeUInt16LE=R.writeUInt16LE,l.writeUInt16BE=R.writeUInt16BE,l.writeUInt32LE=R.writeUInt32LE,l.writeUInt32BE=R.writeUInt32BE,l.writeInt8=R.writeInt8,l.writeInt16LE=R.writeInt16LE,l.writeInt16BE=R.writeInt16BE,l.writeInt32LE=R.writeInt32LE,l.writeInt32BE=R.writeInt32BE,l.writeFloatLE=R.writeFloatLE,l.writeFloatBE=R.writeFloatBE,l.writeDoubleLE=R.writeDoubleLE,l.writeDoubleBE=R.writeDoubleBE,l.fill=R.fill,l.inspect=R.inspect,l.toArrayBuffer=R.toArrayBuffer,l}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/buffer/index.js","/node_modules/gulp-browserify/node_modules/buffer")},{"base64-js":2,buffer:3,ieee754:10,lYpoI2:11}],4:[function(t,r,a){(function(i,s,O,u,c,m,P,j,z){var O=t("buffer").Buffer,N=4,b=new O(N);b.fill(0),r.exports={hash:function(x,I,E,A){for(var B=I(function(d,_){d.length%N!=0&&(v=d.length+(N-d.length%N),d=O.concat([d,b],v));for(var v,$=[],F=_?d.readInt32BE:d.readInt32LE,q=0;q<d.length;q+=N)$.push(F.call(d,q));return $}(x=O.isBuffer(x)?x:new O(x),A),8*x.length),I=A,g=new O(E),w=I?g.writeInt32BE:g.writeInt32LE,h=0;h<B.length;h++)w.call(g,B[h],4*h,!0);return g}}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/helpers.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],5:[function(t,r,a){(function(i,s,O,u,c,m,P,j,z){var O=t("buffer").Buffer,N=t("./sha"),b=t("./sha256"),x=t("./rng"),I={sha1:N,sha256:b,md5:t("./md5")},E=64,A=new O(E);function B(d,_){var v=I[d=d||"sha1"],$=[];return v||g("algorithm:",d,"is not yet supported"),{update:function(F){return O.isBuffer(F)||(F=new O(F)),$.push(F),F.length,this},digest:function(F){var q=O.concat($),q=_?function(R,G,de){O.isBuffer(G)||(G=new O(G)),O.isBuffer(de)||(de=new O(de)),G.length>E?G=R(G):G.length<E&&(G=O.concat([G,A],E));for(var k=new O(E),L=new O(E),Z=0;Z<E;Z++)k[Z]=54^G[Z],L[Z]=92^G[Z];return de=R(O.concat([k,de])),R(O.concat([L,de]))}(v,_,q):v(q);return $=null,F?q.toString(F):q}}}function g(){var d=[].slice.call(arguments).join(" ");throw new Error([d,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join(`
`))}A.fill(0),a.createHash=function(d){return B(d)},a.createHmac=B,a.randomBytes=function(d,_){if(!_||!_.call)return new O(x(d));try{_.call(this,void 0,new O(x(d)))}catch(v){_(v)}};var w,h=["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],f=function(d){a[d]=function(){g("sorry,",d,"is not implemented yet")}};for(w in h)f(h[w])}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/index.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./md5":6,"./rng":7,"./sha":8,"./sha256":9,buffer:3,lYpoI2:11}],6:[function(t,r,a){(function(i,s,o,u,c,m,P,j,z){var O=t("./helpers");function N(g,w){g[w>>5]|=128<<w%32,g[14+(w+64>>>9<<4)]=w;for(var h=1732584193,f=-271733879,d=-1732584194,_=271733878,v=0;v<g.length;v+=16){var $=h,F=f,q=d,R=_,h=x(h,f,d,_,g[v+0],7,-680876936),_=x(_,h,f,d,g[v+1],12,-389564586),d=x(d,_,h,f,g[v+2],17,606105819),f=x(f,d,_,h,g[v+3],22,-1044525330);h=x(h,f,d,_,g[v+4],7,-176418897),_=x(_,h,f,d,g[v+5],12,1200080426),d=x(d,_,h,f,g[v+6],17,-1473231341),f=x(f,d,_,h,g[v+7],22,-45705983),h=x(h,f,d,_,g[v+8],7,1770035416),_=x(_,h,f,d,g[v+9],12,-1958414417),d=x(d,_,h,f,g[v+10],17,-42063),f=x(f,d,_,h,g[v+11],22,-1990404162),h=x(h,f,d,_,g[v+12],7,1804603682),_=x(_,h,f,d,g[v+13],12,-40341101),d=x(d,_,h,f,g[v+14],17,-1502002290),h=I(h,f=x(f,d,_,h,g[v+15],22,1236535329),d,_,g[v+1],5,-165796510),_=I(_,h,f,d,g[v+6],9,-1069501632),d=I(d,_,h,f,g[v+11],14,643717713),f=I(f,d,_,h,g[v+0],20,-373897302),h=I(h,f,d,_,g[v+5],5,-701558691),_=I(_,h,f,d,g[v+10],9,38016083),d=I(d,_,h,f,g[v+15],14,-660478335),f=I(f,d,_,h,g[v+4],20,-405537848),h=I(h,f,d,_,g[v+9],5,568446438),_=I(_,h,f,d,g[v+14],9,-1019803690),d=I(d,_,h,f,g[v+3],14,-187363961),f=I(f,d,_,h,g[v+8],20,1163531501),h=I(h,f,d,_,g[v+13],5,-1444681467),_=I(_,h,f,d,g[v+2],9,-51403784),d=I(d,_,h,f,g[v+7],14,1735328473),h=E(h,f=I(f,d,_,h,g[v+12],20,-1926607734),d,_,g[v+5],4,-378558),_=E(_,h,f,d,g[v+8],11,-2022574463),d=E(d,_,h,f,g[v+11],16,1839030562),f=E(f,d,_,h,g[v+14],23,-35309556),h=E(h,f,d,_,g[v+1],4,-1530992060),_=E(_,h,f,d,g[v+4],11,1272893353),d=E(d,_,h,f,g[v+7],16,-155497632),f=E(f,d,_,h,g[v+10],23,-1094730640),h=E(h,f,d,_,g[v+13],4,681279174),_=E(_,h,f,d,g[v+0],11,-358537222),d=E(d,_,h,f,g[v+3],16,-722521979),f=E(f,d,_,h,g[v+6],23,76029189),h=E(h,f,d,_,g[v+9],4,-640364487),_=E(_,h,f,d,g[v+12],11,-421815835),d=E(d,_,h,f,g[v+15],16,530742520),h=A(h,f=E(f,d,_,h,g[v+2],23,-995338651),d,_,g[v+0],6,-198630844),_=A(_,h,f,d,g[v+7],10,1126891415),d=A(d,_,h,f,g[v+14],15,-1416354905),f=A(f,d,_,h,g[v+5],21,-57434055),h=A(h,f,d,_,g[v+12],6,1700485571),_=A(_,h,f,d,g[v+3],10,-1894986606),d=A(d,_,h,f,g[v+10],15,-1051523),f=A(f,d,_,h,g[v+1],21,-2054922799),h=A(h,f,d,_,g[v+8],6,1873313359),_=A(_,h,f,d,g[v+15],10,-30611744),d=A(d,_,h,f,g[v+6],15,-1560198380),f=A(f,d,_,h,g[v+13],21,1309151649),h=A(h,f,d,_,g[v+4],6,-145523070),_=A(_,h,f,d,g[v+11],10,-1120210379),d=A(d,_,h,f,g[v+2],15,718787259),f=A(f,d,_,h,g[v+9],21,-343485551),h=B(h,$),f=B(f,F),d=B(d,q),_=B(_,R)}return Array(h,f,d,_)}function b(g,w,h,f,d,_){return B((w=B(B(w,g),B(f,_)))<<d|w>>>32-d,h)}function x(g,w,h,f,d,_,v){return b(w&h|~w&f,g,w,d,_,v)}function I(g,w,h,f,d,_,v){return b(w&f|h&~f,g,w,d,_,v)}function E(g,w,h,f,d,_,v){return b(w^h^f,g,w,d,_,v)}function A(g,w,h,f,d,_,v){return b(h^(w|~f),g,w,d,_,v)}function B(g,w){var h=(65535&g)+(65535&w);return(g>>16)+(w>>16)+(h>>16)<<16|65535&h}r.exports=function(g){return O.hash(g,N,16)}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/md5.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],7:[function(t,r,a){(function(i,s,o,u,c,m,P,j,z){r.exports=function(O){for(var N,b=new Array(O),x=0;x<O;x++)!(3&x)&&(N=4294967296*Math.random()),b[x]=N>>>((3&x)<<3)&255;return b}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/rng.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],8:[function(t,r,a){(function(i,s,o,u,c,m,P,j,z){var O=t("./helpers");function N(I,E){I[E>>5]|=128<<24-E%32,I[15+(E+64>>9<<4)]=E;for(var A,B,g,w=Array(80),h=1732584193,f=-271733879,d=-1732584194,_=271733878,v=-1009589776,$=0;$<I.length;$+=16){for(var F=h,q=f,R=d,G=_,de=v,k=0;k<80;k++){w[k]=k<16?I[$+k]:x(w[k-3]^w[k-8]^w[k-14]^w[k-16],1);var L=b(b(x(h,5),(L=f,B=d,g=_,(A=k)<20?L&B|~L&g:!(A<40)&&A<60?L&B|L&g|B&g:L^B^g)),b(b(v,w[k]),(A=k)<20?1518500249:A<40?1859775393:A<60?-1894007588:-899497514)),v=_,_=d,d=x(f,30),f=h,h=L}h=b(h,F),f=b(f,q),d=b(d,R),_=b(_,G),v=b(v,de)}return Array(h,f,d,_,v)}function b(I,E){var A=(65535&I)+(65535&E);return(I>>16)+(E>>16)+(A>>16)<<16|65535&A}function x(I,E){return I<<E|I>>>32-E}r.exports=function(I){return O.hash(I,N,20,!0)}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],9:[function(t,r,a){(function(i,s,o,u,c,m,P,j,z){function O(E,A){var B=(65535&E)+(65535&A);return(E>>16)+(A>>16)+(B>>16)<<16|65535&B}function N(E,A){var B,g=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),w=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),h=new Array(64);E[A>>5]|=128<<24-A%32,E[15+(A+64>>9<<4)]=A;for(var f,d,_=0;_<E.length;_+=16){for(var v=w[0],$=w[1],F=w[2],q=w[3],R=w[4],G=w[5],de=w[6],k=w[7],L=0;L<64;L++)h[L]=L<16?E[L+_]:O(O(O((d=h[L-2],x(d,17)^x(d,19)^I(d,10)),h[L-7]),(d=h[L-15],x(d,7)^x(d,18)^I(d,3))),h[L-16]),B=O(O(O(O(k,x(d=R,6)^x(d,11)^x(d,25)),R&G^~R&de),g[L]),h[L]),f=O(x(f=v,2)^x(f,13)^x(f,22),v&$^v&F^$&F),k=de,de=G,G=R,R=O(q,B),q=F,F=$,$=v,v=O(B,f);w[0]=O(v,w[0]),w[1]=O($,w[1]),w[2]=O(F,w[2]),w[3]=O(q,w[3]),w[4]=O(R,w[4]),w[5]=O(G,w[5]),w[6]=O(de,w[6]),w[7]=O(k,w[7])}return w}var b=t("./helpers"),x=function(E,A){return E>>>A|E<<32-A},I=function(E,A){return E>>>A};r.exports=function(E){return b.hash(E,N,32,!0)}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha256.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],10:[function(t,r,a){(function(i,s,o,u,c,m,P,j,z){a.read=function(O,N,b,x,_){var E,A,B=8*_-x-1,g=(1<<B)-1,w=g>>1,h=-7,f=b?_-1:0,d=b?-1:1,_=O[N+f];for(f+=d,E=_&(1<<-h)-1,_>>=-h,h+=B;0<h;E=256*E+O[N+f],f+=d,h-=8);for(A=E&(1<<-h)-1,E>>=-h,h+=x;0<h;A=256*A+O[N+f],f+=d,h-=8);if(E===0)E=1-w;else{if(E===g)return A?NaN:1/0*(_?-1:1);A+=Math.pow(2,x),E-=w}return(_?-1:1)*A*Math.pow(2,E-x)},a.write=function(O,N,b,x,I,v){var A,B,g=8*v-I-1,w=(1<<g)-1,h=w>>1,f=I===23?Math.pow(2,-24)-Math.pow(2,-77):0,d=x?0:v-1,_=x?1:-1,v=N<0||N===0&&1/N<0?1:0;for(N=Math.abs(N),isNaN(N)||N===1/0?(B=isNaN(N)?1:0,A=w):(A=Math.floor(Math.log(N)/Math.LN2),N*(x=Math.pow(2,-A))<1&&(A--,x*=2),2<=(N+=1<=A+h?f/x:f*Math.pow(2,1-h))*x&&(A++,x/=2),w<=A+h?(B=0,A=w):1<=A+h?(B=(N*x-1)*Math.pow(2,I),A+=h):(B=N*Math.pow(2,h-1)*Math.pow(2,I),A=0));8<=I;O[b+d]=255&B,d+=_,B/=256,I-=8);for(A=A<<I|B,g+=I;0<g;O[b+d]=255&A,d+=_,A/=256,g-=8);O[b+d-_]|=128*v}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/ieee754/index.js","/node_modules/gulp-browserify/node_modules/ieee754")},{buffer:3,lYpoI2:11}],11:[function(t,r,a){(function(i,s,o,u,c,m,P,j,z){var O,N,b;function x(){}(i=r.exports={}).nextTick=(N=typeof window<"u"&&window.setImmediate,b=typeof window<"u"&&window.postMessage&&window.addEventListener,N?function(I){return window.setImmediate(I)}:b?(O=[],window.addEventListener("message",function(I){var E=I.source;E!==window&&E!==null||I.data!=="process-tick"||(I.stopPropagation(),0<O.length&&O.shift()())},!0),function(I){O.push(I),window.postMessage("process-tick","*")}):function(I){setTimeout(I,0)}),i.title="browser",i.browser=!0,i.env={},i.argv=[],i.on=x,i.addListener=x,i.once=x,i.off=x,i.removeListener=x,i.removeAllListeners=x,i.emit=x,i.binding=function(I){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(I){throw new Error("process.chdir is not supported")}}).call(this,t("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},t("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/process/browser.js","/node_modules/gulp-browserify/node_modules/process")},{buffer:3,lYpoI2:11}]},{},[1])(1)})})(qi);var el=qi.exports;const tl=Ua(el),ba=(...n)=>tl(n.join("_")),rl=new Map;class Tn extends ps{constructor(e){super(),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cache=e??new Map}lookup(e,t){return Promise.resolve(this.cache.get(ba(e,t))??null)}async update(e,t,r){this.cache.set(ba(e,t),r)}static global(){return new Tn(rl)}}class Hi extends qa{constructor({cache:e,concurrency:t,...r}){super(t?{maxConcurrency:t,...r}:r),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","llms",this._llmType()]}),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof e=="object"?this.cache=e:e?this.cache=Tn.global():this.cache=void 0}async generatePrompt(e,t,r){const a=e.map(i=>i.toString());return this.generate(a,t,r)}invocationParams(e){return{}}_flattenLLMResult(e){const t=[];for(let r=0;r<e.generations.length;r+=1){const a=e.generations[r];if(r===0)t.push({generations:[a],llmOutput:e.llmOutput});else{const i=e.llmOutput?{...e.llmOutput,tokenUsage:{}}:void 0;t.push({generations:[a],llmOutput:i})}}return t}async _generateUncached(e,t,r){const a=await at.configure(r.callbacks,this.callbacks,r.tags,this.tags,r.metadata,this.metadata,{verbose:this.verbose}),i={options:t,invocation_params:this==null?void 0:this.invocationParams(t)},s=await(a==null?void 0:a.handleLLMStart(this.toJSON(),e,void 0,void 0,i));let o;try{o=await this._generate(e,t,s==null?void 0:s[0])}catch(m){throw await Promise.all((s??[]).map(P=>P==null?void 0:P.handleLLMError(m))),m}const u=this._flattenLLMResult(o);await Promise.all((s??[]).map((m,P)=>m==null?void 0:m.handleLLMEnd(u[P])));const c=(s==null?void 0:s.map(m=>m.runId))||void 0;return Object.defineProperty(o,Ca,{value:c?{runIds:c}:void 0,configurable:!0}),o}async generate(e,t,r){if(!Array.isArray(e))throw new Error("Argument 'prompts' is expected to be a string[]");let a;Array.isArray(t)?a={stop:t}:t!=null&&t.timeout&&!t.signal?a={...t,signal:AbortSignal.timeout(t.timeout)}:a=t??{};const i={tags:a.tags,metadata:a.metadata,callbacks:a.callbacks??r};if(delete a.tags,delete a.metadata,delete a.callbacks,!this.cache)return this._generateUncached(e,a,i);const{cache:s}=this,o=this.serialize();o.stop=a.stop??o.stop;const u=`${Object.entries(o).sort()}`,c=[],m=await Promise.all(e.map(async(j,z)=>{const O=await s.lookup(j,u);return O||c.push(z),O}));let P={};if(c.length>0){const j=await this._generateUncached(c.map(z=>e[z]),a,i);await Promise.all(j.generations.map(async(z,O)=>{const N=c[O];return m[N]=z,s.update(e[N],u,z)})),P=j.llmOutput??{}}return{generations:m,llmOutput:P}}async call(e,t,r){const{generations:a}=await this.generate([e],t??{},r);return a[0][0].text}async predict(e,t,r){return this.call(e,t,r)}async predictMessages(e,t,r){const a=fn(e),i=await this.call(a,t,r);return new Ma(i)}_identifyingParams(){return{}}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}_modelType(){return"base_llm"}static async deserialize(e){const{_type:t,_model:r,...a}=e;if(r&&r!=="base_llm")throw new Error(`Cannot load LLM with model ${r}`);const i={openai:(await Se(()=>Promise.resolve().then(()=>il),void 0,import.meta.url)).OpenAI}[t];if(i===void 0)throw new Error(`Cannot load  LLM with type ${t}`);return new i(a)}}class Yi extends Hi{async _generate(e,t,r){return{generations:await Promise.all(e.map((i,s)=>this._call(i,{...t,promptIndex:s},r).then(o=>[{text:o}])))}}}class jn extends Yi{get lc_secrets(){return{apiKey:"HUGGINGFACEHUB_API_KEY"}}constructor(e){if(super(e??{}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"gpt2"}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topK",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.model=(e==null?void 0:e.model)??this.model,this.temperature=(e==null?void 0:e.temperature)??this.temperature,this.maxTokens=(e==null?void 0:e.maxTokens)??this.maxTokens,this.topP=(e==null?void 0:e.topP)??this.topP,this.topK=(e==null?void 0:e.topK)??this.topK,this.frequencyPenalty=(e==null?void 0:e.frequencyPenalty)??this.frequencyPenalty,this.apiKey=(e==null?void 0:e.apiKey)??pe("HUGGINGFACEHUB_API_KEY"),!this.apiKey)throw new Error("Please set an API key for HuggingFace Hub in the environment variable HUGGINGFACEHUB_API_KEY or in the apiKey field of the HuggingFaceInference constructor.")}_llmType(){return"hf"}async _call(e,t){const{HfInference:r}=await jn.imports(),a=new r(this.apiKey);return(await this.caller.callWithOptions({signal:t.signal},a.textGeneration.bind(a),{model:this.model,parameters:{return_full_text:!1,temperature:this.temperature,max_new_tokens:this.maxTokens,top_p:this.topP,top_k:this.topK,repetition_penalty:this.frequencyPenalty},inputs:e})).generated_text}static async imports(){try{const{HfInference:e}=await Se(()=>import("./hf.dac6bdab.js").then(t=>t.i),["./hf.dac6bdab.js","./NavBar.f58cf5a8.js","./public.9062b0fe.js","./scheduler.2364b0ad.js","./index.9f7452a2.js","../assets/NavBar.ffbd0f32.css"],import.meta.url);return{HfInference:e}}catch{throw new Error("Please install huggingface as a dependency with, e.g. `yarn add @huggingface/inference`")}}}class Sn extends Yi{get callKeys(){return[...super.callKeys,"options","promptIndex"]}get lc_secrets(){return{openAIApiKey:"OPENAI_API_KEY",azureOpenAIApiKey:"AZURE_OPENAI_API_KEY"}}get lc_aliases(){return{modelName:"model",openAIApiKey:"openai_api_key",azureOpenAIApiVersion:"azure_openai_api_version",azureOpenAIApiKey:"azure_openai_api_key",azureOpenAIApiInstanceName:"azure_openai_api_instance_name",azureOpenAIApiDeploymentName:"azure_openai_api_deployment_name"}}constructor(e,t){if(super(e??{}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"presencePenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"n",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"logitBias",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"prefixMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"openAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIBasePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.openAIApiKey=(e==null?void 0:e.openAIApiKey)??pe("OPENAI_API_KEY"),this.azureOpenAIApiKey=(e==null?void 0:e.azureOpenAIApiKey)??pe("AZURE_OPENAI_API_KEY"),!this.azureOpenAIApiKey&&!this.openAIApiKey)throw new Error("OpenAI or Azure OpenAI API key not found");if(this.azureOpenAIApiInstanceName=(e==null?void 0:e.azureOpenAIApiInstanceName)??pe("AZURE_OPENAI_API_INSTANCE_NAME"),this.azureOpenAIApiDeploymentName=((e==null?void 0:e.azureOpenAIApiCompletionsDeploymentName)||(e==null?void 0:e.azureOpenAIApiDeploymentName))??(pe("AZURE_OPENAI_API_COMPLETIONS_DEPLOYMENT_NAME")||pe("AZURE_OPENAI_API_DEPLOYMENT_NAME")),this.azureOpenAIApiVersion=(e==null?void 0:e.azureOpenAIApiVersion)??pe("AZURE_OPENAI_API_VERSION"),this.azureOpenAIBasePath=(e==null?void 0:e.azureOpenAIBasePath)??pe("AZURE_OPENAI_BASE_PATH"),this.modelName=(e==null?void 0:e.modelName)??this.modelName,this.prefixMessages=(e==null?void 0:e.prefixMessages)??this.prefixMessages,this.modelKwargs=(e==null?void 0:e.modelKwargs)??{},this.timeout=e==null?void 0:e.timeout,this.temperature=(e==null?void 0:e.temperature)??this.temperature,this.topP=(e==null?void 0:e.topP)??this.topP,this.frequencyPenalty=(e==null?void 0:e.frequencyPenalty)??this.frequencyPenalty,this.presencePenalty=(e==null?void 0:e.presencePenalty)??this.presencePenalty,this.n=(e==null?void 0:e.n)??this.n,this.logitBias=e==null?void 0:e.logitBias,this.maxTokens=e==null?void 0:e.maxTokens,this.stop=e==null?void 0:e.stop,this.streaming=(e==null?void 0:e.streaming)??!1,this.n>1)throw new Error("Cannot use n > 1 in OpenAIChat LLM. Use ChatOpenAI Chat Model instead.");if(this.azureOpenAIApiKey){if(!this.azureOpenAIApiInstanceName)throw new Error("Azure OpenAI API instance name not found");if(!this.azureOpenAIApiDeploymentName)throw new Error("Azure OpenAI API deployment name not found");if(!this.azureOpenAIApiVersion)throw new Error("Azure OpenAI API version not found")}this.clientConfig={apiKey:this.openAIApiKey,...t,...e==null?void 0:e.configuration}}invocationParams(e){return{model:this.modelName,temperature:this.temperature,top_p:this.topP,frequency_penalty:this.frequencyPenalty,presence_penalty:this.presencePenalty,n:this.n,logit_bias:this.logitBias,max_tokens:this.maxTokens===-1?void 0:this.maxTokens,stop:(e==null?void 0:e.stop)??this.stop,stream:this.streaming,...this.modelKwargs}}_identifyingParams(){return{model_name:this.modelName,...this.invocationParams(),...this.clientConfig}}identifyingParams(){return{model_name:this.modelName,...this.invocationParams(),...this.clientConfig}}formatMessages(e){const t={role:"user",content:e};return this.prefixMessages?[...this.prefixMessages,t]:[t]}async _call(e,t,r){var s;const a=this.invocationParams(t);return((s=(a.stream?await new Promise((o,u)=>{let c,m=!1,P=!1;this.completionWithRetry({...a,messages:this.formatMessages(e)},{signal:t.signal,...t.options,adapter:Pr,responseType:"stream",onmessage:j=>{var z,O,N,b,x,I;if(((O=(z=j.data)==null?void 0:z.trim)==null?void 0:O.call(z))==="[DONE]"){if(P||m)return;P=!0,o(c)}else{const E=JSON.parse(j.data);if(E!=null&&E.error){if(m)return;m=!0,u(E.error);return}const A=E;c||(c={id:A.id,object:A.object,created:A.created,model:A.model,choices:[]});for(const B of A.choices)if(B!=null){let g=c.choices.find(w=>w.index===B.index);g||(g={index:B.index,finish_reason:B.finish_reason??void 0},c.choices.push(g)),g.message||(g.message={role:(N=B.delta)==null?void 0:N.role,content:((b=B.delta)==null?void 0:b.content)??""}),g.message.content+=((x=B.delta)==null?void 0:x.content)??"",r==null||r.handleLLMNewToken(((I=B.delta)==null?void 0:I.content)??"",{prompt:t.promptIndex??0,completion:B.index})}!P&&!m&&A.choices.every(B=>B.finish_reason!=null)&&(P=!0,o(c))}}}).catch(j=>{m||(m=!0,u(j))})}):await this.completionWithRetry({...a,messages:this.formatMessages(e)},{signal:t.signal,...t.options})).choices[0].message)==null?void 0:s.content)??""}async completionWithRetry(e,t){if(!this.client){const a={azureOpenAIApiDeploymentName:this.azureOpenAIApiDeploymentName,azureOpenAIApiInstanceName:this.azureOpenAIApiInstanceName,azureOpenAIApiKey:this.azureOpenAIApiKey,azureOpenAIBasePath:this.azureOpenAIBasePath,basePath:this.clientConfig.basePath},i=La(a),s=new Ar.Configuration({...this.clientConfig,basePath:i,baseOptions:{timeout:this.timeout,...this.clientConfig.baseOptions}});this.client=new Ar.OpenAIApi(s)}const r={adapter:Ra()?void 0:Pr,...this.clientConfig.baseOptions,...t};return this.azureOpenAIApiKey&&(r.headers={"api-key":this.azureOpenAIApiKey,...r.headers},r.params={"api-version":this.azureOpenAIApiVersion,...r.params}),this.caller.call(this.client.createChatCompletion.bind(this.client),e,r).then(a=>a.data)}_llmType(){return"openai"}}class nl extends Sn{get lc_secrets(){return{promptLayerApiKey:"PROMPTLAYER_API_KEY"}}constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"promptLayerApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"plTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnPromptLayerId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.plTags=(e==null?void 0:e.plTags)??[],this.returnPromptLayerId=(e==null?void 0:e.returnPromptLayerId)??!1,this.promptLayerApiKey=(e==null?void 0:e.promptLayerApiKey)??pe("PROMPTLAYER_API_KEY"),!this.promptLayerApiKey)throw new Error("Missing PromptLayer API key")}async completionWithRetry(e,t){return e.stream?super.completionWithRetry(e,t):await super.completionWithRetry(e)}async _generate(e,t,r){let a;return{generations:await Promise.all(e.map(async s=>{const o=Date.now(),u=await this._call(s,t,r),c=Date.now();a=[{text:u}];const m={text:u},P=await Fi(this.caller,"langchain.PromptLayerOpenAIChat",[s],this._identifyingParams(),this.plTags,m,o,c,this.promptLayerApiKey);return this.returnPromptLayerId===!0&&P.success===!0&&(a[0].generationInfo={promptLayerRequestId:P.request_id}),a}))}}}class Cn extends Hi{get callKeys(){return[...super.callKeys,"options"]}get lc_secrets(){return{openAIApiKey:"OPENAI_API_KEY",azureOpenAIApiKey:"AZURE_OPENAI_API_KEY"}}get lc_aliases(){return{modelName:"model",openAIApiKey:"openai_api_key",azureOpenAIApiVersion:"azure_openai_api_version",azureOpenAIApiKey:"azure_openai_api_key",azureOpenAIApiInstanceName:"azure_openai_api_instance_name",azureOpenAIApiDeploymentName:"azure_openai_api_deployment_name"}}constructor(e,t){var r,a,i;if((r=e==null?void 0:e.modelName)!=null&&r.startsWith("gpt-3.5-turbo")||(a=e==null?void 0:e.modelName)!=null&&a.startsWith("gpt-4")||(i=e==null?void 0:e.modelName)!=null&&i.startsWith("gpt-4-32k"))return new Sn(e,t);if(super(e??{}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:.7}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:256}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"presencePenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"n",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"bestOf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"logitBias",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"text-davinci-003"}),Object.defineProperty(this,"modelKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"batchSize",{enumerable:!0,configurable:!0,writable:!0,value:20}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"openAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIBasePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.openAIApiKey=(e==null?void 0:e.openAIApiKey)??pe("OPENAI_API_KEY"),this.azureOpenAIApiKey=(e==null?void 0:e.azureOpenAIApiKey)??pe("AZURE_OPENAI_API_KEY"),!this.azureOpenAIApiKey&&!this.openAIApiKey)throw new Error("OpenAI or Azure OpenAI API key not found");if(this.azureOpenAIApiInstanceName=(e==null?void 0:e.azureOpenAIApiInstanceName)??pe("AZURE_OPENAI_API_INSTANCE_NAME"),this.azureOpenAIApiDeploymentName=((e==null?void 0:e.azureOpenAIApiCompletionsDeploymentName)||(e==null?void 0:e.azureOpenAIApiDeploymentName))??(pe("AZURE_OPENAI_API_COMPLETIONS_DEPLOYMENT_NAME")||pe("AZURE_OPENAI_API_DEPLOYMENT_NAME")),this.azureOpenAIApiVersion=(e==null?void 0:e.azureOpenAIApiVersion)??pe("AZURE_OPENAI_API_VERSION"),this.azureOpenAIBasePath=(e==null?void 0:e.azureOpenAIBasePath)??pe("AZURE_OPENAI_BASE_PATH"),this.modelName=(e==null?void 0:e.modelName)??this.modelName,this.modelKwargs=(e==null?void 0:e.modelKwargs)??{},this.batchSize=(e==null?void 0:e.batchSize)??this.batchSize,this.timeout=e==null?void 0:e.timeout,this.temperature=(e==null?void 0:e.temperature)??this.temperature,this.maxTokens=(e==null?void 0:e.maxTokens)??this.maxTokens,this.topP=(e==null?void 0:e.topP)??this.topP,this.frequencyPenalty=(e==null?void 0:e.frequencyPenalty)??this.frequencyPenalty,this.presencePenalty=(e==null?void 0:e.presencePenalty)??this.presencePenalty,this.n=(e==null?void 0:e.n)??this.n,this.bestOf=(e==null?void 0:e.bestOf)??this.bestOf,this.logitBias=e==null?void 0:e.logitBias,this.stop=e==null?void 0:e.stop,this.streaming=(e==null?void 0:e.streaming)??!1,this.streaming&&this.bestOf&&this.bestOf>1)throw new Error("Cannot stream results when bestOf > 1");if(this.azureOpenAIApiKey){if(!this.azureOpenAIApiInstanceName)throw new Error("Azure OpenAI API instance name not found");if(!this.azureOpenAIApiDeploymentName)throw new Error("Azure OpenAI API deployment name not found");if(!this.azureOpenAIApiVersion)throw new Error("Azure OpenAI API version not found")}this.clientConfig={apiKey:this.openAIApiKey,...t,...e==null?void 0:e.configuration}}invocationParams(e){return{model:this.modelName,temperature:this.temperature,max_tokens:this.maxTokens,top_p:this.topP,frequency_penalty:this.frequencyPenalty,presence_penalty:this.presencePenalty,n:this.n,best_of:this.bestOf,logit_bias:this.logitBias,stop:(e==null?void 0:e.stop)??this.stop,stream:this.streaming,...this.modelKwargs}}_identifyingParams(){return{model_name:this.modelName,...this.invocationParams(),...this.clientConfig}}identifyingParams(){return this._identifyingParams()}async _generate(e,t,r){const a=Un(e,this.batchSize),i=[],s={},o=this.invocationParams(t);if(o.max_tokens===-1){if(e.length!==1)throw new Error("max_tokens set to -1 not supported for multiple inputs");o.max_tokens=await Hs({prompt:e[0],modelName:this.modelName})}for(let c=0;c<a.length;c+=1){const m=o.stream?await new Promise((O,N)=>{const b=[];let x,I=!1,E=!1;this.completionWithRetry({...o,prompt:a[c]},{signal:t.signal,...t.options,adapter:Pr,responseType:"stream",onmessage:A=>{var B,g;if(((g=(B=A.data)==null?void 0:B.trim)==null?void 0:g.call(B))==="[DONE]"){if(E||I)return;E=!0,O({...x,choices:b})}else{const w=JSON.parse(A.data);if(w!=null&&w.error){if(I)return;I=!0,N(w.error);return}const h=w;x||(x={id:h.id,object:h.object,created:h.created,model:h.model});for(const f of h.choices)if(f!=null&&f.index!=null){b[f.index]||(b[f.index]={});const d=b[f.index];d.text=(d.text??"")+(f.text??""),d.finish_reason=f.finish_reason,d.logprobs=f.logprobs,r==null||r.handleLLMNewToken(f.text??"",{prompt:Math.floor(f.index/this.n),completion:f.index%this.n})}!E&&!I&&b.every(f=>f.finish_reason!=null)&&(E=!0,O({...x,choices:b}))}}}).catch(A=>{I||(I=!0,N(A))})}):await this.completionWithRetry({...o,prompt:a[c]},{signal:t.signal,...t.options});i.push(...m.choices);const{completion_tokens:P,prompt_tokens:j,total_tokens:z}=m.usage??{};P&&(s.completionTokens=(s.completionTokens??0)+P),j&&(s.promptTokens=(s.promptTokens??0)+j),z&&(s.totalTokens=(s.totalTokens??0)+z)}return{generations:Un(i,this.n).map(c=>c.map(m=>({text:m.text??"",generationInfo:{finishReason:m.finish_reason,logprobs:m.logprobs}}))),llmOutput:{tokenUsage:s}}}async completionWithRetry(e,t){if(!this.client){const a={azureOpenAIApiDeploymentName:this.azureOpenAIApiDeploymentName,azureOpenAIApiInstanceName:this.azureOpenAIApiInstanceName,azureOpenAIApiKey:this.azureOpenAIApiKey,azureOpenAIBasePath:this.azureOpenAIBasePath,basePath:this.clientConfig.basePath},i=La(a),s=new Ar.Configuration({...this.clientConfig,basePath:i,baseOptions:{timeout:this.timeout,...this.clientConfig.baseOptions}});this.client=new Ar.OpenAIApi(s)}const r={adapter:Ra()?void 0:Pr,...this.clientConfig.baseOptions,...t};return this.azureOpenAIApiKey&&(r.headers={"api-key":this.azureOpenAIApiKey,...r.headers},r.params={"api-version":this.azureOpenAIApiVersion,...r.params}),this.caller.call(this.client.createCompletion.bind(this.client),e,r).then(a=>a.data)}_llmType(){return"openai"}}class al extends Cn{get lc_secrets(){return{promptLayerApiKey:"PROMPTLAYER_API_KEY"}}constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"promptLayerApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"plTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnPromptLayerId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.plTags=(e==null?void 0:e.plTags)??[],this.promptLayerApiKey=(e==null?void 0:e.promptLayerApiKey)??pe("PROMPTLAYER_API_KEY"),this.returnPromptLayerId=e==null?void 0:e.returnPromptLayerId,!this.promptLayerApiKey)throw new Error("Missing PromptLayer API key")}async completionWithRetry(e,t){return e.stream?super.completionWithRetry(e,t):await super.completionWithRetry(e)}async _generate(e,t,r){const a=Date.now(),i=await super._generate(e,t,r);for(let s=0;s<i.generations.length;s+=1){const o=Date.now(),u={text:i.generations[s][0].text,llm_output:i.llmOutput},c=await Fi(this.caller,"langchain.PromptLayerOpenAI",[e[s]],this._identifyingParams(),this.plTags,u,a,o,this.promptLayerApiKey);let m;this.returnPromptLayerId===!0&&(c&&c.success===!0&&(m=c.request_id),i.generations[s][0].generationInfo={...i.generations[s][0].generationInfo,promptLayerRequestId:m})}return i}}const il=Object.freeze(Object.defineProperty({__proto__:null,OpenAI:Cn,OpenAIChat:Sn,PromptLayerOpenAI:al,PromptLayerOpenAIChat:nl},Symbol.toStringTag,{value:"Module"}));async function _a(n,e,t,r,a){if(a==null||a==="")return"Please enter a question";{new jn({apiKey:n,model:"tiiuae/falcon-7b-instruct",maxTokens:5e3});const i=br(vr,_r),s=en;let o=new Qr({openAIApiKey:s});const u=new Cn({temperature:1,openAIApiKey:s,maxTokens:1e3});await i.auth.getUser(),new Xr(o,{client:i,tableName:"documents"});const c="Answer this question, always give it a go do not say you don't know: {question}",m=bn.fromLLM(u,e.asRetriever(),{returnSourceDocuments:!0,questionGeneratorChainOptions:{template:c}});let P={search_distance:.9};const j=await m.call({question:a,chat_history:[],vector_db_kwargs:P});return console.log("result",j),console.log(j.text),j.text}}const{console:sl}=fs,ie="src/routes/ask/+page.svelte";function va(n,e,t){const r=n.slice();return r[34]=e[t],r}function wa(n,e,t){const r=n.slice();return r[37]=e[t],r}function an(n){let e,t,r,a,i,s="Select Model",o,u,c,m="tiiuae/falcon-7b-instruct",P,j="meta-llama/Llama-2-70b-chat-hf",z,O="OpenAssistant/oasst-sft-4-pythia-12b-epoch-3.5",N,b,x,I="Temperature",E,A,B,g,w,h,f,d="Chat History",_,v,$,F,q,R,G,de=Or(n[8]),k=[];for(let Z=0;Z<de.length;Z+=1)k[Z]=sn(wa(n,de,Z));const L={c:function(){e=ne("div"),t=ne("div"),r=ne("div"),a=ne("div"),i=ne("label"),i.textContent=s,o=we(),u=ne("select"),c=ne("option"),c.textContent=m,P=ne("option"),P.textContent=j,z=ne("option"),z.textContent=O,N=we(),b=ne("div"),x=ne("label"),x.textContent=I,E=we(),A=ne("input"),B=we(),g=ne("span"),w=wt(n[1]),h=we(),f=ne("h2"),f.textContent=d,_=we(),v=ne("button"),$=ne("i"),F=wt(" New Chat"),q=we();for(let se=0;se<k.length;se+=1)k[se].c();this.h()},l:function(se){e=ae(se,"DIV",{class:!0});var me=he(e);t=ae(me,"DIV",{class:!0});var T=he(t);r=ae(T,"DIV",{class:!0});var oe=he(r);a=ae(oe,"DIV",{class:!0});var le=he(a);i=ae(le,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),We(i)!=="svelte-1n8492e"&&(i.textContent=s),o=Oe(le),u=ae(le,"SELECT",{id:!0,style:!0,class:!0});var be=he(u);c=ae(be,"OPTION",{"data-svelte-h":!0}),We(c)!=="svelte-15kfk1a"&&(c.textContent=m),P=ae(be,"OPTION",{"data-svelte-h":!0}),We(P)!=="svelte-14tx9eu"&&(P.textContent=j),z=ae(be,"OPTION",{"data-svelte-h":!0}),We(z)!=="svelte-ppycc4"&&(z.textContent=O),be.forEach(te),le.forEach(te),N=Oe(oe),b=ae(oe,"DIV",{class:!0});var M=he(b);x=ae(M,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),We(x)!=="svelte-1cqo6os"&&(x.textContent=I),E=Oe(M),A=ae(M,"INPUT",{type:!0,id:!0,min:!0,max:!0,step:!0,class:!0}),B=Oe(M),g=ae(M,"SPAN",{class:!0});var l=he(g);w=Ot(l,n[1]),l.forEach(te),M.forEach(te),oe.forEach(te),h=Oe(T),f=ae(T,"H2",{class:!0,"data-svelte-h":!0}),We(f)!=="svelte-141gz04"&&(f.textContent=d),_=Oe(T),v=ae(T,"BUTTON",{class:!0});var p=he(v);$=ae(p,"I",{class:!0}),he($).forEach(te),F=Ot(p," New Chat"),p.forEach(te),q=Oe(T);for(let y=0;y<k.length;y+=1)k[y].l(T);T.forEach(te),me.forEach(te),this.h()},h:function(){Q(i,"class","block text-lg font-semibold"),Q(i,"for","model"),re(i,ie,358,16,6197),c.__value="tiiuae/falcon-7b-instruct",dt(c,c.__value),re(c,ie,367,18,6533),P.__value="meta-llama/Llama-2-70b-chat-hf",dt(P,P.__value),re(P,ie,370,18,6668),z.__value="OpenAssistant/oasst-sft-4-pythia-12b-epoch-3.5",dt(z,z.__value),re(z,ie,373,18,6813),Q(u,"id","model"),Ta(u,"width","200px"),Q(u,"class","select select-sm select-primary"),n[0]===void 0&&as(()=>n[16].call(u)),re(u,ie,361,16,6325),Q(a,"class","mb-4"),re(a,ie,357,14,6162),Q(x,"class","block text-lg font-semibold"),Q(x,"for","temperature"),re(x,ie,379,16,7068),Q(A,"type","range"),Q(A,"id","temperature"),Q(A,"min","0.1"),Q(A,"max","1.0"),Q(A,"step","0.2"),Q(A,"class","input input-sm input-primary"),re(A,ie,382,16,7201),Q(g,"class","text-sm ml-2"),re(g,ie,391,16,7492),Q(b,"class","mb-4"),re(b,ie,378,14,7033),Q(r,"class","w-full md:w-3/4 mt-14"),re(r,ie,356,12,6112),Q(f,"class","text-2xl font-bold mb-4"),re(f,ie,395,12,7593),Q($,"class","fas fa-plus"),re($,ie,401,14,7839),Q(v,"class","btn btn-primary btn-sm mb-2"),re(v,ie,397,12,7714),Q(t,"class","overflow-y-auto max-h-96"),re(t,ie,355,10,6061),Q(e,"class","absolute left-0 top-0 bg-gray-800 rounded-lg p-4 sidebar s-uhtJAkW7ZDek"),re(e,ie,354,8,5980)},m:function(se,me){Ne(se,e,me),Y(e,t),Y(t,r),Y(r,a),Y(a,i),Y(a,o),Y(a,u),Y(u,c),Y(u,P),Y(u,z),Bn(u,n[0],!0),Y(r,N),Y(r,b),Y(b,x),Y(b,E),Y(b,A),dt(A,n[1]),Y(b,B),Y(b,g),Y(g,w),Y(t,h),Y(t,f),Y(t,_),Y(t,v),Y(v,$),Y(v,F),Y(t,q);for(let T=0;T<k.length;T+=1)k[T]&&k[T].m(t,null);R||(G=[Qe(u,"change",n[16]),Qe(A,"change",n[17]),Qe(A,"input",n[17]),Qe(v,"click",n[11],!1,!1,!1,!1)],R=!0)},p:function(se,me){if(me[0]&1&&Bn(u,se[0]),me[0]&2&&dt(A,se[1]),me[0]&2&&Tr(w,se[1]),me[0]&24832){de=Or(se[8]);let T;for(T=0;T<de.length;T+=1){const oe=wa(se,de,T);k[T]?k[T].p(oe,me):(k[T]=sn(oe),k[T].c(),k[T].m(t,null))}for(;T<k.length;T+=1)k[T].d(1);k.length=de.length}},d:function(se){se&&te(e),ja(k,se),R=!1,ln(G)}};return Le("SvelteRegisterBlock",{block:L,id:an.name,type:"if",source:"(182:6) {#if isChatHistorySidebarOpen}",ctx:n}),L}function Wi(n){let e,t="New Chat";const r={c:function(){e=ne("span"),e.textContent=t,this.h()},l:function(i){e=ae(i,"SPAN",{"data-svelte-h":!0}),We(e)!=="svelte-t9s83e"&&(e.textContent=t),this.h()},h:function(){re(e,ie,413,18,8382)},m:function(i,s){Ne(i,e,s)},p:Oa,d:function(i){i&&te(e)}};return Le("SvelteRegisterBlock",{block:r,id:Wi.name,type:"else",source:"(241:16) {:else}",ctx:n}),r}function Gi(n){let e,t=n[37].firstUserMessage+"",r;const a={c:function(){e=ne("span"),r=wt(t),this.h()},l:function(s){e=ae(s,"SPAN",{});var o=he(e);r=Ot(o,t),o.forEach(te),this.h()},h:function(){re(e,ie,411,18,8303)},m:function(s,o){Ne(s,e,o),Y(e,r)},p:function(s,o){o[0]&256&&t!==(t=s[37].firstUserMessage+"")&&Tr(r,t)},d:function(s){s&&te(e)}};return Le("SvelteRegisterBlock",{block:a,id:Gi.name,type:"if",source:'(239:16) {#if chat.firstUserMessage !== \\"\\" && chat.firstUserMessage !== null && chat.firstUserMessage !== undefined}',ctx:n}),a}function sn(n){let e,t,r,a,i,s,o;function u(O,N){return O[37].firstUserMessage!==""&&O[37].firstUserMessage!==null&&O[37].firstUserMessage!==void 0?Gi:Wi}let c=u(n),m=c(n);function P(){return n[18](n[37])}function j(){return n[19](n[37])}const z={c:function(){e=ne("div"),m.c(),t=we(),r=ne("button"),a=ne("i"),i=we(),this.h()},l:function(N){e=ae(N,"DIV",{class:!0});var b=he(e);m.l(b),t=Oe(b),r=ae(b,"BUTTON",{class:!0});var x=he(r);a=ae(x,"I",{class:!0}),he(a).forEach(te),x.forEach(te),i=Oe(b),b.forEach(te),this.h()},h:function(){Q(a,"class","fas fa-trash-alt"),re(a,ie,420,18,8650),Q(r,"class","btn btn-error btn-sm"),re(r,ie,416,16,8499),Q(e,"class","flex items-center justify-between mb-2 s-uhtJAkW7ZDek"),re(e,ie,406,14,8006)},m:function(N,b){Ne(N,e,b),m.m(e,null),Y(e,t),Y(e,r),Y(r,a),Y(e,i),s||(o=[Qe(r,"click",P,!1,!1,!1,!1),Qe(e,"click",j,!1,!1,!1,!1)],s=!0)},p:function(N,b){n=N,c===(c=u(n))&&m?m.p(n,b):(m.d(1),m=c(n),m&&(m.c(),m.m(e,t)))},d:function(N){N&&te(e),m.d(),s=!1,ln(o)}};return Le("SvelteRegisterBlock",{block:z,id:sn.name,type:"each",source:"(234:12) {#each $userChats as chat}",ctx:n}),z}function Ji(n){let e;const t={c:function(){e=ne("i"),this.h()},l:function(a){e=ae(a,"I",{class:!0}),he(e).forEach(te),this.h()},h:function(){Q(e,"class","chevron fas fa-chevron-right text-2xl s-uhtJAkW7ZDek"),re(e,ie,436,10,9042)},m:function(a,i){Ne(a,e,i)},d:function(a){a&&te(e)}};return Le("SvelteRegisterBlock",{block:t,id:Ji.name,type:"else",source:"(264:8) {:else}",ctx:n}),t}function Qi(n){let e;const t={c:function(){e=ne("i"),this.h()},l:function(a){e=ae(a,"I",{class:!0}),he(e).forEach(te),this.h()},h:function(){Q(e,"class","chevron fas fa-chevron-left text-2xl s-uhtJAkW7ZDek"),re(e,ie,434,10,8965)},m:function(a,i){Ne(a,e,i)},d:function(a){a&&te(e)}};return Le("SvelteRegisterBlock",{block:t,id:Qi.name,type:"if",source:"(262:8) {#if isChatHistorySidebarOpen}",ctx:n}),t}function Xi(n){let e,t=Or(n[7]),r=[];for(let i=0;i<t.length;i+=1)r[i]=on(va(n,t,i));const a={c:function(){e=ne("div");for(let s=0;s<r.length;s+=1)r[s].c();this.h()},l:function(s){e=ae(s,"DIV",{class:!0});var o=he(e);for(let u=0;u<r.length;u+=1)r[u].l(o);o.forEach(te),this.h()},h:function(){Q(e,"class","chat-container overflow-y-auto h-96 s-uhtJAkW7ZDek"),re(e,ie,451,12,9560)},m:function(s,o){Ne(s,e,o);for(let u=0;u<r.length;u+=1)r[u]&&r[u].m(e,null)},p:function(s,o){if(o[0]&128){t=Or(s[7]);let u;for(u=0;u<t.length;u+=1){const c=va(s,t,u);r[u]?r[u].p(c,o):(r[u]=on(c),r[u].c(),r[u].m(e,null))}for(;u<r.length;u+=1)r[u].d(1);r.length=t.length}},d:function(s){s&&te(e),ja(r,s)}};return Le("SvelteRegisterBlock",{block:a,id:Xi.name,type:"else",source:"(279:10) {:else}",ctx:n}),a}function es(n){let e,t="Select a chat from the history to view messages.";const r={c:function(){e=ne("p"),e.textContent=t,this.h()},l:function(i){e=ae(i,"P",{class:!0,"data-svelte-h":!0}),We(e)!=="svelte-ulna32"&&(e.textContent=t),this.h()},h:function(){Q(e,"class","text-gray-500"),re(e,ie,447,12,9424)},m:function(i,s){Ne(i,e,s)},p:Oa,d:function(i){i&&te(e)}};return Le("SvelteRegisterBlock",{block:r,id:es.name,type:"if",source:"(275:10) {#if selectedChatId === null}",ctx:n}),r}function on(n){let e,t=n[34].message+"",r,a;const i={c:function(){e=ne("div"),r=wt(t),a=we(),this.h()},l:function(o){e=ae(o,"DIV",{class:!0});var u=he(e);r=Ot(u,t),a=Oe(u),u.forEach(te),this.h()},h:function(){Q(e,"class","chat-message s-uhtJAkW7ZDek"),Zn(e,"is-user-message",n[34].is_user_message),re(e,ie,453,16,9681)},m:function(o,u){Ne(o,e,u),Y(e,r),Y(e,a)},p:function(o,u){u[0]&128&&t!==(t=o[34].message+"")&&Tr(r,t),u[0]&128&&Zn(e,"is-user-message",o[34].is_user_message)},d:function(o){o&&te(e)}};return Le("SvelteRegisterBlock",{block:i,id:on.name,type:"each",source:"(281:14) {#each $selectedChatMessages as message}",ctx:n}),i}function un(n){let e,t;const r={c:function(){e=ne("div"),t=wt(n[4]),this.h()},l:function(i){e=ae(i,"DIV",{class:!0});var s=he(e);t=Ot(s,n[4]),s.forEach(te),this.h()},h:function(){Q(e,"class","absolute top-4 left-4 right-4 bg-red-600 text-white p-2 rounded"),re(e,ie,487,6,10669)},m:function(i,s){Ne(i,e,s),Y(e,t)},p:function(i,s){s[0]&16&&Tr(t,i[4])},d:function(i){i&&te(e)}};return Le("SvelteRegisterBlock",{block:r,id:un.name,type:"if",source:"(315:4) {#if errorText !== null}",ctx:n}),r}function ts(n){let e,t,r,a,i,s,o,u,c,m,P="Chat Messages",j,z,O,N,b,x,I,E,A,B,g,w,h,f;t=new Za({$$inline:!0});let d=n[6]&&an(n);function _(k,L){return k[6]?Qi:Ji}let v=_(n),$=v(n);function F(k,L){return k[5]===null?es:Xi}let q=F(n),R=q(n),G=n[4]!==null&&un(n);const de={c:function(){e=ne("div"),Pa(t.$$.fragment),r=we(),a=ne("div"),d&&d.c(),i=we(),s=ne("div"),$.c(),o=we(),u=ne("div"),c=ne("div"),m=ne("h1"),m.textContent=P,j=we(),R.c(),z=we(),O=ne("div"),N=ne("div"),b=ne("textarea"),I=we(),E=ne("button"),A=wt("Ask the AI and Send Message"),g=we(),G&&G.c(),this.h()},l:function(L){e=ae(L,"DIV",{class:!0});var Z=he(e);Aa(t.$$.fragment,Z),r=Oe(Z),a=ae(Z,"DIV",{class:!0});var se=he(a);d&&d.l(se),i=Oe(se),s=ae(se,"DIV",{class:!0,style:!0});var me=he(s);$.l(me),me.forEach(te),o=Oe(se),u=ae(se,"DIV",{class:!0});var T=he(u);c=ae(T,"DIV",{class:!0});var oe=he(c);m=ae(oe,"H1",{class:!0,"data-svelte-h":!0}),We(m)!=="svelte-fy4ok2"&&(m.textContent=P),j=Oe(oe),R.l(oe),oe.forEach(te),z=Oe(T),O=ae(T,"DIV",{class:!0});var le=he(O);N=ae(le,"DIV",{class:!0});var be=he(N);b=ae(be,"TEXTAREA",{id:!0,class:!0}),he(b).forEach(te),be.forEach(te),I=Oe(le),E=ae(le,"BUTTON",{class:!0});var M=he(E);A=Ot(M,"Ask the AI and Send Message"),M.forEach(te),le.forEach(te),T.forEach(te),se.forEach(te),g=Oe(Z),G&&G.l(Z),Z.forEach(te),this.h()},h:function(){Q(s,"class","sidebar-toggle-btn s-uhtJAkW7ZDek"),Ta(s,"left","1rem"),re(s,ie,428,6,8799),Q(m,"class","text-4xl font-bold mb-8"),re(m,ie,445,10,9317),Q(c,"class","w-full md:w-3/4"),re(c,ie,444,8,9277),Q(b,"id","question"),Q(b,"class","textarea textarea-primary"),b.disabled=x=n[5]===null||n[3],re(b,ie,467,12,10066),Q(N,"class","form-control mb-4"),re(N,ie,466,10,10022),Q(E,"class","btn btn-primary mb-4"),E.disabled=B=n[5]===null,re(E,ie,476,10,10367),Q(O,"class","w-full md:w-3/4 mt-4"),re(O,ie,465,8,9977),Q(u,"class","flex flex-col items-center justify-center w-full md:w-3/4 mx-auto s-uhtJAkW7ZDek"),re(u,ie,441,6,9174),Q(a,"class","relative flex flex-col md:flex-row min-h-screen s-uhtJAkW7ZDek"),re(a,ie,350,4,5807),Q(e,"class","flex flex-col bg-gray-900 text-white p-4 s-uhtJAkW7ZDek"),re(e,ie,348,2,5733)},m:function(L,Z){Ne(L,e,Z),xa(t,e,null),Y(e,r),Y(e,a),d&&d.m(a,null),Y(a,i),Y(a,s),$.m(s,null),Y(a,o),Y(a,u),Y(u,c),Y(c,m),Y(c,j),R.m(c,null),Y(u,z),Y(u,O),Y(O,N),Y(N,b),dt(b,n[2]),Y(O,I),Y(O,E),Y(E,A),Y(e,g),G&&G.m(e,null),w=!0,h||(f=[Qe(s,"click",n[20],!1,!1,!1,!1),Qe(b,"input",n[21]),Qe(E,"click",n[22],!1,!1,!1,!1)],h=!0)},p:function(L,Z){L[6]?d?d.p(L,Z):(d=an(L),d.c(),d.m(a,i)):d&&(d.d(1),d=null),v!==(v=_(L))&&($.d(1),$=v(L),$&&($.c(),$.m(s,null))),q===(q=F(L))&&R?R.p(L,Z):(R.d(1),R=q(L),R&&(R.c(),R.m(c,null))),(!w||Z[0]&40&&x!==(x=L[5]===null||L[3]))&&Rn(b,"disabled",x),Z[0]&4&&dt(b,L[2]),(!w||Z[0]&32&&B!==(B=L[5]===null))&&Rn(E,"disabled",B),L[4]!==null?G?G.p(L,Z):(G=un(L),G.c(),G.m(e,null)):G&&(G.d(1),G=null)},i:function(L){w||(Ea(t.$$.fragment,L),w=!0)},o:function(L){ka(t.$$.fragment,L),w=!1},d:function(L){L&&te(e),Ia(t),d&&d.d(),$.d(),R.d(),G&&G.d(),h=!1,ln(f)}};return Le("SvelteRegisterBlock",{block:de,id:ts.name,type:"slot",source:"(176:0) <AuthCheck>",ctx:n}),de}function cn(n){let e,t,r,a;r=new Ba({props:{$$slots:{default:[ts]},$$scope:{ctx:n}},$$inline:!0});const i={c:function(){e=ne("link"),t=we(),Pa(r.$$.fragment),this.h()},l:function(o){e=ae(o,"LINK",{rel:!0,href:!0}),t=Oe(o),Aa(r.$$.fragment,o),this.h()},h:function(){Q(e,"rel","stylesheet"),Q(e,"href","https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"),re(e,ie,343,0,5602)},m:function(o,u){Ne(o,e,u),Ne(o,t,u),xa(r,o,u),a=!0},p:function(o,u){const c={};u[0]&511|u[1]&512&&(c.$$scope={dirty:u,ctx:o}),r.$set(c)},i:function(o){a||(Ea(r.$$.fragment,o),a=!0)},o:function(o){ka(r.$$.fragment,o),a=!1},d:function(o){o&&(te(e),te(t)),Ia(r,o)}};return Le("SvelteRegisterBlock",{block:i,id:cn.name,type:"component",source:"",ctx:n}),i}function ol(n,e,t){let r,a,{$$slots:i={},$$scope:s}=e;os("Page",i,[]);const o=br(vr,_r);let u,c,m="tiiuae/falcon-7b-instruct",P=.2,j="",z=!1,O=null,N="";const b=Hr([]);Dn(b,"userChats"),Mn(n,b,T=>t(8,a=T));const x=Hr([]);Dn(x,"selectedChatMessages"),Mn(n,x,T=>t(7,r=T));let I=null;async function E(){if(z)return;if(await _(),I!==null){const{data:oe,error:le}=await o.from("chats").select("message").eq("chat_id",I);if(le){t(4,O=le.message),console.error("Error fetching chat messages:",le.message);return}}const T=Ge();b.update(oe=>[...oe,{chat_id:T}]),t(5,I=T),x.set([])}async function A(T){const{data:oe,error:le}=await o.from("chats").select("message").eq("chat_id",T).eq("is_user_message",!0).order("timestamp",{ascending:!0}).limit(1);return le?(t(4,O=le.message),""):oe.length>0?oe[0].message:""}async function B(){const T=await _(),{data:oe,error:le}=await o.from("chats").select("chat_id").eq("user_id",T);if(le)console.error("Error fetching user chats:",le.message),t(4,O=le.message);else{const be=new Set,M=[];for(const l of oe)if(!be.has(l.chat_id)){be.add(l.chat_id);const p=await A(l.chat_id);M.push({...l,firstUserMessage:p})}b.set(M)}}async function g(T){t(5,I=T);const{data:oe,error:le}=await o.from("chats").select("message, is_user_message, timestamp").eq("chat_id",T).order("timestamp",{ascending:!0});le?(console.error("Error fetching chat messages:",le.message),t(4,O=le.message)):x.set(oe)}async function w(T){await o.from("chats").insert([{user_id:T,chat_id:I,message:j,is_user_message:!0,timestamp:new Date().toISOString()}]),r.length===0&&B(),g(I)}async function h(){if(z)return;t(3,z=!0);const T=await _();await w(T),await d(T),t(3,z=!1)}async function f(T,oe){await o.from("chats").insert([{user_id:oe,chat_id:I,message:T,is_user_message:!1,timestamp:new Date().toISOString()}]),g(I)}async function d(T){const oe=br(vr,_r),le=en;c=new Qr({openAIApiKey:le}),u=new Xr(c,{client:oe,tableName:"documents"});let be=await _a(Vn,u,m,P,j);await f(be,T),t(2,j="")}async function _(){const T=await o.auth.getUser();return T?T.data.user.id:null}function v(T){g(T)}async function $(T){if(z)return;const oe=I===T,{data:le,error:be}=await o.from("chats").delete().eq("chat_id",T);if(be)console.error("Error deleting chat:",be.message),t(4,O=be.message);else{const M=await _(),{data:l}=await o.from("chats").select("chat_id").eq("user_id",M).order("timestamp",{ascending:!1}).limit(1),p=l.length>0?l[0].chat_id:null;await B(),oe&&t(5,I=p)}}Ln(async()=>{await B(),await E()});let F=!1;function q(){t(6,F=!F)}const R=[];Object.keys(e).forEach(T=>{!~R.indexOf(T)&&T.slice(0,2)!=="$$"&&T!=="slot"&&sl.warn(`<Page> was created with unknown prop '${T}'`)});function G(){m=us(this),t(0,m)}function de(){P=cs(this.value),t(1,P)}const k=T=>$(T.chat_id),L=T=>v(T.chat_id.slice(0,36)),Z=()=>q();function se(){j=this.value,t(2,j)}const me=()=>h();return n.$capture_state=()=>({chatWithDoc:_a,AuthCheck:Ba,NavBar:Za,onMount:Ln,onDestroy:ns,GoTrueAdminApi:gs,createClient:br,OpenAIEmbeddings:Qr,SupabaseVectorStore:Xr,writable:Hr,HuggingFaceInferenceEmbeddings:_s,PUBLIC_SUPABASE_KEY:_r,PUBLIC_SUPABASE_URL:vr,PUBLIC_HUGGINGFACE_API_KEY:Vn,PUBLIC_OPENAI_API_KEY:en,uuidv4:Ge,supabaseClient:o,vector:u,embeddings:c,model:m,temperature:P,question:j,loading:z,errorText:O,responseText:N,userChats:b,selectedChatMessages:x,selectedChatId:I,createNewChat:E,getFirstUserMessage:A,loadUserChats:B,loadChatMessages:g,sendMessage:w,sendUserMessageAndAIResponse:h,saveAIResponse:f,getAIResponse:d,getCurrentUserId:_,selectChat:v,deleteChat:$,isChatHistorySidebarOpen:F,toggleSidebar:q,$selectedChatMessages:r,$userChats:a}),n.$inject_state=T=>{"vector"in T&&(u=T.vector),"embeddings"in T&&(c=T.embeddings),"model"in T&&t(0,m=T.model),"temperature"in T&&t(1,P=T.temperature),"question"in T&&t(2,j=T.question),"loading"in T&&t(3,z=T.loading),"errorText"in T&&t(4,O=T.errorText),"responseText"in T&&(N=T.responseText),"selectedChatId"in T&&t(5,I=T.selectedChatId),"isChatHistorySidebarOpen"in T&&t(6,F=T.isChatHistorySidebarOpen)},e&&"$$inject"in e&&n.$inject_state(e.$$inject),[m,P,j,z,O,I,F,r,a,b,x,E,h,v,$,q,G,de,k,L,Z,se,me]}class ml extends is{constructor(e){super(e),ss(this,e,ol,cn,rs,{},null,[-1,-1]),Le("SvelteRegisterComponent",{component:this,tagName:"Page",options:e,id:cn.name})}}export{lr as B,at as C,De as L,Ae as P,Gs as a,qa as b,ao as c,ml as d,$a as g,Ko as l,Fi as p,Ya as r,nu as z};
