import{s as Pi,v as Xr,h as en,o as tn,i as Oi,d as ue,r as xr,j as Ai,n as Gn}from"./scheduler.2364b0ad.js";import{S as Ti,i as Ei,d as Me,v as ki,j as le,s as Ee,u as Jn,k as ce,c as ke,w as Qn,m as ae,a as Le,x as Xn,f as ea,t as ta,g as oe,y as ra,C as Ci,D as xi,E as Ut,o as it,l as be,A as qe,p as st,n as na,z as te,F as Xe,B as He,G as rn,H as nn,q as Kt,I as aa,J as an}from"./index.be5c2245.js";import{a as ot,_ as at,p as ji,b as _e,c as Si,d as ia,R as sa,B as oa,H as ua,e as la,f as Ni,h as Di,i as Vt,j as ca,k as Bt,l as da,m as sn,O as vr,S as wr,A as ha,N as pa,g as Li}from"./NavBar.dcd95840.js";import{g as fa,_ as Ne,e as Te,c as Zt,P as Mt,a as Rt,d as Ir,G as Zi,b as on}from"./public.41f5b175.js";import{g as Mi,T as Ri,c as jt}from"./_commonjs-dynamic-modules.6fed1697.js";import{w as ur}from"./index.db1f7a41.js";import{H as Ui}from"./hf.cc923392.js";let St;const Vi=new Uint8Array(16);function Bi(){if(!St&&(St=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!St))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return St(Vi)}const Ce=[];for(let n=0;n<256;++n)Ce.push((n+256).toString(16).slice(1));function Ki(n,e=0){return(Ce[n[e+0]]+Ce[n[e+1]]+Ce[n[e+2]]+Ce[n[e+3]]+"-"+Ce[n[e+4]]+Ce[n[e+5]]+"-"+Ce[n[e+6]]+Ce[n[e+7]]+"-"+Ce[n[e+8]]+Ce[n[e+9]]+"-"+Ce[n[e+10]]+Ce[n[e+11]]+Ce[n[e+12]]+Ce[n[e+13]]+Ce[n[e+14]]+Ce[n[e+15]]).toLowerCase()}const zi=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),un={randomUUID:zi};function Fe(n,e,r){if(un.randomUUID&&!e&&!n)return un.randomUUID();n=n||{};const t=n.random||(n.rng||Bi)();if(t[6]=t[6]&15|64,t[8]=t[8]&63|128,e){r=r||0;for(let a=0;a<16;++a)e[r+a]=t[a];return e}return Ki(t)}class $i{}class Tt extends $i{get lc_namespace(){return["langchain","callbacks",this.name]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}constructor(e){var r;super(),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ignoreLLM",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreChain",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreAgent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"awaitHandlers",{enumerable:!0,configurable:!0,writable:!0,value:typeof process<"u"?((r=process.env)==null?void 0:r.LANGCHAIN_CALLBACKS_BACKGROUND)!=="true":!0}),this.lc_kwargs=e||{},e&&(this.ignoreLLM=e.ignoreLLM??this.ignoreLLM,this.ignoreChain=e.ignoreChain??this.ignoreChain,this.ignoreAgent=e.ignoreAgent??this.ignoreAgent)}copy(){return new this.constructor(this)}toJSON(){return ot.prototype.toJSON.call(this)}toJSONNotImplemented(){return ot.prototype.toJSONNotImplemented.call(this)}static fromMethods(e){class r extends Tt{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:Fe()}),Object.assign(this,e)}}return new r}}var jr={exports:{}};jr.exports;(function(n){const r=(i=0)=>o=>`\x1B[${38+i};5;${o}m`,t=(i=0)=>(o,l,u)=>`\x1B[${38+i};2;${o};${l};${u}m`;function a(){const i=new Map,o={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};o.color.gray=o.color.blackBright,o.bgColor.bgGray=o.bgColor.bgBlackBright,o.color.grey=o.color.blackBright,o.bgColor.bgGrey=o.bgColor.bgBlackBright;for(const[l,u]of Object.entries(o)){for(const[d,w]of Object.entries(u))o[d]={open:`\x1B[${w[0]}m`,close:`\x1B[${w[1]}m`},u[d]=o[d],i.set(w[0],w[1]);Object.defineProperty(o,l,{value:u,enumerable:!1})}return Object.defineProperty(o,"codes",{value:i,enumerable:!1}),o.color.close="\x1B[39m",o.bgColor.close="\x1B[49m",o.color.ansi256=r(),o.color.ansi16m=t(),o.bgColor.ansi256=r(10),o.bgColor.ansi16m=t(10),Object.defineProperties(o,{rgbToAnsi256:{value:(l,u,d)=>l===u&&u===d?l<8?16:l>248?231:Math.round((l-8)/247*24)+232:16+36*Math.round(l/255*5)+6*Math.round(u/255*5)+Math.round(d/255*5),enumerable:!1},hexToRgb:{value:l=>{const u=/(?<colorString>[a-f\d]{6}|[a-f\d]{3})/i.exec(l.toString(16));if(!u)return[0,0,0];let{colorString:d}=u.groups;d.length===3&&(d=d.split("").map(j=>j+j).join(""));const w=Number.parseInt(d,16);return[w>>16&255,w>>8&255,w&255]},enumerable:!1},hexToAnsi256:{value:l=>o.rgbToAnsi256(...o.hexToRgb(l)),enumerable:!1}}),o}Object.defineProperty(n,"exports",{enumerable:!0,get:a})})(jr);var qi=jr.exports;const ma=fa(qi);class Sr extends Tt{constructor(e){super(...arguments),Object.defineProperty(this,"runMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map})}copy(){return this}_addChildRun(e,r){e.child_runs.push(r)}_startTrace(e){if(e.parent_run_id!==void 0){const r=this.runMap.get(e.parent_run_id);r&&this._addChildRun(r,e)}this.runMap.set(e.id,e)}async _endTrace(e){const r=e.parent_run_id!==void 0&&this.runMap.get(e.parent_run_id);r?r.child_execution_order=Math.max(r.child_execution_order,e.child_execution_order):await this.persistRun(e),this.runMap.delete(e.id)}_getExecutionOrder(e){const r=e!==void 0&&this.runMap.get(e);return r?r.child_execution_order+1:1}async handleLLMStart(e,r,t,a,i,o,l){var U;const u=this._getExecutionOrder(a),d=Date.now(),w=l?{...i,metadata:l}:i,j={id:t,name:e.id[e.id.length-1],parent_run_id:a,start_time:d,serialized:e,events:[{name:"start",time:d}],inputs:{prompts:r},execution_order:u,child_runs:[],child_execution_order:u,run_type:"llm",extra:w??{},tags:o||[]};this._startTrace(j),await((U=this.onLLMStart)==null?void 0:U.call(this,j))}async handleChatModelStart(e,r,t,a,i,o,l){var U;const u=this._getExecutionOrder(a),d=Date.now(),w=l?{...i,metadata:l}:i,j={id:t,name:e.id[e.id.length-1],parent_run_id:a,start_time:d,serialized:e,events:[{name:"start",time:d}],inputs:{messages:r},execution_order:u,child_runs:[],child_execution_order:u,run_type:"llm",extra:w??{},tags:o||[]};this._startTrace(j),await((U=this.onLLMStart)==null?void 0:U.call(this,j))}async handleLLMEnd(e,r){var a;const t=this.runMap.get(r);if(!t||(t==null?void 0:t.run_type)!=="llm")throw new Error("No LLM run to end.");t.end_time=Date.now(),t.outputs=e,t.events.push({name:"end",time:t.end_time}),await((a=this.onLLMEnd)==null?void 0:a.call(this,t)),await this._endTrace(t)}async handleLLMError(e,r){var a;const t=this.runMap.get(r);if(!t||(t==null?void 0:t.run_type)!=="llm")throw new Error("No LLM run to end.");t.end_time=Date.now(),t.error=e.message,t.events.push({name:"error",time:t.end_time}),await((a=this.onLLMError)==null?void 0:a.call(this,t)),await this._endTrace(t)}async handleChainStart(e,r,t,a,i,o){var w;const l=this._getExecutionOrder(a),u=Date.now(),d={id:t,name:e.id[e.id.length-1],parent_run_id:a,start_time:u,serialized:e,events:[{name:"start",time:u}],inputs:r,execution_order:l,child_execution_order:l,run_type:"chain",child_runs:[],extra:o?{metadata:o}:{},tags:i||[]};this._startTrace(d),await((w=this.onChainStart)==null?void 0:w.call(this,d))}async handleChainEnd(e,r){var a;const t=this.runMap.get(r);if(!t||(t==null?void 0:t.run_type)!=="chain")throw new Error("No chain run to end.");t.end_time=Date.now(),t.outputs=e,t.events.push({name:"end",time:t.end_time}),await((a=this.onChainEnd)==null?void 0:a.call(this,t)),await this._endTrace(t)}async handleChainError(e,r){var a;const t=this.runMap.get(r);if(!t||(t==null?void 0:t.run_type)!=="chain")throw new Error("No chain run to end.");t.end_time=Date.now(),t.error=e.message,t.events.push({name:"error",time:t.end_time}),await((a=this.onChainError)==null?void 0:a.call(this,t)),await this._endTrace(t)}async handleToolStart(e,r,t,a,i,o){var w;const l=this._getExecutionOrder(a),u=Date.now(),d={id:t,name:e.id[e.id.length-1],parent_run_id:a,start_time:u,serialized:e,events:[{name:"start",time:u}],inputs:{input:r},execution_order:l,child_execution_order:l,run_type:"tool",child_runs:[],extra:o?{metadata:o}:{},tags:i||[]};this._startTrace(d),await((w=this.onToolStart)==null?void 0:w.call(this,d))}async handleToolEnd(e,r){var a;const t=this.runMap.get(r);if(!t||(t==null?void 0:t.run_type)!=="tool")throw new Error("No tool run to end");t.end_time=Date.now(),t.outputs={output:e},t.events.push({name:"end",time:t.end_time}),await((a=this.onToolEnd)==null?void 0:a.call(this,t)),await this._endTrace(t)}async handleToolError(e,r){var a;const t=this.runMap.get(r);if(!t||(t==null?void 0:t.run_type)!=="tool")throw new Error("No tool run to end");t.end_time=Date.now(),t.error=e.message,t.events.push({name:"error",time:t.end_time}),await((a=this.onToolError)==null?void 0:a.call(this,t)),await this._endTrace(t)}async handleAgentAction(e,r){var i;const t=this.runMap.get(r);if(!t||(t==null?void 0:t.run_type)!=="chain")return;const a=t;a.actions=a.actions||[],a.actions.push(e),a.events.push({name:"agent_action",time:Date.now(),kwargs:{action:e}}),await((i=this.onAgentAction)==null?void 0:i.call(this,t))}async handleAgentEnd(e,r){var a;const t=this.runMap.get(r);!t||(t==null?void 0:t.run_type)!=="chain"||(t.events.push({name:"agent_end",time:Date.now(),kwargs:{action:e}}),await((a=this.onAgentEnd)==null?void 0:a.call(this,t)))}async handleText(e,r){var a;const t=this.runMap.get(r);!t||(t==null?void 0:t.run_type)!=="chain"||(t.events.push({name:"text",time:Date.now(),kwargs:{text:e}}),await((a=this.onText)==null?void 0:a.call(this,t)))}async handleLLMNewToken(e,r,t){var i;const a=this.runMap.get(t);!a||(a==null?void 0:a.run_type)!=="llm"||(a.events.push({name:"new_token",time:Date.now(),kwargs:{token:e,idx:r}}),await((i=this.onLLMNewToken)==null?void 0:i.call(this,a)))}}function Ue(n,e){return`${n.open}${e}${n.close}`}function Ye(n,e){try{return JSON.stringify(n,null,2)}catch{return e}}function rt(n){if(!n.end_time)return"";const e=n.end_time-n.start_time;return e<1e3?`${e}ms`:`${(e/1e3).toFixed(2)}s`}const{color:Ve}=ma;class ln extends Sr{constructor(){super(...arguments),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"console_callback_handler"})}persistRun(e){return Promise.resolve()}getParents(e){const r=[];let t=e;for(;t.parent_run_id;){const a=this.runMap.get(t.parent_run_id);if(a)r.push(a),t=a;else break}return r}getBreadcrumbs(e){const t=[...this.getParents(e).reverse(),e].map((a,i,o)=>{const l=`${a.execution_order}:${a.run_type}:${a.name}`;return i===o.length-1?Ue(ma.bold,l):l}).join(" > ");return Ue(Ve.grey,t)}onChainStart(e){const r=this.getBreadcrumbs(e);console.log(`${Ue(Ve.green,"[chain/start]")} [${r}] Entering Chain run with input: ${Ye(e.inputs,"[inputs]")}`)}onChainEnd(e){const r=this.getBreadcrumbs(e);console.log(`${Ue(Ve.cyan,"[chain/end]")} [${r}] [${rt(e)}] Exiting Chain run with output: ${Ye(e.outputs,"[outputs]")}`)}onChainError(e){const r=this.getBreadcrumbs(e);console.log(`${Ue(Ve.red,"[chain/error]")} [${r}] [${rt(e)}] Chain run errored with error: ${Ye(e.error,"[error]")}`)}onLLMStart(e){const r=this.getBreadcrumbs(e),t="prompts"in e.inputs?{prompts:e.inputs.prompts.map(a=>a.trim())}:e.inputs;console.log(`${Ue(Ve.green,"[llm/start]")} [${r}] Entering LLM run with input: ${Ye(t,"[inputs]")}`)}onLLMEnd(e){const r=this.getBreadcrumbs(e);console.log(`${Ue(Ve.cyan,"[llm/end]")} [${r}] [${rt(e)}] Exiting LLM run with output: ${Ye(e.outputs,"[response]")}`)}onLLMError(e){const r=this.getBreadcrumbs(e);console.log(`${Ue(Ve.red,"[llm/error]")} [${r}] [${rt(e)}] LLM run errored with error: ${Ye(e.error,"[error]")}`)}onToolStart(e){var t;const r=this.getBreadcrumbs(e);console.log(`${Ue(Ve.green,"[tool/start]")} [${r}] Entering Tool run with input: "${(t=e.inputs.input)==null?void 0:t.trim()}"`)}onToolEnd(e){var t,a;const r=this.getBreadcrumbs(e);console.log(`${Ue(Ve.cyan,"[tool/end]")} [${r}] [${rt(e)}] Exiting Tool run with output: "${(a=(t=e.outputs)==null?void 0:t.output)==null?void 0:a.trim()}"`)}onToolError(e){const r=this.getBreadcrumbs(e);console.log(`${Ue(Ve.red,"[tool/error]")} [${r}] [${rt(e)}] Tool run errored with error: ${Ye(e.error,"[error]")}`)}onAgentAction(e){const r=e,t=this.getBreadcrumbs(e);console.log(`${Ue(Ve.blue,"[agent/action]")} [${t}] Agent selected action: ${Ye(r.actions[r.actions.length-1],"[action]")}`)}}const Fi=[400,401,403,404,405,406,407,408,409];class Hi{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6;const r="default"in at?at.default:at;this.queue=new r({concurrency:this.maxConcurrency})}call(e,...r){return this.queue.add(()=>ji(()=>e(...r).catch(t=>{throw t instanceof Error?t:new Error(t)}),{onFailedAttempt(t){var i;if(t.message.startsWith("Cancel")||t.message.startsWith("TimeoutError")||t.message.startsWith("AbortError")||(t==null?void 0:t.code)==="ECONNABORTED")throw t;const a=(i=t==null?void 0:t.response)==null?void 0:i.status;if(a&&Fi.includes(+a))throw t},retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,r,...t){return e.signal?Promise.race([this.call(r,...t),new Promise((a,i)=>{var o;(o=e.signal)==null||o.addEventListener("abort",()=>{i(new Error("AbortError"))})})]):this.call(r,...t)}fetch(...e){return this.call(()=>fetch(...e).then(r=>r.ok?r:Promise.reject(r)))}}const Yi=()=>typeof window<"u"&&typeof window.document<"u",Wi=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",Gi=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom")),ya=()=>typeof Deno<"u",Ji=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!ya(),Qi=()=>{let n;return Yi()?n="browser":Ji()?n="node":Wi()?n="webworker":Gi()?n="jsdom":ya()?n="deno":n="other",n};let lr;async function Xi(){return lr===void 0&&(lr={library:"langsmith",runtime:Qi()}),lr}function cn(n){var e;try{return typeof process<"u"?(e=process.env)==null?void 0:e[n]:void 0}catch{return}}const es=n=>{const r=n.replace("http://","").replace("https://","").split("/")[0].split(":")[0];return r==="localhost"||r==="127.0.0.1"||r==="::1"},Nt=async(n,e)=>{const r=await n.text();if(!n.ok)throw new Error(`Failed to ${e}: ${n.status} ${n.statusText} ${r}`)};class Nr{constructor(e={}){Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout_ms",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const r=Nr.getDefaultClientConfig();this.apiUrl=e.apiUrl??r.apiUrl,this.apiKey=e.apiKey??r.apiKey,this.validateApiKeyIfHosted(),this.timeout_ms=e.timeout_ms??4e3,this.caller=new Hi(e.callerOptions??{})}static getDefaultClientConfig(){return{apiUrl:cn("LANGCHAIN_ENDPOINT")??"http://localhost:1984",apiKey:cn("LANGCHAIN_API_KEY")}}validateApiKeyIfHosted(){if(!es(this.apiUrl)&&!this.apiKey)throw new Error("API key must be provided when using hosted LangSmith API")}get headers(){const e={};return this.apiKey&&(e["x-api-key"]=`${this.apiKey}`),e}async _get(e,r){const t=(r==null?void 0:r.toString())??"",a=`${this.apiUrl}${e}?${t}`,i=await this.caller.call(fetch,a,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});if(!i.ok)throw new Error(`Failed to fetch ${e}: ${i.status} ${i.statusText}`);return i.json()}async createRun(e){const r={...this.headers,"Content-Type":"application/json"},t=e.extra??{},a=await Xi(),i=e.project_name;delete e.project_name;const o={session_name:i,...e,extra:{...e.extra,runtime:{...a,...t.runtime}}},l=await this.caller.call(fetch,`${this.apiUrl}/runs`,{method:"POST",headers:r,body:JSON.stringify(o),signal:AbortSignal.timeout(this.timeout_ms)});await Nt(l,"create run")}async updateRun(e,r){const t={...this.headers,"Content-Type":"application/json"},a=await this.caller.call(fetch,`${this.apiUrl}/runs/${e}`,{method:"PATCH",headers:t,body:JSON.stringify(r),signal:AbortSignal.timeout(this.timeout_ms)});await Nt(a,"update run")}async readRun(e,{loadChildRuns:r}={loadChildRuns:!1}){let t=await this._get(`/runs/${e}`);return r&&t.child_run_ids&&(t=await this._loadChildRuns(t)),t}async _loadChildRuns(e){const r=await this.listRuns({id:e.child_run_ids}),t={},a={};r.sort((i,o)=>i.execution_order-o.execution_order);for(const i of r){if(i.parent_run_id===null||i.parent_run_id===void 0)throw new Error(`Child run ${i.id} has no parent`);i.parent_run_id in t||(t[i.parent_run_id]=[]),t[i.parent_run_id].push(i),a[i.id]=i}e.child_runs=t[e.id]||[];for(const i in t)i!==e.id&&(a[i].child_runs=t[i]);return e}async listRuns({projectId:e,projectName:r,executionOrder:t,runType:a,error:i,id:o,limit:l,offset:u}){const d=new URLSearchParams;let w=e;if(r){if(e)throw new Error("Only one of projectId or projectName may be given");w=(await this.readProject({projectName:r})).id}if(w&&d.append("session",w),t&&d.append("execution_order",t.toString()),a&&d.append("run_type",a),i!==void 0&&d.append("error",i.toString()),o!==void 0)for(const j of o)d.append("id",j);return l!==void 0&&d.append("limit",l.toString()),u!==void 0&&d.append("offset",u.toString()),this._get("/runs",d)}async deleteRun(e){const r=await this.caller.call(fetch,`${this.apiUrl}/runs/${e}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});await Nt(r,"delete run")}async createProject({projectName:e,projectExtra:r,upsert:t}){const a=t?"?upsert=true":"",i=`${this.apiUrl}/sessions${a}`,o={name:e};r!==void 0&&(o.extra=r);const l=await this.caller.call(fetch,i,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(o),signal:AbortSignal.timeout(this.timeout_ms)}),u=await l.json();if(!l.ok)throw new Error(`Failed to create session ${e}: ${l.status} ${l.statusText}`);return u}async readProject({projectId:e,projectName:r}){let t="/sessions";const a=new URLSearchParams;if(e!==void 0&&r!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(e!==void 0)t+=`/${e}`;else if(r!==void 0)a.append("name",r);else throw new Error("Must provide projectName or projectId");const i=await this._get(t,a);let o;if(Array.isArray(i)){if(i.length===0)throw new Error(`Project[id=${e}, name=${r}] not found`);o=i[0]}else o=i;return o}async listProjects(){return this._get("/sessions")}async deleteProject({projectId:e,projectName:r}){let t;if(e===void 0&&r===void 0)throw new Error("Must provide projectName or projectId");if(e!==void 0&&r!==void 0)throw new Error("Must provide either projectName or projectId, not both");e===void 0?t=(await this.readProject({projectName:r})).id:t=e;const a=await this.caller.call(fetch,`${this.apiUrl}/sessions/${t}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});await Nt(a,`delete session ${t} (${r})`)}async uploadCsv({csvFile:e,fileName:r,inputKeys:t,outputKeys:a,description:i,dataType:o,name:l}){const u=`${this.apiUrl}/datasets/upload`,d=new FormData;d.append("file",e,r),t.forEach(U=>{d.append("input_keys",U)}),a.forEach(U=>{d.append("output_keys",U)}),i&&d.append("description",i),o&&d.append("data_type",o),l&&d.append("name",l);const w=await this.caller.call(fetch,u,{method:"POST",headers:this.headers,body:d,signal:AbortSignal.timeout(this.timeout_ms)});if(!w.ok){const U=await w.json();throw U.detail&&U.detail.includes("already exists")?new Error(`Dataset ${r} already exists`):new Error(`Failed to upload CSV: ${w.status} ${w.statusText}`)}return await w.json()}async createDataset(e,{description:r,dataType:t}={}){const a={name:e,description:r};t&&(a.data_type=t);const i=await this.caller.call(fetch,`${this.apiUrl}/datasets`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(a),signal:AbortSignal.timeout(this.timeout_ms)});if(!i.ok){const l=await i.json();throw l.detail&&l.detail.includes("already exists")?new Error(`Dataset ${e} already exists`):new Error(`Failed to create dataset ${i.status} ${i.statusText}`)}return await i.json()}async readDataset({datasetId:e,datasetName:r}){let t="/datasets";const a=new URLSearchParams({limit:"1"});if(e!==void 0&&r!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(e!==void 0)t+=`/${e}`;else if(r!==void 0)a.append("name",r);else throw new Error("Must provide datasetName or datasetId");const i=await this._get(t,a);let o;if(Array.isArray(i)){if(i.length===0)throw new Error(`Dataset[id=${e}, name=${r}] not found`);o=i[0]}else o=i;return o}async listDatasets({limit:e=100,offset:r=0}={}){const t="/datasets",a=new URLSearchParams({limit:e.toString(),offset:r.toString()}),i=await this._get(t,a);if(!Array.isArray(i))throw new Error(`Expected ${t} to return an array, but got ${i}`);return i}async deleteDataset({datasetId:e,datasetName:r}){let t="/datasets",a=e;if(e!==void 0&&r!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(r!==void 0&&(a=(await this.readDataset({datasetName:r})).id),a!==void 0)t+=`/${a}`;else throw new Error("Must provide datasetName or datasetId");const i=await this.caller.call(fetch,this.apiUrl+t,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});if(!i.ok)throw new Error(`Failed to delete ${t}: ${i.status} ${i.statusText}`);await i.json()}async createExample(e,r,{datasetId:t,datasetName:a,createdAt:i}){let o=t;if(o===void 0&&a===void 0)throw new Error("Must provide either datasetName or datasetId");if(o!==void 0&&a!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");o===void 0&&(o=(await this.readDataset({datasetName:a})).id);const u={dataset_id:o,inputs:e,outputs:r,created_at:(i||new Date).toISOString()},d=await this.caller.call(fetch,`${this.apiUrl}/examples`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(u),signal:AbortSignal.timeout(this.timeout_ms)});if(!d.ok)throw new Error(`Failed to create example: ${d.status} ${d.statusText}`);return await d.json()}async readExample(e){const r=`/examples/${e}`;return await this._get(r)}async listExamples({datasetId:e,datasetName:r,limit:t,offset:a}={}){let i;if(e!==void 0&&r!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(e!==void 0)i=e;else if(r!==void 0)i=(await this.readDataset({datasetName:r})).id;else throw new Error("Must provide a datasetName or datasetId");const o=await this._get("/examples",new URLSearchParams({dataset:i,limit:(t==null?void 0:t.toString())??"100",offset:(a==null?void 0:a.toString())??"0"}));if(!Array.isArray(o))throw new Error(`Expected /examples to return an array, but got ${o}`);return o}async deleteExample(e){const r=`/examples/${e}`,t=await this.caller.call(fetch,this.apiUrl+r,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});if(!t.ok)throw new Error(`Failed to delete ${r}: ${t.status} ${t.statusText}`);await t.json()}async updateExample(e,r){const t=await this.caller.call(fetch,`${this.apiUrl}/examples/${e}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(r),signal:AbortSignal.timeout(this.timeout_ms)});if(!t.ok)throw new Error(`Failed to update example ${e}: ${t.status} ${t.statusText}`);return await t.json()}async evaluateRun(e,r,{sourceInfo:t,loadChildRuns:a}={loadChildRuns:!1}){let i;if(typeof e=="string")i=await this.readRun(e,{loadChildRuns:a});else if(typeof e=="object"&&"id"in e)i=e;else throw new Error(`Invalid run type: ${typeof e}`);let o;i.reference_example_id!==null&&i.reference_example_id!==void 0&&(o=await this.readExample(i.reference_example_id));const l=await r.evaluateRun(i,o);let u=t??{};return l.evaluatorInfo&&(u={...u,...l.evaluatorInfo}),await this.createFeedback(i.id,l.key,{score:l.score,value:l.value,comment:l.comment,correction:l.correction,sourceInfo:u,feedbackSourceType:"MODEL"})}async createFeedback(e,r,{score:t,value:a,correction:i,comment:o,sourceInfo:l,feedbackSourceType:u="API"}){let d;if(u==="API")d={type:"api",metadata:l??{}};else if(u==="MODEL")d={type:"model",metadata:l??{}};else throw new Error(`Unknown feedback source type ${u}`);const w={id:Fe(),run_id:e,key:r,score:t,value:a,correction:i,comment:o,feedback_source:d},j=await this.caller.call(fetch,`${this.apiUrl}/feedback`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(w),signal:AbortSignal.timeout(this.timeout_ms)});if(!j.ok)throw new Error(`Failed to create feedback for run ${e}: ${j.status} ${j.statusText}`);return await j.json()}async readFeedback(e){const r=`/feedback/${e}`;return await this._get(r)}async deleteFeedback(e){const r=`/feedback/${e}`,t=await this.caller.call(fetch,this.apiUrl+r,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms)});if(!t.ok)throw new Error(`Failed to delete ${r}: ${t.status} ${t.statusText}`);await t.json()}async listFeedback({runIds:e,limit:r,offset:t}={}){const a=new URLSearchParams;return e&&a.append("run",e.join(",")),r!==void 0&&a.append("limit",r.toString()),t!==void 0&&a.append("offset",t.toString()),await this._get("/feedback",a)}}class ts extends Sr{constructor(e={}){super(e),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"langchain_tracer"}),Object.defineProperty(this,"projectName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exampleId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const{exampleId:r,projectName:t,client:a}=e;this.projectName=t??_e("LANGCHAIN_PROJECT")??_e("LANGCHAIN_SESSION"),this.exampleId=r,this.client=a??new Nr({})}async _convertToCreate(e,r=void 0){return{...e,extra:{...e.extra,runtime:await Si()},child_runs:void 0,session_name:this.projectName,reference_example_id:e.parent_run_id?void 0:r}}async persistRun(e){}async _persistRunSingle(e){const r=await this._convertToCreate(e,this.exampleId);await this.client.createRun(r)}async _updateRunSingle(e){const r={end_time:e.end_time,error:e.error,outputs:e.outputs,events:e.events};await this.client.updateRun(e.id,r)}async onLLMStart(e){await this._persistRunSingle(e)}async onLLMEnd(e){await this._updateRunSingle(e)}async onLLMError(e){await this._updateRunSingle(e)}async onChainStart(e){await this._persistRunSingle(e)}async onChainEnd(e){await this._updateRunSingle(e)}async onChainError(e){await this._updateRunSingle(e)}async onToolStart(e){await this._persistRunSingle(e)}async onToolEnd(e){await this._updateRunSingle(e)}async onToolError(e){await this._updateRunSingle(e)}}function Dr(n,e="Human",r="AI"){const t=[];for(const a of n){let i;if(a._getType()==="human")i=e;else if(a._getType()==="ai")i=r;else if(a._getType()==="system")i="System";else if(a._getType()==="function")i="Function";else if(a._getType()==="generic")i=a.role;else throw new Error(`Got unsupported message type: ${a}`);const o=a.name?`${a.name}, `:"";t.push(`${i}: ${o}${a.content}`)}return t.join(`
`)}class rs extends Sr{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"langchain_tracer"}),Object.defineProperty(this,"endpoint",{enumerable:!0,configurable:!0,writable:!0,value:_e("LANGCHAIN_ENDPOINT")||"http://localhost:1984"}),Object.defineProperty(this,"headers",{enumerable:!0,configurable:!0,writable:!0,value:{"Content-Type":"application/json"}}),Object.defineProperty(this,"session",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const e=_e("LANGCHAIN_API_KEY");e&&(this.headers["x-api-key"]=e)}async newSession(e){const r={start_time:Date.now(),name:e},t=await this.persistSession(r);return this.session=t,t}async loadSession(e){const r=`${this.endpoint}/sessions?name=${e}`;return this._handleSessionResponse(r)}async loadDefaultSession(){const e=`${this.endpoint}/sessions?name=default`;return this._handleSessionResponse(e)}async convertV2RunToRun(e){var i;const r=this.session??await this.loadDefaultSession(),t=e.serialized;let a;if(e.run_type==="llm"){const o=e.inputs.prompts?e.inputs.prompts:e.inputs.messages.map(u=>Dr(u));a={uuid:e.id,start_time:e.start_time,end_time:e.end_time,execution_order:e.execution_order,child_execution_order:e.child_execution_order,serialized:t,type:e.run_type,session_id:r.id,prompts:o,response:e.outputs}}else if(e.run_type==="chain"){const o=await Promise.all(e.child_runs.map(u=>this.convertV2RunToRun(u)));a={uuid:e.id,start_time:e.start_time,end_time:e.end_time,execution_order:e.execution_order,child_execution_order:e.child_execution_order,serialized:t,type:e.run_type,session_id:r.id,inputs:e.inputs,outputs:e.outputs,child_llm_runs:o.filter(u=>u.type==="llm"),child_chain_runs:o.filter(u=>u.type==="chain"),child_tool_runs:o.filter(u=>u.type==="tool")}}else if(e.run_type==="tool"){const o=await Promise.all(e.child_runs.map(u=>this.convertV2RunToRun(u)));a={uuid:e.id,start_time:e.start_time,end_time:e.end_time,execution_order:e.execution_order,child_execution_order:e.child_execution_order,serialized:t,type:e.run_type,session_id:r.id,tool_input:e.inputs.input,output:(i=e.outputs)==null?void 0:i.output,action:JSON.stringify(t),child_llm_runs:o.filter(u=>u.type==="llm"),child_chain_runs:o.filter(u=>u.type==="chain"),child_tool_runs:o.filter(u=>u.type==="tool")}}else throw new Error(`Unknown run type: ${e.run_type}`);return a}async persistRun(e){let r,t;e.run_type!==void 0?t=await this.convertV2RunToRun(e):t=e,t.type==="llm"?r=`${this.endpoint}/llm-runs`:t.type==="chain"?r=`${this.endpoint}/chain-runs`:r=`${this.endpoint}/tool-runs`;const a=await fetch(r,{method:"POST",headers:this.headers,body:JSON.stringify(t)});a.ok||console.error(`Failed to persist run: ${a.status} ${a.statusText}`)}async persistSession(e){const r=`${this.endpoint}/sessions`,t=await fetch(r,{method:"POST",headers:this.headers,body:JSON.stringify(e)});return t.ok?{id:(await t.json()).id,...e}:(console.error(`Failed to persist session: ${t.status} ${t.statusText}, using default session.`),{id:1,...e})}async _handleSessionResponse(e){const r=await fetch(e,{method:"GET",headers:this.headers});let t;if(!r.ok)return console.error(`Failed to load session: ${r.status} ${r.statusText}`),t={id:1,start_time:Date.now()},this.session=t,t;const a=await r.json();return a.length===0?(t={id:1,start_time:Date.now()},this.session=t,t):([t]=a,this.session=t,t)}}async function ns(n){const e=new rs;return n?await e.loadSession(n):await e.loadDefaultSession(),e}async function as(){return new ts}let cr;function is(){const n="default"in at?at.default:at;return new n({autoStart:!0,concurrency:1})}async function De(n,e){e===!0?await n():(typeof cr>"u"&&(cr=is()),cr.add(n))}function ss(n){return n?Array.isArray(n)||"name"in n?{callbacks:n}:n:{}}class os{setHandler(e){return this.setHandlers([e])}}class Lr{constructor(e,r,t,a,i,o,l,u){Object.defineProperty(this,"runId",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:l}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:u})}async handleText(e){await Promise.all(this.handlers.map(r=>De(async()=>{var t;try{await((t=r.handleText)==null?void 0:t.call(r,e,this.runId,this._parentRunId,this.tags))}catch(a){console.error(`Error in handler ${r.constructor.name}, handleText: ${a}`)}},r.awaitHandlers)))}}class dn extends Lr{async handleLLMNewToken(e,r={prompt:0,completion:0}){await Promise.all(this.handlers.map(t=>De(async()=>{var a;if(!t.ignoreLLM)try{await((a=t.handleLLMNewToken)==null?void 0:a.call(t,e,r,this.runId,this._parentRunId,this.tags))}catch(i){console.error(`Error in handler ${t.constructor.name}, handleLLMNewToken: ${i}`)}},t.awaitHandlers)))}async handleLLMError(e){await Promise.all(this.handlers.map(r=>De(async()=>{var t;if(!r.ignoreLLM)try{await((t=r.handleLLMError)==null?void 0:t.call(r,e,this.runId,this._parentRunId,this.tags))}catch(a){console.error(`Error in handler ${r.constructor.name}, handleLLMError: ${a}`)}},r.awaitHandlers)))}async handleLLMEnd(e){await Promise.all(this.handlers.map(r=>De(async()=>{var t;if(!r.ignoreLLM)try{await((t=r.handleLLMEnd)==null?void 0:t.call(r,e,this.runId,this._parentRunId,this.tags))}catch(a){console.error(`Error in handler ${r.constructor.name}, handleLLMEnd: ${a}`)}},r.awaitHandlers)))}}class us extends Lr{getChild(e){const r=new Ge(this.runId);return r.setHandlers(this.inheritableHandlers),r.addTags(this.inheritableTags),r.addMetadata(this.inheritableMetadata),e&&r.addTags([e],!1),r}async handleChainError(e){await Promise.all(this.handlers.map(r=>De(async()=>{var t;if(!r.ignoreChain)try{await((t=r.handleChainError)==null?void 0:t.call(r,e,this.runId,this._parentRunId,this.tags))}catch(a){console.error(`Error in handler ${r.constructor.name}, handleChainError: ${a}`)}},r.awaitHandlers)))}async handleChainEnd(e){await Promise.all(this.handlers.map(r=>De(async()=>{var t;if(!r.ignoreChain)try{await((t=r.handleChainEnd)==null?void 0:t.call(r,e,this.runId,this._parentRunId,this.tags))}catch(a){console.error(`Error in handler ${r.constructor.name}, handleChainEnd: ${a}`)}},r.awaitHandlers)))}async handleAgentAction(e){await Promise.all(this.handlers.map(r=>De(async()=>{var t;if(!r.ignoreAgent)try{await((t=r.handleAgentAction)==null?void 0:t.call(r,e,this.runId,this._parentRunId,this.tags))}catch(a){console.error(`Error in handler ${r.constructor.name}, handleAgentAction: ${a}`)}},r.awaitHandlers)))}async handleAgentEnd(e){await Promise.all(this.handlers.map(r=>De(async()=>{var t;if(!r.ignoreAgent)try{await((t=r.handleAgentEnd)==null?void 0:t.call(r,e,this.runId,this._parentRunId,this.tags))}catch(a){console.error(`Error in handler ${r.constructor.name}, handleAgentEnd: ${a}`)}},r.awaitHandlers)))}}class ls extends Lr{getChild(e){const r=new Ge(this.runId);return r.setHandlers(this.inheritableHandlers),r.addTags(this.inheritableTags),r.addMetadata(this.inheritableMetadata),e&&r.addTags([e],!1),r}async handleToolError(e){await Promise.all(this.handlers.map(r=>De(async()=>{var t;if(!r.ignoreAgent)try{await((t=r.handleToolError)==null?void 0:t.call(r,e,this.runId,this._parentRunId,this.tags))}catch(a){console.error(`Error in handler ${r.constructor.name}, handleToolError: ${a}`)}},r.awaitHandlers)))}async handleToolEnd(e){await Promise.all(this.handlers.map(r=>De(async()=>{var t;if(!r.ignoreAgent)try{await((t=r.handleToolEnd)==null?void 0:t.call(r,e,this.runId,this._parentRunId,this.tags))}catch(a){console.error(`Error in handler ${r.constructor.name}, handleToolEnd: ${a}`)}},r.awaitHandlers)))}}class Ge extends os{constructor(e){super(),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"callback_manager"}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.handlers=[],this.inheritableHandlers=[],this._parentRunId=e}async handleLLMStart(e,r,t=void 0,a=void 0,i=void 0){return Promise.all(r.map(async o=>{const l=Fe();return await Promise.all(this.handlers.map(u=>De(async()=>{var d;if(!u.ignoreLLM)try{await((d=u.handleLLMStart)==null?void 0:d.call(u,e,[o],l,this._parentRunId,i,this.tags,this.metadata))}catch(w){console.error(`Error in handler ${u.constructor.name}, handleLLMStart: ${w}`)}},u.awaitHandlers))),new dn(l,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChatModelStart(e,r,t=void 0,a=void 0,i=void 0){return Promise.all(r.map(async o=>{const l=Fe();return await Promise.all(this.handlers.map(u=>De(async()=>{var d,w;if(!u.ignoreLLM)try{if(u.handleChatModelStart)await((d=u.handleChatModelStart)==null?void 0:d.call(u,e,[o],l,this._parentRunId,i,this.tags,this.metadata));else if(u.handleLLMStart){const j=Dr(o);await((w=u.handleLLMStart)==null?void 0:w.call(u,e,[j],l,this._parentRunId,i,this.tags,this.metadata))}}catch(j){console.error(`Error in handler ${u.constructor.name}, handleLLMStart: ${j}`)}},u.awaitHandlers))),new dn(l,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChainStart(e,r,t=Fe()){return await Promise.all(this.handlers.map(a=>De(async()=>{var i;if(!a.ignoreChain)try{await((i=a.handleChainStart)==null?void 0:i.call(a,e,r,t,this._parentRunId,this.tags,this.metadata))}catch(o){console.error(`Error in handler ${a.constructor.name}, handleChainStart: ${o}`)}},a.awaitHandlers))),new us(t,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleToolStart(e,r,t=Fe()){return await Promise.all(this.handlers.map(a=>De(async()=>{var i;if(!a.ignoreAgent)try{await((i=a.handleToolStart)==null?void 0:i.call(a,e,r,t,this._parentRunId,this.tags,this.metadata))}catch(o){console.error(`Error in handler ${a.constructor.name}, handleToolStart: ${o}`)}},a.awaitHandlers))),new ls(t,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}addHandler(e,r=!0){this.handlers.push(e),r&&this.inheritableHandlers.push(e)}removeHandler(e){this.handlers=this.handlers.filter(r=>r!==e),this.inheritableHandlers=this.inheritableHandlers.filter(r=>r!==e)}setHandlers(e,r=!0){this.handlers=[],this.inheritableHandlers=[];for(const t of e)this.addHandler(t,r)}addTags(e,r=!0){this.removeTags(e),this.tags.push(...e),r&&this.inheritableTags.push(...e)}removeTags(e){this.tags=this.tags.filter(r=>!e.includes(r)),this.inheritableTags=this.inheritableTags.filter(r=>!e.includes(r))}addMetadata(e,r=!0){this.metadata={...this.metadata,...e},r&&(this.inheritableMetadata={...this.inheritableMetadata,...e})}removeMetadata(e){for(const r of Object.keys(e))delete this.metadata[r],delete this.inheritableMetadata[r]}copy(e=[],r=!0){const t=new Ge(this._parentRunId);for(const a of this.handlers){const i=this.inheritableHandlers.includes(a);t.addHandler(a,i)}for(const a of this.tags){const i=this.inheritableTags.includes(a);t.addTags([a],i)}for(const a of Object.keys(this.metadata)){const i=Object.keys(this.inheritableMetadata).includes(a);t.addMetadata({[a]:this.metadata[a]},i)}for(const a of e)t.handlers.filter(i=>i.name==="console_callback_handler").some(i=>i.name===a.name)||t.addHandler(a,r);return t}static fromHandlers(e){class r extends Tt{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:Fe()}),Object.assign(this,e)}}const t=new this;return t.addHandler(new r),t}static async configure(e,r,t,a,i,o,l){let u;(e||r)&&(Array.isArray(e)||!e?(u=new Ge,u.setHandlers((e==null?void 0:e.map(hn))??[],!0)):u=e,u=u.copy(Array.isArray(r)?r.map(hn):r==null?void 0:r.handlers,!1));const d=_e("LANGCHAIN_VERBOSE")||(l==null?void 0:l.verbose),w=_e("LANGCHAIN_TRACING_V2")??!1,j=w||(_e("LANGCHAIN_TRACING")??!1);if(d||j){if(u||(u=new Ge),d&&!u.handlers.some(U=>U.name===ln.prototype.name)){const U=new ln;u.addHandler(U,!0)}if(j&&!u.handlers.some(U=>U.name==="langchain_tracer"))if(w)u.addHandler(await as(),!0);else{const U=_e("LANGCHAIN_PROJECT")&&_e("LANGCHAIN_SESSION");u.addHandler(await ns(U),!0)}}return(t||a)&&u&&(u.addTags(t??[]),u.addTags(a??[],!1)),(i||o)&&u&&(u.addMetadata(i??{}),u.addMetadata(o??{},!1)),u}}function hn(n){return"name"in n?n:Tt.fromMethods(n)}const Dt={},cs=new ia({});async function ds(n,e){return n in Dt||(Dt[n]=cs.fetch(`https://tiktoken.pages.dev/js/${n}.json`,{signal:e==null?void 0:e.signal}).then(r=>r.json()).catch(r=>{throw delete Dt[n],r})),new Ri(await Dt[n],e==null?void 0:e.extendedSpecialTokens)}async function ga(n,e){return ds(Mi(n),e)}const ba=n=>n.startsWith("gpt-3.5-turbo-16k")?"gpt-3.5-turbo-16k":n.startsWith("gpt-3.5-turbo-")?"gpt-3.5-turbo":n.startsWith("gpt-4-32k")?"gpt-4-32k":n.startsWith("gpt-4-")?"gpt-4":n,hs=n=>{switch(ba(n)){case"gpt-3.5-turbo-16k":return 16384;case"gpt-3.5-turbo":return 4096;case"gpt-4-32k":return 32768;case"gpt-4":return 8192;case"text-davinci-003":return 4097;case"text-curie-001":return 2048;case"text-babbage-001":return 2048;case"text-ada-001":return 2048;case"code-davinci-002":return 8e3;case"code-cushman-001":return 2048;default:return 4097}},ps=async({prompt:n,modelName:e})=>{let r;try{r=(await ga(e)).encode(n).length}catch{console.warn("Failed to calculate number of tokens, falling back to approximate count"),r=Math.ceil(n.length/4)}return hs(e)-r},fs=()=>!1;class _a extends ot{get lc_attributes(){return{callbacks:void 0,verbose:void 0}}constructor(e){super(e),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.verbose=e.verbose??fs(),this.callbacks=e.callbacks,this.tags=e.tags??[],this.metadata=e.metadata??{}}}class va extends _a{get callKeys(){return["stop","timeout","signal","tags","metadata","callbacks"]}constructor({callbacks:e,callbackManager:r,...t}){super({callbacks:e??r,...t}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_encoding",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.caller=new ia(t??{})}async getNumTokens(e){let r=Math.ceil(e.length/4);if(!this._encoding)try{this._encoding=await ga("modelName"in this?ba(this.modelName):"gpt2")}catch(t){console.warn("Failed to calculate number of tokens, falling back to approximate count",t)}return this._encoding&&(r=this._encoding.encode(e).length),r}_identifyingParams(){return{}}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}static async deserialize(e){const{_type:r,_model:t,...a}=e;if(t&&t!=="base_chat_model")throw new Error(`Cannot load LLM with model ${t}`);const i={openai:(await Ne(()=>import("./openai.2ba6be30.js"),["./openai.2ba6be30.js","./NavBar.dcd95840.js","./public.41f5b175.js","./scheduler.2364b0ad.js","./index.be5c2245.js","../assets/NavBar.ffbd0f32.css"],import.meta.url)).ChatOpenAI}[r];if(i===void 0)throw new Error(`Cannot load  LLM with type ${r}`);return new i(a)}}class Et extends _a{get lc_namespace(){return["langchain","chains",this._chainType()]}constructor(e,r,t){if(arguments.length===1&&typeof e=="object"&&!("saveContext"in e)){const{memory:a,callbackManager:i,...o}=e;super({...o,callbacks:i??o.callbacks}),this.memory=a}else super({verbose:r,callbacks:t}),this.memory=e}_selectMemoryInputs(e){const r={...e};return"signal"in r&&delete r.signal,"timeout"in r&&delete r.timeout,r}serialize(){throw new Error("Method not implemented.")}async run(e,r){const t=this.inputKeys.filter(u=>{var d;return!((d=this.memory)!=null&&d.memoryKeys.includes(u))});if(!(t.length<=1))throw new Error(`Chain ${this._chainType()} expects multiple inputs, cannot use 'run' `);const i=t.length?{[t[0]]:e}:{},o=await this.call(i,r),l=Object.keys(o);if(l.length===1)return o[l[0]];throw new Error("return values have multiple keys, `run` only supported when one key currently")}async call(e,r,t){const a={...e};if(a.timeout&&!a.signal&&(a.signal=AbortSignal.timeout(a.timeout),delete a.timeout),this.memory!=null){const d=await this.memory.loadMemoryVariables(this._selectMemoryInputs(e));for(const[w,j]of Object.entries(d))a[w]=j}const i=ss(r),o=await Ge.configure(i.callbacks,this.callbacks,i.tags||t,this.tags,i.metadata,this.metadata,{verbose:this.verbose}),l=await(o==null?void 0:o.handleChainStart(this.toJSON(),a));let u;try{u=await(e.signal?Promise.race([this._call(a,l),new Promise((d,w)=>{var j;(j=e.signal)==null||j.addEventListener("abort",()=>{w(new Error("AbortError"))})})]):this._call(a,l))}catch(d){throw await(l==null?void 0:l.handleChainError(d)),d}return this.memory!=null&&await this.memory.saveContext(this._selectMemoryInputs(e),u),await(l==null?void 0:l.handleChainEnd(u)),Object.defineProperty(u,sa,{value:l?{runId:l==null?void 0:l.runId}:void 0,configurable:!0}),u}async apply(e,r){return Promise.all(e.map(async(t,a)=>this.call(t,r==null?void 0:r[a])))}static async deserialize(e,r={}){switch(e._type){case"llm_chain":{const{LLMChain:t}=await Ne(()=>Promise.resolve().then(()=>vs),void 0,import.meta.url);return t.deserialize(e)}case"sequential_chain":{const{SequentialChain:t}=await Ne(()=>import("./sequential_chain.30d6f1e9.js"),[],import.meta.url);return t.deserialize(e)}case"simple_sequential_chain":{const{SimpleSequentialChain:t}=await Ne(()=>import("./sequential_chain.30d6f1e9.js"),[],import.meta.url);return t.deserialize(e)}case"stuff_documents_chain":{const{StuffDocumentsChain:t}=await Ne(()=>Promise.resolve().then(()=>dr),void 0,import.meta.url);return t.deserialize(e)}case"map_reduce_documents_chain":{const{MapReduceDocumentsChain:t}=await Ne(()=>Promise.resolve().then(()=>dr),void 0,import.meta.url);return t.deserialize(e)}case"refine_documents_chain":{const{RefineDocumentsChain:t}=await Ne(()=>Promise.resolve().then(()=>dr),void 0,import.meta.url);return t.deserialize(e)}case"vector_db_qa":{const{VectorDBQAChain:t}=await Ne(()=>import("./vector_db_qa.947467e5.js"),[],import.meta.url);return t.deserialize(e,r)}case"api_chain":{const{APIChain:t}=await Ne(()=>import("./api_chain.40c252f5.js"),[],import.meta.url);return t.deserialize(e)}default:throw new Error(`Invalid prompt type in config: ${e._type}`)}}}class ms extends oa{constructor(e){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","prompts","base"]}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.value=e}toString(){return this.value}toChatMessages(){return[new ua(this.value)]}}class Zr extends ot{get lc_attributes(){return{partialVariables:void 0}}constructor(e){super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","prompts",this._getPromptType()]}),Object.defineProperty(this,"inputVariables",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"partialVariables",{enumerable:!0,configurable:!0,writable:!0,value:{}});const{inputVariables:r}=e;if(r.includes("stop"))throw new Error("Cannot have an input variable named 'stop', as it is used internally, please rename.");Object.assign(this,e)}async mergePartialAndUserVariables(e){const r=this.partialVariables??{},t={};for(const[i,o]of Object.entries(r))typeof o=="string"?t[i]=o:t[i]=await o();return{...t,...e}}serialize(){throw new Error("Use .toJSON() instead")}static async deserialize(e){switch(e._type){case"prompt":{const{PromptTemplate:r}=await Ne(()=>Promise.resolve().then(()=>pn),void 0,import.meta.url);return r.deserialize(e)}case void 0:{const{PromptTemplate:r}=await Ne(()=>Promise.resolve().then(()=>pn),void 0,import.meta.url);return r.deserialize({...e,_type:"prompt"})}case"few_shot":{const{FewShotPromptTemplate:r}=await Ne(()=>import("./few_shot.814ca61e.js"),[],import.meta.url);return r.deserialize(e)}default:throw new Error(`Invalid prompt type in config: ${e._type}`)}}}class ys extends Zr{async formatPromptValue(e){const r=await this.format(e);return new ms(r)}}class gs extends ot{parseResultWithPrompt(e,r,t){return this.parseResult(e,t)}}class bs extends gs{parseResult(e,r){return this.parse(e[0].text,r)}async parseWithPrompt(e,r,t){return this.parse(e,t)}_type(){throw new Error("_type not implemented")}}class _s extends bs{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","default"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}parse(e){return Promise.resolve(e)}getFormatInstructions(){return""}}class Ze extends Et{get inputKeys(){return this.prompt.inputVariables}get outputKeys(){return[this.outputKey]}constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"prompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"llm",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"llmKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputKey",{enumerable:!0,configurable:!0,writable:!0,value:"text"}),Object.defineProperty(this,"outputParser",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.prompt=e.prompt,this.llm=e.llm,this.llmKwargs=e.llmKwargs,this.outputKey=e.outputKey??this.outputKey,this.outputParser=e.outputParser??new _s,this.prompt.outputParser){if(e.outputParser)throw new Error("Cannot set both outputParser and prompt.outputParser");this.outputParser=this.prompt.outputParser}}_selectMemoryInputs(e){const r=super._selectMemoryInputs(e);for(const t of this.llm.callKeys)t in e&&delete r[t];return r}async _getFinalOutput(e,r,t){let a;return this.outputParser?a=await this.outputParser.parseResultWithPrompt(e,r,t==null?void 0:t.getChild()):a=e[0].text,a}call(e,r){return super.call(e,r)}async _call(e,r){const t={...e},a={...this.llmKwargs};for(const l of this.llm.callKeys)l in e&&(a[l]=e[l],delete t[l]);const i=await this.prompt.formatPromptValue(t),{generations:o}=await this.llm.generatePrompt([i],a,r==null?void 0:r.getChild());return{[this.outputKey]:await this._getFinalOutput(o[0],i,r)}}async predict(e,r){return(await this.call(e,r))[this.outputKey]}_chainType(){return"llm"}static async deserialize(e){const{llm:r,prompt:t}=e;if(!r)throw new Error("LLMChain must have llm");if(!t)throw new Error("LLMChain must have prompt");return new Ze({llm:await va.deserialize(r),prompt:await Zr.deserialize(t)})}serialize(){return{_type:`${this._chainType()}_chain`,llm:this.llm.serialize(),prompt:this.prompt.serialize()}}}const vs=Object.freeze(Object.defineProperty({__proto__:null,LLMChain:Ze},Symbol.toStringTag,{value:"Module"})),wa=n=>{const e=n.split(""),r=[],t=(i,o)=>{for(let l=o;l<e.length;l+=1)if(i.includes(e[l]))return l;return-1};let a=0;for(;a<e.length;)if(e[a]==="{"&&a+1<e.length&&e[a+1]==="{")r.push({type:"literal",text:"{"}),a+=2;else if(e[a]==="}"&&a+1<e.length&&e[a+1]==="}")r.push({type:"literal",text:"}"}),a+=2;else if(e[a]==="{"){const i=t("}",a);if(i<0)throw new Error("Unclosed '{' in template.");r.push({type:"variable",name:e.slice(a+1,i).join("")}),a=i+1}else{if(e[a]==="}")throw new Error("Single '}' in template.");{const i=t("{}",a),o=(i<0?e.slice(a):e.slice(a,i)).join("");r.push({type:"literal",text:o}),a=i<0?e.length:i}}return r},ws=(n,e)=>wa(n).reduce((r,t)=>{if(t.type==="variable"){if(t.name in e)return r+e[t.name];throw new Error(`Missing value for input ${t.name}`)}return r+t.text},""),Pr={"f-string":ws,jinja2:(n,e)=>""},Is={"f-string":wa,jinja2:n=>[]},Ia=(n,e,r)=>Pr[e](n,r),Ps=(n,e)=>Is[e](n),Os=(n,e,r)=>{if(!(e in Pr)){const t=Object.keys(Pr);throw new Error(`Invalid template format. Got \`${e}\`;
                         should be one of ${t}`)}try{const t=r.reduce((a,i)=>(a[i]="foo",a),{});Ia(n,e,t)}catch(t){throw new Error(`Invalid prompt schema: ${t.message}`)}};class xe extends ys{constructor(e){if(super(e),Object.defineProperty(this,"template",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"templateFormat",{enumerable:!0,configurable:!0,writable:!0,value:"f-string"}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.assign(this,e),this.validateTemplate){let r=this.inputVariables;this.partialVariables&&(r=r.concat(Object.keys(this.partialVariables))),Os(this.template,this.templateFormat,r)}}_getPromptType(){return"prompt"}async format(e){const r=await this.mergePartialAndUserVariables(e);return Ia(this.template,this.templateFormat,r)}static fromExamples(e,r,t,a=`

`,i=""){const o=[i,...e,r].join(a);return new xe({inputVariables:t,template:o})}static fromTemplate(e,{templateFormat:r="f-string",...t}={}){const a=new Set;return Ps(e,r).forEach(i=>{i.type==="variable"&&a.add(i.name)}),new xe({inputVariables:[...a],templateFormat:r,template:e,...t})}async partial(e){const r={...this};return r.inputVariables=this.inputVariables.filter(t=>!(t in e)),r.partialVariables={...this.partialVariables??{},...e},new xe(r)}serialize(){if(this.outputParser!==void 0)throw new Error("Cannot serialize a prompt template with an output parser");return{_type:this._getPromptType(),input_variables:this.inputVariables,template:this.template,template_format:this.templateFormat}}static async deserialize(e){if(!e.template)throw new Error("Prompt template must have a template");return new xe({inputVariables:e.input_variables,template:e.template,templateFormat:e.template_format})}}const pn=Object.freeze(Object.defineProperty({__proto__:null,PromptTemplate:xe},Symbol.toStringTag,{value:"Module"}));class lt extends Et{get inputKeys(){return[this.inputKey,...this.llmChain.inputKeys].filter(e=>e!==this.documentVariableName)}get outputKeys(){return this.llmChain.outputKeys}constructor(e){super(e),Object.defineProperty(this,"llmChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"input_documents"}),Object.defineProperty(this,"documentVariableName",{enumerable:!0,configurable:!0,writable:!0,value:"context"}),this.llmChain=e.llmChain,this.documentVariableName=e.documentVariableName??this.documentVariableName,this.inputKey=e.inputKey??this.inputKey}_prepInputs(e){if(!(this.inputKey in e))throw new Error(`Document key ${this.inputKey} not found.`);const{[this.inputKey]:r,...t}=e,i=r.map(({pageContent:o})=>o).join(`

`);return{...t,[this.documentVariableName]:i}}async _call(e,r){return await this.llmChain.call(this._prepInputs(e),r==null?void 0:r.getChild("combine_documents"))}_chainType(){return"stuff_documents_chain"}static async deserialize(e){if(!e.llm_chain)throw new Error("Missing llm_chain");return new lt({llmChain:await Ze.deserialize(e.llm_chain)})}serialize(){return{_type:this._chainType(),llm_chain:this.llmChain.serialize()}}}class zt extends Et{get inputKeys(){return[this.inputKey,...this.combineDocumentChain.inputKeys]}get outputKeys(){return this.combineDocumentChain.outputKeys}constructor(e){super(e),Object.defineProperty(this,"llmChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"input_documents"}),Object.defineProperty(this,"documentVariableName",{enumerable:!0,configurable:!0,writable:!0,value:"context"}),Object.defineProperty(this,"returnIntermediateSteps",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:3e3}),Object.defineProperty(this,"maxIterations",{enumerable:!0,configurable:!0,writable:!0,value:10}),Object.defineProperty(this,"ensureMapStep",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"combineDocumentChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.llmChain=e.llmChain,this.combineDocumentChain=e.combineDocumentChain,this.documentVariableName=e.documentVariableName??this.documentVariableName,this.ensureMapStep=e.ensureMapStep??this.ensureMapStep,this.inputKey=e.inputKey??this.inputKey,this.maxTokens=e.maxTokens??this.maxTokens,this.maxIterations=e.maxIterations??this.maxIterations,this.returnIntermediateSteps=e.returnIntermediateSteps??!1}async _call(e,r){if(!(this.inputKey in e))throw new Error(`Document key ${this.inputKey} not found.`);const{[this.inputKey]:t,...a}=e;let i=t,o=[];for(let d=0;d<this.maxIterations;d+=1){const w=i.map(k=>({[this.documentVariableName]:k.pageContent,...a}));if(d!==0||!this.ensureMapStep){const k=await this.combineDocumentChain.llmChain.prompt.format(this.combineDocumentChain._prepInputs({[this.combineDocumentChain.inputKey]:i,...a}));if(await this.combineDocumentChain.llmChain.llm.getNumTokens(k)<this.maxTokens)break}const U=await this.llmChain.apply(w,r?Array.from({length:w.length},(k,M)=>r.getChild(`map_${M+1}`)):void 0),{outputKey:B}=this.llmChain;this.returnIntermediateSteps&&(o=o.concat(U.map(k=>k[B]))),i=U.map(k=>({pageContent:k[B],metadata:{}}))}const l={[this.combineDocumentChain.inputKey]:i,...a},u=await this.combineDocumentChain.call(l,r==null?void 0:r.getChild("combine_documents"));return this.returnIntermediateSteps?{...u,intermediateSteps:o}:u}_chainType(){return"map_reduce_documents_chain"}static async deserialize(e){if(!e.llm_chain)throw new Error("Missing llm_chain");if(!e.combine_document_chain)throw new Error("Missing combine_document_chain");return new zt({llmChain:await Ze.deserialize(e.llm_chain),combineDocumentChain:await lt.deserialize(e.combine_document_chain)})}serialize(){return{_type:this._chainType(),llm_chain:this.llmChain.serialize(),combine_document_chain:this.combineDocumentChain.serialize()}}}class $t extends Et{get defaultDocumentPrompt(){return new xe({inputVariables:["page_content"],template:"{page_content}"})}get inputKeys(){return[...new Set([this.inputKey,...this.llmChain.inputKeys,...this.refineLLMChain.inputKeys])].filter(e=>e!==this.documentVariableName&&e!==this.initialResponseName)}get outputKeys(){return[this.outputKey]}constructor(e){super(e),Object.defineProperty(this,"llmChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"input_documents"}),Object.defineProperty(this,"outputKey",{enumerable:!0,configurable:!0,writable:!0,value:"output_text"}),Object.defineProperty(this,"documentVariableName",{enumerable:!0,configurable:!0,writable:!0,value:"context"}),Object.defineProperty(this,"initialResponseName",{enumerable:!0,configurable:!0,writable:!0,value:"existing_answer"}),Object.defineProperty(this,"refineLLMChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"documentPrompt",{enumerable:!0,configurable:!0,writable:!0,value:this.defaultDocumentPrompt}),this.llmChain=e.llmChain,this.refineLLMChain=e.refineLLMChain,this.documentVariableName=e.documentVariableName??this.documentVariableName,this.inputKey=e.inputKey??this.inputKey,this.outputKey=e.outputKey??this.outputKey,this.documentPrompt=e.documentPrompt??this.documentPrompt,this.initialResponseName=e.initialResponseName??this.initialResponseName}async _constructInitialInputs(e,r){const t={page_content:e.pageContent,...e.metadata},a={};return this.documentPrompt.inputVariables.forEach(l=>{a[l]=t[l]}),{...{[this.documentVariableName]:await this.documentPrompt.format({...a})},...r}}async _constructRefineInputs(e,r){const t={page_content:e.pageContent,...e.metadata},a={};this.documentPrompt.inputVariables.forEach(l=>{a[l]=t[l]});const i={[this.documentVariableName]:await this.documentPrompt.format({...a})};return{[this.initialResponseName]:r,...i}}async _call(e,r){if(!(this.inputKey in e))throw new Error(`Document key ${this.inputKey} not found.`);const{[this.inputKey]:t,...a}=e,i=t,o=await this._constructInitialInputs(i[0],a);let l=await this.llmChain.predict({...o},r==null?void 0:r.getChild("answer"));for(let u=1;u<i.length;u+=1){const w={...await this._constructRefineInputs(i[u],l),...a};l=await this.refineLLMChain.predict({...w},r==null?void 0:r.getChild("refine"))}return{[this.outputKey]:l}}_chainType(){return"refine_documents_chain"}static async deserialize(e){const r=e.llm_chain;if(!r)throw new Error("Missing llm_chain");const t=e.refine_llm_chain;if(!t)throw new Error("Missing refine_llm_chain");return new $t({llmChain:await Ze.deserialize(r),refineLLMChain:await Ze.deserialize(t)})}serialize(){return{_type:this._chainType(),llm_chain:this.llmChain.serialize(),refine_llm_chain:this.refineLLMChain.serialize()}}}const dr=Object.freeze(Object.defineProperty({__proto__:null,MapReduceDocumentsChain:zt,RefineDocumentsChain:$t,StuffDocumentsChain:lt},Symbol.toStringTag,{value:"Module"}));class As extends ot{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","prompts","chat"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}}class Ts extends oa{constructor(e){Array.isArray(e)&&(e={messages:e}),super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","prompts","chat"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"messages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.messages=e.messages}toString(){return JSON.stringify(this.messages)}toChatMessages(){return this.messages}}class Mr extends As{constructor(e){"prompt"in e||(e={prompt:e}),super(e),Object.defineProperty(this,"prompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.prompt=e.prompt}get inputVariables(){return this.prompt.inputVariables}async formatMessages(e){return[await this.format(e)]}}class Es extends Zr{constructor(e){super(e)}async format(e){return(await this.formatPromptValue(e)).toString()}async formatPromptValue(e){const r=await this.formatMessages(e);return new Ts(r)}}class ut extends Mr{async format(e){return new ua(await this.prompt.format(e))}static fromTemplate(e){return new this(xe.fromTemplate(e))}}class ks extends Mr{async format(e){return new la(await this.prompt.format(e))}static fromTemplate(e){return new this(xe.fromTemplate(e))}}class qt extends Mr{async format(e){return new Ni(await this.prompt.format(e))}static fromTemplate(e){return new this(xe.fromTemplate(e))}}class Ke extends Es{get lc_aliases(){return{promptMessages:"messages"}}constructor(e){if(super(e),Object.defineProperty(this,"promptMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"validateTemplate",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.assign(this,e),this.validateTemplate){const r=new Set;for(const o of this.promptMessages)for(const l of o.inputVariables)r.add(l);const t=new Set(this.partialVariables?this.inputVariables.concat(Object.keys(this.partialVariables)):this.inputVariables),a=new Set([...t].filter(o=>!r.has(o)));if(a.size>0)throw new Error(`Input variables \`${[...a]}\` are not used in any of the prompt messages.`);const i=new Set([...r].filter(o=>!t.has(o)));if(i.size>0)throw new Error(`Input variables \`${[...i]}\` are used in prompt messages but not in the prompt template.`)}}_getPromptType(){return"chat"}async formatMessages(e){const r=await this.mergePartialAndUserVariables(e);let t=[];for(const a of this.promptMessages){const i=a.inputVariables.reduce((l,u)=>{if(!(u in r))throw new Error(`Missing value for input variable \`${u}\``);return l[u]=r[u],l},{}),o=await a.formatMessages(i);t=t.concat(o)}return t}async partial(e){const r={...this};return r.inputVariables=this.inputVariables.filter(t=>!(t in e)),r.partialVariables={...this.partialVariables??{},...e},new Ke(r)}static fromPromptMessages(e){const r=e.reduce((i,o)=>i.concat(o instanceof Ke?o.promptMessages:[o]),[]),t=e.reduce((i,o)=>o instanceof Ke?Object.assign(i,o.partialVariables):i,Object.create(null)),a=new Set;for(const i of r)for(const o of i.inputVariables)o in t||a.add(o);return new Ke({inputVariables:[...a],promptMessages:r,partialVariables:t})}}class Cs{async getPromptAsync(e,r){return this.getPrompt(e).partial((r==null?void 0:r.partialVariables)??{})}}class kt extends Cs{constructor(e,r=[]){super(),Object.defineProperty(this,"defaultPrompt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"conditionals",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.defaultPrompt=e,this.conditionals=r}getPrompt(e){for(const[r,t]of this.conditionals)if(r(e))return t;return this.defaultPrompt}}function Ct(n){return n._modelType()==="base_chat_model"}const xs=new xe({template:`Use the following pieces of context to answer the question at the end. If you don't know the answer, just say that you don't know, don't try to make up an answer.

{context}

Question: {question}
Helpful Answer:`,inputVariables:["context","question"]}),js=`Use the following pieces of context to answer the users question. 
If you don't know the answer, just say that you don't know, don't try to make up an answer.
----------------
{context}`,Ss=[qt.fromTemplate(js),ut.fromTemplate("{question}")],Ns=Ke.fromPromptMessages(Ss),Ds=new kt(xs,[[Ct,Ns]]),Ls=`Use the following portion of a long document to see if any of the text is relevant to answer the question. 
Return any relevant text verbatim.
{context}
Question: {question}
Relevant text, if any:`,Zs=xe.fromTemplate(Ls),Ms=`Use the following portion of a long document to see if any of the text is relevant to answer the question. 
Return any relevant text verbatim.
----------------
{context}`,Rs=[qt.fromTemplate(Ms),ut.fromTemplate("{question}")],Us=Ke.fromPromptMessages(Rs),Vs=new kt(Zs,[[Ct,Us]]),Bs=`Given the following extracted parts of a long document and a question, create a final answer. 
If you don't know the answer, just say that you don't know. Don't try to make up an answer.

QUESTION: Which state/country's law governs the interpretation of the contract?
=========
Content: This Agreement is governed by English law and the parties submit to the exclusive jurisdiction of the English courts in  relation to any dispute (contractual or non-contractual) concerning this Agreement save that either party may apply to any court for an  injunction or other relief to protect its Intellectual Property Rights.

Content: No Waiver. Failure or delay in exercising any right or remedy under this Agreement shall not constitute a waiver of such (or any other)  right or remedy.

11.7 Severability. The invalidity, illegality or unenforceability of any term (or part of a term) of this Agreement shall not affect the continuation  in force of the remainder of the term (if any) and this Agreement.

11.8 No Agency. Except as expressly stated otherwise, nothing in this Agreement shall create an agency, partnership or joint venture of any  kind between the parties.

11.9 No Third-Party Beneficiaries.

Content: (b) if Google believes, in good faith, that the Distributor has violated or caused Google to violate any Anti-Bribery Laws (as  defined in Clause 8.5) or that such a violation is reasonably likely to occur,
=========
FINAL ANSWER: This Agreement is governed by English law.

QUESTION: What did the president say about Michael Jackson?
=========
Content: Madam Speaker, Madam Vice President, our First Lady and Second Gentleman. Members of Congress and the Cabinet. Justices of the Supreme Court. My fellow Americans.  

Last year COVID-19 kept us apart. This year we are finally together again. 

Tonight, we meet as Democrats Republicans and Independents. But most importantly as Americans. 

With a duty to one another to the American people to the Constitution. 

And with an unwavering resolve that freedom will always triumph over tyranny. 

Six days ago, Russias Vladimir Putin sought to shake the foundations of the free world thinking he could make it bend to his menacing ways. But he badly miscalculated. 

He thought he could roll into Ukraine and the world would roll over. Instead he met a wall of strength he never imagined. 

He met the Ukrainian people. 

From President Zelenskyy to every Ukrainian, their fearlessness, their courage, their determination, inspires the world. 

Groups of citizens blocking tanks with their bodies. Everyone from students to retirees teachers turned soldiers defending their homeland.

Content: And we wont stop. 

We have lost so much to COVID-19. Time with one another. And worst of all, so much loss of life. 

Lets use this moment to reset. Lets stop looking at COVID-19 as a partisan dividing line and see it for what it is: A God-awful disease.  

Lets stop seeing each other as enemies, and start seeing each other for who we really are: Fellow Americans.  

We cant change how divided weve been. But we can change how we move forwardon COVID-19 and other issues we must face together. 

I recently visited the New York City Police Department days after the funerals of Officer Wilbert Mora and his partner, Officer Jason Rivera. 

They were responding to a 9-1-1 call when a man shot and killed them with a stolen gun. 

Officer Mora was 27 years old. 

Officer Rivera was 22. 

Both Dominican Americans whod grown up on the same streets they later chose to patrol as police officers. 

I spoke with their families and told them that we are forever in debt for their sacrifice, and we will carry on their mission to restore the trust and safety every community deserves.

Content: And a proud Ukrainian people, who have known 30 years  of independence, have repeatedly shown that they will not tolerate anyone who tries to take their country backwards.  

To all Americans, I will be honest with you, as Ive always promised. A Russian dictator, invading a foreign country, has costs around the world. 

And Im taking robust action to make sure the pain of our sanctions  is targeted at Russias economy. And I will use every tool at our disposal to protect American businesses and consumers. 

Tonight, I can announce that the United States has worked with 30 other countries to release 60 Million barrels of oil from reserves around the world.  

America will lead that effort, releasing 30 Million barrels from our own Strategic Petroleum Reserve. And we stand ready to do more if necessary, unified with our allies.  

These steps will help blunt gas prices here at home. And I know the news about whats happening can seem alarming. 

But I want you to know that we are going to be okay.

Content: More support for patients and families. 

To get there, I call on Congress to fund ARPA-H, the Advanced Research Projects Agency for Health. 

Its based on DARPAthe Defense Department project that led to the Internet, GPS, and so much more.  

ARPA-H will have a singular purposeto drive breakthroughs in cancer, Alzheimers, diabetes, and more. 

A unity agenda for the nation. 

We can do this. 

My fellow Americanstonight , we have gathered in a sacred spacethe citadel of our democracy. 

In this Capitol, generation after generation, Americans have debated great questions amid great strife, and have done great things. 

We have fought for freedom, expanded liberty, defeated totalitarianism and terror. 

And built the strongest, freest, and most prosperous nation the world has ever known. 

Now is the hour. 

Our moment of responsibility. 

Our test of resolve and conscience, of history itself. 

It is in this moment that our character is formed. Our purpose is found. Our future is forged. 

Well I know this nation.
=========
FINAL ANSWER: The president did not mention Michael Jackson.

QUESTION: {question}
=========
{summaries}
=========
FINAL ANSWER:`,Ks=xe.fromTemplate(Bs),zs=`Given the following extracted parts of a long document and a question, create a final answer. 
If you don't know the answer, just say that you don't know. Don't try to make up an answer.
----------------
{summaries}`,$s=[qt.fromTemplate(zs),ut.fromTemplate("{question}")],qs=Ke.fromPromptMessages($s),Fs=new kt(Ks,[[Ct,qs]]),Hs=`The original question is as follows: {question}
We have provided an existing answer: {existing_answer}
We have the opportunity to refine the existing answer
(only if needed) with some more context below.
------------
{context}
------------
Given the new context, refine the original answer to better answer the question. 
If the context isn't useful, return the original answer.`,Ys=new xe({inputVariables:["question","existing_answer","context"],template:Hs}),Ws=`The original question is as follows: {question}
We have provided an existing answer: {existing_answer}
We have the opportunity to refine the existing answer
(only if needed) with some more context below.
------------
{context}
------------
Given the new context, refine the original answer to better answer the question. 
If the context isn't useful, return the original answer.`,Gs=[ut.fromTemplate("{question}"),ks.fromTemplate("{existing_answer}"),ut.fromTemplate(Ws)],Js=Ke.fromPromptMessages(Gs),Qs=new kt(Ys,[[Ct,Js]]),Xs=`Context information is below. 
---------------------
{context}
---------------------
Given the context information and not prior knowledge, answer the question: {question}`,eo=new xe({inputVariables:["context","question"],template:Xs}),to=`Context information is below. 
---------------------
{context}
---------------------
Given the context information and not prior knowledge, answer any questions`,ro=[qt.fromTemplate(to),ut.fromTemplate("{question}")],no=Ke.fromPromptMessages(ro),ao=new kt(eo,[[Ct,no]]),io=(n,e={type:"stuff"})=>{const{type:r}=e;if(r==="stuff")return so(n,e);if(r==="map_reduce")return oo(n,e);if(r==="refine")return uo(n,e);throw new Error(`Invalid _type: ${r}`)};function so(n,e={}){const{prompt:r=Ds.getPrompt(n),verbose:t}=e,a=new Ze({prompt:r,llm:n,verbose:t});return new lt({llmChain:a,verbose:t})}function oo(n,e={}){const{combineMapPrompt:r=Vs.getPrompt(n),combinePrompt:t=Fs.getPrompt(n),verbose:a,returnIntermediateSteps:i}=e,o=new Ze({prompt:r,llm:n,verbose:a}),l=new Ze({prompt:t,llm:n,verbose:a}),u=new lt({llmChain:l,documentVariableName:"summaries",verbose:a});return new zt({llmChain:o,combineDocumentChain:u,returnIntermediateSteps:i,verbose:a})}function uo(n,e={}){const{questionPrompt:r=ao.getPrompt(n),refinePrompt:t=Qs.getPrompt(n),verbose:a}=e,i=new Ze({prompt:r,llm:n,verbose:a}),o=new Ze({prompt:t,llm:n,verbose:a});return new $t({llmChain:i,refineLLMChain:o,verbose:a})}const lo=`Given the following conversation and a follow up question, rephrase the follow up question to be a standalone question.

Chat History:
{chat_history}
Follow Up Input: {question}
Standalone question:`;class Rr extends Et{get inputKeys(){return[this.inputKey,this.chatHistoryKey]}get outputKeys(){return this.combineDocumentsChain.outputKeys.concat(this.returnSourceDocuments?["sourceDocuments"]:[])}constructor(e){super(e),Object.defineProperty(this,"inputKey",{enumerable:!0,configurable:!0,writable:!0,value:"question"}),Object.defineProperty(this,"chatHistoryKey",{enumerable:!0,configurable:!0,writable:!0,value:"chat_history"}),Object.defineProperty(this,"retriever",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"combineDocumentsChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"questionGeneratorChain",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSourceDocuments",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.retriever=e.retriever,this.combineDocumentsChain=e.combineDocumentsChain,this.questionGeneratorChain=e.questionGeneratorChain,this.inputKey=e.inputKey??this.inputKey,this.returnSourceDocuments=e.returnSourceDocuments??this.returnSourceDocuments}static getChatHistoryString(e){return Array.isArray(e)?e.map(r=>r._getType()==="human"?`Human: ${r.content}`:r._getType()==="ai"?`Assistant: ${r.content}`:`${r.content}`).join(`
`):e}async _call(e,r){if(!(this.inputKey in e))throw new Error(`Question key ${this.inputKey} not found.`);if(!(this.chatHistoryKey in e))throw new Error(`Chat history key ${this.chatHistoryKey} not found.`);const t=e[this.inputKey],a=Rr.getChatHistoryString(e[this.chatHistoryKey]);let i=t;if(a.length>0){const d=await this.questionGeneratorChain.call({question:t,chat_history:a},r==null?void 0:r.getChild("question_generator")),w=Object.keys(d);if(w.length===1)i=d[w[0]];else throw new Error("Return from llm chain has multiple values, only single values supported.")}const o=await this.retriever.getRelevantDocuments(i),l={question:i,input_documents:o,chat_history:a},u=await this.combineDocumentsChain.call(l,r==null?void 0:r.getChild("combine_documents"));return this.returnSourceDocuments?{...u,sourceDocuments:o}:u}_chainType(){return"conversational_retrieval_chain"}static async deserialize(e,r){throw new Error("Not implemented.")}serialize(){throw new Error("Not implemented.")}static fromLLM(e,r,t={}){const{questionGeneratorTemplate:a,qaTemplate:i,qaChainOptions:o={type:"stuff",prompt:i?xe.fromTemplate(i):void 0},questionGeneratorChainOptions:l,verbose:u,...d}=t,w=io(e,o),j=xe.fromTemplate((l==null?void 0:l.template)??a??lo),U=new Ze({prompt:j,llm:(l==null?void 0:l.llm)??e,verbose:u});return new this({retriever:r,combineDocumentsChain:w,questionGeneratorChain:U,verbose:u,...d})}}var co={},Ft={},ct={},hr={},pr={},ze={},Lt={},fr={},fn;function Ht(){return fn||(fn=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.getParsedType=n.ZodParsedType=n.objectUtil=n.util=void 0;var e;(function(t){t.assertEqual=l=>l;function a(l){}t.assertIs=a;function i(l){throw new Error}t.assertNever=i,t.arrayToEnum=l=>{const u={};for(const d of l)u[d]=d;return u},t.getValidEnumValues=l=>{const u=t.objectKeys(l).filter(w=>typeof l[l[w]]!="number"),d={};for(const w of u)d[w]=l[w];return t.objectValues(d)},t.objectValues=l=>t.objectKeys(l).map(function(u){return l[u]}),t.objectKeys=typeof Object.keys=="function"?l=>Object.keys(l):l=>{const u=[];for(const d in l)Object.prototype.hasOwnProperty.call(l,d)&&u.push(d);return u},t.find=(l,u)=>{for(const d of l)if(u(d))return d},t.isInteger=typeof Number.isInteger=="function"?l=>Number.isInteger(l):l=>typeof l=="number"&&isFinite(l)&&Math.floor(l)===l;function o(l,u=" | "){return l.map(d=>typeof d=="string"?`'${d}'`:d).join(u)}t.joinValues=o,t.jsonStringifyReplacer=(l,u)=>typeof u=="bigint"?u.toString():u})(e=n.util||(n.util={})),function(t){t.mergeShapes=(a,i)=>({...a,...i})}(n.objectUtil||(n.objectUtil={})),n.ZodParsedType=e.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]);const r=t=>{switch(typeof t){case"undefined":return n.ZodParsedType.undefined;case"string":return n.ZodParsedType.string;case"number":return isNaN(t)?n.ZodParsedType.nan:n.ZodParsedType.number;case"boolean":return n.ZodParsedType.boolean;case"function":return n.ZodParsedType.function;case"bigint":return n.ZodParsedType.bigint;case"symbol":return n.ZodParsedType.symbol;case"object":return Array.isArray(t)?n.ZodParsedType.array:t===null?n.ZodParsedType.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?n.ZodParsedType.promise:typeof Map<"u"&&t instanceof Map?n.ZodParsedType.map:typeof Set<"u"&&t instanceof Set?n.ZodParsedType.set:typeof Date<"u"&&t instanceof Date?n.ZodParsedType.date:n.ZodParsedType.object;default:return n.ZodParsedType.unknown}};n.getParsedType=r}(fr)),fr}var $e={},mn;function Ur(){if(mn)return $e;mn=1,Object.defineProperty($e,"__esModule",{value:!0}),$e.ZodError=$e.quotelessJson=$e.ZodIssueCode=void 0;const n=Ht();$e.ZodIssueCode=n.util.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);const e=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:");$e.quotelessJson=e;let r=class extends Error{constructor(a){super(),this.issues=[],this.addIssue=o=>{this.issues=[...this.issues,o]},this.addIssues=(o=[])=>{this.issues=[...this.issues,...o]};const i=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,i):this.__proto__=i,this.name="ZodError",this.issues=a}get errors(){return this.issues}format(a){const i=a||function(u){return u.message},o={_errors:[]},l=u=>{for(const d of u.issues)if(d.code==="invalid_union")d.unionErrors.map(l);else if(d.code==="invalid_return_type")l(d.returnTypeError);else if(d.code==="invalid_arguments")l(d.argumentsError);else if(d.path.length===0)o._errors.push(i(d));else{let w=o,j=0;for(;j<d.path.length;){const U=d.path[j];j===d.path.length-1?(w[U]=w[U]||{_errors:[]},w[U]._errors.push(i(d))):w[U]=w[U]||{_errors:[]},w=w[U],j++}}};return l(this),o}toString(){return this.message}get message(){return JSON.stringify(this.issues,n.util.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(a=i=>i.message){const i={},o=[];for(const l of this.issues)l.path.length>0?(i[l.path[0]]=i[l.path[0]]||[],i[l.path[0]].push(a(l))):o.push(a(l));return{formErrors:o,fieldErrors:i}}get formErrors(){return this.flatten()}};return $e.ZodError=r,r.create=t=>new r(t),$e}var yn;function Pa(){if(yn)return Lt;yn=1,Object.defineProperty(Lt,"__esModule",{value:!0});const n=Ht(),e=Ur(),r=(t,a)=>{let i;switch(t.code){case e.ZodIssueCode.invalid_type:t.received===n.ZodParsedType.undefined?i="Required":i=`Expected ${t.expected}, received ${t.received}`;break;case e.ZodIssueCode.invalid_literal:i=`Invalid literal value, expected ${JSON.stringify(t.expected,n.util.jsonStringifyReplacer)}`;break;case e.ZodIssueCode.unrecognized_keys:i=`Unrecognized key(s) in object: ${n.util.joinValues(t.keys,", ")}`;break;case e.ZodIssueCode.invalid_union:i="Invalid input";break;case e.ZodIssueCode.invalid_union_discriminator:i=`Invalid discriminator value. Expected ${n.util.joinValues(t.options)}`;break;case e.ZodIssueCode.invalid_enum_value:i=`Invalid enum value. Expected ${n.util.joinValues(t.options)}, received '${t.received}'`;break;case e.ZodIssueCode.invalid_arguments:i="Invalid function arguments";break;case e.ZodIssueCode.invalid_return_type:i="Invalid function return type";break;case e.ZodIssueCode.invalid_date:i="Invalid date";break;case e.ZodIssueCode.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(i=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(i=`${i} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?i=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?i=`Invalid input: must end with "${t.validation.endsWith}"`:n.util.assertNever(t.validation):t.validation!=="regex"?i=`Invalid ${t.validation}`:i="Invalid";break;case e.ZodIssueCode.too_small:t.type==="array"?i=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?i=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?i=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?i=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:i="Invalid input";break;case e.ZodIssueCode.too_big:t.type==="array"?i=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?i=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?i=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?i=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?i=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:i="Invalid input";break;case e.ZodIssueCode.custom:i="Invalid input";break;case e.ZodIssueCode.invalid_intersection_types:i="Intersection results could not be merged";break;case e.ZodIssueCode.not_multiple_of:i=`Number must be a multiple of ${t.multipleOf}`;break;case e.ZodIssueCode.not_finite:i="Number must be finite";break;default:i=a.defaultError,n.util.assertNever(t)}return{message:i}};return Lt.default=r,Lt}var gn;function Vr(){if(gn)return ze;gn=1;var n=Te&&Te.__importDefault||function(i){return i&&i.__esModule?i:{default:i}};Object.defineProperty(ze,"__esModule",{value:!0}),ze.getErrorMap=ze.setErrorMap=ze.defaultErrorMap=void 0;const e=n(Pa());ze.defaultErrorMap=e.default;let r=e.default;function t(i){r=i}ze.setErrorMap=t;function a(){return r}return ze.getErrorMap=a,ze}var mr={},bn;function Oa(){return bn||(bn=1,function(n){var e=Te&&Te.__importDefault||function(B){return B&&B.__esModule?B:{default:B}};Object.defineProperty(n,"__esModule",{value:!0}),n.isAsync=n.isValid=n.isDirty=n.isAborted=n.OK=n.DIRTY=n.INVALID=n.ParseStatus=n.addIssueToContext=n.EMPTY_PATH=n.makeIssue=void 0;const r=Vr(),t=e(Pa()),a=B=>{const{data:k,path:M,errorMaps:P,issueData:S}=B,D=[...M,...S.path||[]],N={...S,path:D};let C="";const H=P.filter(I=>!!I).slice().reverse();for(const I of H)C=I(N,{data:k,defaultError:C}).message;return{...S,path:D,message:S.message||C}};n.makeIssue=a,n.EMPTY_PATH=[];function i(B,k){const M=(0,n.makeIssue)({issueData:k,data:B.data,path:B.path,errorMaps:[B.common.contextualErrorMap,B.schemaErrorMap,(0,r.getErrorMap)(),t.default].filter(P=>!!P)});B.common.issues.push(M)}n.addIssueToContext=i;class o{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(k,M){const P=[];for(const S of M){if(S.status==="aborted")return n.INVALID;S.status==="dirty"&&k.dirty(),P.push(S.value)}return{status:k.value,value:P}}static async mergeObjectAsync(k,M){const P=[];for(const S of M)P.push({key:await S.key,value:await S.value});return o.mergeObjectSync(k,P)}static mergeObjectSync(k,M){const P={};for(const S of M){const{key:D,value:N}=S;if(D.status==="aborted"||N.status==="aborted")return n.INVALID;D.status==="dirty"&&k.dirty(),N.status==="dirty"&&k.dirty(),(typeof N.value<"u"||S.alwaysSet)&&(P[D.value]=N.value)}return{status:k.value,value:P}}}n.ParseStatus=o,n.INVALID=Object.freeze({status:"aborted"});const l=B=>({status:"dirty",value:B});n.DIRTY=l;const u=B=>({status:"valid",value:B});n.OK=u;const d=B=>B.status==="aborted";n.isAborted=d;const w=B=>B.status==="dirty";n.isDirty=w;const j=B=>B.status==="valid";n.isValid=j;const U=B=>typeof Promise<"u"&&B instanceof Promise;n.isAsync=U}(mr)),mr}var yr={},_n;function ho(){return _n||(_n=1,Object.defineProperty(yr,"__esModule",{value:!0})),yr}var gr={},br={},vn;function po(){return vn||(vn=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.errorUtil=void 0,function(e){e.errToObj=r=>typeof r=="string"?{message:r}:r||{},e.toString=r=>typeof r=="string"?r:r==null?void 0:r.message}(n.errorUtil||(n.errorUtil={}))}(br)),br}var wn;function fo(){return wn||(wn=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.discriminatedUnion=n.date=n.boolean=n.bigint=n.array=n.any=n.coerce=n.ZodFirstPartyTypeKind=n.late=n.ZodSchema=n.Schema=n.custom=n.ZodPipeline=n.ZodBranded=n.BRAND=n.ZodNaN=n.ZodCatch=n.ZodDefault=n.ZodNullable=n.ZodOptional=n.ZodTransformer=n.ZodEffects=n.ZodPromise=n.ZodNativeEnum=n.ZodEnum=n.ZodLiteral=n.ZodLazy=n.ZodFunction=n.ZodSet=n.ZodMap=n.ZodRecord=n.ZodTuple=n.ZodIntersection=n.ZodDiscriminatedUnion=n.ZodUnion=n.ZodObject=n.ZodArray=n.ZodVoid=n.ZodNever=n.ZodUnknown=n.ZodAny=n.ZodNull=n.ZodUndefined=n.ZodSymbol=n.ZodDate=n.ZodBoolean=n.ZodBigInt=n.ZodNumber=n.ZodString=n.ZodType=void 0,n.NEVER=n.void=n.unknown=n.union=n.undefined=n.tuple=n.transformer=n.symbol=n.string=n.strictObject=n.set=n.record=n.promise=n.preprocess=n.pipeline=n.ostring=n.optional=n.onumber=n.oboolean=n.object=n.number=n.nullable=n.null=n.never=n.nativeEnum=n.nan=n.map=n.literal=n.lazy=n.intersection=n.instanceof=n.function=n.enum=n.effect=void 0;const e=Vr(),r=po(),t=Oa(),a=Ht(),i=Ur();class o{constructor(s,c,p,v){this._cachedPath=[],this.parent=s,this.data=c,this._path=p,this._key=v}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const l=(b,s)=>{if((0,t.isValid)(s))return{success:!0,data:s.value};if(!b.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const c=new i.ZodError(b.common.issues);return this._error=c,this._error}}};function u(b){if(!b)return{};const{errorMap:s,invalid_type_error:c,required_error:p,description:v}=b;if(s&&(c||p))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return s?{errorMap:s,description:v}:{errorMap:(z,L)=>z.code!=="invalid_type"?{message:L.defaultError}:typeof L.data>"u"?{message:p??L.defaultError}:{message:c??L.defaultError},description:v}}class d{constructor(s){this.spa=this.safeParseAsync,this._def=s,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(s){return(0,a.getParsedType)(s.data)}_getOrReturnCtx(s,c){return c||{common:s.parent.common,data:s.data,parsedType:(0,a.getParsedType)(s.data),schemaErrorMap:this._def.errorMap,path:s.path,parent:s.parent}}_processInputParams(s){return{status:new t.ParseStatus,ctx:{common:s.parent.common,data:s.data,parsedType:(0,a.getParsedType)(s.data),schemaErrorMap:this._def.errorMap,path:s.path,parent:s.parent}}}_parseSync(s){const c=this._parse(s);if((0,t.isAsync)(c))throw new Error("Synchronous parse encountered promise.");return c}_parseAsync(s){const c=this._parse(s);return Promise.resolve(c)}parse(s,c){const p=this.safeParse(s,c);if(p.success)return p.data;throw p.error}safeParse(s,c){var p;const v={common:{issues:[],async:(p=c==null?void 0:c.async)!==null&&p!==void 0?p:!1,contextualErrorMap:c==null?void 0:c.errorMap},path:(c==null?void 0:c.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:s,parsedType:(0,a.getParsedType)(s)},_=this._parseSync({data:s,path:v.path,parent:v});return l(v,_)}async parseAsync(s,c){const p=await this.safeParseAsync(s,c);if(p.success)return p.data;throw p.error}async safeParseAsync(s,c){const p={common:{issues:[],contextualErrorMap:c==null?void 0:c.errorMap,async:!0},path:(c==null?void 0:c.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:s,parsedType:(0,a.getParsedType)(s)},v=this._parse({data:s,path:p.path,parent:p}),_=await((0,t.isAsync)(v)?v:Promise.resolve(v));return l(p,_)}refine(s,c){const p=v=>typeof c=="string"||typeof c>"u"?{message:c}:typeof c=="function"?c(v):c;return this._refinement((v,_)=>{const z=s(v),L=()=>_.addIssue({code:i.ZodIssueCode.custom,...p(v)});return typeof Promise<"u"&&z instanceof Promise?z.then(X=>X?!0:(L(),!1)):z?!0:(L(),!1)})}refinement(s,c){return this._refinement((p,v)=>s(p)?!0:(v.addIssue(typeof c=="function"?c(p,v):c),!1))}_refinement(s){return new me({schema:this,typeName:ne.ZodEffects,effect:{type:"refinement",refinement:s}})}superRefine(s){return this._refinement(s)}optional(){return ye.create(this,this._def)}nullable(){return Oe.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Q.create(this,this._def)}promise(){return ie.create(this,this._def)}or(s){return $.create([this,s],this._def)}and(s){return Z.create(this,s,this._def)}transform(s){return new me({...u(this._def),schema:this,typeName:ne.ZodEffects,effect:{type:"transform",transform:s}})}default(s){const c=typeof s=="function"?s:()=>s;return new Pe({...u(this._def),innerType:this,defaultValue:c,typeName:ne.ZodDefault})}brand(){return new Ie({typeName:ne.ZodBranded,type:this,...u(this._def)})}catch(s){const c=typeof s=="function"?s:()=>s;return new Ae({...u(this._def),innerType:this,catchValue:c,typeName:ne.ZodCatch})}describe(s){const c=this.constructor;return new c({...this._def,description:s})}pipe(s){return Re.create(this,s)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}n.ZodType=d,n.Schema=d,n.ZodSchema=d;const w=/^c[^\s-]{8,}$/i,j=/^[a-z][a-z0-9]*$/,U=/[0-9A-HJKMNP-TV-Z]{26}/,B=/^([a-f0-9]{8}-[a-f0-9]{4}-[1-5][a-f0-9]{3}-[a-f0-9]{4}-[a-f0-9]{12}|00000000-0000-0000-0000-000000000000)$/i,k=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\])|(\[IPv6:(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))\])|([A-Za-z0-9]([A-Za-z0-9-]*[A-Za-z0-9])*(\.[A-Za-z]{2,})+))$/,M=/^(\p{Extended_Pictographic}|\p{Emoji_Component})+$/u,P=/^(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))$/,S=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,D=b=>b.precision?b.offset?new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${b.precision}}(([+-]\\d{2}(:?\\d{2})?)|Z)$`):new RegExp(`^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{${b.precision}}Z$`):b.precision===0?b.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}Z$"):b.offset?new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?(([+-]\\d{2}(:?\\d{2})?)|Z)$"):new RegExp("^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d+)?Z$");function N(b,s){return!!((s==="v4"||!s)&&P.test(b)||(s==="v6"||!s)&&S.test(b))}class C extends d{constructor(){super(...arguments),this._regex=(s,c,p)=>this.refinement(v=>s.test(v),{validation:c,code:i.ZodIssueCode.invalid_string,...r.errorUtil.errToObj(p)}),this.nonempty=s=>this.min(1,r.errorUtil.errToObj(s)),this.trim=()=>new C({...this._def,checks:[...this._def.checks,{kind:"trim"}]}),this.toLowerCase=()=>new C({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]}),this.toUpperCase=()=>new C({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}_parse(s){if(this._def.coerce&&(s.data=String(s.data)),this._getType(s)!==a.ZodParsedType.string){const _=this._getOrReturnCtx(s);return(0,t.addIssueToContext)(_,{code:i.ZodIssueCode.invalid_type,expected:a.ZodParsedType.string,received:_.parsedType}),t.INVALID}const p=new t.ParseStatus;let v;for(const _ of this._def.checks)if(_.kind==="min")s.data.length<_.value&&(v=this._getOrReturnCtx(s,v),(0,t.addIssueToContext)(v,{code:i.ZodIssueCode.too_small,minimum:_.value,type:"string",inclusive:!0,exact:!1,message:_.message}),p.dirty());else if(_.kind==="max")s.data.length>_.value&&(v=this._getOrReturnCtx(s,v),(0,t.addIssueToContext)(v,{code:i.ZodIssueCode.too_big,maximum:_.value,type:"string",inclusive:!0,exact:!1,message:_.message}),p.dirty());else if(_.kind==="length"){const z=s.data.length>_.value,L=s.data.length<_.value;(z||L)&&(v=this._getOrReturnCtx(s,v),z?(0,t.addIssueToContext)(v,{code:i.ZodIssueCode.too_big,maximum:_.value,type:"string",inclusive:!0,exact:!0,message:_.message}):L&&(0,t.addIssueToContext)(v,{code:i.ZodIssueCode.too_small,minimum:_.value,type:"string",inclusive:!0,exact:!0,message:_.message}),p.dirty())}else if(_.kind==="email")k.test(s.data)||(v=this._getOrReturnCtx(s,v),(0,t.addIssueToContext)(v,{validation:"email",code:i.ZodIssueCode.invalid_string,message:_.message}),p.dirty());else if(_.kind==="emoji")M.test(s.data)||(v=this._getOrReturnCtx(s,v),(0,t.addIssueToContext)(v,{validation:"emoji",code:i.ZodIssueCode.invalid_string,message:_.message}),p.dirty());else if(_.kind==="uuid")B.test(s.data)||(v=this._getOrReturnCtx(s,v),(0,t.addIssueToContext)(v,{validation:"uuid",code:i.ZodIssueCode.invalid_string,message:_.message}),p.dirty());else if(_.kind==="cuid")w.test(s.data)||(v=this._getOrReturnCtx(s,v),(0,t.addIssueToContext)(v,{validation:"cuid",code:i.ZodIssueCode.invalid_string,message:_.message}),p.dirty());else if(_.kind==="cuid2")j.test(s.data)||(v=this._getOrReturnCtx(s,v),(0,t.addIssueToContext)(v,{validation:"cuid2",code:i.ZodIssueCode.invalid_string,message:_.message}),p.dirty());else if(_.kind==="ulid")U.test(s.data)||(v=this._getOrReturnCtx(s,v),(0,t.addIssueToContext)(v,{validation:"ulid",code:i.ZodIssueCode.invalid_string,message:_.message}),p.dirty());else if(_.kind==="url")try{new URL(s.data)}catch{v=this._getOrReturnCtx(s,v),(0,t.addIssueToContext)(v,{validation:"url",code:i.ZodIssueCode.invalid_string,message:_.message}),p.dirty()}else _.kind==="regex"?(_.regex.lastIndex=0,_.regex.test(s.data)||(v=this._getOrReturnCtx(s,v),(0,t.addIssueToContext)(v,{validation:"regex",code:i.ZodIssueCode.invalid_string,message:_.message}),p.dirty())):_.kind==="trim"?s.data=s.data.trim():_.kind==="includes"?s.data.includes(_.value,_.position)||(v=this._getOrReturnCtx(s,v),(0,t.addIssueToContext)(v,{code:i.ZodIssueCode.invalid_string,validation:{includes:_.value,position:_.position},message:_.message}),p.dirty()):_.kind==="toLowerCase"?s.data=s.data.toLowerCase():_.kind==="toUpperCase"?s.data=s.data.toUpperCase():_.kind==="startsWith"?s.data.startsWith(_.value)||(v=this._getOrReturnCtx(s,v),(0,t.addIssueToContext)(v,{code:i.ZodIssueCode.invalid_string,validation:{startsWith:_.value},message:_.message}),p.dirty()):_.kind==="endsWith"?s.data.endsWith(_.value)||(v=this._getOrReturnCtx(s,v),(0,t.addIssueToContext)(v,{code:i.ZodIssueCode.invalid_string,validation:{endsWith:_.value},message:_.message}),p.dirty()):_.kind==="datetime"?D(_).test(s.data)||(v=this._getOrReturnCtx(s,v),(0,t.addIssueToContext)(v,{code:i.ZodIssueCode.invalid_string,validation:"datetime",message:_.message}),p.dirty()):_.kind==="ip"?N(s.data,_.version)||(v=this._getOrReturnCtx(s,v),(0,t.addIssueToContext)(v,{validation:"ip",code:i.ZodIssueCode.invalid_string,message:_.message}),p.dirty()):a.util.assertNever(_);return{status:p.value,value:s.data}}_addCheck(s){return new C({...this._def,checks:[...this._def.checks,s]})}email(s){return this._addCheck({kind:"email",...r.errorUtil.errToObj(s)})}url(s){return this._addCheck({kind:"url",...r.errorUtil.errToObj(s)})}emoji(s){return this._addCheck({kind:"emoji",...r.errorUtil.errToObj(s)})}uuid(s){return this._addCheck({kind:"uuid",...r.errorUtil.errToObj(s)})}cuid(s){return this._addCheck({kind:"cuid",...r.errorUtil.errToObj(s)})}cuid2(s){return this._addCheck({kind:"cuid2",...r.errorUtil.errToObj(s)})}ulid(s){return this._addCheck({kind:"ulid",...r.errorUtil.errToObj(s)})}ip(s){return this._addCheck({kind:"ip",...r.errorUtil.errToObj(s)})}datetime(s){var c;return typeof s=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,message:s}):this._addCheck({kind:"datetime",precision:typeof(s==null?void 0:s.precision)>"u"?null:s==null?void 0:s.precision,offset:(c=s==null?void 0:s.offset)!==null&&c!==void 0?c:!1,...r.errorUtil.errToObj(s==null?void 0:s.message)})}regex(s,c){return this._addCheck({kind:"regex",regex:s,...r.errorUtil.errToObj(c)})}includes(s,c){return this._addCheck({kind:"includes",value:s,position:c==null?void 0:c.position,...r.errorUtil.errToObj(c==null?void 0:c.message)})}startsWith(s,c){return this._addCheck({kind:"startsWith",value:s,...r.errorUtil.errToObj(c)})}endsWith(s,c){return this._addCheck({kind:"endsWith",value:s,...r.errorUtil.errToObj(c)})}min(s,c){return this._addCheck({kind:"min",value:s,...r.errorUtil.errToObj(c)})}max(s,c){return this._addCheck({kind:"max",value:s,...r.errorUtil.errToObj(c)})}length(s,c){return this._addCheck({kind:"length",value:s,...r.errorUtil.errToObj(c)})}get isDatetime(){return!!this._def.checks.find(s=>s.kind==="datetime")}get isEmail(){return!!this._def.checks.find(s=>s.kind==="email")}get isURL(){return!!this._def.checks.find(s=>s.kind==="url")}get isEmoji(){return!!this._def.checks.find(s=>s.kind==="emoji")}get isUUID(){return!!this._def.checks.find(s=>s.kind==="uuid")}get isCUID(){return!!this._def.checks.find(s=>s.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(s=>s.kind==="cuid2")}get isULID(){return!!this._def.checks.find(s=>s.kind==="ulid")}get isIP(){return!!this._def.checks.find(s=>s.kind==="ip")}get minLength(){let s=null;for(const c of this._def.checks)c.kind==="min"&&(s===null||c.value>s)&&(s=c.value);return s}get maxLength(){let s=null;for(const c of this._def.checks)c.kind==="max"&&(s===null||c.value<s)&&(s=c.value);return s}}n.ZodString=C,C.create=b=>{var s;return new C({checks:[],typeName:ne.ZodString,coerce:(s=b==null?void 0:b.coerce)!==null&&s!==void 0?s:!1,...u(b)})};function H(b,s){const c=(b.toString().split(".")[1]||"").length,p=(s.toString().split(".")[1]||"").length,v=c>p?c:p,_=parseInt(b.toFixed(v).replace(".","")),z=parseInt(s.toFixed(v).replace(".",""));return _%z/Math.pow(10,v)}class I extends d{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(s){if(this._def.coerce&&(s.data=Number(s.data)),this._getType(s)!==a.ZodParsedType.number){const _=this._getOrReturnCtx(s);return(0,t.addIssueToContext)(_,{code:i.ZodIssueCode.invalid_type,expected:a.ZodParsedType.number,received:_.parsedType}),t.INVALID}let p;const v=new t.ParseStatus;for(const _ of this._def.checks)_.kind==="int"?a.util.isInteger(s.data)||(p=this._getOrReturnCtx(s,p),(0,t.addIssueToContext)(p,{code:i.ZodIssueCode.invalid_type,expected:"integer",received:"float",message:_.message}),v.dirty()):_.kind==="min"?(_.inclusive?s.data<_.value:s.data<=_.value)&&(p=this._getOrReturnCtx(s,p),(0,t.addIssueToContext)(p,{code:i.ZodIssueCode.too_small,minimum:_.value,type:"number",inclusive:_.inclusive,exact:!1,message:_.message}),v.dirty()):_.kind==="max"?(_.inclusive?s.data>_.value:s.data>=_.value)&&(p=this._getOrReturnCtx(s,p),(0,t.addIssueToContext)(p,{code:i.ZodIssueCode.too_big,maximum:_.value,type:"number",inclusive:_.inclusive,exact:!1,message:_.message}),v.dirty()):_.kind==="multipleOf"?H(s.data,_.value)!==0&&(p=this._getOrReturnCtx(s,p),(0,t.addIssueToContext)(p,{code:i.ZodIssueCode.not_multiple_of,multipleOf:_.value,message:_.message}),v.dirty()):_.kind==="finite"?Number.isFinite(s.data)||(p=this._getOrReturnCtx(s,p),(0,t.addIssueToContext)(p,{code:i.ZodIssueCode.not_finite,message:_.message}),v.dirty()):a.util.assertNever(_);return{status:v.value,value:s.data}}gte(s,c){return this.setLimit("min",s,!0,r.errorUtil.toString(c))}gt(s,c){return this.setLimit("min",s,!1,r.errorUtil.toString(c))}lte(s,c){return this.setLimit("max",s,!0,r.errorUtil.toString(c))}lt(s,c){return this.setLimit("max",s,!1,r.errorUtil.toString(c))}setLimit(s,c,p,v){return new I({...this._def,checks:[...this._def.checks,{kind:s,value:c,inclusive:p,message:r.errorUtil.toString(v)}]})}_addCheck(s){return new I({...this._def,checks:[...this._def.checks,s]})}int(s){return this._addCheck({kind:"int",message:r.errorUtil.toString(s)})}positive(s){return this._addCheck({kind:"min",value:0,inclusive:!1,message:r.errorUtil.toString(s)})}negative(s){return this._addCheck({kind:"max",value:0,inclusive:!1,message:r.errorUtil.toString(s)})}nonpositive(s){return this._addCheck({kind:"max",value:0,inclusive:!0,message:r.errorUtil.toString(s)})}nonnegative(s){return this._addCheck({kind:"min",value:0,inclusive:!0,message:r.errorUtil.toString(s)})}multipleOf(s,c){return this._addCheck({kind:"multipleOf",value:s,message:r.errorUtil.toString(c)})}finite(s){return this._addCheck({kind:"finite",message:r.errorUtil.toString(s)})}safe(s){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:r.errorUtil.toString(s)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:r.errorUtil.toString(s)})}get minValue(){let s=null;for(const c of this._def.checks)c.kind==="min"&&(s===null||c.value>s)&&(s=c.value);return s}get maxValue(){let s=null;for(const c of this._def.checks)c.kind==="max"&&(s===null||c.value<s)&&(s=c.value);return s}get isInt(){return!!this._def.checks.find(s=>s.kind==="int"||s.kind==="multipleOf"&&a.util.isInteger(s.value))}get isFinite(){let s=null,c=null;for(const p of this._def.checks){if(p.kind==="finite"||p.kind==="int"||p.kind==="multipleOf")return!0;p.kind==="min"?(c===null||p.value>c)&&(c=p.value):p.kind==="max"&&(s===null||p.value<s)&&(s=p.value)}return Number.isFinite(c)&&Number.isFinite(s)}}n.ZodNumber=I,I.create=b=>new I({checks:[],typeName:ne.ZodNumber,coerce:(b==null?void 0:b.coerce)||!1,...u(b)});class E extends d{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(s){if(this._def.coerce&&(s.data=BigInt(s.data)),this._getType(s)!==a.ZodParsedType.bigint){const _=this._getOrReturnCtx(s);return(0,t.addIssueToContext)(_,{code:i.ZodIssueCode.invalid_type,expected:a.ZodParsedType.bigint,received:_.parsedType}),t.INVALID}let p;const v=new t.ParseStatus;for(const _ of this._def.checks)_.kind==="min"?(_.inclusive?s.data<_.value:s.data<=_.value)&&(p=this._getOrReturnCtx(s,p),(0,t.addIssueToContext)(p,{code:i.ZodIssueCode.too_small,type:"bigint",minimum:_.value,inclusive:_.inclusive,message:_.message}),v.dirty()):_.kind==="max"?(_.inclusive?s.data>_.value:s.data>=_.value)&&(p=this._getOrReturnCtx(s,p),(0,t.addIssueToContext)(p,{code:i.ZodIssueCode.too_big,type:"bigint",maximum:_.value,inclusive:_.inclusive,message:_.message}),v.dirty()):_.kind==="multipleOf"?s.data%_.value!==BigInt(0)&&(p=this._getOrReturnCtx(s,p),(0,t.addIssueToContext)(p,{code:i.ZodIssueCode.not_multiple_of,multipleOf:_.value,message:_.message}),v.dirty()):a.util.assertNever(_);return{status:v.value,value:s.data}}gte(s,c){return this.setLimit("min",s,!0,r.errorUtil.toString(c))}gt(s,c){return this.setLimit("min",s,!1,r.errorUtil.toString(c))}lte(s,c){return this.setLimit("max",s,!0,r.errorUtil.toString(c))}lt(s,c){return this.setLimit("max",s,!1,r.errorUtil.toString(c))}setLimit(s,c,p,v){return new E({...this._def,checks:[...this._def.checks,{kind:s,value:c,inclusive:p,message:r.errorUtil.toString(v)}]})}_addCheck(s){return new E({...this._def,checks:[...this._def.checks,s]})}positive(s){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:r.errorUtil.toString(s)})}negative(s){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:r.errorUtil.toString(s)})}nonpositive(s){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:r.errorUtil.toString(s)})}nonnegative(s){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:r.errorUtil.toString(s)})}multipleOf(s,c){return this._addCheck({kind:"multipleOf",value:s,message:r.errorUtil.toString(c)})}get minValue(){let s=null;for(const c of this._def.checks)c.kind==="min"&&(s===null||c.value>s)&&(s=c.value);return s}get maxValue(){let s=null;for(const c of this._def.checks)c.kind==="max"&&(s===null||c.value<s)&&(s=c.value);return s}}n.ZodBigInt=E,E.create=b=>{var s;return new E({checks:[],typeName:ne.ZodBigInt,coerce:(s=b==null?void 0:b.coerce)!==null&&s!==void 0?s:!1,...u(b)})};class m extends d{_parse(s){if(this._def.coerce&&(s.data=!!s.data),this._getType(s)!==a.ZodParsedType.boolean){const p=this._getOrReturnCtx(s);return(0,t.addIssueToContext)(p,{code:i.ZodIssueCode.invalid_type,expected:a.ZodParsedType.boolean,received:p.parsedType}),t.INVALID}return(0,t.OK)(s.data)}}n.ZodBoolean=m,m.create=b=>new m({typeName:ne.ZodBoolean,coerce:(b==null?void 0:b.coerce)||!1,...u(b)});class g extends d{_parse(s){if(this._def.coerce&&(s.data=new Date(s.data)),this._getType(s)!==a.ZodParsedType.date){const _=this._getOrReturnCtx(s);return(0,t.addIssueToContext)(_,{code:i.ZodIssueCode.invalid_type,expected:a.ZodParsedType.date,received:_.parsedType}),t.INVALID}if(isNaN(s.data.getTime())){const _=this._getOrReturnCtx(s);return(0,t.addIssueToContext)(_,{code:i.ZodIssueCode.invalid_date}),t.INVALID}const p=new t.ParseStatus;let v;for(const _ of this._def.checks)_.kind==="min"?s.data.getTime()<_.value&&(v=this._getOrReturnCtx(s,v),(0,t.addIssueToContext)(v,{code:i.ZodIssueCode.too_small,message:_.message,inclusive:!0,exact:!1,minimum:_.value,type:"date"}),p.dirty()):_.kind==="max"?s.data.getTime()>_.value&&(v=this._getOrReturnCtx(s,v),(0,t.addIssueToContext)(v,{code:i.ZodIssueCode.too_big,message:_.message,inclusive:!0,exact:!1,maximum:_.value,type:"date"}),p.dirty()):a.util.assertNever(_);return{status:p.value,value:new Date(s.data.getTime())}}_addCheck(s){return new g({...this._def,checks:[...this._def.checks,s]})}min(s,c){return this._addCheck({kind:"min",value:s.getTime(),message:r.errorUtil.toString(c)})}max(s,c){return this._addCheck({kind:"max",value:s.getTime(),message:r.errorUtil.toString(c)})}get minDate(){let s=null;for(const c of this._def.checks)c.kind==="min"&&(s===null||c.value>s)&&(s=c.value);return s!=null?new Date(s):null}get maxDate(){let s=null;for(const c of this._def.checks)c.kind==="max"&&(s===null||c.value<s)&&(s=c.value);return s!=null?new Date(s):null}}n.ZodDate=g,g.create=b=>new g({checks:[],coerce:(b==null?void 0:b.coerce)||!1,typeName:ne.ZodDate,...u(b)});class f extends d{_parse(s){if(this._getType(s)!==a.ZodParsedType.symbol){const p=this._getOrReturnCtx(s);return(0,t.addIssueToContext)(p,{code:i.ZodIssueCode.invalid_type,expected:a.ZodParsedType.symbol,received:p.parsedType}),t.INVALID}return(0,t.OK)(s.data)}}n.ZodSymbol=f,f.create=b=>new f({typeName:ne.ZodSymbol,...u(b)});class A extends d{_parse(s){if(this._getType(s)!==a.ZodParsedType.undefined){const p=this._getOrReturnCtx(s);return(0,t.addIssueToContext)(p,{code:i.ZodIssueCode.invalid_type,expected:a.ZodParsedType.undefined,received:p.parsedType}),t.INVALID}return(0,t.OK)(s.data)}}n.ZodUndefined=A,A.create=b=>new A({typeName:ne.ZodUndefined,...u(b)});class T extends d{_parse(s){if(this._getType(s)!==a.ZodParsedType.null){const p=this._getOrReturnCtx(s);return(0,t.addIssueToContext)(p,{code:i.ZodIssueCode.invalid_type,expected:a.ZodParsedType.null,received:p.parsedType}),t.INVALID}return(0,t.OK)(s.data)}}n.ZodNull=T,T.create=b=>new T({typeName:ne.ZodNull,...u(b)});class W extends d{constructor(){super(...arguments),this._any=!0}_parse(s){return(0,t.OK)(s.data)}}n.ZodAny=W,W.create=b=>new W({typeName:ne.ZodAny,...u(b)});class G extends d{constructor(){super(...arguments),this._unknown=!0}_parse(s){return(0,t.OK)(s.data)}}n.ZodUnknown=G,G.create=b=>new G({typeName:ne.ZodUnknown,...u(b)});class J extends d{_parse(s){const c=this._getOrReturnCtx(s);return(0,t.addIssueToContext)(c,{code:i.ZodIssueCode.invalid_type,expected:a.ZodParsedType.never,received:c.parsedType}),t.INVALID}}n.ZodNever=J,J.create=b=>new J({typeName:ne.ZodNever,...u(b)});class q extends d{_parse(s){if(this._getType(s)!==a.ZodParsedType.undefined){const p=this._getOrReturnCtx(s);return(0,t.addIssueToContext)(p,{code:i.ZodIssueCode.invalid_type,expected:a.ZodParsedType.void,received:p.parsedType}),t.INVALID}return(0,t.OK)(s.data)}}n.ZodVoid=q,q.create=b=>new q({typeName:ne.ZodVoid,...u(b)});class Q extends d{_parse(s){const{ctx:c,status:p}=this._processInputParams(s),v=this._def;if(c.parsedType!==a.ZodParsedType.array)return(0,t.addIssueToContext)(c,{code:i.ZodIssueCode.invalid_type,expected:a.ZodParsedType.array,received:c.parsedType}),t.INVALID;if(v.exactLength!==null){const z=c.data.length>v.exactLength.value,L=c.data.length<v.exactLength.value;(z||L)&&((0,t.addIssueToContext)(c,{code:z?i.ZodIssueCode.too_big:i.ZodIssueCode.too_small,minimum:L?v.exactLength.value:void 0,maximum:z?v.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:v.exactLength.message}),p.dirty())}if(v.minLength!==null&&c.data.length<v.minLength.value&&((0,t.addIssueToContext)(c,{code:i.ZodIssueCode.too_small,minimum:v.minLength.value,type:"array",inclusive:!0,exact:!1,message:v.minLength.message}),p.dirty()),v.maxLength!==null&&c.data.length>v.maxLength.value&&((0,t.addIssueToContext)(c,{code:i.ZodIssueCode.too_big,maximum:v.maxLength.value,type:"array",inclusive:!0,exact:!1,message:v.maxLength.message}),p.dirty()),c.common.async)return Promise.all([...c.data].map((z,L)=>v.type._parseAsync(new o(c,z,c.path,L)))).then(z=>t.ParseStatus.mergeArray(p,z));const _=[...c.data].map((z,L)=>v.type._parseSync(new o(c,z,c.path,L)));return t.ParseStatus.mergeArray(p,_)}get element(){return this._def.type}min(s,c){return new Q({...this._def,minLength:{value:s,message:r.errorUtil.toString(c)}})}max(s,c){return new Q({...this._def,maxLength:{value:s,message:r.errorUtil.toString(c)}})}length(s,c){return new Q({...this._def,exactLength:{value:s,message:r.errorUtil.toString(c)}})}nonempty(s){return this.min(1,s)}}n.ZodArray=Q,Q.create=(b,s)=>new Q({type:b,minLength:null,maxLength:null,exactLength:null,typeName:ne.ZodArray,...u(s)});function he(b){if(b instanceof x){const s={};for(const c in b.shape){const p=b.shape[c];s[c]=ye.create(he(p))}return new x({...b._def,shape:()=>s})}else return b instanceof Q?new Q({...b._def,type:he(b.element)}):b instanceof ye?ye.create(he(b.unwrap())):b instanceof Oe?Oe.create(he(b.unwrap())):b instanceof re?re.create(b.items.map(s=>he(s))):b}class x extends d{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const s=this._def.shape(),c=a.util.objectKeys(s);return this._cached={shape:s,keys:c}}_parse(s){if(this._getType(s)!==a.ZodParsedType.object){const ee=this._getOrReturnCtx(s);return(0,t.addIssueToContext)(ee,{code:i.ZodIssueCode.invalid_type,expected:a.ZodParsedType.object,received:ee.parsedType}),t.INVALID}const{status:p,ctx:v}=this._processInputParams(s),{shape:_,keys:z}=this._getCached(),L=[];if(!(this._def.catchall instanceof J&&this._def.unknownKeys==="strip"))for(const ee in v.data)z.includes(ee)||L.push(ee);const X=[];for(const ee of z){const fe=_[ee],tt=v.data[ee];X.push({key:{status:"valid",value:ee},value:fe._parse(new o(v,tt,v.path,ee)),alwaysSet:ee in v.data})}if(this._def.catchall instanceof J){const ee=this._def.unknownKeys;if(ee==="passthrough")for(const fe of L)X.push({key:{status:"valid",value:fe},value:{status:"valid",value:v.data[fe]}});else if(ee==="strict")L.length>0&&((0,t.addIssueToContext)(v,{code:i.ZodIssueCode.unrecognized_keys,keys:L}),p.dirty());else if(ee!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const ee=this._def.catchall;for(const fe of L){const tt=v.data[fe];X.push({key:{status:"valid",value:fe},value:ee._parse(new o(v,tt,v.path,fe)),alwaysSet:fe in v.data})}}return v.common.async?Promise.resolve().then(async()=>{const ee=[];for(const fe of X){const tt=await fe.key;ee.push({key:tt,value:await fe.value,alwaysSet:fe.alwaysSet})}return ee}).then(ee=>t.ParseStatus.mergeObjectSync(p,ee)):t.ParseStatus.mergeObjectSync(p,X)}get shape(){return this._def.shape()}strict(s){return r.errorUtil.errToObj,new x({...this._def,unknownKeys:"strict",...s!==void 0?{errorMap:(c,p)=>{var v,_,z,L;const X=(z=(_=(v=this._def).errorMap)===null||_===void 0?void 0:_.call(v,c,p).message)!==null&&z!==void 0?z:p.defaultError;return c.code==="unrecognized_keys"?{message:(L=r.errorUtil.errToObj(s).message)!==null&&L!==void 0?L:X}:{message:X}}}:{}})}strip(){return new x({...this._def,unknownKeys:"strip"})}passthrough(){return new x({...this._def,unknownKeys:"passthrough"})}extend(s){return new x({...this._def,shape:()=>({...this._def.shape(),...s})})}merge(s){return new x({unknownKeys:s._def.unknownKeys,catchall:s._def.catchall,shape:()=>({...this._def.shape(),...s._def.shape()}),typeName:ne.ZodObject})}setKey(s,c){return this.augment({[s]:c})}catchall(s){return new x({...this._def,catchall:s})}pick(s){const c={};return a.util.objectKeys(s).forEach(p=>{s[p]&&this.shape[p]&&(c[p]=this.shape[p])}),new x({...this._def,shape:()=>c})}omit(s){const c={};return a.util.objectKeys(this.shape).forEach(p=>{s[p]||(c[p]=this.shape[p])}),new x({...this._def,shape:()=>c})}deepPartial(){return he(this)}partial(s){const c={};return a.util.objectKeys(this.shape).forEach(p=>{const v=this.shape[p];s&&!s[p]?c[p]=v:c[p]=v.optional()}),new x({...this._def,shape:()=>c})}required(s){const c={};return a.util.objectKeys(this.shape).forEach(p=>{if(s&&!s[p])c[p]=this.shape[p];else{let _=this.shape[p];for(;_ instanceof ye;)_=_._def.innerType;c[p]=_}}),new x({...this._def,shape:()=>c})}keyof(){return K(a.util.objectKeys(this.shape))}}n.ZodObject=x,x.create=(b,s)=>new x({shape:()=>b,unknownKeys:"strip",catchall:J.create(),typeName:ne.ZodObject,...u(s)}),x.strictCreate=(b,s)=>new x({shape:()=>b,unknownKeys:"strict",catchall:J.create(),typeName:ne.ZodObject,...u(s)}),x.lazycreate=(b,s)=>new x({shape:b,unknownKeys:"strip",catchall:J.create(),typeName:ne.ZodObject,...u(s)});class $ extends d{_parse(s){const{ctx:c}=this._processInputParams(s),p=this._def.options;function v(_){for(const L of _)if(L.result.status==="valid")return L.result;for(const L of _)if(L.result.status==="dirty")return c.common.issues.push(...L.ctx.common.issues),L.result;const z=_.map(L=>new i.ZodError(L.ctx.common.issues));return(0,t.addIssueToContext)(c,{code:i.ZodIssueCode.invalid_union,unionErrors:z}),t.INVALID}if(c.common.async)return Promise.all(p.map(async _=>{const z={...c,common:{...c.common,issues:[]},parent:null};return{result:await _._parseAsync({data:c.data,path:c.path,parent:z}),ctx:z}})).then(v);{let _;const z=[];for(const X of p){const ee={...c,common:{...c.common,issues:[]},parent:null},fe=X._parseSync({data:c.data,path:c.path,parent:ee});if(fe.status==="valid")return fe;fe.status==="dirty"&&!_&&(_={result:fe,ctx:ee}),ee.common.issues.length&&z.push(ee.common.issues)}if(_)return c.common.issues.push(..._.ctx.common.issues),_.result;const L=z.map(X=>new i.ZodError(X));return(0,t.addIssueToContext)(c,{code:i.ZodIssueCode.invalid_union,unionErrors:L}),t.INVALID}}get options(){return this._def.options}}n.ZodUnion=$,$.create=(b,s)=>new $({options:b,typeName:ne.ZodUnion,...u(s)});const F=b=>b instanceof y?F(b.schema):b instanceof me?F(b.innerType()):b instanceof O?[b.value]:b instanceof R?b.options:b instanceof Y?Object.keys(b.enum):b instanceof Pe?F(b._def.innerType):b instanceof A?[void 0]:b instanceof T?[null]:null;class se extends d{_parse(s){const{ctx:c}=this._processInputParams(s);if(c.parsedType!==a.ZodParsedType.object)return(0,t.addIssueToContext)(c,{code:i.ZodIssueCode.invalid_type,expected:a.ZodParsedType.object,received:c.parsedType}),t.INVALID;const p=this.discriminator,v=c.data[p],_=this.optionsMap.get(v);return _?c.common.async?_._parseAsync({data:c.data,path:c.path,parent:c}):_._parseSync({data:c.data,path:c.path,parent:c}):((0,t.addIssueToContext)(c,{code:i.ZodIssueCode.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[p]}),t.INVALID)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(s,c,p){const v=new Map;for(const _ of c){const z=F(_.shape[s]);if(!z)throw new Error(`A discriminator value for key \`${s}\` could not be extracted from all schema options`);for(const L of z){if(v.has(L))throw new Error(`Discriminator property ${String(s)} has duplicate value ${String(L)}`);v.set(L,_)}}return new se({typeName:ne.ZodDiscriminatedUnion,discriminator:s,options:c,optionsMap:v,...u(p)})}}n.ZodDiscriminatedUnion=se;function ge(b,s){const c=(0,a.getParsedType)(b),p=(0,a.getParsedType)(s);if(b===s)return{valid:!0,data:b};if(c===a.ZodParsedType.object&&p===a.ZodParsedType.object){const v=a.util.objectKeys(s),_=a.util.objectKeys(b).filter(L=>v.indexOf(L)!==-1),z={...b,...s};for(const L of _){const X=ge(b[L],s[L]);if(!X.valid)return{valid:!1};z[L]=X.data}return{valid:!0,data:z}}else if(c===a.ZodParsedType.array&&p===a.ZodParsedType.array){if(b.length!==s.length)return{valid:!1};const v=[];for(let _=0;_<b.length;_++){const z=b[_],L=s[_],X=ge(z,L);if(!X.valid)return{valid:!1};v.push(X.data)}return{valid:!0,data:v}}else return c===a.ZodParsedType.date&&p===a.ZodParsedType.date&&+b==+s?{valid:!0,data:b}:{valid:!1}}class Z extends d{_parse(s){const{status:c,ctx:p}=this._processInputParams(s),v=(_,z)=>{if((0,t.isAborted)(_)||(0,t.isAborted)(z))return t.INVALID;const L=ge(_.value,z.value);return L.valid?(((0,t.isDirty)(_)||(0,t.isDirty)(z))&&c.dirty(),{status:c.value,value:L.data}):((0,t.addIssueToContext)(p,{code:i.ZodIssueCode.invalid_intersection_types}),t.INVALID)};return p.common.async?Promise.all([this._def.left._parseAsync({data:p.data,path:p.path,parent:p}),this._def.right._parseAsync({data:p.data,path:p.path,parent:p})]).then(([_,z])=>v(_,z)):v(this._def.left._parseSync({data:p.data,path:p.path,parent:p}),this._def.right._parseSync({data:p.data,path:p.path,parent:p}))}}n.ZodIntersection=Z,Z.create=(b,s,c)=>new Z({left:b,right:s,typeName:ne.ZodIntersection,...u(c)});class re extends d{_parse(s){const{status:c,ctx:p}=this._processInputParams(s);if(p.parsedType!==a.ZodParsedType.array)return(0,t.addIssueToContext)(p,{code:i.ZodIssueCode.invalid_type,expected:a.ZodParsedType.array,received:p.parsedType}),t.INVALID;if(p.data.length<this._def.items.length)return(0,t.addIssueToContext)(p,{code:i.ZodIssueCode.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.INVALID;!this._def.rest&&p.data.length>this._def.items.length&&((0,t.addIssueToContext)(p,{code:i.ZodIssueCode.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),c.dirty());const _=[...p.data].map((z,L)=>{const X=this._def.items[L]||this._def.rest;return X?X._parse(new o(p,z,p.path,L)):null}).filter(z=>!!z);return p.common.async?Promise.all(_).then(z=>t.ParseStatus.mergeArray(c,z)):t.ParseStatus.mergeArray(c,_)}get items(){return this._def.items}rest(s){return new re({...this._def,rest:s})}}n.ZodTuple=re,re.create=(b,s)=>{if(!Array.isArray(b))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new re({items:b,typeName:ne.ZodTuple,rest:null,...u(s)})};class pe extends d{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(s){const{status:c,ctx:p}=this._processInputParams(s);if(p.parsedType!==a.ZodParsedType.object)return(0,t.addIssueToContext)(p,{code:i.ZodIssueCode.invalid_type,expected:a.ZodParsedType.object,received:p.parsedType}),t.INVALID;const v=[],_=this._def.keyType,z=this._def.valueType;for(const L in p.data)v.push({key:_._parse(new o(p,L,p.path,L)),value:z._parse(new o(p,p.data[L],p.path,L))});return p.common.async?t.ParseStatus.mergeObjectAsync(c,v):t.ParseStatus.mergeObjectSync(c,v)}get element(){return this._def.valueType}static create(s,c,p){return c instanceof d?new pe({keyType:s,valueType:c,typeName:ne.ZodRecord,...u(p)}):new pe({keyType:C.create(),valueType:s,typeName:ne.ZodRecord,...u(c)})}}n.ZodRecord=pe;class ve extends d{_parse(s){const{status:c,ctx:p}=this._processInputParams(s);if(p.parsedType!==a.ZodParsedType.map)return(0,t.addIssueToContext)(p,{code:i.ZodIssueCode.invalid_type,expected:a.ZodParsedType.map,received:p.parsedType}),t.INVALID;const v=this._def.keyType,_=this._def.valueType,z=[...p.data.entries()].map(([L,X],ee)=>({key:v._parse(new o(p,L,p.path,[ee,"key"])),value:_._parse(new o(p,X,p.path,[ee,"value"]))}));if(p.common.async){const L=new Map;return Promise.resolve().then(async()=>{for(const X of z){const ee=await X.key,fe=await X.value;if(ee.status==="aborted"||fe.status==="aborted")return t.INVALID;(ee.status==="dirty"||fe.status==="dirty")&&c.dirty(),L.set(ee.value,fe.value)}return{status:c.value,value:L}})}else{const L=new Map;for(const X of z){const ee=X.key,fe=X.value;if(ee.status==="aborted"||fe.status==="aborted")return t.INVALID;(ee.status==="dirty"||fe.status==="dirty")&&c.dirty(),L.set(ee.value,fe.value)}return{status:c.value,value:L}}}}n.ZodMap=ve,ve.create=(b,s,c)=>new ve({valueType:s,keyType:b,typeName:ne.ZodMap,...u(c)});class V extends d{_parse(s){const{status:c,ctx:p}=this._processInputParams(s);if(p.parsedType!==a.ZodParsedType.set)return(0,t.addIssueToContext)(p,{code:i.ZodIssueCode.invalid_type,expected:a.ZodParsedType.set,received:p.parsedType}),t.INVALID;const v=this._def;v.minSize!==null&&p.data.size<v.minSize.value&&((0,t.addIssueToContext)(p,{code:i.ZodIssueCode.too_small,minimum:v.minSize.value,type:"set",inclusive:!0,exact:!1,message:v.minSize.message}),c.dirty()),v.maxSize!==null&&p.data.size>v.maxSize.value&&((0,t.addIssueToContext)(p,{code:i.ZodIssueCode.too_big,maximum:v.maxSize.value,type:"set",inclusive:!0,exact:!1,message:v.maxSize.message}),c.dirty());const _=this._def.valueType;function z(X){const ee=new Set;for(const fe of X){if(fe.status==="aborted")return t.INVALID;fe.status==="dirty"&&c.dirty(),ee.add(fe.value)}return{status:c.value,value:ee}}const L=[...p.data.values()].map((X,ee)=>_._parse(new o(p,X,p.path,ee)));return p.common.async?Promise.all(L).then(X=>z(X)):z(L)}min(s,c){return new V({...this._def,minSize:{value:s,message:r.errorUtil.toString(c)}})}max(s,c){return new V({...this._def,maxSize:{value:s,message:r.errorUtil.toString(c)}})}size(s,c){return this.min(s,c).max(s,c)}nonempty(s){return this.min(1,s)}}n.ZodSet=V,V.create=(b,s)=>new V({valueType:b,minSize:null,maxSize:null,typeName:ne.ZodSet,...u(s)});class h extends d{constructor(){super(...arguments),this.validate=this.implement}_parse(s){const{ctx:c}=this._processInputParams(s);if(c.parsedType!==a.ZodParsedType.function)return(0,t.addIssueToContext)(c,{code:i.ZodIssueCode.invalid_type,expected:a.ZodParsedType.function,received:c.parsedType}),t.INVALID;function p(L,X){return(0,t.makeIssue)({data:L,path:c.path,errorMaps:[c.common.contextualErrorMap,c.schemaErrorMap,(0,e.getErrorMap)(),e.defaultErrorMap].filter(ee=>!!ee),issueData:{code:i.ZodIssueCode.invalid_arguments,argumentsError:X}})}function v(L,X){return(0,t.makeIssue)({data:L,path:c.path,errorMaps:[c.common.contextualErrorMap,c.schemaErrorMap,(0,e.getErrorMap)(),e.defaultErrorMap].filter(ee=>!!ee),issueData:{code:i.ZodIssueCode.invalid_return_type,returnTypeError:X}})}const _={errorMap:c.common.contextualErrorMap},z=c.data;return this._def.returns instanceof ie?(0,t.OK)(async(...L)=>{const X=new i.ZodError([]),ee=await this._def.args.parseAsync(L,_).catch(or=>{throw X.addIssue(p(L,or)),X}),fe=await z(...ee);return await this._def.returns._def.type.parseAsync(fe,_).catch(or=>{throw X.addIssue(v(fe,or)),X})}):(0,t.OK)((...L)=>{const X=this._def.args.safeParse(L,_);if(!X.success)throw new i.ZodError([p(L,X.error)]);const ee=z(...X.data),fe=this._def.returns.safeParse(ee,_);if(!fe.success)throw new i.ZodError([v(ee,fe.error)]);return fe.data})}parameters(){return this._def.args}returnType(){return this._def.returns}args(...s){return new h({...this._def,args:re.create(s).rest(G.create())})}returns(s){return new h({...this._def,returns:s})}implement(s){return this.parse(s)}strictImplement(s){return this.parse(s)}static create(s,c,p){return new h({args:s||re.create([]).rest(G.create()),returns:c||G.create(),typeName:ne.ZodFunction,...u(p)})}}n.ZodFunction=h;class y extends d{get schema(){return this._def.getter()}_parse(s){const{ctx:c}=this._processInputParams(s);return this._def.getter()._parse({data:c.data,path:c.path,parent:c})}}n.ZodLazy=y,y.create=(b,s)=>new y({getter:b,typeName:ne.ZodLazy,...u(s)});class O extends d{_parse(s){if(s.data!==this._def.value){const c=this._getOrReturnCtx(s);return(0,t.addIssueToContext)(c,{received:c.data,code:i.ZodIssueCode.invalid_literal,expected:this._def.value}),t.INVALID}return{status:"valid",value:s.data}}get value(){return this._def.value}}n.ZodLiteral=O,O.create=(b,s)=>new O({value:b,typeName:ne.ZodLiteral,...u(s)});function K(b,s){return new R({values:b,typeName:ne.ZodEnum,...u(s)})}class R extends d{_parse(s){if(typeof s.data!="string"){const c=this._getOrReturnCtx(s),p=this._def.values;return(0,t.addIssueToContext)(c,{expected:a.util.joinValues(p),received:c.parsedType,code:i.ZodIssueCode.invalid_type}),t.INVALID}if(this._def.values.indexOf(s.data)===-1){const c=this._getOrReturnCtx(s),p=this._def.values;return(0,t.addIssueToContext)(c,{received:c.data,code:i.ZodIssueCode.invalid_enum_value,options:p}),t.INVALID}return(0,t.OK)(s.data)}get options(){return this._def.values}get enum(){const s={};for(const c of this._def.values)s[c]=c;return s}get Values(){const s={};for(const c of this._def.values)s[c]=c;return s}get Enum(){const s={};for(const c of this._def.values)s[c]=c;return s}extract(s){return R.create(s)}exclude(s){return R.create(this.options.filter(c=>!s.includes(c)))}}n.ZodEnum=R,R.create=K;class Y extends d{_parse(s){const c=a.util.getValidEnumValues(this._def.values),p=this._getOrReturnCtx(s);if(p.parsedType!==a.ZodParsedType.string&&p.parsedType!==a.ZodParsedType.number){const v=a.util.objectValues(c);return(0,t.addIssueToContext)(p,{expected:a.util.joinValues(v),received:p.parsedType,code:i.ZodIssueCode.invalid_type}),t.INVALID}if(c.indexOf(s.data)===-1){const v=a.util.objectValues(c);return(0,t.addIssueToContext)(p,{received:p.data,code:i.ZodIssueCode.invalid_enum_value,options:v}),t.INVALID}return(0,t.OK)(s.data)}get enum(){return this._def.values}}n.ZodNativeEnum=Y,Y.create=(b,s)=>new Y({values:b,typeName:ne.ZodNativeEnum,...u(s)});class ie extends d{unwrap(){return this._def.type}_parse(s){const{ctx:c}=this._processInputParams(s);if(c.parsedType!==a.ZodParsedType.promise&&c.common.async===!1)return(0,t.addIssueToContext)(c,{code:i.ZodIssueCode.invalid_type,expected:a.ZodParsedType.promise,received:c.parsedType}),t.INVALID;const p=c.parsedType===a.ZodParsedType.promise?c.data:Promise.resolve(c.data);return(0,t.OK)(p.then(v=>this._def.type.parseAsync(v,{path:c.path,errorMap:c.common.contextualErrorMap})))}}n.ZodPromise=ie,ie.create=(b,s)=>new ie({type:b,typeName:ne.ZodPromise,...u(s)});class me extends d{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===ne.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(s){const{status:c,ctx:p}=this._processInputParams(s),v=this._def.effect||null;if(v.type==="preprocess"){const z=v.transform(p.data);return p.common.async?Promise.resolve(z).then(L=>this._def.schema._parseAsync({data:L,path:p.path,parent:p})):this._def.schema._parseSync({data:z,path:p.path,parent:p})}const _={addIssue:z=>{(0,t.addIssueToContext)(p,z),z.fatal?c.abort():c.dirty()},get path(){return p.path}};if(_.addIssue=_.addIssue.bind(_),v.type==="refinement"){const z=L=>{const X=v.refinement(L,_);if(p.common.async)return Promise.resolve(X);if(X instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return L};if(p.common.async===!1){const L=this._def.schema._parseSync({data:p.data,path:p.path,parent:p});return L.status==="aborted"?t.INVALID:(L.status==="dirty"&&c.dirty(),z(L.value),{status:c.value,value:L.value})}else return this._def.schema._parseAsync({data:p.data,path:p.path,parent:p}).then(L=>L.status==="aborted"?t.INVALID:(L.status==="dirty"&&c.dirty(),z(L.value).then(()=>({status:c.value,value:L.value}))))}if(v.type==="transform")if(p.common.async===!1){const z=this._def.schema._parseSync({data:p.data,path:p.path,parent:p});if(!(0,t.isValid)(z))return z;const L=v.transform(z.value,_);if(L instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:c.value,value:L}}else return this._def.schema._parseAsync({data:p.data,path:p.path,parent:p}).then(z=>(0,t.isValid)(z)?Promise.resolve(v.transform(z.value,_)).then(L=>({status:c.value,value:L})):z);a.util.assertNever(v)}}n.ZodEffects=me,n.ZodTransformer=me,me.create=(b,s,c)=>new me({schema:b,typeName:ne.ZodEffects,effect:s,...u(c)}),me.createWithPreprocess=(b,s,c)=>new me({schema:s,effect:{type:"preprocess",transform:b},typeName:ne.ZodEffects,...u(c)});class ye extends d{_parse(s){return this._getType(s)===a.ZodParsedType.undefined?(0,t.OK)(void 0):this._def.innerType._parse(s)}unwrap(){return this._def.innerType}}n.ZodOptional=ye,ye.create=(b,s)=>new ye({innerType:b,typeName:ne.ZodOptional,...u(s)});class Oe extends d{_parse(s){return this._getType(s)===a.ZodParsedType.null?(0,t.OK)(null):this._def.innerType._parse(s)}unwrap(){return this._def.innerType}}n.ZodNullable=Oe,Oe.create=(b,s)=>new Oe({innerType:b,typeName:ne.ZodNullable,...u(s)});class Pe extends d{_parse(s){const{ctx:c}=this._processInputParams(s);let p=c.data;return c.parsedType===a.ZodParsedType.undefined&&(p=this._def.defaultValue()),this._def.innerType._parse({data:p,path:c.path,parent:c})}removeDefault(){return this._def.innerType}}n.ZodDefault=Pe,Pe.create=(b,s)=>new Pe({innerType:b,typeName:ne.ZodDefault,defaultValue:typeof s.default=="function"?s.default:()=>s.default,...u(s)});class Ae extends d{_parse(s){const{ctx:c}=this._processInputParams(s),p={...c,common:{...c.common,issues:[]}},v=this._def.innerType._parse({data:p.data,path:p.path,parent:{...p}});return(0,t.isAsync)(v)?v.then(_=>({status:"valid",value:_.status==="valid"?_.value:this._def.catchValue({get error(){return new i.ZodError(p.common.issues)},input:p.data})})):{status:"valid",value:v.status==="valid"?v.value:this._def.catchValue({get error(){return new i.ZodError(p.common.issues)},input:p.data})}}removeCatch(){return this._def.innerType}}n.ZodCatch=Ae,Ae.create=(b,s)=>new Ae({innerType:b,typeName:ne.ZodCatch,catchValue:typeof s.catch=="function"?s.catch:()=>s.catch,...u(s)});class we extends d{_parse(s){if(this._getType(s)!==a.ZodParsedType.nan){const p=this._getOrReturnCtx(s);return(0,t.addIssueToContext)(p,{code:i.ZodIssueCode.invalid_type,expected:a.ZodParsedType.nan,received:p.parsedType}),t.INVALID}return{status:"valid",value:s.data}}}n.ZodNaN=we,we.create=b=>new we({typeName:ne.ZodNaN,...u(b)}),n.BRAND=Symbol("zod_brand");class Ie extends d{_parse(s){const{ctx:c}=this._processInputParams(s),p=c.data;return this._def.type._parse({data:p,path:c.path,parent:c})}unwrap(){return this._def.type}}n.ZodBranded=Ie;class Re extends d{_parse(s){const{status:c,ctx:p}=this._processInputParams(s);if(p.common.async)return(async()=>{const _=await this._def.in._parseAsync({data:p.data,path:p.path,parent:p});return _.status==="aborted"?t.INVALID:_.status==="dirty"?(c.dirty(),(0,t.DIRTY)(_.value)):this._def.out._parseAsync({data:_.value,path:p.path,parent:p})})();{const v=this._def.in._parseSync({data:p.data,path:p.path,parent:p});return v.status==="aborted"?t.INVALID:v.status==="dirty"?(c.dirty(),{status:"dirty",value:v.value}):this._def.out._parseSync({data:v.value,path:p.path,parent:p})}}static create(s,c){return new Re({in:s,out:c,typeName:ne.ZodPipeline})}}n.ZodPipeline=Re;const xt=(b,s={},c)=>b?W.create().superRefine((p,v)=>{var _,z;if(!b(p)){const L=typeof s=="function"?s(p):typeof s=="string"?{message:s}:s,X=(z=(_=L.fatal)!==null&&_!==void 0?_:c)!==null&&z!==void 0?z:!0,ee=typeof L=="string"?{message:L}:L;v.addIssue({code:"custom",...ee,fatal:X})}}):W.create();n.custom=xt,n.late={object:x.lazycreate};var ne;(function(b){b.ZodString="ZodString",b.ZodNumber="ZodNumber",b.ZodNaN="ZodNaN",b.ZodBigInt="ZodBigInt",b.ZodBoolean="ZodBoolean",b.ZodDate="ZodDate",b.ZodSymbol="ZodSymbol",b.ZodUndefined="ZodUndefined",b.ZodNull="ZodNull",b.ZodAny="ZodAny",b.ZodUnknown="ZodUnknown",b.ZodNever="ZodNever",b.ZodVoid="ZodVoid",b.ZodArray="ZodArray",b.ZodObject="ZodObject",b.ZodUnion="ZodUnion",b.ZodDiscriminatedUnion="ZodDiscriminatedUnion",b.ZodIntersection="ZodIntersection",b.ZodTuple="ZodTuple",b.ZodRecord="ZodRecord",b.ZodMap="ZodMap",b.ZodSet="ZodSet",b.ZodFunction="ZodFunction",b.ZodLazy="ZodLazy",b.ZodLiteral="ZodLiteral",b.ZodEnum="ZodEnum",b.ZodEffects="ZodEffects",b.ZodNativeEnum="ZodNativeEnum",b.ZodOptional="ZodOptional",b.ZodNullable="ZodNullable",b.ZodDefault="ZodDefault",b.ZodCatch="ZodCatch",b.ZodPromise="ZodPromise",b.ZodBranded="ZodBranded",b.ZodPipeline="ZodPipeline"})(ne=n.ZodFirstPartyTypeKind||(n.ZodFirstPartyTypeKind={}));const za=(b,s={message:`Input not instance of ${b.name}`})=>(0,n.custom)(c=>c instanceof b,s);n.instanceof=za;const Wr=C.create;n.string=Wr;const Gr=I.create;n.number=Gr;const $a=we.create;n.nan=$a;const qa=E.create;n.bigint=qa;const Jr=m.create;n.boolean=Jr;const Fa=g.create;n.date=Fa;const Ha=f.create;n.symbol=Ha;const Ya=A.create;n.undefined=Ya;const Wa=T.create;n.null=Wa;const Ga=W.create;n.any=Ga;const Ja=G.create;n.unknown=Ja;const Qa=J.create;n.never=Qa;const Xa=q.create;n.void=Xa;const ei=Q.create;n.array=ei;const ti=x.create;n.object=ti;const ri=x.strictCreate;n.strictObject=ri;const ni=$.create;n.union=ni;const ai=se.create;n.discriminatedUnion=ai;const ii=Z.create;n.intersection=ii;const si=re.create;n.tuple=si;const oi=pe.create;n.record=oi;const ui=ve.create;n.map=ui;const li=V.create;n.set=li;const ci=h.create;n.function=ci;const di=y.create;n.lazy=di;const hi=O.create;n.literal=hi;const pi=R.create;n.enum=pi;const fi=Y.create;n.nativeEnum=fi;const mi=ie.create;n.promise=mi;const Qr=me.create;n.effect=Qr,n.transformer=Qr;const yi=ye.create;n.optional=yi;const gi=Oe.create;n.nullable=gi;const bi=me.createWithPreprocess;n.preprocess=bi;const _i=Re.create;n.pipeline=_i;const vi=()=>Wr().optional();n.ostring=vi;const wi=()=>Gr().optional();n.onumber=wi;const Ii=()=>Jr().optional();n.oboolean=Ii,n.coerce={string:b=>C.create({...b,coerce:!0}),number:b=>I.create({...b,coerce:!0}),boolean:b=>m.create({...b,coerce:!0}),bigint:b=>E.create({...b,coerce:!0}),date:b=>g.create({...b,coerce:!0})},n.NEVER=t.INVALID}(gr)),gr}var In;function Pn(){return In||(In=1,function(n){var e=Te&&Te.__createBinding||(Object.create?function(t,a,i,o){o===void 0&&(o=i),Object.defineProperty(t,o,{enumerable:!0,get:function(){return a[i]}})}:function(t,a,i,o){o===void 0&&(o=i),t[o]=a[i]}),r=Te&&Te.__exportStar||function(t,a){for(var i in t)i!=="default"&&!Object.prototype.hasOwnProperty.call(a,i)&&e(a,t,i)};Object.defineProperty(n,"__esModule",{value:!0}),r(Vr(),n),r(Oa(),n),r(ho(),n),r(Ht(),n),r(fo(),n),r(Ur(),n)}(pr)),pr}var On;function Br(){return On||(On=1,function(n){var e=Te&&Te.__createBinding||(Object.create?function(o,l,u,d){d===void 0&&(d=u),Object.defineProperty(o,d,{enumerable:!0,get:function(){return l[u]}})}:function(o,l,u,d){d===void 0&&(d=u),o[d]=l[u]}),r=Te&&Te.__setModuleDefault||(Object.create?function(o,l){Object.defineProperty(o,"default",{enumerable:!0,value:l})}:function(o,l){o.default=l}),t=Te&&Te.__importStar||function(o){if(o&&o.__esModule)return o;var l={};if(o!=null)for(var u in o)u!=="default"&&Object.prototype.hasOwnProperty.call(o,u)&&e(l,o,u);return r(l,o),l},a=Te&&Te.__exportStar||function(o,l){for(var u in o)u!=="default"&&!Object.prototype.hasOwnProperty.call(l,u)&&e(l,o,u)};Object.defineProperty(n,"__esModule",{value:!0}),n.z=void 0;const i=t(Pn());n.z=i,a(Pn(),n),n.default=i}(hr)),hr}var Yt={};Object.defineProperty(Yt,"__esModule",{value:!0});Yt.parseAnyDef=void 0;function mo(){return{}}Yt.parseAnyDef=mo;var dt={},Be={};Object.defineProperty(Be,"__esModule",{value:!0});Be.setResponseValueAndErrors=Be.addErrorMessage=void 0;function Aa(n,e,r,t){t!=null&&t.errorMessages&&r&&(n.errorMessage=Object.assign(Object.assign({},n.errorMessage),{[e]:r}))}Be.addErrorMessage=Aa;function yo(n,e,r,t,a){n[e]=r,Aa(n,e,t,a)}Be.setResponseValueAndErrors=yo;var An;function go(){if(An)return dt;An=1,Object.defineProperty(dt,"__esModule",{value:!0}),dt.parseArrayDef=void 0;const n=Br(),e=Be,r=je();function t(a,i){var o,l;const u={type:"array"};return((l=(o=a.type)===null||o===void 0?void 0:o._def)===null||l===void 0?void 0:l.typeName)!==n.ZodFirstPartyTypeKind.ZodAny&&(u.items=(0,r.parseDef)(a.type._def,Object.assign(Object.assign({},i),{currentPath:[...i.currentPath,"items"]}))),a.minLength&&(0,e.setResponseValueAndErrors)(u,"minItems",a.minLength.value,a.minLength.message,i),a.maxLength&&(0,e.setResponseValueAndErrors)(u,"maxItems",a.maxLength.value,a.maxLength.message,i),a.exactLength&&((0,e.setResponseValueAndErrors)(u,"minItems",a.exactLength.value,a.exactLength.message,i),(0,e.setResponseValueAndErrors)(u,"maxItems",a.exactLength.value,a.exactLength.message,i)),u}return dt.parseArrayDef=t,dt}var Wt={};Object.defineProperty(Wt,"__esModule",{value:!0});Wt.parseBigintDef=void 0;const Je=Be;function bo(n,e){const r={type:"integer",format:"int64"};if(!n.checks)return r;for(const t of n.checks)switch(t.kind){case"min":e.target==="jsonSchema7"?t.inclusive?(0,Je.setResponseValueAndErrors)(r,"minimum",t.value,t.message,e):(0,Je.setResponseValueAndErrors)(r,"exclusiveMinimum",t.value,t.message,e):(t.inclusive||(r.exclusiveMinimum=!0),(0,Je.setResponseValueAndErrors)(r,"minimum",t.value,t.message,e));break;case"max":e.target==="jsonSchema7"?t.inclusive?(0,Je.setResponseValueAndErrors)(r,"maximum",t.value,t.message,e):(0,Je.setResponseValueAndErrors)(r,"exclusiveMaximum",t.value,t.message,e):(t.inclusive||(r.exclusiveMaximum=!0),(0,Je.setResponseValueAndErrors)(r,"maximum",t.value,t.message,e));break;case"multipleOf":(0,Je.setResponseValueAndErrors)(r,"multipleOf",t.value,t.message,e);break}return r}Wt.parseBigintDef=bo;var Gt={};Object.defineProperty(Gt,"__esModule",{value:!0});Gt.parseBooleanDef=void 0;function _o(){return{type:"boolean"}}Gt.parseBooleanDef=_o;var ht={},Tn;function vo(){if(Tn)return ht;Tn=1,Object.defineProperty(ht,"__esModule",{value:!0}),ht.parseBrandedDef=void 0;const n=je();function e(r,t){return(0,n.parseDef)(r.type._def,t)}return ht.parseBrandedDef=e,ht}var pt={},En;function wo(){if(En)return pt;En=1,Object.defineProperty(pt,"__esModule",{value:!0}),pt.parseCatchDef=void 0;const n=je(),e=(r,t)=>(0,n.parseDef)(r.innerType._def,t);return pt.parseCatchDef=e,pt}var Jt={};Object.defineProperty(Jt,"__esModule",{value:!0});Jt.parseDateDef=void 0;const kn=Be;function Io(n,e){return e.dateStrategy=="integer"?Po(n,e):{type:"string",format:"date-time"}}Jt.parseDateDef=Io;const Po=(n,e)=>{const r={type:"integer",format:"unix-time"};for(const t of n.checks)switch(t.kind){case"min":e.target==="jsonSchema7"&&(0,kn.setResponseValueAndErrors)(r,"minimum",t.value,t.message,e);break;case"max":e.target==="jsonSchema7"&&(0,kn.setResponseValueAndErrors)(r,"maximum",t.value,t.message,e);break}return r};var ft={},Cn;function Oo(){if(Cn)return ft;Cn=1,Object.defineProperty(ft,"__esModule",{value:!0}),ft.parseDefaultDef=void 0;const n=je();function e(r,t){return Object.assign(Object.assign({},(0,n.parseDef)(r.innerType._def,t)),{default:r.defaultValue()})}return ft.parseDefaultDef=e,ft}var mt={},xn;function Ao(){if(xn)return mt;xn=1,Object.defineProperty(mt,"__esModule",{value:!0}),mt.parseEffectsDef=void 0;const n=je();function e(r,t){return t.effectStrategy==="input"?(0,n.parseDef)(r.schema._def,t):{}}return mt.parseEffectsDef=e,mt}var Qt={};Object.defineProperty(Qt,"__esModule",{value:!0});Qt.parseEnumDef=void 0;function To(n){return{type:"string",enum:n.values}}Qt.parseEnumDef=To;var yt={},jn;function Eo(){if(jn)return yt;jn=1;var n=Te&&Te.__rest||function(a,i){var o={};for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&i.indexOf(l)<0&&(o[l]=a[l]);if(a!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,l=Object.getOwnPropertySymbols(a);u<l.length;u++)i.indexOf(l[u])<0&&Object.prototype.propertyIsEnumerable.call(a,l[u])&&(o[l[u]]=a[l[u]]);return o};Object.defineProperty(yt,"__esModule",{value:!0}),yt.parseIntersectionDef=void 0;const e=je(),r=a=>"type"in a&&a.type==="string"?!1:"allOf"in a;function t(a,i){const o=[(0,e.parseDef)(a.left._def,Object.assign(Object.assign({},i),{currentPath:[...i.currentPath,"allOf","0"]})),(0,e.parseDef)(a.right._def,Object.assign(Object.assign({},i),{currentPath:[...i.currentPath,"allOf","1"]}))].filter(d=>!!d);let l=i.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const u=[];return o.forEach(d=>{if(r(d))u.push(...d.allOf),d.unevaluatedProperties===void 0&&(l=void 0);else{let w=d;"additionalProperties"in d&&d.additionalProperties===!1?w=n(d,["additionalProperties"]):l=void 0,u.push(w)}}),u.length?Object.assign({allOf:u},l):void 0}return yt.parseIntersectionDef=t,yt}var Xt={};Object.defineProperty(Xt,"__esModule",{value:!0});Xt.parseLiteralDef=void 0;function ko(n,e){const r=typeof n.value;return r!=="bigint"&&r!=="number"&&r!=="boolean"&&r!=="string"?{type:Array.isArray(n.value)?"array":"object"}:e.target==="openApi3"?{type:r==="bigint"?"integer":r,enum:[n.value]}:{type:r==="bigint"?"integer":r,const:n.value}}Xt.parseLiteralDef=ko;var gt={},Sn;function Co(){if(Sn)return gt;Sn=1,Object.defineProperty(gt,"__esModule",{value:!0}),gt.parseMapDef=void 0;const n=je();function e(r,t){const a=(0,n.parseDef)(r.keyType._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"items","items","0"]}))||{},i=(0,n.parseDef)(r.valueType._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"items","items","1"]}))||{};return{type:"array",maxItems:125,items:{type:"array",items:[a,i],minItems:2,maxItems:2}}}return gt.parseMapDef=e,gt}var er={};Object.defineProperty(er,"__esModule",{value:!0});er.parseNativeEnumDef=void 0;function xo(n){const e=n.values,t=Object.keys(n.values).filter(i=>typeof e[e[i]]!="number").map(i=>e[i]),a=Array.from(new Set(t.map(i=>typeof i)));return{type:a.length===1?a[0]==="string"?"string":"number":["string","number"],enum:t}}er.parseNativeEnumDef=xo;var tr={};Object.defineProperty(tr,"__esModule",{value:!0});tr.parseNeverDef=void 0;function jo(){return{not:{}}}tr.parseNeverDef=jo;var rr={};Object.defineProperty(rr,"__esModule",{value:!0});rr.parseNullDef=void 0;function So(n){return n.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}rr.parseNullDef=So;var bt={},_r={},Nn;function Ta(){return Nn||(Nn=1,function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.parseUnionDef=n.primitiveMappings=void 0;const e=je();n.primitiveMappings={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function r(a,i){if(i.target==="openApi3")return t(a,i);const o=a.options instanceof Map?Array.from(a.options.values()):a.options;if(o.every(l=>l._def.typeName in n.primitiveMappings&&(!l._def.checks||!l._def.checks.length))){const l=o.reduce((u,d)=>{const w=n.primitiveMappings[d._def.typeName];return w&&!u.includes(w)?[...u,w]:u},[]);return{type:l.length>1?l:l[0]}}else if(o.every(l=>l._def.typeName==="ZodLiteral"&&!l.description)){const l=o.reduce((u,d)=>{const w=typeof d._def.value;switch(w){case"string":case"number":case"boolean":return[...u,w];case"bigint":return[...u,"integer"];case"object":if(d._def.value===null)return[...u,"null"];case"symbol":case"undefined":case"function":default:return u}},[]);if(l.length===o.length){const u=l.filter((d,w,j)=>j.indexOf(d)===w);return{type:u.length>1?u:u[0],enum:o.reduce((d,w)=>d.includes(w._def.value)?d:[...d,w._def.value],[])}}}else if(o.every(l=>l._def.typeName==="ZodEnum"))return{type:"string",enum:o.reduce((l,u)=>[...l,...u._def.values.filter(d=>!l.includes(d))],[])};return t(a,i)}n.parseUnionDef=r;const t=(a,i)=>{const o=(a.options instanceof Map?Array.from(a.options.values()):a.options).map((l,u)=>(0,e.parseDef)(l._def,Object.assign(Object.assign({},i),{currentPath:[...i.currentPath,"anyOf",`${u}`]}))).filter(l=>!!l&&(!i.strictUnions||typeof l=="object"&&Object.keys(l).length>0));return o.length?{anyOf:o}:void 0}}(_r)),_r}var Dn;function No(){if(Dn)return bt;Dn=1,Object.defineProperty(bt,"__esModule",{value:!0}),bt.parseNullableDef=void 0;const n=je(),e=Ta();function r(t,a){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(t.innerType._def.typeName)&&(!t.innerType._def.checks||!t.innerType._def.checks.length))return a.target==="openApi3"?{type:e.primitiveMappings[t.innerType._def.typeName],nullable:!0}:{type:[e.primitiveMappings[t.innerType._def.typeName],"null"]};if(a.target==="openApi3"){const o=(0,n.parseDef)(t.innerType._def,Object.assign(Object.assign({},a),{currentPath:[...a.currentPath]}));return o&&Object.assign(Object.assign({},o),{nullable:!0})}const i=(0,n.parseDef)(t.innerType._def,Object.assign(Object.assign({},a),{currentPath:[...a.currentPath,"anyOf","0"]}));return i&&{anyOf:[i,{type:"null"}]}}return bt.parseNullableDef=r,bt}var nr={};Object.defineProperty(nr,"__esModule",{value:!0});nr.parseNumberDef=void 0;const We=Be;function Do(n,e){const r={type:"number"};if(!n.checks)return r;for(const t of n.checks)switch(t.kind){case"int":r.type="integer",(0,We.addErrorMessage)(r,"type",t.message,e);break;case"min":e.target==="jsonSchema7"?t.inclusive?(0,We.setResponseValueAndErrors)(r,"minimum",t.value,t.message,e):(0,We.setResponseValueAndErrors)(r,"exclusiveMinimum",t.value,t.message,e):(t.inclusive||(r.exclusiveMinimum=!0),(0,We.setResponseValueAndErrors)(r,"minimum",t.value,t.message,e));break;case"max":e.target==="jsonSchema7"?t.inclusive?(0,We.setResponseValueAndErrors)(r,"maximum",t.value,t.message,e):(0,We.setResponseValueAndErrors)(r,"exclusiveMaximum",t.value,t.message,e):(t.inclusive||(r.exclusiveMaximum=!0),(0,We.setResponseValueAndErrors)(r,"maximum",t.value,t.message,e));break;case"multipleOf":(0,We.setResponseValueAndErrors)(r,"multipleOf",t.value,t.message,e);break}return r}nr.parseNumberDef=Do;var Qe={},Ln;function Lo(){if(Ln)return Qe;Ln=1,Object.defineProperty(Qe,"__esModule",{value:!0}),Qe.parseObjectDef=Qe.parseObjectDefX=void 0;const n=je();function e(t,a){var i,o;Object.keys(t.shape()).reduce((u,d)=>{let w=t.shape()[d];const j=w.isOptional();j||(w=Object.assign({},w._def.innerSchema));const U=(0,n.parseDef)(w._def,Object.assign(Object.assign({},a),{currentPath:[...a.currentPath,"properties",d],propertyPath:[...a.currentPath,"properties",d]}));return U!==void 0&&(u.properties[d]=U,j||(u.required||(u.required=[]),u.required.push(d))),u},{type:"object",properties:{},additionalProperties:t.catchall._def.typeName==="ZodNever"?t.unknownKeys==="passthrough":(i=(0,n.parseDef)(t.catchall._def,Object.assign(Object.assign({},a),{currentPath:[...a.currentPath,"additionalProperties"]})))!==null&&i!==void 0?i:!0});const l=Object.assign(Object.assign({type:"object"},Object.entries(t.shape()).reduce((u,[d,w])=>{if(w===void 0||w._def===void 0)return u;const j=(0,n.parseDef)(w._def,Object.assign(Object.assign({},a),{currentPath:[...a.currentPath,"properties",d],propertyPath:[...a.currentPath,"properties",d]}));return j===void 0?u:{properties:Object.assign(Object.assign({},u.properties),{[d]:j}),required:w.isOptional()?u.required:[...u.required,d]}},{properties:{},required:[]})),{additionalProperties:t.catchall._def.typeName==="ZodNever"?t.unknownKeys==="passthrough":(o=(0,n.parseDef)(t.catchall._def,Object.assign(Object.assign({},a),{currentPath:[...a.currentPath,"additionalProperties"]})))!==null&&o!==void 0?o:!0});return l.required.length||delete l.required,l}Qe.parseObjectDefX=e;function r(t,a){var i;const o=Object.assign(Object.assign({type:"object"},Object.entries(t.shape()).reduce((l,[u,d])=>{if(d===void 0||d._def===void 0)return l;const w=(0,n.parseDef)(d._def,Object.assign(Object.assign({},a),{currentPath:[...a.currentPath,"properties",u],propertyPath:[...a.currentPath,"properties",u]}));return w===void 0?l:{properties:Object.assign(Object.assign({},l.properties),{[u]:w}),required:d.isOptional()?l.required:[...l.required,u]}},{properties:{},required:[]})),{additionalProperties:t.catchall._def.typeName==="ZodNever"?t.unknownKeys==="passthrough":(i=(0,n.parseDef)(t.catchall._def,Object.assign(Object.assign({},a),{currentPath:[...a.currentPath,"additionalProperties"]})))!==null&&i!==void 0?i:!0});return o.required.length||delete o.required,o}return Qe.parseObjectDef=r,Qe}var _t={},Zn;function Zo(){if(Zn)return _t;Zn=1,Object.defineProperty(_t,"__esModule",{value:!0}),_t.parseOptionalDef=void 0;const n=je(),e=(r,t)=>{var a;if(t.currentPath.toString()===((a=t.propertyPath)===null||a===void 0?void 0:a.toString()))return(0,n.parseDef)(r.innerType._def,t);const i=(0,n.parseDef)(r.innerType._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"anyOf","1"]}));return i?{anyOf:[{not:{}},i]}:{}};return _t.parseOptionalDef=e,_t}var vt={},Mn;function Mo(){if(Mn)return vt;Mn=1,Object.defineProperty(vt,"__esModule",{value:!0}),vt.parsePipelineDef=void 0;const n=je(),e=(r,t)=>{if(t.pipeStrategy==="input")return(0,n.parseDef)(r.in._def,t);const a=(0,n.parseDef)(r.in._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"allOf","0"]})),i=(0,n.parseDef)(r.out._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"allOf",a?"1":"0"]}));return{allOf:[a,i].filter(o=>o!==void 0)}};return vt.parsePipelineDef=e,vt}var wt={},Rn;function Ro(){if(Rn)return wt;Rn=1,Object.defineProperty(wt,"__esModule",{value:!0}),wt.parsePromiseDef=void 0;const n=je();function e(r,t){return(0,n.parseDef)(r.type._def,t)}return wt.parsePromiseDef=e,wt}var It={},Kr={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.parseStringDef=n.emojiPattern=n.ulidPattern=n.cuid2Pattern=n.cuidPattern=n.emailPattern=void 0;const e=Be;n.emailPattern='^(([^<>()[\\]\\\\.,;:\\s@\\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\\"]+)*)|(\\".+\\"))@((\\[(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\])|(\\[IPv6:(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))\\])|([A-Za-z0-9]([A-Za-z0-9-]*[A-Za-z0-9])*(\\.[A-Za-z]{2,})+))$',n.cuidPattern="^c[^\\s-]{8,}$",n.cuid2Pattern="^[a-z][a-z0-9]*$",n.ulidPattern="/[0-9A-HJKMNP-TV-Z]{26}/",n.emojiPattern="/^(p{Extended_Pictographic}|p{Emoji_Component})+$/u";function r(o,l){const u={type:"string"};if(o.checks)for(const d of o.checks)switch(d.kind){case"min":(0,e.setResponseValueAndErrors)(u,"minLength",typeof u.minLength=="number"?Math.max(u.minLength,d.value):d.value,d.message,l);break;case"max":(0,e.setResponseValueAndErrors)(u,"maxLength",typeof u.maxLength=="number"?Math.min(u.maxLength,d.value):d.value,d.message,l);break;case"email":switch(l.emailStrategy){case"format:email":a(u,"email",d.message,l);break;case"format:idn-email":a(u,"idn-email",d.message,l);break;case"pattern:zod":i(u,n.emailPattern,d.message,l);break}break;case"url":a(u,"uri",d.message,l);break;case"uuid":a(u,"uuid",d.message,l);break;case"regex":i(u,d.regex.source,d.message,l);break;case"cuid":i(u,n.cuidPattern,d.message,l);break;case"cuid2":i(u,n.cuid2Pattern,d.message,l);break;case"startsWith":i(u,"^"+t(d.value),d.message,l);break;case"endsWith":i(u,t(d.value)+"$",d.message,l);break;case"datetime":a(u,"date-time",d.message,l);break;case"length":(0,e.setResponseValueAndErrors)(u,"minLength",typeof u.minLength=="number"?Math.max(u.minLength,d.value):d.value,d.message,l),(0,e.setResponseValueAndErrors)(u,"maxLength",typeof u.maxLength=="number"?Math.min(u.maxLength,d.value):d.value,d.message,l);break;case"includes":{i(u,t(d.value),d.message,l);break}case"ip":{d.version!=="v6"&&a(u,"ipv4",d.message,l),d.version!=="v4"&&a(u,"ipv6",d.message,l);break}case"emoji":i(u,n.emojiPattern,d.message,l);break;case"ulid":{i(u,n.ulidPattern,d.message,l);break}}return u}n.parseStringDef=r;const t=o=>Array.from(o).map(l=>/[a-zA-Z0-9]/.test(l)?l:`\\${l}`).join(""),a=(o,l,u,d)=>{var w;o.format||!((w=o.anyOf)===null||w===void 0)&&w.some(j=>j.format)?(o.anyOf||(o.anyOf=[]),o.format&&(o.anyOf.push(Object.assign({format:o.format},o.errorMessage&&d.errorMessages&&{errorMessage:{format:o.errorMessage.format}})),delete o.format,o.errorMessage&&(delete o.errorMessage.format,Object.keys(o.errorMessage).length===0&&delete o.errorMessage)),o.anyOf.push(Object.assign({format:l},u&&d.errorMessages&&{errorMessage:{format:u}}))):(0,e.setResponseValueAndErrors)(o,"format",l,u,d)},i=(o,l,u,d)=>{var w;o.pattern||!((w=o.allOf)===null||w===void 0)&&w.some(j=>j.pattern)?(o.allOf||(o.allOf=[]),o.pattern&&(o.allOf.push(Object.assign({pattern:o.pattern},o.errorMessage&&d.errorMessages&&{errorMessage:{pattern:o.errorMessage.pattern}})),delete o.pattern,o.errorMessage&&(delete o.errorMessage.pattern,Object.keys(o.errorMessage).length===0&&delete o.errorMessage)),o.allOf.push(Object.assign({pattern:l},u&&d.errorMessages&&{errorMessage:{pattern:u}}))):(0,e.setResponseValueAndErrors)(o,"pattern",l,u,d)}})(Kr);var Un;function Uo(){if(Un)return It;Un=1,Object.defineProperty(It,"__esModule",{value:!0}),It.parseRecordDef=void 0;const n=Br(),e=je(),r=Kr;function t(a,i){var o,l,u,d,w;if(i.target==="openApi3"&&((o=a.keyType)===null||o===void 0?void 0:o._def.typeName)===n.ZodFirstPartyTypeKind.ZodEnum)return{type:"object",required:a.keyType._def.values,properties:a.keyType._def.values.reduce((U,B)=>{var k;return Object.assign(Object.assign({},U),{[B]:(k=(0,e.parseDef)(a.valueType._def,Object.assign(Object.assign({},i),{currentPath:[...i.currentPath,"properties",B]})))!==null&&k!==void 0?k:{}})},{}),additionalProperties:!1};const j={type:"object",additionalProperties:(l=(0,e.parseDef)(a.valueType._def,Object.assign(Object.assign({},i),{currentPath:[...i.currentPath,"additionalProperties"]})))!==null&&l!==void 0?l:{}};if(i.target==="openApi3")return j;if(((u=a.keyType)===null||u===void 0?void 0:u._def.typeName)===n.ZodFirstPartyTypeKind.ZodString&&(!((d=a.keyType._def.checks)===null||d===void 0)&&d.length)){const U=Object.entries((0,r.parseStringDef)(a.keyType._def,i)).reduce((B,[k,M])=>k==="type"?B:Object.assign(Object.assign({},B),{[k]:M}),{});return Object.assign(Object.assign({},j),{propertyNames:U})}else if(((w=a.keyType)===null||w===void 0?void 0:w._def.typeName)===n.ZodFirstPartyTypeKind.ZodEnum)return Object.assign(Object.assign({},j),{propertyNames:{enum:a.keyType._def.values}});return j}return It.parseRecordDef=t,It}var Pt={},Vn;function Vo(){if(Vn)return Pt;Vn=1,Object.defineProperty(Pt,"__esModule",{value:!0}),Pt.parseSetDef=void 0;const n=Be,e=je();function r(t,a){const o={type:"array",uniqueItems:!0,items:(0,e.parseDef)(t.valueType._def,Object.assign(Object.assign({},a),{currentPath:[...a.currentPath,"items"]}))};return t.minSize&&(0,n.setResponseValueAndErrors)(o,"minItems",t.minSize.value,t.minSize.message,a),t.maxSize&&(0,n.setResponseValueAndErrors)(o,"maxItems",t.maxSize.value,t.maxSize.message,a),o}return Pt.parseSetDef=r,Pt}var Ot={},Bn;function Bo(){if(Bn)return Ot;Bn=1,Object.defineProperty(Ot,"__esModule",{value:!0}),Ot.parseTupleDef=void 0;const n=je();function e(r,t){return r.rest?{type:"array",minItems:r.items.length,items:r.items.map((a,i)=>(0,n.parseDef)(a._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"items",`${i}`]}))).reduce((a,i)=>i===void 0?a:[...a,i],[]),additionalItems:(0,n.parseDef)(r.rest._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"additionalItems"]}))}:{type:"array",minItems:r.items.length,maxItems:r.items.length,items:r.items.map((a,i)=>(0,n.parseDef)(a._def,Object.assign(Object.assign({},t),{currentPath:[...t.currentPath,"items",`${i}`]}))).reduce((a,i)=>i===void 0?a:[...a,i],[])}}return Ot.parseTupleDef=e,Ot}var ar={};Object.defineProperty(ar,"__esModule",{value:!0});ar.parseUndefinedDef=void 0;function Ko(){return{not:{}}}ar.parseUndefinedDef=Ko;var ir={};Object.defineProperty(ir,"__esModule",{value:!0});ir.parseUnknownDef=void 0;function zo(){return{}}ir.parseUnknownDef=zo;var Kn;function je(){if(Kn)return ct;Kn=1,Object.defineProperty(ct,"__esModule",{value:!0}),ct.parseDef=void 0;const n=Br(),e=Yt,r=go(),t=Wt,a=Gt,i=vo(),o=wo(),l=Jt,u=Oo(),d=Ao(),w=Qt,j=Eo(),U=Xt,B=Co(),k=er,M=tr,P=rr,S=No(),D=nr,N=Lo(),C=Zo(),H=Mo(),I=Ro(),E=Uo(),m=Vo(),g=Kr,f=Bo(),A=ar,T=Ta(),W=ir;function G(x,$,F=!1){const se=$.seen.get(x);if(se&&!F){const re=J(se,$);if(re!==void 0)return re}const ge={def:x,path:$.currentPath,jsonSchema:void 0};$.seen.set(x,ge);const Z=Q(x,x.typeName,$);return Z&&he(x,$,Z),ge.jsonSchema=Z,Z}ct.parseDef=G;const J=(x,$)=>{switch($.$refStrategy){case"root":return{$ref:x.path.length===0?"":x.path.length===1?`${x.path[0]}/`:x.path.join("/")};case"relative":return{$ref:q($.currentPath,x.path)};case"none":return x.path.length<$.currentPath.length&&x.path.every((F,se)=>$.currentPath[se]===F)?(console.warn(`Recursive reference detected at ${$.currentPath.join("/")}! Defaulting to any`),{}):void 0;case"seen":return x.path.length<$.currentPath.length&&x.path.every((F,se)=>$.currentPath[se]===F)?(console.warn(`Recursive reference detected at ${$.currentPath.join("/")}! Defaulting to any`),{}):x.jsonSchema}},q=(x,$)=>{let F=0;for(;F<x.length&&F<$.length&&x[F]===$[F];F++);return[(x.length-F).toString(),...$.slice(F)].join("/")},Q=(x,$,F)=>{switch($){case n.ZodFirstPartyTypeKind.ZodString:return(0,g.parseStringDef)(x,F);case n.ZodFirstPartyTypeKind.ZodNumber:return(0,D.parseNumberDef)(x,F);case n.ZodFirstPartyTypeKind.ZodObject:return(0,N.parseObjectDef)(x,F);case n.ZodFirstPartyTypeKind.ZodBigInt:return(0,t.parseBigintDef)(x,F);case n.ZodFirstPartyTypeKind.ZodBoolean:return(0,a.parseBooleanDef)();case n.ZodFirstPartyTypeKind.ZodDate:return(0,l.parseDateDef)(x,F);case n.ZodFirstPartyTypeKind.ZodUndefined:return(0,A.parseUndefinedDef)();case n.ZodFirstPartyTypeKind.ZodNull:return(0,P.parseNullDef)(F);case n.ZodFirstPartyTypeKind.ZodArray:return(0,r.parseArrayDef)(x,F);case n.ZodFirstPartyTypeKind.ZodUnion:case n.ZodFirstPartyTypeKind.ZodDiscriminatedUnion:return(0,T.parseUnionDef)(x,F);case n.ZodFirstPartyTypeKind.ZodIntersection:return(0,j.parseIntersectionDef)(x,F);case n.ZodFirstPartyTypeKind.ZodTuple:return(0,f.parseTupleDef)(x,F);case n.ZodFirstPartyTypeKind.ZodRecord:return(0,E.parseRecordDef)(x,F);case n.ZodFirstPartyTypeKind.ZodLiteral:return(0,U.parseLiteralDef)(x,F);case n.ZodFirstPartyTypeKind.ZodEnum:return(0,w.parseEnumDef)(x);case n.ZodFirstPartyTypeKind.ZodNativeEnum:return(0,k.parseNativeEnumDef)(x);case n.ZodFirstPartyTypeKind.ZodNullable:return(0,S.parseNullableDef)(x,F);case n.ZodFirstPartyTypeKind.ZodOptional:return(0,C.parseOptionalDef)(x,F);case n.ZodFirstPartyTypeKind.ZodMap:return(0,B.parseMapDef)(x,F);case n.ZodFirstPartyTypeKind.ZodSet:return(0,m.parseSetDef)(x,F);case n.ZodFirstPartyTypeKind.ZodLazy:return G(x.getter()._def,F);case n.ZodFirstPartyTypeKind.ZodPromise:return(0,I.parsePromiseDef)(x,F);case n.ZodFirstPartyTypeKind.ZodNaN:case n.ZodFirstPartyTypeKind.ZodNever:return(0,M.parseNeverDef)();case n.ZodFirstPartyTypeKind.ZodEffects:return(0,d.parseEffectsDef)(x,F);case n.ZodFirstPartyTypeKind.ZodAny:return(0,e.parseAnyDef)();case n.ZodFirstPartyTypeKind.ZodUnknown:return(0,W.parseUnknownDef)();case n.ZodFirstPartyTypeKind.ZodDefault:return(0,u.parseDefaultDef)(x,F);case n.ZodFirstPartyTypeKind.ZodBranded:return(0,i.parseBrandedDef)(x,F);case n.ZodFirstPartyTypeKind.ZodCatch:return(0,o.parseCatchDef)(x,F);case n.ZodFirstPartyTypeKind.ZodPipeline:return(0,H.parsePipelineDef)(x,F);case n.ZodFirstPartyTypeKind.ZodFunction:case n.ZodFirstPartyTypeKind.ZodVoid:case n.ZodFirstPartyTypeKind.ZodSymbol:return;default:return(se=>{})()}},he=(x,$,F)=>(x.description&&(F.description=x.description,$.markdownDescription&&(F.markdownDescription=x.description)),F);return ct}var sr={},Ea={};(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.getDefaultOptions=n.defaultOptions=void 0,n.defaultOptions={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"string",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,emailStrategy:"format:email"};const e=r=>typeof r=="string"?Object.assign(Object.assign({},n.defaultOptions),{name:r}):Object.assign(Object.assign({},n.defaultOptions),r);n.getDefaultOptions=e})(Ea);Object.defineProperty(sr,"__esModule",{value:!0});sr.getRefs=void 0;const $o=Ea,qo=n=>{const e=(0,$o.getDefaultOptions)(n),r=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return Object.assign(Object.assign({},e),{currentPath:r,propertyPath:void 0,seen:new Map(Object.entries(e.definitions).map(([t,a])=>[a._def,{def:a._def,path:[...e.basePath,e.definitionPath,t],jsonSchema:void 0}]))})};sr.getRefs=qo;Object.defineProperty(Ft,"__esModule",{value:!0});Ft.zodToJsonSchema=void 0;const zn=je(),Fo=sr,Ho=(n,e)=>{var r;const t=(0,Fo.getRefs)(e),a=typeof e=="object"&&e.definitions?Object.entries(e.definitions).reduce((u,[d,w])=>{var j;return Object.assign(Object.assign({},u),{[d]:(j=(0,zn.parseDef)(w._def,Object.assign(Object.assign({},t),{currentPath:[...t.basePath,t.definitionPath,d]}),!0))!==null&&j!==void 0?j:{}})},{}):void 0,i=typeof e=="string"?e:e==null?void 0:e.name,o=(r=(0,zn.parseDef)(n._def,i===void 0?t:Object.assign(Object.assign({},t),{currentPath:[...t.basePath,t.definitionPath,i]}),!1))!==null&&r!==void 0?r:{},l=i===void 0?a?Object.assign(Object.assign({},o),{[t.definitionPath]:a}):o:{$ref:[...t.$refStrategy==="relative"?[]:t.basePath,t.definitionPath,i].join("/"),[t.definitionPath]:Object.assign(Object.assign({},a),{[i]:o})};return t.target==="jsonSchema7"?l.$schema="http://json-schema.org/draft-07/schema#":t.target==="jsonSchema2019-09"&&(l.$schema="https://json-schema.org/draft/2019-09/schema#"),l};Ft.zodToJsonSchema=Ho;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),n.zodToJsonSchema=void 0;const e=Ft;Object.defineProperty(n,"zodToJsonSchema",{enumerable:!0,get:function(){return e.zodToJsonSchema}}),n.default=e.zodToJsonSchema})(co);/*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT */function ka(n){return typeof n>"u"||n===null}function Yo(n){return typeof n=="object"&&n!==null}function Wo(n){return Array.isArray(n)?n:ka(n)?[]:[n]}function Go(n,e){var r,t,a,i;if(e)for(i=Object.keys(e),r=0,t=i.length;r<t;r+=1)a=i[r],n[a]=e[a];return n}function Jo(n,e){var r="",t;for(t=0;t<e;t+=1)r+=n;return r}function Qo(n){return n===0&&Number.NEGATIVE_INFINITY===1/n}var Xo=ka,eu=Yo,tu=Wo,ru=Jo,nu=Qo,au=Go,zr={isNothing:Xo,isObject:eu,toArray:tu,repeat:ru,isNegativeZero:nu,extend:au};function Ca(n,e){var r="",t=n.reason||"(unknown reason)";return n.mark?(n.mark.name&&(r+='in "'+n.mark.name+'" '),r+="("+(n.mark.line+1)+":"+(n.mark.column+1)+")",!e&&n.mark.snippet&&(r+=`

`+n.mark.snippet),t+" "+r):t}function At(n,e){Error.call(this),this.name="YAMLException",this.reason=n,this.mark=e,this.message=Ca(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}At.prototype=Object.create(Error.prototype);At.prototype.constructor=At;At.prototype.toString=function(e){return this.name+": "+Ca(this,e)};var et=At,iu=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],su=["scalar","sequence","mapping"];function ou(n){var e={};return n!==null&&Object.keys(n).forEach(function(r){n[r].forEach(function(t){e[String(t)]=r})}),e}function uu(n,e){if(e=e||{},Object.keys(e).forEach(function(r){if(iu.indexOf(r)===-1)throw new et('Unknown option "'+r+'" is met in definition of "'+n+'" YAML type.')}),this.options=e,this.tag=n,this.kind=e.kind||null,this.resolve=e.resolve||function(){return!0},this.construct=e.construct||function(r){return r},this.instanceOf=e.instanceOf||null,this.predicate=e.predicate||null,this.represent=e.represent||null,this.representName=e.representName||null,this.defaultStyle=e.defaultStyle||null,this.multi=e.multi||!1,this.styleAliases=ou(e.styleAliases||null),su.indexOf(this.kind)===-1)throw new et('Unknown kind "'+this.kind+'" is specified for "'+n+'" YAML type.')}var Se=uu;function $n(n,e){var r=[];return n[e].forEach(function(t){var a=r.length;r.forEach(function(i,o){i.tag===t.tag&&i.kind===t.kind&&i.multi===t.multi&&(a=o)}),r[a]=t}),r}function lu(){var n={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},e,r;function t(a){a.multi?(n.multi[a.kind].push(a),n.multi.fallback.push(a)):n[a.kind][a.tag]=n.fallback[a.tag]=a}for(e=0,r=arguments.length;e<r;e+=1)arguments[e].forEach(t);return n}function Or(n){return this.extend(n)}Or.prototype.extend=function(e){var r=[],t=[];if(e instanceof Se)t.push(e);else if(Array.isArray(e))t=t.concat(e);else if(e&&(Array.isArray(e.implicit)||Array.isArray(e.explicit)))e.implicit&&(r=r.concat(e.implicit)),e.explicit&&(t=t.concat(e.explicit));else throw new et("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");r.forEach(function(i){if(!(i instanceof Se))throw new et("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(i.loadKind&&i.loadKind!=="scalar")throw new et("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(i.multi)throw new et("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),t.forEach(function(i){if(!(i instanceof Se))throw new et("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var a=Object.create(Or.prototype);return a.implicit=(this.implicit||[]).concat(r),a.explicit=(this.explicit||[]).concat(t),a.compiledImplicit=$n(a,"implicit"),a.compiledExplicit=$n(a,"explicit"),a.compiledTypeMap=lu(a.compiledImplicit,a.compiledExplicit),a};var cu=Or,du=new Se("tag:yaml.org,2002:str",{kind:"scalar",construct:function(n){return n!==null?n:""}}),hu=new Se("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(n){return n!==null?n:[]}}),pu=new Se("tag:yaml.org,2002:map",{kind:"mapping",construct:function(n){return n!==null?n:{}}}),fu=new cu({explicit:[du,hu,pu]});function mu(n){if(n===null)return!0;var e=n.length;return e===1&&n==="~"||e===4&&(n==="null"||n==="Null"||n==="NULL")}function yu(){return null}function gu(n){return n===null}var bu=new Se("tag:yaml.org,2002:null",{kind:"scalar",resolve:mu,construct:yu,predicate:gu,represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"});function _u(n){if(n===null)return!1;var e=n.length;return e===4&&(n==="true"||n==="True"||n==="TRUE")||e===5&&(n==="false"||n==="False"||n==="FALSE")}function vu(n){return n==="true"||n==="True"||n==="TRUE"}function wu(n){return Object.prototype.toString.call(n)==="[object Boolean]"}var Iu=new Se("tag:yaml.org,2002:bool",{kind:"scalar",resolve:_u,construct:vu,predicate:wu,represent:{lowercase:function(n){return n?"true":"false"},uppercase:function(n){return n?"TRUE":"FALSE"},camelcase:function(n){return n?"True":"False"}},defaultStyle:"lowercase"});function Pu(n){return 48<=n&&n<=57||65<=n&&n<=70||97<=n&&n<=102}function Ou(n){return 48<=n&&n<=55}function Au(n){return 48<=n&&n<=57}function Tu(n){if(n===null)return!1;var e=n.length,r=0,t=!1,a;if(!e)return!1;if(a=n[r],(a==="-"||a==="+")&&(a=n[++r]),a==="0"){if(r+1===e)return!0;if(a=n[++r],a==="b"){for(r++;r<e;r++)if(a=n[r],a!=="_"){if(a!=="0"&&a!=="1")return!1;t=!0}return t&&a!=="_"}if(a==="x"){for(r++;r<e;r++)if(a=n[r],a!=="_"){if(!Pu(n.charCodeAt(r)))return!1;t=!0}return t&&a!=="_"}if(a==="o"){for(r++;r<e;r++)if(a=n[r],a!=="_"){if(!Ou(n.charCodeAt(r)))return!1;t=!0}return t&&a!=="_"}}if(a==="_")return!1;for(;r<e;r++)if(a=n[r],a!=="_"){if(!Au(n.charCodeAt(r)))return!1;t=!0}return!(!t||a==="_")}function Eu(n){var e=n,r=1,t;if(e.indexOf("_")!==-1&&(e=e.replace(/_/g,"")),t=e[0],(t==="-"||t==="+")&&(t==="-"&&(r=-1),e=e.slice(1),t=e[0]),e==="0")return 0;if(t==="0"){if(e[1]==="b")return r*parseInt(e.slice(2),2);if(e[1]==="x")return r*parseInt(e.slice(2),16);if(e[1]==="o")return r*parseInt(e.slice(2),8)}return r*parseInt(e,10)}function ku(n){return Object.prototype.toString.call(n)==="[object Number]"&&n%1===0&&!zr.isNegativeZero(n)}var Cu=new Se("tag:yaml.org,2002:int",{kind:"scalar",resolve:Tu,construct:Eu,predicate:ku,represent:{binary:function(n){return n>=0?"0b"+n.toString(2):"-0b"+n.toString(2).slice(1)},octal:function(n){return n>=0?"0o"+n.toString(8):"-0o"+n.toString(8).slice(1)},decimal:function(n){return n.toString(10)},hexadecimal:function(n){return n>=0?"0x"+n.toString(16).toUpperCase():"-0x"+n.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),xu=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function ju(n){return!(n===null||!xu.test(n)||n[n.length-1]==="_")}function Su(n){var e,r;return e=n.replace(/_/g,"").toLowerCase(),r=e[0]==="-"?-1:1,"+-".indexOf(e[0])>=0&&(e=e.slice(1)),e===".inf"?r===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:e===".nan"?NaN:r*parseFloat(e,10)}var Nu=/^[-+]?[0-9]+e/;function Du(n,e){var r;if(isNaN(n))switch(e){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===n)switch(e){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===n)switch(e){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(zr.isNegativeZero(n))return"-0.0";return r=n.toString(10),Nu.test(r)?r.replace("e",".e"):r}function Lu(n){return Object.prototype.toString.call(n)==="[object Number]"&&(n%1!==0||zr.isNegativeZero(n))}var Zu=new Se("tag:yaml.org,2002:float",{kind:"scalar",resolve:ju,construct:Su,predicate:Lu,represent:Du,defaultStyle:"lowercase"}),Mu=fu.extend({implicit:[bu,Iu,Cu,Zu]}),Ru=Mu,xa=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),ja=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function Uu(n){return n===null?!1:xa.exec(n)!==null||ja.exec(n)!==null}function Vu(n){var e,r,t,a,i,o,l,u=0,d=null,w,j,U;if(e=xa.exec(n),e===null&&(e=ja.exec(n)),e===null)throw new Error("Date resolve error");if(r=+e[1],t=+e[2]-1,a=+e[3],!e[4])return new Date(Date.UTC(r,t,a));if(i=+e[4],o=+e[5],l=+e[6],e[7]){for(u=e[7].slice(0,3);u.length<3;)u+="0";u=+u}return e[9]&&(w=+e[10],j=+(e[11]||0),d=(w*60+j)*6e4,e[9]==="-"&&(d=-d)),U=new Date(Date.UTC(r,t,a,i,o,l,u)),d&&U.setTime(U.getTime()-d),U}function Bu(n){return n.toISOString()}var Ku=new Se("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:Uu,construct:Vu,instanceOf:Date,represent:Bu});function zu(n){return n==="<<"||n===null}var $u=new Se("tag:yaml.org,2002:merge",{kind:"scalar",resolve:zu}),$r=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function qu(n){if(n===null)return!1;var e,r,t=0,a=n.length,i=$r;for(r=0;r<a;r++)if(e=i.indexOf(n.charAt(r)),!(e>64)){if(e<0)return!1;t+=6}return t%8===0}function Fu(n){var e,r,t=n.replace(/[\r\n=]/g,""),a=t.length,i=$r,o=0,l=[];for(e=0;e<a;e++)e%4===0&&e&&(l.push(o>>16&255),l.push(o>>8&255),l.push(o&255)),o=o<<6|i.indexOf(t.charAt(e));return r=a%4*6,r===0?(l.push(o>>16&255),l.push(o>>8&255),l.push(o&255)):r===18?(l.push(o>>10&255),l.push(o>>2&255)):r===12&&l.push(o>>4&255),new Uint8Array(l)}function Hu(n){var e="",r=0,t,a,i=n.length,o=$r;for(t=0;t<i;t++)t%3===0&&t&&(e+=o[r>>18&63],e+=o[r>>12&63],e+=o[r>>6&63],e+=o[r&63]),r=(r<<8)+n[t];return a=i%3,a===0?(e+=o[r>>18&63],e+=o[r>>12&63],e+=o[r>>6&63],e+=o[r&63]):a===2?(e+=o[r>>10&63],e+=o[r>>4&63],e+=o[r<<2&63],e+=o[64]):a===1&&(e+=o[r>>2&63],e+=o[r<<4&63],e+=o[64],e+=o[64]),e}function Yu(n){return Object.prototype.toString.call(n)==="[object Uint8Array]"}var Wu=new Se("tag:yaml.org,2002:binary",{kind:"scalar",resolve:qu,construct:Fu,predicate:Yu,represent:Hu}),Gu=Object.prototype.hasOwnProperty,Ju=Object.prototype.toString;function Qu(n){if(n===null)return!0;var e=[],r,t,a,i,o,l=n;for(r=0,t=l.length;r<t;r+=1){if(a=l[r],o=!1,Ju.call(a)!=="[object Object]")return!1;for(i in a)if(Gu.call(a,i))if(!o)o=!0;else return!1;if(!o)return!1;if(e.indexOf(i)===-1)e.push(i);else return!1}return!0}function Xu(n){return n!==null?n:[]}var el=new Se("tag:yaml.org,2002:omap",{kind:"sequence",resolve:Qu,construct:Xu}),tl=Object.prototype.toString;function rl(n){if(n===null)return!0;var e,r,t,a,i,o=n;for(i=new Array(o.length),e=0,r=o.length;e<r;e+=1){if(t=o[e],tl.call(t)!=="[object Object]"||(a=Object.keys(t),a.length!==1))return!1;i[e]=[a[0],t[a[0]]]}return!0}function nl(n){if(n===null)return[];var e,r,t,a,i,o=n;for(i=new Array(o.length),e=0,r=o.length;e<r;e+=1)t=o[e],a=Object.keys(t),i[e]=[a[0],t[a[0]]];return i}var al=new Se("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:rl,construct:nl}),il=Object.prototype.hasOwnProperty;function sl(n){if(n===null)return!0;var e,r=n;for(e in r)if(il.call(r,e)&&r[e]!==null)return!1;return!0}function ol(n){return n!==null?n:{}}var ul=new Se("tag:yaml.org,2002:set",{kind:"mapping",resolve:sl,construct:ol});Ru.extend({implicit:[Ku,$u],explicit:[Wu,el,al,ul]});function qn(n){return n===48?"\0":n===97?"\x07":n===98?"\b":n===116||n===9?"	":n===110?`
`:n===118?"\v":n===102?"\f":n===114?"\r":n===101?"\x1B":n===32?" ":n===34?'"':n===47?"/":n===92?"\\":n===78?"":n===95?"":n===76?"\u2028":n===80?"\u2029":""}var ll=new Array(256),cl=new Array(256);for(var nt=0;nt<256;nt++)ll[nt]=qn(nt)?1:0,cl[nt]=qn(nt);const Sa=async(n,e,r,t,a,i,o,l,u)=>(await n.call(fetch,"https://api.promptlayer.com/track-request",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({function_name:e,provider:"langchain",args:r,kwargs:t,tags:a,request_response:i,request_start_time:Math.floor(o/1e3),request_end_time:Math.floor(l/1e3),api_key:u})})).json();var Na={exports:{}};(function(n,e){(function(r){n.exports=r()})(function(){return function r(t,a,i){function o(d,w){if(!a[d]){if(!t[d]){var j=typeof jt=="function"&&jt;if(!w&&j)return j(d,!0);if(l)return l(d,!0);throw new Error("Cannot find module '"+d+"'")}w=a[d]={exports:{}},t[d][0].call(w.exports,function(U){var B=t[d][1][U];return o(B||U)},w,w.exports,r,t,a,i)}return a[d].exports}for(var l=typeof jt=="function"&&jt,u=0;u<i.length;u++)o(i[u]);return o}({1:[function(r,t,a){(function(i,o,l,u,d,w,j,U,B){var k=r("crypto");function M(I,E){E=D(I,E);var m;return(m=E.algorithm!=="passthrough"?k.createHash(E.algorithm):new H).write===void 0&&(m.write=m.update,m.end=m.update),C(E,m).dispatch(I),m.update||m.end(""),m.digest?m.digest(E.encoding==="buffer"?void 0:E.encoding):(I=m.read(),E.encoding!=="buffer"?I.toString(E.encoding):I)}(a=t.exports=M).sha1=function(I){return M(I)},a.keys=function(I){return M(I,{excludeValues:!0,algorithm:"sha1",encoding:"hex"})},a.MD5=function(I){return M(I,{algorithm:"md5",encoding:"hex"})},a.keysMD5=function(I){return M(I,{algorithm:"md5",encoding:"hex",excludeValues:!0})};var P=k.getHashes?k.getHashes().slice():["sha1","md5"],S=(P.push("passthrough"),["buffer","hex","binary","base64"]);function D(I,E){var m={};if(m.algorithm=(E=E||{}).algorithm||"sha1",m.encoding=E.encoding||"hex",m.excludeValues=!!E.excludeValues,m.algorithm=m.algorithm.toLowerCase(),m.encoding=m.encoding.toLowerCase(),m.ignoreUnknown=E.ignoreUnknown===!0,m.respectType=E.respectType!==!1,m.respectFunctionNames=E.respectFunctionNames!==!1,m.respectFunctionProperties=E.respectFunctionProperties!==!1,m.unorderedArrays=E.unorderedArrays===!0,m.unorderedSets=E.unorderedSets!==!1,m.unorderedObjects=E.unorderedObjects!==!1,m.replacer=E.replacer||void 0,m.excludeKeys=E.excludeKeys||void 0,I===void 0)throw new Error("Object argument required.");for(var g=0;g<P.length;++g)P[g].toLowerCase()===m.algorithm.toLowerCase()&&(m.algorithm=P[g]);if(P.indexOf(m.algorithm)===-1)throw new Error('Algorithm "'+m.algorithm+'"  not supported. supported values: '+P.join(", "));if(S.indexOf(m.encoding)===-1&&m.algorithm!=="passthrough")throw new Error('Encoding "'+m.encoding+'"  not supported. supported values: '+S.join(", "));return m}function N(I){if(typeof I=="function")return/^function\s+\w*\s*\(\s*\)\s*{\s+\[native code\]\s+}$/i.exec(Function.prototype.toString.call(I))!=null}function C(I,E,m){m=m||[];function g(f){return E.update?E.update(f,"utf8"):E.write(f,"utf8")}return{dispatch:function(f){return this["_"+((f=I.replacer?I.replacer(f):f)===null?"null":typeof f)](f)},_object:function(f){var A,T=Object.prototype.toString.call(f),W=/\[object (.*)\]/i.exec(T);if(W=(W=W?W[1]:"unknown:["+T+"]").toLowerCase(),0<=(T=m.indexOf(f)))return this.dispatch("[CIRCULAR:"+T+"]");if(m.push(f),l!==void 0&&l.isBuffer&&l.isBuffer(f))return g("buffer:"),g(f);if(W==="object"||W==="function"||W==="asyncfunction")return T=Object.keys(f),I.unorderedObjects&&(T=T.sort()),I.respectType===!1||N(f)||T.splice(0,0,"prototype","__proto__","constructor"),I.excludeKeys&&(T=T.filter(function(G){return!I.excludeKeys(G)})),g("object:"+T.length+":"),A=this,T.forEach(function(G){A.dispatch(G),g(":"),I.excludeValues||A.dispatch(f[G]),g(",")});if(!this["_"+W]){if(I.ignoreUnknown)return g("["+W+"]");throw new Error('Unknown object type "'+W+'"')}this["_"+W](f)},_array:function(f,G){G=G!==void 0?G:I.unorderedArrays!==!1;var T=this;if(g("array:"+f.length+":"),!G||f.length<=1)return f.forEach(function(J){return T.dispatch(J)});var W=[],G=f.map(function(J){var q=new H,Q=m.slice();return C(I,q,Q).dispatch(J),W=W.concat(Q.slice(m.length)),q.read().toString()});return m=m.concat(W),G.sort(),this._array(G,!1)},_date:function(f){return g("date:"+f.toJSON())},_symbol:function(f){return g("symbol:"+f.toString())},_error:function(f){return g("error:"+f.toString())},_boolean:function(f){return g("bool:"+f.toString())},_string:function(f){g("string:"+f.length+":"),g(f.toString())},_function:function(f){g("fn:"),N(f)?this.dispatch("[native]"):this.dispatch(f.toString()),I.respectFunctionNames!==!1&&this.dispatch("function-name:"+String(f.name)),I.respectFunctionProperties&&this._object(f)},_number:function(f){return g("number:"+f.toString())},_xml:function(f){return g("xml:"+f.toString())},_null:function(){return g("Null")},_undefined:function(){return g("Undefined")},_regexp:function(f){return g("regex:"+f.toString())},_uint8array:function(f){return g("uint8array:"),this.dispatch(Array.prototype.slice.call(f))},_uint8clampedarray:function(f){return g("uint8clampedarray:"),this.dispatch(Array.prototype.slice.call(f))},_int8array:function(f){return g("int8array:"),this.dispatch(Array.prototype.slice.call(f))},_uint16array:function(f){return g("uint16array:"),this.dispatch(Array.prototype.slice.call(f))},_int16array:function(f){return g("int16array:"),this.dispatch(Array.prototype.slice.call(f))},_uint32array:function(f){return g("uint32array:"),this.dispatch(Array.prototype.slice.call(f))},_int32array:function(f){return g("int32array:"),this.dispatch(Array.prototype.slice.call(f))},_float32array:function(f){return g("float32array:"),this.dispatch(Array.prototype.slice.call(f))},_float64array:function(f){return g("float64array:"),this.dispatch(Array.prototype.slice.call(f))},_arraybuffer:function(f){return g("arraybuffer:"),this.dispatch(new Uint8Array(f))},_url:function(f){return g("url:"+f.toString())},_map:function(f){return g("map:"),f=Array.from(f),this._array(f,I.unorderedSets!==!1)},_set:function(f){return g("set:"),f=Array.from(f),this._array(f,I.unorderedSets!==!1)},_file:function(f){return g("file:"),this.dispatch([f.name,f.size,f.type,f.lastModfied])},_blob:function(){if(I.ignoreUnknown)return g("[blob]");throw Error(`Hashing Blob objects is currently not supported
(see https://github.com/puleos/object-hash/issues/26)
Use "options.replacer" or "options.ignoreUnknown"
`)},_domwindow:function(){return g("domwindow")},_bigint:function(f){return g("bigint:"+f.toString())},_process:function(){return g("process")},_timer:function(){return g("timer")},_pipe:function(){return g("pipe")},_tcp:function(){return g("tcp")},_udp:function(){return g("udp")},_tty:function(){return g("tty")},_statwatcher:function(){return g("statwatcher")},_securecontext:function(){return g("securecontext")},_connection:function(){return g("connection")},_zlib:function(){return g("zlib")},_context:function(){return g("context")},_nodescript:function(){return g("nodescript")},_httpparser:function(){return g("httpparser")},_dataview:function(){return g("dataview")},_signal:function(){return g("signal")},_fsevent:function(){return g("fsevent")},_tlswrap:function(){return g("tlswrap")}}}function H(){return{buf:"",write:function(I){this.buf+=I},end:function(I){this.buf+=I},read:function(){return this.buf}}}a.writeToStream=function(I,E,m){return m===void 0&&(m=E,E={}),C(E=D(I,E),m).dispatch(I)}}).call(this,r("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/fake_9a5aa49d.js","/")},{buffer:3,crypto:5,lYpoI2:11}],2:[function(r,t,a){(function(i,o,l,u,d,w,j,U,B){(function(k){var M=typeof Uint8Array<"u"?Uint8Array:Array,P="+".charCodeAt(0),S="/".charCodeAt(0),D="0".charCodeAt(0),N="a".charCodeAt(0),C="A".charCodeAt(0),H="-".charCodeAt(0),I="_".charCodeAt(0);function E(m){return m=m.charCodeAt(0),m===P||m===H?62:m===S||m===I?63:m<D?-1:m<D+10?m-D+26+26:m<C+26?m-C:m<N+26?m-N+26:void 0}k.toByteArray=function(m){var g,f;if(0<m.length%4)throw new Error("Invalid string. Length must be a multiple of 4");var A=m.length,A=m.charAt(A-2)==="="?2:m.charAt(A-1)==="="?1:0,T=new M(3*m.length/4-A),W=0<A?m.length-4:m.length,G=0;function J(q){T[G++]=q}for(g=0;g<W;g+=4,0)J((16711680&(f=E(m.charAt(g))<<18|E(m.charAt(g+1))<<12|E(m.charAt(g+2))<<6|E(m.charAt(g+3))))>>16),J((65280&f)>>8),J(255&f);return A==2?J(255&(f=E(m.charAt(g))<<2|E(m.charAt(g+1))>>4)):A==1&&(J((f=E(m.charAt(g))<<10|E(m.charAt(g+1))<<4|E(m.charAt(g+2))>>2)>>8&255),J(255&f)),T},k.fromByteArray=function(m){var g,f,A,T,W=m.length%3,G="";function J(q){return"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(q)}for(g=0,A=m.length-W;g<A;g+=3)f=(m[g]<<16)+(m[g+1]<<8)+m[g+2],G+=J((T=f)>>18&63)+J(T>>12&63)+J(T>>6&63)+J(63&T);switch(W){case 1:G=(G+=J((f=m[m.length-1])>>2))+J(f<<4&63)+"==";break;case 2:G=(G=(G+=J((f=(m[m.length-2]<<8)+m[m.length-1])>>10))+J(f>>4&63))+J(f<<2&63)+"="}return G}})(a===void 0?this.base64js={}:a)}).call(this,r("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/base64-js/lib/b64.js","/node_modules/gulp-browserify/node_modules/base64-js/lib")},{buffer:3,lYpoI2:11}],3:[function(r,t,a){(function(i,o,P,u,d,w,j,U,B){var k=r("base64-js"),M=r("ieee754");function P(h,y,O){if(!(this instanceof P))return new P(h,y,O);var K,R,Y,ie,me=typeof h;if(y==="base64"&&me=="string")for(h=(ie=h).trim?ie.trim():ie.replace(/^\s+|\s+$/g,"");h.length%4!=0;)h+="=";if(me=="number")K=he(h);else if(me=="string")K=P.byteLength(h,y);else{if(me!="object")throw new Error("First argument needs to be a number, array or string.");K=he(h.length)}if(P._useTypedArrays?R=P._augment(new Uint8Array(K)):((R=this).length=K,R._isBuffer=!0),P._useTypedArrays&&typeof h.byteLength=="number")R._set(h);else if(x(ie=h)||P.isBuffer(ie)||ie&&typeof ie=="object"&&typeof ie.length=="number")for(Y=0;Y<K;Y++)P.isBuffer(h)?R[Y]=h.readUInt8(Y):R[Y]=h[Y];else if(me=="string")R.write(h,0,y);else if(me=="number"&&!P._useTypedArrays&&!O)for(Y=0;Y<K;Y++)R[Y]=0;return R}function S(h,y,O,K){return P._charsWritten=ge(function(R){for(var Y=[],ie=0;ie<R.length;ie++)Y.push(255&R.charCodeAt(ie));return Y}(y),h,O,K)}function D(h,y,O,K){return P._charsWritten=ge(function(R){for(var Y,ie,me=[],ye=0;ye<R.length;ye++)ie=R.charCodeAt(ye),Y=ie>>8,ie=ie%256,me.push(ie),me.push(Y);return me}(y),h,O,K)}function N(h,y,O){var K="";O=Math.min(h.length,O);for(var R=y;R<O;R++)K+=String.fromCharCode(h[R]);return K}function C(h,y,O,Y){Y||(V(typeof O=="boolean","missing or invalid endian"),V(y!=null,"missing offset"),V(y+1<h.length,"Trying to read beyond buffer length"));var R,Y=h.length;if(!(Y<=y))return O?(R=h[y],y+1<Y&&(R|=h[y+1]<<8)):(R=h[y]<<8,y+1<Y&&(R|=h[y+1])),R}function H(h,y,O,Y){Y||(V(typeof O=="boolean","missing or invalid endian"),V(y!=null,"missing offset"),V(y+3<h.length,"Trying to read beyond buffer length"));var R,Y=h.length;if(!(Y<=y))return O?(y+2<Y&&(R=h[y+2]<<16),y+1<Y&&(R|=h[y+1]<<8),R|=h[y],y+3<Y&&(R+=h[y+3]<<24>>>0)):(y+1<Y&&(R=h[y+1]<<16),y+2<Y&&(R|=h[y+2]<<8),y+3<Y&&(R|=h[y+3]),R+=h[y]<<24>>>0),R}function I(h,y,O,K){if(K||(V(typeof O=="boolean","missing or invalid endian"),V(y!=null,"missing offset"),V(y+1<h.length,"Trying to read beyond buffer length")),!(h.length<=y))return K=C(h,y,O,!0),32768&K?-1*(65535-K+1):K}function E(h,y,O,K){if(K||(V(typeof O=="boolean","missing or invalid endian"),V(y!=null,"missing offset"),V(y+3<h.length,"Trying to read beyond buffer length")),!(h.length<=y))return K=H(h,y,O,!0),2147483648&K?-1*(4294967295-K+1):K}function m(h,y,O,K){return K||(V(typeof O=="boolean","missing or invalid endian"),V(y+3<h.length,"Trying to read beyond buffer length")),M.read(h,y,O,23,4)}function g(h,y,O,K){return K||(V(typeof O=="boolean","missing or invalid endian"),V(y+7<h.length,"Trying to read beyond buffer length")),M.read(h,y,O,52,8)}function f(h,y,O,K,R){if(R||(V(y!=null,"missing value"),V(typeof K=="boolean","missing or invalid endian"),V(O!=null,"missing offset"),V(O+1<h.length,"trying to write beyond buffer length"),re(y,65535)),R=h.length,!(R<=O))for(var Y=0,ie=Math.min(R-O,2);Y<ie;Y++)h[O+Y]=(y&255<<8*(K?Y:1-Y))>>>8*(K?Y:1-Y)}function A(h,y,O,K,R){if(R||(V(y!=null,"missing value"),V(typeof K=="boolean","missing or invalid endian"),V(O!=null,"missing offset"),V(O+3<h.length,"trying to write beyond buffer length"),re(y,4294967295)),R=h.length,!(R<=O))for(var Y=0,ie=Math.min(R-O,4);Y<ie;Y++)h[O+Y]=y>>>8*(K?Y:3-Y)&255}function T(h,y,O,K,R){R||(V(y!=null,"missing value"),V(typeof K=="boolean","missing or invalid endian"),V(O!=null,"missing offset"),V(O+1<h.length,"Trying to write beyond buffer length"),pe(y,32767,-32768)),h.length<=O||f(h,0<=y?y:65535+y+1,O,K,R)}function W(h,y,O,K,R){R||(V(y!=null,"missing value"),V(typeof K=="boolean","missing or invalid endian"),V(O!=null,"missing offset"),V(O+3<h.length,"Trying to write beyond buffer length"),pe(y,2147483647,-2147483648)),h.length<=O||A(h,0<=y?y:4294967295+y+1,O,K,R)}function G(h,y,O,K,R){R||(V(y!=null,"missing value"),V(typeof K=="boolean","missing or invalid endian"),V(O!=null,"missing offset"),V(O+3<h.length,"Trying to write beyond buffer length"),ve(y,34028234663852886e22,-34028234663852886e22)),h.length<=O||M.write(h,y,O,K,23,4)}function J(h,y,O,K,R){R||(V(y!=null,"missing value"),V(typeof K=="boolean","missing or invalid endian"),V(O!=null,"missing offset"),V(O+7<h.length,"Trying to write beyond buffer length"),ve(y,17976931348623157e292,-17976931348623157e292)),h.length<=O||M.write(h,y,O,K,52,8)}a.Buffer=P,a.SlowBuffer=P,a.INSPECT_MAX_BYTES=50,P.poolSize=8192,P._useTypedArrays=function(){try{var h=new ArrayBuffer(0),y=new Uint8Array(h);return y.foo=function(){return 42},y.foo()===42&&typeof y.subarray=="function"}catch{return!1}}(),P.isEncoding=function(h){switch(String(h).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},P.isBuffer=function(h){return!(h==null||!h._isBuffer)},P.byteLength=function(h,y){var O;switch(h+="",y||"utf8"){case"hex":O=h.length/2;break;case"utf8":case"utf-8":O=F(h).length;break;case"ascii":case"binary":case"raw":O=h.length;break;case"base64":O=se(h).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":O=2*h.length;break;default:throw new Error("Unknown encoding")}return O},P.concat=function(h,y){if(V(x(h),`Usage: Buffer.concat(list, [totalLength])
list should be an Array.`),h.length===0)return new P(0);if(h.length===1)return h[0];if(typeof y!="number")for(R=y=0;R<h.length;R++)y+=h[R].length;for(var O=new P(y),K=0,R=0;R<h.length;R++){var Y=h[R];Y.copy(O,K),K+=Y.length}return O},P.prototype.write=function(h,y,O,K){isFinite(y)?isFinite(O)||(K=O,O=void 0):(ye=K,K=y,y=O,O=ye),y=Number(y)||0;var R,Y,ie,me,ye=this.length-y;switch((!O||ye<(O=Number(O)))&&(O=ye),K=String(K||"utf8").toLowerCase()){case"hex":R=function(Oe,Pe,Ae,we){Ae=Number(Ae)||0;var Ie=Oe.length-Ae;(!we||Ie<(we=Number(we)))&&(we=Ie),V((Ie=Pe.length)%2==0,"Invalid hex string"),Ie/2<we&&(we=Ie/2);for(var Re=0;Re<we;Re++){var xt=parseInt(Pe.substr(2*Re,2),16);V(!isNaN(xt),"Invalid hex string"),Oe[Ae+Re]=xt}return P._charsWritten=2*Re,Re}(this,h,y,O);break;case"utf8":case"utf-8":Y=this,ie=y,me=O,R=P._charsWritten=ge(F(h),Y,ie,me);break;case"ascii":case"binary":R=S(this,h,y,O);break;case"base64":Y=this,ie=y,me=O,R=P._charsWritten=ge(se(h),Y,ie,me);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":R=D(this,h,y,O);break;default:throw new Error("Unknown encoding")}return R},P.prototype.toString=function(h,y,O){var K,R,Y,ie,me=this;if(h=String(h||"utf8").toLowerCase(),y=Number(y)||0,(O=O!==void 0?Number(O):me.length)===y)return"";switch(h){case"hex":K=function(ye,Oe,Pe){var Ae=ye.length;(!Oe||Oe<0)&&(Oe=0),(!Pe||Pe<0||Ae<Pe)&&(Pe=Ae);for(var we="",Ie=Oe;Ie<Pe;Ie++)we+=$(ye[Ie]);return we}(me,y,O);break;case"utf8":case"utf-8":K=function(ye,Oe,Pe){var Ae="",we="";Pe=Math.min(ye.length,Pe);for(var Ie=Oe;Ie<Pe;Ie++)ye[Ie]<=127?(Ae+=Z(we)+String.fromCharCode(ye[Ie]),we=""):we+="%"+ye[Ie].toString(16);return Ae+Z(we)}(me,y,O);break;case"ascii":case"binary":K=N(me,y,O);break;case"base64":R=me,ie=O,K=(Y=y)===0&&ie===R.length?k.fromByteArray(R):k.fromByteArray(R.slice(Y,ie));break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":K=function(ye,Oe,Pe){for(var Ae=ye.slice(Oe,Pe),we="",Ie=0;Ie<Ae.length;Ie+=2)we+=String.fromCharCode(Ae[Ie]+256*Ae[Ie+1]);return we}(me,y,O);break;default:throw new Error("Unknown encoding")}return K},P.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},P.prototype.copy=function(h,y,O,K){if(y=y||0,(K=K||K===0?K:this.length)!==(O=O||0)&&h.length!==0&&this.length!==0){V(O<=K,"sourceEnd < sourceStart"),V(0<=y&&y<h.length,"targetStart out of bounds"),V(0<=O&&O<this.length,"sourceStart out of bounds"),V(0<=K&&K<=this.length,"sourceEnd out of bounds"),K>this.length&&(K=this.length);var R=(K=h.length-y<K-O?h.length-y+O:K)-O;if(R<100||!P._useTypedArrays)for(var Y=0;Y<R;Y++)h[Y+y]=this[Y+O];else h._set(this.subarray(O,O+R),y)}},P.prototype.slice=function(h,y){var O=this.length;if(h=Q(h,O,0),y=Q(y,O,O),P._useTypedArrays)return P._augment(this.subarray(h,y));for(var K=y-h,R=new P(K,void 0,!0),Y=0;Y<K;Y++)R[Y]=this[Y+h];return R},P.prototype.get=function(h){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(h)},P.prototype.set=function(h,y){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(h,y)},P.prototype.readUInt8=function(h,y){if(y||(V(h!=null,"missing offset"),V(h<this.length,"Trying to read beyond buffer length")),!(h>=this.length))return this[h]},P.prototype.readUInt16LE=function(h,y){return C(this,h,!0,y)},P.prototype.readUInt16BE=function(h,y){return C(this,h,!1,y)},P.prototype.readUInt32LE=function(h,y){return H(this,h,!0,y)},P.prototype.readUInt32BE=function(h,y){return H(this,h,!1,y)},P.prototype.readInt8=function(h,y){if(y||(V(h!=null,"missing offset"),V(h<this.length,"Trying to read beyond buffer length")),!(h>=this.length))return 128&this[h]?-1*(255-this[h]+1):this[h]},P.prototype.readInt16LE=function(h,y){return I(this,h,!0,y)},P.prototype.readInt16BE=function(h,y){return I(this,h,!1,y)},P.prototype.readInt32LE=function(h,y){return E(this,h,!0,y)},P.prototype.readInt32BE=function(h,y){return E(this,h,!1,y)},P.prototype.readFloatLE=function(h,y){return m(this,h,!0,y)},P.prototype.readFloatBE=function(h,y){return m(this,h,!1,y)},P.prototype.readDoubleLE=function(h,y){return g(this,h,!0,y)},P.prototype.readDoubleBE=function(h,y){return g(this,h,!1,y)},P.prototype.writeUInt8=function(h,y,O){O||(V(h!=null,"missing value"),V(y!=null,"missing offset"),V(y<this.length,"trying to write beyond buffer length"),re(h,255)),y>=this.length||(this[y]=h)},P.prototype.writeUInt16LE=function(h,y,O){f(this,h,y,!0,O)},P.prototype.writeUInt16BE=function(h,y,O){f(this,h,y,!1,O)},P.prototype.writeUInt32LE=function(h,y,O){A(this,h,y,!0,O)},P.prototype.writeUInt32BE=function(h,y,O){A(this,h,y,!1,O)},P.prototype.writeInt8=function(h,y,O){O||(V(h!=null,"missing value"),V(y!=null,"missing offset"),V(y<this.length,"Trying to write beyond buffer length"),pe(h,127,-128)),y>=this.length||(0<=h?this.writeUInt8(h,y,O):this.writeUInt8(255+h+1,y,O))},P.prototype.writeInt16LE=function(h,y,O){T(this,h,y,!0,O)},P.prototype.writeInt16BE=function(h,y,O){T(this,h,y,!1,O)},P.prototype.writeInt32LE=function(h,y,O){W(this,h,y,!0,O)},P.prototype.writeInt32BE=function(h,y,O){W(this,h,y,!1,O)},P.prototype.writeFloatLE=function(h,y,O){G(this,h,y,!0,O)},P.prototype.writeFloatBE=function(h,y,O){G(this,h,y,!1,O)},P.prototype.writeDoubleLE=function(h,y,O){J(this,h,y,!0,O)},P.prototype.writeDoubleBE=function(h,y,O){J(this,h,y,!1,O)},P.prototype.fill=function(h,y,O){if(y=y||0,O=O||this.length,V(typeof(h=typeof(h=h||0)=="string"?h.charCodeAt(0):h)=="number"&&!isNaN(h),"value is not a number"),V(y<=O,"end < start"),O!==y&&this.length!==0){V(0<=y&&y<this.length,"start out of bounds"),V(0<=O&&O<=this.length,"end out of bounds");for(var K=y;K<O;K++)this[K]=h}},P.prototype.inspect=function(){for(var h=[],y=this.length,O=0;O<y;O++)if(h[O]=$(this[O]),O===a.INSPECT_MAX_BYTES){h[O+1]="...";break}return"<Buffer "+h.join(" ")+">"},P.prototype.toArrayBuffer=function(){if(typeof Uint8Array>"u")throw new Error("Buffer.toArrayBuffer not supported in this browser");if(P._useTypedArrays)return new P(this).buffer;for(var h=new Uint8Array(this.length),y=0,O=h.length;y<O;y+=1)h[y]=this[y];return h.buffer};var q=P.prototype;function Q(h,y,O){return typeof h!="number"?O:y<=(h=~~h)?y:0<=h||0<=(h+=y)?h:0}function he(h){return(h=~~Math.ceil(+h))<0?0:h}function x(h){return(Array.isArray||function(y){return Object.prototype.toString.call(y)==="[object Array]"})(h)}function $(h){return h<16?"0"+h.toString(16):h.toString(16)}function F(h){for(var y=[],O=0;O<h.length;O++){var K=h.charCodeAt(O);if(K<=127)y.push(h.charCodeAt(O));else for(var R=O,Y=(55296<=K&&K<=57343&&O++,encodeURIComponent(h.slice(R,O+1)).substr(1).split("%")),ie=0;ie<Y.length;ie++)y.push(parseInt(Y[ie],16))}return y}function se(h){return k.toByteArray(h)}function ge(h,y,O,K){for(var R=0;R<K&&!(R+O>=y.length||R>=h.length);R++)y[R+O]=h[R];return R}function Z(h){try{return decodeURIComponent(h)}catch{return String.fromCharCode(65533)}}function re(h,y){V(typeof h=="number","cannot write a non-number as a number"),V(0<=h,"specified a negative value for writing an unsigned value"),V(h<=y,"value is larger than maximum value for type"),V(Math.floor(h)===h,"value has a fractional component")}function pe(h,y,O){V(typeof h=="number","cannot write a non-number as a number"),V(h<=y,"value larger than maximum allowed value"),V(O<=h,"value smaller than minimum allowed value"),V(Math.floor(h)===h,"value has a fractional component")}function ve(h,y,O){V(typeof h=="number","cannot write a non-number as a number"),V(h<=y,"value larger than maximum allowed value"),V(O<=h,"value smaller than minimum allowed value")}function V(h,y){if(!h)throw new Error(y||"Failed assertion")}P._augment=function(h){return h._isBuffer=!0,h._get=h.get,h._set=h.set,h.get=q.get,h.set=q.set,h.write=q.write,h.toString=q.toString,h.toLocaleString=q.toString,h.toJSON=q.toJSON,h.copy=q.copy,h.slice=q.slice,h.readUInt8=q.readUInt8,h.readUInt16LE=q.readUInt16LE,h.readUInt16BE=q.readUInt16BE,h.readUInt32LE=q.readUInt32LE,h.readUInt32BE=q.readUInt32BE,h.readInt8=q.readInt8,h.readInt16LE=q.readInt16LE,h.readInt16BE=q.readInt16BE,h.readInt32LE=q.readInt32LE,h.readInt32BE=q.readInt32BE,h.readFloatLE=q.readFloatLE,h.readFloatBE=q.readFloatBE,h.readDoubleLE=q.readDoubleLE,h.readDoubleBE=q.readDoubleBE,h.writeUInt8=q.writeUInt8,h.writeUInt16LE=q.writeUInt16LE,h.writeUInt16BE=q.writeUInt16BE,h.writeUInt32LE=q.writeUInt32LE,h.writeUInt32BE=q.writeUInt32BE,h.writeInt8=q.writeInt8,h.writeInt16LE=q.writeInt16LE,h.writeInt16BE=q.writeInt16BE,h.writeInt32LE=q.writeInt32LE,h.writeInt32BE=q.writeInt32BE,h.writeFloatLE=q.writeFloatLE,h.writeFloatBE=q.writeFloatBE,h.writeDoubleLE=q.writeDoubleLE,h.writeDoubleBE=q.writeDoubleBE,h.fill=q.fill,h.inspect=q.inspect,h.toArrayBuffer=q.toArrayBuffer,h}}).call(this,r("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/buffer/index.js","/node_modules/gulp-browserify/node_modules/buffer")},{"base64-js":2,buffer:3,ieee754:10,lYpoI2:11}],4:[function(r,t,a){(function(i,o,k,u,d,w,j,U,B){var k=r("buffer").Buffer,M=4,P=new k(M);P.fill(0),t.exports={hash:function(S,D,N,C){for(var H=D(function(f,A){f.length%M!=0&&(T=f.length+(M-f.length%M),f=k.concat([f,P],T));for(var T,W=[],G=A?f.readInt32BE:f.readInt32LE,J=0;J<f.length;J+=M)W.push(G.call(f,J));return W}(S=k.isBuffer(S)?S:new k(S),C),8*S.length),D=C,I=new k(N),E=D?I.writeInt32BE:I.writeInt32LE,m=0;m<H.length;m++)E.call(I,H[m],4*m,!0);return I}}}).call(this,r("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/helpers.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],5:[function(r,t,a){(function(i,o,k,u,d,w,j,U,B){var k=r("buffer").Buffer,M=r("./sha"),P=r("./sha256"),S=r("./rng"),D={sha1:M,sha256:P,md5:r("./md5")},N=64,C=new k(N);function H(f,A){var T=D[f=f||"sha1"],W=[];return T||I("algorithm:",f,"is not yet supported"),{update:function(G){return k.isBuffer(G)||(G=new k(G)),W.push(G),G.length,this},digest:function(G){var J=k.concat(W),J=A?function(q,Q,he){k.isBuffer(Q)||(Q=new k(Q)),k.isBuffer(he)||(he=new k(he)),Q.length>N?Q=q(Q):Q.length<N&&(Q=k.concat([Q,C],N));for(var x=new k(N),$=new k(N),F=0;F<N;F++)x[F]=54^Q[F],$[F]=92^Q[F];return he=q(k.concat([x,he])),q(k.concat([$,he]))}(T,A,J):T(J);return W=null,G?J.toString(G):J}}}function I(){var f=[].slice.call(arguments).join(" ");throw new Error([f,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join(`
`))}C.fill(0),a.createHash=function(f){return H(f)},a.createHmac=H,a.randomBytes=function(f,A){if(!A||!A.call)return new k(S(f));try{A.call(this,void 0,new k(S(f)))}catch(T){A(T)}};var E,m=["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],g=function(f){a[f]=function(){I("sorry,",f,"is not implemented yet")}};for(E in m)g(m[E])}).call(this,r("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/index.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./md5":6,"./rng":7,"./sha":8,"./sha256":9,buffer:3,lYpoI2:11}],6:[function(r,t,a){(function(i,o,l,u,d,w,j,U,B){var k=r("./helpers");function M(I,E){I[E>>5]|=128<<E%32,I[14+(E+64>>>9<<4)]=E;for(var m=1732584193,g=-271733879,f=-1732584194,A=271733878,T=0;T<I.length;T+=16){var W=m,G=g,J=f,q=A,m=S(m,g,f,A,I[T+0],7,-680876936),A=S(A,m,g,f,I[T+1],12,-389564586),f=S(f,A,m,g,I[T+2],17,606105819),g=S(g,f,A,m,I[T+3],22,-1044525330);m=S(m,g,f,A,I[T+4],7,-176418897),A=S(A,m,g,f,I[T+5],12,1200080426),f=S(f,A,m,g,I[T+6],17,-1473231341),g=S(g,f,A,m,I[T+7],22,-45705983),m=S(m,g,f,A,I[T+8],7,1770035416),A=S(A,m,g,f,I[T+9],12,-1958414417),f=S(f,A,m,g,I[T+10],17,-42063),g=S(g,f,A,m,I[T+11],22,-1990404162),m=S(m,g,f,A,I[T+12],7,1804603682),A=S(A,m,g,f,I[T+13],12,-40341101),f=S(f,A,m,g,I[T+14],17,-1502002290),m=D(m,g=S(g,f,A,m,I[T+15],22,1236535329),f,A,I[T+1],5,-165796510),A=D(A,m,g,f,I[T+6],9,-1069501632),f=D(f,A,m,g,I[T+11],14,643717713),g=D(g,f,A,m,I[T+0],20,-373897302),m=D(m,g,f,A,I[T+5],5,-701558691),A=D(A,m,g,f,I[T+10],9,38016083),f=D(f,A,m,g,I[T+15],14,-660478335),g=D(g,f,A,m,I[T+4],20,-405537848),m=D(m,g,f,A,I[T+9],5,568446438),A=D(A,m,g,f,I[T+14],9,-1019803690),f=D(f,A,m,g,I[T+3],14,-187363961),g=D(g,f,A,m,I[T+8],20,1163531501),m=D(m,g,f,A,I[T+13],5,-1444681467),A=D(A,m,g,f,I[T+2],9,-51403784),f=D(f,A,m,g,I[T+7],14,1735328473),m=N(m,g=D(g,f,A,m,I[T+12],20,-1926607734),f,A,I[T+5],4,-378558),A=N(A,m,g,f,I[T+8],11,-2022574463),f=N(f,A,m,g,I[T+11],16,1839030562),g=N(g,f,A,m,I[T+14],23,-35309556),m=N(m,g,f,A,I[T+1],4,-1530992060),A=N(A,m,g,f,I[T+4],11,1272893353),f=N(f,A,m,g,I[T+7],16,-155497632),g=N(g,f,A,m,I[T+10],23,-1094730640),m=N(m,g,f,A,I[T+13],4,681279174),A=N(A,m,g,f,I[T+0],11,-358537222),f=N(f,A,m,g,I[T+3],16,-722521979),g=N(g,f,A,m,I[T+6],23,76029189),m=N(m,g,f,A,I[T+9],4,-640364487),A=N(A,m,g,f,I[T+12],11,-421815835),f=N(f,A,m,g,I[T+15],16,530742520),m=C(m,g=N(g,f,A,m,I[T+2],23,-995338651),f,A,I[T+0],6,-198630844),A=C(A,m,g,f,I[T+7],10,1126891415),f=C(f,A,m,g,I[T+14],15,-1416354905),g=C(g,f,A,m,I[T+5],21,-57434055),m=C(m,g,f,A,I[T+12],6,1700485571),A=C(A,m,g,f,I[T+3],10,-1894986606),f=C(f,A,m,g,I[T+10],15,-1051523),g=C(g,f,A,m,I[T+1],21,-2054922799),m=C(m,g,f,A,I[T+8],6,1873313359),A=C(A,m,g,f,I[T+15],10,-30611744),f=C(f,A,m,g,I[T+6],15,-1560198380),g=C(g,f,A,m,I[T+13],21,1309151649),m=C(m,g,f,A,I[T+4],6,-145523070),A=C(A,m,g,f,I[T+11],10,-1120210379),f=C(f,A,m,g,I[T+2],15,718787259),g=C(g,f,A,m,I[T+9],21,-343485551),m=H(m,W),g=H(g,G),f=H(f,J),A=H(A,q)}return Array(m,g,f,A)}function P(I,E,m,g,f,A){return H((E=H(H(E,I),H(g,A)))<<f|E>>>32-f,m)}function S(I,E,m,g,f,A,T){return P(E&m|~E&g,I,E,f,A,T)}function D(I,E,m,g,f,A,T){return P(E&g|m&~g,I,E,f,A,T)}function N(I,E,m,g,f,A,T){return P(E^m^g,I,E,f,A,T)}function C(I,E,m,g,f,A,T){return P(m^(E|~g),I,E,f,A,T)}function H(I,E){var m=(65535&I)+(65535&E);return(I>>16)+(E>>16)+(m>>16)<<16|65535&m}t.exports=function(I){return k.hash(I,M,16)}}).call(this,r("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/md5.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],7:[function(r,t,a){(function(i,o,l,u,d,w,j,U,B){t.exports=function(k){for(var M,P=new Array(k),S=0;S<k;S++)!(3&S)&&(M=4294967296*Math.random()),P[S]=M>>>((3&S)<<3)&255;return P}}).call(this,r("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/rng.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{buffer:3,lYpoI2:11}],8:[function(r,t,a){(function(i,o,l,u,d,w,j,U,B){var k=r("./helpers");function M(D,N){D[N>>5]|=128<<24-N%32,D[15+(N+64>>9<<4)]=N;for(var C,H,I,E=Array(80),m=1732584193,g=-271733879,f=-1732584194,A=271733878,T=-1009589776,W=0;W<D.length;W+=16){for(var G=m,J=g,q=f,Q=A,he=T,x=0;x<80;x++){E[x]=x<16?D[W+x]:S(E[x-3]^E[x-8]^E[x-14]^E[x-16],1);var $=P(P(S(m,5),($=g,H=f,I=A,(C=x)<20?$&H|~$&I:!(C<40)&&C<60?$&H|$&I|H&I:$^H^I)),P(P(T,E[x]),(C=x)<20?1518500249:C<40?1859775393:C<60?-1894007588:-899497514)),T=A,A=f,f=S(g,30),g=m,m=$}m=P(m,G),g=P(g,J),f=P(f,q),A=P(A,Q),T=P(T,he)}return Array(m,g,f,A,T)}function P(D,N){var C=(65535&D)+(65535&N);return(D>>16)+(N>>16)+(C>>16)<<16|65535&C}function S(D,N){return D<<N|D>>>32-N}t.exports=function(D){return k.hash(D,M,20,!0)}}).call(this,r("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],9:[function(r,t,a){(function(i,o,l,u,d,w,j,U,B){function k(N,C){var H=(65535&N)+(65535&C);return(N>>16)+(C>>16)+(H>>16)<<16|65535&H}function M(N,C){var H,I=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),E=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),m=new Array(64);N[C>>5]|=128<<24-C%32,N[15+(C+64>>9<<4)]=C;for(var g,f,A=0;A<N.length;A+=16){for(var T=E[0],W=E[1],G=E[2],J=E[3],q=E[4],Q=E[5],he=E[6],x=E[7],$=0;$<64;$++)m[$]=$<16?N[$+A]:k(k(k((f=m[$-2],S(f,17)^S(f,19)^D(f,10)),m[$-7]),(f=m[$-15],S(f,7)^S(f,18)^D(f,3))),m[$-16]),H=k(k(k(k(x,S(f=q,6)^S(f,11)^S(f,25)),q&Q^~q&he),I[$]),m[$]),g=k(S(g=T,2)^S(g,13)^S(g,22),T&W^T&G^W&G),x=he,he=Q,Q=q,q=k(J,H),J=G,G=W,W=T,T=k(H,g);E[0]=k(T,E[0]),E[1]=k(W,E[1]),E[2]=k(G,E[2]),E[3]=k(J,E[3]),E[4]=k(q,E[4]),E[5]=k(Q,E[5]),E[6]=k(he,E[6]),E[7]=k(x,E[7])}return E}var P=r("./helpers"),S=function(N,C){return N>>>C|N<<32-C},D=function(N,C){return N>>>C};t.exports=function(N){return P.hash(N,M,32,!0)}}).call(this,r("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/crypto-browserify/sha256.js","/node_modules/gulp-browserify/node_modules/crypto-browserify")},{"./helpers":4,buffer:3,lYpoI2:11}],10:[function(r,t,a){(function(i,o,l,u,d,w,j,U,B){a.read=function(k,M,P,S,A){var N,C,H=8*A-S-1,I=(1<<H)-1,E=I>>1,m=-7,g=P?A-1:0,f=P?-1:1,A=k[M+g];for(g+=f,N=A&(1<<-m)-1,A>>=-m,m+=H;0<m;N=256*N+k[M+g],g+=f,m-=8);for(C=N&(1<<-m)-1,N>>=-m,m+=S;0<m;C=256*C+k[M+g],g+=f,m-=8);if(N===0)N=1-E;else{if(N===I)return C?NaN:1/0*(A?-1:1);C+=Math.pow(2,S),N-=E}return(A?-1:1)*C*Math.pow(2,N-S)},a.write=function(k,M,P,S,D,T){var C,H,I=8*T-D-1,E=(1<<I)-1,m=E>>1,g=D===23?Math.pow(2,-24)-Math.pow(2,-77):0,f=S?0:T-1,A=S?1:-1,T=M<0||M===0&&1/M<0?1:0;for(M=Math.abs(M),isNaN(M)||M===1/0?(H=isNaN(M)?1:0,C=E):(C=Math.floor(Math.log(M)/Math.LN2),M*(S=Math.pow(2,-C))<1&&(C--,S*=2),2<=(M+=1<=C+m?g/S:g*Math.pow(2,1-m))*S&&(C++,S/=2),E<=C+m?(H=0,C=E):1<=C+m?(H=(M*S-1)*Math.pow(2,D),C+=m):(H=M*Math.pow(2,m-1)*Math.pow(2,D),C=0));8<=D;k[P+f]=255&H,f+=A,H/=256,D-=8);for(C=C<<D|H,I+=D;0<I;k[P+f]=255&C,f+=A,C/=256,I-=8);k[P+f-A]|=128*T}}).call(this,r("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/ieee754/index.js","/node_modules/gulp-browserify/node_modules/ieee754")},{buffer:3,lYpoI2:11}],11:[function(r,t,a){(function(i,o,l,u,d,w,j,U,B){var k,M,P;function S(){}(i=t.exports={}).nextTick=(M=typeof window<"u"&&window.setImmediate,P=typeof window<"u"&&window.postMessage&&window.addEventListener,M?function(D){return window.setImmediate(D)}:P?(k=[],window.addEventListener("message",function(D){var N=D.source;N!==window&&N!==null||D.data!=="process-tick"||(D.stopPropagation(),0<k.length&&k.shift()())},!0),function(D){k.push(D),window.postMessage("process-tick","*")}):function(D){setTimeout(D,0)}),i.title="browser",i.browser=!0,i.env={},i.argv=[],i.on=S,i.addListener=S,i.once=S,i.off=S,i.removeListener=S,i.removeAllListeners=S,i.emit=S,i.binding=function(D){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(D){throw new Error("process.chdir is not supported")}}).call(this,r("lYpoI2"),typeof self<"u"?self:typeof window<"u"?window:{},r("buffer").Buffer,arguments[3],arguments[4],arguments[5],arguments[6],"/node_modules/gulp-browserify/node_modules/process/browser.js","/node_modules/gulp-browserify/node_modules/process")},{buffer:3,lYpoI2:11}]},{},[1])(1)})})(Na);var dl=Na.exports;const hl=fa(dl),Fn=(...n)=>hl(n.join("_")),pl=new Map;class qr extends Di{constructor(e){super(),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cache=e??new Map}lookup(e,r){return Promise.resolve(this.cache.get(Fn(e,r))??null)}async update(e,r,t){this.cache.set(Fn(e,r),t)}static global(){return new qr(pl)}}class Da extends va{constructor({cache:e,concurrency:r,...t}){super(r?{maxConcurrency:r,...t}:t),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","llms",this._llmType()]}),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof e=="object"?this.cache=e:e?this.cache=qr.global():this.cache=void 0}async generatePrompt(e,r,t){const a=e.map(i=>i.toString());return this.generate(a,r,t)}invocationParams(e){return{}}_flattenLLMResult(e){const r=[];for(let t=0;t<e.generations.length;t+=1){const a=e.generations[t];if(t===0)r.push({generations:[a],llmOutput:e.llmOutput});else{const i=e.llmOutput?{...e.llmOutput,tokenUsage:{}}:void 0;r.push({generations:[a],llmOutput:i})}}return r}async _generateUncached(e,r,t){const a=await Ge.configure(t.callbacks,this.callbacks,t.tags,this.tags,t.metadata,this.metadata,{verbose:this.verbose}),i={options:r,invocation_params:this==null?void 0:this.invocationParams(r)},o=await(a==null?void 0:a.handleLLMStart(this.toJSON(),e,void 0,void 0,i));let l;try{l=await this._generate(e,r,o==null?void 0:o[0])}catch(w){throw await Promise.all((o??[]).map(j=>j==null?void 0:j.handleLLMError(w))),w}const u=this._flattenLLMResult(l);await Promise.all((o??[]).map((w,j)=>w==null?void 0:w.handleLLMEnd(u[j])));const d=(o==null?void 0:o.map(w=>w.runId))||void 0;return Object.defineProperty(l,sa,{value:d?{runIds:d}:void 0,configurable:!0}),l}async generate(e,r,t){if(!Array.isArray(e))throw new Error("Argument 'prompts' is expected to be a string[]");let a;Array.isArray(r)?a={stop:r}:r!=null&&r.timeout&&!r.signal?a={...r,signal:AbortSignal.timeout(r.timeout)}:a=r??{};const i={tags:a.tags,metadata:a.metadata,callbacks:a.callbacks??t};if(delete a.tags,delete a.metadata,delete a.callbacks,!this.cache)return this._generateUncached(e,a,i);const{cache:o}=this,l=this.serialize();l.stop=a.stop??l.stop;const u=`${Object.entries(l).sort()}`,d=[],w=await Promise.all(e.map(async(U,B)=>{const k=await o.lookup(U,u);return k||d.push(B),k}));let j={};if(d.length>0){const U=await this._generateUncached(d.map(B=>e[B]),a,i);await Promise.all(U.generations.map(async(B,k)=>{const M=d[k];return w[M]=B,o.update(e[M],u,B)})),j=U.llmOutput??{}}return{generations:w,llmOutput:j}}async call(e,r,t){const{generations:a}=await this.generate([e],r??{},t);return a[0][0].text}async predict(e,r,t){return this.call(e,r,t)}async predictMessages(e,r,t){const a=Dr(e),i=await this.call(a,r,t);return new la(i)}_identifyingParams(){return{}}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}_modelType(){return"base_llm"}static async deserialize(e){const{_type:r,_model:t,...a}=e;if(t&&t!=="base_llm")throw new Error(`Cannot load LLM with model ${t}`);const i={openai:(await Ne(()=>Promise.resolve().then(()=>yl),void 0,import.meta.url)).OpenAI}[r];if(i===void 0)throw new Error(`Cannot load  LLM with type ${r}`);return new i(a)}}class La extends Da{async _generate(e,r,t){return{generations:await Promise.all(e.map((i,o)=>this._call(i,{...r,promptIndex:o},t).then(l=>[{text:l}])))}}}class Fr extends La{get lc_secrets(){return{apiKey:"HUGGINGFACEHUB_API_KEY"}}constructor(e){if(super(e??{}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"gpt2"}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topK",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.model=(e==null?void 0:e.model)??this.model,this.temperature=(e==null?void 0:e.temperature)??this.temperature,this.maxTokens=(e==null?void 0:e.maxTokens)??this.maxTokens,this.topP=(e==null?void 0:e.topP)??this.topP,this.topK=(e==null?void 0:e.topK)??this.topK,this.frequencyPenalty=(e==null?void 0:e.frequencyPenalty)??this.frequencyPenalty,this.apiKey=(e==null?void 0:e.apiKey)??_e("HUGGINGFACEHUB_API_KEY"),!this.apiKey)throw new Error("Please set an API key for HuggingFace Hub in the environment variable HUGGINGFACEHUB_API_KEY or in the apiKey field of the HuggingFaceInference constructor.")}_llmType(){return"hf"}async _call(e,r){const{HfInference:t}=await Fr.imports(),a=new t(this.apiKey);return(await this.caller.callWithOptions({signal:r.signal},a.textGeneration.bind(a),{model:this.model,parameters:{return_full_text:!1,temperature:this.temperature,max_new_tokens:this.maxTokens,top_p:this.topP,top_k:this.topK,repetition_penalty:this.frequencyPenalty},inputs:e})).generated_text}static async imports(){try{const{HfInference:e}=await Ne(()=>import("./hf.cc923392.js").then(r=>r.i),["./hf.cc923392.js","./NavBar.dcd95840.js","./public.41f5b175.js","./scheduler.2364b0ad.js","./index.be5c2245.js","../assets/NavBar.ffbd0f32.css"],import.meta.url);return{HfInference:e}}catch{throw new Error("Please install huggingface as a dependency with, e.g. `yarn add @huggingface/inference`")}}}class Hr extends La{get callKeys(){return[...super.callKeys,"options","promptIndex"]}get lc_secrets(){return{openAIApiKey:"OPENAI_API_KEY",azureOpenAIApiKey:"AZURE_OPENAI_API_KEY"}}get lc_aliases(){return{modelName:"model",openAIApiKey:"openai_api_key",azureOpenAIApiVersion:"azure_openai_api_version",azureOpenAIApiKey:"azure_openai_api_key",azureOpenAIApiInstanceName:"azure_openai_api_instance_name",azureOpenAIApiDeploymentName:"azure_openai_api_deployment_name"}}constructor(e,r){if(super(e??{}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"presencePenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"n",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"logitBias",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"prefixMessages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"openAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIBasePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.openAIApiKey=(e==null?void 0:e.openAIApiKey)??_e("OPENAI_API_KEY"),this.azureOpenAIApiKey=(e==null?void 0:e.azureOpenAIApiKey)??_e("AZURE_OPENAI_API_KEY"),!this.azureOpenAIApiKey&&!this.openAIApiKey)throw new Error("OpenAI or Azure OpenAI API key not found");if(this.azureOpenAIApiInstanceName=(e==null?void 0:e.azureOpenAIApiInstanceName)??_e("AZURE_OPENAI_API_INSTANCE_NAME"),this.azureOpenAIApiDeploymentName=((e==null?void 0:e.azureOpenAIApiCompletionsDeploymentName)||(e==null?void 0:e.azureOpenAIApiDeploymentName))??(_e("AZURE_OPENAI_API_COMPLETIONS_DEPLOYMENT_NAME")||_e("AZURE_OPENAI_API_DEPLOYMENT_NAME")),this.azureOpenAIApiVersion=(e==null?void 0:e.azureOpenAIApiVersion)??_e("AZURE_OPENAI_API_VERSION"),this.azureOpenAIBasePath=(e==null?void 0:e.azureOpenAIBasePath)??_e("AZURE_OPENAI_BASE_PATH"),this.modelName=(e==null?void 0:e.modelName)??this.modelName,this.prefixMessages=(e==null?void 0:e.prefixMessages)??this.prefixMessages,this.modelKwargs=(e==null?void 0:e.modelKwargs)??{},this.timeout=e==null?void 0:e.timeout,this.temperature=(e==null?void 0:e.temperature)??this.temperature,this.topP=(e==null?void 0:e.topP)??this.topP,this.frequencyPenalty=(e==null?void 0:e.frequencyPenalty)??this.frequencyPenalty,this.presencePenalty=(e==null?void 0:e.presencePenalty)??this.presencePenalty,this.n=(e==null?void 0:e.n)??this.n,this.logitBias=e==null?void 0:e.logitBias,this.maxTokens=e==null?void 0:e.maxTokens,this.stop=e==null?void 0:e.stop,this.streaming=(e==null?void 0:e.streaming)??!1,this.n>1)throw new Error("Cannot use n > 1 in OpenAIChat LLM. Use ChatOpenAI Chat Model instead.");if(this.azureOpenAIApiKey){if(!this.azureOpenAIApiInstanceName)throw new Error("Azure OpenAI API instance name not found");if(!this.azureOpenAIApiDeploymentName)throw new Error("Azure OpenAI API deployment name not found");if(!this.azureOpenAIApiVersion)throw new Error("Azure OpenAI API version not found")}this.clientConfig={apiKey:this.openAIApiKey,...r,...e==null?void 0:e.configuration}}invocationParams(e){return{model:this.modelName,temperature:this.temperature,top_p:this.topP,frequency_penalty:this.frequencyPenalty,presence_penalty:this.presencePenalty,n:this.n,logit_bias:this.logitBias,max_tokens:this.maxTokens===-1?void 0:this.maxTokens,stop:(e==null?void 0:e.stop)??this.stop,stream:this.streaming,...this.modelKwargs}}_identifyingParams(){return{model_name:this.modelName,...this.invocationParams(),...this.clientConfig}}identifyingParams(){return{model_name:this.modelName,...this.invocationParams(),...this.clientConfig}}formatMessages(e){const r={role:"user",content:e};return this.prefixMessages?[...this.prefixMessages,r]:[r]}async _call(e,r,t){var o;const a=this.invocationParams(r);return((o=(a.stream?await new Promise((l,u)=>{let d,w=!1,j=!1;this.completionWithRetry({...a,messages:this.formatMessages(e)},{signal:r.signal,...r.options,adapter:Vt,responseType:"stream",onmessage:U=>{var B,k,M,P,S,D;if(((k=(B=U.data)==null?void 0:B.trim)==null?void 0:k.call(B))==="[DONE]"){if(j||w)return;j=!0,l(d)}else{const N=JSON.parse(U.data);if(N!=null&&N.error){if(w)return;w=!0,u(N.error);return}const C=N;d||(d={id:C.id,object:C.object,created:C.created,model:C.model,choices:[]});for(const H of C.choices)if(H!=null){let I=d.choices.find(E=>E.index===H.index);I||(I={index:H.index,finish_reason:H.finish_reason??void 0},d.choices.push(I)),I.message||(I.message={role:(M=H.delta)==null?void 0:M.role,content:((P=H.delta)==null?void 0:P.content)??""}),I.message.content+=((S=H.delta)==null?void 0:S.content)??"",t==null||t.handleLLMNewToken(((D=H.delta)==null?void 0:D.content)??"",{prompt:r.promptIndex??0,completion:H.index})}!j&&!w&&C.choices.every(H=>H.finish_reason!=null)&&(j=!0,l(d))}}}).catch(U=>{w||(w=!0,u(U))})}):await this.completionWithRetry({...a,messages:this.formatMessages(e)},{signal:r.signal,...r.options})).choices[0].message)==null?void 0:o.content)??""}async completionWithRetry(e,r){if(!this.client){const a={azureOpenAIApiDeploymentName:this.azureOpenAIApiDeploymentName,azureOpenAIApiInstanceName:this.azureOpenAIApiInstanceName,azureOpenAIApiKey:this.azureOpenAIApiKey,azureOpenAIBasePath:this.azureOpenAIBasePath,basePath:this.clientConfig.basePath},i=ca(a),o=new Bt.Configuration({...this.clientConfig,basePath:i,baseOptions:{timeout:this.timeout,...this.clientConfig.baseOptions}});this.client=new Bt.OpenAIApi(o)}const t={adapter:da()?void 0:Vt,...this.clientConfig.baseOptions,...r};return this.azureOpenAIApiKey&&(t.headers={"api-key":this.azureOpenAIApiKey,...t.headers},t.params={"api-version":this.azureOpenAIApiVersion,...t.params}),this.caller.call(this.client.createChatCompletion.bind(this.client),e,t).then(a=>a.data)}_llmType(){return"openai"}}class fl extends Hr{get lc_secrets(){return{promptLayerApiKey:"PROMPTLAYER_API_KEY"}}constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"promptLayerApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"plTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnPromptLayerId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.plTags=(e==null?void 0:e.plTags)??[],this.returnPromptLayerId=(e==null?void 0:e.returnPromptLayerId)??!1,this.promptLayerApiKey=(e==null?void 0:e.promptLayerApiKey)??_e("PROMPTLAYER_API_KEY"),!this.promptLayerApiKey)throw new Error("Missing PromptLayer API key")}async completionWithRetry(e,r){return e.stream?super.completionWithRetry(e,r):await super.completionWithRetry(e)}async _generate(e,r,t){let a;return{generations:await Promise.all(e.map(async o=>{const l=Date.now(),u=await this._call(o,r,t),d=Date.now();a=[{text:u}];const w={text:u},j=await Sa(this.caller,"langchain.PromptLayerOpenAIChat",[o],this._identifyingParams(),this.plTags,w,l,d,this.promptLayerApiKey);return this.returnPromptLayerId===!0&&j.success===!0&&(a[0].generationInfo={promptLayerRequestId:j.request_id}),a}))}}}class Yr extends Da{get callKeys(){return[...super.callKeys,"options"]}get lc_secrets(){return{openAIApiKey:"OPENAI_API_KEY",azureOpenAIApiKey:"AZURE_OPENAI_API_KEY"}}get lc_aliases(){return{modelName:"model",openAIApiKey:"openai_api_key",azureOpenAIApiVersion:"azure_openai_api_version",azureOpenAIApiKey:"azure_openai_api_key",azureOpenAIApiInstanceName:"azure_openai_api_instance_name",azureOpenAIApiDeploymentName:"azure_openai_api_deployment_name"}}constructor(e,r){var t,a,i;if((t=e==null?void 0:e.modelName)!=null&&t.startsWith("gpt-3.5-turbo")||(a=e==null?void 0:e.modelName)!=null&&a.startsWith("gpt-4")||(i=e==null?void 0:e.modelName)!=null&&i.startsWith("gpt-4-32k"))return new Hr(e,r);if(super(e??{}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:.7}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:256}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"presencePenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"n",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"bestOf",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"logitBias",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"text-davinci-003"}),Object.defineProperty(this,"modelKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"batchSize",{enumerable:!0,configurable:!0,writable:!0,value:20}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"openAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIBasePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.openAIApiKey=(e==null?void 0:e.openAIApiKey)??_e("OPENAI_API_KEY"),this.azureOpenAIApiKey=(e==null?void 0:e.azureOpenAIApiKey)??_e("AZURE_OPENAI_API_KEY"),!this.azureOpenAIApiKey&&!this.openAIApiKey)throw new Error("OpenAI or Azure OpenAI API key not found");if(this.azureOpenAIApiInstanceName=(e==null?void 0:e.azureOpenAIApiInstanceName)??_e("AZURE_OPENAI_API_INSTANCE_NAME"),this.azureOpenAIApiDeploymentName=((e==null?void 0:e.azureOpenAIApiCompletionsDeploymentName)||(e==null?void 0:e.azureOpenAIApiDeploymentName))??(_e("AZURE_OPENAI_API_COMPLETIONS_DEPLOYMENT_NAME")||_e("AZURE_OPENAI_API_DEPLOYMENT_NAME")),this.azureOpenAIApiVersion=(e==null?void 0:e.azureOpenAIApiVersion)??_e("AZURE_OPENAI_API_VERSION"),this.azureOpenAIBasePath=(e==null?void 0:e.azureOpenAIBasePath)??_e("AZURE_OPENAI_BASE_PATH"),this.modelName=(e==null?void 0:e.modelName)??this.modelName,this.modelKwargs=(e==null?void 0:e.modelKwargs)??{},this.batchSize=(e==null?void 0:e.batchSize)??this.batchSize,this.timeout=e==null?void 0:e.timeout,this.temperature=(e==null?void 0:e.temperature)??this.temperature,this.maxTokens=(e==null?void 0:e.maxTokens)??this.maxTokens,this.topP=(e==null?void 0:e.topP)??this.topP,this.frequencyPenalty=(e==null?void 0:e.frequencyPenalty)??this.frequencyPenalty,this.presencePenalty=(e==null?void 0:e.presencePenalty)??this.presencePenalty,this.n=(e==null?void 0:e.n)??this.n,this.bestOf=(e==null?void 0:e.bestOf)??this.bestOf,this.logitBias=e==null?void 0:e.logitBias,this.stop=e==null?void 0:e.stop,this.streaming=(e==null?void 0:e.streaming)??!1,this.streaming&&this.bestOf&&this.bestOf>1)throw new Error("Cannot stream results when bestOf > 1");if(this.azureOpenAIApiKey){if(!this.azureOpenAIApiInstanceName)throw new Error("Azure OpenAI API instance name not found");if(!this.azureOpenAIApiDeploymentName)throw new Error("Azure OpenAI API deployment name not found");if(!this.azureOpenAIApiVersion)throw new Error("Azure OpenAI API version not found")}this.clientConfig={apiKey:this.openAIApiKey,...r,...e==null?void 0:e.configuration}}invocationParams(e){return{model:this.modelName,temperature:this.temperature,max_tokens:this.maxTokens,top_p:this.topP,frequency_penalty:this.frequencyPenalty,presence_penalty:this.presencePenalty,n:this.n,best_of:this.bestOf,logit_bias:this.logitBias,stop:(e==null?void 0:e.stop)??this.stop,stream:this.streaming,...this.modelKwargs}}_identifyingParams(){return{model_name:this.modelName,...this.invocationParams(),...this.clientConfig}}identifyingParams(){return this._identifyingParams()}async _generate(e,r,t){const a=sn(e,this.batchSize),i=[],o={},l=this.invocationParams(r);if(l.max_tokens===-1){if(e.length!==1)throw new Error("max_tokens set to -1 not supported for multiple inputs");l.max_tokens=await ps({prompt:e[0],modelName:this.modelName})}for(let d=0;d<a.length;d+=1){const w=l.stream?await new Promise((k,M)=>{const P=[];let S,D=!1,N=!1;this.completionWithRetry({...l,prompt:a[d]},{signal:r.signal,...r.options,adapter:Vt,responseType:"stream",onmessage:C=>{var H,I;if(((I=(H=C.data)==null?void 0:H.trim)==null?void 0:I.call(H))==="[DONE]"){if(N||D)return;N=!0,k({...S,choices:P})}else{const E=JSON.parse(C.data);if(E!=null&&E.error){if(D)return;D=!0,M(E.error);return}const m=E;S||(S={id:m.id,object:m.object,created:m.created,model:m.model});for(const g of m.choices)if(g!=null&&g.index!=null){P[g.index]||(P[g.index]={});const f=P[g.index];f.text=(f.text??"")+(g.text??""),f.finish_reason=g.finish_reason,f.logprobs=g.logprobs,t==null||t.handleLLMNewToken(g.text??"",{prompt:Math.floor(g.index/this.n),completion:g.index%this.n})}!N&&!D&&P.every(g=>g.finish_reason!=null)&&(N=!0,k({...S,choices:P}))}}}).catch(C=>{D||(D=!0,M(C))})}):await this.completionWithRetry({...l,prompt:a[d]},{signal:r.signal,...r.options});i.push(...w.choices);const{completion_tokens:j,prompt_tokens:U,total_tokens:B}=w.usage??{};j&&(o.completionTokens=(o.completionTokens??0)+j),U&&(o.promptTokens=(o.promptTokens??0)+U),B&&(o.totalTokens=(o.totalTokens??0)+B)}return{generations:sn(i,this.n).map(d=>d.map(w=>({text:w.text??"",generationInfo:{finishReason:w.finish_reason,logprobs:w.logprobs}}))),llmOutput:{tokenUsage:o}}}async completionWithRetry(e,r){if(!this.client){const a={azureOpenAIApiDeploymentName:this.azureOpenAIApiDeploymentName,azureOpenAIApiInstanceName:this.azureOpenAIApiInstanceName,azureOpenAIApiKey:this.azureOpenAIApiKey,azureOpenAIBasePath:this.azureOpenAIBasePath,basePath:this.clientConfig.basePath},i=ca(a),o=new Bt.Configuration({...this.clientConfig,basePath:i,baseOptions:{timeout:this.timeout,...this.clientConfig.baseOptions}});this.client=new Bt.OpenAIApi(o)}const t={adapter:da()?void 0:Vt,...this.clientConfig.baseOptions,...r};return this.azureOpenAIApiKey&&(t.headers={"api-key":this.azureOpenAIApiKey,...t.headers},t.params={"api-version":this.azureOpenAIApiVersion,...t.params}),this.caller.call(this.client.createCompletion.bind(this.client),e,t).then(a=>a.data)}_llmType(){return"openai"}}class ml extends Yr{get lc_secrets(){return{promptLayerApiKey:"PROMPTLAYER_API_KEY"}}constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"promptLayerApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"plTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnPromptLayerId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.plTags=(e==null?void 0:e.plTags)??[],this.promptLayerApiKey=(e==null?void 0:e.promptLayerApiKey)??_e("PROMPTLAYER_API_KEY"),this.returnPromptLayerId=e==null?void 0:e.returnPromptLayerId,!this.promptLayerApiKey)throw new Error("Missing PromptLayer API key")}async completionWithRetry(e,r){return e.stream?super.completionWithRetry(e,r):await super.completionWithRetry(e)}async _generate(e,r,t){const a=Date.now(),i=await super._generate(e,r,t);for(let o=0;o<i.generations.length;o+=1){const l=Date.now(),u={text:i.generations[o][0].text,llm_output:i.llmOutput},d=await Sa(this.caller,"langchain.PromptLayerOpenAI",[e[o]],this._identifyingParams(),this.plTags,u,a,l,this.promptLayerApiKey);let w;this.returnPromptLayerId===!0&&(d&&d.success===!0&&(w=d.request_id),i.generations[o][0].generationInfo={...i.generations[o][0].generationInfo,promptLayerRequestId:w})}return i}}const yl=Object.freeze(Object.defineProperty({__proto__:null,OpenAI:Yr,OpenAIChat:Hr,PromptLayerOpenAI:ml,PromptLayerOpenAIChat:fl},Symbol.toStringTag,{value:"Module"}));async function Hn(n,e,r,t,a){if(a==null||a==="")return"Please enter a question";{new Fr({apiKey:n,model:"tiiuae/falcon-7b-instruct",maxTokens:5e3});const i=Zt(Rt,Mt),o=Ir;let l=new vr({openAIApiKey:o});const u=new Yr({temperature:1,openAIApiKey:o,maxTokens:1e3});await i.auth.getUser(),new wr(l,{client:i,tableName:"documents"});const d="Answer this question, always give it a go do not say you don't know: {question}",w=Rr.fromLLM(u,e.asRetriever(),{returnSourceDocuments:!0,questionGeneratorChainOptions:{template:d}});let j={search_distance:.9};const U=await w.call({question:a,chat_history:[],vector_db_kwargs:j});return console.log("result",U),console.log(U.text),U.text}}const{console:gl}=Li,de="src/routes/ask/+page.svelte";function Yn(n,e,r){const t=n.slice();return t[34]=e[r],t}function Wn(n,e,r){const t=n.slice();return t[37]=e[r],t}function Ar(n){let e,r,t,a,i,o="Select Model",l,u,d,w="tiiuae/falcon-7b-instruct",j,U="meta-llama/Llama-2-70b-chat-hf",B,k="OpenAssistant/oasst-sft-4-pythia-12b-epoch-3.5",M,P,S,D="Temperature",N,C,H,I,E,m,g,f="Chat History",A,T,W,G,J,q,Q,he=Ut(n[8]),x=[];for(let F=0;F<he.length;F+=1)x[F]=Tr(Wn(n,he,F));const $={c:function(){e=le("div"),r=le("div"),t=le("div"),a=le("div"),i=le("label"),i.textContent=o,l=Ee(),u=le("select"),d=le("option"),d.textContent=w,j=le("option"),j.textContent=U,B=le("option"),B.textContent=k,M=Ee(),P=le("div"),S=le("label"),S.textContent=D,N=Ee(),C=le("input"),H=Ee(),I=le("span"),E=it(n[1]),m=Ee(),g=le("h2"),g.textContent=f,A=Ee(),T=le("button"),W=le("i"),G=it(" New Chat"),J=Ee();for(let se=0;se<x.length;se+=1)x[se].c();this.h()},l:function(se){e=ce(se,"DIV",{class:!0});var ge=be(e);r=ce(ge,"DIV",{class:!0});var Z=be(r);t=ce(Z,"DIV",{class:!0});var re=be(t);a=ce(re,"DIV",{class:!0});var pe=be(a);i=ce(pe,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),qe(i)!=="svelte-1n8492e"&&(i.textContent=o),l=ke(pe),u=ce(pe,"SELECT",{id:!0,style:!0,class:!0});var ve=be(u);d=ce(ve,"OPTION",{"data-svelte-h":!0}),qe(d)!=="svelte-15kfk1a"&&(d.textContent=w),j=ce(ve,"OPTION",{"data-svelte-h":!0}),qe(j)!=="svelte-14tx9eu"&&(j.textContent=U),B=ce(ve,"OPTION",{"data-svelte-h":!0}),qe(B)!=="svelte-ppycc4"&&(B.textContent=k),ve.forEach(oe),pe.forEach(oe),M=ke(re),P=ce(re,"DIV",{class:!0});var V=be(P);S=ce(V,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),qe(S)!=="svelte-1cqo6os"&&(S.textContent=D),N=ke(V),C=ce(V,"INPUT",{type:!0,id:!0,min:!0,max:!0,step:!0,class:!0}),H=ke(V),I=ce(V,"SPAN",{class:!0});var h=be(I);E=st(h,n[1]),h.forEach(oe),V.forEach(oe),re.forEach(oe),m=ke(Z),g=ce(Z,"H2",{class:!0,"data-svelte-h":!0}),qe(g)!=="svelte-141gz04"&&(g.textContent=f),A=ke(Z),T=ce(Z,"BUTTON",{class:!0});var y=be(T);W=ce(y,"I",{class:!0}),be(W).forEach(oe),G=st(y," New Chat"),y.forEach(oe),J=ke(Z);for(let O=0;O<x.length;O+=1)x[O].l(Z);Z.forEach(oe),ge.forEach(oe),this.h()},h:function(){ae(i,"class","block text-lg font-semibold"),ae(i,"for","model"),ue(i,de,358,16,6197),d.__value="tiiuae/falcon-7b-instruct",Xe(d,d.__value),ue(d,de,367,18,6533),j.__value="meta-llama/Llama-2-70b-chat-hf",Xe(j,j.__value),ue(j,de,370,18,6668),B.__value="OpenAssistant/oasst-sft-4-pythia-12b-epoch-3.5",Xe(B,B.__value),ue(B,de,373,18,6813),ae(u,"id","model"),na(u,"width","200px"),ae(u,"class","select select-sm select-primary"),n[0]===void 0&&Ai(()=>n[16].call(u)),ue(u,de,361,16,6325),ae(a,"class","mb-4"),ue(a,de,357,14,6162),ae(S,"class","block text-lg font-semibold"),ae(S,"for","temperature"),ue(S,de,379,16,7068),ae(C,"type","range"),ae(C,"id","temperature"),ae(C,"min","0.1"),ae(C,"max","1.0"),ae(C,"step","0.2"),ae(C,"class","input input-sm input-primary"),ue(C,de,382,16,7201),ae(I,"class","text-sm ml-2"),ue(I,de,391,16,7492),ae(P,"class","mb-4"),ue(P,de,378,14,7033),ae(t,"class","w-full md:w-3/4 mt-14"),ue(t,de,356,12,6112),ae(g,"class","text-2xl font-bold mb-4"),ue(g,de,395,12,7593),ae(W,"class","fas fa-plus"),ue(W,de,401,14,7839),ae(T,"class","btn btn-primary btn-sm mb-2"),ue(T,de,397,12,7714),ae(r,"class","overflow-y-auto max-h-96"),ue(r,de,355,10,6061),ae(e,"class","absolute left-0 top-0 bg-gray-800 rounded-lg p-4 sidebar s-uhtJAkW7ZDek"),ue(e,de,354,8,5980)},m:function(se,ge){Le(se,e,ge),te(e,r),te(r,t),te(t,a),te(a,i),te(a,l),te(a,u),te(u,d),te(u,j),te(u,B),nn(u,n[0],!0),te(t,M),te(t,P),te(P,S),te(P,N),te(P,C),Xe(C,n[1]),te(P,H),te(P,I),te(I,E),te(r,m),te(r,g),te(r,A),te(r,T),te(T,W),te(T,G),te(r,J);for(let Z=0;Z<x.length;Z+=1)x[Z]&&x[Z].m(r,null);q||(Q=[He(u,"change",n[16]),He(C,"change",n[17]),He(C,"input",n[17]),He(T,"click",n[11],!1,!1,!1,!1)],q=!0)},p:function(se,ge){if(ge[0]&1&&nn(u,se[0]),ge[0]&2&&Xe(C,se[1]),ge[0]&2&&Kt(E,se[1]),ge[0]&24832){he=Ut(se[8]);let Z;for(Z=0;Z<he.length;Z+=1){const re=Wn(se,he,Z);x[Z]?x[Z].p(re,ge):(x[Z]=Tr(re),x[Z].c(),x[Z].m(r,null))}for(;Z<x.length;Z+=1)x[Z].d(1);x.length=he.length}},d:function(se){se&&oe(e),aa(x,se),q=!1,xr(Q)}};return Me("SvelteRegisterBlock",{block:$,id:Ar.name,type:"if",source:"(182:6) {#if isChatHistorySidebarOpen}",ctx:n}),$}function Za(n){let e,r="New Chat";const t={c:function(){e=le("span"),e.textContent=r,this.h()},l:function(i){e=ce(i,"SPAN",{"data-svelte-h":!0}),qe(e)!=="svelte-t9s83e"&&(e.textContent=r),this.h()},h:function(){ue(e,de,413,18,8382)},m:function(i,o){Le(i,e,o)},p:Gn,d:function(i){i&&oe(e)}};return Me("SvelteRegisterBlock",{block:t,id:Za.name,type:"else",source:"(241:16) {:else}",ctx:n}),t}function Ma(n){let e,r=n[37].firstUserMessage+"",t;const a={c:function(){e=le("span"),t=it(r),this.h()},l:function(o){e=ce(o,"SPAN",{});var l=be(e);t=st(l,r),l.forEach(oe),this.h()},h:function(){ue(e,de,411,18,8303)},m:function(o,l){Le(o,e,l),te(e,t)},p:function(o,l){l[0]&256&&r!==(r=o[37].firstUserMessage+"")&&Kt(t,r)},d:function(o){o&&oe(e)}};return Me("SvelteRegisterBlock",{block:a,id:Ma.name,type:"if",source:'(239:16) {#if chat.firstUserMessage !== \\"\\" && chat.firstUserMessage !== null && chat.firstUserMessage !== undefined}',ctx:n}),a}function Tr(n){let e,r,t,a,i,o,l;function u(k,M){return k[37].firstUserMessage!==""&&k[37].firstUserMessage!==null&&k[37].firstUserMessage!==void 0?Ma:Za}let d=u(n),w=d(n);function j(){return n[18](n[37])}function U(){return n[19](n[37])}const B={c:function(){e=le("div"),w.c(),r=Ee(),t=le("button"),a=le("i"),i=Ee(),this.h()},l:function(M){e=ce(M,"DIV",{class:!0});var P=be(e);w.l(P),r=ke(P),t=ce(P,"BUTTON",{class:!0});var S=be(t);a=ce(S,"I",{class:!0}),be(a).forEach(oe),S.forEach(oe),i=ke(P),P.forEach(oe),this.h()},h:function(){ae(a,"class","fas fa-trash-alt"),ue(a,de,420,18,8650),ae(t,"class","btn btn-error btn-sm"),ue(t,de,416,16,8499),ae(e,"class","flex items-center justify-between mb-2 s-uhtJAkW7ZDek"),ue(e,de,406,14,8006)},m:function(M,P){Le(M,e,P),w.m(e,null),te(e,r),te(e,t),te(t,a),te(e,i),o||(l=[He(t,"click",j,!1,!1,!1,!1),He(e,"click",U,!1,!1,!1,!1)],o=!0)},p:function(M,P){n=M,d===(d=u(n))&&w?w.p(n,P):(w.d(1),w=d(n),w&&(w.c(),w.m(e,r)))},d:function(M){M&&oe(e),w.d(),o=!1,xr(l)}};return Me("SvelteRegisterBlock",{block:B,id:Tr.name,type:"each",source:"(234:12) {#each $userChats as chat}",ctx:n}),B}function Ra(n){let e;const r={c:function(){e=le("i"),this.h()},l:function(a){e=ce(a,"I",{class:!0}),be(e).forEach(oe),this.h()},h:function(){ae(e,"class","chevron fas fa-chevron-right text-2xl s-uhtJAkW7ZDek"),ue(e,de,436,10,9042)},m:function(a,i){Le(a,e,i)},d:function(a){a&&oe(e)}};return Me("SvelteRegisterBlock",{block:r,id:Ra.name,type:"else",source:"(264:8) {:else}",ctx:n}),r}function Ua(n){let e;const r={c:function(){e=le("i"),this.h()},l:function(a){e=ce(a,"I",{class:!0}),be(e).forEach(oe),this.h()},h:function(){ae(e,"class","chevron fas fa-chevron-left text-2xl s-uhtJAkW7ZDek"),ue(e,de,434,10,8965)},m:function(a,i){Le(a,e,i)},d:function(a){a&&oe(e)}};return Me("SvelteRegisterBlock",{block:r,id:Ua.name,type:"if",source:"(262:8) {#if isChatHistorySidebarOpen}",ctx:n}),r}function Va(n){let e,r=Ut(n[7]),t=[];for(let i=0;i<r.length;i+=1)t[i]=Er(Yn(n,r,i));const a={c:function(){e=le("div");for(let o=0;o<t.length;o+=1)t[o].c();this.h()},l:function(o){e=ce(o,"DIV",{class:!0});var l=be(e);for(let u=0;u<t.length;u+=1)t[u].l(l);l.forEach(oe),this.h()},h:function(){ae(e,"class","chat-container overflow-y-auto h-96 s-uhtJAkW7ZDek"),ue(e,de,451,12,9560)},m:function(o,l){Le(o,e,l);for(let u=0;u<t.length;u+=1)t[u]&&t[u].m(e,null)},p:function(o,l){if(l[0]&128){r=Ut(o[7]);let u;for(u=0;u<r.length;u+=1){const d=Yn(o,r,u);t[u]?t[u].p(d,l):(t[u]=Er(d),t[u].c(),t[u].m(e,null))}for(;u<t.length;u+=1)t[u].d(1);t.length=r.length}},d:function(o){o&&oe(e),aa(t,o)}};return Me("SvelteRegisterBlock",{block:a,id:Va.name,type:"else",source:"(279:10) {:else}",ctx:n}),a}function Ba(n){let e,r="Select a chat from the history to view messages.";const t={c:function(){e=le("p"),e.textContent=r,this.h()},l:function(i){e=ce(i,"P",{class:!0,"data-svelte-h":!0}),qe(e)!=="svelte-ulna32"&&(e.textContent=r),this.h()},h:function(){ae(e,"class","text-gray-500"),ue(e,de,447,12,9424)},m:function(i,o){Le(i,e,o)},p:Gn,d:function(i){i&&oe(e)}};return Me("SvelteRegisterBlock",{block:t,id:Ba.name,type:"if",source:"(275:10) {#if selectedChatId === null}",ctx:n}),t}function Er(n){let e,r=n[34].message+"",t,a;const i={c:function(){e=le("div"),t=it(r),a=Ee(),this.h()},l:function(l){e=ce(l,"DIV",{class:!0});var u=be(e);t=st(u,r),a=ke(u),u.forEach(oe),this.h()},h:function(){ae(e,"class","chat-message s-uhtJAkW7ZDek"),an(e,"is-user-message",n[34].is_user_message),ue(e,de,453,16,9681)},m:function(l,u){Le(l,e,u),te(e,t),te(e,a)},p:function(l,u){u[0]&128&&r!==(r=l[34].message+"")&&Kt(t,r),u[0]&128&&an(e,"is-user-message",l[34].is_user_message)},d:function(l){l&&oe(e)}};return Me("SvelteRegisterBlock",{block:i,id:Er.name,type:"each",source:"(281:14) {#each $selectedChatMessages as message}",ctx:n}),i}function kr(n){let e,r;const t={c:function(){e=le("div"),r=it(n[4]),this.h()},l:function(i){e=ce(i,"DIV",{class:!0});var o=be(e);r=st(o,n[4]),o.forEach(oe),this.h()},h:function(){ae(e,"class","absolute top-4 left-4 right-4 bg-red-600 text-white p-2 rounded"),ue(e,de,487,6,10669)},m:function(i,o){Le(i,e,o),te(e,r)},p:function(i,o){o[0]&16&&Kt(r,i[4])},d:function(i){i&&oe(e)}};return Me("SvelteRegisterBlock",{block:t,id:kr.name,type:"if",source:"(315:4) {#if errorText !== null}",ctx:n}),t}function Ka(n){let e,r,t,a,i,o,l,u,d,w,j="Chat Messages",U,B,k,M,P,S,D,N,C,H,I,E,m,g;r=new pa({$$inline:!0});let f=n[6]&&Ar(n);function A(x,$){return x[6]?Ua:Ra}let T=A(n),W=T(n);function G(x,$){return x[5]===null?Ba:Va}let J=G(n),q=J(n),Q=n[4]!==null&&kr(n);const he={c:function(){e=le("div"),Jn(r.$$.fragment),t=Ee(),a=le("div"),f&&f.c(),i=Ee(),o=le("div"),W.c(),l=Ee(),u=le("div"),d=le("div"),w=le("h1"),w.textContent=j,U=Ee(),q.c(),B=Ee(),k=le("div"),M=le("div"),P=le("textarea"),D=Ee(),N=le("button"),C=it("Ask the AI and Send Message"),I=Ee(),Q&&Q.c(),this.h()},l:function($){e=ce($,"DIV",{class:!0});var F=be(e);Qn(r.$$.fragment,F),t=ke(F),a=ce(F,"DIV",{class:!0});var se=be(a);f&&f.l(se),i=ke(se),o=ce(se,"DIV",{class:!0,style:!0});var ge=be(o);W.l(ge),ge.forEach(oe),l=ke(se),u=ce(se,"DIV",{class:!0});var Z=be(u);d=ce(Z,"DIV",{class:!0});var re=be(d);w=ce(re,"H1",{class:!0,"data-svelte-h":!0}),qe(w)!=="svelte-fy4ok2"&&(w.textContent=j),U=ke(re),q.l(re),re.forEach(oe),B=ke(Z),k=ce(Z,"DIV",{class:!0});var pe=be(k);M=ce(pe,"DIV",{class:!0});var ve=be(M);P=ce(ve,"TEXTAREA",{id:!0,class:!0}),be(P).forEach(oe),ve.forEach(oe),D=ke(pe),N=ce(pe,"BUTTON",{class:!0});var V=be(N);C=st(V,"Ask the AI and Send Message"),V.forEach(oe),pe.forEach(oe),Z.forEach(oe),se.forEach(oe),I=ke(F),Q&&Q.l(F),F.forEach(oe),this.h()},h:function(){ae(o,"class","sidebar-toggle-btn s-uhtJAkW7ZDek"),na(o,"left","1rem"),ue(o,de,428,6,8799),ae(w,"class","text-4xl font-bold mb-8"),ue(w,de,445,10,9317),ae(d,"class","w-full md:w-3/4"),ue(d,de,444,8,9277),ae(P,"id","question"),ae(P,"class","textarea textarea-primary"),P.disabled=S=n[5]===null||n[3],ue(P,de,467,12,10066),ae(M,"class","form-control mb-4"),ue(M,de,466,10,10022),ae(N,"class","btn btn-primary mb-4"),N.disabled=H=n[5]===null,ue(N,de,476,10,10367),ae(k,"class","w-full md:w-3/4 mt-4"),ue(k,de,465,8,9977),ae(u,"class","flex flex-col items-center justify-center w-full md:w-3/4 mx-auto s-uhtJAkW7ZDek"),ue(u,de,441,6,9174),ae(a,"class","relative flex flex-col md:flex-row min-h-screen s-uhtJAkW7ZDek"),ue(a,de,350,4,5807),ae(e,"class","flex flex-col bg-gray-900 text-white p-4 s-uhtJAkW7ZDek"),ue(e,de,348,2,5733)},m:function($,F){Le($,e,F),Xn(r,e,null),te(e,t),te(e,a),f&&f.m(a,null),te(a,i),te(a,o),W.m(o,null),te(a,l),te(a,u),te(u,d),te(d,w),te(d,U),q.m(d,null),te(u,B),te(u,k),te(k,M),te(M,P),Xe(P,n[2]),te(k,D),te(k,N),te(N,C),te(e,I),Q&&Q.m(e,null),E=!0,m||(g=[He(o,"click",n[20],!1,!1,!1,!1),He(P,"input",n[21]),He(N,"click",n[22],!1,!1,!1,!1)],m=!0)},p:function($,F){$[6]?f?f.p($,F):(f=Ar($),f.c(),f.m(a,i)):f&&(f.d(1),f=null),T!==(T=A($))&&(W.d(1),W=T($),W&&(W.c(),W.m(o,null))),J===(J=G($))&&q?q.p($,F):(q.d(1),q=J($),q&&(q.c(),q.m(d,null))),(!E||F[0]&40&&S!==(S=$[5]===null||$[3]))&&rn(P,"disabled",S),F[0]&4&&Xe(P,$[2]),(!E||F[0]&32&&H!==(H=$[5]===null))&&rn(N,"disabled",H),$[4]!==null?Q?Q.p($,F):(Q=kr($),Q.c(),Q.m(e,null)):Q&&(Q.d(1),Q=null)},i:function($){E||(ea(r.$$.fragment,$),E=!0)},o:function($){ta(r.$$.fragment,$),E=!1},d:function($){$&&oe(e),ra(r),f&&f.d(),W.d(),q.d(),Q&&Q.d(),m=!1,xr(g)}};return Me("SvelteRegisterBlock",{block:he,id:Ka.name,type:"slot",source:"(176:0) <AuthCheck>",ctx:n}),he}function Cr(n){let e,r,t,a;t=new ha({props:{$$slots:{default:[Ka]},$$scope:{ctx:n}},$$inline:!0});const i={c:function(){e=le("link"),r=Ee(),Jn(t.$$.fragment),this.h()},l:function(l){e=ce(l,"LINK",{rel:!0,href:!0}),r=ke(l),Qn(t.$$.fragment,l),this.h()},h:function(){ae(e,"rel","stylesheet"),ae(e,"href","https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"),ue(e,de,343,0,5602)},m:function(l,u){Le(l,e,u),Le(l,r,u),Xn(t,l,u),a=!0},p:function(l,u){const d={};u[0]&511|u[1]&512&&(d.$$scope={dirty:u,ctx:l}),t.$set(d)},i:function(l){a||(ea(t.$$.fragment,l),a=!0)},o:function(l){ta(t.$$.fragment,l),a=!1},d:function(l){l&&(oe(e),oe(r)),ra(t,l)}};return Me("SvelteRegisterBlock",{block:i,id:Cr.name,type:"component",source:"",ctx:n}),i}function bl(n,e,r){let t,a,{$$slots:i={},$$scope:o}=e;ki("Page",i,[]);const l=Zt(Rt,Mt);let u,d,w="tiiuae/falcon-7b-instruct",j=.2,U="",B=!1,k=null,M="";const P=ur([]);Xr(P,"userChats"),en(n,P,Z=>r(8,a=Z));const S=ur([]);Xr(S,"selectedChatMessages"),en(n,S,Z=>r(7,t=Z));let D=null;async function N(){if(B)return;if(await A(),D!==null){const{data:re,error:pe}=await l.from("chats").select("message").eq("chat_id",D);if(pe){r(4,k=pe.message),console.error("Error fetching chat messages:",pe.message);return}}const Z=Fe();P.update(re=>[...re,{chat_id:Z}]),r(5,D=Z),S.set([])}async function C(Z){const{data:re,error:pe}=await l.from("chats").select("message").eq("chat_id",Z).eq("is_user_message",!0).order("timestamp",{ascending:!0}).limit(1);return pe?(r(4,k=pe.message),""):re.length>0?re[0].message:""}async function H(){const Z=await A(),{data:re,error:pe}=await l.from("chats").select("chat_id").eq("user_id",Z);if(pe)console.error("Error fetching user chats:",pe.message),r(4,k=pe.message);else{const ve=new Set,V=[];for(const h of re)if(!ve.has(h.chat_id)){ve.add(h.chat_id);const y=await C(h.chat_id);V.push({...h,firstUserMessage:y})}P.set(V)}}async function I(Z){r(5,D=Z);const{data:re,error:pe}=await l.from("chats").select("message, is_user_message, timestamp").eq("chat_id",Z).order("timestamp",{ascending:!0});pe?(console.error("Error fetching chat messages:",pe.message),r(4,k=pe.message)):S.set(re)}async function E(Z){await l.from("chats").insert([{user_id:Z,chat_id:D,message:U,is_user_message:!0,timestamp:new Date().toISOString()}]),t.length===0&&H(),I(D)}async function m(){if(B)return;r(3,B=!0);const Z=await A();await E(Z),await f(Z),r(3,B=!1)}async function g(Z,re){await l.from("chats").insert([{user_id:re,chat_id:D,message:Z,is_user_message:!1,timestamp:new Date().toISOString()}]),I(D)}async function f(Z){const re=Zt(Rt,Mt),pe=Ir;d=new vr({openAIApiKey:pe}),u=new wr(d,{client:re,tableName:"documents"});let ve=await Hn(on,u,w,j,U);await g(ve,Z),r(2,U="")}async function A(){const Z=await l.auth.getUser();return Z?Z.data.user.id:null}function T(Z){I(Z)}async function W(Z){if(B)return;const re=D===Z,{data:pe,error:ve}=await l.from("chats").delete().eq("chat_id",Z);if(ve)console.error("Error deleting chat:",ve.message),r(4,k=ve.message);else{const V=await A(),{data:h}=await l.from("chats").select("chat_id").eq("user_id",V).order("timestamp",{ascending:!1}).limit(1),y=h.length>0?h[0].chat_id:null;await H(),re&&r(5,D=y)}}tn(async()=>{await H(),await N()});let G=!1;function J(){r(6,G=!G)}const q=[];Object.keys(e).forEach(Z=>{!~q.indexOf(Z)&&Z.slice(0,2)!=="$$"&&Z!=="slot"&&gl.warn(`<Page> was created with unknown prop '${Z}'`)});function Q(){w=Ci(this),r(0,w)}function he(){j=xi(this.value),r(1,j)}const x=Z=>W(Z.chat_id),$=Z=>T(Z.chat_id.slice(0,36)),F=()=>J();function se(){U=this.value,r(2,U)}const ge=()=>m();return n.$capture_state=()=>({chatWithDoc:Hn,AuthCheck:ha,NavBar:pa,onMount:tn,onDestroy:Oi,GoTrueAdminApi:Zi,createClient:Zt,OpenAIEmbeddings:vr,SupabaseVectorStore:wr,writable:ur,HuggingFaceInferenceEmbeddings:Ui,PUBLIC_SUPABASE_KEY:Mt,PUBLIC_SUPABASE_URL:Rt,PUBLIC_HUGGINGFACE_API_KEY:on,PUBLIC_OPENAI_API_KEY:Ir,uuidv4:Fe,supabaseClient:l,vector:u,embeddings:d,model:w,temperature:j,question:U,loading:B,errorText:k,responseText:M,userChats:P,selectedChatMessages:S,selectedChatId:D,createNewChat:N,getFirstUserMessage:C,loadUserChats:H,loadChatMessages:I,sendMessage:E,sendUserMessageAndAIResponse:m,saveAIResponse:g,getAIResponse:f,getCurrentUserId:A,selectChat:T,deleteChat:W,isChatHistorySidebarOpen:G,toggleSidebar:J,$selectedChatMessages:t,$userChats:a}),n.$inject_state=Z=>{"vector"in Z&&(u=Z.vector),"embeddings"in Z&&(d=Z.embeddings),"model"in Z&&r(0,w=Z.model),"temperature"in Z&&r(1,j=Z.temperature),"question"in Z&&r(2,U=Z.question),"loading"in Z&&r(3,B=Z.loading),"errorText"in Z&&r(4,k=Z.errorText),"responseText"in Z&&(M=Z.responseText),"selectedChatId"in Z&&r(5,D=Z.selectedChatId),"isChatHistorySidebarOpen"in Z&&r(6,G=Z.isChatHistorySidebarOpen)},e&&"$$inject"in e&&n.$inject_state(e.$$inject),[w,j,U,B,k,D,G,t,a,P,S,N,m,T,W,J,Q,he,x,$,F,se,ge]}class El extends Ti{constructor(e){super(e),Ei(this,e,bl,Cr,Pi,{},null,[-1,-1]),Me("SvelteRegisterComponent",{component:this,tagName:"Page",options:e,id:Cr.name})}}export{Et as B,Ge as C,Ze as L,xe as P,ys as a,va as b,Os as c,El as d,ba as g,so as l,Sa as p,Ia as r,co as z};
