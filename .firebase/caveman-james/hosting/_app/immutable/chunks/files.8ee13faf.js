import{b as Serializable,D as Document,O as OpenAIEmbeddings,S as SupabaseVectorStore,h as getEnv}from"./NavBar.34dbe8c9.js";import{c as commonjsRequire}from"./_commonjs-dynamic-modules.6fed1697.js";import{e as getAugmentedNamespace,f as commonjsGlobal,c as createClient,P as PUBLIC_SUPABASE_KEY,a as PUBLIC_SUPABASE_URL,d as PUBLIC_OPENAI_API_KEY,_ as __vitePreload}from"./public.42564a77.js";class BaseDocumentTransformer extends Serializable{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","document_transformers"]})}}class TextSplitter extends BaseDocumentTransformer{constructor(n){if(super(n),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","document_transformers","text_splitters"]}),Object.defineProperty(this,"chunkSize",{enumerable:!0,configurable:!0,writable:!0,value:1e3}),Object.defineProperty(this,"chunkOverlap",{enumerable:!0,configurable:!0,writable:!0,value:200}),Object.defineProperty(this,"keepSeparator",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lengthFunction",{enumerable:!0,configurable:!0,writable:!0,value:o=>o.length}),this.chunkSize=(n==null?void 0:n.chunkSize)??this.chunkSize,this.chunkOverlap=(n==null?void 0:n.chunkOverlap)??this.chunkOverlap,this.keepSeparator=(n==null?void 0:n.keepSeparator)??this.keepSeparator,this.lengthFunction=(n==null?void 0:n.lengthFunction)??(o=>o.length),this.chunkOverlap>=this.chunkSize)throw new Error("Cannot have chunkOverlap >= chunkSize")}async transformDocuments(n,o={}){return this.splitDocuments(n,o)}splitOnSeparator(n,o){let t;if(o)if(this.keepSeparator){const u=o.replace(/[/\-\\^$*+?.()|[\]{}]/g,"\\$&");t=n.split(new RegExp(`(?=${u})`))}else t=n.split(o);else t=n.split("");return t.filter(u=>u!=="")}async createDocuments(n,o=[],t={}){const u=o.length>0?o:new Array(n.length).fill({}),{chunkHeader:g="",chunkOverlapHeader:C="(cont'd) ",appendChunkOverlapHeader:_=!1}=t,b=new Array;for(let f=0;f<n.length;f+=1){const m=n[f];let P=1,E=null;for(const A of await this.splitText(m)){let R=g,d=0;if(E){const w=m.indexOf(A),s=m.indexOf(E)+this.lengthFunction(E);d=(m.slice(s,w).match(/\n/g)||[]).length,_&&(R+=C)}P+=d;const k=(A.match(/\n/g)||[]).length,W=u[f].loc&&typeof u[f].loc=="object"?{...u[f].loc}:{};W.lines={from:P,to:P+k};const U={...u[f],loc:W};R+=A,b.push(new Document({pageContent:R,metadata:U})),P+=k,E=A}}return b}async splitDocuments(n,o={}){const t=n.filter(C=>C.pageContent!==void 0),u=t.map(C=>C.pageContent),g=t.map(C=>C.metadata);return this.createDocuments(u,g,o)}joinDocs(n,o){const t=n.join(o).trim();return t===""?null:t}mergeSplits(n,o){const t=[],u=[];let g=0;for(const _ of n){const b=this.lengthFunction(_);if(g+b+(u.length>0?o.length:0)>this.chunkSize&&(g>this.chunkSize&&console.warn(`Created a chunk of size ${g}, +
which is longer than the specified ${this.chunkSize}`),u.length>0)){const f=this.joinDocs(u,o);for(f!==null&&t.push(f);g>this.chunkOverlap||g+b>this.chunkSize&&g>0;)g-=this.lengthFunction(u[0]),u.shift()}u.push(_),g+=b}const C=this.joinDocs(u,o);return C!==null&&t.push(C),t}}class RecursiveCharacterTextSplitter extends TextSplitter{constructor(n){super(n),Object.defineProperty(this,"separators",{enumerable:!0,configurable:!0,writable:!0,value:[`

`,`
`," ",""]}),this.separators=(n==null?void 0:n.separators)??this.separators,this.keepSeparator=(n==null?void 0:n.keepSeparator)??!0}async _splitText(n,o){const t=[];let u=o[o.length-1],g;for(let f=0;f<o.length;f+=1){const m=o[f];if(m===""){u=m;break}if(n.includes(m)){u=m,g=o.slice(f+1);break}}const C=this.splitOnSeparator(n,u);let _=[];const b=this.keepSeparator?"":u;for(const f of C)if(this.lengthFunction(f)<this.chunkSize)_.push(f);else{if(_.length){const m=this.mergeSplits(_,b);t.push(...m),_=[]}if(!g)t.push(f);else{const m=await this._splitText(f,g);t.push(...m)}}if(_.length){const f=this.mergeSplits(_,b);t.push(...f)}return t}async splitText(n){return this._splitText(n,this.separators)}static fromLanguage(n,o){return new RecursiveCharacterTextSplitter({...o,separators:RecursiveCharacterTextSplitter.getSeparatorsForLanguage(n)})}static getSeparatorsForLanguage(n){if(n==="cpp")return[`
class `,`
void `,`
int `,`
float `,`
double `,`
if `,`
for `,`
while `,`
switch `,`
case `,`

`,`
`," ",""];if(n==="go")return[`
func `,`
var `,`
const `,`
type `,`
if `,`
for `,`
switch `,`
case `,`

`,`
`," ",""];if(n==="java")return[`
class `,`
public `,`
protected `,`
private `,`
static `,`
if `,`
for `,`
while `,`
switch `,`
case `,`

`,`
`," ",""];if(n==="js")return[`
function `,`
const `,`
let `,`
var `,`
class `,`
if `,`
for `,`
while `,`
switch `,`
case `,`
default `,`

`,`
`," ",""];if(n==="php")return[`
function `,`
class `,`
if `,`
foreach `,`
while `,`
do `,`
switch `,`
case `,`

`,`
`," ",""];if(n==="proto")return[`
message `,`
service `,`
enum `,`
option `,`
import `,`
syntax `,`

`,`
`," ",""];if(n==="python")return[`
class `,`
def `,`
	def `,`

`,`
`," ",""];if(n==="rst")return[`
===
`,`
---
`,`
***
`,`
.. `,`

`,`
`," ",""];if(n==="ruby")return[`
def `,`
class `,`
if `,`
unless `,`
while `,`
for `,`
do `,`
begin `,`
rescue `,`

`,`
`," ",""];if(n==="rust")return[`
fn `,`
const `,`
let `,`
if `,`
while `,`
for `,`
loop `,`
match `,`
const `,`

`,`
`," ",""];if(n==="scala")return[`
class `,`
object `,`
def `,`
val `,`
var `,`
if `,`
for `,`
while `,`
match `,`
case `,`

`,`
`," ",""];if(n==="swift")return[`
func `,`
class `,`
struct `,`
enum `,`
if `,`
for `,`
while `,`
do `,`
switch `,`
case `,`

`,`
`," ",""];if(n==="markdown")return[`
## `,`
### `,`
#### `,`
##### `,`
###### `,"```\n\n",`

***

`,`

---

`,`

___

`,`

`,`
`," ",""];if(n==="latex")return[`
\\chapter{`,`
\\section{`,`
\\subsection{`,`
\\subsubsection{`,`
\\begin{enumerate}`,`
\\begin{itemize}`,`
\\begin{description}`,`
\\begin{list}`,`
\\begin{quote}`,`
\\begin{quotation}`,`
\\begin{verse}`,`
\\begin{verbatim}`,`
\\begin{align}`,"$$","$",`

`,`
`," ",""];if(n==="html")return["<body>","<div>","<p>","<br>","<li>","<h1>","<h2>","<h3>","<h4>","<h5>","<h6>","<span>","<table>","<tr>","<td>","<th>","<ul>","<ol>","<header>","<footer>","<nav>","<head>","<style>","<script>","<meta>","<title>"," ",""];if(n==="sol")return[`
pragma `,`
using `,`
contract `,`
interface `,`
library `,`
constructor `,`
type `,`
function `,`
event `,`
modifier `,`
error `,`
struct `,`
enum `,`
if `,`
for `,`
while `,`
do while `,`
assembly `,`

`,`
`," ",""];throw new Error(`Language ${n} is not supported.`)}}async function computeSHA1FromFile(Y){const o=await(await fetch(Y)).arrayBuffer(),t=await crypto.subtle.digest("SHA-1",o),g=Array.from(new Uint8Array(t)).map(C=>C.toString(16).padStart(2,"0")).join("");return console.log("readableHash from computeSHA1FromFile: ",g),g}async function computeSHA1FromContent(Y){const o=new TextEncoder().encode(Y),t=await crypto.subtle.digest("SHA-1",o),g=Array.from(new Uint8Array(t)).map(C=>C.toString(16).padStart(2,"0")).join("");return console.log("readableHash from computeSHA1FromContent: ",g),g}var pdf={exports:{}};const __viteBrowserExternal=new Proxy({},{get(Y,n){throw new Error(`Module "" has been externalized for browser compatibility. Cannot access ".${n}" in client code.  See http://vitejs.dev/guide/troubleshooting.html#module-externalized-for-browser-compatibility for more details.`)}}),__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(n,o){module.exports=o()})(commonjsGlobal,function(){return(()=>{var __webpack_modules__=[,(Y,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.addLinkAttributes=k,n.deprecated=y,n.getFilenameFromUrl=w,n.getPdfFilenameFromUrl=s,n.getXfaPageViewport=Q,n.isDataScheme=W,n.isPdfFile=U,n.isValidFetchUrl=p,n.loadScript=v,n.StatTimer=n.RenderingCancelledException=n.PixelsPerInch=n.PDFDateString=n.PageViewport=n.LinkTarget=n.DOMSVGFactory=n.DOMStandardFontDataFactory=n.DOMCMapReaderFactory=n.DOMCanvasFactory=void 0;var t=o(2),u=o(5);const g="noopener noreferrer nofollow",C="http://www.w3.org/2000/svg",_={CSS:96,PDF:72,get PDF_TO_CSS_UNITS(){return(0,t.shadow)(this,"PDF_TO_CSS_UNITS",this.CSS/this.PDF)}};n.PixelsPerInch=_;class b extends u.BaseCanvasFactory{constructor({ownerDocument:T=globalThis.document}={}){super(),this._document=T}_createCanvas(T,M){const q=this._document.createElement("canvas");return q.width=T,q.height=M,q}}n.DOMCanvasFactory=b;async function f(H,T=!1){if(p(H,document.baseURI)){const M=await fetch(H);if(!M.ok)throw new Error(M.statusText);return T?new Uint8Array(await M.arrayBuffer()):(0,t.stringToBytes)(await M.text())}return new Promise((M,q)=>{const G=new XMLHttpRequest;G.open("GET",H,!0),T&&(G.responseType="arraybuffer"),G.onreadystatechange=()=>{if(G.readyState===XMLHttpRequest.DONE){if(G.status===200||G.status===0){let B;if(T&&G.response?B=new Uint8Array(G.response):!T&&G.responseText&&(B=(0,t.stringToBytes)(G.responseText)),B){M(B);return}}q(new Error(G.statusText))}},G.send(null)})}class m extends u.BaseCMapReaderFactory{_fetchData(T,M){return f(T,this.isCompressed).then(q=>({cMapData:q,compressionType:M}))}}n.DOMCMapReaderFactory=m;class P extends u.BaseStandardFontDataFactory{_fetchData(T){return f(T,!0)}}n.DOMStandardFontDataFactory=P;class E extends u.BaseSVGFactory{_createSVG(T){return document.createElementNS(C,T)}}n.DOMSVGFactory=E;class A{constructor({viewBox:T,scale:M,rotation:q,offsetX:G=0,offsetY:B=0,dontFlip:J=!1}){this.viewBox=T,this.scale=M,this.rotation=q,this.offsetX=G,this.offsetY=B;const F=(T[2]+T[0])/2,c=(T[3]+T[1])/2;let e,i,r,h;switch(q%=360,q<0&&(q+=360),q){case 180:e=-1,i=0,r=0,h=1;break;case 90:e=0,i=1,r=1,h=0;break;case 270:e=0,i=-1,r=-1,h=0;break;case 0:e=1,i=0,r=0,h=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}J&&(r=-r,h=-h);let l,S,x,I;e===0?(l=Math.abs(c-T[1])*M+G,S=Math.abs(F-T[0])*M+B,x=Math.abs(T[3]-T[1])*M,I=Math.abs(T[2]-T[0])*M):(l=Math.abs(F-T[0])*M+G,S=Math.abs(c-T[1])*M+B,x=Math.abs(T[2]-T[0])*M,I=Math.abs(T[3]-T[1])*M),this.transform=[e*M,i*M,r*M,h*M,l-e*M*F-r*M*c,S-i*M*F-h*M*c],this.width=x,this.height=I}clone({scale:T=this.scale,rotation:M=this.rotation,offsetX:q=this.offsetX,offsetY:G=this.offsetY,dontFlip:B=!1}={}){return new A({viewBox:this.viewBox.slice(),scale:T,rotation:M,offsetX:q,offsetY:G,dontFlip:B})}convertToViewportPoint(T,M){return t.Util.applyTransform([T,M],this.transform)}convertToViewportRectangle(T){const M=t.Util.applyTransform([T[0],T[1]],this.transform),q=t.Util.applyTransform([T[2],T[3]],this.transform);return[M[0],M[1],q[0],q[1]]}convertToPdfPoint(T,M){return t.Util.applyInverseTransform([T,M],this.transform)}}n.PageViewport=A;class R extends t.BaseException{constructor(T,M){super(T,"RenderingCancelledException"),this.type=M}}n.RenderingCancelledException=R;const d={NONE:0,SELF:1,BLANK:2,PARENT:3,TOP:4};n.LinkTarget=d;function k(H,{url:T,target:M,rel:q,enabled:G=!0}={}){(0,t.assert)(T&&typeof T=="string",'addLinkAttributes: A valid "url" parameter must provided.');const B=(0,t.removeNullCharacters)(T);G?H.href=H.title=B:(H.href="",H.title=`Disabled: ${B}`,H.onclick=()=>!1);let J="";switch(M){case d.NONE:break;case d.SELF:J="_self";break;case d.BLANK:J="_blank";break;case d.PARENT:J="_parent";break;case d.TOP:J="_top";break}H.target=J,H.rel=typeof q=="string"?q:g}function W(H){const T=H.length;let M=0;for(;M<T&&H[M].trim()==="";)M++;return H.substring(M,M+5).toLowerCase()==="data:"}function U(H){return typeof H=="string"&&/\.pdf$/i.test(H)}function w(H){const T=H.indexOf("#"),M=H.indexOf("?"),q=Math.min(T>0?T:H.length,M>0?M:H.length);return H.substring(H.lastIndexOf("/",q)+1,q)}function s(H,T="document.pdf"){if(typeof H!="string")return T;if(W(H))return(0,t.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),T;const M=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,q=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,G=M.exec(H);let B=q.exec(G[1])||q.exec(G[2])||q.exec(G[3]);if(B&&(B=B[0],B.includes("%")))try{B=q.exec(decodeURIComponent(B))[0]}catch{}return B||T}class a{constructor(){this.started=Object.create(null),this.times=[]}time(T){T in this.started&&(0,t.warn)(`Timer is already running for ${T}`),this.started[T]=Date.now()}timeEnd(T){T in this.started||(0,t.warn)(`Timer has not been started for ${T}`),this.times.push({name:T,start:this.started[T],end:Date.now()}),delete this.started[T]}toString(){const T=[];let M=0;for(const q of this.times){const G=q.name;G.length>M&&(M=G.length)}for(const q of this.times){const G=q.end-q.start;T.push(`${q.name.padEnd(M)} ${G}ms
`)}return T.join("")}}n.StatTimer=a;function p(H,T){try{const{protocol:M}=T?new URL(H,T):new URL(H);return M==="http:"||M==="https:"}catch{return!1}}function v(H,T=!1){return new Promise((M,q)=>{const G=document.createElement("script");G.src=H,G.onload=function(B){T&&G.remove(),M(B)},G.onerror=function(){q(new Error(`Cannot load script at: ${G.src}`))},(document.head||document.documentElement).appendChild(G)})}function y(H){console.log("Deprecated API usage: "+H)}let D;class L{static toDateObject(T){if(!T||!(0,t.isString)(T))return null;D||(D=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const M=D.exec(T);if(!M)return null;const q=parseInt(M[1],10);let G=parseInt(M[2],10);G=G>=1&&G<=12?G-1:0;let B=parseInt(M[3],10);B=B>=1&&B<=31?B:1;let J=parseInt(M[4],10);J=J>=0&&J<=23?J:0;let F=parseInt(M[5],10);F=F>=0&&F<=59?F:0;let c=parseInt(M[6],10);c=c>=0&&c<=59?c:0;const e=M[7]||"Z";let i=parseInt(M[8],10);i=i>=0&&i<=23?i:0;let r=parseInt(M[9],10)||0;return r=r>=0&&r<=59?r:0,e==="-"?(J+=i,F+=r):e==="+"&&(J-=i,F-=r),new Date(Date.UTC(q,G,B,J,F,c))}}n.PDFDateString=L;function Q(H,{scale:T=1,rotation:M=0}){const{width:q,height:G}=H.attributes.style,B=[0,0,parseInt(q),parseInt(G)];return new A({viewBox:B,scale:T,rotation:M})}},(Y,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.arrayByteLength=ie,n.arraysToBytes=se,n.assert=J,n.bytesToString=K,n.createObjectURL=Me,n.createPromiseCapability=Oe,n.createValidAbsoluteUrl=e,n.escapeString=Ae,n.getModificationDate=Re,n.getVerbosityLevel=M,n.info=q,n.isArrayBuffer=ke,n.isArrayEqual=Fe,n.isAscii=me,n.isBool=Pe,n.isNum=Ee,n.isSameOrigin=F,n.isString=Te,n.objectFromMap=he,n.objectSize=ne,n.removeNullCharacters=z,n.setVerbosityLevel=T,n.shadow=i,n.string32=ae,n.stringToBytes=Z,n.stringToPDFString=ge,n.stringToUTF16BEString=ye,n.stringToUTF8String=de,n.unreachable=B,n.utf8StringToString=Ce,n.warn=G,n.VerbosityLevel=n.Util=n.UNSUPPORTED_FEATURES=n.UnknownErrorException=n.UnexpectedResponseException=n.TextRenderingMode=n.StreamType=n.RenderingIntentFlag=n.PermissionFlag=n.PasswordResponses=n.PasswordException=n.PageActionEventType=n.OPS=n.MissingPDFException=n.IsLittleEndianCached=n.IsEvalSupportedCached=n.InvalidPDFException=n.ImageKind=n.IDENTITY_MATRIX=n.FormatError=n.FontType=n.FONT_IDENTITY_MATRIX=n.DocumentActionEventType=n.CMapCompressionType=n.BaseException=n.AnnotationType=n.AnnotationStateModelType=n.AnnotationReviewState=n.AnnotationReplyType=n.AnnotationMode=n.AnnotationMarkedState=n.AnnotationFlag=n.AnnotationFieldFlag=n.AnnotationBorderStyleType=n.AnnotationActionEventType=n.AbortException=void 0,o(3);const t=[1,0,0,1,0,0];n.IDENTITY_MATRIX=t;const u=[.001,0,0,.001,0,0];n.FONT_IDENTITY_MATRIX=u;const g={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};n.RenderingIntentFlag=g;const C={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};n.AnnotationMode=C;const _={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};n.PermissionFlag=_;const b={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};n.TextRenderingMode=b;const f={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};n.ImageKind=f;const m={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};n.AnnotationType=m;const P={MARKED:"Marked",REVIEW:"Review"};n.AnnotationStateModelType=P;const E={MARKED:"Marked",UNMARKED:"Unmarked"};n.AnnotationMarkedState=E;const A={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};n.AnnotationReviewState=A;const R={GROUP:"Group",REPLY:"R"};n.AnnotationReplyType=R;const d={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};n.AnnotationFlag=d;const k={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};n.AnnotationFieldFlag=k;const W={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};n.AnnotationBorderStyleType=W;const U={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};n.AnnotationActionEventType=U;const w={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};n.DocumentActionEventType=w;const s={O:"PageOpen",C:"PageClose"};n.PageActionEventType=s;const a={UNKNOWN:"UNKNOWN",FLATE:"FLATE",LZW:"LZW",DCT:"DCT",JPX:"JPX",JBIG:"JBIG",A85:"A85",AHX:"AHX",CCF:"CCF",RLX:"RLX"};n.StreamType=a;const p={UNKNOWN:"UNKNOWN",TYPE1:"TYPE1",TYPE1STANDARD:"TYPE1STANDARD",TYPE1C:"TYPE1C",CIDFONTTYPE0:"CIDFONTTYPE0",CIDFONTTYPE0C:"CIDFONTTYPE0C",TRUETYPE:"TRUETYPE",CIDFONTTYPE2:"CIDFONTTYPE2",TYPE3:"TYPE3",OPENTYPE:"OPENTYPE",TYPE0:"TYPE0",MMTYPE1:"MMTYPE1"};n.FontType=p;const v={ERRORS:0,WARNINGS:1,INFOS:5};n.VerbosityLevel=v;const y={NONE:0,BINARY:1,STREAM:2};n.CMapCompressionType=y;const D={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};n.OPS=D;const L={unknown:"unknown",forms:"forms",javaScript:"javaScript",signatures:"signatures",smask:"smask",shadingPattern:"shadingPattern",font:"font",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontBuildPath:"errorFontBuildPath",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent",errorContentSubStream:"errorContentSubStream"};n.UNSUPPORTED_FEATURES=L;const Q={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};n.PasswordResponses=Q;let H=v.WARNINGS;function T(X){Number.isInteger(X)&&(H=X)}function M(){return H}function q(X){H>=v.INFOS&&console.log(`Info: ${X}`)}function G(X){H>=v.WARNINGS&&console.log(`Warning: ${X}`)}function B(X){throw new Error(X)}function J(X,j){X||B(j)}function F(X,j){let V;try{if(V=new URL(X),!V.origin||V.origin==="null")return!1}catch{return!1}const te=new URL(j,V);return V.origin===te.origin}function c(X){if(!X)return!1;switch(X.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function e(X,j=null,V=null){if(!X)return null;try{if(V&&typeof X=="string"){if(V.addDefaultProtocol&&X.startsWith("www.")){const re=X.match(/\./g);re&&re.length>=2&&(X=`http://${X}`)}if(V.tryConvertEncoding)try{X=de(X)}catch{}}const te=j?new URL(X,j):new URL(X);if(c(te))return te}catch{}return null}function i(X,j,V){return Object.defineProperty(X,j,{value:V,enumerable:!0,configurable:!0,writable:!1}),V}const r=function(){function j(V,te){this.constructor===j&&B("Cannot initialize BaseException."),this.message=V,this.name=te}return j.prototype=new Error,j.constructor=j,j}();n.BaseException=r;class h extends r{constructor(j,V){super(j,"PasswordException"),this.code=V}}n.PasswordException=h;class l extends r{constructor(j,V){super(j,"UnknownErrorException"),this.details=V}}n.UnknownErrorException=l;class S extends r{constructor(j){super(j,"InvalidPDFException")}}n.InvalidPDFException=S;class x extends r{constructor(j){super(j,"MissingPDFException")}}n.MissingPDFException=x;class I extends r{constructor(j,V){super(j,"UnexpectedResponseException"),this.status=V}}n.UnexpectedResponseException=I;class N extends r{constructor(j){super(j,"FormatError")}}n.FormatError=N;class O extends r{constructor(j){super(j,"AbortException")}}n.AbortException=O;const $=/\x00/g;function z(X){return typeof X!="string"?(G("The argument for removeNullCharacters must be a string."),X):X.replace($,"")}function K(X){J(X!==null&&typeof X=="object"&&X.length!==void 0,"Invalid argument for bytesToString");const j=X.length,V=8192;if(j<V)return String.fromCharCode.apply(null,X);const te=[];for(let re=0;re<j;re+=V){const oe=Math.min(re+V,j),ce=X.subarray(re,oe);te.push(String.fromCharCode.apply(null,ce))}return te.join("")}function Z(X){J(typeof X=="string","Invalid argument for stringToBytes");const j=X.length,V=new Uint8Array(j);for(let te=0;te<j;++te)V[te]=X.charCodeAt(te)&255;return V}function ie(X){return X.length!==void 0?X.length:(J(X.byteLength!==void 0,"arrayByteLength - invalid argument."),X.byteLength)}function se(X){const j=X.length;if(j===1&&X[0]instanceof Uint8Array)return X[0];let V=0;for(let oe=0;oe<j;oe++)V+=ie(X[oe]);let te=0;const re=new Uint8Array(V);for(let oe=0;oe<j;oe++){let ce=X[oe];ce instanceof Uint8Array||(typeof ce=="string"?ce=Z(ce):ce=new Uint8Array(ce));const Se=ce.byteLength;re.set(ce,te),te+=Se}return re}function ae(X){return String.fromCharCode(X>>24&255,X>>16&255,X>>8&255,X&255)}function ne(X){return Object.keys(X).length}function he(X){const j=Object.create(null);for(const[V,te]of X)j[V]=te;return j}function ue(){const X=new Uint8Array(4);return X[0]=1,new Uint32Array(X.buffer,0,1)[0]===1}const ee={get value(){return i(this,"value",ue())}};n.IsLittleEndianCached=ee;function le(){try{return new Function(""),!0}catch{return!1}}const _e={get value(){return i(this,"value",le())}};n.IsEvalSupportedCached=_e;const pe=[...Array(256).keys()].map(X=>X.toString(16).padStart(2,"0"));class fe{static makeHexColor(j,V,te){return`#${pe[j]}${pe[V]}${pe[te]}`}static transform(j,V){return[j[0]*V[0]+j[2]*V[1],j[1]*V[0]+j[3]*V[1],j[0]*V[2]+j[2]*V[3],j[1]*V[2]+j[3]*V[3],j[0]*V[4]+j[2]*V[5]+j[4],j[1]*V[4]+j[3]*V[5]+j[5]]}static applyTransform(j,V){const te=j[0]*V[0]+j[1]*V[2]+V[4],re=j[0]*V[1]+j[1]*V[3]+V[5];return[te,re]}static applyInverseTransform(j,V){const te=V[0]*V[3]-V[1]*V[2],re=(j[0]*V[3]-j[1]*V[2]+V[2]*V[5]-V[4]*V[3])/te,oe=(-j[0]*V[1]+j[1]*V[0]+V[4]*V[1]-V[5]*V[0])/te;return[re,oe]}static getAxialAlignedBoundingBox(j,V){const te=fe.applyTransform(j,V),re=fe.applyTransform(j.slice(2,4),V),oe=fe.applyTransform([j[0],j[3]],V),ce=fe.applyTransform([j[2],j[1]],V);return[Math.min(te[0],re[0],oe[0],ce[0]),Math.min(te[1],re[1],oe[1],ce[1]),Math.max(te[0],re[0],oe[0],ce[0]),Math.max(te[1],re[1],oe[1],ce[1])]}static inverseTransform(j){const V=j[0]*j[3]-j[1]*j[2];return[j[3]/V,-j[1]/V,-j[2]/V,j[0]/V,(j[2]*j[5]-j[4]*j[3])/V,(j[4]*j[1]-j[5]*j[0])/V]}static apply3dTransform(j,V){return[j[0]*V[0]+j[1]*V[1]+j[2]*V[2],j[3]*V[0]+j[4]*V[1]+j[5]*V[2],j[6]*V[0]+j[7]*V[1]+j[8]*V[2]]}static singularValueDecompose2dScale(j){const V=[j[0],j[2],j[1],j[3]],te=j[0]*V[0]+j[1]*V[2],re=j[0]*V[1]+j[1]*V[3],oe=j[2]*V[0]+j[3]*V[2],ce=j[2]*V[1]+j[3]*V[3],Se=(te+ce)/2,ve=Math.sqrt((te+ce)**2-4*(te*ce-oe*re))/2,xe=Se+ve||1,we=Se-ve||1;return[Math.sqrt(xe),Math.sqrt(we)]}static normalizeRect(j){const V=j.slice(0);return j[0]>j[2]&&(V[0]=j[2],V[2]=j[0]),j[1]>j[3]&&(V[1]=j[3],V[3]=j[1]),V}static intersect(j,V){function te(Se,ve){return Se-ve}const re=[j[0],j[2],V[0],V[2]].sort(te),oe=[j[1],j[3],V[1],V[3]].sort(te),ce=[];if(j=fe.normalizeRect(j),V=fe.normalizeRect(V),re[0]===j[0]&&re[1]===V[0]||re[0]===V[0]&&re[1]===j[0])ce[0]=re[1],ce[2]=re[2];else return null;if(oe[0]===j[1]&&oe[1]===V[1]||oe[0]===V[1]&&oe[1]===j[1])ce[1]=oe[1],ce[3]=oe[2];else return null;return ce}}n.Util=fe;const be=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function ge(X){const j=X.length,V=[];if(X[0]==="þ"&&X[1]==="ÿ")for(let te=2;te<j;te+=2)V.push(String.fromCharCode(X.charCodeAt(te)<<8|X.charCodeAt(te+1)));else if(X[0]==="ÿ"&&X[1]==="þ")for(let te=2;te<j;te+=2)V.push(String.fromCharCode(X.charCodeAt(te+1)<<8|X.charCodeAt(te)));else for(let te=0;te<j;++te){const re=be[X.charCodeAt(te)];V.push(re?String.fromCharCode(re):X.charAt(te))}return V.join("")}function Ae(X){return X.replace(/([()\\\n\r])/g,j=>j===`
`?"\\n":j==="\r"?"\\r":`\\${j}`)}function me(X){return/^[\x00-\x7F]*$/.test(X)}function ye(X){const j=["þÿ"];for(let V=0,te=X.length;V<te;V++){const re=X.charCodeAt(V);j.push(String.fromCharCode(re>>8&255),String.fromCharCode(re&255))}return j.join("")}function de(X){return decodeURIComponent(escape(X))}function Ce(X){return unescape(encodeURIComponent(X))}function Pe(X){return typeof X=="boolean"}function Ee(X){return typeof X=="number"}function Te(X){return typeof X=="string"}function ke(X){return typeof X=="object"&&X!==null&&X.byteLength!==void 0}function Fe(X,j){if(X.length!==j.length)return!1;for(let V=0,te=X.length;V<te;V++)if(X[V]!==j[V])return!1;return!0}function Re(X=new Date){return[X.getUTCFullYear().toString(),(X.getUTCMonth()+1).toString().padStart(2,"0"),X.getUTCDate().toString().padStart(2,"0"),X.getUTCHours().toString().padStart(2,"0"),X.getUTCMinutes().toString().padStart(2,"0"),X.getUTCSeconds().toString().padStart(2,"0")].join("")}function Oe(){const X=Object.create(null);let j=!1;return Object.defineProperty(X,"settled",{get(){return j}}),X.promise=new Promise(function(V,te){X.resolve=function(re){j=!0,V(re)},X.reject=function(re){j=!0,te(re)}}),X}function Me(X,j="",V=!1){if(URL.createObjectURL&&!V)return URL.createObjectURL(new Blob([X],{type:j}));const te="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let re=`data:${j};base64,`;for(let oe=0,ce=X.length;oe<ce;oe+=3){const Se=X[oe]&255,ve=X[oe+1]&255,xe=X[oe+2]&255,we=Se>>2,Le=(Se&3)<<4|ve>>4,De=oe+1<ce?(ve&15)<<2|xe>>6:64,Ie=oe+2<ce?xe&63:64;re+=te[we]+te[Le]+te[De]+te[Ie]}return re}},(Y,n,o)=>{o(4)},(Y,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.isNodeJS=void 0;const o=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");n.isNodeJS=o},(Y,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.BaseSVGFactory=n.BaseStandardFontDataFactory=n.BaseCMapReaderFactory=n.BaseCanvasFactory=void 0;var t=o(2);class u{constructor(){this.constructor===u&&(0,t.unreachable)("Cannot initialize BaseCanvasFactory.")}create(f,m){if(f<=0||m<=0)throw new Error("Invalid canvas size");const P=this._createCanvas(f,m);return{canvas:P,context:P.getContext("2d")}}reset(f,m,P){if(!f.canvas)throw new Error("Canvas is not specified");if(m<=0||P<=0)throw new Error("Invalid canvas size");f.canvas.width=m,f.canvas.height=P}destroy(f){if(!f.canvas)throw new Error("Canvas is not specified");f.canvas.width=0,f.canvas.height=0,f.canvas=null,f.context=null}_createCanvas(f,m){(0,t.unreachable)("Abstract method `_createCanvas` called.")}}n.BaseCanvasFactory=u;class g{constructor({baseUrl:f=null,isCompressed:m=!1}){this.constructor===g&&(0,t.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=f,this.isCompressed=m}async fetch({name:f}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!f)throw new Error("CMap name must be specified.");const m=this.baseUrl+f+(this.isCompressed?".bcmap":""),P=this.isCompressed?t.CMapCompressionType.BINARY:t.CMapCompressionType.NONE;return this._fetchData(m,P).catch(E=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${m}`)})}_fetchData(f,m){(0,t.unreachable)("Abstract method `_fetchData` called.")}}n.BaseCMapReaderFactory=g;class C{constructor({baseUrl:f=null}){this.constructor===C&&(0,t.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=f}async fetch({filename:f}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!f)throw new Error("Font filename must be specified.");const m=`${this.baseUrl}${f}`;return this._fetchData(m).catch(P=>{throw new Error(`Unable to load font data at: ${m}`)})}_fetchData(f){(0,t.unreachable)("Abstract method `_fetchData` called.")}}n.BaseStandardFontDataFactory=C;class _{constructor(){this.constructor===_&&(0,t.unreachable)("Cannot initialize BaseSVGFactory.")}create(f,m){if(f<=0||m<=0)throw new Error("Invalid SVG dimensions");const P=this._createSVG("svg:svg");return P.setAttribute("version","1.1"),P.setAttribute("width",`${f}px`),P.setAttribute("height",`${m}px`),P.setAttribute("preserveAspectRatio","none"),P.setAttribute("viewBox",`0 0 ${f} ${m}`),P}createElement(f){if(typeof f!="string")throw new Error("Invalid SVG element type");return this._createSVG(f)}_createSVG(f){(0,t.unreachable)("Abstract method `_createSVG` called.")}}n.BaseSVGFactory=_},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var Y;Object.defineProperty(exports,"__esModule",{value:!0}),exports.getDocument=getDocument,exports.setPDFNetworkStreamFactory=setPDFNetworkStreamFactory,exports.version=exports.RenderTask=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultCMapReaderFactory=exports.DefaultCanvasFactory=exports.build=void 0;var _util=__w_pdfjs_require__(2),_display_utils=__w_pdfjs_require__(1),_font_loader=__w_pdfjs_require__(7),_node_utils=__w_pdfjs_require__(8),_annotation_storage=__w_pdfjs_require__(9),_canvas=__w_pdfjs_require__(10),_worker_options=__w_pdfjs_require__(12),_is_node=__w_pdfjs_require__(4),_message_handler=__w_pdfjs_require__(13),_metadata=__w_pdfjs_require__(14),_optional_content_config=__w_pdfjs_require__(15),_transport_stream=__w_pdfjs_require__(16),_xfa_text=__w_pdfjs_require__(17);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DefaultCanvasFactory=_is_node.isNodeJS?_node_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_is_node.isNodeJS?_node_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultStandardFontDataFactory=_is_node.isNodeJS?_node_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;let createPDFNetworkStream;function setPDFNetworkStreamFactory(n){createPDFNetworkStream=n}function getDocument(n){const o=new PDFDocumentLoadingTask;let t;if(typeof n=="string"||n instanceof URL)t={url:n};else if((0,_util.isArrayBuffer)(n))t={data:n};else if(n instanceof PDFDataRangeTransport)t={range:n};else{if(typeof n!="object")throw new Error("Invalid parameter in getDocument, need either string, URL, Uint8Array, or parameter object.");if(!n.url&&!n.data&&!n.range)throw new Error("Invalid parameter object: need either .data, .range or .url");t=n}const u=Object.create(null);let g=null,C=null;for(const b in t){const f=t[b];switch(b){case"url":if(typeof window<"u")try{u[b]=new URL(f,window.location).href;continue}catch(m){(0,_util.warn)(`Cannot create valid URL: "${m}".`)}else if(typeof f=="string"||f instanceof URL){u[b]=f.toString();continue}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.");case"range":g=f;continue;case"worker":C=f;continue;case"data":if(_is_node.isNodeJS&&typeof Buffer<"u"&&f instanceof Buffer)u[b]=new Uint8Array(f);else{if(f instanceof Uint8Array)break;if(typeof f=="string")u[b]=(0,_util.stringToBytes)(f);else if(typeof f=="object"&&f!==null&&!isNaN(f.length))u[b]=new Uint8Array(f);else if((0,_util.isArrayBuffer)(f))u[b]=new Uint8Array(f);else throw new Error("Invalid PDF binary data: either typed array, string, or array-like object is expected in the data property.")}continue}u[b]=f}if(u.rangeChunkSize=u.rangeChunkSize||DEFAULT_RANGE_CHUNK_SIZE,u.CMapReaderFactory=u.CMapReaderFactory||DefaultCMapReaderFactory,u.StandardFontDataFactory=u.StandardFontDataFactory||DefaultStandardFontDataFactory,u.ignoreErrors=u.stopAtErrors!==!0,u.fontExtraProperties=u.fontExtraProperties===!0,u.pdfBug=u.pdfBug===!0,u.enableXfa=u.enableXfa===!0,(typeof u.docBaseUrl!="string"||(0,_display_utils.isDataScheme)(u.docBaseUrl))&&(u.docBaseUrl=null),Number.isInteger(u.maxImageSize)||(u.maxImageSize=-1),typeof u.useWorkerFetch!="boolean"&&(u.useWorkerFetch=u.CMapReaderFactory===_display_utils.DOMCMapReaderFactory&&u.StandardFontDataFactory===_display_utils.DOMStandardFontDataFactory),typeof u.isEvalSupported!="boolean"&&(u.isEvalSupported=!0),typeof u.disableFontFace!="boolean"&&(u.disableFontFace=_is_node.isNodeJS),typeof u.useSystemFonts!="boolean"&&(u.useSystemFonts=!_is_node.isNodeJS&&!u.disableFontFace),typeof u.ownerDocument>"u"&&(u.ownerDocument=globalThis.document),typeof u.disableRange!="boolean"&&(u.disableRange=!1),typeof u.disableStream!="boolean"&&(u.disableStream=!1),typeof u.disableAutoFetch!="boolean"&&(u.disableAutoFetch=!1),(0,_util.setVerbosityLevel)(u.verbosity),!C){const b={verbosity:u.verbosity,port:_worker_options.GlobalWorkerOptions.workerPort};C=b.port?PDFWorker.fromPort(b):new PDFWorker(b),o._worker=C}const _=o.docId;return C.promise.then(function(){if(o.destroyed)throw new Error("Loading aborted");const b=_fetchDocument(C,u,g,_),f=new Promise(function(m){let P;g?P=new _transport_stream.PDFDataTransportStream({length:u.length,initialData:u.initialData,progressiveDone:u.progressiveDone,contentDispositionFilename:u.contentDispositionFilename,disableRange:u.disableRange,disableStream:u.disableStream},g):u.data||(P=createPDFNetworkStream({url:u.url,length:u.length,httpHeaders:u.httpHeaders,withCredentials:u.withCredentials,rangeChunkSize:u.rangeChunkSize,disableRange:u.disableRange,disableStream:u.disableStream})),m(P)});return Promise.all([b,f]).then(function([m,P]){if(o.destroyed)throw new Error("Loading aborted");const E=new _message_handler.MessageHandler(_,m,C.port);E.postMessageTransfers=C.postMessageTransfers;const A=new WorkerTransport(E,o,P,u);o._transport=A,E.send("Ready",null)})}).catch(o._capability.reject),o}async function _fetchDocument(n,o,t,u){if(n.destroyed)throw new Error("Worker was destroyed");t&&(o.length=t.length,o.initialData=t.initialData,o.progressiveDone=t.progressiveDone,o.contentDispositionFilename=t.contentDispositionFilename);const g=await n.messageHandler.sendWithPromise("GetDocRequest",{docId:u,apiVersion:"2.11.338",source:{data:o.data,url:o.url,password:o.password,disableAutoFetch:o.disableAutoFetch,rangeChunkSize:o.rangeChunkSize,length:o.length},maxImageSize:o.maxImageSize,disableFontFace:o.disableFontFace,postMessageTransfers:n.postMessageTransfers,docBaseUrl:o.docBaseUrl,ignoreErrors:o.ignoreErrors,isEvalSupported:o.isEvalSupported,fontExtraProperties:o.fontExtraProperties,enableXfa:o.enableXfa,useSystemFonts:o.useSystemFonts,cMapUrl:o.useWorkerFetch?o.cMapUrl:null,standardFontDataUrl:o.useWorkerFetch?o.standardFontDataUrl:null});if(n.destroyed)throw new Error("Worker was destroyed");return g}class PDFDocumentLoadingTask{static get idCounters(){return(0,_util.shadow)(this,"idCounters",{doc:0})}constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId=`d${PDFDocumentLoadingTask.idCounters.doc++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}get promise(){return this._capability.promise}async destroy(){var o;this.destroyed=!0,await((o=this._transport)==null?void 0:o.destroy()),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}}exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(o,t,u=!1,g=null){this.length=o,this.initialData=t,this.progressiveDone=u,this.contentDispositionFilename=g,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(o){this._rangeListeners.push(o)}addProgressListener(o){this._progressListeners.push(o)}addProgressiveReadListener(o){this._progressiveReadListeners.push(o)}addProgressiveDoneListener(o){this._progressiveDoneListeners.push(o)}onDataRange(o,t){for(const u of this._rangeListeners)u(o,t)}onDataProgress(o,t){this._readyCapability.promise.then(()=>{for(const u of this._progressListeners)u(o,t)})}onDataProgressiveRead(o){this._readyCapability.promise.then(()=>{for(const t of this._progressiveReadListeners)t(o)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const o of this._progressiveDoneListeners)o()})}transportReady(){this._readyCapability.resolve()}requestDataRange(o,t){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(o,t){this._pdfInfo=o,this._transport=t,Object.defineProperty(this,"fingerprint",{get(){return(0,_display_utils.deprecated)("`PDFDocumentProxy.fingerprint`, please use `PDFDocumentProxy.fingerprints` instead."),this.fingerprints[0]}})}get annotationStorage(){return this._transport.annotationStorage}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return!!this._transport._htmlForXfa}get allXfaHtml(){return this._transport._htmlForXfa}getPage(o){return this._transport.getPage(o)}getPageIndex(o){return this._transport.getPageIndex(o)}getDestinations(){return this._transport.getDestinations()}getDestination(o){return this._transport.getDestination(o)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}getStats(){return this._transport.getStats()}cleanup(o=!1){return this._transport.startCleanup(o||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}saveDocument(){return this._transport.annotationStorage.size<=0&&(0,_display_utils.deprecated)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this._transport.saveDocument()}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(o,t,u,g,C=!1){this._pageIndex=o,this._pageInfo=t,this._ownerDocument=g,this._transport=u,this._stats=C?new _display_utils.StatTimer:null,this._pdfBug=C,this.commonObjs=u.commonObjs,this.objs=new PDFObjects,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this._annotationPromises=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:o,rotation:t=this.rotate,offsetX:u=0,offsetY:g=0,dontFlip:C=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:o,rotation:t,offsetX:u,offsetY:g,dontFlip:C})}getAnnotations({intent:o="display"}={}){const t=this._transport.getRenderingIntent(o);let u=this._annotationPromises.get(t.cacheKey);return u||(u=this._transport.getAnnotations(this._pageIndex,t.renderingIntent),this._annotationPromises.set(t.cacheKey,u),u=u.then(g=>{for(const C of g)C.titleObj!==void 0&&Object.defineProperty(C,"title",{get(){return(0,_display_utils.deprecated)("`title`-property on annotation, please use `titleObj` instead."),C.titleObj.str}}),C.contentsObj!==void 0&&Object.defineProperty(C,"contents",{get(){return(0,_display_utils.deprecated)("`contents`-property on annotation, please use `contentsObj` instead."),C.contentsObj.str}});return g})),u}getJSActions(){return this._jsActionsPromise||(this._jsActionsPromise=this._transport.getPageJSActions(this._pageIndex))}async getXfa(){var o;return((o=this._transport._htmlForXfa)==null?void 0:o.children[this._pageIndex])||null}render({canvasContext:o,viewport:t,intent:u="display",annotationMode:g=_util.AnnotationMode.ENABLE,transform:C=null,imageLayer:_=null,canvasFactory:b=null,background:f=null,optionalContentConfigPromise:m=null}){var U,w;((U=arguments[0])==null?void 0:U.renderInteractiveForms)!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `renderInteractiveForms`-option, please use the `annotationMode`-option instead."),arguments[0].renderInteractiveForms===!0&&g===_util.AnnotationMode.ENABLE&&(g=_util.AnnotationMode.ENABLE_FORMS)),((w=arguments[0])==null?void 0:w.includeAnnotationStorage)!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `includeAnnotationStorage`-option, please use the `annotationMode`-option instead."),arguments[0].includeAnnotationStorage===!0&&g===_util.AnnotationMode.ENABLE&&(g=_util.AnnotationMode.ENABLE_STORAGE)),this._stats&&this._stats.time("Overall");const P=this._transport.getRenderingIntent(u,g);this.pendingCleanup=!1,m||(m=this._transport.getOptionalContentConfig());let E=this._intentStates.get(P.cacheKey);E||(E=Object.create(null),this._intentStates.set(P.cacheKey,E)),E.streamReaderCancelTimeout&&(clearTimeout(E.streamReaderCancelTimeout),E.streamReaderCancelTimeout=null);const A=b||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),R=!!(P.renderingIntent&_util.RenderingIntentFlag.PRINT);E.displayReadyCapability||(E.displayReadyCapability=(0,_util.createPromiseCapability)(),E.operatorList={fnArray:[],argsArray:[],lastChunk:!1},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(P));const d=s=>{E.renderTasks.delete(k),(this.cleanupAfterRender||R)&&(this.pendingCleanup=!0),this._tryCleanup(),s?(k.capability.reject(s),this._abortOperatorList({intentState:E,reason:s instanceof Error?s:new Error(s)})):k.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"))},k=new InternalRenderTask({callback:d,params:{canvasContext:o,viewport:t,transform:C,imageLayer:_,background:f},objs:this.objs,commonObjs:this.commonObjs,operatorList:E.operatorList,pageIndex:this._pageIndex,canvasFactory:A,useRequestAnimationFrame:!R,pdfBug:this._pdfBug});(E.renderTasks||(E.renderTasks=new Set)).add(k);const W=k.task;return Promise.all([E.displayReadyCapability.promise,m]).then(([s,a])=>{if(this.pendingCleanup){d();return}this._stats&&this._stats.time("Rendering"),k.initializeGraphics({transparency:s,optionalContentConfig:a}),k.operatorListChanged()}).catch(d),W}getOperatorList({intent:o="display",annotationMode:t=_util.AnnotationMode.ENABLE}={}){function u(){C.operatorList.lastChunk&&(C.opListReadCapability.resolve(C.operatorList),C.renderTasks.delete(_))}const g=this._transport.getRenderingIntent(o,t,!0);let C=this._intentStates.get(g.cacheKey);C||(C=Object.create(null),this._intentStates.set(g.cacheKey,C));let _;return C.opListReadCapability||(_=Object.create(null),_.operatorListChanged=u,C.opListReadCapability=(0,_util.createPromiseCapability)(),(C.renderTasks||(C.renderTasks=new Set)).add(_),C.operatorList={fnArray:[],argsArray:[],lastChunk:!1},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(g)),C.opListReadCapability.promise}streamTextContent({normalizeWhitespace:o=!1,disableCombineTextItems:t=!1,includeMarkedContent:u=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,normalizeWhitespace:o===!0,combineTextItems:t!==!0,includeMarkedContent:u===!0},{highWaterMark:100,size(C){return C.items.length}})}getTextContent(o={}){if(this._transport._htmlForXfa)return this.getXfa().then(u=>_xfa_text.XfaText.textContent(u));const t=this.streamTextContent(o);return new Promise(function(u,g){function C(){_.read().then(function({value:f,done:m}){if(m){u(b);return}Object.assign(b.styles,f.styles),b.items.push(...f.items),C()},g)}const _=t.getReader(),b={items:[],styles:Object.create(null)};C()})}getStructTree(){return this._structTreePromise||(this._structTreePromise=this._transport.getStructTree(this._pageIndex))}_destroy(){this.destroyed=!0,this._transport.pageCache[this._pageIndex]=null;const o=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const u of t.renderTasks)o.push(u.completed),u.cancel();return this.objs.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,this.pendingCleanup=!1,Promise.all(o)}cleanup(o=!1){return this.pendingCleanup=!0,this._tryCleanup(o)}_tryCleanup(o=!1){if(!this.pendingCleanup)return!1;for(const{renderTasks:t,operatorList:u}of this._intentStates.values())if(t.size>0||!u.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,o&&this._stats&&(this._stats=new _display_utils.StatTimer),this.pendingCleanup=!1,!0}_startRenderPage(o,t){const u=this._intentStates.get(t);u&&(this._stats&&this._stats.timeEnd("Page Request"),u.displayReadyCapability&&u.displayReadyCapability.resolve(o))}_renderPageChunk(o,t){for(let u=0,g=o.length;u<g;u++)t.operatorList.fnArray.push(o.fnArray[u]),t.operatorList.argsArray.push(o.argsArray[u]);t.operatorList.lastChunk=o.lastChunk;for(const u of t.renderTasks)u.operatorListChanged();o.lastChunk&&this._tryCleanup()}_pumpOperatorList({renderingIntent:o,cacheKey:t}){const g=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:o,cacheKey:t,annotationStorage:o&_util.RenderingIntentFlag.ANNOTATIONS_STORAGE?this._transport.annotationStorage.serializable:null}).getReader(),C=this._intentStates.get(t);C.streamReader=g;const _=()=>{g.read().then(({value:b,done:f})=>{if(f){C.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(b,C),_())},b=>{if(C.streamReader=null,!this._transport.destroyed){if(C.operatorList){C.operatorList.lastChunk=!0;for(const f of C.renderTasks)f.operatorListChanged();this._tryCleanup()}if(C.displayReadyCapability)C.displayReadyCapability.reject(b);else if(C.opListReadCapability)C.opListReadCapability.reject(b);else throw b}})};_()}_abortOperatorList({intentState:o,reason:t,force:u=!1}){if(o.streamReader){if(!u){if(o.renderTasks.size>0)return;if(t instanceof _display_utils.RenderingCancelledException){o.streamReaderCancelTimeout=setTimeout(()=>{this._abortOperatorList({intentState:o,reason:t,force:!0}),o.streamReaderCancelTimeout=null},RENDERING_CANCELLED_TIMEOUT);return}}if(o.streamReader.cancel(new _util.AbortException(t.message)).catch(()=>{}),o.streamReader=null,!this._transport.destroyed){for(const[g,C]of this._intentStates)if(C===o){this._intentStates.delete(g);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){this._listeners=[],this._deferred=Promise.resolve(void 0)}postMessage(o,t){function u(_){var m;if(typeof _=="function"||typeof _=="symbol"||_ instanceof URL)throw new Error(`LoopbackPort.postMessage - cannot clone: ${_==null?void 0:_.toString()}`);if(typeof _!="object"||_===null)return _;if(g.has(_))return g.get(_);let b,f;if((b=_.buffer)&&(0,_util.isArrayBuffer)(b))return t!=null&&t.includes(b)?f=new _.constructor(b,_.byteOffset,_.byteLength):f=new _.constructor(_),g.set(_,f),f;if(_ instanceof Map){f=new Map,g.set(_,f);for(const[P,E]of _)f.set(P,u(E));return f}if(_ instanceof Set){f=new Set,g.set(_,f);for(const P of _)f.add(u(P));return f}f=Array.isArray(_)?[]:Object.create(null),g.set(_,f);for(const P in _){let E,A=_;for(;!(E=Object.getOwnPropertyDescriptor(A,P));)A=Object.getPrototypeOf(A);typeof E.value>"u"||typeof E.value=="function"&&!((m=_.hasOwnProperty)!=null&&m.call(_,P))||(f[P]=u(E.value))}return f}const g=new WeakMap,C={data:u(o)};this._deferred.then(()=>{for(const _ of this._listeners)_.call(this,C)})}addEventListener(o,t){this._listeners.push(t)}removeEventListener(o,t){const u=this._listeners.indexOf(t);this._listeners.splice(u,1)}terminate(){this._listeners.length=0}}exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};{if(_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const n=(Y=document==null?void 0:document.currentScript)==null?void 0:Y.src;n&&(PDFWorkerUtil.fallbackWorkerSrc=n.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.createCDNWrapper=function(n){const o=`importScripts("${n}");`;return URL.createObjectURL(new Blob([o]))}}class PDFWorker{static get _workerPorts(){return(0,_util.shadow)(this,"_workerPorts",new WeakMap)}constructor({name:n=null,port:o=null,verbosity:t=(0,_util.getVerbosityLevel)()}={}){if(o&&PDFWorker._workerPorts.has(o))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=n,this.destroyed=!1,this.postMessageTransfers=!0,this.verbosity=t,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,o){PDFWorker._workerPorts.set(o,this),this._initializeFromPort(o);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(n){this._port=n,this._messageHandler=new _message_handler.MessageHandler("main","worker",n),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve()}_initialize(){if(typeof Worker<"u"&&!PDFWorkerUtil.isWorkerDisabled&&!PDFWorker._mainThreadWorkerMessageHandler){let n=PDFWorker.workerSrc;try{(0,_util.isSameOrigin)(window.location.href,n)||(n=PDFWorkerUtil.createCDNWrapper(new URL(n,window.location).href));const o=new Worker(n),t=new _message_handler.MessageHandler("main","worker",o),u=()=>{o.removeEventListener("error",g),t.destroy(),o.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},g=()=>{this._webWorker||u()};o.addEventListener("error",g),t.on("test",_=>{if(o.removeEventListener("error",g),this.destroyed){u();return}_?(this._messageHandler=t,this._port=o,this._webWorker=o,_.supportTransfers||(this.postMessageTransfers=!1),this._readyCapability.resolve(),t.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),t.destroy(),o.terminate())}),t.on("ready",_=>{if(o.removeEventListener("error",g),this.destroyed){u();return}try{C()}catch{this._setupFakeWorker()}});const C=()=>{const _=new Uint8Array([this.postMessageTransfers?255:0]);try{t.send("test",_,[_.buffer])}catch{(0,_util.warn)("Cannot use postMessage transfers."),_[0]=0,t.send("test",_)}};C();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),PDFWorker._setupFakeWorkerGlobal.then(n=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const o=new LoopbackPort;this._port=o;const t=`fake${PDFWorkerUtil.fakeWorkerId++}`,u=new _message_handler.MessageHandler(t+"_worker",t,o);n.setup(u,o);const g=new _message_handler.MessageHandler(t,t+"_worker",o);this._messageHandler=g,this._readyCapability.resolve(),g.send("configure",{verbosity:this.verbosity})}).catch(n=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${n.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),PDFWorker._workerPorts.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(n){if(!(n!=null&&n.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return this._workerPorts.has(n.port)?this._workerPorts.get(n.port):new PDFWorker(n)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var n;try{return((n=globalThis.pdfjsWorker)==null?void 0:n.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}}exports.PDFWorker=PDFWorker,PDFWorker.getWorkerSrc=function(){return(0,_display_utils.deprecated)("`PDFWorker.getWorkerSrc()`, please use `PDFWorker.workerSrc` instead."),this.workerSrc};class WorkerTransport{constructor(o,t,u,g){this.messageHandler=o,this.loadingTask=t,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({docId:t.docId,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:g.ownerDocument,styleElement:g.styleElement}),this._params=g,g.useWorkerFetch||(this.CMapReaderFactory=new g.CMapReaderFactory({baseUrl:g.cMapUrl,isCompressed:g.cMapPacked}),this.StandardFontDataFactory=new g.StandardFontDataFactory({baseUrl:g.standardFontDataUrl})),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=u,this._fullReader=null,this._lastProgress=null,this.pageCache=[],this.pagePromises=[],this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(o,t=_util.AnnotationMode.ENABLE,u=!1){let g=_util.RenderingIntentFlag.DISPLAY,C="";switch(o){case"any":g=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":g=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${o}`)}switch(t){case _util.AnnotationMode.DISABLE:g+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:g+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:g+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,C=this.annotationStorage.lastModified;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${t}`)}return u&&(g+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:g,cacheKey:`${g}_${C}`}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const o=[];for(const u of this.pageCache)u&&o.push(u._destroy());this.pageCache.length=0,this.pagePromises.length=0,this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return o.push(t),Promise.all(o).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null,this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:o,loadingTask:t}=this;o.on("GetReader",(u,g)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=C=>{this._lastProgress={loaded:C.loaded,total:C.total}},g.onPull=()=>{this._fullReader.read().then(function({value:C,done:_}){if(_){g.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(C),"GetReader - expected an ArrayBuffer."),g.enqueue(new Uint8Array(C),1,[C])}).catch(C=>{g.error(C)})},g.onCancel=C=>{this._fullReader.cancel(C),g.ready.catch(_=>{if(!this.destroyed)throw _})}}),o.on("ReaderHeadersReady",u=>{const g=(0,_util.createPromiseCapability)(),C=this._fullReader;return C.headersReady.then(()=>{(!C.isStreamingSupported||!C.isRangeSupported)&&(this._lastProgress&&t.onProgress&&t.onProgress(this._lastProgress),C.onProgress=_=>{t.onProgress&&t.onProgress({loaded:_.loaded,total:_.total})}),g.resolve({isStreamingSupported:C.isStreamingSupported,isRangeSupported:C.isRangeSupported,contentLength:C.contentLength})},g.reject),g.promise}),o.on("GetRangeReader",(u,g)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const C=this._networkStream.getRangeReader(u.begin,u.end);if(!C){g.close();return}g.onPull=()=>{C.read().then(function({value:_,done:b}){if(b){g.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(_),"GetRangeReader - expected an ArrayBuffer."),g.enqueue(new Uint8Array(_),1,[_])}).catch(_=>{g.error(_)})},g.onCancel=_=>{C.cancel(_),g.ready.catch(b=>{if(!this.destroyed)throw b})}}),o.on("GetDoc",({pdfInfo:u})=>{this._numPages=u.numPages,this._htmlForXfa=u.htmlForXfa,delete u.htmlForXfa,t._capability.resolve(new PDFDocumentProxy(u,this))}),o.on("DocException",function(u){let g;switch(u.name){case"PasswordException":g=new _util.PasswordException(u.message,u.code);break;case"InvalidPDFException":g=new _util.InvalidPDFException(u.message);break;case"MissingPDFException":g=new _util.MissingPDFException(u.message);break;case"UnexpectedResponseException":g=new _util.UnexpectedResponseException(u.message,u.status);break;case"UnknownErrorException":g=new _util.UnknownErrorException(u.message,u.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}t._capability.reject(g)}),o.on("PasswordRequest",u=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),t.onPassword){const g=C=>{this._passwordCapability.resolve({password:C})};try{t.onPassword(g,u.code)}catch(C){this._passwordCapability.reject(C)}}else this._passwordCapability.reject(new _util.PasswordException(u.message,u.code));return this._passwordCapability.promise}),o.on("DataLoaded",u=>{t.onProgress&&t.onProgress({loaded:u.length,total:u.length}),this.downloadInfoCapability.resolve(u)}),o.on("StartRenderPage",u=>{if(this.destroyed)return;this.pageCache[u.pageIndex]._startRenderPage(u.transparency,u.cacheKey)}),o.on("commonobj",u=>{var b;if(this.destroyed)return;const[g,C,_]=u;if(!this.commonObjs.has(g))switch(C){case"Font":const f=this._params;if("error"in _){const E=_.error;(0,_util.warn)(`Error during font loading: ${E}`),this.commonObjs.resolve(g,E);break}let m=null;f.pdfBug&&((b=globalThis.FontInspector)!=null&&b.enabled)&&(m={registerFont(E,A){globalThis.FontInspector.fontAdded(E,A)}});const P=new _font_loader.FontFaceObject(_,{isEvalSupported:f.isEvalSupported,disableFontFace:f.disableFontFace,ignoreErrors:f.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:m});this.fontLoader.bind(P).catch(E=>o.sendWithPromise("FontFallback",{id:g})).finally(()=>{!f.fontExtraProperties&&P.data&&(P.data=null),this.commonObjs.resolve(g,P)});break;case"FontPath":case"Image":this.commonObjs.resolve(g,_);break;default:throw new Error(`Got unknown common object type ${C}`)}}),o.on("obj",u=>{var m;if(this.destroyed)return;const[g,C,_,b]=u,f=this.pageCache[C];if(!f.objs.has(g))switch(_){case"Image":f.objs.resolve(g,b);const P=8e6;((m=b==null?void 0:b.data)==null?void 0:m.length)>P&&(f.cleanupAfterRender=!0);break;case"Pattern":f.objs.resolve(g,b);break;default:throw new Error(`Got unknown object type ${_}`)}}),o.on("DocProgress",u=>{this.destroyed||t.onProgress&&t.onProgress({loaded:u.loaded,total:u.total})}),o.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),o.on("FetchBuiltInCMap",u=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.CMapReaderFactory?this.CMapReaderFactory.fetch(u):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),o.on("FetchStandardFontData",u=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.StandardFontDataFactory?this.StandardFontDataFactory.fetch(u):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}_onUnsupportedFeature({featureId:o}){this.destroyed||this.loadingTask.onUnsupportedFeature&&this.loadingTask.onUnsupportedFeature(o)}getData(){return this.messageHandler.sendWithPromise("GetData",null)}getPage(o){if(!Number.isInteger(o)||o<=0||o>this._numPages)return Promise.reject(new Error("Invalid page request"));const t=o-1;if(t in this.pagePromises)return this.pagePromises[t];const u=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(g=>{if(this.destroyed)throw new Error("Transport destroyed");const C=new PDFPageProxy(t,g,this,this._params.ownerDocument,this._params.pdfBug);return this.pageCache[t]=C,C});return this.pagePromises[t]=u,u}getPageIndex(o){return this.messageHandler.sendWithPromise("GetPageIndex",{ref:o})}getAnnotations(o,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:o,intent:t})}saveDocument(){var o;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:((o=this._fullReader)==null?void 0:o.filename)??null}).finally(()=>{this.annotationStorage.resetModified()})}getFieldObjects(){return this._getFieldObjectsPromise||(this._getFieldObjectsPromise=this.messageHandler.sendWithPromise("GetFieldObjects",null))}hasJSActions(){return this._hasJSActionsPromise||(this._hasJSActionsPromise=this.messageHandler.sendWithPromise("HasJSActions",null))}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(o){return typeof o!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:o})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(o){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:o})}getStructTree(o){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:o})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(o=>new _optional_content_config.OptionalContentConfig(o))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){return this.messageHandler.sendWithPromise("GetMetadata",null).then(o=>{var t,u;return{info:o[0],metadata:o[1]?new _metadata.Metadata(o[1]):null,contentDispositionFilename:((t=this._fullReader)==null?void 0:t.filename)??null,contentLength:((u=this._fullReader)==null?void 0:u.contentLength)??null}})}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}getStats(){return this.messageHandler.sendWithPromise("GetStats",null)}async startCleanup(o=!1){if(await this.messageHandler.sendWithPromise("Cleanup",null),!this.destroyed){for(let t=0,u=this.pageCache.length;t<u;t++){const g=this.pageCache[t];if(!g)continue;if(!g.cleanup())throw new Error(`startCleanup: Page ${t+1} is currently rendering.`)}this.commonObjs.clear(),o||this.fontLoader.clear(),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null}}get loadingParams(){const o=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:o.disableAutoFetch,enableXfa:o.enableXfa})}}class PDFObjects{constructor(){this._objs=Object.create(null)}_ensureObj(o){return this._objs[o]?this._objs[o]:this._objs[o]={capability:(0,_util.createPromiseCapability)(),data:null,resolved:!1}}get(o,t=null){if(t)return this._ensureObj(o).capability.promise.then(t),null;const u=this._objs[o];if(!u||!u.resolved)throw new Error(`Requesting object that isn't resolved yet ${o}.`);return u.data}has(o){const t=this._objs[o];return(t==null?void 0:t.resolved)||!1}resolve(o,t){const u=this._ensureObj(o);u.resolved=!0,u.data=t,u.capability.resolve(t)}clear(){this._objs=Object.create(null)}}class RenderTask{constructor(o){this._internalRenderTask=o,this.onContinue=null}get promise(){return this._internalRenderTask.capability.promise}cancel(){this._internalRenderTask.cancel()}}exports.RenderTask=RenderTask;class InternalRenderTask{static get canvasInUse(){return(0,_util.shadow)(this,"canvasInUse",new WeakSet)}constructor({callback:o,params:t,objs:u,commonObjs:g,operatorList:C,pageIndex:_,canvasFactory:b,useRequestAnimationFrame:f=!1,pdfBug:m=!1}){this.callback=o,this.params=t,this.objs=u,this.commonObjs=g,this.operatorListIdx=null,this.operatorList=C,this._pageIndex=_,this.canvasFactory=b,this._pdfBug=m,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=f===!0&&typeof window<"u",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:o=!1,optionalContentConfig:t}){var f;if(this.cancelled)return;if(this._canvas){if(InternalRenderTask.canvasInUse.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");InternalRenderTask.canvasInUse.add(this._canvas)}this._pdfBug&&((f=globalThis.StepperManager)!=null&&f.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:u,viewport:g,transform:C,imageLayer:_,background:b}=this.params;this.gfx=new _canvas.CanvasGraphics(u,this.commonObjs,this.objs,this.canvasFactory,_,t),this.gfx.beginDrawing({transform:C,viewport:g,transparency:o,background:b}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()}cancel(o=null){this.running=!1,this.cancelled=!0,this.gfx&&this.gfx.endDrawing(),this._canvas&&InternalRenderTask.canvasInUse.delete(this._canvas),this.callback(o||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas"))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}this.stepper&&this.stepper.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this._canvas&&InternalRenderTask.canvasInUse.delete(this._canvas),this.callback())))}}const version="2.11.338";exports.version=version;const build="dedff3c98";exports.build=build},(Y,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.FontLoader=n.FontFaceObject=void 0;var t=o(2);class u{constructor({docId:b,onUnsupportedFeature:f,ownerDocument:m=globalThis.document,styleElement:P=null}){this.constructor===u&&(0,t.unreachable)("Cannot initialize BaseFontLoader."),this.docId=b,this._onUnsupportedFeature=f,this._document=m,this.nativeFontFaces=[],this.styleElement=null}addNativeFontFace(b){this.nativeFontFaces.push(b),this._document.fonts.add(b)}insertRule(b){let f=this.styleElement;f||(f=this.styleElement=this._document.createElement("style"),f.id=`PDFJS_FONT_STYLE_TAG_${this.docId}`,this._document.documentElement.getElementsByTagName("head")[0].appendChild(f));const m=f.sheet;m.insertRule(b,m.cssRules.length)}clear(){for(const b of this.nativeFontFaces)this._document.fonts.delete(b);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(b){if(b.attached||b.missingFile)return;if(b.attached=!0,this.isFontLoadingAPISupported){const m=b.createNativeFontFace();if(m){this.addNativeFontFace(m);try{await m.loaded}catch(P){throw this._onUnsupportedFeature({featureId:t.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,t.warn)(`Failed to load font '${m.family}': '${P}'.`),b.disableFontFace=!0,P}}return}const f=b.createFontFaceRule();if(f){if(this.insertRule(f),this.isSyncFontLoadingSupported)return;await new Promise(m=>{const P=this._queueLoadingCallback(m);this._prepareFontLoadEvent([f],[b],P)})}}_queueLoadingCallback(b){(0,t.unreachable)("Abstract method `_queueLoadingCallback`.")}get isFontLoadingAPISupported(){var f;const b=!!((f=this._document)!=null&&f.fonts);return(0,t.shadow)(this,"isFontLoadingAPISupported",b)}get isSyncFontLoadingSupported(){(0,t.unreachable)("Abstract method `isSyncFontLoadingSupported`.")}get _loadTestFont(){(0,t.unreachable)("Abstract method `_loadTestFont`.")}_prepareFontLoadEvent(b,f,m){(0,t.unreachable)("Abstract method `_prepareFontLoadEvent`.")}}let g;n.FontLoader=g,n.FontLoader=g=class extends u{constructor(b){super(b),this.loadingContext={requests:[],nextRequestId:0},this.loadTestFontId=0}get isSyncFontLoadingSupported(){let b=!1;if(typeof navigator>"u")b=!0;else{const f=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent);(f==null?void 0:f[1])>=14&&(b=!0)}return(0,t.shadow)(this,"isSyncFontLoadingSupported",b)}_queueLoadingCallback(b){function f(){for((0,t.assert)(!P.done,"completeRequest() cannot be called twice."),P.done=!0;m.requests.length>0&&m.requests[0].done;){const E=m.requests.shift();setTimeout(E.callback,0)}}const m=this.loadingContext,P={id:`pdfjs-font-loading-${m.nextRequestId++}`,done:!1,complete:f,callback:b};return m.requests.push(P),P}get _loadTestFont(){const b=function(){return atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==")};return(0,t.shadow)(this,"_loadTestFont",b())}_prepareFontLoadEvent(b,f,m){function P(T,M){return T.charCodeAt(M)<<24|T.charCodeAt(M+1)<<16|T.charCodeAt(M+2)<<8|T.charCodeAt(M+3)&255}function E(T,M,q,G){const B=T.substring(0,M),J=T.substring(M+q);return B+G+J}let A,R;const d=this._document.createElement("canvas");d.width=1,d.height=1;const k=d.getContext("2d");let W=0;function U(T,M){if(W++,W>30){(0,t.warn)("Load test font never loaded."),M();return}if(k.font="30px "+T,k.fillText(".",0,20),k.getImageData(0,0,1,1).data[3]>0){M();return}setTimeout(U.bind(null,T,M))}const w=`lt${Date.now()}${this.loadTestFontId++}`;let s=this._loadTestFont;s=E(s,976,w.length,w);const p=16,v=1482184792;let y=P(s,p);for(A=0,R=w.length-3;A<R;A+=4)y=y-v+P(w,A)|0;A<w.length&&(y=y-v+P(w+"XXX",A)|0),s=E(s,p,4,(0,t.string32)(y));const D=`url(data:font/opentype;base64,${btoa(s)});`,L=`@font-face {font-family:"${w}";src:${D}}`;this.insertRule(L);const Q=[];for(const T of f)Q.push(T.loadedName);Q.push(w);const H=this._document.createElement("div");H.style.visibility="hidden",H.style.width=H.style.height="10px",H.style.position="absolute",H.style.top=H.style.left="0px";for(const T of Q){const M=this._document.createElement("span");M.textContent="Hi",M.style.fontFamily=T,H.appendChild(M)}this._document.body.appendChild(H),U(w,()=>{this._document.body.removeChild(H),m.complete()})}};class C{constructor(b,{isEvalSupported:f=!0,disableFontFace:m=!1,ignoreErrors:P=!1,onUnsupportedFeature:E,fontRegistry:A=null}){this.compiledGlyphs=Object.create(null);for(const R in b)this[R]=b[R];this.isEvalSupported=f!==!1,this.disableFontFace=m===!0,this.ignoreErrors=P===!0,this._onUnsupportedFeature=E,this.fontRegistry=A}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let b;if(!this.cssFontInfo)b=new FontFace(this.loadedName,this.data,{});else{const f={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(f.style=`oblique ${this.cssFontInfo.italicAngle}deg`),b=new FontFace(this.cssFontInfo.fontFamily,this.data,f)}return this.fontRegistry&&this.fontRegistry.registerFont(this),b}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const b=(0,t.bytesToString)(this.data),f=`url(data:${this.mimetype};base64,${btoa(b)});`;let m;if(!this.cssFontInfo)m=`@font-face {font-family:"${this.loadedName}";src:${f}}`;else{let P=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(P+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),m=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${P}src:${f}}`}return this.fontRegistry&&this.fontRegistry.registerFont(this,f),m}getPathGenerator(b,f){if(this.compiledGlyphs[f]!==void 0)return this.compiledGlyphs[f];let m;try{m=b.get(this.loadedName+"_path_"+f)}catch(P){if(!this.ignoreErrors)throw P;return this._onUnsupportedFeature({featureId:t.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,t.warn)(`getPathGenerator - ignoring character: "${P}".`),this.compiledGlyphs[f]=function(E,A){}}if(this.isEvalSupported&&t.IsEvalSupportedCached.value){const P=[];for(const E of m){const A=E.args!==void 0?E.args.join(","):"";P.push("c.",E.cmd,"(",A,`);
`)}return this.compiledGlyphs[f]=new Function("c","size",P.join(""))}return this.compiledGlyphs[f]=function(P,E){for(const A of m)A.cmd==="scale"&&(A.args=[E,-E]),P[A.cmd].apply(P,A.args)}}}n.FontFaceObject=C},(Y,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.NodeStandardFontDataFactory=n.NodeCMapReaderFactory=n.NodeCanvasFactory=void 0;var t=o(5),u=o(4),g=o(2);let C=class{constructor(){(0,g.unreachable)("Not implemented: NodeCanvasFactory")}};n.NodeCanvasFactory=C;let _=class{constructor(){(0,g.unreachable)("Not implemented: NodeCMapReaderFactory")}};n.NodeCMapReaderFactory=_;let b=class{constructor(){(0,g.unreachable)("Not implemented: NodeStandardFontDataFactory")}};if(n.NodeStandardFontDataFactory=b,u.isNodeJS){const f=function(m){return new Promise((P,E)=>{require$$5.readFile(m,(R,d)=>{if(R||!d){E(new Error(R));return}P(new Uint8Array(d))})})};n.NodeCanvasFactory=C=class extends t.BaseCanvasFactory{_createCanvas(m,P){return require$$5.createCanvas(m,P)}},n.NodeCMapReaderFactory=_=class extends t.BaseCMapReaderFactory{_fetchData(m,P){return f(m).then(E=>({cMapData:E,compressionType:P}))}},n.NodeStandardFontDataFactory=b=class extends t.BaseStandardFontDataFactory{_fetchData(m){return f(m)}}}},(Y,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.AnnotationStorage=void 0;var t=o(2);class u{constructor(){this._storage=new Map,this._timeStamp=Date.now(),this._modified=!1,this.onSetModified=null,this.onResetModified=null}getValue(C,_){const b=this._storage.get(C);return b===void 0?_:Object.assign(_,b)}setValue(C,_){const b=this._storage.get(C);let f=!1;if(b!==void 0)for(const[m,P]of Object.entries(_))b[m]!==P&&(f=!0,b[m]=P);else f=!0,this._storage.set(C,_);f&&(this._timeStamp=Date.now(),this._setModified())}getAll(){return this._storage.size>0?(0,t.objectFromMap)(this._storage):null}get size(){return this._storage.size}_setModified(){this._modified||(this._modified=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this._modified&&(this._modified=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get serializable(){return this._storage.size>0?this._storage:null}get lastModified(){return this._timeStamp.toString()}}n.AnnotationStorage=u},(Y,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CanvasGraphics=void 0;var t=o(2),u=o(11),g=o(1);const C=16,_=100,b=4096,f=2,m=15,P=10,E=1e3,A=16,R=1.000001;function d(F){if(!F.mozCurrentTransform){F._originalSave=F.save,F._originalRestore=F.restore,F._originalRotate=F.rotate,F._originalScale=F.scale,F._originalTranslate=F.translate,F._originalTransform=F.transform,F._originalSetTransform=F.setTransform,F._originalResetTransform=F.resetTransform,F._transformMatrix=F._transformMatrix||[1,0,0,1,0,0],F._transformStack=[];try{const c=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(F),"lineWidth");F._setLineWidth=c.set,F._getLineWidth=c.get,Object.defineProperty(F,"lineWidth",{set:function(i){this._setLineWidth(i*R)},get:function(){return this._getLineWidth()}})}catch{}Object.defineProperty(F,"mozCurrentTransform",{get:function(){return this._transformMatrix}}),Object.defineProperty(F,"mozCurrentTransformInverse",{get:function(){const[e,i,r,h,l,S]=this._transformMatrix,x=e*h-i*r,I=i*r-e*h;return[h/x,i/I,r/I,e/x,(h*l-r*S)/I,(i*l-e*S)/x]}}),F.save=function(){const e=this._transformMatrix;this._transformStack.push(e),this._transformMatrix=e.slice(0,6),this._originalSave()},F.restore=function(){const e=this._transformStack.pop();e&&(this._transformMatrix=e,this._originalRestore())},F.translate=function(e,i){const r=this._transformMatrix;r[4]=r[0]*e+r[2]*i+r[4],r[5]=r[1]*e+r[3]*i+r[5],this._originalTranslate(e,i)},F.scale=function(e,i){const r=this._transformMatrix;r[0]*=e,r[1]*=e,r[2]*=i,r[3]*=i,this._originalScale(e,i)},F.transform=function(e,i,r,h,l,S){const x=this._transformMatrix;this._transformMatrix=[x[0]*e+x[2]*i,x[1]*e+x[3]*i,x[0]*r+x[2]*h,x[1]*r+x[3]*h,x[0]*l+x[2]*S+x[4],x[1]*l+x[3]*S+x[5]],F._originalTransform(e,i,r,h,l,S)},F.setTransform=function(e,i,r,h,l,S){this._transformMatrix=[e,i,r,h,l,S],F._originalSetTransform(e,i,r,h,l,S)},F.resetTransform=function(){this._transformMatrix=[1,0,0,1,0,0],F._originalResetTransform()},F.rotate=function(e){const i=Math.cos(e),r=Math.sin(e),h=this._transformMatrix;this._transformMatrix=[h[0]*i+h[2]*r,h[1]*i+h[3]*r,h[0]*-r+h[2]*i,h[1]*-r+h[3]*i,h[4],h[5]],this._originalRotate(e)}}}class k{constructor(c){this.canvasFactory=c,this.cache=Object.create(null)}getCanvas(c,e,i,r){let h;return this.cache[c]!==void 0?(h=this.cache[c],this.canvasFactory.reset(h,e,i),h.context.setTransform(1,0,0,1,0,0)):(h=this.canvasFactory.create(e,i),this.cache[c]=h),r&&d(h.context),h}clear(){for(const c in this.cache){const e=this.cache[c];this.canvasFactory.destroy(e),delete this.cache[c]}}}class W{constructor(c=0){this._cache=new Map,this._maxSize=c}has(c){return this._cache.has(c)}get(c){if(this._cache.has(c)){const e=this._cache.get(c);this._cache.delete(c),this._cache.set(c,e)}return this._cache.get(c)}set(c,e){this._maxSize<=0||(this._cache.size+1>this._maxSize&&this._cache.delete(this._cache.keys().next().value),this._cache.set(c,e))}clear(){this._cache.clear()}}function U(F){const e=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),i=F.width,r=F.height,h=i+1;let l,S,x,I;const N=new Uint8Array(h*(r+1)),O=i+7&-8,$=F.data,z=new Uint8Array(O*r);let K=0;for(l=0,S=$.length;l<S;l++){const ne=$[l];let he=128;for(;he>0;)z[K++]=ne&he?0:255,he>>=1}let Z=0;for(K=0,z[K]!==0&&(N[0]=1,++Z),x=1;x<i;x++)z[K]!==z[K+1]&&(N[x]=z[K]?2:1,++Z),K++;for(z[K]!==0&&(N[x]=2,++Z),l=1;l<r;l++){K=l*O,I=l*h,z[K-O]!==z[K]&&(N[I]=z[K]?1:8,++Z);let ne=(z[K]?4:0)+(z[K-O]?8:0);for(x=1;x<i;x++)ne=(ne>>2)+(z[K+1]?4:0)+(z[K-O+1]?8:0),e[ne]&&(N[I+x]=e[ne],++Z),K++;if(z[K-O]!==z[K]&&(N[I+x]=z[K]?2:4,++Z),Z>1e3)return null}for(K=O*(r-1),I=l*h,z[K]!==0&&(N[I]=8,++Z),x=1;x<i;x++)z[K]!==z[K+1]&&(N[I+x]=z[K]?4:8,++Z),K++;if(z[K]!==0&&(N[I+x]=4,++Z),Z>1e3)return null;const ie=new Int32Array([0,h,-1,0,-h,0,0,0,1]),se=[];for(l=0;Z&&l<=r;l++){let ne=l*h;const he=ne+i;for(;ne<he&&!N[ne];)ne++;if(ne===he)continue;const ue=[ne%h,l],ee=ne;let le=N[ne];do{const _e=ie[le];do ne+=_e;while(!N[ne]);const pe=N[ne];pe!==5&&pe!==10?(le=pe,N[ne]=0):(le=pe&51*le>>4,N[ne]&=le>>2|le<<2),ue.push(ne%h,ne/h|0),N[ne]||--Z}while(ee!==ne);se.push(ue),--l}return function(ne){ne.save(),ne.scale(1/i,-1/r),ne.translate(0,-r),ne.beginPath();for(let he=0,ue=se.length;he<ue;he++){const ee=se[he];ne.moveTo(ee[0],ee[1]);for(let le=2,_e=ee.length;le<_e;le+=2)ne.lineTo(ee[le],ee[le+1])}ne.fill(),ne.beginPath(),ne.restore()}}class w{constructor(){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=t.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=t.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=t.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.resumeSMaskCtx=null,this.transferMaps=null}clone(){return Object.create(this)}setCurrentPoint(c,e){this.x=c,this.y=e}}function s(F,c,e=null){if(typeof ImageData<"u"&&c instanceof ImageData){F.putImageData(c,0,0);return}const i=c.height,r=c.width,h=i%A,l=(i-h)/A,S=h===0?l:l+1,x=F.createImageData(r,A);let I=0,N;const O=c.data,$=x.data;let z,K,Z,ie,se,ae,ne,he;if(e)switch(e.length){case 1:se=e[0],ae=e[0],ne=e[0],he=e[0];break;case 4:se=e[0],ae=e[1],ne=e[2],he=e[3];break}if(c.kind===t.ImageKind.GRAYSCALE_1BPP){const ue=O.byteLength,ee=new Uint32Array($.buffer,0,$.byteLength>>2),le=ee.length,_e=r+7>>3;let pe=4294967295,fe=t.IsLittleEndianCached.value?4278190080:255;for(he&&he[0]===255&&he[255]===0&&([pe,fe]=[fe,pe]),z=0;z<S;z++){for(Z=z<l?A:h,N=0,K=0;K<Z;K++){const be=ue-I;let ge=0;const Ae=be>_e?r:be*8-7,me=Ae&-8;let ye=0,de=0;for(;ge<me;ge+=8)de=O[I++],ee[N++]=de&128?pe:fe,ee[N++]=de&64?pe:fe,ee[N++]=de&32?pe:fe,ee[N++]=de&16?pe:fe,ee[N++]=de&8?pe:fe,ee[N++]=de&4?pe:fe,ee[N++]=de&2?pe:fe,ee[N++]=de&1?pe:fe;for(;ge<Ae;ge++)ye===0&&(de=O[I++],ye=128),ee[N++]=de&ye?pe:fe,ye>>=1}for(;N<le;)ee[N++]=0;F.putImageData(x,0,z*A)}}else if(c.kind===t.ImageKind.RGBA_32BPP){const ue=!!(se||ae||ne);for(K=0,ie=r*A*4,z=0;z<l;z++){if($.set(O.subarray(I,I+ie)),I+=ie,ue)for(let ee=0;ee<ie;ee+=4)se&&($[ee+0]=se[$[ee+0]]),ae&&($[ee+1]=ae[$[ee+1]]),ne&&($[ee+2]=ne[$[ee+2]]);F.putImageData(x,0,K),K+=A}if(z<S){if(ie=r*h*4,$.set(O.subarray(I,I+ie)),ue)for(let ee=0;ee<ie;ee+=4)se&&($[ee+0]=se[$[ee+0]]),ae&&($[ee+1]=ae[$[ee+1]]),ne&&($[ee+2]=ne[$[ee+2]]);F.putImageData(x,0,K)}}else if(c.kind===t.ImageKind.RGB_24BPP){const ue=!!(se||ae||ne);for(Z=A,ie=r*Z,z=0;z<S;z++){for(z>=l&&(Z=h,ie=r*Z),N=0,K=ie;K--;)$[N++]=O[I++],$[N++]=O[I++],$[N++]=O[I++],$[N++]=255;if(ue)for(let ee=0;ee<N;ee+=4)se&&($[ee+0]=se[$[ee+0]]),ae&&($[ee+1]=ae[$[ee+1]]),ne&&($[ee+2]=ne[$[ee+2]]);F.putImageData(x,0,z*A)}}else throw new Error(`bad image kind: ${c.kind}`)}function a(F,c){const e=c.height,i=c.width,r=e%A,h=(e-r)/A,l=r===0?h:h+1,S=F.createImageData(i,A);let x=0;const I=c.data,N=S.data;for(let O=0;O<l;O++){const $=O<h?A:r;let z=3;for(let K=0;K<$;K++){let Z,ie=0;for(let se=0;se<i;se++)ie||(Z=I[x++],ie=128),N[z]=Z&ie?0:255,z+=4,ie>>=1}F.putImageData(S,0,O*A)}}function p(F,c){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"];for(let i=0,r=e.length;i<r;i++){const h=e[i];F[h]!==void 0&&(c[h]=F[h])}F.setLineDash!==void 0&&(c.setLineDash(F.getLineDash()),c.lineDashOffset=F.lineDashOffset)}function v(F){F.strokeStyle="#000000",F.fillStyle="#000000",F.fillRule="nonzero",F.globalAlpha=1,F.lineWidth=1,F.lineCap="butt",F.lineJoin="miter",F.miterLimit=10,F.globalCompositeOperation="source-over",F.font="10px sans-serif",F.setLineDash!==void 0&&(F.setLineDash([]),F.lineDashOffset=0)}function y(F,c,e,i){const r=F.length;for(let h=3;h<r;h+=4){const l=F[h];if(l===0)F[h-3]=c,F[h-2]=e,F[h-1]=i;else if(l<255){const S=255-l;F[h-3]=F[h-3]*l+c*S>>8,F[h-2]=F[h-2]*l+e*S>>8,F[h-1]=F[h-1]*l+i*S>>8}}}function D(F,c,e){const i=F.length,r=1/255;for(let h=3;h<i;h+=4){const l=e?e[F[h]]:F[h];c[h]=c[h]*l*r|0}}function L(F,c,e){const i=F.length;for(let r=3;r<i;r+=4){const h=F[r-3]*77+F[r-2]*152+F[r-1]*28;c[r]=e?c[r]*e[h>>8]>>8:c[r]*h>>16}}function Q(F,c,e,i,r,h,l){const S=!!h,x=S?h[0]:0,I=S?h[1]:0,N=S?h[2]:0;let O;r==="Luminosity"?O=L:O=D;const z=Math.min(i,Math.ceil(1048576/e));for(let K=0;K<i;K+=z){const Z=Math.min(z,i-K),ie=F.getImageData(0,K,e,Z),se=c.getImageData(0,K,e,Z);S&&y(ie.data,x,I,N),O(ie.data,se.data,l),F.putImageData(se,0,K)}}function H(F,c,e){const i=c.canvas,r=c.context;F.setTransform(c.scaleX,0,0,c.scaleY,c.offsetX,c.offsetY),Q(r,e,i.width,i.height,c.subtype,c.backdrop,c.transferMap),F.drawImage(i,0,0)}function T(F,c){const e=t.Util.singularValueDecompose2dScale(F);e[0]=Math.fround(e[0]),e[1]=Math.fround(e[1]);const i=Math.fround((globalThis.devicePixelRatio||1)*g.PixelsPerInch.PDF_TO_CSS_UNITS);return c!==void 0?c:e[0]<=i||e[1]<=i}const M=["butt","round","square"],q=["miter","round","bevel"],G={},B={};class J{constructor(c,e,i,r,h,l){this.ctx=c,this.current=new w,this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=i,this.canvasFactory=r,this.imageLayer=h,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.contentVisible=!0,this.markedContentStack=[],this.optionalContentConfig=l,this.cachedCanvases=new k(this.canvasFactory),this.cachedCanvasPatterns=new W(f),this.cachedPatterns=new Map,c&&d(c),this._cachedGetSinglePixelWidth=null}beginDrawing({transform:c,viewport:e,transparency:i=!1,background:r=null}){const h=this.ctx.canvas.width,l=this.ctx.canvas.height;if(this.ctx.save(),this.ctx.fillStyle=r||"rgb(255, 255, 255)",this.ctx.fillRect(0,0,h,l),this.ctx.restore(),i){const S=this.cachedCanvases.getCanvas("transparent",h,l,!0);this.compositeCtx=this.ctx,this.transparentCanvas=S.canvas,this.ctx=S.context,this.ctx.save(),this.ctx.transform.apply(this.ctx,this.compositeCtx.mozCurrentTransform)}this.ctx.save(),v(this.ctx),c&&this.ctx.transform.apply(this.ctx,c),this.ctx.transform.apply(this.ctx,e.transform),this.baseTransform=this.ctx.mozCurrentTransform.slice(),this._combinedScaleFactor=Math.hypot(this.baseTransform[0],this.baseTransform[2]),this.imageLayer&&this.imageLayer.beginLayout()}executeOperatorList(c,e,i,r){const h=c.argsArray,l=c.fnArray;let S=e||0;const x=h.length;if(x===S)return S;const I=x-S>P&&typeof i=="function",N=I?Date.now()+m:0;let O=0;const $=this.commonObjs,z=this.objs;let K;for(;;){if(r!==void 0&&S===r.nextBreakPoint)return r.breakIt(S,i),S;if(K=l[S],K!==t.OPS.dependency)this[K].apply(this,h[S]);else for(const Z of h[S]){const ie=Z.startsWith("g_")?$:z;if(!ie.has(Z))return ie.get(Z,i),S}if(S++,S===x)return S;if(I&&++O>P){if(Date.now()>N)return i(),S;O=0}}}endDrawing(){for(;this.stateStack.length||this.current.activeSMask!==null;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null),this.cachedCanvases.clear(),this.cachedCanvasPatterns.clear(),this.cachedPatterns.clear(),this.imageLayer&&this.imageLayer.endLayout()}_scaleImage(c,e){const i=c.width,r=c.height;let h=Math.max(Math.hypot(e[0],e[1]),1),l=Math.max(Math.hypot(e[2],e[3]),1),S=i,x=r,I="prescale1",N,O;for(;h>2&&S>1||l>2&&x>1;){let $=S,z=x;h>2&&S>1&&($=Math.ceil(S/2),h/=S/$),l>2&&x>1&&(z=Math.ceil(x/2),l/=x/z),N=this.cachedCanvases.getCanvas(I,$,z),O=N.context,O.clearRect(0,0,$,z),O.drawImage(c,0,0,S,x,0,0,$,z),c=N.canvas,S=$,x=z,I=I==="prescale1"?"prescale2":"prescale1"}return{img:c,paintWidth:S,paintHeight:x}}_createMaskCanvas(c){const e=this.ctx,i=c.width,r=c.height,h=this.current.fillColor,l=this.current.patternFill,S=this.cachedCanvases.getCanvas("maskCanvas",i,r),x=S.context;a(x,c);const I=e.mozCurrentTransform;let N=t.Util.transform(I,[1/i,0,0,-1/r,0,0]);N=t.Util.transform(N,[1,0,0,1,0,-r]);const O=t.Util.applyTransform([0,0],N),$=t.Util.applyTransform([i,r],N),z=t.Util.normalizeRect([O[0],O[1],$[0],$[1]]),K=Math.ceil(z[2]-z[0]),Z=Math.ceil(z[3]-z[1]),ie=this.cachedCanvases.getCanvas("fillCanvas",K,Z,!0),se=ie.context,ae=Math.min(O[0],$[0]),ne=Math.min(O[1],$[1]);se.translate(-ae,-ne),se.transform.apply(se,N);const he=this._scaleImage(S.canvas,se.mozCurrentTransformInverse);se.imageSmoothingEnabled=T(se.mozCurrentTransform,c.interpolate),se.drawImage(he.img,0,0,he.img.width,he.img.height,0,0,i,r),se.globalCompositeOperation="source-in";const ue=t.Util.transform(se.mozCurrentTransformInverse,[1,0,0,1,-ae,-ne]);return se.fillStyle=l?h.getPattern(e,this,ue,!1):h,se.fillRect(0,0,i,r),{canvas:ie.canvas,offsetX:Math.round(ae),offsetY:Math.round(ne)}}setLineWidth(c){this.current.lineWidth=c,this.ctx.lineWidth=c}setLineCap(c){this.ctx.lineCap=M[c]}setLineJoin(c){this.ctx.lineJoin=q[c]}setMiterLimit(c){this.ctx.miterLimit=c}setDash(c,e){const i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(c),i.lineDashOffset=e)}setRenderingIntent(c){}setFlatness(c){}setGState(c){for(let e=0,i=c.length;e<i;e++){const r=c[e],h=r[0],l=r[1];switch(h){case"LW":this.setLineWidth(l);break;case"LC":this.setLineCap(l);break;case"LJ":this.setLineJoin(l);break;case"ML":this.setMiterLimit(l);break;case"D":this.setDash(l[0],l[1]);break;case"RI":this.setRenderingIntent(l);break;case"FL":this.setFlatness(l);break;case"Font":this.setFont(l[0],l[1]);break;case"CA":this.current.strokeAlpha=r[1];break;case"ca":this.current.fillAlpha=r[1],this.ctx.globalAlpha=r[1];break;case"BM":this.ctx.globalCompositeOperation=l;break;case"SMask":this.current.activeSMask&&(this.stateStack.length>0&&this.stateStack[this.stateStack.length-1].activeSMask===this.current.activeSMask?this.suspendSMaskGroup():this.endSMaskGroup()),this.current.activeSMask=l?this.tempSMask:null,this.current.activeSMask&&this.beginSMaskGroup(),this.tempSMask=null;break;case"TR":this.current.transferMaps=l}}}beginSMaskGroup(){const c=this.current.activeSMask,e=c.canvas.width,i=c.canvas.height,r="smaskGroupAt"+this.groupLevel,h=this.cachedCanvases.getCanvas(r,e,i,!0),l=this.ctx,S=l.mozCurrentTransform;this.ctx.save();const x=h.context;x.scale(1/c.scaleX,1/c.scaleY),x.translate(-c.offsetX,-c.offsetY),x.transform.apply(x,S),c.startTransformInverse=x.mozCurrentTransformInverse,p(l,x),this.ctx=x,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(l),this.groupLevel++}suspendSMaskGroup(){const c=this.ctx;this.groupLevel--,this.ctx=this.groupStack.pop(),H(this.ctx,this.current.activeSMask,c),this.ctx.restore(),this.ctx.save(),p(c,this.ctx),this.current.resumeSMaskCtx=c;const e=t.Util.transform(this.current.activeSMask.startTransformInverse,c.mozCurrentTransform);this.ctx.transform.apply(this.ctx,e),c.save(),c.setTransform(1,0,0,1,0,0),c.clearRect(0,0,c.canvas.width,c.canvas.height),c.restore()}resumeSMaskGroup(){const c=this.current.resumeSMaskCtx,e=this.ctx;this.ctx=c,this.groupStack.push(e),this.groupLevel++}endSMaskGroup(){const c=this.ctx;this.groupLevel--,this.ctx=this.groupStack.pop(),H(this.ctx,this.current.activeSMask,c),this.ctx.restore(),p(c,this.ctx);const e=t.Util.transform(this.current.activeSMask.startTransformInverse,c.mozCurrentTransform);this.ctx.transform.apply(this.ctx,e)}save(){this.ctx.save();const c=this.current;this.stateStack.push(c),this.current=c.clone(),this.current.resumeSMaskCtx=null}restore(){this.current.resumeSMaskCtx&&this.resumeSMaskGroup(),this.current.activeSMask!==null&&(this.stateStack.length===0||this.stateStack[this.stateStack.length-1].activeSMask!==this.current.activeSMask)&&this.endSMaskGroup(),this.stateStack.length!==0?(this.current=this.stateStack.pop(),this.ctx.restore(),this.pendingClip=null,this._cachedGetSinglePixelWidth=null):this.current.activeSMask=null}transform(c,e,i,r,h,l){this.ctx.transform(c,e,i,r,h,l),this._cachedGetSinglePixelWidth=null}constructPath(c,e){const i=this.ctx,r=this.current;let h=r.x,l=r.y;for(let S=0,x=0,I=c.length;S<I;S++)switch(c[S]|0){case t.OPS.rectangle:h=e[x++],l=e[x++];const N=e[x++],O=e[x++],$=h+N,z=l+O;i.moveTo(h,l),N===0||O===0?i.lineTo($,z):(i.lineTo($,l),i.lineTo($,z),i.lineTo(h,z)),i.closePath();break;case t.OPS.moveTo:h=e[x++],l=e[x++],i.moveTo(h,l);break;case t.OPS.lineTo:h=e[x++],l=e[x++],i.lineTo(h,l);break;case t.OPS.curveTo:h=e[x+4],l=e[x+5],i.bezierCurveTo(e[x],e[x+1],e[x+2],e[x+3],h,l),x+=6;break;case t.OPS.curveTo2:i.bezierCurveTo(h,l,e[x],e[x+1],e[x+2],e[x+3]),h=e[x+2],l=e[x+3],x+=4;break;case t.OPS.curveTo3:h=e[x+2],l=e[x+3],i.bezierCurveTo(e[x],e[x+1],h,l,h,l),x+=4;break;case t.OPS.closePath:i.closePath();break}r.setCurrentPoint(h,l)}closePath(){this.ctx.closePath()}stroke(c){c=typeof c<"u"?c:!0;const e=this.ctx,i=this.current.strokeColor;if(e.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof i=="object"&&(i!=null&&i.getPattern)){const r=this.getSinglePixelWidth();e.save(),e.strokeStyle=i.getPattern(e,this,e.mozCurrentTransformInverse),e.lineWidth=Math.max(r,this.current.lineWidth),e.stroke(),e.restore()}else{const r=this.getSinglePixelWidth();r<0&&-r>=this.current.lineWidth?(e.save(),e.resetTransform(),e.lineWidth=Math.round(this._combinedScaleFactor),e.stroke(),e.restore()):(e.lineWidth=Math.max(r,this.current.lineWidth),e.stroke())}c&&this.consumePath(),e.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(c){c=typeof c<"u"?c:!0;const e=this.ctx,i=this.current.fillColor,r=this.current.patternFill;let h=!1;r&&(e.save(),e.fillStyle=i.getPattern(e,this,e.mozCurrentTransformInverse),h=!0),this.contentVisible&&(this.pendingEOFill?(e.fill("evenodd"),this.pendingEOFill=!1):e.fill()),h&&e.restore(),c&&this.consumePath()}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=G}eoClip(){this.pendingClip=B}beginText(){this.current.textMatrix=t.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const c=this.pendingTextPaths,e=this.ctx;if(c===void 0){e.beginPath();return}e.save(),e.beginPath();for(let i=0;i<c.length;i++){const r=c[i];e.setTransform.apply(e,r.transform),e.translate(r.x,r.y),r.addToPath(e,r.fontSize)}e.restore(),e.clip(),e.beginPath(),delete this.pendingTextPaths}setCharSpacing(c){this.current.charSpacing=c}setWordSpacing(c){this.current.wordSpacing=c}setHScale(c){this.current.textHScale=c/100}setLeading(c){this.current.leading=-c}setFont(c,e){const i=this.commonObjs.get(c),r=this.current;if(!i)throw new Error(`Can't find font for ${c}`);if(r.fontMatrix=i.fontMatrix||t.FONT_IDENTITY_MATRIX,(r.fontMatrix[0]===0||r.fontMatrix[3]===0)&&(0,t.warn)("Invalid font matrix for font "+c),e<0?(e=-e,r.fontDirection=-1):r.fontDirection=1,this.current.font=i,this.current.fontSize=e,i.isType3Font)return;const h=i.loadedName||"sans-serif";let l="normal";i.black?l="900":i.bold&&(l="bold");const S=i.italic?"italic":"normal",x=`"${h}", ${i.fallbackName}`;let I=e;e<C?I=C:e>_&&(I=_),this.current.fontSizeScale=e/I,this.ctx.font=`${S} ${l} ${I}px ${x}`}setTextRenderingMode(c){this.current.textRenderingMode=c}setTextRise(c){this.current.textRise=c}moveText(c,e){this.current.x=this.current.lineX+=c,this.current.y=this.current.lineY+=e}setLeadingMoveText(c,e){this.setLeading(-e),this.moveText(c,e)}setTextMatrix(c,e,i,r,h,l){this.current.textMatrix=[c,e,i,r,h,l],this.current.textMatrixScale=Math.hypot(c,e),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(c,e,i,r,h){const l=this.ctx,S=this.current,x=S.font,I=S.textRenderingMode,N=S.fontSize/S.fontSizeScale,O=I&t.TextRenderingMode.FILL_STROKE_MASK,$=!!(I&t.TextRenderingMode.ADD_TO_PATH_FLAG),z=S.patternFill&&!x.missingFile;let K;(x.disableFontFace||$||z)&&(K=x.getPathGenerator(this.commonObjs,c)),x.disableFontFace||z?(l.save(),l.translate(e,i),l.beginPath(),K(l,N),r&&l.setTransform.apply(l,r),(O===t.TextRenderingMode.FILL||O===t.TextRenderingMode.FILL_STROKE)&&l.fill(),(O===t.TextRenderingMode.STROKE||O===t.TextRenderingMode.FILL_STROKE)&&(h&&(l.resetTransform(),l.lineWidth=Math.round(this._combinedScaleFactor)),l.stroke()),l.restore()):((O===t.TextRenderingMode.FILL||O===t.TextRenderingMode.FILL_STROKE)&&l.fillText(c,e,i),(O===t.TextRenderingMode.STROKE||O===t.TextRenderingMode.FILL_STROKE)&&(h?(l.save(),l.moveTo(e,i),l.resetTransform(),l.lineWidth=Math.round(this._combinedScaleFactor),l.strokeText(c,0,0),l.restore()):l.strokeText(c,e,i))),$&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:l.mozCurrentTransform,x:e,y:i,fontSize:N,addToPath:K})}get isFontSubpixelAAEnabled(){const{context:c}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);c.scale(1.5,1),c.fillText("I",0,10);const e=c.getImageData(0,0,10,10).data;let i=!1;for(let r=3;r<e.length;r+=4)if(e[r]>0&&e[r]<255){i=!0;break}return(0,t.shadow)(this,"isFontSubpixelAAEnabled",i)}showText(c){const e=this.current,i=e.font;if(i.isType3Font)return this.showType3Text(c);const r=e.fontSize;if(r===0)return;const h=this.ctx,l=e.fontSizeScale,S=e.charSpacing,x=e.wordSpacing,I=e.fontDirection,N=e.textHScale*I,O=c.length,$=i.vertical,z=$?1:-1,K=i.defaultVMetrics,Z=r*e.fontMatrix[0],ie=e.textRenderingMode===t.TextRenderingMode.FILL&&!i.disableFontFace&&!e.patternFill;h.save();let se;if(e.patternFill){h.save();const le=e.fillColor.getPattern(h,this,h.mozCurrentTransformInverse);se=h.mozCurrentTransform,h.restore(),h.fillStyle=le}h.transform.apply(h,e.textMatrix),h.translate(e.x,e.y+e.textRise),I>0?h.scale(N,-1):h.scale(N,1);let ae=e.lineWidth,ne=!1;const he=e.textMatrixScale;if(he===0||ae===0){const le=e.textRenderingMode&t.TextRenderingMode.FILL_STROKE_MASK;(le===t.TextRenderingMode.STROKE||le===t.TextRenderingMode.FILL_STROKE)&&(this._cachedGetSinglePixelWidth=null,ae=this.getSinglePixelWidth(),ne=ae<0)}else ae/=he;l!==1&&(h.scale(l,l),ae/=l),h.lineWidth=ae;let ue=0,ee;for(ee=0;ee<O;++ee){const le=c[ee];if((0,t.isNum)(le)){ue+=z*le*r/1e3;continue}let _e=!1;const pe=(le.isSpace?x:0)+S,fe=le.fontChar,be=le.accent;let ge,Ae,me=le.width;if($){const de=le.vmetric||K,Ce=-(le.vmetric?de[1]:me*.5)*Z,Pe=de[2]*Z;me=de?-de[0]:me,ge=Ce/l,Ae=(ue+Pe)/l}else ge=ue/l,Ae=0;if(i.remeasure&&me>0){const de=h.measureText(fe).width*1e3/r*l;if(me<de&&this.isFontSubpixelAAEnabled){const Ce=me/de;_e=!0,h.save(),h.scale(Ce,1),ge/=Ce}else me!==de&&(ge+=(me-de)/2e3*r/l)}if(this.contentVisible&&(le.isInFont||i.missingFile)){if(ie&&!be)h.fillText(fe,ge,Ae);else if(this.paintChar(fe,ge,Ae,se,ne),be){const de=ge+r*be.offset.x/l,Ce=Ae-r*be.offset.y/l;this.paintChar(be.fontChar,de,Ce,se,ne)}}let ye;$?ye=me*Z-pe*I:ye=me*Z+pe*I,ue+=ye,_e&&h.restore()}$?e.y-=ue:e.x+=ue*N,h.restore()}showType3Text(c){const e=this.ctx,i=this.current,r=i.font,h=i.fontSize,l=i.fontDirection,S=r.vertical?1:-1,x=i.charSpacing,I=i.wordSpacing,N=i.textHScale*l,O=i.fontMatrix||t.FONT_IDENTITY_MATRIX,$=c.length,z=i.textRenderingMode===t.TextRenderingMode.INVISIBLE;let K,Z,ie,se;if(!(z||h===0)){for(this._cachedGetSinglePixelWidth=null,e.save(),e.transform.apply(e,i.textMatrix),e.translate(i.x,i.y),e.scale(N,l),K=0;K<$;++K){if(Z=c[K],(0,t.isNum)(Z)){se=S*Z*h/1e3,this.ctx.translate(se,0),i.x+=se*N;continue}const ae=(Z.isSpace?I:0)+x,ne=r.charProcOperatorList[Z.operatorListId];if(!ne){(0,t.warn)(`Type3 character "${Z.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=Z,this.save(),e.scale(h,h),e.transform.apply(e,O),this.executeOperatorList(ne),this.restore()),ie=t.Util.applyTransform([Z.width,0],O)[0]*h+ae,e.translate(ie,0),i.x+=ie*N}e.restore(),this.processingType3=null}}setCharWidth(c,e){}setCharWidthAndBounds(c,e,i,r,h,l){this.ctx.rect(i,r,h-i,l-r),this.clip(),this.endPath()}getColorN_Pattern(c){let e;if(c[0]==="TilingPattern"){const i=c[1],r=this.baseTransform||this.ctx.mozCurrentTransform.slice(),h={createCanvasGraphics:l=>new J(l,this.commonObjs,this.objs,this.canvasFactory)};e=new u.TilingPattern(c,i,this.ctx,h,r)}else e=this._getPattern(c[1],c[2]);return e}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(c,e,i){const r=t.Util.makeHexColor(c,e,i);this.ctx.strokeStyle=r,this.current.strokeColor=r}setFillRGBColor(c,e,i){const r=t.Util.makeHexColor(c,e,i);this.ctx.fillStyle=r,this.current.fillColor=r,this.current.patternFill=!1}_getPattern(c,e=null){let i;return this.cachedPatterns.has(c)?i=this.cachedPatterns.get(c):(i=(0,u.getShadingPattern)(this.objs.get(c),this.cachedCanvasPatterns),this.cachedPatterns.set(c,i)),e&&(i.matrix=e),i}shadingFill(c){if(!this.contentVisible)return;const e=this.ctx;this.save();const i=this._getPattern(c);e.fillStyle=i.getPattern(e,this,e.mozCurrentTransformInverse,!0);const r=e.mozCurrentTransformInverse;if(r){const h=e.canvas,l=h.width,S=h.height,x=t.Util.applyTransform([0,0],r),I=t.Util.applyTransform([0,S],r),N=t.Util.applyTransform([l,0],r),O=t.Util.applyTransform([l,S],r),$=Math.min(x[0],I[0],N[0],O[0]),z=Math.min(x[1],I[1],N[1],O[1]),K=Math.max(x[0],I[0],N[0],O[0]),Z=Math.max(x[1],I[1],N[1],O[1]);this.ctx.fillRect($,z,K-$,Z-z)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.restore()}beginInlineImage(){(0,t.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,t.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(c,e){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(c)&&c.length===6&&this.transform.apply(this,c),this.baseTransform=this.ctx.mozCurrentTransform,e)){const i=e[2]-e[0],r=e[3]-e[1];this.ctx.rect(e[0],e[1],i,r),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(c){if(!this.contentVisible)return;this.save();const e=this.ctx;c.isolated||(0,t.info)("TODO: Support non-isolated groups."),c.knockout&&(0,t.warn)("Knockout groups not supported.");const i=e.mozCurrentTransform;if(c.matrix&&e.transform.apply(e,c.matrix),!c.bbox)throw new Error("Bounding box is required.");let r=t.Util.getAxialAlignedBoundingBox(c.bbox,e.mozCurrentTransform);const h=[0,0,e.canvas.width,e.canvas.height];r=t.Util.intersect(r,h)||[0,0,0,0];const l=Math.floor(r[0]),S=Math.floor(r[1]);let x=Math.max(Math.ceil(r[2])-l,1),I=Math.max(Math.ceil(r[3])-S,1),N=1,O=1;x>b&&(N=x/b,x=b),I>b&&(O=I/b,I=b);let $="groupAt"+this.groupLevel;c.smask&&($+="_smask_"+this.smaskCounter++%2);const z=this.cachedCanvases.getCanvas($,x,I,!0),K=z.context;K.scale(1/N,1/O),K.translate(-l,-S),K.transform.apply(K,i),c.smask?this.smaskStack.push({canvas:z.canvas,context:K,offsetX:l,offsetY:S,scaleX:N,scaleY:O,subtype:c.smask.subtype,backdrop:c.smask.backdrop,transferMap:c.smask.transferMap||null,startTransformInverse:null}):(e.setTransform(1,0,0,1,0,0),e.translate(l,S),e.scale(N,O)),p(e,K),this.ctx=K,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(e),this.groupLevel++,this.current.activeSMask=null}endGroup(c){if(!this.contentVisible)return;this.groupLevel--;const e=this.ctx;this.ctx=this.groupStack.pop(),this.ctx.imageSmoothingEnabled=!1,c.smask?this.tempSMask=this.smaskStack.pop():this.ctx.drawImage(e.canvas,0,0),this.restore()}beginAnnotations(){this.save(),this.baseTransform&&this.ctx.setTransform.apply(this.ctx,this.baseTransform)}endAnnotations(){this.restore()}beginAnnotation(c,e,i,r){if(this.save(),v(this.ctx),this.current=new w,Array.isArray(e)&&e.length===4){const h=e[2]-e[0],l=e[3]-e[1];this.ctx.rect(e[0],e[1],h,l),this.clip(),this.endPath()}this.transform.apply(this,i),this.transform.apply(this,r)}endAnnotation(){this.restore()}paintImageMaskXObject(c){if(!this.contentVisible)return;const e=this.ctx,i=c.width,r=c.height,h=this.processingType3;if(h&&h.compiled===void 0&&(i<=E&&r<=E?h.compiled=U({data:c.data,width:i,height:r}):h.compiled=null),h!=null&&h.compiled){h.compiled(e);return}const l=this._createMaskCanvas(c),S=l.canvas;e.save(),e.setTransform(1,0,0,1,0,0),e.drawImage(S,l.offsetX,l.offsetY),e.restore()}paintImageMaskXObjectRepeat(c,e,i=0,r=0,h,l){if(!this.contentVisible)return;const S=this.ctx;S.save();const x=S.mozCurrentTransform;S.transform(e,i,r,h,0,0);const I=this._createMaskCanvas(c);S.setTransform(1,0,0,1,0,0);for(let N=0,O=l.length;N<O;N+=2){const $=t.Util.transform(x,[e,i,r,h,l[N],l[N+1]]),[z,K]=t.Util.applyTransform([0,0],$);S.drawImage(I.canvas,z,K)}S.restore()}paintImageMaskXObjectGroup(c){if(!this.contentVisible)return;const e=this.ctx,i=this.current.fillColor,r=this.current.patternFill;for(let h=0,l=c.length;h<l;h++){const S=c[h],x=S.width,I=S.height,N=this.cachedCanvases.getCanvas("maskCanvas",x,I),O=N.context;O.save(),a(O,S),O.globalCompositeOperation="source-in",O.fillStyle=r?i.getPattern(O,this,e.mozCurrentTransformInverse,!1):i,O.fillRect(0,0,x,I),O.restore(),e.save(),e.transform.apply(e,S.transform),e.scale(1,-1),e.drawImage(N.canvas,0,0,x,I,0,-1,1,1),e.restore()}}paintImageXObject(c){if(!this.contentVisible)return;const e=c.startsWith("g_")?this.commonObjs.get(c):this.objs.get(c);if(!e){(0,t.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e)}paintImageXObjectRepeat(c,e,i,r){if(!this.contentVisible)return;const h=c.startsWith("g_")?this.commonObjs.get(c):this.objs.get(c);if(!h){(0,t.warn)("Dependent image isn't ready yet");return}const l=h.width,S=h.height,x=[];for(let I=0,N=r.length;I<N;I+=2)x.push({transform:[e,0,0,i,r[I],r[I+1]],x:0,y:0,w:l,h:S});this.paintInlineImageXObjectGroup(h,x)}paintInlineImageXObject(c){if(!this.contentVisible)return;const e=c.width,i=c.height,r=this.ctx;this.save(),r.scale(1/e,-1/i);let h;if(typeof HTMLElement=="function"&&c instanceof HTMLElement||!c.data)h=c;else{const S=this.cachedCanvases.getCanvas("inlineImage",e,i),x=S.context;s(x,c,this.current.transferMaps),h=S.canvas}const l=this._scaleImage(h,r.mozCurrentTransformInverse);if(r.imageSmoothingEnabled=T(r.mozCurrentTransform,c.interpolate),r.drawImage(l.img,0,0,l.paintWidth,l.paintHeight,0,-i,e,i),this.imageLayer){const S=this.getCanvasPosition(0,-i);this.imageLayer.appendImage({imgData:c,left:S[0],top:S[1],width:e/r.mozCurrentTransformInverse[0],height:i/r.mozCurrentTransformInverse[3]})}this.restore()}paintInlineImageXObjectGroup(c,e){if(!this.contentVisible)return;const i=this.ctx,r=c.width,h=c.height,l=this.cachedCanvases.getCanvas("inlineImage",r,h),S=l.context;s(S,c,this.current.transferMaps);for(let x=0,I=e.length;x<I;x++){const N=e[x];if(i.save(),i.transform.apply(i,N.transform),i.scale(1,-1),i.drawImage(l.canvas,N.x,N.y,N.w,N.h,0,-1,1,1),this.imageLayer){const O=this.getCanvasPosition(N.x,N.y);this.imageLayer.appendImage({imgData:c,left:O[0],top:O[1],width:r,height:h})}i.restore()}}paintSolidColorImageMask(){this.contentVisible&&this.ctx.fillRect(0,0,1,1)}markPoint(c){}markPointProps(c,e){}beginMarkedContent(c){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(c,e){c==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(e)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(){const c=this.ctx;this.pendingClip&&(this.pendingClip===B?c.clip("evenodd"):c.clip(),this.pendingClip=null),c.beginPath()}getSinglePixelWidth(){if(this._cachedGetSinglePixelWidth===null){const c=this.ctx.mozCurrentTransform,e=Math.abs(c[0]*c[3]-c[2]*c[1]),i=c[0]**2+c[2]**2,r=c[1]**2+c[3]**2,h=Math.sqrt(Math.max(i,r))/e;i!==r&&this._combinedScaleFactor*h>1?this._cachedGetSinglePixelWidth=-(this._combinedScaleFactor*h):e>Number.EPSILON?this._cachedGetSinglePixelWidth=h:this._cachedGetSinglePixelWidth=1}return this._cachedGetSinglePixelWidth}getCanvasPosition(c,e){const i=this.ctx.mozCurrentTransform;return[i[0]*c+i[2]*e+i[4],i[1]*c+i[3]*e+i[5]]}isContentVisible(){for(let c=this.markedContentStack.length-1;c>=0;c--)if(!this.markedContentStack[c].visible)return!1;return!0}}n.CanvasGraphics=J;for(const F in t.OPS)J.prototype[F]!==void 0&&(J.prototype[t.OPS[F]]=J.prototype[F])},(Y,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.getShadingPattern=P,n.TilingPattern=void 0;var t=o(2);function u(R,d){if(!d||typeof Path2D>"u")return;const k=d[2]-d[0],W=d[3]-d[1],U=new Path2D;U.rect(d[0],d[1],k,W),R.clip(U)}class g{constructor(){this.constructor===g&&(0,t.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,t.unreachable)("Abstract method `getPattern` called.")}}class C extends g{constructor(d,k){super(),this._type=d[1],this._bbox=d[2],this._colorStops=d[3],this._p0=d[4],this._p1=d[5],this._r0=d[6],this._r1=d[7],this.matrix=null,this.cachedCanvasPatterns=k}_createGradient(d){let k;this._type==="axial"?k=d.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(k=d.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const W of this._colorStops)k.addColorStop(W[0],W[1]);return k}getPattern(d,k,W,U=!1){let w;if(U)u(d,this._bbox),w=this._createGradient(d);else if(this.cachedCanvasPatterns.has(this))w=this.cachedCanvasPatterns.get(this);else{const s=k.cachedCanvases.getCanvas("pattern",k.ctx.canvas.width,k.ctx.canvas.height,!0),a=s.context;a.clearRect(0,0,a.canvas.width,a.canvas.height),a.beginPath(),a.rect(0,0,a.canvas.width,a.canvas.height),a.setTransform.apply(a,k.baseTransform),this.matrix&&a.transform.apply(a,this.matrix),u(a,this._bbox),a.fillStyle=this._createGradient(a),a.fill(),w=d.createPattern(s.canvas,"repeat"),this.cachedCanvasPatterns.set(this,w)}if(!U){const s=new DOMMatrix(W);try{w.setTransform(s)}catch(a){(0,t.warn)(`RadialAxialShadingPattern.getPattern: "${a==null?void 0:a.message}".`)}}return w}}function _(R,d,k,W,U,w,s,a){const p=d.coords,v=d.colors,y=R.data,D=R.width*4;let L;p[k+1]>p[W+1]&&(L=k,k=W,W=L,L=w,w=s,s=L),p[W+1]>p[U+1]&&(L=W,W=U,U=L,L=s,s=a,a=L),p[k+1]>p[W+1]&&(L=k,k=W,W=L,L=w,w=s,s=L);const Q=(p[k]+d.offsetX)*d.scaleX,H=(p[k+1]+d.offsetY)*d.scaleY,T=(p[W]+d.offsetX)*d.scaleX,M=(p[W+1]+d.offsetY)*d.scaleY,q=(p[U]+d.offsetX)*d.scaleX,G=(p[U+1]+d.offsetY)*d.scaleY;if(H>=G)return;const B=v[w],J=v[w+1],F=v[w+2],c=v[s],e=v[s+1],i=v[s+2],r=v[a],h=v[a+1],l=v[a+2],S=Math.round(H),x=Math.round(G);let I,N,O,$,z,K,Z,ie;for(let se=S;se<=x;se++){if(se<M){let ee;se<H?ee=0:ee=(H-se)/(H-M),I=Q-(Q-T)*ee,N=B-(B-c)*ee,O=J-(J-e)*ee,$=F-(F-i)*ee}else{let ee;se>G?ee=1:M===G?ee=0:ee=(M-se)/(M-G),I=T-(T-q)*ee,N=c-(c-r)*ee,O=e-(e-h)*ee,$=i-(i-l)*ee}let ae;se<H?ae=0:se>G?ae=1:ae=(H-se)/(H-G),z=Q-(Q-q)*ae,K=B-(B-r)*ae,Z=J-(J-h)*ae,ie=F-(F-l)*ae;const ne=Math.round(Math.min(I,z)),he=Math.round(Math.max(I,z));let ue=D*se+ne*4;for(let ee=ne;ee<=he;ee++)ae=(I-ee)/(I-z),ae<0?ae=0:ae>1&&(ae=1),y[ue++]=N-(N-K)*ae|0,y[ue++]=O-(O-Z)*ae|0,y[ue++]=$-($-ie)*ae|0,y[ue++]=255}}function b(R,d,k){const W=d.coords,U=d.colors;let w,s;switch(d.type){case"lattice":const a=d.verticesPerRow,p=Math.floor(W.length/a)-1,v=a-1;for(w=0;w<p;w++){let y=w*a;for(let D=0;D<v;D++,y++)_(R,k,W[y],W[y+1],W[y+a],U[y],U[y+1],U[y+a]),_(R,k,W[y+a+1],W[y+1],W[y+a],U[y+a+1],U[y+1],U[y+a])}break;case"triangles":for(w=0,s=W.length;w<s;w+=3)_(R,k,W[w],W[w+1],W[w+2],U[w],U[w+1],U[w+2]);break;default:throw new Error("illegal figure")}}class f extends g{constructor(d){super(),this._coords=d[2],this._colors=d[3],this._figures=d[4],this._bounds=d[5],this._bbox=d[7],this._background=d[8],this.matrix=null}_createMeshCanvas(d,k,W){const a=Math.floor(this._bounds[0]),p=Math.floor(this._bounds[1]),v=Math.ceil(this._bounds[2])-a,y=Math.ceil(this._bounds[3])-p,D=Math.min(Math.ceil(Math.abs(v*d[0]*1.1)),3e3),L=Math.min(Math.ceil(Math.abs(y*d[1]*1.1)),3e3),Q=v/D,H=y/L,T={coords:this._coords,colors:this._colors,offsetX:-a,offsetY:-p,scaleX:1/Q,scaleY:1/H},M=D+2*2,q=L+2*2,G=W.getCanvas("mesh",M,q,!1),B=G.context,J=B.createImageData(D,L);if(k){const c=J.data;for(let e=0,i=c.length;e<i;e+=4)c[e]=k[0],c[e+1]=k[1],c[e+2]=k[2],c[e+3]=255}for(const c of this._figures)b(J,c,T);return B.putImageData(J,2,2),{canvas:G.canvas,offsetX:a-2*Q,offsetY:p-2*H,scaleX:Q,scaleY:H}}getPattern(d,k,W,U=!1){u(d,this._bbox);let w;if(U)w=t.Util.singularValueDecompose2dScale(d.mozCurrentTransform);else if(w=t.Util.singularValueDecompose2dScale(k.baseTransform),this.matrix){const a=t.Util.singularValueDecompose2dScale(this.matrix);w=[w[0]*a[0],w[1]*a[1]]}const s=this._createMeshCanvas(w,U?null:this._background,k.cachedCanvases);return U||(d.setTransform.apply(d,k.baseTransform),this.matrix&&d.transform.apply(d,this.matrix)),d.translate(s.offsetX,s.offsetY),d.scale(s.scaleX,s.scaleY),d.createPattern(s.canvas,"no-repeat")}}class m extends g{getPattern(){return"hotpink"}}function P(R,d){switch(R[0]){case"RadialAxial":return new C(R,d);case"Mesh":return new f(R);case"Dummy":return new m}throw new Error(`Unknown IR type: ${R[0]}`)}const E={COLORED:1,UNCOLORED:2};class A{static get MAX_PATTERN_SIZE(){return(0,t.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(d,k,W,U,w){this.operatorList=d[2],this.matrix=d[3]||[1,0,0,1,0,0],this.bbox=d[4],this.xstep=d[5],this.ystep=d[6],this.paintType=d[7],this.tilingType=d[8],this.color=k,this.ctx=W,this.canvasGraphicsFactory=U,this.baseTransform=w}createPatternCanvas(d){const k=this.operatorList,W=this.bbox,U=this.xstep,w=this.ystep,s=this.paintType,a=this.tilingType,p=this.color,v=this.canvasGraphicsFactory;(0,t.info)("TilingType: "+a);const y=W[0],D=W[1],L=W[2],Q=W[3],H=t.Util.singularValueDecompose2dScale(this.matrix),T=t.Util.singularValueDecompose2dScale(this.baseTransform),M=[H[0]*T[0],H[1]*T[1]],q=this.getSizeAndScale(U,this.ctx.canvas.width,M[0]),G=this.getSizeAndScale(w,this.ctx.canvas.height,M[1]),B=d.cachedCanvases.getCanvas("pattern",q.size,G.size,!0),J=B.context,F=v.createCanvasGraphics(J);F.groupLevel=d.groupLevel,this.setFillAndStrokeStyleToContext(F,s,p);let c=y,e=D,i=L,r=Q;return y<0&&(c=0,i+=Math.abs(y)),D<0&&(e=0,r+=Math.abs(D)),J.translate(-(q.scale*c),-(G.scale*e)),F.transform(q.scale,0,0,G.scale,0,0),this.clipBbox(F,c,e,i,r),F.baseTransform=F.ctx.mozCurrentTransform.slice(),F.executeOperatorList(k),F.endDrawing(),{canvas:B.canvas,scaleX:q.scale,scaleY:G.scale,offsetX:c,offsetY:e}}getSizeAndScale(d,k,W){d=Math.abs(d);const U=Math.max(A.MAX_PATTERN_SIZE,k);let w=Math.ceil(d*W);return w>=U?w=U:W=w/d,{scale:W,size:w}}clipBbox(d,k,W,U,w){const s=U-k,a=w-W;d.ctx.rect(k,W,s,a),d.clip(),d.endPath()}setFillAndStrokeStyleToContext(d,k,W){const U=d.ctx,w=d.current;switch(k){case E.COLORED:const s=this.ctx;U.fillStyle=s.fillStyle,U.strokeStyle=s.strokeStyle,w.fillColor=s.fillStyle,w.strokeColor=s.strokeStyle;break;case E.UNCOLORED:const a=t.Util.makeHexColor(W[0],W[1],W[2]);U.fillStyle=a,U.strokeStyle=a,w.fillColor=a,w.strokeColor=a;break;default:throw new t.FormatError(`Unsupported paint type: ${k}`)}}getPattern(d,k,W,U=!1){let w=W;U||(w=t.Util.transform(w,k.baseTransform),this.matrix&&(w=t.Util.transform(w,this.matrix)));const s=this.createPatternCanvas(k);let a=new DOMMatrix(w);a=a.translate(s.offsetX,s.offsetY),a=a.scale(1/s.scaleX,1/s.scaleY);const p=d.createPattern(s.canvas,"repeat");try{p.setTransform(a)}catch(v){(0,t.warn)(`TilingPattern.getPattern: "${v==null?void 0:v.message}".`)}return p}}n.TilingPattern=A},(Y,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.GlobalWorkerOptions=void 0;const o=Object.create(null);n.GlobalWorkerOptions=o,o.workerPort=o.workerPort===void 0?null:o.workerPort,o.workerSrc=o.workerSrc===void 0?"":o.workerSrc},(Y,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.MessageHandler=void 0;var t=o(2);const u={UNKNOWN:0,DATA:1,ERROR:2},g={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function C(b){if(!(b instanceof Error||typeof b=="object"&&b!==null))return(0,t.warn)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),b;switch(b.name){case"AbortException":return new t.AbortException(b.message);case"MissingPDFException":return new t.MissingPDFException(b.message);case"PasswordException":return new t.PasswordException(b.message,b.code);case"UnexpectedResponseException":return new t.UnexpectedResponseException(b.message,b.status);case"UnknownErrorException":return new t.UnknownErrorException(b.message,b.details);default:return new t.UnknownErrorException(b.message,b.toString())}}class _{constructor(f,m,P){this.sourceName=f,this.targetName=m,this.comObj=P,this.callbackId=1,this.streamId=1,this.postMessageTransfers=!0,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=E=>{const A=E.data;if(A.targetName!==this.sourceName)return;if(A.stream){this._processStreamMessage(A);return}if(A.callback){const d=A.callbackId,k=this.callbackCapabilities[d];if(!k)throw new Error(`Cannot resolve callback ${d}`);if(delete this.callbackCapabilities[d],A.callback===u.DATA)k.resolve(A.data);else if(A.callback===u.ERROR)k.reject(C(A.reason));else throw new Error("Unexpected callback case");return}const R=this.actionHandler[A.action];if(!R)throw new Error(`Unknown action from worker: ${A.action}`);if(A.callbackId){const d=this.sourceName,k=A.sourceName;new Promise(function(W){W(R(A.data))}).then(function(W){P.postMessage({sourceName:d,targetName:k,callback:u.DATA,callbackId:A.callbackId,data:W})},function(W){P.postMessage({sourceName:d,targetName:k,callback:u.ERROR,callbackId:A.callbackId,reason:C(W)})});return}if(A.streamId){this._createStreamSink(A);return}R(A.data)},P.addEventListener("message",this._onComObjOnMessage)}on(f,m){const P=this.actionHandler;if(P[f])throw new Error(`There is already an actionName called "${f}"`);P[f]=m}send(f,m,P){this._postMessage({sourceName:this.sourceName,targetName:this.targetName,action:f,data:m},P)}sendWithPromise(f,m,P){const E=this.callbackId++,A=(0,t.createPromiseCapability)();this.callbackCapabilities[E]=A;try{this._postMessage({sourceName:this.sourceName,targetName:this.targetName,action:f,callbackId:E,data:m},P)}catch(R){A.reject(R)}return A.promise}sendWithStream(f,m,P,E){const A=this.streamId++,R=this.sourceName,d=this.targetName,k=this.comObj;return new ReadableStream({start:W=>{const U=(0,t.createPromiseCapability)();return this.streamControllers[A]={controller:W,startCall:U,pullCall:null,cancelCall:null,isClosed:!1},this._postMessage({sourceName:R,targetName:d,action:f,streamId:A,data:m,desiredSize:W.desiredSize},E),U.promise},pull:W=>{const U=(0,t.createPromiseCapability)();return this.streamControllers[A].pullCall=U,k.postMessage({sourceName:R,targetName:d,stream:g.PULL,streamId:A,desiredSize:W.desiredSize}),U.promise},cancel:W=>{(0,t.assert)(W instanceof Error,"cancel must have a valid reason");const U=(0,t.createPromiseCapability)();return this.streamControllers[A].cancelCall=U,this.streamControllers[A].isClosed=!0,k.postMessage({sourceName:R,targetName:d,stream:g.CANCEL,streamId:A,reason:C(W)}),U.promise}},P)}_createStreamSink(f){const m=f.streamId,P=this.sourceName,E=f.sourceName,A=this.comObj,R=this,d=this.actionHandler[f.action],k={enqueue(W,U=1,w){if(this.isCancelled)return;const s=this.desiredSize;this.desiredSize-=U,s>0&&this.desiredSize<=0&&(this.sinkCapability=(0,t.createPromiseCapability)(),this.ready=this.sinkCapability.promise),R._postMessage({sourceName:P,targetName:E,stream:g.ENQUEUE,streamId:m,chunk:W},w)},close(){this.isCancelled||(this.isCancelled=!0,A.postMessage({sourceName:P,targetName:E,stream:g.CLOSE,streamId:m}),delete R.streamSinks[m])},error(W){(0,t.assert)(W instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,A.postMessage({sourceName:P,targetName:E,stream:g.ERROR,streamId:m,reason:C(W)}))},sinkCapability:(0,t.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:f.desiredSize,ready:null};k.sinkCapability.resolve(),k.ready=k.sinkCapability.promise,this.streamSinks[m]=k,new Promise(function(W){W(d(f.data,k))}).then(function(){A.postMessage({sourceName:P,targetName:E,stream:g.START_COMPLETE,streamId:m,success:!0})},function(W){A.postMessage({sourceName:P,targetName:E,stream:g.START_COMPLETE,streamId:m,reason:C(W)})})}_processStreamMessage(f){const m=f.streamId,P=this.sourceName,E=f.sourceName,A=this.comObj,R=this.streamControllers[m],d=this.streamSinks[m];switch(f.stream){case g.START_COMPLETE:f.success?R.startCall.resolve():R.startCall.reject(C(f.reason));break;case g.PULL_COMPLETE:f.success?R.pullCall.resolve():R.pullCall.reject(C(f.reason));break;case g.PULL:if(!d){A.postMessage({sourceName:P,targetName:E,stream:g.PULL_COMPLETE,streamId:m,success:!0});break}d.desiredSize<=0&&f.desiredSize>0&&d.sinkCapability.resolve(),d.desiredSize=f.desiredSize,new Promise(function(k){k(d.onPull&&d.onPull())}).then(function(){A.postMessage({sourceName:P,targetName:E,stream:g.PULL_COMPLETE,streamId:m,success:!0})},function(k){A.postMessage({sourceName:P,targetName:E,stream:g.PULL_COMPLETE,streamId:m,reason:C(k)})});break;case g.ENQUEUE:if((0,t.assert)(R,"enqueue should have stream controller"),R.isClosed)break;R.controller.enqueue(f.chunk);break;case g.CLOSE:if((0,t.assert)(R,"close should have stream controller"),R.isClosed)break;R.isClosed=!0,R.controller.close(),this._deleteStreamController(R,m);break;case g.ERROR:(0,t.assert)(R,"error should have stream controller"),R.controller.error(C(f.reason)),this._deleteStreamController(R,m);break;case g.CANCEL_COMPLETE:f.success?R.cancelCall.resolve():R.cancelCall.reject(C(f.reason)),this._deleteStreamController(R,m);break;case g.CANCEL:if(!d)break;new Promise(function(k){k(d.onCancel&&d.onCancel(C(f.reason)))}).then(function(){A.postMessage({sourceName:P,targetName:E,stream:g.CANCEL_COMPLETE,streamId:m,success:!0})},function(k){A.postMessage({sourceName:P,targetName:E,stream:g.CANCEL_COMPLETE,streamId:m,reason:C(k)})}),d.sinkCapability.reject(C(f.reason)),d.isCancelled=!0,delete this.streamSinks[m];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(f,m){await Promise.allSettled([f.startCall&&f.startCall.promise,f.pullCall&&f.pullCall.promise,f.cancelCall&&f.cancelCall.promise]),delete this.streamControllers[m]}_postMessage(f,m){m&&this.postMessageTransfers?this.comObj.postMessage(f,m):this.comObj.postMessage(f)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}n.MessageHandler=_},(Y,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Metadata=void 0;var t=o(2);class u{constructor({parsedData:C,rawData:_}){this._metadataMap=C,this._data=_}getRaw(){return this._data}get(C){return this._metadataMap.get(C)??null}getAll(){return(0,t.objectFromMap)(this._metadataMap)}has(C){return this._metadataMap.has(C)}}n.Metadata=u},(Y,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.OptionalContentConfig=void 0;var t=o(2);class u{constructor(_,b){this.visible=!0,this.name=_,this.intent=b}}class g{constructor(_){if(this.name=null,this.creator=null,this._order=null,this._groups=new Map,_!==null){this.name=_.name,this.creator=_.creator,this._order=_.order;for(const b of _.groups)this._groups.set(b.id,new u(b.name,b.intent));if(_.baseState==="OFF")for(const b of this._groups)b.visible=!1;for(const b of _.on)this._groups.get(b).visible=!0;for(const b of _.off)this._groups.get(b).visible=!1}}_evaluateVisibilityExpression(_){const b=_.length;if(b<2)return!0;const f=_[0];for(let m=1;m<b;m++){const P=_[m];let E;if(Array.isArray(P))E=this._evaluateVisibilityExpression(P);else if(this._groups.has(P))E=this._groups.get(P).visible;else return(0,t.warn)(`Optional content group not found: ${P}`),!0;switch(f){case"And":if(!E)return!1;break;case"Or":if(E)return!0;break;case"Not":return!E;default:return!0}}return f==="And"}isVisible(_){if(this._groups.size===0)return!0;if(!_)return(0,t.warn)("Optional content group not defined."),!0;if(_.type==="OCG")return this._groups.has(_.id)?this._groups.get(_.id).visible:((0,t.warn)(`Optional content group not found: ${_.id}`),!0);if(_.type==="OCMD"){if(_.expression)return this._evaluateVisibilityExpression(_.expression);if(!_.policy||_.policy==="AnyOn"){for(const b of _.ids){if(!this._groups.has(b))return(0,t.warn)(`Optional content group not found: ${b}`),!0;if(this._groups.get(b).visible)return!0}return!1}else if(_.policy==="AllOn"){for(const b of _.ids){if(!this._groups.has(b))return(0,t.warn)(`Optional content group not found: ${b}`),!0;if(!this._groups.get(b).visible)return!1}return!0}else if(_.policy==="AnyOff"){for(const b of _.ids){if(!this._groups.has(b))return(0,t.warn)(`Optional content group not found: ${b}`),!0;if(!this._groups.get(b).visible)return!0}return!1}else if(_.policy==="AllOff"){for(const b of _.ids){if(!this._groups.has(b))return(0,t.warn)(`Optional content group not found: ${b}`),!0;if(this._groups.get(b).visible)return!1}return!0}return(0,t.warn)(`Unknown optional content policy ${_.policy}.`),!0}return(0,t.warn)(`Unknown group type ${_.type}.`),!0}setVisibility(_,b=!0){if(!this._groups.has(_)){(0,t.warn)(`Optional content group not found: ${_}`);return}this._groups.get(_).visible=!!b}getOrder(){return this._groups.size?this._order?this._order.slice():Array.from(this._groups.keys()):null}getGroups(){return this._groups.size>0?(0,t.objectFromMap)(this._groups):null}getGroup(_){return this._groups.get(_)||null}}n.OptionalContentConfig=g},(Y,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFDataTransportStream=void 0;var t=o(2),u=o(1);class g{constructor(f,m){(0,t.assert)(m,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=f.progressiveDone||!1,this._contentDispositionFilename=f.contentDispositionFilename||null;const P=f.initialData;if((P==null?void 0:P.length)>0){const E=new Uint8Array(P).buffer;this._queuedChunks.push(E)}this._pdfDataRangeTransport=m,this._isStreamingSupported=!f.disableStream,this._isRangeSupported=!f.disableRange,this._contentLength=f.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((E,A)=>{this._onReceiveData({begin:E,chunk:A})}),this._pdfDataRangeTransport.addProgressListener((E,A)=>{this._onProgress({loaded:E,total:A})}),this._pdfDataRangeTransport.addProgressiveReadListener(E=>{this._onReceiveData({chunk:E})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData(f){const m=new Uint8Array(f.chunk).buffer;if(f.begin===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(m):this._queuedChunks.push(m);else{const P=this._rangeReaders.some(function(E){return E._begin!==f.begin?!1:(E._enqueue(m),!0)});(0,t.assert)(P,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var f;return((f=this._fullRequestReader)==null?void 0:f._loaded)??0}_onProgress(f){if(f.total===void 0){const m=this._rangeReaders[0];m!=null&&m.onProgress&&m.onProgress({loaded:f.loaded})}else{const m=this._fullRequestReader;m!=null&&m.onProgress&&m.onProgress({loaded:f.loaded,total:f.total})}}_onProgressiveDone(){this._fullRequestReader&&this._fullRequestReader.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(f){const m=this._rangeReaders.indexOf(f);m>=0&&this._rangeReaders.splice(m,1)}getFullReader(){(0,t.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const f=this._queuedChunks;return this._queuedChunks=null,new C(this,f,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(f,m){if(m<=this._progressiveDataLength)return null;const P=new _(this,f,m);return this._pdfDataRangeTransport.requestDataRange(f,m),this._rangeReaders.push(P),P}cancelAllRequests(f){this._fullRequestReader&&this._fullRequestReader.cancel(f);for(const m of this._rangeReaders.slice(0))m.cancel(f);this._pdfDataRangeTransport.abort()}}n.PDFDataTransportStream=g;class C{constructor(f,m,P=!1,E=null){this._stream=f,this._done=P||!1,this._filename=(0,u.isPdfFile)(E)?E:null,this._queuedChunks=m||[],this._loaded=0;for(const A of this._queuedChunks)this._loaded+=A.byteLength;this._requests=[],this._headersReady=Promise.resolve(),f._fullRequestReader=this,this.onProgress=null}_enqueue(f){this._done||(this._requests.length>0?this._requests.shift().resolve({value:f,done:!1}):this._queuedChunks.push(f),this._loaded+=f.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const f=(0,t.createPromiseCapability)();return this._requests.push(f),f.promise}cancel(f){this._done=!0;for(const m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class _{constructor(f,m,P){this._stream=f,this._begin=m,this._end=P,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(f){if(!this._done){if(this._requests.length===0)this._queuedChunk=f;else{this._requests.shift().resolve({value:f,done:!1});for(const P of this._requests)P.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const m=this._queuedChunk;return this._queuedChunk=null,{value:m,done:!1}}if(this._done)return{value:void 0,done:!0};const f=(0,t.createPromiseCapability)();return this._requests.push(f),f.promise}cancel(f){this._done=!0;for(const m of this._requests)m.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(Y,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.XfaText=void 0;class o{static textContent(u){const g=[],C={items:g,styles:Object.create(null)};function _(b){var P;if(!b)return;let f=null;const m=b.name;if(m==="#text")f=b.value;else if(o.shouldBuildText(m))(P=b==null?void 0:b.attributes)!=null&&P.textContent?f=b.attributes.textContent:b.value&&(f=b.value);else return;if(f!==null&&g.push({str:f}),!!b.children)for(const E of b.children)_(E)}return _(u),C}static shouldBuildText(u){return!(u==="textarea"||u==="input"||u==="option"||u==="select")}}n.XfaText=o},(Y,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.AnnotationLayer=void 0;var t=o(2),u=o(1),g=o(9),C=o(19);const _=1e3,b=new WeakSet;class f{static create(e){switch(e.data.annotationType){case t.AnnotationType.LINK:return new P(e);case t.AnnotationType.TEXT:return new E(e);case t.AnnotationType.WIDGET:switch(e.data.fieldType){case"Tx":return new R(e);case"Btn":return e.data.radioButton?new k(e):e.data.checkBox?new d(e):new W(e);case"Ch":return new U(e)}return new A(e);case t.AnnotationType.POPUP:return new w(e);case t.AnnotationType.FREETEXT:return new a(e);case t.AnnotationType.LINE:return new p(e);case t.AnnotationType.SQUARE:return new v(e);case t.AnnotationType.CIRCLE:return new y(e);case t.AnnotationType.POLYLINE:return new D(e);case t.AnnotationType.CARET:return new Q(e);case t.AnnotationType.INK:return new H(e);case t.AnnotationType.POLYGON:return new L(e);case t.AnnotationType.HIGHLIGHT:return new T(e);case t.AnnotationType.UNDERLINE:return new M(e);case t.AnnotationType.SQUIGGLY:return new q(e);case t.AnnotationType.STRIKEOUT:return new G(e);case t.AnnotationType.STAMP:return new B(e);case t.AnnotationType.FILEATTACHMENT:return new J(e);default:return new m(e)}}}class m{constructor(e,{isRenderable:i=!1,ignoreBorder:r=!1,createQuadrilaterals:h=!1}={}){this.isRenderable=i,this.data=e.data,this.layer=e.layer,this.page=e.page,this.viewport=e.viewport,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this._mouseState=e.mouseState,i&&(this.container=this._createContainer(r)),h&&(this.quadrilaterals=this._createQuadrilaterals(r))}_createContainer(e=!1){const i=this.data,r=this.page,h=this.viewport,l=document.createElement("section");let S=i.rect[2]-i.rect[0],x=i.rect[3]-i.rect[1];l.setAttribute("data-annotation-id",i.id);const I=t.Util.normalizeRect([i.rect[0],r.view[3]-i.rect[1]+r.view[1],i.rect[2],r.view[3]-i.rect[3]+r.view[1]]);if(l.style.transform=`matrix(${h.transform.join(",")})`,l.style.transformOrigin=`${-I[0]}px ${-I[1]}px`,!e&&i.borderStyle.width>0){l.style.borderWidth=`${i.borderStyle.width}px`,i.borderStyle.style!==t.AnnotationBorderStyleType.UNDERLINE&&(S-=2*i.borderStyle.width,x-=2*i.borderStyle.width);const N=i.borderStyle.horizontalCornerRadius,O=i.borderStyle.verticalCornerRadius;if(N>0||O>0){const z=`${N}px / ${O}px`;l.style.borderRadius=z}switch(i.borderStyle.style){case t.AnnotationBorderStyleType.SOLID:l.style.borderStyle="solid";break;case t.AnnotationBorderStyleType.DASHED:l.style.borderStyle="dashed";break;case t.AnnotationBorderStyleType.BEVELED:(0,t.warn)("Unimplemented border style: beveled");break;case t.AnnotationBorderStyleType.INSET:(0,t.warn)("Unimplemented border style: inset");break;case t.AnnotationBorderStyleType.UNDERLINE:l.style.borderBottomStyle="solid";break}i.borderColor||i.color||null?l.style.borderColor=t.Util.makeHexColor(i.color[0]|0,i.color[1]|0,i.color[2]|0):l.style.borderWidth=0}return l.style.left=`${I[0]}px`,l.style.top=`${I[1]}px`,l.style.width=`${S}px`,l.style.height=`${x}px`,l}_createQuadrilaterals(e=!1){if(!this.data.quadPoints)return null;const i=[],r=this.data.rect;for(const h of this.data.quadPoints)this.data.rect=[h[2].x,h[2].y,h[1].x,h[1].y],i.push(this._createContainer(e));return this.data.rect=r,i}_createPopup(e,i){let r=this.container;this.quadrilaterals&&(e=e||this.quadrilaterals,r=this.quadrilaterals[0]),e||(e=document.createElement("div"),e.style.height=r.style.height,e.style.width=r.style.width,r.appendChild(e));const l=new s({container:r,trigger:e,color:i.color,titleObj:i.titleObj,modificationDate:i.modificationDate,contentsObj:i.contentsObj,hideWrapper:!0}).render();l.style.left=r.style.width,r.appendChild(l)}_renderQuadrilaterals(e){for(const i of this.quadrilaterals)i.className=e;return this.quadrilaterals}render(){(0,t.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,i=null){const r=[];if(this._fieldObjects){const h=this._fieldObjects[e];if(h)for(const{page:l,id:S,exportValues:x}of h){if(l===-1||S===i)continue;const I=typeof x=="string"?x:null,N=document.getElementById(S);if(N&&!b.has(N)){(0,t.warn)(`_getElementsByName - element not allowed: ${S}`);continue}r.push({id:S,exportValue:I,domElement:N})}return r}for(const h of document.getElementsByName(e)){const{id:l,exportValue:S}=h;l!==i&&b.has(h)&&r.push({id:l,exportValue:S,domElement:h})}return r}static get platform(){const e=typeof navigator<"u"?navigator.platform:"";return(0,t.shadow)(this,"platform",{isWin:e.includes("Win"),isMac:e.includes("Mac")})}}class P extends m{constructor(e){const i=!!(e.data.url||e.data.dest||e.data.action||e.data.isTooltipOnly||e.data.resetForm||e.data.actions&&(e.data.actions.Action||e.data.actions["Mouse Up"]||e.data.actions["Mouse Down"]));super(e,{isRenderable:i,createQuadrilaterals:!0})}render(){var h;const{data:e,linkService:i}=this,r=document.createElement("a");if(e.url)i.addLinkAttributes||(0,t.warn)("LinkAnnotationElement.render - missing `addLinkAttributes`-method on the `linkService`-instance."),(h=i.addLinkAttributes)==null||h.call(i,r,e.url,e.newWindow);else if(e.action)this._bindNamedAction(r,e.action);else if(e.dest)this._bindLink(r,e.dest);else{let l=!1;e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(l=!0,this._bindJSAction(r,e)),e.resetForm?this._bindResetFormAction(r,e.resetForm):l||this._bindLink(r,"")}return this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((l,S)=>{const x=S===0?r:r.cloneNode();return l.appendChild(x),l}):(this.container.className="linkAnnotation",this.container.appendChild(r),this.container)}_bindLink(e,i){e.href=this.linkService.getDestinationHash(i),e.onclick=()=>(i&&this.linkService.goToDestination(i),!1),(i||i==="")&&(e.className="internalLink")}_bindNamedAction(e,i){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(i),!1),e.className="internalLink"}_bindJSAction(e,i){e.href=this.linkService.getAnchorUrl("");const r=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const h of Object.keys(i.actions)){const l=r.get(h);l&&(e[l]=()=>{var S;return(S=this.linkService.eventBus)==null||S.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i.id,name:h}}),!1})}e.onclick||(e.onclick=()=>!1),e.className="internalLink"}_bindResetFormAction(e,i){const r=e.onclick;if(r||(e.href=this.linkService.getAnchorUrl("")),e.className="internalLink",!this._fieldObjects){(0,t.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),r||(e.onclick=()=>!1);return}e.onclick=()=>{var O;r&&r();const{fields:h,refs:l,include:S}=i,x=[];if(h.length!==0||l.length!==0){const $=new Set(l);for(const z of h){const K=this._fieldObjects[z]||[];for(const{id:Z}of K)$.add(Z)}for(const z of Object.values(this._fieldObjects))for(const K of z)$.has(K.id)===S&&x.push(K)}else for(const $ of Object.values(this._fieldObjects))x.push(...$);const I=this.annotationStorage,N=[];for(const $ of x){const{id:z}=$;switch(N.push(z),$.type){case"text":{const Z=$.defaultValue||"";I.setValue(z,{value:Z,valueAsString:Z});break}case"checkbox":case"radiobutton":{const Z=$.defaultValue===$.exportValues;I.setValue(z,{value:Z});break}case"combobox":case"listbox":{const Z=$.defaultValue||"";I.setValue(z,{value:Z});break}default:continue}const K=document.getElementById(z);!K||!b.has(K)||K.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((O=this.linkService.eventBus)==null||O.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:N,name:"ResetForm"}})),!1}}}class E extends m{constructor(e){var r,h;const i=!!(e.data.hasPopup||(r=e.data.titleObj)!=null&&r.str||(h=e.data.contentsObj)!=null&&h.str);super(e,{isRenderable:i})}render(){this.container.className="textAnnotation";const e=document.createElement("img");return e.style.height=this.container.style.height,e.style.width=this.container.style.width,e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.alt="[{{type}} Annotation]",e.dataset.l10nId="text_annotation_type",e.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(e,this.data),this.container.appendChild(e),this.container}}class A extends m{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(e){const{isWin:i,isMac:r}=m.platform;return i&&e.ctrlKey||r&&e.metaKey}_setEventListener(e,i,r,h){i.includes("mouse")?e.addEventListener(i,l=>{var S;(S=this.linkService.eventBus)==null||S.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:h(l),shift:l.shiftKey,modifier:this._getKeyModifier(l)}})}):e.addEventListener(i,l=>{var S;(S=this.linkService.eventBus)==null||S.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:l.target.checked}})})}_setEventListeners(e,i,r){var h;for(const[l,S]of i)(S==="Action"||(h=this.data.actions)!=null&&h[S])&&this._setEventListener(e,l,S,r)}_setBackgroundColor(e){const i=this.data.backgroundColor||null;e.style.backgroundColor=i===null?"transparent":t.Util.makeHexColor(i[0],i[1],i[2])}_dispatchEventFromSandbox(e,i){const r=(l,S,x)=>{const I=x.detail[l];x.target.style[S]=C.ColorConverters[`${I[0]}_HTML`](I.slice(1))},h={display:l=>{const S=l.detail.display%2===1;l.target.style.visibility=S?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:S,print:l.detail.display===0||l.detail.display===3})},print:l=>{this.annotationStorage.setValue(this.data.id,{print:l.detail.print})},hidden:l=>{l.target.style.visibility=l.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:l.detail.hidden})},focus:l=>{setTimeout(()=>l.target.focus({preventScroll:!1}),0)},userName:l=>{l.target.title=l.detail.userName},readonly:l=>{l.detail.readonly?l.target.setAttribute("readonly",""):l.target.removeAttribute("readonly")},required:l=>{l.detail.required?l.target.setAttribute("required",""):l.target.removeAttribute("required")},bgColor:l=>{r("bgColor","backgroundColor",l)},fillColor:l=>{r("fillColor","backgroundColor",l)},fgColor:l=>{r("fgColor","color",l)},textColor:l=>{r("textColor","color",l)},borderColor:l=>{r("borderColor","borderColor",l)},strokeColor:l=>{r("strokeColor","borderColor",l)}};for(const l of Object.keys(i.detail)){const S=e[l]||h[l];S&&S(i)}}}class R extends A{constructor(e){const i=e.renderForms||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:i})}setPropertyOnSiblings(e,i,r,h){const l=this.annotationStorage;for(const S of this._getElementsByName(e.name,e.id))S.domElement&&(S.domElement[i]=r),l.setValue(S.id,{[h]:r})}render(){var h;const e=this.annotationStorage,i=this.data.id;this.container.className="textWidgetAnnotation";let r=null;if(this.renderForms){const l=e.getValue(i,{value:this.data.fieldValue,valueAsString:this.data.fieldValue}),S=l.valueAsString||l.value||"",x={userValue:null,formattedValue:null,beforeInputSelectionRange:null,beforeInputValue:null};this.data.multiLine?(r=document.createElement("textarea"),r.textContent=S):(r=document.createElement("input"),r.type="text",r.setAttribute("value",S)),b.add(r),r.disabled=this.data.readOnly,r.name=this.data.fieldName,r.tabIndex=_,x.userValue=S,r.setAttribute("id",i),r.addEventListener("input",N=>{e.setValue(i,{value:N.target.value}),this.setPropertyOnSiblings(r,"value",N.target.value,"value")}),r.addEventListener("resetform",N=>{const O=this.data.defaultFieldValue||"";r.value=x.userValue=O,delete x.formattedValue});let I=N=>{x.formattedValue&&(N.target.value=x.formattedValue),N.target.scrollLeft=0,x.beforeInputSelectionRange=null};if(this.enableScripting&&this.hasJSActions){r.addEventListener("focus",O=>{x.userValue&&(O.target.value=x.userValue)}),r.addEventListener("updatefromsandbox",O=>{const $={value(z){x.userValue=z.detail.value||"",e.setValue(i,{value:x.userValue.toString()}),x.formattedValue||(z.target.value=x.userValue)},valueAsString(z){x.formattedValue=z.detail.valueAsString||"",z.target!==document.activeElement&&(z.target.value=x.formattedValue),e.setValue(i,{formattedValue:x.formattedValue})},selRange(z){const[K,Z]=z.detail.selRange;K>=0&&Z<z.target.value.length&&z.target.setSelectionRange(K,Z)}};this._dispatchEventFromSandbox($,O)}),r.addEventListener("keydown",O=>{var z;x.beforeInputValue=O.target.value;let $=-1;O.key==="Escape"?$=0:O.key==="Enter"?$=2:O.key==="Tab"&&($=3),$!==-1&&(x.userValue=O.target.value,(z=this.linkService.eventBus)==null||z.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:O.target.value,willCommit:!0,commitKey:$,selStart:O.target.selectionStart,selEnd:O.target.selectionEnd}}))});const N=I;I=null,r.addEventListener("blur",O=>{var $;this._mouseState.isDown&&(x.userValue=O.target.value,($=this.linkService.eventBus)==null||$.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:O.target.value,willCommit:!0,commitKey:1,selStart:O.target.selectionStart,selEnd:O.target.selectionEnd}})),N(O)}),r.addEventListener("mousedown",O=>{x.beforeInputValue=O.target.value,x.beforeInputSelectionRange=null}),r.addEventListener("keyup",O=>{O.target.selectionStart===O.target.selectionEnd&&(x.beforeInputSelectionRange=null)}),r.addEventListener("select",O=>{x.beforeInputSelectionRange=[O.target.selectionStart,O.target.selectionEnd]}),(h=this.data.actions)!=null&&h.Keystroke&&r.addEventListener("input",O=>{var K;let $=-1,z=-1;x.beforeInputSelectionRange&&([$,z]=x.beforeInputSelectionRange),(K=this.linkService.eventBus)==null||K.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:x.beforeInputValue,change:O.data,willCommit:!1,selStart:$,selEnd:z}})}),this._setEventListeners(r,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],O=>O.target.value)}if(I&&r.addEventListener("blur",I),this.data.maxLen!==null&&(r.maxLength=this.data.maxLen),this.data.comb){const O=(this.data.rect[2]-this.data.rect[0])/this.data.maxLen;r.classList.add("comb"),r.style.letterSpacing=`calc(${O}px - 1ch)`}}else r=document.createElement("div"),r.textContent=this.data.fieldValue,r.style.verticalAlign="middle",r.style.display="table-cell";return this._setTextStyle(r),this._setBackgroundColor(r),this.container.appendChild(r),this.container}_setTextStyle(e){const i=["left","center","right"],{fontSize:r,fontColor:h}=this.data.defaultAppearanceData,l=e.style;r&&(l.fontSize=`${r}px`),l.color=t.Util.makeHexColor(h[0],h[1],h[2]),this.data.textAlignment!==null&&(l.textAlign=i[this.data.textAlignment])}}class d extends A{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,i=this.data,r=i.id;let h=e.getValue(r,{value:i.exportValue===i.fieldValue}).value;typeof h=="string"&&(h=h!=="Off",e.setValue(r,{value:h})),this.container.className="buttonWidgetAnnotation checkBox";const l=document.createElement("input");return b.add(l),l.disabled=i.readOnly,l.type="checkbox",l.name=i.fieldName,h&&l.setAttribute("checked",!0),l.setAttribute("id",r),l.setAttribute("exportValue",i.exportValue),l.tabIndex=_,l.addEventListener("change",S=>{const{name:x,checked:I}=S.target;for(const N of this._getElementsByName(x,r)){const O=I&&N.exportValue===i.exportValue;N.domElement&&(N.domElement.checked=O),e.setValue(N.id,{value:O})}e.setValue(r,{value:I})}),l.addEventListener("resetform",S=>{const x=i.defaultFieldValue||"Off";S.target.checked=x===i.exportValue}),this.enableScripting&&this.hasJSActions&&(l.addEventListener("updatefromsandbox",S=>{const x={value(I){I.target.checked=I.detail.value!=="Off",e.setValue(r,{value:I.target.checked})}};this._dispatchEventFromSandbox(x,S)}),this._setEventListeners(l,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],S=>S.target.checked)),this._setBackgroundColor(l),this.container.appendChild(l),this.container}}class k extends A{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.className="buttonWidgetAnnotation radioButton";const e=this.annotationStorage,i=this.data,r=i.id;let h=e.getValue(r,{value:i.fieldValue===i.buttonValue}).value;typeof h=="string"&&(h=h!==i.buttonValue,e.setValue(r,{value:h}));const l=document.createElement("input");if(b.add(l),l.disabled=i.readOnly,l.type="radio",l.name=i.fieldName,h&&l.setAttribute("checked",!0),l.setAttribute("id",r),l.tabIndex=_,l.addEventListener("change",S=>{const{name:x,checked:I}=S.target;for(const N of this._getElementsByName(x,r))e.setValue(N.id,{value:!1});e.setValue(r,{value:I})}),l.addEventListener("resetform",S=>{const x=i.defaultFieldValue;S.target.checked=x!=null&&x===i.buttonValue}),this.enableScripting&&this.hasJSActions){const S=i.buttonValue;l.addEventListener("updatefromsandbox",x=>{const I={value:N=>{const O=S===N.detail.value;for(const $ of this._getElementsByName(N.target.name)){const z=O&&$.id===r;$.domElement&&($.domElement.checked=z),e.setValue($.id,{value:z})}}};this._dispatchEventFromSandbox(I,x)}),this._setEventListeners(l,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],x=>x.target.checked)}return this._setBackgroundColor(l),this.container.appendChild(l),this.container}}class W extends P{render(){const e=super.render();return e.className="buttonWidgetAnnotation pushButton",this.data.alternativeText&&(e.title=this.data.alternativeText),e}}class U extends A{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.className="choiceWidgetAnnotation";const e=this.annotationStorage,i=this.data.id;e.getValue(i,{value:this.data.fieldValue.length>0?this.data.fieldValue[0]:void 0});let{fontSize:r}=this.data.defaultAppearanceData;r||(r=9);const h=`calc(${r}px * var(--zoom-factor))`,l=document.createElement("select");b.add(l),l.disabled=this.data.readOnly,l.name=this.data.fieldName,l.setAttribute("id",i),l.tabIndex=_,l.style.fontSize=`${r}px`,this.data.combo||(l.size=this.data.options.length,this.data.multiSelect&&(l.multiple=!0)),l.addEventListener("resetform",I=>{const N=this.data.defaultFieldValue;for(const O of l.options)O.selected=O.value===N});for(const I of this.data.options){const N=document.createElement("option");N.textContent=I.displayValue,N.value=I.exportValue,this.data.combo&&(N.style.fontSize=h),this.data.fieldValue.includes(I.exportValue)&&N.setAttribute("selected",!0),l.appendChild(N)}const S=(I,N)=>{const O=N?"value":"textContent",$=I.target.options;return I.target.multiple?Array.prototype.filter.call($,z=>z.selected).map(z=>z[O]):$.selectedIndex===-1?null:$[$.selectedIndex][O]},x=I=>{const N=I.target.options;return Array.prototype.map.call(N,O=>({displayValue:O.textContent,exportValue:O.value}))};return this.enableScripting&&this.hasJSActions?(l.addEventListener("updatefromsandbox",I=>{const N={value(O){const $=O.detail.value,z=new Set(Array.isArray($)?$:[$]);for(const K of l.options)K.selected=z.has(K.value);e.setValue(i,{value:S(O,!0)})},multipleSelection(O){l.multiple=!0},remove(O){const $=l.options,z=O.detail.remove;$[z].selected=!1,l.remove(z),$.length>0&&Array.prototype.findIndex.call($,Z=>Z.selected)===-1&&($[0].selected=!0),e.setValue(i,{value:S(O,!0),items:x(O)})},clear(O){for(;l.length!==0;)l.remove(0);e.setValue(i,{value:null,items:[]})},insert(O){const{index:$,displayValue:z,exportValue:K}=O.detail.insert,Z=document.createElement("option");Z.textContent=z,Z.value=K,l.insertBefore(Z,l.children[$]),e.setValue(i,{value:S(O,!0),items:x(O)})},items(O){const{items:$}=O.detail;for(;l.length!==0;)l.remove(0);for(const z of $){const{displayValue:K,exportValue:Z}=z,ie=document.createElement("option");ie.textContent=K,ie.value=Z,l.appendChild(ie)}l.options.length>0&&(l.options[0].selected=!0),e.setValue(i,{value:S(O,!0),items:x(O)})},indices(O){const $=new Set(O.detail.indices);for(const z of O.target.options)z.selected=$.has(z.index);e.setValue(i,{value:S(O,!0)})},editable(O){O.target.disabled=!O.detail.editable}};this._dispatchEventFromSandbox(N,I)}),l.addEventListener("input",I=>{var $;const N=S(I,!0),O=S(I,!1);e.setValue(i,{value:N}),($=this.linkService.eventBus)==null||$.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i,name:"Keystroke",value:O,changeEx:N,willCommit:!0,commitKey:1,keyDown:!1}})}),this._setEventListeners(l,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"]],I=>I.target.checked)):l.addEventListener("input",function(I){e.setValue(i,{value:S(I)})}),this._setBackgroundColor(l),this.container.appendChild(l),this.container}}class w extends m{constructor(e){var r,h;const i=!!((r=e.data.titleObj)!=null&&r.str||(h=e.data.contentsObj)!=null&&h.str);super(e,{isRenderable:i})}render(){const e=["Line","Square","Circle","PolyLine","Polygon","Ink"];if(this.container.className="popupAnnotation",e.includes(this.data.parentType))return this.container;const i=`[data-annotation-id="${this.data.parentId}"]`,r=this.layer.querySelectorAll(i);if(r.length===0)return this.container;const h=new s({container:this.container,trigger:Array.from(r),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj}),l=this.page,S=t.Util.normalizeRect([this.data.parentRect[0],l.view[3]-this.data.parentRect[1]+l.view[1],this.data.parentRect[2],l.view[3]-this.data.parentRect[3]+l.view[1]]),x=S[0]+this.data.parentRect[2]-this.data.parentRect[0],I=S[1];return this.container.style.transformOrigin=`${-x}px ${-I}px`,this.container.style.left=`${x}px`,this.container.style.top=`${I}px`,this.container.appendChild(h.render()),this.container}}class s{constructor(e){this.container=e.container,this.trigger=e.trigger,this.color=e.color,this.titleObj=e.titleObj,this.modificationDate=e.modificationDate,this.contentsObj=e.contentsObj,this.hideWrapper=e.hideWrapper||!1,this.pinned=!1}render(){const i=document.createElement("div");i.className="popupWrapper",this.hideElement=this.hideWrapper?i:this.container,this.hideElement.hidden=!0;const r=document.createElement("div");r.className="popup";const h=this.color;if(h){const I=.7*(255-h[0])+h[0],N=.7*(255-h[1])+h[1],O=.7*(255-h[2])+h[2];r.style.backgroundColor=t.Util.makeHexColor(I|0,N|0,O|0)}const l=document.createElement("h1");l.dir=this.titleObj.dir,l.textContent=this.titleObj.str,r.appendChild(l);const S=u.PDFDateString.toDateObject(this.modificationDate);if(S){const I=document.createElement("span");I.textContent="{{date}}, {{time}}",I.dataset.l10nId="annotation_date_string",I.dataset.l10nArgs=JSON.stringify({date:S.toLocaleDateString(),time:S.toLocaleTimeString()}),r.appendChild(I)}const x=this._formatContents(this.contentsObj);r.appendChild(x),Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const I of this.trigger)I.addEventListener("click",this._toggle.bind(this)),I.addEventListener("mouseover",this._show.bind(this,!1)),I.addEventListener("mouseout",this._hide.bind(this,!1));return r.addEventListener("click",this._hide.bind(this,!0)),i.appendChild(r),i}_formatContents({str:e,dir:i}){const r=document.createElement("p");r.dir=i;const h=e.split(/(?:\r\n?|\n)/);for(let l=0,S=h.length;l<S;++l){const x=h[l];r.appendChild(document.createTextNode(x)),l<S-1&&r.appendChild(document.createElement("br"))}return r}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(e=!1){e&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex+=1)}_hide(e=!0){e&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex-=1)}}class a extends m{constructor(e){var r,h;const i=!!(e.data.hasPopup||(r=e.data.titleObj)!=null&&r.str||(h=e.data.contentsObj)!=null&&h.str);super(e,{isRenderable:i,ignoreBorder:!0})}render(){return this.container.className="freeTextAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class p extends m{constructor(e){var r,h;const i=!!(e.data.hasPopup||(r=e.data.titleObj)!=null&&r.str||(h=e.data.contentsObj)!=null&&h.str);super(e,{isRenderable:i,ignoreBorder:!0})}render(){this.container.className="lineAnnotation";const e=this.data,i=e.rect[2]-e.rect[0],r=e.rect[3]-e.rect[1],h=this.svgFactory.create(i,r),l=this.svgFactory.createElement("svg:line");return l.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),l.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),l.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),l.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),l.setAttribute("stroke-width",e.borderStyle.width||1),l.setAttribute("stroke","transparent"),h.appendChild(l),this.container.append(h),this._createPopup(l,e),this.container}}class v extends m{constructor(e){var r,h;const i=!!(e.data.hasPopup||(r=e.data.titleObj)!=null&&r.str||(h=e.data.contentsObj)!=null&&h.str);super(e,{isRenderable:i,ignoreBorder:!0})}render(){this.container.className="squareAnnotation";const e=this.data,i=e.rect[2]-e.rect[0],r=e.rect[3]-e.rect[1],h=this.svgFactory.create(i,r),l=e.borderStyle.width,S=this.svgFactory.createElement("svg:rect");return S.setAttribute("x",l/2),S.setAttribute("y",l/2),S.setAttribute("width",i-l),S.setAttribute("height",r-l),S.setAttribute("stroke-width",l||1),S.setAttribute("stroke","transparent"),S.setAttribute("fill","none"),h.appendChild(S),this.container.append(h),this._createPopup(S,e),this.container}}class y extends m{constructor(e){var r,h;const i=!!(e.data.hasPopup||(r=e.data.titleObj)!=null&&r.str||(h=e.data.contentsObj)!=null&&h.str);super(e,{isRenderable:i,ignoreBorder:!0})}render(){this.container.className="circleAnnotation";const e=this.data,i=e.rect[2]-e.rect[0],r=e.rect[3]-e.rect[1],h=this.svgFactory.create(i,r),l=e.borderStyle.width,S=this.svgFactory.createElement("svg:ellipse");return S.setAttribute("cx",i/2),S.setAttribute("cy",r/2),S.setAttribute("rx",i/2-l/2),S.setAttribute("ry",r/2-l/2),S.setAttribute("stroke-width",l||1),S.setAttribute("stroke","transparent"),S.setAttribute("fill","none"),h.appendChild(S),this.container.append(h),this._createPopup(S,e),this.container}}class D extends m{constructor(e){var r,h;const i=!!(e.data.hasPopup||(r=e.data.titleObj)!=null&&r.str||(h=e.data.contentsObj)!=null&&h.str);super(e,{isRenderable:i,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const e=this.data,i=e.rect[2]-e.rect[0],r=e.rect[3]-e.rect[1],h=this.svgFactory.create(i,r);let l=[];for(const x of e.vertices){const I=x.x-e.rect[0],N=e.rect[3]-x.y;l.push(I+","+N)}l=l.join(" ");const S=this.svgFactory.createElement(this.svgElementName);return S.setAttribute("points",l),S.setAttribute("stroke-width",e.borderStyle.width||1),S.setAttribute("stroke","transparent"),S.setAttribute("fill","none"),h.appendChild(S),this.container.append(h),this._createPopup(S,e),this.container}}class L extends D{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Q extends m{constructor(e){var r,h;const i=!!(e.data.hasPopup||(r=e.data.titleObj)!=null&&r.str||(h=e.data.contentsObj)!=null&&h.str);super(e,{isRenderable:i,ignoreBorder:!0})}render(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class H extends m{constructor(e){var r,h;const i=!!(e.data.hasPopup||(r=e.data.titleObj)!=null&&r.str||(h=e.data.contentsObj)!=null&&h.str);super(e,{isRenderable:i,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const e=this.data,i=e.rect[2]-e.rect[0],r=e.rect[3]-e.rect[1],h=this.svgFactory.create(i,r);for(const l of e.inkLists){let S=[];for(const I of l){const N=I.x-e.rect[0],O=e.rect[3]-I.y;S.push(`${N},${O}`)}S=S.join(" ");const x=this.svgFactory.createElement(this.svgElementName);x.setAttribute("points",S),x.setAttribute("stroke-width",e.borderStyle.width||1),x.setAttribute("stroke","transparent"),x.setAttribute("fill","none"),this._createPopup(x,e),h.appendChild(x)}return this.container.append(h),this.container}}class T extends m{constructor(e){var r,h;const i=!!(e.data.hasPopup||(r=e.data.titleObj)!=null&&r.str||(h=e.data.contentsObj)!=null&&h.str);super(e,{isRenderable:i,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.className="highlightAnnotation",this.container)}}class M extends m{constructor(e){var r,h;const i=!!(e.data.hasPopup||(r=e.data.titleObj)!=null&&r.str||(h=e.data.contentsObj)!=null&&h.str);super(e,{isRenderable:i,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.className="underlineAnnotation",this.container)}}class q extends m{constructor(e){var r,h;const i=!!(e.data.hasPopup||(r=e.data.titleObj)!=null&&r.str||(h=e.data.contentsObj)!=null&&h.str);super(e,{isRenderable:i,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.className="squigglyAnnotation",this.container)}}class G extends m{constructor(e){var r,h;const i=!!(e.data.hasPopup||(r=e.data.titleObj)!=null&&r.str||(h=e.data.contentsObj)!=null&&h.str);super(e,{isRenderable:i,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.className="strikeoutAnnotation",this.container)}}class B extends m{constructor(e){var r,h;const i=!!(e.data.hasPopup||(r=e.data.titleObj)!=null&&r.str||(h=e.data.contentsObj)!=null&&h.str);super(e,{isRenderable:i,ignoreBorder:!0})}render(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class J extends m{constructor(e){var h;super(e,{isRenderable:!0});const{filename:i,content:r}=this.data.file;this.filename=(0,u.getFilenameFromUrl)(i),this.content=r,(h=this.linkService.eventBus)==null||h.dispatch("fileattachmentannotation",{source:this,id:(0,t.stringToPDFString)(i),filename:i,content:r})}render(){var i,r;this.container.className="fileAttachmentAnnotation";const e=document.createElement("div");return e.style.height=this.container.style.height,e.style.width=this.container.style.width,e.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&((i=this.data.titleObj)!=null&&i.str||(r=this.data.contentsObj)!=null&&r.str)&&this._createPopup(e,this.data),this.container.appendChild(e),this.container}_download(){var e;(e=this.downloadManager)==null||e.openOrDownloadData(this.container,this.content,this.filename)}}class F{static render(e){const i=[],r=[];for(const h of e.annotations)if(h){if(h.annotationType===t.AnnotationType.POPUP){r.push(h);continue}i.push(h)}r.length&&i.push(...r);for(const h of i){const l=f.create({data:h,layer:e.div,page:e.page,viewport:e.viewport,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new u.DOMSVGFactory,annotationStorage:e.annotationStorage||new g.AnnotationStorage,enableScripting:e.enableScripting,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,mouseState:e.mouseState||{isDown:!1}});if(l.isRenderable){const S=l.render();if(h.hidden&&(S.style.visibility="hidden"),Array.isArray(S))for(const x of S)e.div.appendChild(x);else l instanceof w?e.div.prepend(S):e.div.appendChild(S)}}}static update(e){const i=`matrix(${e.viewport.transform.join(",")})`;for(const r of e.annotations){const h=e.div.querySelectorAll(`[data-annotation-id="${r.id}"]`);if(h)for(const l of h)l.style.transform=i}e.div.hidden=!1}}n.AnnotationLayer=F},(Y,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ColorConverters=void 0;function o(u){return Math.floor(Math.max(0,Math.min(1,u))*255).toString(16).padStart(2,"0")}class t{static CMYK_G([g,C,_,b]){return["G",1-Math.min(1,.3*g+.59*_+.11*C+b)]}static G_CMYK([g]){return["CMYK",0,0,0,1-g]}static G_RGB([g]){return["RGB",g,g,g]}static G_HTML([g]){const C=o(g);return`#${C}${C}${C}`}static RGB_G([g,C,_]){return["G",.3*g+.59*C+.11*_]}static RGB_HTML([g,C,_]){const b=o(g),f=o(C),m=o(_);return`#${b}${f}${m}`}static T_HTML(){return"#00000000"}static CMYK_RGB([g,C,_,b]){return["RGB",1-Math.min(1,g+b),1-Math.min(1,_+b),1-Math.min(1,C+b)]}static CMYK_HTML(g){return this.RGB_HTML(this.CMYK_RGB(g))}static RGB_CMYK([g,C,_]){const b=1-g,f=1-C,m=1-_,P=Math.min(b,f,m);return["CMYK",b,f,m,P]}}n.ColorConverters=t},(Y,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.renderTextLayer=W;var t=o(2);const u=1e5,g=30,C=.8,_=new Map,b=/^\s+$/g;function f(U,w){const s=_.get(U);if(s)return s;w.save(),w.font=`${g}px ${U}`;const a=w.measureText("");let p=a.fontBoundingBoxAscent,v=Math.abs(a.fontBoundingBoxDescent);if(p){w.restore();const D=p/(p+v);return _.set(U,D),D}w.strokeStyle="red",w.clearRect(0,0,g,g),w.strokeText("g",0,0);let y=w.getImageData(0,0,g,g).data;v=0;for(let D=y.length-1-3;D>=0;D-=4)if(y[D]>0){v=Math.ceil(D/4/g);break}w.clearRect(0,0,g,g),w.strokeText("A",0,g),y=w.getImageData(0,0,g,g).data,p=0;for(let D=0,L=y.length;D<L;D+=4)if(y[D]>0){p=g-Math.floor(D/4/g);break}if(w.restore(),p){const D=p/(p+v);return _.set(U,D),D}return _.set(U,C),C}function m(U,w,s,a){const p=document.createElement("span"),v=U._enhanceTextSelection?{angle:0,canvasWidth:0,hasText:w.str!=="",hasEOL:w.hasEOL,originalTransform:null,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,scale:1}:{angle:0,canvasWidth:0,hasText:w.str!=="",hasEOL:w.hasEOL};U._textDivs.push(p);const y=t.Util.transform(U._viewport.transform,w.transform);let D=Math.atan2(y[1],y[0]);const L=s[w.fontName];L.vertical&&(D+=Math.PI/2);const Q=Math.hypot(y[2],y[3]),H=Q*f(L.fontFamily,a);let T,M;D===0?(T=y[4],M=y[5]-H):(T=y[4]+H*Math.sin(D),M=y[5]-H*Math.cos(D)),p.style.left=`${T}px`,p.style.top=`${M}px`,p.style.fontSize=`${Q}px`,p.style.fontFamily=L.fontFamily,p.setAttribute("role","presentation"),p.textContent=w.str,p.dir=w.dir,U._fontInspectorEnabled&&(p.dataset.fontName=w.fontName),D!==0&&(v.angle=D*(180/Math.PI));let q=!1;if(w.str.length>1||U._enhanceTextSelection&&b.test(w.str))q=!0;else if(w.transform[0]!==w.transform[3]){const G=Math.abs(w.transform[0]),B=Math.abs(w.transform[3]);G!==B&&Math.max(G,B)/Math.min(G,B)>1.5&&(q=!0)}if(q&&(L.vertical?v.canvasWidth=w.height*U._viewport.scale:v.canvasWidth=w.width*U._viewport.scale),U._textDivProperties.set(p,v),U._textContentStream&&U._layoutText(p),U._enhanceTextSelection&&v.hasText){let G=1,B=0;D!==0&&(G=Math.cos(D),B=Math.sin(D));const J=(L.vertical?w.height:w.width)*U._viewport.scale,F=Q;let c,e;D!==0?(c=[G,B,-B,G,T,M],e=t.Util.getAxialAlignedBoundingBox([0,0,J,F],c)):e=[T,M,T+J,M+F],U._bounds.push({left:e[0],top:e[1],right:e[2],bottom:e[3],div:p,size:[J,F],m:c})}}function P(U){if(U._canceled)return;const w=U._textDivs,s=U._capability,a=w.length;if(a>u){U._renderingDone=!0,s.resolve();return}if(!U._textContentStream)for(let p=0;p<a;p++)U._layoutText(w[p]);U._renderingDone=!0,s.resolve()}function E(U,w,s){let a=0;for(let p=0;p<s;p++){const v=U[w++];v>0&&(a=a?Math.min(v,a):v)}return a}function A(U){const w=U._bounds,s=U._viewport,a=R(s.width,s.height,w);for(let p=0;p<a.length;p++){const v=w[p].div,y=U._textDivProperties.get(v);if(y.angle===0){y.paddingLeft=w[p].left-a[p].left,y.paddingTop=w[p].top-a[p].top,y.paddingRight=a[p].right-w[p].right,y.paddingBottom=a[p].bottom-w[p].bottom,U._textDivProperties.set(v,y);continue}const D=a[p],L=w[p],Q=L.m,H=Q[0],T=Q[1],M=[[0,0],[0,L.size[1]],[L.size[0],0],L.size],q=new Float64Array(64);for(let B=0,J=M.length;B<J;B++){const F=t.Util.applyTransform(M[B],Q);q[B+0]=H&&(D.left-F[0])/H,q[B+4]=T&&(D.top-F[1])/T,q[B+8]=H&&(D.right-F[0])/H,q[B+12]=T&&(D.bottom-F[1])/T,q[B+16]=T&&(D.left-F[0])/-T,q[B+20]=H&&(D.top-F[1])/H,q[B+24]=T&&(D.right-F[0])/-T,q[B+28]=H&&(D.bottom-F[1])/H,q[B+32]=H&&(D.left-F[0])/-H,q[B+36]=T&&(D.top-F[1])/-T,q[B+40]=H&&(D.right-F[0])/-H,q[B+44]=T&&(D.bottom-F[1])/-T,q[B+48]=T&&(D.left-F[0])/T,q[B+52]=H&&(D.top-F[1])/-H,q[B+56]=T&&(D.right-F[0])/T,q[B+60]=H&&(D.bottom-F[1])/-H}const G=1+Math.min(Math.abs(H),Math.abs(T));y.paddingLeft=E(q,32,16)/G,y.paddingTop=E(q,48,16)/G,y.paddingRight=E(q,0,16)/G,y.paddingBottom=E(q,16,16)/G,U._textDivProperties.set(v,y)}}function R(U,w,s){const a=s.map(function(v,y){return{x1:v.left,y1:v.top,x2:v.right,y2:v.bottom,index:y,x1New:void 0,x2New:void 0}});d(U,a);const p=new Array(s.length);for(const v of a){const y=v.index;p[y]={left:v.x1New,top:0,right:v.x2New,bottom:0}}s.map(function(v,y){const D=p[y],L=a[y];L.x1=v.top,L.y1=U-D.right,L.x2=v.bottom,L.y2=U-D.left,L.index=y,L.x1New=void 0,L.x2New=void 0}),d(w,a);for(const v of a){const y=v.index;p[y].top=v.x1New,p[y].bottom=v.x2New}return p}function d(U,w){w.sort(function(p,v){return p.x1-v.x1||p.index-v.index});const a=[{start:-1/0,end:1/0,boundary:{x1:-1/0,y1:-1/0,x2:0,y2:1/0,index:-1,x1New:0,x2New:0}}];for(const p of w){let v=0;for(;v<a.length&&a[v].end<=p.y1;)v++;let y=a.length-1;for(;y>=0&&a[y].start>=p.y2;)y--;let D,L,Q,H,T=-1/0;for(Q=v;Q<=y;Q++){D=a[Q],L=D.boundary;let G;L.x2>p.x1?G=L.index>p.index?L.x1New:p.x1:L.x2New===void 0?G=(L.x2+p.x1)/2:G=L.x2New,G>T&&(T=G)}for(p.x1New=T,Q=v;Q<=y;Q++)D=a[Q],L=D.boundary,L.x2New===void 0?L.x2>p.x1?L.index>p.index&&(L.x2New=L.x2):L.x2New=T:L.x2New>T&&(L.x2New=Math.max(T,L.x2));const M=[];let q=null;for(Q=v;Q<=y;Q++){D=a[Q],L=D.boundary;const G=L.x2>p.x2?L:p;q===G?M[M.length-1].end=D.end:(M.push({start:D.start,end:D.end,boundary:G}),q=G)}for(a[v].start<p.y1&&(M[0].start=p.y1,M.unshift({start:a[v].start,end:p.y1,boundary:a[v].boundary})),p.y2<a[y].end&&(M[M.length-1].end=p.y2,M.push({start:p.y2,end:a[y].end,boundary:a[y].boundary})),Q=v;Q<=y;Q++){if(D=a[Q],L=D.boundary,L.x2New!==void 0)continue;let G=!1;for(H=v-1;!G&&H>=0&&a[H].start>=L.y1;H--)G=a[H].boundary===L;for(H=y+1;!G&&H<a.length&&a[H].end<=L.y2;H++)G=a[H].boundary===L;for(H=0;!G&&H<M.length;H++)G=M[H].boundary===L;G||(L.x2New=T)}Array.prototype.splice.apply(a,[v,y-v+1].concat(M))}for(const p of a){const v=p.boundary;v.x2New===void 0&&(v.x2New=Math.max(U,v.x2))}}class k{constructor({textContent:w,textContentStream:s,container:a,viewport:p,textDivs:v,textContentItemsStr:y,enhanceTextSelection:D}){var L;this._textContent=w,this._textContentStream=s,this._container=a,this._document=a.ownerDocument,this._viewport=p,this._textDivs=v||[],this._textContentItemsStr=y||[],this._enhanceTextSelection=!!D,this._fontInspectorEnabled=!!((L=globalThis.FontInspector)!=null&&L.enabled),this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,t.createPromiseCapability)(),this._renderTimer=null,this._bounds=[],this._capability.promise.finally(()=>{this._enhanceTextSelection||(this._textDivProperties=null),this._layoutTextCtx&&(this._layoutTextCtx.canvas.width=0,this._layoutTextCtx.canvas.height=0,this._layoutTextCtx=null)}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new t.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._renderTimer!==null&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject(new Error("TextLayer task cancelled."))}_processItems(w,s){for(let a=0,p=w.length;a<p;a++){if(w[a].str===void 0){if(w[a].type==="beginMarkedContentProps"||w[a].type==="beginMarkedContent"){const v=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),w[a].id!==null&&this._container.setAttribute("id",`${w[a].id}`),v.appendChild(this._container)}else w[a].type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(w[a].str),m(this,w[a],s,this._layoutTextCtx)}}_layoutText(w){const s=this._textDivProperties.get(w);let a="";if(s.canvasWidth!==0&&s.hasText){const{fontSize:p,fontFamily:v}=w.style;(p!==this._layoutTextLastFontSize||v!==this._layoutTextLastFontFamily)&&(this._layoutTextCtx.font=`${p} ${v}`,this._layoutTextLastFontSize=p,this._layoutTextLastFontFamily=v);const{width:y}=this._layoutTextCtx.measureText(w.textContent);if(y>0){const D=s.canvasWidth/y;this._enhanceTextSelection&&(s.scale=D),a=`scaleX(${D})`}}if(s.angle!==0&&(a=`rotate(${s.angle}deg) ${a}`),a.length>0&&(this._enhanceTextSelection&&(s.originalTransform=a),w.style.transform=a),s.hasText&&this._container.appendChild(w),s.hasEOL){const p=document.createElement("br");p.setAttribute("role","presentation"),this._container.appendChild(p)}}_render(w=0){const s=(0,t.createPromiseCapability)();let a=Object.create(null);const p=this._document.createElement("canvas");if(p.height=p.width=g,p.mozOpaque=!0,this._layoutTextCtx=p.getContext("2d",{alpha:!1}),this._textContent){const v=this._textContent.items,y=this._textContent.styles;this._processItems(v,y),s.resolve()}else if(this._textContentStream){const v=()=>{this._reader.read().then(({value:y,done:D})=>{if(D){s.resolve();return}Object.assign(a,y.styles),this._processItems(y.items,a),v()},s.reject)};this._reader=this._textContentStream.getReader(),v()}else throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');s.promise.then(()=>{a=null,w?this._renderTimer=setTimeout(()=>{P(this),this._renderTimer=null},w):P(this)},this._capability.reject)}expandTextDivs(w=!1){if(!this._enhanceTextSelection||!this._renderingDone)return;this._bounds!==null&&(A(this),this._bounds=null);const s=[],a=[];for(let p=0,v=this._textDivs.length;p<v;p++){const y=this._textDivs[p],D=this._textDivProperties.get(y);D.hasText&&(w?(s.length=0,a.length=0,D.originalTransform&&s.push(D.originalTransform),D.paddingTop>0?(a.push(`${D.paddingTop}px`),s.push(`translateY(${-D.paddingTop}px)`)):a.push(0),D.paddingRight>0?a.push(`${D.paddingRight/D.scale}px`):a.push(0),D.paddingBottom>0?a.push(`${D.paddingBottom}px`):a.push(0),D.paddingLeft>0?(a.push(`${D.paddingLeft/D.scale}px`),s.push(`translateX(${-D.paddingLeft/D.scale}px)`)):a.push(0),y.style.padding=a.join(" "),s.length&&(y.style.transform=s.join(" "))):(y.style.padding=null,y.style.transform=D.originalTransform))}}}function W(U){const w=new k({textContent:U.textContent,textContentStream:U.textContentStream,container:U.container,viewport:U.viewport,textDivs:U.textDivs,textContentItemsStr:U.textContentItemsStr,enhanceTextSelection:U.enhanceTextSelection});return w._render(U.timeout),w}},(Y,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.SVGGraphics=void 0;var t=o(2),u=o(1),g=o(4);let C=class{constructor(){(0,t.unreachable)("Not implemented: SVGGraphics")}};n.SVGGraphics=C;{let R=function(s){let a=[];const p=[];for(const v of s){if(v.fn==="save"){a.push({fnId:92,fn:"group",items:[]}),p.push(a),a=a[a.length-1].items;continue}v.fn==="restore"?a=p.pop():a.push(v)}return a},d=function(s){if(Number.isInteger(s))return s.toString();const a=s.toFixed(10);let p=a.length-1;if(a[p]!=="0")return a;do p--;while(a[p]==="0");return a.substring(0,a[p]==="."?p:p+1)},k=function(s){if(s[4]===0&&s[5]===0){if(s[1]===0&&s[2]===0)return s[0]===1&&s[3]===1?"":`scale(${d(s[0])} ${d(s[3])})`;if(s[0]===s[3]&&s[1]===-s[2]){const a=Math.acos(s[0])*180/Math.PI;return`rotate(${d(a)})`}}else if(s[0]===1&&s[1]===0&&s[2]===0&&s[3]===1)return`translate(${d(s[4])} ${d(s[5])})`;return`matrix(${d(s[0])} ${d(s[1])} ${d(s[2])} ${d(s[3])} ${d(s[4])} ${d(s[5])})`};const _={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},b="http://www.w3.org/XML/1998/namespace",f="http://www.w3.org/1999/xlink",m=["butt","round","square"],P=["miter","round","bevel"],E=function(){const s=new Uint8Array([137,80,78,71,13,10,26,10]),a=12,p=new Int32Array(256);for(let T=0;T<256;T++){let M=T;for(let q=0;q<8;q++)M&1?M=3988292384^M>>1&2147483647:M=M>>1&2147483647;p[T]=M}function v(T,M,q){let G=-1;for(let B=M;B<q;B++){const J=(G^T[B])&255,F=p[J];G=G>>>8^F}return G^-1}function y(T,M,q,G){let B=G;const J=M.length;q[B]=J>>24&255,q[B+1]=J>>16&255,q[B+2]=J>>8&255,q[B+3]=J&255,B+=4,q[B]=T.charCodeAt(0)&255,q[B+1]=T.charCodeAt(1)&255,q[B+2]=T.charCodeAt(2)&255,q[B+3]=T.charCodeAt(3)&255,B+=4,q.set(M,B),B+=M.length;const F=v(q,G+4,B);q[B]=F>>24&255,q[B+1]=F>>16&255,q[B+2]=F>>8&255,q[B+3]=F&255}function D(T,M,q){let G=1,B=0;for(let J=M;J<q;++J)G=(G+(T[J]&255))%65521,B=(B+G)%65521;return B<<16|G}function L(T){if(!g.isNodeJS)return Q(T);try{let M;parseInt(process.versions.node)>=8?M=T:M=Buffer.from(T);const q=require$$5.deflateSync(M,{level:9});return q instanceof Uint8Array?q:new Uint8Array(q)}catch(M){(0,t.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+M)}return Q(T)}function Q(T){let M=T.length;const q=65535,G=Math.ceil(M/q),B=new Uint8Array(2+M+G*5+4);let J=0;B[J++]=120,B[J++]=156;let F=0;for(;M>q;)B[J++]=0,B[J++]=255,B[J++]=255,B[J++]=0,B[J++]=0,B.set(T.subarray(F,F+q),J),J+=q,F+=q,M-=q;B[J++]=1,B[J++]=M&255,B[J++]=M>>8&255,B[J++]=~M&65535&255,B[J++]=(~M&65535)>>8&255,B.set(T.subarray(F),J),J+=T.length-F;const c=D(T,0,T.length);return B[J++]=c>>24&255,B[J++]=c>>16&255,B[J++]=c>>8&255,B[J++]=c&255,B}function H(T,M,q,G){const B=T.width,J=T.height;let F,c,e;const i=T.data;switch(M){case t.ImageKind.GRAYSCALE_1BPP:c=0,F=1,e=B+7>>3;break;case t.ImageKind.RGB_24BPP:c=2,F=8,e=B*3;break;case t.ImageKind.RGBA_32BPP:c=6,F=8,e=B*4;break;default:throw new Error("invalid format")}const r=new Uint8Array((1+e)*J);let h=0,l=0;for(let $=0;$<J;++$)r[h++]=0,r.set(i.subarray(l,l+e),h),l+=e,h+=e;if(M===t.ImageKind.GRAYSCALE_1BPP&&G){h=0;for(let $=0;$<J;$++){h++;for(let z=0;z<e;z++)r[h++]^=255}}const S=new Uint8Array([B>>24&255,B>>16&255,B>>8&255,B&255,J>>24&255,J>>16&255,J>>8&255,J&255,F,c,0,0,0]),x=L(r),I=s.length+a*3+S.length+x.length,N=new Uint8Array(I);let O=0;return N.set(s,O),O+=s.length,y("IHDR",S,N,O),O+=a+S.length,y("IDATA",x,N,O),O+=a+x.length,y("IEND",new Uint8Array(0),N,O),(0,t.createObjectURL)(N,"image/png",q)}return function(M,q,G){const B=M.kind===void 0?t.ImageKind.GRAYSCALE_1BPP:M.kind;return H(M,B,q,G)}}();class A{constructor(){this.fontSizeScale=1,this.fontWeight=_.fontWeight,this.fontSize=0,this.textMatrix=t.IDENTITY_MATRIX,this.fontMatrix=t.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=t.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=_.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(a,p){this.x=a,this.y=p}}let W=0,U=0,w=0;n.SVGGraphics=C=class{constructor(s,a,p=!1){this.svgFactory=new u.DOMSVGFactory,this.current=new A,this.transformMatrix=t.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=s,this.objs=a,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!p,this._operatorIdMapping=[];for(const v in t.OPS)this._operatorIdMapping[t.OPS[v]]=v}save(){this.transformStack.push(this.transformMatrix);const s=this.current;this.extraStack.push(s),this.current=s.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(s){this.save(),this.executeOpTree(s),this.restore()}loadDependencies(s){const a=s.fnArray,p=s.argsArray;for(let v=0,y=a.length;v<y;v++)if(a[v]===t.OPS.dependency)for(const D of p[v]){const L=D.startsWith("g_")?this.commonObjs:this.objs,Q=new Promise(H=>{L.get(D,H)});this.current.dependencies.push(Q)}return Promise.all(this.current.dependencies)}transform(s,a,p,v,y,D){const L=[s,a,p,v,y,D];this.transformMatrix=t.Util.transform(this.transformMatrix,L),this.tgrp=null}getSVG(s,a){this.viewport=a;const p=this._initialize(a);return this.loadDependencies(s).then(()=>(this.transformMatrix=t.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(s)),p))}convertOpList(s){const a=this._operatorIdMapping,p=s.argsArray,v=s.fnArray,y=[];for(let D=0,L=v.length;D<L;D++){const Q=v[D];y.push({fnId:Q,fn:a[Q],args:p[D]})}return R(y)}executeOpTree(s){for(const a of s){const p=a.fn,v=a.fnId,y=a.args;switch(v|0){case t.OPS.beginText:this.beginText();break;case t.OPS.dependency:break;case t.OPS.setLeading:this.setLeading(y);break;case t.OPS.setLeadingMoveText:this.setLeadingMoveText(y[0],y[1]);break;case t.OPS.setFont:this.setFont(y);break;case t.OPS.showText:this.showText(y[0]);break;case t.OPS.showSpacedText:this.showText(y[0]);break;case t.OPS.endText:this.endText();break;case t.OPS.moveText:this.moveText(y[0],y[1]);break;case t.OPS.setCharSpacing:this.setCharSpacing(y[0]);break;case t.OPS.setWordSpacing:this.setWordSpacing(y[0]);break;case t.OPS.setHScale:this.setHScale(y[0]);break;case t.OPS.setTextMatrix:this.setTextMatrix(y[0],y[1],y[2],y[3],y[4],y[5]);break;case t.OPS.setTextRise:this.setTextRise(y[0]);break;case t.OPS.setTextRenderingMode:this.setTextRenderingMode(y[0]);break;case t.OPS.setLineWidth:this.setLineWidth(y[0]);break;case t.OPS.setLineJoin:this.setLineJoin(y[0]);break;case t.OPS.setLineCap:this.setLineCap(y[0]);break;case t.OPS.setMiterLimit:this.setMiterLimit(y[0]);break;case t.OPS.setFillRGBColor:this.setFillRGBColor(y[0],y[1],y[2]);break;case t.OPS.setStrokeRGBColor:this.setStrokeRGBColor(y[0],y[1],y[2]);break;case t.OPS.setStrokeColorN:this.setStrokeColorN(y);break;case t.OPS.setFillColorN:this.setFillColorN(y);break;case t.OPS.shadingFill:this.shadingFill(y[0]);break;case t.OPS.setDash:this.setDash(y[0],y[1]);break;case t.OPS.setRenderingIntent:this.setRenderingIntent(y[0]);break;case t.OPS.setFlatness:this.setFlatness(y[0]);break;case t.OPS.setGState:this.setGState(y[0]);break;case t.OPS.fill:this.fill();break;case t.OPS.eoFill:this.eoFill();break;case t.OPS.stroke:this.stroke();break;case t.OPS.fillStroke:this.fillStroke();break;case t.OPS.eoFillStroke:this.eoFillStroke();break;case t.OPS.clip:this.clip("nonzero");break;case t.OPS.eoClip:this.clip("evenodd");break;case t.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case t.OPS.paintImageXObject:this.paintImageXObject(y[0]);break;case t.OPS.paintInlineImageXObject:this.paintInlineImageXObject(y[0]);break;case t.OPS.paintImageMaskXObject:this.paintImageMaskXObject(y[0]);break;case t.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(y[0],y[1]);break;case t.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case t.OPS.closePath:this.closePath();break;case t.OPS.closeStroke:this.closeStroke();break;case t.OPS.closeFillStroke:this.closeFillStroke();break;case t.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case t.OPS.nextLine:this.nextLine();break;case t.OPS.transform:this.transform(y[0],y[1],y[2],y[3],y[4],y[5]);break;case t.OPS.constructPath:this.constructPath(y[0],y[1]);break;case t.OPS.endPath:this.endPath();break;case 92:this.group(a.items);break;default:(0,t.warn)(`Unimplemented operator ${p}`);break}}}setWordSpacing(s){this.current.wordSpacing=s}setCharSpacing(s){this.current.charSpacing=s}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(s,a,p,v,y,D){const L=this.current;L.textMatrix=L.lineMatrix=[s,a,p,v,y,D],L.textMatrixScale=Math.hypot(s,a),L.x=L.lineX=0,L.y=L.lineY=0,L.xcoords=[],L.ycoords=[],L.tspan=this.svgFactory.createElement("svg:tspan"),L.tspan.setAttributeNS(null,"font-family",L.fontFamily),L.tspan.setAttributeNS(null,"font-size",`${d(L.fontSize)}px`),L.tspan.setAttributeNS(null,"y",d(-L.y)),L.txtElement=this.svgFactory.createElement("svg:text"),L.txtElement.appendChild(L.tspan)}beginText(){const s=this.current;s.x=s.lineX=0,s.y=s.lineY=0,s.textMatrix=t.IDENTITY_MATRIX,s.lineMatrix=t.IDENTITY_MATRIX,s.textMatrixScale=1,s.tspan=this.svgFactory.createElement("svg:tspan"),s.txtElement=this.svgFactory.createElement("svg:text"),s.txtgrp=this.svgFactory.createElement("svg:g"),s.xcoords=[],s.ycoords=[]}moveText(s,a){const p=this.current;p.x=p.lineX+=s,p.y=p.lineY+=a,p.xcoords=[],p.ycoords=[],p.tspan=this.svgFactory.createElement("svg:tspan"),p.tspan.setAttributeNS(null,"font-family",p.fontFamily),p.tspan.setAttributeNS(null,"font-size",`${d(p.fontSize)}px`),p.tspan.setAttributeNS(null,"y",d(-p.y))}showText(s){const a=this.current,p=a.font,v=a.fontSize;if(v===0)return;const y=a.fontSizeScale,D=a.charSpacing,L=a.wordSpacing,Q=a.fontDirection,H=a.textHScale*Q,T=p.vertical,M=T?1:-1,q=p.defaultVMetrics,G=v*a.fontMatrix[0];let B=0;for(const c of s){if(c===null){B+=Q*L;continue}else if((0,t.isNum)(c)){B+=M*c*v/1e3;continue}const e=(c.isSpace?L:0)+D,i=c.fontChar;let r,h,l=c.width;if(T){let x;const I=c.vmetric||q;x=c.vmetric?I[1]:l*.5,x=-x*G;const N=I[2]*G;l=I?-I[0]:l,r=x/y,h=(B+N)/y}else r=B/y,h=0;(c.isInFont||p.missingFile)&&(a.xcoords.push(a.x+r),T&&a.ycoords.push(-a.y+h),a.tspan.textContent+=i);let S;T?S=l*G-e*Q:S=l*G+e*Q,B+=S}a.tspan.setAttributeNS(null,"x",a.xcoords.map(d).join(" ")),T?a.tspan.setAttributeNS(null,"y",a.ycoords.map(d).join(" ")):a.tspan.setAttributeNS(null,"y",d(-a.y)),T?a.y-=B:a.x+=B*H,a.tspan.setAttributeNS(null,"font-family",a.fontFamily),a.tspan.setAttributeNS(null,"font-size",`${d(a.fontSize)}px`),a.fontStyle!==_.fontStyle&&a.tspan.setAttributeNS(null,"font-style",a.fontStyle),a.fontWeight!==_.fontWeight&&a.tspan.setAttributeNS(null,"font-weight",a.fontWeight);const J=a.textRenderingMode&t.TextRenderingMode.FILL_STROKE_MASK;if(J===t.TextRenderingMode.FILL||J===t.TextRenderingMode.FILL_STROKE?(a.fillColor!==_.fillColor&&a.tspan.setAttributeNS(null,"fill",a.fillColor),a.fillAlpha<1&&a.tspan.setAttributeNS(null,"fill-opacity",a.fillAlpha)):a.textRenderingMode===t.TextRenderingMode.ADD_TO_PATH?a.tspan.setAttributeNS(null,"fill","transparent"):a.tspan.setAttributeNS(null,"fill","none"),J===t.TextRenderingMode.STROKE||J===t.TextRenderingMode.FILL_STROKE){const c=1/(a.textMatrixScale||1);this._setStrokeAttributes(a.tspan,c)}let F=a.textMatrix;a.textRise!==0&&(F=F.slice(),F[5]+=a.textRise),a.txtElement.setAttributeNS(null,"transform",`${k(F)} scale(${d(H)}, -1)`),a.txtElement.setAttributeNS(b,"xml:space","preserve"),a.txtElement.appendChild(a.tspan),a.txtgrp.appendChild(a.txtElement),this._ensureTransformGroup().appendChild(a.txtElement)}setLeadingMoveText(s,a){this.setLeading(-a),this.moveText(s,a)}addFontStyle(s){if(!s.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.appendChild(this.cssStyle));const a=(0,t.createObjectURL)(s.data,s.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${s.loadedName}"; src: url(${a}); }
`}setFont(s){const a=this.current,p=this.commonObjs.get(s[0]);let v=s[1];a.font=p,this.embedFonts&&!p.missingFile&&!this.embeddedFonts[p.loadedName]&&(this.addFontStyle(p),this.embeddedFonts[p.loadedName]=p),a.fontMatrix=p.fontMatrix||t.FONT_IDENTITY_MATRIX;let y="normal";p.black?y="900":p.bold&&(y="bold");const D=p.italic?"italic":"normal";v<0?(v=-v,a.fontDirection=-1):a.fontDirection=1,a.fontSize=v,a.fontFamily=p.loadedName,a.fontWeight=y,a.fontStyle=D,a.tspan=this.svgFactory.createElement("svg:tspan"),a.tspan.setAttributeNS(null,"y",d(-a.y)),a.xcoords=[],a.ycoords=[]}endText(){var a;const s=this.current;s.textRenderingMode&t.TextRenderingMode.ADD_TO_PATH_FLAG&&((a=s.txtElement)!=null&&a.hasChildNodes())&&(s.element=s.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(s){s>0&&(this.current.lineWidth=s)}setLineCap(s){this.current.lineCap=m[s]}setLineJoin(s){this.current.lineJoin=P[s]}setMiterLimit(s){this.current.miterLimit=s}setStrokeAlpha(s){this.current.strokeAlpha=s}setStrokeRGBColor(s,a,p){this.current.strokeColor=t.Util.makeHexColor(s,a,p)}setFillAlpha(s){this.current.fillAlpha=s}setFillRGBColor(s,a,p){this.current.fillColor=t.Util.makeHexColor(s,a,p),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(s){this.current.strokeColor=this._makeColorN_Pattern(s)}setFillColorN(s){this.current.fillColor=this._makeColorN_Pattern(s)}shadingFill(s){const a=this.viewport.width,p=this.viewport.height,v=t.Util.inverseTransform(this.transformMatrix),y=t.Util.applyTransform([0,0],v),D=t.Util.applyTransform([0,p],v),L=t.Util.applyTransform([a,0],v),Q=t.Util.applyTransform([a,p],v),H=Math.min(y[0],D[0],L[0],Q[0]),T=Math.min(y[1],D[1],L[1],Q[1]),M=Math.max(y[0],D[0],L[0],Q[0]),q=Math.max(y[1],D[1],L[1],Q[1]),G=this.svgFactory.createElement("svg:rect");G.setAttributeNS(null,"x",H),G.setAttributeNS(null,"y",T),G.setAttributeNS(null,"width",M-H),G.setAttributeNS(null,"height",q-T),G.setAttributeNS(null,"fill",this._makeShadingPattern(s)),this.current.fillAlpha<1&&G.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().appendChild(G)}_makeColorN_Pattern(s){return s[0]==="TilingPattern"?this._makeTilingPattern(s):this._makeShadingPattern(s)}_makeTilingPattern(s){const a=s[1],p=s[2],v=s[3]||t.IDENTITY_MATRIX,[y,D,L,Q]=s[4],H=s[5],T=s[6],M=s[7],q=`shading${w++}`,[G,B,J,F]=t.Util.normalizeRect([...t.Util.applyTransform([y,D],v),...t.Util.applyTransform([L,Q],v)]),[c,e]=t.Util.singularValueDecompose2dScale(v),i=H*c,r=T*e,h=this.svgFactory.createElement("svg:pattern");h.setAttributeNS(null,"id",q),h.setAttributeNS(null,"patternUnits","userSpaceOnUse"),h.setAttributeNS(null,"width",i),h.setAttributeNS(null,"height",r),h.setAttributeNS(null,"x",`${G}`),h.setAttributeNS(null,"y",`${B}`);const l=this.svg,S=this.transformMatrix,x=this.current.fillColor,I=this.current.strokeColor,N=this.svgFactory.create(J-G,F-B);if(this.svg=N,this.transformMatrix=v,M===2){const O=t.Util.makeHexColor(...a);this.current.fillColor=O,this.current.strokeColor=O}return this.executeOpTree(this.convertOpList(p)),this.svg=l,this.transformMatrix=S,this.current.fillColor=x,this.current.strokeColor=I,h.appendChild(N.childNodes[0]),this.defs.appendChild(h),`url(#${q})`}_makeShadingPattern(s){switch(s[0]){case"RadialAxial":const a=`shading${w++}`,p=s[3];let v;switch(s[1]){case"axial":const y=s[4],D=s[5];v=this.svgFactory.createElement("svg:linearGradient"),v.setAttributeNS(null,"id",a),v.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),v.setAttributeNS(null,"x1",y[0]),v.setAttributeNS(null,"y1",y[1]),v.setAttributeNS(null,"x2",D[0]),v.setAttributeNS(null,"y2",D[1]);break;case"radial":const L=s[4],Q=s[5],H=s[6],T=s[7];v=this.svgFactory.createElement("svg:radialGradient"),v.setAttributeNS(null,"id",a),v.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),v.setAttributeNS(null,"cx",Q[0]),v.setAttributeNS(null,"cy",Q[1]),v.setAttributeNS(null,"r",T),v.setAttributeNS(null,"fx",L[0]),v.setAttributeNS(null,"fy",L[1]),v.setAttributeNS(null,"fr",H);break;default:throw new Error(`Unknown RadialAxial type: ${s[1]}`)}for(const y of p){const D=this.svgFactory.createElement("svg:stop");D.setAttributeNS(null,"offset",y[0]),D.setAttributeNS(null,"stop-color",y[1]),v.appendChild(D)}return this.defs.appendChild(v),`url(#${a})`;case"Mesh":return(0,t.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${s[0]}`)}}setDash(s,a){this.current.dashArray=s,this.current.dashPhase=a}constructPath(s,a){const p=this.current;let v=p.x,y=p.y,D=[],L=0;for(const Q of s)switch(Q|0){case t.OPS.rectangle:v=a[L++],y=a[L++];const H=a[L++],T=a[L++],M=v+H,q=y+T;D.push("M",d(v),d(y),"L",d(M),d(y),"L",d(M),d(q),"L",d(v),d(q),"Z");break;case t.OPS.moveTo:v=a[L++],y=a[L++],D.push("M",d(v),d(y));break;case t.OPS.lineTo:v=a[L++],y=a[L++],D.push("L",d(v),d(y));break;case t.OPS.curveTo:v=a[L+4],y=a[L+5],D.push("C",d(a[L]),d(a[L+1]),d(a[L+2]),d(a[L+3]),d(v),d(y)),L+=6;break;case t.OPS.curveTo2:D.push("C",d(v),d(y),d(a[L]),d(a[L+1]),d(a[L+2]),d(a[L+3])),v=a[L+2],y=a[L+3],L+=4;break;case t.OPS.curveTo3:v=a[L+2],y=a[L+3],D.push("C",d(a[L]),d(a[L+1]),d(v),d(y),d(v),d(y)),L+=4;break;case t.OPS.closePath:D.push("Z");break}D=D.join(" "),p.path&&s.length>0&&s[0]!==t.OPS.rectangle&&s[0]!==t.OPS.moveTo?D=p.path.getAttributeNS(null,"d")+D:(p.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().appendChild(p.path)),p.path.setAttributeNS(null,"d",D),p.path.setAttributeNS(null,"fill","none"),p.element=p.path,p.setCurrentPoint(v,y)}endPath(){const s=this.current;if(s.path=null,!this.pendingClip)return;if(!s.element){this.pendingClip=null;return}const a=`clippath${W++}`,p=this.svgFactory.createElement("svg:clipPath");p.setAttributeNS(null,"id",a),p.setAttributeNS(null,"transform",k(this.transformMatrix));const v=s.element.cloneNode(!0);if(this.pendingClip==="evenodd"?v.setAttributeNS(null,"clip-rule","evenodd"):v.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,p.appendChild(v),this.defs.appendChild(p),s.activeClipUrl){s.clipGroup=null;for(const y of this.extraStack)y.clipGroup=null;p.setAttributeNS(null,"clip-path",s.activeClipUrl)}s.activeClipUrl=`url(#${a})`,this.tgrp=null}clip(s){this.pendingClip=s}closePath(){const s=this.current;if(s.path){const a=`${s.path.getAttributeNS(null,"d")}Z`;s.path.setAttributeNS(null,"d",a)}}setLeading(s){this.current.leading=-s}setTextRise(s){this.current.textRise=s}setTextRenderingMode(s){this.current.textRenderingMode=s}setHScale(s){this.current.textHScale=s/100}setRenderingIntent(s){}setFlatness(s){}setGState(s){for(const[a,p]of s)switch(a){case"LW":this.setLineWidth(p);break;case"LC":this.setLineCap(p);break;case"LJ":this.setLineJoin(p);break;case"ML":this.setMiterLimit(p);break;case"D":this.setDash(p[0],p[1]);break;case"RI":this.setRenderingIntent(p);break;case"FL":this.setFlatness(p);break;case"Font":this.setFont(p);break;case"CA":this.setStrokeAlpha(p);break;case"ca":this.setFillAlpha(p);break;default:(0,t.warn)(`Unimplemented graphic state operator ${a}`);break}}fill(){const s=this.current;s.element&&(s.element.setAttributeNS(null,"fill",s.fillColor),s.element.setAttributeNS(null,"fill-opacity",s.fillAlpha),this.endPath())}stroke(){const s=this.current;s.element&&(this._setStrokeAttributes(s.element),s.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(s,a=1){const p=this.current;let v=p.dashArray;a!==1&&v.length>0&&(v=v.map(function(y){return a*y})),s.setAttributeNS(null,"stroke",p.strokeColor),s.setAttributeNS(null,"stroke-opacity",p.strokeAlpha),s.setAttributeNS(null,"stroke-miterlimit",d(p.miterLimit)),s.setAttributeNS(null,"stroke-linecap",p.lineCap),s.setAttributeNS(null,"stroke-linejoin",p.lineJoin),s.setAttributeNS(null,"stroke-width",d(a*p.lineWidth)+"px"),s.setAttributeNS(null,"stroke-dasharray",v.map(d).join(" ")),s.setAttributeNS(null,"stroke-dashoffset",d(a*p.dashPhase)+"px")}eoFill(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const s=this.svgFactory.createElement("svg:rect");s.setAttributeNS(null,"x","0"),s.setAttributeNS(null,"y","0"),s.setAttributeNS(null,"width","1px"),s.setAttributeNS(null,"height","1px"),s.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().appendChild(s)}paintImageXObject(s){const a=s.startsWith("g_")?this.commonObjs.get(s):this.objs.get(s);if(!a){(0,t.warn)(`Dependent image with object ID ${s} is not ready yet`);return}this.paintInlineImageXObject(a)}paintInlineImageXObject(s,a){const p=s.width,v=s.height,y=E(s,this.forceDataSchema,!!a),D=this.svgFactory.createElement("svg:rect");D.setAttributeNS(null,"x","0"),D.setAttributeNS(null,"y","0"),D.setAttributeNS(null,"width",d(p)),D.setAttributeNS(null,"height",d(v)),this.current.element=D,this.clip("nonzero");const L=this.svgFactory.createElement("svg:image");L.setAttributeNS(f,"xlink:href",y),L.setAttributeNS(null,"x","0"),L.setAttributeNS(null,"y",d(-v)),L.setAttributeNS(null,"width",d(p)+"px"),L.setAttributeNS(null,"height",d(v)+"px"),L.setAttributeNS(null,"transform",`scale(${d(1/p)} ${d(-1/v)})`),a?a.appendChild(L):this._ensureTransformGroup().appendChild(L)}paintImageMaskXObject(s){const a=this.current,p=s.width,v=s.height,y=a.fillColor;a.maskId=`mask${U++}`;const D=this.svgFactory.createElement("svg:mask");D.setAttributeNS(null,"id",a.maskId);const L=this.svgFactory.createElement("svg:rect");L.setAttributeNS(null,"x","0"),L.setAttributeNS(null,"y","0"),L.setAttributeNS(null,"width",d(p)),L.setAttributeNS(null,"height",d(v)),L.setAttributeNS(null,"fill",y),L.setAttributeNS(null,"mask",`url(#${a.maskId})`),this.defs.appendChild(D),this._ensureTransformGroup().appendChild(L),this.paintInlineImageXObject(s,D)}paintFormXObjectBegin(s,a){if(Array.isArray(s)&&s.length===6&&this.transform(s[0],s[1],s[2],s[3],s[4],s[5]),a){const p=a[2]-a[0],v=a[3]-a[1],y=this.svgFactory.createElement("svg:rect");y.setAttributeNS(null,"x",a[0]),y.setAttributeNS(null,"y",a[1]),y.setAttributeNS(null,"width",d(p)),y.setAttributeNS(null,"height",d(v)),this.current.element=y,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(s){const a=this.svgFactory.create(s.width,s.height),p=this.svgFactory.createElement("svg:defs");a.appendChild(p),this.defs=p;const v=this.svgFactory.createElement("svg:g");return v.setAttributeNS(null,"transform",k(s.transform)),a.appendChild(v),this.svg=v,a}_ensureClipGroup(){if(!this.current.clipGroup){const s=this.svgFactory.createElement("svg:g");s.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.appendChild(s),this.current.clipGroup=s}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",k(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().appendChild(this.tgrp):this.svg.appendChild(this.tgrp)),this.tgrp}}}},(Y,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.XfaLayer=void 0;var t=o(2),u=o(17);class g{static setupStorage(_,b,f,m,P){const E=m.getValue(b,{value:null});switch(f.name){case"textarea":if(E.value!==null&&(_.textContent=E.value),P==="print")break;_.addEventListener("input",A=>{m.setValue(b,{value:A.target.value})});break;case"input":if(f.attributes.type==="radio"||f.attributes.type==="checkbox"){if(E.value===f.attributes.xfaOn?_.setAttribute("checked",!0):E.value===f.attributes.xfaOff&&_.removeAttribute("checked"),P==="print")break;_.addEventListener("change",A=>{m.setValue(b,{value:A.target.checked?A.target.getAttribute("xfaOn"):A.target.getAttribute("xfaOff")})})}else{if(E.value!==null&&_.setAttribute("value",E.value),P==="print")break;_.addEventListener("input",A=>{m.setValue(b,{value:A.target.value})})}break;case"select":if(E.value!==null)for(const A of f.children)A.attributes.value===E.value&&(A.attributes.selected=!0);_.addEventListener("input",A=>{const R=A.target.options,d=R.selectedIndex===-1?"":R[R.selectedIndex].value;m.setValue(b,{value:d})});break}}static setAttributes({html:_,element:b,storage:f=null,intent:m,linkService:P}){var R;const{attributes:E}=b,A=_ instanceof HTMLAnchorElement;E.type==="radio"&&(E.name=`${E.name}-${m}`);for(const[d,k]of Object.entries(E))if(!(k==null||d==="dataId"))if(d!=="style")if(d==="textContent")_.textContent=k;else if(d==="class")_.setAttribute(d,k.join(" "));else{if(A&&(d==="href"||d==="newWindow"))continue;_.setAttribute(d,k)}else Object.assign(_.style,k);A&&(P.addLinkAttributes||(0,t.warn)("XfaLayer.setAttribute - missing `addLinkAttributes`-method on the `linkService`-instance."),(R=P.addLinkAttributes)==null||R.call(P,_,E.href,E.newWindow)),f&&E.dataId&&this.setupStorage(_,E.dataId,b,f)}static render(_){var W;const b=_.annotationStorage,f=_.linkService,m=_.xfa,P=_.intent||"display",E=document.createElement(m.name);m.attributes&&this.setAttributes({html:E,element:m,intent:P,linkService:f});const A=[[m,-1,E]],R=_.div;R.appendChild(E);const d=`matrix(${_.viewport.transform.join(",")})`;R.style.transform=d,R.setAttribute("class","xfaLayer xfaFont");const k=[];for(;A.length>0;){const[U,w,s]=A[A.length-1];if(w+1===U.children.length){A.pop();continue}const a=U.children[++A[A.length-1][1]];if(a===null)continue;const{name:p}=a;if(p==="#text"){const y=document.createTextNode(a.value);k.push(y),s.appendChild(y);continue}let v;if((W=a==null?void 0:a.attributes)!=null&&W.xmlns?v=document.createElementNS(a.attributes.xmlns,p):v=document.createElement(p),s.appendChild(v),a.attributes&&this.setAttributes({html:v,element:a,storage:b,intent:P,linkService:f}),a.children&&a.children.length>0)A.push([a,-1,v]);else if(a.value){const y=document.createTextNode(a.value);u.XfaText.shouldBuildText(p)&&k.push(y),v.appendChild(y)}}for(const U of R.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))U.setAttribute("readOnly",!0);return{textDivs:k}}static update(_){const b=`matrix(${_.viewport.transform.join(",")})`;_.div.style.transform=b,_.div.hidden=!1}}n.XfaLayer=g},(Y,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFNodeStream=void 0;var t=o(2),u=o(24);const g=require$$5,C=require$$5,_=require$$5,b=require$$5,f=/^file:\/\/\/[a-zA-Z]:\//;function m(w){const s=b.parse(w);return s.protocol==="file:"||s.host?s:/^[a-z]:[/\\]/i.test(w)?b.parse(`file:///${w}`):(s.host||(s.protocol="file:"),s)}class P{constructor(s){this.source=s,this.url=m(s.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&s.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var s;return((s=this._fullRequestReader)==null?void 0:s._loaded)??0}getFullReader(){return(0,t.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new W(this):new d(this),this._fullRequestReader}getRangeReader(s,a){if(a<=this._progressiveDataLength)return null;const p=this.isFsUrl?new U(this,s,a):new k(this,s,a);return this._rangeRequestReaders.push(p),p}cancelAllRequests(s){this._fullRequestReader&&this._fullRequestReader.cancel(s);for(const a of this._rangeRequestReaders.slice(0))a.cancel(s)}}n.PDFNodeStream=P;class E{constructor(s){this._url=s.url,this._done=!1,this._storedError=null,this.onProgress=null;const a=s.source;this._contentLength=a.length,this._loaded=0,this._filename=null,this._disableRange=a.disableRange||!1,this._rangeChunkSize=a.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!a.disableStream,this._isRangeSupported=!a.disableRange,this._readableStream=null,this._readCapability=(0,t.createPromiseCapability)(),this._headersCapability=(0,t.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const s=this._readableStream.read();return s===null?(this._readCapability=(0,t.createPromiseCapability)(),this.read()):(this._loaded+=s.length,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(s).buffer,done:!1})}cancel(s){if(!this._readableStream){this._error(s);return}this._readableStream.destroy(s)}_error(s){this._storedError=s,this._readCapability.resolve()}_setReadableStream(s){this._readableStream=s,s.on("readable",()=>{this._readCapability.resolve()}),s.on("end",()=>{s.destroy(),this._done=!0,this._readCapability.resolve()}),s.on("error",a=>{this._error(a)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new t.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class A{constructor(s){this._url=s.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,t.createPromiseCapability)();const a=s.source;this._isStreamingSupported=!a.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const s=this._readableStream.read();return s===null?(this._readCapability=(0,t.createPromiseCapability)(),this.read()):(this._loaded+=s.length,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(s).buffer,done:!1})}cancel(s){if(!this._readableStream){this._error(s);return}this._readableStream.destroy(s)}_error(s){this._storedError=s,this._readCapability.resolve()}_setReadableStream(s){this._readableStream=s,s.on("readable",()=>{this._readCapability.resolve()}),s.on("end",()=>{s.destroy(),this._done=!0,this._readCapability.resolve()}),s.on("error",a=>{this._error(a)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function R(w,s){return{protocol:w.protocol,auth:w.auth,host:w.hostname,port:w.port,path:w.path,method:"GET",headers:s}}class d extends E{constructor(s){super(s);const a=p=>{if(p.statusCode===404){const L=new t.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=L,this._headersCapability.reject(L);return}this._headersCapability.resolve(),this._setReadableStream(p);const v=L=>this._readableStream.headers[L.toLowerCase()],{allowRangeRequests:y,suggestedLength:D}=(0,u.validateRangeRequestCapabilities)({getResponseHeader:v,isHttp:s.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=y,this._contentLength=D||this._contentLength,this._filename=(0,u.extractFilenameFromHeader)(v)};this._request=null,this._url.protocol==="http:"?this._request=C.request(R(this._url,s.httpHeaders),a):this._request=_.request(R(this._url,s.httpHeaders),a),this._request.on("error",p=>{this._storedError=p,this._headersCapability.reject(p)}),this._request.end()}}class k extends A{constructor(s,a,p){super(s),this._httpHeaders={};for(const y in s.httpHeaders){const D=s.httpHeaders[y];typeof D>"u"||(this._httpHeaders[y]=D)}this._httpHeaders.Range=`bytes=${a}-${p-1}`;const v=y=>{if(y.statusCode===404){const D=new t.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=D;return}this._setReadableStream(y)};this._request=null,this._url.protocol==="http:"?this._request=C.request(R(this._url,this._httpHeaders),v):this._request=_.request(R(this._url,this._httpHeaders),v),this._request.on("error",y=>{this._storedError=y}),this._request.end()}}class W extends E{constructor(s){super(s);let a=decodeURIComponent(this._url.path);f.test(this._url.href)&&(a=a.replace(/^\//,"")),g.lstat(a,(p,v)=>{if(p){p.code==="ENOENT"&&(p=new t.MissingPDFException(`Missing PDF "${a}".`)),this._storedError=p,this._headersCapability.reject(p);return}this._contentLength=v.size,this._setReadableStream(g.createReadStream(a)),this._headersCapability.resolve()})}}class U extends A{constructor(s,a,p){super(s);let v=decodeURIComponent(this._url.path);f.test(this._url.href)&&(v=v.replace(/^\//,"")),this._setReadableStream(g.createReadStream(v,{start:a,end:p-1}))}}},(Y,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.createResponseStatusError=b,n.extractFilenameFromHeader=_,n.validateRangeRequestCapabilities=C,n.validateResponseStatus=f;var t=o(2),u=o(25),g=o(1);function C({getResponseHeader:m,isHttp:P,rangeChunkSize:E,disableRange:A}){(0,t.assert)(E>0,"Range chunk size must be larger than zero");const R={allowRangeRequests:!1,suggestedLength:void 0},d=parseInt(m("Content-Length"),10);return!Number.isInteger(d)||(R.suggestedLength=d,d<=2*E)||A||!P||m("Accept-Ranges")!=="bytes"||(m("Content-Encoding")||"identity")!=="identity"||(R.allowRangeRequests=!0),R}function _(m){const P=m("Content-Disposition");if(P){let E=(0,u.getFilenameFromContentDispositionHeader)(P);if(E.includes("%"))try{E=decodeURIComponent(E)}catch{}if((0,g.isPdfFile)(E))return E}return null}function b(m,P){return m===404||m===0&&P.startsWith("file:")?new t.MissingPDFException('Missing PDF "'+P+'".'):new t.UnexpectedResponseException(`Unexpected server response (${m}) while retrieving PDF "${P}".`,m)}function f(m){return m===200||m===206}},(Y,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.getFilenameFromContentDispositionHeader=u;var t=o(2);function u(g){let C=!0,_=b("filename\\*","i").exec(g);if(_){_=_[1];let d=E(_);return d=unescape(d),d=A(d),d=R(d),m(d)}if(_=P(g),_){const d=R(_);return m(d)}if(_=b("filename","i").exec(g),_){_=_[1];let d=E(_);return d=R(d),m(d)}function b(d,k){return new RegExp("(?:^|;)\\s*"+d+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',k)}function f(d,k){if(d){if(!/^[\x00-\xFF]+$/.test(k))return k;try{const W=new TextDecoder(d,{fatal:!0}),U=(0,t.stringToBytes)(k);k=W.decode(U),C=!1}catch{if(/^utf-?8$/i.test(d))try{k=decodeURIComponent(escape(k)),C=!1}catch{}}}return k}function m(d){return C&&/[\x80-\xff]/.test(d)&&(d=f("utf-8",d),C&&(d=f("iso-8859-1",d))),d}function P(d){const k=[];let W;const U=b("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(W=U.exec(d))!==null;){let[,s,a,p]=W;if(s=parseInt(s,10),s in k){if(s===0)break;continue}k[s]=[a,p]}const w=[];for(let s=0;s<k.length&&s in k;++s){let[a,p]=k[s];p=E(p),a&&(p=unescape(p),s===0&&(p=A(p))),w.push(p)}return w.join("")}function E(d){if(d.startsWith('"')){const k=d.slice(1).split('\\"');for(let W=0;W<k.length;++W){const U=k[W].indexOf('"');U!==-1&&(k[W]=k[W].slice(0,U),k.length=W+1),k[W]=k[W].replace(/\\(.)/g,"$1")}d=k.join('"')}return d}function A(d){const k=d.indexOf("'");if(k===-1)return d;const W=d.slice(0,k),w=d.slice(k+1).replace(/^[^']*'/,"");return f(W,w)}function R(d){return!d.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(d)?d:d.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(k,W,U,w){if(U==="q"||U==="Q")return w=w.replace(/_/g," "),w=w.replace(/=([0-9a-fA-F]{2})/g,function(s,a){return String.fromCharCode(parseInt(a,16))}),f(W,w);try{w=atob(w)}catch{}return f(W,w)})}return""}},(Y,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFNetworkStream=void 0;var t=o(2),u=o(24);const g=200,C=206;function _(E){const A=E.response;return typeof A!="string"?A:(0,t.stringToBytes)(A).buffer}class b{constructor(A,R={}){this.url=A,this.isHttp=/^https?:/i.test(A),this.httpHeaders=this.isHttp&&R.httpHeaders||Object.create(null),this.withCredentials=R.withCredentials||!1,this.getXhr=R.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(A,R,d){const k={begin:A,end:R};for(const W in d)k[W]=d[W];return this.request(k)}requestFull(A){return this.request(A)}request(A){const R=this.getXhr(),d=this.currXhrId++,k=this.pendingRequests[d]={xhr:R};R.open("GET",this.url),R.withCredentials=this.withCredentials;for(const W in this.httpHeaders){const U=this.httpHeaders[W];typeof U>"u"||R.setRequestHeader(W,U)}return this.isHttp&&"begin"in A&&"end"in A?(R.setRequestHeader("Range",`bytes=${A.begin}-${A.end-1}`),k.expectedStatus=C):k.expectedStatus=g,R.responseType="arraybuffer",A.onError&&(R.onerror=function(W){A.onError(R.status)}),R.onreadystatechange=this.onStateChange.bind(this,d),R.onprogress=this.onProgress.bind(this,d),k.onHeadersReceived=A.onHeadersReceived,k.onDone=A.onDone,k.onError=A.onError,k.onProgress=A.onProgress,R.send(null),d}onProgress(A,R){var k;const d=this.pendingRequests[A];d&&((k=d.onProgress)==null||k.call(d,R))}onStateChange(A,R){var s,a,p;const d=this.pendingRequests[A];if(!d)return;const k=d.xhr;if(k.readyState>=2&&d.onHeadersReceived&&(d.onHeadersReceived(),delete d.onHeadersReceived),k.readyState!==4||!(A in this.pendingRequests))return;if(delete this.pendingRequests[A],k.status===0&&this.isHttp){(s=d.onError)==null||s.call(d,k.status);return}const W=k.status||g;if(!(W===g&&d.expectedStatus===C)&&W!==d.expectedStatus){(a=d.onError)==null||a.call(d,k.status);return}const w=_(k);if(W===C){const v=k.getResponseHeader("Content-Range"),y=/bytes (\d+)-(\d+)\/(\d+)/.exec(v);d.onDone({begin:parseInt(y[1],10),chunk:w})}else w?d.onDone({begin:0,chunk:w}):(p=d.onError)==null||p.call(d,k.status)}getRequestXhr(A){return this.pendingRequests[A].xhr}isPendingRequest(A){return A in this.pendingRequests}abortRequest(A){const R=this.pendingRequests[A].xhr;delete this.pendingRequests[A],R.abort()}}class f{constructor(A){this._source=A,this._manager=new b(A.url,{httpHeaders:A.httpHeaders,withCredentials:A.withCredentials}),this._rangeChunkSize=A.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(A){const R=this._rangeRequestReaders.indexOf(A);R>=0&&this._rangeRequestReaders.splice(R,1)}getFullReader(){return(0,t.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new m(this._manager,this._source),this._fullRequestReader}getRangeReader(A,R){const d=new P(this._manager,A,R);return d.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(d),d}cancelAllRequests(A){var R;(R=this._fullRequestReader)==null||R.cancel(A);for(const d of this._rangeRequestReaders.slice(0))d.cancel(A)}}n.PDFNetworkStream=f;class m{constructor(A,R){this._manager=A;const d={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=R.url,this._fullRequestId=A.requestFull(d),this._headersReceivedCapability=(0,t.createPromiseCapability)(),this._disableRange=R.disableRange||!1,this._contentLength=R.length,this._rangeChunkSize=R.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const A=this._fullRequestId,R=this._manager.getRequestXhr(A),d=U=>R.getResponseHeader(U),{allowRangeRequests:k,suggestedLength:W}=(0,u.validateRangeRequestCapabilities)({getResponseHeader:d,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});k&&(this._isRangeSupported=!0),this._contentLength=W||this._contentLength,this._filename=(0,u.extractFilenameFromHeader)(d),this._isRangeSupported&&this._manager.abortRequest(A),this._headersReceivedCapability.resolve()}_onDone(A){if(A&&(this._requests.length>0?this._requests.shift().resolve({value:A.chunk,done:!1}):this._cachedChunks.push(A.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const R of this._requests)R.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(A){this._storedError=(0,u.createResponseStatusError)(A,this._url),this._headersReceivedCapability.reject(this._storedError);for(const R of this._requests)R.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(A){var R;(R=this.onProgress)==null||R.call(this,{loaded:A.loaded,total:A.lengthComputable?A.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const A=(0,t.createPromiseCapability)();return this._requests.push(A),A.promise}cancel(A){this._done=!0,this._headersReceivedCapability.reject(A);for(const R of this._requests)R.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class P{constructor(A,R,d){this._manager=A;const k={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=A.url,this._requestId=A.requestRange(R,d,k),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var A;(A=this.onClosed)==null||A.call(this,this)}_onDone(A){const R=A.chunk;this._requests.length>0?this._requests.shift().resolve({value:R,done:!1}):this._queuedChunk=R,this._done=!0;for(const d of this._requests)d.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(A){this._storedError=(0,u.createResponseStatusError)(A,this._url);for(const R of this._requests)R.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(A){var R;this.isStreamingSupported||(R=this.onProgress)==null||R.call(this,{loaded:A.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const R=this._queuedChunk;return this._queuedChunk=null,{value:R,done:!1}}if(this._done)return{value:void 0,done:!0};const A=(0,t.createPromiseCapability)();return this._requests.push(A),A.promise}cancel(A){this._done=!0;for(const R of this._requests)R.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(Y,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFFetchStream=void 0;var t=o(2),u=o(24);function g(m,P,E){return{method:"GET",headers:m,signal:E==null?void 0:E.signal,mode:"cors",credentials:P?"include":"same-origin",redirect:"follow"}}function C(m){const P=new Headers;for(const E in m){const A=m[E];typeof A>"u"||P.append(E,A)}return P}class _{constructor(P){this.source=P,this.isHttp=/^https?:/i.test(P.url),this.httpHeaders=this.isHttp&&P.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var P;return((P=this._fullRequestReader)==null?void 0:P._loaded)??0}getFullReader(){return(0,t.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new b(this),this._fullRequestReader}getRangeReader(P,E){if(E<=this._progressiveDataLength)return null;const A=new f(this,P,E);return this._rangeRequestReaders.push(A),A}cancelAllRequests(P){this._fullRequestReader&&this._fullRequestReader.cancel(P);for(const E of this._rangeRequestReaders.slice(0))E.cancel(P)}}n.PDFFetchStream=_;class b{constructor(P){this._stream=P,this._reader=null,this._loaded=0,this._filename=null;const E=P.source;this._withCredentials=E.withCredentials||!1,this._contentLength=E.length,this._headersCapability=(0,t.createPromiseCapability)(),this._disableRange=E.disableRange||!1,this._rangeChunkSize=E.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),typeof AbortController<"u"&&(this._abortController=new AbortController),this._isStreamingSupported=!E.disableStream,this._isRangeSupported=!E.disableRange,this._headers=C(this._stream.httpHeaders);const A=E.url;fetch(A,g(this._headers,this._withCredentials,this._abortController)).then(R=>{if(!(0,u.validateResponseStatus)(R.status))throw(0,u.createResponseStatusError)(R.status,A);this._reader=R.body.getReader(),this._headersCapability.resolve();const d=U=>R.headers.get(U),{allowRangeRequests:k,suggestedLength:W}=(0,u.validateRangeRequestCapabilities)({getResponseHeader:d,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=k,this._contentLength=W||this._contentLength,this._filename=(0,u.extractFilenameFromHeader)(d),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new t.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:P,done:E}=await this._reader.read();return E?{value:P,done:E}:(this._loaded+=P.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(P).buffer,done:!1})}cancel(P){this._reader&&this._reader.cancel(P),this._abortController&&this._abortController.abort()}}class f{constructor(P,E,A){this._stream=P,this._reader=null,this._loaded=0;const R=P.source;this._withCredentials=R.withCredentials||!1,this._readCapability=(0,t.createPromiseCapability)(),this._isStreamingSupported=!R.disableStream,typeof AbortController<"u"&&(this._abortController=new AbortController),this._headers=C(this._stream.httpHeaders),this._headers.append("Range",`bytes=${E}-${A-1}`);const d=R.url;fetch(d,g(this._headers,this._withCredentials,this._abortController)).then(k=>{if(!(0,u.validateResponseStatus)(k.status))throw(0,u.createResponseStatusError)(k.status,d);this._readCapability.resolve(),this._reader=k.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:P,done:E}=await this._reader.read();return E?{value:P,done:E}:(this._loaded+=P.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(P).buffer,done:!1})}cancel(P){this._reader&&this._reader.cancel(P),this._abortController&&this._abortController.abort()}}}],__webpack_module_cache__={};function __w_pdfjs_require__(Y){var n=__webpack_module_cache__[Y];if(n!==void 0)return n.exports;var o=__webpack_module_cache__[Y]={exports:{}};return __webpack_modules__[Y](o,o.exports,__w_pdfjs_require__),o.exports}var __webpack_exports__={};return(()=>{var Y=__webpack_exports__;Object.defineProperty(Y,"__esModule",{value:!0}),Object.defineProperty(Y,"addLinkAttributes",{enumerable:!0,get:function(){return n.addLinkAttributes}}),Object.defineProperty(Y,"getFilenameFromUrl",{enumerable:!0,get:function(){return n.getFilenameFromUrl}}),Object.defineProperty(Y,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return n.getPdfFilenameFromUrl}}),Object.defineProperty(Y,"getXfaPageViewport",{enumerable:!0,get:function(){return n.getXfaPageViewport}}),Object.defineProperty(Y,"isPdfFile",{enumerable:!0,get:function(){return n.isPdfFile}}),Object.defineProperty(Y,"LinkTarget",{enumerable:!0,get:function(){return n.LinkTarget}}),Object.defineProperty(Y,"loadScript",{enumerable:!0,get:function(){return n.loadScript}}),Object.defineProperty(Y,"PDFDateString",{enumerable:!0,get:function(){return n.PDFDateString}}),Object.defineProperty(Y,"PixelsPerInch",{enumerable:!0,get:function(){return n.PixelsPerInch}}),Object.defineProperty(Y,"RenderingCancelledException",{enumerable:!0,get:function(){return n.RenderingCancelledException}}),Object.defineProperty(Y,"AnnotationMode",{enumerable:!0,get:function(){return o.AnnotationMode}}),Object.defineProperty(Y,"CMapCompressionType",{enumerable:!0,get:function(){return o.CMapCompressionType}}),Object.defineProperty(Y,"createObjectURL",{enumerable:!0,get:function(){return o.createObjectURL}}),Object.defineProperty(Y,"createPromiseCapability",{enumerable:!0,get:function(){return o.createPromiseCapability}}),Object.defineProperty(Y,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return o.createValidAbsoluteUrl}}),Object.defineProperty(Y,"InvalidPDFException",{enumerable:!0,get:function(){return o.InvalidPDFException}}),Object.defineProperty(Y,"MissingPDFException",{enumerable:!0,get:function(){return o.MissingPDFException}}),Object.defineProperty(Y,"OPS",{enumerable:!0,get:function(){return o.OPS}}),Object.defineProperty(Y,"PasswordResponses",{enumerable:!0,get:function(){return o.PasswordResponses}}),Object.defineProperty(Y,"PermissionFlag",{enumerable:!0,get:function(){return o.PermissionFlag}}),Object.defineProperty(Y,"removeNullCharacters",{enumerable:!0,get:function(){return o.removeNullCharacters}}),Object.defineProperty(Y,"shadow",{enumerable:!0,get:function(){return o.shadow}}),Object.defineProperty(Y,"UnexpectedResponseException",{enumerable:!0,get:function(){return o.UnexpectedResponseException}}),Object.defineProperty(Y,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return o.UNSUPPORTED_FEATURES}}),Object.defineProperty(Y,"Util",{enumerable:!0,get:function(){return o.Util}}),Object.defineProperty(Y,"VerbosityLevel",{enumerable:!0,get:function(){return o.VerbosityLevel}}),Object.defineProperty(Y,"build",{enumerable:!0,get:function(){return t.build}}),Object.defineProperty(Y,"getDocument",{enumerable:!0,get:function(){return t.getDocument}}),Object.defineProperty(Y,"LoopbackPort",{enumerable:!0,get:function(){return t.LoopbackPort}}),Object.defineProperty(Y,"PDFDataRangeTransport",{enumerable:!0,get:function(){return t.PDFDataRangeTransport}}),Object.defineProperty(Y,"PDFWorker",{enumerable:!0,get:function(){return t.PDFWorker}}),Object.defineProperty(Y,"version",{enumerable:!0,get:function(){return t.version}}),Object.defineProperty(Y,"AnnotationLayer",{enumerable:!0,get:function(){return u.AnnotationLayer}}),Object.defineProperty(Y,"GlobalWorkerOptions",{enumerable:!0,get:function(){return g.GlobalWorkerOptions}}),Object.defineProperty(Y,"renderTextLayer",{enumerable:!0,get:function(){return _.renderTextLayer}}),Object.defineProperty(Y,"SVGGraphics",{enumerable:!0,get:function(){return b.SVGGraphics}}),Object.defineProperty(Y,"XfaLayer",{enumerable:!0,get:function(){return f.XfaLayer}});var n=__w_pdfjs_require__(1),o=__w_pdfjs_require__(2),t=__w_pdfjs_require__(6),u=__w_pdfjs_require__(18),g=__w_pdfjs_require__(12),C=__w_pdfjs_require__(4),_=__w_pdfjs_require__(20),b=__w_pdfjs_require__(21),f=__w_pdfjs_require__(22);if(C.isNodeJS){const{PDFNodeStream:m}=__w_pdfjs_require__(23);(0,t.setPDFNetworkStreamFactory)(P=>new m(P))}else{const{PDFNetworkStream:m}=__w_pdfjs_require__(26),{PDFFetchStream:P}=__w_pdfjs_require__(27);(0,t.setPDFNetworkStreamFactory)(E=>(0,n.isValidFetchUrl)(E.url)?new P(E):new m(E))}})(),__webpack_exports__})()})})(pdf);var pdfExports=pdf.exports;async function process_file(Y,n,o,t,u,g,C){const _=n.name,b=n.size,f=new Date;let m;const P=u,E=g,A=new RecursiveCharacterTextSplitter({chunkSize:P,chunkOverlap:E}),R=createClient(PUBLIC_SUPABASE_URL,PUBLIC_SUPABASE_KEY);let k=(await R.auth.getUser()).data.user.id;console.log("userID",k);let W;if(console.log("isUrl",C),C===!0){console.log("isUrl",C);const p=new FileReader;p.onload=async function(v){const y=v.target.result;console.log("file content: ",y);const D={pageContent:y.toString(),metadata:{file_sha1:m,file_size:b,file_name:_,chunk_size:u,chunk_overlap:g,date:f}};W=await A.splitDocuments([D]),console.log("splittedDocuments",W[0].user_id),m=await computeSHA1FromContent(y);const L=[];for(const q of W){const G={pageContent:q.pageContent,metadata:{file_sha1:m,file_size:b,file_name:_,chunk_size:u,chunk_overlap:g,date:f}};L.push(G)}const Q=createClient(PUBLIC_SUPABASE_URL,PUBLIC_SUPABASE_KEY),H=PUBLIC_OPENAI_API_KEY,T=new OpenAIEmbeddings({openAIApiKey:H});console.log("user_id",k),new SupabaseVectorStore(T,{client:Q,queryName:"insert",tableName:"documents"}).addDocuments(L)},await p.readAsText(n)}else if(t===".pdf"){console.log("isPdf");const p=new File([n],_,{type:n.type});m=await computeSHA1FromFile(p);const v=await fetchFileAsArrayBuffer(p),y=await pdfExports.getDocument({data:v}).promise,D=await extractTextFromPDF(y);console.log("pdfText",D);const L={pageContent:D,metadata:{file_sha1:m,file_size:b,file_name:_,chunk_size:u,chunk_overlap:g,date:f}};W=await A.splitDocuments([L]),console.log("splittedDocuments",W);const Q=[];for(const G of W){const B={pageContent:G.pageContent,metadata:{file_sha1:m,file_size:b,file_name:_,chunk_size:u,chunk_overlap:g,date:f}};Q.push(B)}const H=createClient(PUBLIC_SUPABASE_URL,PUBLIC_SUPABASE_KEY),T=PUBLIC_OPENAI_API_KEY,M=new OpenAIEmbeddings({openAIApiKey:T});console.log("user_id",k);let q=new SupabaseVectorStore(M,{client:H,queryName:"insert",tableName:"documents"});console.log("docs Metadata",Q[0].user_id),q.addDocuments(Q)}else{const p=new File([n],_,{type:n.type});m=await computeSHA1FromFile(p);const y=await new o(p).load();W=await A.splitDocuments(y)}const U=[];for(const p of W){const v={pageContent:p.pageContent,metadata:{file_sha1:m,file_size:b,file_name:_,chunk_size:u,chunk_overlap:g,date:f}};U.push(v)}const w=PUBLIC_OPENAI_API_KEY,s=new OpenAIEmbeddings({openAIApiKey:w});console.log("user_id",k);let a=new SupabaseVectorStore(s,{client:R,tableName:"documents",queryName:"insert"});console.log("docsWithMetadata",U);try{a.addDocuments(U)}catch(p){console.log("error",p)}}async function extractTextFromPDF(Y){let n="";for(let o=1;o<=Y.numPages;o++){const g=(await(await Y.getPage(o)).getTextContent()).items.map(C=>C.str).join(" ");n+=g+" "}return n}async function fetchFileAsArrayBuffer(Y){return await(await fetch(URL.createObjectURL(Y))).arrayBuffer()}class BaseDocumentLoader{async loadAndSplit(n=new RecursiveCharacterTextSplitter){const o=await this.load();return n.splitDocuments(o)}}class TextLoader extends BaseDocumentLoader{constructor(n){super(),Object.defineProperty(this,"filePathOrBlob",{enumerable:!0,configurable:!0,writable:!0,value:n})}async parse(n){return[n]}async load(){let n,o;if(typeof this.filePathOrBlob=="string"){const{readFile:u}=await TextLoader.imports();n=await u(this.filePathOrBlob,"utf8"),o={source:this.filePathOrBlob}}else n=await this.filePathOrBlob.text(),o={source:"blob",blobType:this.filePathOrBlob.type};const t=await this.parse(n);return t.forEach((u,g)=>{if(typeof u!="string")throw new Error(`Expected string, at position ${g} got ${typeof u}`)}),t.map((u,g)=>new Document({pageContent:u,metadata:t.length===1?o:{...o,line:g+1}}))}static async imports(){try{const{readFile:n}=await __vitePreload(()=>import("./promises.0ef77ad7.js"),[]);return{readFile:n}}catch(n){throw console.error(n),new Error(`Failed to load fs/promises. TextLoader available only on environment 'node'. It appears you are running environment '${getEnv()}'. See https://<link to docs> for alternatives.`)}}}function processTxt(Y,n){return process_file(Y,n,TextLoader,".txt",500,0)}class BufferLoader extends BaseDocumentLoader{constructor(n){super(),Object.defineProperty(this,"filePathOrBlob",{enumerable:!0,configurable:!0,writable:!0,value:n})}async load(){let n,o;if(typeof this.filePathOrBlob=="string"){const{readFile:t}=await BufferLoader.imports();n=await t(this.filePathOrBlob),o={source:this.filePathOrBlob}}else n=await this.filePathOrBlob.arrayBuffer().then(t=>Buffer.from(t)),o={source:"blob",blobType:this.filePathOrBlob.type};return this.parse(n,o)}static async imports(){try{const{readFile:n}=await __vitePreload(()=>import("./promises.0ef77ad7.js"),[]);return{readFile:n}}catch(n){throw console.error(n),new Error(`Failed to load fs/promises. TextLoader available only on environment 'node'. It appears you are running environment '${getEnv()}'. See https://<link to docs> for alternatives.`)}}}class PDFLoader extends BufferLoader{constructor(n,{splitPages:o=!0,pdfjs:t=PDFLoaderImports}={}){super(n),Object.defineProperty(this,"splitPages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"pdfjs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.splitPages=o,this.pdfjs=t}async parse(n,o){const{getDocument:t,version:u}=await this.pdfjs(),g=await t({data:new Uint8Array(n.buffer),useWorkerFetch:!1,isEvalSupported:!1,useSystemFonts:!0}).promise,C=await g.getMetadata().catch(()=>null),_=[];for(let b=1;b<=g.numPages;b+=1){const m=await(await g.getPage(b)).getTextContent();if(m.items.length===0)continue;const P=m.items.map(E=>E.str).join(`
`);_.push(new Document({pageContent:P,metadata:{...o,pdf:{version:u,info:C==null?void 0:C.info,metadata:C==null?void 0:C.metadata,totalPages:g.numPages},loc:{pageNumber:b}}}))}return this.splitPages?_:_.length===0?[]:[new Document({pageContent:_.map(b=>b.pageContent).join(`

`),metadata:{...o,pdf:{version:u,info:C==null?void 0:C.info,metadata:C==null?void 0:C.metadata,totalPages:g.numPages}}})]}}async function PDFLoaderImports(){try{const{default:Y}=await __vitePreload(()=>import("./pdf.5620fb3c.js").then(t=>t.p),["_app/immutable/chunks/pdf.5620fb3c.js","_app/immutable/chunks/public.42564a77.js","_app/immutable/chunks/_commonjs-dynamic-modules.6fed1697.js"]),{getDocument:n,version:o}=Y;return{getDocument:n,version:o}}catch(Y){throw console.error(Y),new Error("Failed to load pdf-parse. Please install it with eg. `npm install pdf-parse`.")}}function process_pdf(Y,n){return process_file(Y,n,PDFLoader,".pdf",500,0)}class UnstructuredLoader extends BaseDocumentLoader{constructor(n,o={}){super(),Object.defineProperty(this,"filePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiUrl",{enumerable:!0,configurable:!0,writable:!0,value:"https://api.unstructured.io/general/v0/general"}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"strategy",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof o=="string"?(this.filePath=o,this.apiUrl=n):(this.filePath=n,this.apiKey=o.apiKey,this.apiUrl=o.apiUrl??this.apiUrl,this.strategy=o.strategy??"hi_res")}async _partition(){const{readFile:n,basename:o}=await this.imports(),t=await n(this.filePath),u=o(this.filePath),g=new FormData;g.append("files",new Blob([t]),u),g.append("strategy",this.strategy);const C={"UNSTRUCTURED-API-KEY":this.apiKey??""},_=await fetch(this.apiUrl,{method:"POST",body:g,headers:C});if(!_.ok)throw new Error(`Failed to partition file ${this.filePath} with error ${_.status} and message ${await _.text()}`);const b=await _.json();if(!Array.isArray(b))throw new Error(`Expected partitioning request to return an array, but got ${b}`);return b.filter(f=>typeof f.text=="string")}async load(){const n=await this._partition(),o=[];for(const t of n){const{metadata:u,text:g}=t;o.push(new Document({pageContent:g,metadata:{...u,category:t.type}}))}return o}async imports(){try{const{readFile:n}=await __vitePreload(()=>import("./promises.0ef77ad7.js"),[]),{basename:o}=await __vitePreload(()=>import("./__vite-browser-external_node_path.042c5bd1.js"),[]);return{readFile:n,basename:o}}catch(n){throw console.error(n),new Error(`Failed to load fs/promises. TextLoader available only on environment 'node'. It appears you are running environment '${getEnv()}'. See https://<link to docs> for alternatives.`)}}}const fs=new Proxy({},{get(Y,n){throw new Error(`Module "fs" has been externalized for browser compatibility. Cannot access "fs.${n}" in client code.  See http://vitejs.dev/guide/troubleshooting.html#module-externalized-for-browser-compatibility for more details.`)}}),__viteBrowserExternal_fs=Object.freeze(Object.defineProperty({__proto__:null,default:fs},Symbol.toStringTag,{value:"Module"}));async function processHtml(Y,n){return process_file(Y,n,UnstructuredLoader,".html")}async function getHtml(Y){try{const o=`/api?${new URLSearchParams({url:Y}).toString()}`,t=await fetch(o,{method:"GET"});return t.status===200?await t.text():null}catch{return null}}class CustomFile extends Blob{constructor(n,o){super(n,o),this.name=o.name,this.lastModifiedDate=new Date}}function createHtmlFile(Y,n){const o=slugify(Y)+".html";return new CustomFile([n],{type:"text/html",name:o})}function slugify(Y){return Y=Y.normalize("NFKD").replace(/[\u0300-\u036f]/g,""),Y=Y.replace(/[^\w\s-]/g,"").trim().toLowerCase(),Y=Y.replace(/[-\s]+/g,"-"),Y}const file_processors={".txt":processTxt,".pdf":process_pdf,".html":processHtml};async function file_uploader(Y,n,o,t){Array.isArray(t)||(t=[t]),console.log(t);for(const u of t)await filter_file(u,Y)}async function file_already_exists(Y,n){const o=computeSHA1FromContent(n);let t=createClient(PUBLIC_SUPABASE_URL,PUBLIC_SUPABASE_KEY);const{data:u,error:g}=await t.from("documents").select("id").eq("metadata->>file_sha1",o);return g?(console.log(`Error retrieving data: ${g.message}`),!1):u.length>0}async function filter_file(Y,n,o){if(await file_already_exists(n,Y))return console.log(`😎 ${Y.name} is already in the database.`),!1;if(Y.size<1)return console.log(`💨 ${Y.name} is empty.`),!1;{const t=`.${Y.name.split(".").pop()}`;if(console.log(Y.name,t),t in file_processors){const u=PUBLIC_OPENAI_API_KEY;let g=createClient(PUBLIC_SUPABASE_URL,PUBLIC_SUPABASE_KEY),C=new OpenAIEmbeddings({openAIApiKey:u}),_=new SupabaseVectorStore(C,{client:g,tableName:"documents"});return await file_processors[t](_,Y),console.log(`✅ ${Y.name}`),!0}else return console.log(`❌ ${Y.name} is not a valid file type.`),!1}}async function url_uploader(Y,n,o,t){const u=await getHtml(t);console.log(u);const g=createHtmlFile(t,u);console.log(g),await process_file(o,g,UnstructuredLoader,".html",500,0,!0)}export{__viteBrowserExternal_fs as _,file_uploader as f,url_uploader as u};
