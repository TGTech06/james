import{s as me,o as H,d as g}from"../chunks/scheduler.2364b0ad.js";import{S as _e,i as he,d as V,v as ve,E as K,u as ne,w as se,x as ae,f as oe,t as ce,y as le,j as p,s as O,k as b,l as I,c as z,A as ge,g as _,m as P,a as re,z as f,B as ie,I as pe,o as N,p as j,q as Y}from"../chunks/index.9f7452a2.js";import{g as be}from"../chunks/globals.7f7f1b26.js";import{c as F,P as J,a as M,b as ye,d as Z}from"../chunks/public.9062b0fe.js";import{A as ue,O as Q,S as W,N as fe}from"../chunks/NavBar.28f036ee.js";import{H as Ee}from"../chunks/hf.6d567cb7.js";async function X(l){const a=(await l.from("documents").select("name:metadata->>file_name, size:metadata->>file_size",{count:"exact"})).data.reduce((r,t)=>(r.find(u=>u.name===t.name)||r.push(t),r),[]);return a.sort((r,t)=>parseInt(t.size)-parseInt(r.size)),a}async function ee(l,e){try{return(await l.from("documents").delete().match({"metadata->>file_name":e})).error==null}catch(s){return console.error("Error:",s),!1}}const{console:Ie}=be,y="src/routes/profile/+page.svelte";function te(l,e,s){const a=l.slice();return a[7]=e[s],a}function G(l){let e,s,a,r,t=l[7].name+"",i,u,w=l[7].size+"",k,h,D,v,n,E,$,U;function x(){return l[4](l[7])}const d={c:function(){e=p("div"),s=p("div"),a=p("p"),r=p("strong"),i=N(t),u=N(" ("),k=N(w),h=N(" bytes)"),D=O(),v=p("button"),n=p("i"),E=O(),this.h()},l:function(m){e=b(m,"DIV",{class:!0});var o=I(e);s=b(o,"DIV",{});var A=I(s);a=b(A,"P",{class:!0});var c=I(a);r=b(c,"STRONG",{});var S=I(r);i=j(S,t),S.forEach(_),u=j(c," ("),k=j(c,w),h=j(c," bytes)"),c.forEach(_),A.forEach(_),D=z(o),v=b(o,"BUTTON",{class:!0});var C=I(v);n=b(C,"I",{class:!0}),I(n).forEach(_),C.forEach(_),E=z(o),o.forEach(_),this.h()},h:function(){g(r,y,88,18,2428),P(a,"class","text-lg"),g(a,y,87,16,2390),g(s,y,86,14,2368),P(n,"class","fas fa-trash white-icon"),g(n,y,95,16,2688),P(v,"class","btn btn-error"),g(v,y,91,14,2541),P(e,"class","bg-gray-800 p-4 rounded-lg flex items-center justify-between"),g(e,y,83,12,2252)},m:function(m,o){re(m,e,o),f(e,s),f(s,a),f(a,r),f(r,i),f(a,u),f(a,k),f(a,h),f(e,D),f(e,v),f(v,n),f(e,E),$||(U=ie(v,"click",x,!1,!1,!1,!1),$=!0)},p:function(m,o){l=m,o&1&&t!==(t=l[7].name+"")&&Y(i,t),o&1&&w!==(w=l[7].size+"")&&Y(k,w)},d:function(m){m&&_(e),$=!1,U()}};return V("SvelteRegisterBlock",{block:d,id:G.name,type:"each",source:"(70:10) {#each documents as document}",ctx:l}),d}function de(l){let e,s,a,r,t,i,u,w="Your James",k,h,D,v,n,E,$,U;a=new fe({$$inline:!0});let x=K(l[0]),d=[];for(let m=0;m<x.length;m+=1)d[m]=G(te(l,x,m));const B={c:function(){e=p("div"),s=p("div"),ne(a.$$.fragment),r=O(),t=p("div"),i=p("div"),u=p("h1"),u.textContent=w,k=O(),h=p("button"),D=p("i"),v=O(),n=p("div");for(let o=0;o<d.length;o+=1)d[o].c();this.h()},l:function(o){e=b(o,"DIV",{class:!0});var A=I(e);s=b(A,"DIV",{class:!0});var c=I(s);se(a.$$.fragment,c),r=z(c),t=b(c,"DIV",{class:!0});var S=I(t);i=b(S,"DIV",{class:!0});var C=I(i);u=b(C,"H1",{class:!0,"data-svelte-h":!0}),ge(u)!=="svelte-8zxus5"&&(u.textContent=w),k=z(C),h=b(C,"BUTTON",{class:!0});var T=I(h);D=b(T,"I",{class:!0}),I(D).forEach(_),T.forEach(_),C.forEach(_),v=z(S),n=b(S,"DIV",{class:!0});var q=I(n);for(let R=0;R<d.length;R+=1)d[R].l(q);q.forEach(_),S.forEach(_),c.forEach(_),A.forEach(_),this.h()},h:function(){P(u,"class","text-4xl font-bold mb-8"),g(u,y,72,10,1898),P(D,"class","fas fa-sign-out-alt"),g(D,y,77,12,2098),P(h,"class","btn btn-secondary btn-md flex items-center s-zqG5o-EiPySZ"),g(h,y,73,10,1960),P(i,"class","flex items-center justify-between"),g(i,y,71,8,1840),P(n,"class","space-y-4"),g(n,y,81,8,2176),P(t,"class","p-8"),g(t,y,70,6,1814),P(s,"class","flex flex-col items-center"),g(s,y,68,4,1750),P(e,"class","flex flex-col min-h-screen min-w-full bg-gray-900 text-white p-4"),g(e,y,67,2,1667)},m:function(o,A){re(o,e,A),f(e,s),ae(a,s,null),f(s,r),f(s,t),f(t,i),f(i,u),f(i,k),f(i,h),f(h,D),f(t,v),f(t,n);for(let c=0;c<d.length;c+=1)d[c]&&d[c].m(n,null);E=!0,$||(U=ie(h,"click",l[3],!1,!1,!1,!1),$=!0)},p:function(o,A){if(A&3){x=K(o[0]);let c;for(c=0;c<x.length;c+=1){const S=te(o,x,c);d[c]?d[c].p(S,A):(d[c]=G(S),d[c].c(),d[c].m(n,null))}for(;c<d.length;c+=1)d[c].d(1);d.length=x.length}},i:function(o){E||(oe(a.$$.fragment,o),E=!0)},o:function(o){ce(a.$$.fragment,o),E=!1},d:function(o){o&&_(e),le(a),pe(d,o),$=!1,U()}};return V("SvelteRegisterBlock",{block:B,id:de.name,type:"slot",source:"(54:0) <AuthCheck>",ctx:l}),B}function L(l){let e,s;e=new ue({props:{$$slots:{default:[de]},$$scope:{ctx:l}},$$inline:!0});const a={c:function(){ne(e.$$.fragment)},l:function(t){se(e.$$.fragment,t)},m:function(t,i){ae(e,t,i),s=!0},p:function(t,[i]){const u={};i&1025&&(u.$$scope={dirty:i,ctx:t}),e.$set(u)},i:function(t){s||(oe(e.$$.fragment,t),s=!0)},o:function(t){ce(e.$$.fragment,t),s=!1},d:function(t){le(e,t)}};return V("SvelteRegisterBlock",{block:a,id:L.name,type:"component",source:"",ctx:l}),a}function we(l,e,s){let{$$slots:a={},$$scope:r}=e;ve("Page",a,[]);let t,i,u=[];H(async()=>{t=F(M,J);const n=Z;let E=new Q({openAIApiKey:n});i=new W(E,{client:t,tableName:"documents"}),s(0,u=await X(t))});async function w(n){const E=n.split("/"),$=E[E.length-1];await ee(t,$)?s(0,u=u.filter(x=>x.name!==$)):console.error(`Error deleting ${$}`)}async function k(){const{error:n}=await t.auth.signOut();n?console.log(n):window.location.reload()}const h=[];Object.keys(e).forEach(n=>{!~h.indexOf(n)&&n.slice(0,2)!=="$$"&&n!=="slot"&&Ie.warn(`<Page> was created with unknown prop '${n}'`)});const D=()=>k(),v=n=>w(n.name);return l.$capture_state=()=>({onMount:H,createClient:F,SupabaseVectorStore:W,HuggingFaceInferenceEmbeddings:Ee,PUBLIC_SUPABASE_KEY:J,PUBLIC_SUPABASE_URL:M,PUBLIC_HUGGINGFACE_API_KEY:ye,PUBLIC_OPENAI_API_KEY:Z,OpenAIEmbeddings:Q,getDocuments:X,deleteDocument:ee,AuthCheck:ue,NavBar:fe,supabase:t,vector:i,documents:u,handleDeleteDocument:w,signOutUser:k}),l.$inject_state=n=>{"supabase"in n&&(t=n.supabase),"vector"in n&&(i=n.vector),"documents"in n&&s(0,u=n.documents)},e&&"$$inject"in e&&l.$inject_state(e.$$inject),[u,w,k,D,v]}class Se extends _e{constructor(e){super(e),he(this,e,we,L,me,{}),V("SvelteRegisterComponent",{component:this,tagName:"Page",options:e,id:L.name})}}export{Se as component};
