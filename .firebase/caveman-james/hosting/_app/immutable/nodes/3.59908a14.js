import{s as Vt,v as ut,h as ft,o as We,j as dt,d,i as Mt,r as Ct,n as Tt}from"../chunks/scheduler.98e03797.js";import{S as xt,i as Ut,d as pe,v as Lt,D as xe,j as h,s as S,u as kt,k as _,c as A,w as yt,m as u,a as ve,x as It,f as wt,t as Et,g as v,y as St,H as jt,I as Ht,o as ye,l as y,A as G,p as Ie,J as ne,B as ge,z as n,E as ht,C as le,F as qt,q as $e,G as At}from"../chunks/index.e99f61eb.js";import{g as Rt}from"../chunks/globals.7f7f1b26.js";import{c as _t,O as Jt,v as mt}from"../chunks/question.7d3532c1.js";import{A as Dt,N as Ot,S as gt,H as vt}from"../chunks/NavBar.adcb78d3.js";import{c as Ze,P as Ge,a as Ke,b as ze}from"../chunks/public.8bae8052.js";import{w as Fe}from"../chunks/index.0907e69b.js";const{console:Wt}=Rt,m="src/routes/ask/+page.svelte";function pt(s,e,a){const i=s.slice();return i[37]=e[a],i}function bt(s,e,a){const i=s.slice();return i[40]=e[a],i}function Ye(s){let e,a,i,f=s[40].chat_id+"",r,c,l,o,b,O,L;function N(){return s[17](s[40])}function j(){return s[18](s[40])}const H={c:function(){e=h("div"),a=h("span"),i=ye("Chat ID: "),r=ye(f),c=S(),l=h("button"),o=h("i"),b=S(),this.h()},l:function(p){e=_(p,"DIV",{class:!0});var E=y(e);a=_(E,"SPAN",{});var X=y(a);i=Ie(X,"Chat ID: "),r=Ie(X,f),X.forEach(v),c=A(E),l=_(E,"BUTTON",{class:!0});var K=y(l);o=_(K,"I",{class:!0}),y(o).forEach(v),K.forEach(v),b=A(E),E.forEach(v),this.h()},h:function(){d(a,m,266,14,6145),u(o,"class","fas fa-trash-alt"),d(o,m,272,16,6394),u(l,"class","btn btn-error btn-sm"),d(l,m,268,14,6251),u(e,"class","flex items-center justify-between mb-2"),d(e,m,262,12,5995)},m:function(p,E){ve(p,e,E),n(e,a),n(a,i),n(a,r),n(e,c),n(e,l),n(l,o),n(e,b),O||(L=[le(l,"click",N,!1,!1,!1,!1),le(e,"click",j,!1,!1,!1,!1)],O=!0)},p:function(p,E){s=p,E[0]&128&&f!==(f=s[40].chat_id+"")&&$e(r,f)},d:function(p){p&&v(e),O=!1,Ct(L)}};return pe("SvelteRegisterBlock",{block:H,id:Ye.name,type:"each",source:"(186:10) {#each $userChats as chat}",ctx:s}),H}function Pt(s){let e,a=xe(s[8]),i=[];for(let r=0;r<a.length;r+=1)i[r]=Qe(pt(s,a,r));const f={c:function(){e=h("div");for(let c=0;c<i.length;c+=1)i[c].c();this.h()},l:function(c){e=_(c,"DIV",{class:!0});var l=y(e);for(let o=0;o<i.length;o+=1)i[o].l(l);l.forEach(v),this.h()},h:function(){u(e,"class","chat-container overflow-y-auto h-96"),d(e,m,288,12,6878)},m:function(c,l){ve(c,e,l);for(let o=0;o<i.length;o+=1)i[o]&&i[o].m(e,null)},p:function(c,l){if(l[0]&256){a=xe(c[8]);let o;for(o=0;o<a.length;o+=1){const b=pt(c,a,o);i[o]?i[o].p(b,l):(i[o]=Qe(b),i[o].c(),i[o].m(e,null))}for(;o<i.length;o+=1)i[o].d(1);i.length=a.length}},d:function(c){c&&v(e),At(i,c)}};return pe("SvelteRegisterBlock",{block:f,id:Pt.name,type:"else",source:"(212:10) {:else}",ctx:s}),f}function Bt(s){let e,a="Select a chat from the history to view messages.";const i={c:function(){e=h("p"),e.textContent=a,this.h()},l:function(r){e=_(r,"P",{class:!0,"data-svelte-h":!0}),G(e)!=="svelte-ulna32"&&(e.textContent=a),this.h()},h:function(){u(e,"class","text-gray-500"),d(e,m,284,12,6742)},m:function(r,c){ve(r,e,c)},p:Tt,d:function(r){r&&v(e)}};return pe("SvelteRegisterBlock",{block:i,id:Bt.name,type:"if",source:"(208:10) {#if selectedChatId === null}",ctx:s}),i}function Qe(s){let e,a=s[37].message+"",i,f;const r={c:function(){e=h("div"),i=ye(a),f=S(),this.h()},l:function(l){e=_(l,"DIV",{class:!0});var o=y(e);i=Ie(o,a),f=A(o),o.forEach(v),this.h()},h:function(){u(e,"class","chat-message"),ne(e,"is-user-message",s[37].is_user_message),d(e,m,290,16,6999)},m:function(l,o){ve(l,e,o),n(e,i),n(e,f)},p:function(l,o){o[0]&256&&a!==(a=l[37].message+"")&&$e(i,a),o[0]&256&&ne(e,"is-user-message",l[37].is_user_message)},d:function(l){l&&v(e)}};return pe("SvelteRegisterBlock",{block:r,id:Qe.name,type:"each",source:"(214:14) {#each $selectedChatMessages as message}",ctx:s}),r}function Nt(s){let e,a,i,f,r,c,l="Chat History",o,b,O,L,N,j,H,I,p,E,X="Chat Messages",K,be,q,$,R,ce,V,he,ee,oe,D,J,ue="Configuration",fe,W,Se="Choose your model and temperature for asking questions.",we,z,te,Ae="Model",Ee,B,Z,De="tiiuae/falcon-7b-instruct",t,M="meta-llama/Llama-2-70b-chat-hf",w,_e="OpenAssistant/oasst-sft-4-pythia-12b-epoch-3.5",ie,T,se,et="Temperature",Ue,x,Le,me,Oe,je,F,tt="☰",He,Y,st="☰",ae,qe,at;a=new Ot({$$inline:!0});let Ce=xe(s[7]),P=[];for(let U=0;U<Ce.length;U+=1)P[U]=Ye(bt(s,Ce,U));function nt(U,g){return U[3]===null?Bt:Pt}let Pe=nt(s),Q=Pe(s);const lt={c:function(){e=h("div"),kt(a.$$.fragment),i=S(),f=h("div"),r=h("div"),c=h("h2"),c.textContent=l,o=S(),b=h("button"),O=h("i"),L=ye(" New Chat"),N=S(),j=h("div");for(let g=0;g<P.length;g+=1)P[g].c();H=S(),I=h("div"),p=h("div"),E=h("h1"),E.textContent=X,K=S(),Q.c(),be=S(),q=h("div"),$=h("div"),R=h("textarea"),ce=S(),V=h("button"),he=ye("Ask the AI and Send Message"),oe=S(),D=h("div"),J=h("h2"),J.textContent=ue,fe=S(),W=h("p"),W.textContent=Se,we=S(),z=h("div"),te=h("label"),te.textContent=Ae,Ee=S(),B=h("select"),Z=h("option"),Z.textContent=De,t=h("option"),t.textContent=M,w=h("option"),w.textContent=_e,ie=S(),T=h("div"),se=h("label"),se.textContent=et,Ue=S(),x=h("input"),Le=S(),me=h("span"),Oe=ye(s[1]),je=S(),F=h("div"),F.textContent=tt,He=S(),Y=h("div"),Y.textContent=st,this.h()},l:function(g){e=_(g,"DIV",{class:!0});var k=y(e);yt(a.$$.fragment,k),i=A(k),f=_(k,"DIV",{class:!0});var C=y(f);r=_(C,"DIV",{class:!0});var re=y(r);c=_(re,"H2",{class:!0,"data-svelte-h":!0}),G(c)!=="svelte-141gz04"&&(c.textContent=l),o=A(re),b=_(re,"BUTTON",{class:!0});var Re=y(b);O=_(Re,"I",{class:!0}),y(O).forEach(v),L=Ie(Re," New Chat"),Re.forEach(v),N=A(re),j=_(re,"DIV",{class:!0});var ot=y(j);for(let Je=0;Je<P.length;Je+=1)P[Je].l(ot);ot.forEach(v),re.forEach(v),H=A(C),I=_(C,"DIV",{class:!0});var Be=y(I);p=_(Be,"DIV",{class:!0});var Ne=y(p);E=_(Ne,"H1",{class:!0,"data-svelte-h":!0}),G(E)!=="svelte-fy4ok2"&&(E.textContent=X),K=A(Ne),Q.l(Ne),Ne.forEach(v),be=A(Be),q=_(Be,"DIV",{class:!0});var Ve=y(q);$=_(Ve,"DIV",{class:!0});var it=y($);R=_(it,"TEXTAREA",{id:!0,class:!0}),y(R).forEach(v),it.forEach(v),ce=A(Ve),V=_(Ve,"BUTTON",{class:!0});var rt=y(V);he=Ie(rt,"Ask the AI and Send Message"),rt.forEach(v),Ve.forEach(v),Be.forEach(v),oe=A(C),D=_(C,"DIV",{class:!0});var de=y(D);J=_(de,"H2",{class:!0,"data-svelte-h":!0}),G(J)!=="svelte-1ali85g"&&(J.textContent=ue),fe=A(de),W=_(de,"P",{class:!0,"data-svelte-h":!0}),G(W)!=="svelte-73zky"&&(W.textContent=Se),we=A(de),z=_(de,"DIV",{class:!0});var Me=y(z);te=_(Me,"LABEL",{for:!0,"data-svelte-h":!0}),G(te)!=="svelte-6cjlpw"&&(te.textContent=Ae),Ee=A(Me),B=_(Me,"SELECT",{id:!0,class:!0});var Te=y(B);Z=_(Te,"OPTION",{"data-svelte-h":!0}),G(Z)!=="svelte-m8jcxa"&&(Z.textContent=De),t=_(Te,"OPTION",{"data-svelte-h":!0}),G(t)!=="svelte-1hemkti"&&(t.textContent=M),w=_(Te,"OPTION",{"data-svelte-h":!0}),G(w)!=="svelte-1epjw1g"&&(w.textContent=_e),Te.forEach(v),Me.forEach(v),ie=A(de),T=_(de,"DIV",{class:!0});var ke=y(T);se=_(ke,"LABEL",{for:!0,"data-svelte-h":!0}),G(se)!=="svelte-11sobei"&&(se.textContent=et),Ue=A(ke),x=_(ke,"INPUT",{type:!0,id:!0,min:!0,max:!0,step:!0,class:!0}),Le=A(ke),me=_(ke,"SPAN",{class:!0});var ct=y(me);Oe=Ie(ct,s[1]),ct.forEach(v),ke.forEach(v),de.forEach(v),C.forEach(v),je=A(k),F=_(k,"DIV",{class:!0,"data-svelte-h":!0}),G(F)!=="svelte-si78np"&&(F.textContent=tt),He=A(k),Y=_(k,"DIV",{class:!0,"data-svelte-h":!0}),G(Y)!=="svelte-18gmth0"&&(Y.textContent=st),k.forEach(v),this.h()},h:function(){u(c,"class","text-2xl font-bold mb-4"),d(c,m,254,8,5656),u(O,"class","fas fa-plus"),d(O,m,257,10,5849),u(b,"class","btn btn-primary btn-sm mb-2"),d(b,m,256,8,5769),u(j,"class","overflow-y-auto h-96"),d(j,m,260,8,5911),u(r,"class","col-span-3 bg-gray-800 rounded-lg p-4 sidebar s-uhtJAkW7ZDek"),ne(r,"open",!s[6]&&s[4]),d(r,m,250,6,5514),u(E,"class","text-4xl font-bold mb-8"),d(E,m,282,10,6635),u(p,"class","col-span-6 s-uhtJAkW7ZDek"),d(p,m,281,8,6600),u(R,"id","question"),u(R,"class","textarea textarea-primary"),d(R,m,304,12,7374),u($,"class","form-control mb-4"),d($,m,303,10,7330),u(V,"class","btn btn-primary mb-4"),V.disabled=ee=s[3]===null,d(V,m,312,10,7615),u(q,"class","col-span-9"),d(q,m,302,8,7295),u(I,"class","col-span-6 s-uhtJAkW7ZDek"),d(I,m,280,6,6567),u(J,"class","text-2xl font-bold mb-4"),d(J,m,327,8,8067),u(W,"class","mb-4"),d(W,m,328,8,8130),u(te,"for","model"),d(te,m,332,10,8271),Z.__value="tiiuae/falcon-7b-instruct",ge(Z,Z.__value),d(Z,m,334,12,8393),t.__value="meta-llama/Llama-2-70b-chat-hf",ge(t,t.__value),d(t,m,337,12,8510),w.__value="OpenAssistant/oasst-sft-4-pythia-12b-epoch-3.5",ge(w,w.__value),d(w,m,340,12,8637),u(B,"id","model"),u(B,"class","input input-primary"),s[0]===void 0&&Mt(()=>s[21].call(B)),d(B,m,333,10,8314),u(z,"class","form-control"),d(z,m,331,8,8234),u(se,"for","temperature"),d(se,m,346,10,8869),u(x,"type","range"),u(x,"id","temperature"),u(x,"min","0.1"),u(x,"max","1.0"),u(x,"step","0.2"),u(x,"class","input input-primary"),d(x,m,347,10,8924),u(me,"class","text-sm ml-2"),d(me,m,356,10,9152),u(T,"class","form-control mt-4"),d(T,m,345,8,8827),u(D,"class","col-span-3 bg-gray-800 rounded-lg p-4 sidebar s-uhtJAkW7ZDek"),ne(D,"open",!s[6]&&s[5]),d(D,m,323,6,7923),u(f,"class","grid s-uhtJAkW7ZDek"),d(f,m,248,4,5446),u(F,"class","toggle-btn toggle-chat-history-btn s-uhtJAkW7ZDek"),ne(F,"visible",!s[6]||!s[4]),d(F,m,362,4,9289),u(Y,"class","toggle-btn toggle-configuration-btn s-uhtJAkW7ZDek"),ne(Y,"visible",!s[6]||!s[5]),d(Y,m,369,4,9483),u(e,"class","flex flex-col min-h-screen bg-gray-900 text-white p-4"),d(e,m,246,2,5359)},m:function(g,k){ve(g,e,k),It(a,e,null),n(e,i),n(e,f),n(f,r),n(r,c),n(r,o),n(r,b),n(b,O),n(b,L),n(r,N),n(r,j);for(let C=0;C<P.length;C+=1)P[C]&&P[C].m(j,null);n(f,H),n(f,I),n(I,p),n(p,E),n(p,K),Q.m(p,null),n(I,be),n(I,q),n(q,$),n($,R),ge(R,s[2]),n(q,ce),n(q,V),n(V,he),n(f,oe),n(f,D),n(D,J),n(D,fe),n(D,W),n(D,we),n(D,z),n(z,te),n(z,Ee),n(z,B),n(B,Z),n(B,t),n(B,w),ht(B,s[0],!0),n(D,ie),n(D,T),n(T,se),n(T,Ue),n(T,x),ge(x,s[1]),n(T,Le),n(T,me),n(me,Oe),n(e,je),n(e,F),n(e,He),n(e,Y),ae=!0,qe||(at=[le(b,"click",s[11],!1,!1,!1,!1),le(R,"input",s[19]),le(V,"click",s[20],!1,!1,!1,!1),le(B,"change",s[21]),le(x,"change",s[22]),le(x,"input",s[22]),le(F,"click",s[23],!1,!1,!1,!1),le(Y,"click",s[24],!1,!1,!1,!1)],qe=!0)},p:function(g,k){if(k[0]&24704){Ce=xe(g[7]);let C;for(C=0;C<Ce.length;C+=1){const re=bt(g,Ce,C);P[C]?P[C].p(re,k):(P[C]=Ye(re),P[C].c(),P[C].m(j,null))}for(;C<P.length;C+=1)P[C].d(1);P.length=Ce.length}(!ae||k[0]&80)&&ne(r,"open",!g[6]&&g[4]),Pe===(Pe=nt(g))&&Q?Q.p(g,k):(Q.d(1),Q=Pe(g),Q&&(Q.c(),Q.m(p,null))),k[0]&4&&ge(R,g[2]),(!ae||k[0]&8&&ee!==(ee=g[3]===null))&&qt(V,"disabled",ee),k[0]&1&&ht(B,g[0]),k[0]&2&&ge(x,g[1]),(!ae||k[0]&2)&&$e(Oe,g[1]),(!ae||k[0]&96)&&ne(D,"open",!g[6]&&g[5]),(!ae||k[0]&80)&&ne(F,"visible",!g[6]||!g[4]),(!ae||k[0]&96)&&ne(Y,"visible",!g[6]||!g[5])},i:function(g){ae||(wt(a.$$.fragment,g),ae=!0)},o:function(g){Et(a.$$.fragment,g),ae=!1},d:function(g){g&&v(e),St(a),At(P,g),Q.d(),qe=!1,Ct(at)}};return pe("SvelteRegisterBlock",{block:lt,id:Nt.name,type:"slot",source:"(170:0) <AuthCheck>",ctx:s}),lt}function Xe(s){let e,a,i,f;i=new Dt({props:{$$slots:{default:[Nt]},$$scope:{ctx:s}},$$inline:!0});const r={c:function(){e=h("link"),a=S(),kt(i.$$.fragment),this.h()},l:function(l){e=_(l,"LINK",{rel:!0,href:!0}),a=A(l),yt(i.$$.fragment,l),this.h()},h:function(){u(e,"rel","stylesheet"),u(e,"href","https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"),d(e,m,241,0,5228)},m:function(l,o){ve(l,e,o),ve(l,a,o),It(i,l,o),f=!0},p:function(l,o){const b={};o[0]&511|o[1]&4096&&(b.$$scope={dirty:o,ctx:l}),i.$set(b)},i:function(l){f||(wt(i.$$.fragment,l),f=!0)},o:function(l){Et(i.$$.fragment,l),f=!1},d:function(l){l&&(v(e),v(a)),St(i,l)}};return pe("SvelteRegisterBlock",{block:r,id:Xe.name,type:"component",source:"",ctx:s}),r}function Zt(s,e,a){let i,f,{$$slots:r={},$$scope:c}=e;Lt("Page",r,[]);const l=Ze(Ke,Ge);let o,b,O="tiiuae/falcon-7b-instruct",L=.2,N="",j="";const H=Fe([]);ut(H,"userChats"),ft(s,H,t=>a(7,i=t));const I=Fe([]);ut(I,"selectedChatMessages"),ft(s,I,t=>a(8,f=t));let p=null;async function E(){const t=await ce(),M=mt(),{data:w,error:_e}=await l.from("chats").insert([{user_id:t,chat_id:M,message:"",is_user_message:!0,timestamp:new Date().toISOString()}]);_e?console.error("Error creating new chat:",_e.message):H.update(ie=>[...ie,{chat_id:M}])}async function X(){const t=await ce(),{data:M,error:w}=await l.from("chats").select("chat_id").eq("user_id",t);if(w)console.error("Error fetching user chats:",w.message);else{const _e=M.reduce((ie,T)=>(ie.find(se=>se.chat_id===T.chat_id)||ie.push(T),ie),[]);H.set(_e)}}async function K(t){a(3,p=t);const{data:M,error:w}=await l.from("chats").select("message, is_user_message, timestamp").eq("chat_id",t).order("timestamp",{ascending:!0});w?console.error("Error fetching chat messages:",w.message):I.set(M)}async function be(t){console.log("userId",t),console.log("selectedChatId",p),console.log("question",N),console.log("timestamp",new Date().toISOString()),await l.from("chats").insert([{user_id:t,chat_id:p,message:N,is_user_message:!0,timestamp:new Date().toISOString()}]),K(p),await R(t)}async function q(){const t=await ce();console.log("userId",t),await be(t)}async function $(t,M){await l.from("chats").insert([{user_id:M,chat_id:p,message:t,is_user_message:!1,timestamp:new Date().toISOString()}]),K(p)}async function R(t){const M=Ze(Ke,Ge);b=new vt({apiKey:ze}),o=new gt(b,{client:M,tableName:"documents"});let w=await _t(ze,o,O,L,N);await $(w,t),a(2,N="")}async function ce(){const t=await l.auth.getUser();return t?t.data.user.id:null}function V(t){K(t)}async function he(t){const{data:M,error:w}=await l.from("chats").delete().eq("chat_id",t);w?console.error("Error deleting chat:",w.message):(await X(),I.set([]),a(3,p=null))}We(()=>{X()});let ee=!1,oe=!1;function D(){console.log("toggleChatHistorySidebar"),a(4,ee=!ee)}function J(){console.log("toggleConfigurationSidebar"),a(5,oe=!oe)}let ue=!1;const fe=window.matchMedia("(max-width: 768px)");function W(t){a(6,ue=t.matches)}We(()=>{a(6,ue=fe.matches),fe.addListener(W)}),dt(()=>{fe.removeListener(W)});const Se=[];Object.keys(e).forEach(t=>{!~Se.indexOf(t)&&t.slice(0,2)!=="$$"&&t!=="slot"&&Wt.warn(`<Page> was created with unknown prop '${t}'`)});const we=t=>he(t.chat_id),z=t=>V(t.chat_id);function te(){N=this.value,a(2,N)}const Ae=()=>q();function Ee(){O=jt(this),a(0,O)}function B(){L=Ht(this.value),a(1,L)}const Z=()=>D(),De=()=>J();return s.$capture_state=()=>({chatWithDoc:_t,AuthCheck:Dt,NavBar:Ot,onMount:We,onDestroy:dt,createClient:Ze,SupabaseVectorStore:gt,writable:Fe,HuggingFaceInferenceEmbeddings:vt,PUBLIC_SUPABASE_KEY:Ge,PUBLIC_SUPABASE_URL:Ke,PUBLIC_HUGGINGFACE_API_KEY:ze,OpenAIEmbeddings:Jt,uuidv4:mt,supabaseClient:l,vector:o,embeddings:b,model:O,temperature:L,question:N,responseText:j,userChats:H,selectedChatMessages:I,selectedChatId:p,createNewChat:E,loadUserChats:X,loadChatMessages:K,sendMessage:be,sendUserMessageAndAIResponse:q,saveAIResponse:$,getAIResponse:R,getCurrentUserId:ce,selectChat:V,deleteChat:he,isChatHistorySidebarOpen:ee,isConfigurationSidebarOpen:oe,toggleChatHistorySidebar:D,toggleConfigurationSidebar:J,isMobile:ue,mediaQuery:fe,handleMobileViewChange:W,$userChats:i,$selectedChatMessages:f}),s.$inject_state=t=>{"vector"in t&&(o=t.vector),"embeddings"in t&&(b=t.embeddings),"model"in t&&a(0,O=t.model),"temperature"in t&&a(1,L=t.temperature),"question"in t&&a(2,N=t.question),"responseText"in t&&(j=t.responseText),"selectedChatId"in t&&a(3,p=t.selectedChatId),"isChatHistorySidebarOpen"in t&&a(4,ee=t.isChatHistorySidebarOpen),"isConfigurationSidebarOpen"in t&&a(5,oe=t.isConfigurationSidebarOpen),"isMobile"in t&&a(6,ue=t.isMobile)},e&&"$$inject"in e&&s.$inject_state(e.$$inject),[O,L,N,p,ee,oe,ue,i,f,H,I,E,q,V,he,D,J,we,z,te,Ae,Ee,B,Z,De]}class $t extends xt{constructor(e){super(e),Ut(this,e,Zt,Xe,Vt,{},null,[-1,-1]),pe("SvelteRegisterComponent",{component:this,tagName:"Page",options:e,id:Xe.name})}}export{$t as component};
