import{s as safe_not_equal,o as onMount,d as add_location,r as run_all}from"../chunks/scheduler.2364b0ad.js";import{S as SvelteComponentDev,i as init,d as dispatch_dev,v as validate_slots,u as create_component,w as claim_component,x as mount_component,f as transition_in,t as transition_out,y as destroy_component,j as element,s as space,k as claim_element,l as children,c as claim_space,A as get_svelte_dataset,g as detach_dev,m as attr_dev,a as insert_hydration_dev,z as append_hydration_dev,F as set_input_value,B as listen_dev,o as text,p as claim_text,q as set_data_dev}from"../chunks/index.be5c2245.js";import{a as Serializable,D as Document,O as OpenAIEmbeddings,S as SupabaseVectorStore,m as getEnv,A as AuthCheck,N as NavBar}from"../chunks/NavBar.9cc01a6e.js";import{c as commonjsRequire}from"../chunks/_commonjs-dynamic-modules.6fed1697.js";import{f as getAugmentedNamespace,e as commonjsGlobal,c as createClient,P as PUBLIC_SUPABASE_KEY,a as PUBLIC_SUPABASE_URL,d as PUBLIC_OPENAI_API_KEY,_ as __vitePreload,b as PUBLIC_HUGGINGFACE_API_KEY}from"../chunks/public.41f5b175.js";class BaseDocumentTransformer extends Serializable{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","document_transformers"]})}}class TextSplitter extends BaseDocumentTransformer{constructor(n){if(super(n),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","document_transformers","text_splitters"]}),Object.defineProperty(this,"chunkSize",{enumerable:!0,configurable:!0,writable:!0,value:1e3}),Object.defineProperty(this,"chunkOverlap",{enumerable:!0,configurable:!0,writable:!0,value:200}),Object.defineProperty(this,"keepSeparator",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lengthFunction",{enumerable:!0,configurable:!0,writable:!0,value:o=>o.length}),this.chunkSize=(n==null?void 0:n.chunkSize)??this.chunkSize,this.chunkOverlap=(n==null?void 0:n.chunkOverlap)??this.chunkOverlap,this.keepSeparator=(n==null?void 0:n.keepSeparator)??this.keepSeparator,this.lengthFunction=(n==null?void 0:n.lengthFunction)??(o=>o.length),this.chunkOverlap>=this.chunkSize)throw new Error("Cannot have chunkOverlap >= chunkSize")}async transformDocuments(n,o={}){return this.splitDocuments(n,o)}splitOnSeparator(n,o){let t;if(o)if(this.keepSeparator){const h=o.replace(/[/\-\\^$*+?.()|[\]{}]/g,"\\$&");t=n.split(new RegExp(`(?=${h})`))}else t=n.split(o);else t=n.split("");return t.filter(h=>h!=="")}async createDocuments(n,o=[],t={}){const h=o.length>0?o:new Array(n.length).fill({}),{chunkHeader:p="",chunkOverlapHeader:S="(cont'd) ",appendChunkOverlapHeader:m=!1}=t,b=new Array;for(let f=0;f<n.length;f+=1){const _=n[f];let x=1,E=null;for(const A of await this.splitText(_)){let F=p,u=0;if(E){const w=_.indexOf(A),s=_.indexOf(E)+this.lengthFunction(E);u=(_.slice(s,w).match(/\n/g)||[]).length,m&&(F+=S)}x+=u;const R=(A.match(/\n/g)||[]).length,B=h[f].loc&&typeof h[f].loc=="object"?{...h[f].loc}:{};B.lines={from:x,to:x+R};const I={...h[f],loc:B};F+=A,b.push(new Document({pageContent:F,metadata:I})),x+=R,E=A}}return b}async splitDocuments(n,o={}){const t=n.filter(S=>S.pageContent!==void 0),h=t.map(S=>S.pageContent),p=t.map(S=>S.metadata);return this.createDocuments(h,p,o)}joinDocs(n,o){const t=n.join(o).trim();return t===""?null:t}mergeSplits(n,o){const t=[],h=[];let p=0;for(const m of n){const b=this.lengthFunction(m);if(p+b+(h.length>0?o.length:0)>this.chunkSize&&(p>this.chunkSize&&console.warn(`Created a chunk of size ${p}, +
which is longer than the specified ${this.chunkSize}`),h.length>0)){const f=this.joinDocs(h,o);for(f!==null&&t.push(f);p>this.chunkOverlap||p+b>this.chunkSize&&p>0;)p-=this.lengthFunction(h[0]),h.shift()}h.push(m),p+=b}const S=this.joinDocs(h,o);return S!==null&&t.push(S),t}}class RecursiveCharacterTextSplitter extends TextSplitter{constructor(n){super(n),Object.defineProperty(this,"separators",{enumerable:!0,configurable:!0,writable:!0,value:[`

`,`
`," ",""]}),this.separators=(n==null?void 0:n.separators)??this.separators,this.keepSeparator=(n==null?void 0:n.keepSeparator)??!0}async _splitText(n,o){const t=[];let h=o[o.length-1],p;for(let f=0;f<o.length;f+=1){const _=o[f];if(_===""){h=_;break}if(n.includes(_)){h=_,p=o.slice(f+1);break}}const S=this.splitOnSeparator(n,h);let m=[];const b=this.keepSeparator?"":h;for(const f of S)if(this.lengthFunction(f)<this.chunkSize)m.push(f);else{if(m.length){const _=this.mergeSplits(m,b);t.push(..._),m=[]}if(!p)t.push(f);else{const _=await this._splitText(f,p);t.push(..._)}}if(m.length){const f=this.mergeSplits(m,b);t.push(...f)}return t}async splitText(n){return this._splitText(n,this.separators)}static fromLanguage(n,o){return new RecursiveCharacterTextSplitter({...o,separators:RecursiveCharacterTextSplitter.getSeparatorsForLanguage(n)})}static getSeparatorsForLanguage(n){if(n==="cpp")return[`
class `,`
void `,`
int `,`
float `,`
double `,`
if `,`
for `,`
while `,`
switch `,`
case `,`

`,`
`," ",""];if(n==="go")return[`
func `,`
var `,`
const `,`
type `,`
if `,`
for `,`
switch `,`
case `,`

`,`
`," ",""];if(n==="java")return[`
class `,`
public `,`
protected `,`
private `,`
static `,`
if `,`
for `,`
while `,`
switch `,`
case `,`

`,`
`," ",""];if(n==="js")return[`
function `,`
const `,`
let `,`
var `,`
class `,`
if `,`
for `,`
while `,`
switch `,`
case `,`
default `,`

`,`
`," ",""];if(n==="php")return[`
function `,`
class `,`
if `,`
foreach `,`
while `,`
do `,`
switch `,`
case `,`

`,`
`," ",""];if(n==="proto")return[`
message `,`
service `,`
enum `,`
option `,`
import `,`
syntax `,`

`,`
`," ",""];if(n==="python")return[`
class `,`
def `,`
	def `,`

`,`
`," ",""];if(n==="rst")return[`
===
`,`
---
`,`
***
`,`
.. `,`

`,`
`," ",""];if(n==="ruby")return[`
def `,`
class `,`
if `,`
unless `,`
while `,`
for `,`
do `,`
begin `,`
rescue `,`

`,`
`," ",""];if(n==="rust")return[`
fn `,`
const `,`
let `,`
if `,`
while `,`
for `,`
loop `,`
match `,`
const `,`

`,`
`," ",""];if(n==="scala")return[`
class `,`
object `,`
def `,`
val `,`
var `,`
if `,`
for `,`
while `,`
match `,`
case `,`

`,`
`," ",""];if(n==="swift")return[`
func `,`
class `,`
struct `,`
enum `,`
if `,`
for `,`
while `,`
do `,`
switch `,`
case `,`

`,`
`," ",""];if(n==="markdown")return[`
## `,`
### `,`
#### `,`
##### `,`
###### `,"```\n\n",`

***

`,`

---

`,`

___

`,`

`,`
`," ",""];if(n==="latex")return[`
\\chapter{`,`
\\section{`,`
\\subsection{`,`
\\subsubsection{`,`
\\begin{enumerate}`,`
\\begin{itemize}`,`
\\begin{description}`,`
\\begin{list}`,`
\\begin{quote}`,`
\\begin{quotation}`,`
\\begin{verse}`,`
\\begin{verbatim}`,`
\\begin{align}`,"$$","$",`

`,`
`," ",""];if(n==="html")return["<body>","<div>","<p>","<br>","<li>","<h1>","<h2>","<h3>","<h4>","<h5>","<h6>","<span>","<table>","<tr>","<td>","<th>","<ul>","<ol>","<header>","<footer>","<nav>","<head>","<style>","<script>","<meta>","<title>"," ",""];if(n==="sol")return[`
pragma `,`
using `,`
contract `,`
interface `,`
library `,`
constructor `,`
type `,`
function `,`
event `,`
modifier `,`
error `,`
struct `,`
enum `,`
if `,`
for `,`
while `,`
do while `,`
assembly `,`

`,`
`," ",""];throw new Error(`Language ${n} is not supported.`)}}async function computeSHA1FromFile(G){const o=await(await fetch(G)).arrayBuffer(),t=await crypto.subtle.digest("SHA-1",o),p=Array.from(new Uint8Array(t)).map(S=>S.toString(16).padStart(2,"0")).join("");return console.log("readableHash from computeSHA1FromFile: ",p),p}async function computeSHA1FromContent$1(G){const o=new TextEncoder().encode(G),t=await crypto.subtle.digest("SHA-1",o),p=Array.from(new Uint8Array(t)).map(S=>S.toString(16).padStart(2,"0")).join("");return console.log("readableHash from computeSHA1FromContent: ",p),p}var pdf={exports:{}};const __viteBrowserExternal=new Proxy({},{get(G,n){throw new Error(`Module "" has been externalized for browser compatibility. Cannot access ".${n}" in client code.  See http://vitejs.dev/guide/troubleshooting.html#module-externalized-for-browser-compatibility for more details.`)}}),__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);(function(module,exports){(function(n,o){module.exports=o()})(commonjsGlobal,function(){return(()=>{var __webpack_modules__=[,(G,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.addLinkAttributes=R,n.deprecated=y,n.getFilenameFromUrl=w,n.getPdfFilenameFromUrl=s,n.getXfaPageViewport=Q,n.isDataScheme=B,n.isPdfFile=I,n.isValidFetchUrl=g,n.loadScript=v,n.StatTimer=n.RenderingCancelledException=n.PixelsPerInch=n.PDFDateString=n.PageViewport=n.LinkTarget=n.DOMSVGFactory=n.DOMStandardFontDataFactory=n.DOMCMapReaderFactory=n.DOMCanvasFactory=void 0;var t=o(2),h=o(5);const p="noopener noreferrer nofollow",S="http://www.w3.org/2000/svg",m={CSS:96,PDF:72,get PDF_TO_CSS_UNITS(){return(0,t.shadow)(this,"PDF_TO_CSS_UNITS",this.CSS/this.PDF)}};n.PixelsPerInch=m;class b extends h.BaseCanvasFactory{constructor({ownerDocument:k=globalThis.document}={}){super(),this._document=k}_createCanvas(k,L){const H=this._document.createElement("canvas");return H.width=k,H.height=L,H}}n.DOMCanvasFactory=b;async function f(V,k=!1){if(g(V,document.baseURI)){const L=await fetch(V);if(!L.ok)throw new Error(L.statusText);return k?new Uint8Array(await L.arrayBuffer()):(0,t.stringToBytes)(await L.text())}return new Promise((L,H)=>{const q=new XMLHttpRequest;q.open("GET",V,!0),k&&(q.responseType="arraybuffer"),q.onreadystatechange=()=>{if(q.readyState===XMLHttpRequest.DONE){if(q.status===200||q.status===0){let W;if(k&&q.response?W=new Uint8Array(q.response):!k&&q.responseText&&(W=(0,t.stringToBytes)(q.responseText)),W){L(W);return}}H(new Error(q.statusText))}},q.send(null)})}class _ extends h.BaseCMapReaderFactory{_fetchData(k,L){return f(k,this.isCompressed).then(H=>({cMapData:H,compressionType:L}))}}n.DOMCMapReaderFactory=_;class x extends h.BaseStandardFontDataFactory{_fetchData(k){return f(k,!0)}}n.DOMStandardFontDataFactory=x;class E extends h.BaseSVGFactory{_createSVG(k){return document.createElementNS(S,k)}}n.DOMSVGFactory=E;class A{constructor({viewBox:k,scale:L,rotation:H,offsetX:q=0,offsetY:W=0,dontFlip:K=!1}){this.viewBox=k,this.scale=L,this.rotation=H,this.offsetX=q,this.offsetY=W;const T=(k[2]+k[0])/2,c=(k[3]+k[1])/2;let e,r,i,d;switch(H%=360,H<0&&(H+=360),H){case 180:e=-1,r=0,i=0,d=1;break;case 90:e=0,r=1,i=1,d=0;break;case 270:e=0,r=-1,i=-1,d=0;break;case 0:e=1,r=0,i=0,d=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}K&&(i=-i,d=-d);let l,C,P,N;e===0?(l=Math.abs(c-k[1])*L+q,C=Math.abs(T-k[0])*L+W,P=Math.abs(k[3]-k[1])*L,N=Math.abs(k[2]-k[0])*L):(l=Math.abs(T-k[0])*L+q,C=Math.abs(c-k[1])*L+W,P=Math.abs(k[2]-k[0])*L,N=Math.abs(k[3]-k[1])*L),this.transform=[e*L,r*L,i*L,d*L,l-e*L*T-i*L*c,C-r*L*T-d*L*c],this.width=P,this.height=N}clone({scale:k=this.scale,rotation:L=this.rotation,offsetX:H=this.offsetX,offsetY:q=this.offsetY,dontFlip:W=!1}={}){return new A({viewBox:this.viewBox.slice(),scale:k,rotation:L,offsetX:H,offsetY:q,dontFlip:W})}convertToViewportPoint(k,L){return t.Util.applyTransform([k,L],this.transform)}convertToViewportRectangle(k){const L=t.Util.applyTransform([k[0],k[1]],this.transform),H=t.Util.applyTransform([k[2],k[3]],this.transform);return[L[0],L[1],H[0],H[1]]}convertToPdfPoint(k,L){return t.Util.applyInverseTransform([k,L],this.transform)}}n.PageViewport=A;class F extends t.BaseException{constructor(k,L){super(k,"RenderingCancelledException"),this.type=L}}n.RenderingCancelledException=F;const u={NONE:0,SELF:1,BLANK:2,PARENT:3,TOP:4};n.LinkTarget=u;function R(V,{url:k,target:L,rel:H,enabled:q=!0}={}){(0,t.assert)(k&&typeof k=="string",'addLinkAttributes: A valid "url" parameter must provided.');const W=(0,t.removeNullCharacters)(k);q?V.href=V.title=W:(V.href="",V.title=`Disabled: ${W}`,V.onclick=()=>!1);let K="";switch(L){case u.NONE:break;case u.SELF:K="_self";break;case u.BLANK:K="_blank";break;case u.PARENT:K="_parent";break;case u.TOP:K="_top";break}V.target=K,V.rel=typeof H=="string"?H:p}function B(V){const k=V.length;let L=0;for(;L<k&&V[L].trim()==="";)L++;return V.substring(L,L+5).toLowerCase()==="data:"}function I(V){return typeof V=="string"&&/\.pdf$/i.test(V)}function w(V){const k=V.indexOf("#"),L=V.indexOf("?"),H=Math.min(k>0?k:V.length,L>0?L:V.length);return V.substring(V.lastIndexOf("/",H)+1,H)}function s(V,k="document.pdf"){if(typeof V!="string")return k;if(B(V))return(0,t.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),k;const L=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,H=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,q=L.exec(V);let W=H.exec(q[1])||H.exec(q[2])||H.exec(q[3]);if(W&&(W=W[0],W.includes("%")))try{W=H.exec(decodeURIComponent(W))[0]}catch{}return W||k}class a{constructor(){this.started=Object.create(null),this.times=[]}time(k){k in this.started&&(0,t.warn)(`Timer is already running for ${k}`),this.started[k]=Date.now()}timeEnd(k){k in this.started||(0,t.warn)(`Timer has not been started for ${k}`),this.times.push({name:k,start:this.started[k],end:Date.now()}),delete this.started[k]}toString(){const k=[];let L=0;for(const H of this.times){const q=H.name;q.length>L&&(L=q.length)}for(const H of this.times){const q=H.end-H.start;k.push(`${H.name.padEnd(L)} ${q}ms
`)}return k.join("")}}n.StatTimer=a;function g(V,k){try{const{protocol:L}=k?new URL(V,k):new URL(V);return L==="http:"||L==="https:"}catch{return!1}}function v(V,k=!1){return new Promise((L,H)=>{const q=document.createElement("script");q.src=V,q.onload=function(W){k&&q.remove(),L(W)},q.onerror=function(){H(new Error(`Cannot load script at: ${q.src}`))},(document.head||document.documentElement).appendChild(q)})}function y(V){console.log("Deprecated API usage: "+V)}let O;class M{static toDateObject(k){if(!k||!(0,t.isString)(k))return null;O||(O=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const L=O.exec(k);if(!L)return null;const H=parseInt(L[1],10);let q=parseInt(L[2],10);q=q>=1&&q<=12?q-1:0;let W=parseInt(L[3],10);W=W>=1&&W<=31?W:1;let K=parseInt(L[4],10);K=K>=0&&K<=23?K:0;let T=parseInt(L[5],10);T=T>=0&&T<=59?T:0;let c=parseInt(L[6],10);c=c>=0&&c<=59?c:0;const e=L[7]||"Z";let r=parseInt(L[8],10);r=r>=0&&r<=23?r:0;let i=parseInt(L[9],10)||0;return i=i>=0&&i<=59?i:0,e==="-"?(K+=r,T+=i):e==="+"&&(K-=r,T-=i),new Date(Date.UTC(H,q,W,K,T,c))}}n.PDFDateString=M;function Q(V,{scale:k=1,rotation:L=0}){const{width:H,height:q}=V.attributes.style,W=[0,0,parseInt(H),parseInt(q)];return new A({viewBox:W,scale:k,rotation:L})}},(G,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.arrayByteLength=ie,n.arraysToBytes=se,n.assert=K,n.bytesToString=J,n.createObjectURL=Le,n.createPromiseCapability=Oe,n.createValidAbsoluteUrl=e,n.escapeString=Ae,n.getModificationDate=Re,n.getVerbosityLevel=L,n.info=H,n.isArrayBuffer=Te,n.isArrayEqual=Fe,n.isAscii=_e,n.isBool=Pe,n.isNum=Ee,n.isSameOrigin=T,n.isString=ke,n.objectFromMap=de,n.objectSize=ne,n.removeNullCharacters=X,n.setVerbosityLevel=k,n.shadow=r,n.string32=ae,n.stringToBytes=Z,n.stringToPDFString=ge,n.stringToUTF16BEString=ye,n.stringToUTF8String=ue,n.unreachable=W,n.utf8StringToString=Ce,n.warn=q,n.VerbosityLevel=n.Util=n.UNSUPPORTED_FEATURES=n.UnknownErrorException=n.UnexpectedResponseException=n.TextRenderingMode=n.StreamType=n.RenderingIntentFlag=n.PermissionFlag=n.PasswordResponses=n.PasswordException=n.PageActionEventType=n.OPS=n.MissingPDFException=n.IsLittleEndianCached=n.IsEvalSupportedCached=n.InvalidPDFException=n.ImageKind=n.IDENTITY_MATRIX=n.FormatError=n.FontType=n.FONT_IDENTITY_MATRIX=n.DocumentActionEventType=n.CMapCompressionType=n.BaseException=n.AnnotationType=n.AnnotationStateModelType=n.AnnotationReviewState=n.AnnotationReplyType=n.AnnotationMode=n.AnnotationMarkedState=n.AnnotationFlag=n.AnnotationFieldFlag=n.AnnotationBorderStyleType=n.AnnotationActionEventType=n.AbortException=void 0,o(3);const t=[1,0,0,1,0,0];n.IDENTITY_MATRIX=t;const h=[.001,0,0,.001,0,0];n.FONT_IDENTITY_MATRIX=h;const p={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};n.RenderingIntentFlag=p;const S={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};n.AnnotationMode=S;const m={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};n.PermissionFlag=m;const b={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};n.TextRenderingMode=b;const f={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};n.ImageKind=f;const _={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};n.AnnotationType=_;const x={MARKED:"Marked",REVIEW:"Review"};n.AnnotationStateModelType=x;const E={MARKED:"Marked",UNMARKED:"Unmarked"};n.AnnotationMarkedState=E;const A={ACCEPTED:"Accepted",REJECTED:"Rejected",CANCELLED:"Cancelled",COMPLETED:"Completed",NONE:"None"};n.AnnotationReviewState=A;const F={GROUP:"Group",REPLY:"R"};n.AnnotationReplyType=F;const u={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};n.AnnotationFlag=u;const R={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};n.AnnotationFieldFlag=R;const B={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};n.AnnotationBorderStyleType=B;const I={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};n.AnnotationActionEventType=I;const w={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};n.DocumentActionEventType=w;const s={O:"PageOpen",C:"PageClose"};n.PageActionEventType=s;const a={UNKNOWN:"UNKNOWN",FLATE:"FLATE",LZW:"LZW",DCT:"DCT",JPX:"JPX",JBIG:"JBIG",A85:"A85",AHX:"AHX",CCF:"CCF",RLX:"RLX"};n.StreamType=a;const g={UNKNOWN:"UNKNOWN",TYPE1:"TYPE1",TYPE1STANDARD:"TYPE1STANDARD",TYPE1C:"TYPE1C",CIDFONTTYPE0:"CIDFONTTYPE0",CIDFONTTYPE0C:"CIDFONTTYPE0C",TRUETYPE:"TRUETYPE",CIDFONTTYPE2:"CIDFONTTYPE2",TYPE3:"TYPE3",OPENTYPE:"OPENTYPE",TYPE0:"TYPE0",MMTYPE1:"MMTYPE1"};n.FontType=g;const v={ERRORS:0,WARNINGS:1,INFOS:5};n.VerbosityLevel=v;const y={NONE:0,BINARY:1,STREAM:2};n.CMapCompressionType=y;const O={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotations:78,endAnnotations:79,beginAnnotation:80,endAnnotation:81,paintJpegXObject:82,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};n.OPS=O;const M={unknown:"unknown",forms:"forms",javaScript:"javaScript",signatures:"signatures",smask:"smask",shadingPattern:"shadingPattern",font:"font",errorTilingPattern:"errorTilingPattern",errorExtGState:"errorExtGState",errorXObject:"errorXObject",errorFontLoadType3:"errorFontLoadType3",errorFontState:"errorFontState",errorFontMissing:"errorFontMissing",errorFontTranslate:"errorFontTranslate",errorColorSpace:"errorColorSpace",errorOperatorList:"errorOperatorList",errorFontToUnicode:"errorFontToUnicode",errorFontLoadNative:"errorFontLoadNative",errorFontBuildPath:"errorFontBuildPath",errorFontGetPath:"errorFontGetPath",errorMarkedContent:"errorMarkedContent",errorContentSubStream:"errorContentSubStream"};n.UNSUPPORTED_FEATURES=M;const Q={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};n.PasswordResponses=Q;let V=v.WARNINGS;function k(Y){Number.isInteger(Y)&&(V=Y)}function L(){return V}function H(Y){V>=v.INFOS&&console.log(`Info: ${Y}`)}function q(Y){V>=v.WARNINGS&&console.log(`Warning: ${Y}`)}function W(Y){throw new Error(Y)}function K(Y,U){Y||W(U)}function T(Y,U){let z;try{if(z=new URL(Y),!z.origin||z.origin==="null")return!1}catch{return!1}const te=new URL(U,z);return z.origin===te.origin}function c(Y){if(!Y)return!1;switch(Y.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function e(Y,U=null,z=null){if(!Y)return null;try{if(z&&typeof Y=="string"){if(z.addDefaultProtocol&&Y.startsWith("www.")){const re=Y.match(/\./g);re&&re.length>=2&&(Y=`http://${Y}`)}if(z.tryConvertEncoding)try{Y=ue(Y)}catch{}}const te=U?new URL(Y,U):new URL(Y);if(c(te))return te}catch{}return null}function r(Y,U,z){return Object.defineProperty(Y,U,{value:z,enumerable:!0,configurable:!0,writable:!1}),z}const i=function(){function U(z,te){this.constructor===U&&W("Cannot initialize BaseException."),this.message=z,this.name=te}return U.prototype=new Error,U.constructor=U,U}();n.BaseException=i;class d extends i{constructor(U,z){super(U,"PasswordException"),this.code=z}}n.PasswordException=d;class l extends i{constructor(U,z){super(U,"UnknownErrorException"),this.details=z}}n.UnknownErrorException=l;class C extends i{constructor(U){super(U,"InvalidPDFException")}}n.InvalidPDFException=C;class P extends i{constructor(U){super(U,"MissingPDFException")}}n.MissingPDFException=P;class N extends i{constructor(U,z){super(U,"UnexpectedResponseException"),this.status=z}}n.UnexpectedResponseException=N;class j extends i{constructor(U){super(U,"FormatError")}}n.FormatError=j;class D extends i{constructor(U){super(U,"AbortException")}}n.AbortException=D;const $=/\x00/g;function X(Y){return typeof Y!="string"?(q("The argument for removeNullCharacters must be a string."),Y):Y.replace($,"")}function J(Y){K(Y!==null&&typeof Y=="object"&&Y.length!==void 0,"Invalid argument for bytesToString");const U=Y.length,z=8192;if(U<z)return String.fromCharCode.apply(null,Y);const te=[];for(let re=0;re<U;re+=z){const oe=Math.min(re+z,U),ce=Y.subarray(re,oe);te.push(String.fromCharCode.apply(null,ce))}return te.join("")}function Z(Y){K(typeof Y=="string","Invalid argument for stringToBytes");const U=Y.length,z=new Uint8Array(U);for(let te=0;te<U;++te)z[te]=Y.charCodeAt(te)&255;return z}function ie(Y){return Y.length!==void 0?Y.length:(K(Y.byteLength!==void 0,"arrayByteLength - invalid argument."),Y.byteLength)}function se(Y){const U=Y.length;if(U===1&&Y[0]instanceof Uint8Array)return Y[0];let z=0;for(let oe=0;oe<U;oe++)z+=ie(Y[oe]);let te=0;const re=new Uint8Array(z);for(let oe=0;oe<U;oe++){let ce=Y[oe];ce instanceof Uint8Array||(typeof ce=="string"?ce=Z(ce):ce=new Uint8Array(ce));const Se=ce.byteLength;re.set(ce,te),te+=Se}return re}function ae(Y){return String.fromCharCode(Y>>24&255,Y>>16&255,Y>>8&255,Y&255)}function ne(Y){return Object.keys(Y).length}function de(Y){const U=Object.create(null);for(const[z,te]of Y)U[z]=te;return U}function he(){const Y=new Uint8Array(4);return Y[0]=1,new Uint32Array(Y.buffer,0,1)[0]===1}const ee={get value(){return r(this,"value",he())}};n.IsLittleEndianCached=ee;function le(){try{return new Function(""),!0}catch{return!1}}const me={get value(){return r(this,"value",le())}};n.IsEvalSupportedCached=me;const pe=[...Array(256).keys()].map(Y=>Y.toString(16).padStart(2,"0"));class fe{static makeHexColor(U,z,te){return`#${pe[U]}${pe[z]}${pe[te]}`}static transform(U,z){return[U[0]*z[0]+U[2]*z[1],U[1]*z[0]+U[3]*z[1],U[0]*z[2]+U[2]*z[3],U[1]*z[2]+U[3]*z[3],U[0]*z[4]+U[2]*z[5]+U[4],U[1]*z[4]+U[3]*z[5]+U[5]]}static applyTransform(U,z){const te=U[0]*z[0]+U[1]*z[2]+z[4],re=U[0]*z[1]+U[1]*z[3]+z[5];return[te,re]}static applyInverseTransform(U,z){const te=z[0]*z[3]-z[1]*z[2],re=(U[0]*z[3]-U[1]*z[2]+z[2]*z[5]-z[4]*z[3])/te,oe=(-U[0]*z[1]+U[1]*z[0]+z[4]*z[1]-z[5]*z[0])/te;return[re,oe]}static getAxialAlignedBoundingBox(U,z){const te=fe.applyTransform(U,z),re=fe.applyTransform(U.slice(2,4),z),oe=fe.applyTransform([U[0],U[3]],z),ce=fe.applyTransform([U[2],U[1]],z);return[Math.min(te[0],re[0],oe[0],ce[0]),Math.min(te[1],re[1],oe[1],ce[1]),Math.max(te[0],re[0],oe[0],ce[0]),Math.max(te[1],re[1],oe[1],ce[1])]}static inverseTransform(U){const z=U[0]*U[3]-U[1]*U[2];return[U[3]/z,-U[1]/z,-U[2]/z,U[0]/z,(U[2]*U[5]-U[4]*U[3])/z,(U[4]*U[1]-U[5]*U[0])/z]}static apply3dTransform(U,z){return[U[0]*z[0]+U[1]*z[1]+U[2]*z[2],U[3]*z[0]+U[4]*z[1]+U[5]*z[2],U[6]*z[0]+U[7]*z[1]+U[8]*z[2]]}static singularValueDecompose2dScale(U){const z=[U[0],U[2],U[1],U[3]],te=U[0]*z[0]+U[1]*z[2],re=U[0]*z[1]+U[1]*z[3],oe=U[2]*z[0]+U[3]*z[2],ce=U[2]*z[1]+U[3]*z[3],Se=(te+ce)/2,ve=Math.sqrt((te+ce)**2-4*(te*ce-oe*re))/2,xe=Se+ve||1,we=Se-ve||1;return[Math.sqrt(xe),Math.sqrt(we)]}static normalizeRect(U){const z=U.slice(0);return U[0]>U[2]&&(z[0]=U[2],z[2]=U[0]),U[1]>U[3]&&(z[1]=U[3],z[3]=U[1]),z}static intersect(U,z){function te(Se,ve){return Se-ve}const re=[U[0],U[2],z[0],z[2]].sort(te),oe=[U[1],U[3],z[1],z[3]].sort(te),ce=[];if(U=fe.normalizeRect(U),z=fe.normalizeRect(z),re[0]===U[0]&&re[1]===z[0]||re[0]===z[0]&&re[1]===U[0])ce[0]=re[1],ce[2]=re[2];else return null;if(oe[0]===U[1]&&oe[1]===z[1]||oe[0]===z[1]&&oe[1]===U[1])ce[1]=oe[1],ce[3]=oe[2];else return null;return ce}}n.Util=fe;const be=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function ge(Y){const U=Y.length,z=[];if(Y[0]==="þ"&&Y[1]==="ÿ")for(let te=2;te<U;te+=2)z.push(String.fromCharCode(Y.charCodeAt(te)<<8|Y.charCodeAt(te+1)));else if(Y[0]==="ÿ"&&Y[1]==="þ")for(let te=2;te<U;te+=2)z.push(String.fromCharCode(Y.charCodeAt(te+1)<<8|Y.charCodeAt(te)));else for(let te=0;te<U;++te){const re=be[Y.charCodeAt(te)];z.push(re?String.fromCharCode(re):Y.charAt(te))}return z.join("")}function Ae(Y){return Y.replace(/([()\\\n\r])/g,U=>U===`
`?"\\n":U==="\r"?"\\r":`\\${U}`)}function _e(Y){return/^[\x00-\x7F]*$/.test(Y)}function ye(Y){const U=["þÿ"];for(let z=0,te=Y.length;z<te;z++){const re=Y.charCodeAt(z);U.push(String.fromCharCode(re>>8&255),String.fromCharCode(re&255))}return U.join("")}function ue(Y){return decodeURIComponent(escape(Y))}function Ce(Y){return unescape(encodeURIComponent(Y))}function Pe(Y){return typeof Y=="boolean"}function Ee(Y){return typeof Y=="number"}function ke(Y){return typeof Y=="string"}function Te(Y){return typeof Y=="object"&&Y!==null&&Y.byteLength!==void 0}function Fe(Y,U){if(Y.length!==U.length)return!1;for(let z=0,te=Y.length;z<te;z++)if(Y[z]!==U[z])return!1;return!0}function Re(Y=new Date){return[Y.getUTCFullYear().toString(),(Y.getUTCMonth()+1).toString().padStart(2,"0"),Y.getUTCDate().toString().padStart(2,"0"),Y.getUTCHours().toString().padStart(2,"0"),Y.getUTCMinutes().toString().padStart(2,"0"),Y.getUTCSeconds().toString().padStart(2,"0")].join("")}function Oe(){const Y=Object.create(null);let U=!1;return Object.defineProperty(Y,"settled",{get(){return U}}),Y.promise=new Promise(function(z,te){Y.resolve=function(re){U=!0,z(re)},Y.reject=function(re){U=!0,te(re)}}),Y}function Le(Y,U="",z=!1){if(URL.createObjectURL&&!z)return URL.createObjectURL(new Blob([Y],{type:U}));const te="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let re=`data:${U};base64,`;for(let oe=0,ce=Y.length;oe<ce;oe+=3){const Se=Y[oe]&255,ve=Y[oe+1]&255,xe=Y[oe+2]&255,we=Se>>2,Me=(Se&3)<<4|ve>>4,De=oe+1<ce?(ve&15)<<2|xe>>6:64,Ie=oe+2<ce?xe&63:64;re+=te[we]+te[Me]+te[De]+te[Ie]}return re}},(G,n,o)=>{o(4)},(G,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.isNodeJS=void 0;const o=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");n.isNodeJS=o},(G,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.BaseSVGFactory=n.BaseStandardFontDataFactory=n.BaseCMapReaderFactory=n.BaseCanvasFactory=void 0;var t=o(2);class h{constructor(){this.constructor===h&&(0,t.unreachable)("Cannot initialize BaseCanvasFactory.")}create(f,_){if(f<=0||_<=0)throw new Error("Invalid canvas size");const x=this._createCanvas(f,_);return{canvas:x,context:x.getContext("2d")}}reset(f,_,x){if(!f.canvas)throw new Error("Canvas is not specified");if(_<=0||x<=0)throw new Error("Invalid canvas size");f.canvas.width=_,f.canvas.height=x}destroy(f){if(!f.canvas)throw new Error("Canvas is not specified");f.canvas.width=0,f.canvas.height=0,f.canvas=null,f.context=null}_createCanvas(f,_){(0,t.unreachable)("Abstract method `_createCanvas` called.")}}n.BaseCanvasFactory=h;class p{constructor({baseUrl:f=null,isCompressed:_=!1}){this.constructor===p&&(0,t.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=f,this.isCompressed=_}async fetch({name:f}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!f)throw new Error("CMap name must be specified.");const _=this.baseUrl+f+(this.isCompressed?".bcmap":""),x=this.isCompressed?t.CMapCompressionType.BINARY:t.CMapCompressionType.NONE;return this._fetchData(_,x).catch(E=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${_}`)})}_fetchData(f,_){(0,t.unreachable)("Abstract method `_fetchData` called.")}}n.BaseCMapReaderFactory=p;class S{constructor({baseUrl:f=null}){this.constructor===S&&(0,t.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=f}async fetch({filename:f}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!f)throw new Error("Font filename must be specified.");const _=`${this.baseUrl}${f}`;return this._fetchData(_).catch(x=>{throw new Error(`Unable to load font data at: ${_}`)})}_fetchData(f){(0,t.unreachable)("Abstract method `_fetchData` called.")}}n.BaseStandardFontDataFactory=S;class m{constructor(){this.constructor===m&&(0,t.unreachable)("Cannot initialize BaseSVGFactory.")}create(f,_){if(f<=0||_<=0)throw new Error("Invalid SVG dimensions");const x=this._createSVG("svg:svg");return x.setAttribute("version","1.1"),x.setAttribute("width",`${f}px`),x.setAttribute("height",`${_}px`),x.setAttribute("preserveAspectRatio","none"),x.setAttribute("viewBox",`0 0 ${f} ${_}`),x}createElement(f){if(typeof f!="string")throw new Error("Invalid SVG element type");return this._createSVG(f)}_createSVG(f){(0,t.unreachable)("Abstract method `_createSVG` called.")}}n.BaseSVGFactory=m},(__unused_webpack_module,exports,__w_pdfjs_require__)=>{var G;Object.defineProperty(exports,"__esModule",{value:!0}),exports.getDocument=getDocument,exports.setPDFNetworkStreamFactory=setPDFNetworkStreamFactory,exports.version=exports.RenderTask=exports.PDFWorker=exports.PDFPageProxy=exports.PDFDocumentProxy=exports.PDFDocumentLoadingTask=exports.PDFDataRangeTransport=exports.LoopbackPort=exports.DefaultStandardFontDataFactory=exports.DefaultCMapReaderFactory=exports.DefaultCanvasFactory=exports.build=void 0;var _util=__w_pdfjs_require__(2),_display_utils=__w_pdfjs_require__(1),_font_loader=__w_pdfjs_require__(7),_node_utils=__w_pdfjs_require__(8),_annotation_storage=__w_pdfjs_require__(9),_canvas=__w_pdfjs_require__(10),_worker_options=__w_pdfjs_require__(12),_is_node=__w_pdfjs_require__(4),_message_handler=__w_pdfjs_require__(13),_metadata=__w_pdfjs_require__(14),_optional_content_config=__w_pdfjs_require__(15),_transport_stream=__w_pdfjs_require__(16),_xfa_text=__w_pdfjs_require__(17);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DefaultCanvasFactory=_is_node.isNodeJS?_node_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_is_node.isNodeJS?_node_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultStandardFontDataFactory=_is_node.isNodeJS?_node_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;let createPDFNetworkStream;function setPDFNetworkStreamFactory(n){createPDFNetworkStream=n}function getDocument(n){const o=new PDFDocumentLoadingTask;let t;if(typeof n=="string"||n instanceof URL)t={url:n};else if((0,_util.isArrayBuffer)(n))t={data:n};else if(n instanceof PDFDataRangeTransport)t={range:n};else{if(typeof n!="object")throw new Error("Invalid parameter in getDocument, need either string, URL, Uint8Array, or parameter object.");if(!n.url&&!n.data&&!n.range)throw new Error("Invalid parameter object: need either .data, .range or .url");t=n}const h=Object.create(null);let p=null,S=null;for(const b in t){const f=t[b];switch(b){case"url":if(typeof window<"u")try{h[b]=new URL(f,window.location).href;continue}catch(_){(0,_util.warn)(`Cannot create valid URL: "${_}".`)}else if(typeof f=="string"||f instanceof URL){h[b]=f.toString();continue}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.");case"range":p=f;continue;case"worker":S=f;continue;case"data":if(_is_node.isNodeJS&&typeof Buffer<"u"&&f instanceof Buffer)h[b]=new Uint8Array(f);else{if(f instanceof Uint8Array)break;if(typeof f=="string")h[b]=(0,_util.stringToBytes)(f);else if(typeof f=="object"&&f!==null&&!isNaN(f.length))h[b]=new Uint8Array(f);else if((0,_util.isArrayBuffer)(f))h[b]=new Uint8Array(f);else throw new Error("Invalid PDF binary data: either typed array, string, or array-like object is expected in the data property.")}continue}h[b]=f}if(h.rangeChunkSize=h.rangeChunkSize||DEFAULT_RANGE_CHUNK_SIZE,h.CMapReaderFactory=h.CMapReaderFactory||DefaultCMapReaderFactory,h.StandardFontDataFactory=h.StandardFontDataFactory||DefaultStandardFontDataFactory,h.ignoreErrors=h.stopAtErrors!==!0,h.fontExtraProperties=h.fontExtraProperties===!0,h.pdfBug=h.pdfBug===!0,h.enableXfa=h.enableXfa===!0,(typeof h.docBaseUrl!="string"||(0,_display_utils.isDataScheme)(h.docBaseUrl))&&(h.docBaseUrl=null),Number.isInteger(h.maxImageSize)||(h.maxImageSize=-1),typeof h.useWorkerFetch!="boolean"&&(h.useWorkerFetch=h.CMapReaderFactory===_display_utils.DOMCMapReaderFactory&&h.StandardFontDataFactory===_display_utils.DOMStandardFontDataFactory),typeof h.isEvalSupported!="boolean"&&(h.isEvalSupported=!0),typeof h.disableFontFace!="boolean"&&(h.disableFontFace=_is_node.isNodeJS),typeof h.useSystemFonts!="boolean"&&(h.useSystemFonts=!_is_node.isNodeJS&&!h.disableFontFace),typeof h.ownerDocument>"u"&&(h.ownerDocument=globalThis.document),typeof h.disableRange!="boolean"&&(h.disableRange=!1),typeof h.disableStream!="boolean"&&(h.disableStream=!1),typeof h.disableAutoFetch!="boolean"&&(h.disableAutoFetch=!1),(0,_util.setVerbosityLevel)(h.verbosity),!S){const b={verbosity:h.verbosity,port:_worker_options.GlobalWorkerOptions.workerPort};S=b.port?PDFWorker.fromPort(b):new PDFWorker(b),o._worker=S}const m=o.docId;return S.promise.then(function(){if(o.destroyed)throw new Error("Loading aborted");const b=_fetchDocument(S,h,p,m),f=new Promise(function(_){let x;p?x=new _transport_stream.PDFDataTransportStream({length:h.length,initialData:h.initialData,progressiveDone:h.progressiveDone,contentDispositionFilename:h.contentDispositionFilename,disableRange:h.disableRange,disableStream:h.disableStream},p):h.data||(x=createPDFNetworkStream({url:h.url,length:h.length,httpHeaders:h.httpHeaders,withCredentials:h.withCredentials,rangeChunkSize:h.rangeChunkSize,disableRange:h.disableRange,disableStream:h.disableStream})),_(x)});return Promise.all([b,f]).then(function([_,x]){if(o.destroyed)throw new Error("Loading aborted");const E=new _message_handler.MessageHandler(m,_,S.port);E.postMessageTransfers=S.postMessageTransfers;const A=new WorkerTransport(E,o,x,h);o._transport=A,E.send("Ready",null)})}).catch(o._capability.reject),o}async function _fetchDocument(n,o,t,h){if(n.destroyed)throw new Error("Worker was destroyed");t&&(o.length=t.length,o.initialData=t.initialData,o.progressiveDone=t.progressiveDone,o.contentDispositionFilename=t.contentDispositionFilename);const p=await n.messageHandler.sendWithPromise("GetDocRequest",{docId:h,apiVersion:"2.11.338",source:{data:o.data,url:o.url,password:o.password,disableAutoFetch:o.disableAutoFetch,rangeChunkSize:o.rangeChunkSize,length:o.length},maxImageSize:o.maxImageSize,disableFontFace:o.disableFontFace,postMessageTransfers:n.postMessageTransfers,docBaseUrl:o.docBaseUrl,ignoreErrors:o.ignoreErrors,isEvalSupported:o.isEvalSupported,fontExtraProperties:o.fontExtraProperties,enableXfa:o.enableXfa,useSystemFonts:o.useSystemFonts,cMapUrl:o.useWorkerFetch?o.cMapUrl:null,standardFontDataUrl:o.useWorkerFetch?o.standardFontDataUrl:null});if(n.destroyed)throw new Error("Worker was destroyed");return p}class PDFDocumentLoadingTask{static get idCounters(){return(0,_util.shadow)(this,"idCounters",{doc:0})}constructor(){this._capability=(0,_util.createPromiseCapability)(),this._transport=null,this._worker=null,this.docId=`d${PDFDocumentLoadingTask.idCounters.doc++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null,this.onUnsupportedFeature=null}get promise(){return this._capability.promise}async destroy(){var o;this.destroyed=!0,await((o=this._transport)==null?void 0:o.destroy()),this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}}exports.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(o,t,h=!1,p=null){this.length=o,this.initialData=t,this.progressiveDone=h,this.contentDispositionFilename=p,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=(0,_util.createPromiseCapability)()}addRangeListener(o){this._rangeListeners.push(o)}addProgressListener(o){this._progressListeners.push(o)}addProgressiveReadListener(o){this._progressiveReadListeners.push(o)}addProgressiveDoneListener(o){this._progressiveDoneListeners.push(o)}onDataRange(o,t){for(const h of this._rangeListeners)h(o,t)}onDataProgress(o,t){this._readyCapability.promise.then(()=>{for(const h of this._progressListeners)h(o,t)})}onDataProgressiveRead(o){this._readyCapability.promise.then(()=>{for(const t of this._progressiveReadListeners)t(o)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const o of this._progressiveDoneListeners)o()})}transportReady(){this._readyCapability.resolve()}requestDataRange(o,t){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(o,t){this._pdfInfo=o,this._transport=t,Object.defineProperty(this,"fingerprint",{get(){return(0,_display_utils.deprecated)("`PDFDocumentProxy.fingerprint`, please use `PDFDocumentProxy.fingerprints` instead."),this.fingerprints[0]}})}get annotationStorage(){return this._transport.annotationStorage}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return!!this._transport._htmlForXfa}get allXfaHtml(){return this._transport._htmlForXfa}getPage(o){return this._transport.getPage(o)}getPageIndex(o){return this._transport.getPageIndex(o)}getDestinations(){return this._transport.getDestinations()}getDestination(o){return this._transport.getDestination(o)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJavaScript(){return this._transport.getJavaScript()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}getStats(){return this._transport.getStats()}cleanup(o=!1){return this._transport.startCleanup(o||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}saveDocument(){return this._transport.annotationStorage.size<=0&&(0,_display_utils.deprecated)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead."),this._transport.saveDocument()}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{constructor(o,t,h,p,S=!1){this._pageIndex=o,this._pageInfo=t,this._ownerDocument=p,this._transport=h,this._stats=S?new _display_utils.StatTimer:null,this._pdfBug=S,this.commonObjs=h.commonObjs,this.objs=new PDFObjects,this.cleanupAfterRender=!1,this.pendingCleanup=!1,this._intentStates=new Map,this._annotationPromises=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:o,rotation:t=this.rotate,offsetX:h=0,offsetY:p=0,dontFlip:S=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:o,rotation:t,offsetX:h,offsetY:p,dontFlip:S})}getAnnotations({intent:o="display"}={}){const t=this._transport.getRenderingIntent(o);let h=this._annotationPromises.get(t.cacheKey);return h||(h=this._transport.getAnnotations(this._pageIndex,t.renderingIntent),this._annotationPromises.set(t.cacheKey,h),h=h.then(p=>{for(const S of p)S.titleObj!==void 0&&Object.defineProperty(S,"title",{get(){return(0,_display_utils.deprecated)("`title`-property on annotation, please use `titleObj` instead."),S.titleObj.str}}),S.contentsObj!==void 0&&Object.defineProperty(S,"contents",{get(){return(0,_display_utils.deprecated)("`contents`-property on annotation, please use `contentsObj` instead."),S.contentsObj.str}});return p})),h}getJSActions(){return this._jsActionsPromise||(this._jsActionsPromise=this._transport.getPageJSActions(this._pageIndex))}async getXfa(){var o;return((o=this._transport._htmlForXfa)==null?void 0:o.children[this._pageIndex])||null}render({canvasContext:o,viewport:t,intent:h="display",annotationMode:p=_util.AnnotationMode.ENABLE,transform:S=null,imageLayer:m=null,canvasFactory:b=null,background:f=null,optionalContentConfigPromise:_=null}){var I,w;((I=arguments[0])==null?void 0:I.renderInteractiveForms)!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `renderInteractiveForms`-option, please use the `annotationMode`-option instead."),arguments[0].renderInteractiveForms===!0&&p===_util.AnnotationMode.ENABLE&&(p=_util.AnnotationMode.ENABLE_FORMS)),((w=arguments[0])==null?void 0:w.includeAnnotationStorage)!==void 0&&((0,_display_utils.deprecated)("render no longer accepts the `includeAnnotationStorage`-option, please use the `annotationMode`-option instead."),arguments[0].includeAnnotationStorage===!0&&p===_util.AnnotationMode.ENABLE&&(p=_util.AnnotationMode.ENABLE_STORAGE)),this._stats&&this._stats.time("Overall");const x=this._transport.getRenderingIntent(h,p);this.pendingCleanup=!1,_||(_=this._transport.getOptionalContentConfig());let E=this._intentStates.get(x.cacheKey);E||(E=Object.create(null),this._intentStates.set(x.cacheKey,E)),E.streamReaderCancelTimeout&&(clearTimeout(E.streamReaderCancelTimeout),E.streamReaderCancelTimeout=null);const A=b||new DefaultCanvasFactory({ownerDocument:this._ownerDocument}),F=!!(x.renderingIntent&_util.RenderingIntentFlag.PRINT);E.displayReadyCapability||(E.displayReadyCapability=(0,_util.createPromiseCapability)(),E.operatorList={fnArray:[],argsArray:[],lastChunk:!1},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(x));const u=s=>{E.renderTasks.delete(R),(this.cleanupAfterRender||F)&&(this.pendingCleanup=!0),this._tryCleanup(),s?(R.capability.reject(s),this._abortOperatorList({intentState:E,reason:s instanceof Error?s:new Error(s)})):R.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"))},R=new InternalRenderTask({callback:u,params:{canvasContext:o,viewport:t,transform:S,imageLayer:m,background:f},objs:this.objs,commonObjs:this.commonObjs,operatorList:E.operatorList,pageIndex:this._pageIndex,canvasFactory:A,useRequestAnimationFrame:!F,pdfBug:this._pdfBug});(E.renderTasks||(E.renderTasks=new Set)).add(R);const B=R.task;return Promise.all([E.displayReadyCapability.promise,_]).then(([s,a])=>{if(this.pendingCleanup){u();return}this._stats&&this._stats.time("Rendering"),R.initializeGraphics({transparency:s,optionalContentConfig:a}),R.operatorListChanged()}).catch(u),B}getOperatorList({intent:o="display",annotationMode:t=_util.AnnotationMode.ENABLE}={}){function h(){S.operatorList.lastChunk&&(S.opListReadCapability.resolve(S.operatorList),S.renderTasks.delete(m))}const p=this._transport.getRenderingIntent(o,t,!0);let S=this._intentStates.get(p.cacheKey);S||(S=Object.create(null),this._intentStates.set(p.cacheKey,S));let m;return S.opListReadCapability||(m=Object.create(null),m.operatorListChanged=h,S.opListReadCapability=(0,_util.createPromiseCapability)(),(S.renderTasks||(S.renderTasks=new Set)).add(m),S.operatorList={fnArray:[],argsArray:[],lastChunk:!1},this._stats&&this._stats.time("Page Request"),this._pumpOperatorList(p)),S.opListReadCapability.promise}streamTextContent({normalizeWhitespace:o=!1,disableCombineTextItems:t=!1,includeMarkedContent:h=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,normalizeWhitespace:o===!0,combineTextItems:t!==!0,includeMarkedContent:h===!0},{highWaterMark:100,size(S){return S.items.length}})}getTextContent(o={}){if(this._transport._htmlForXfa)return this.getXfa().then(h=>_xfa_text.XfaText.textContent(h));const t=this.streamTextContent(o);return new Promise(function(h,p){function S(){m.read().then(function({value:f,done:_}){if(_){h(b);return}Object.assign(b.styles,f.styles),b.items.push(...f.items),S()},p)}const m=t.getReader(),b={items:[],styles:Object.create(null)};S()})}getStructTree(){return this._structTreePromise||(this._structTreePromise=this._transport.getStructTree(this._pageIndex))}_destroy(){this.destroyed=!0,this._transport.pageCache[this._pageIndex]=null;const o=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const h of t.renderTasks)o.push(h.completed),h.cancel();return this.objs.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,this.pendingCleanup=!1,Promise.all(o)}cleanup(o=!1){return this.pendingCleanup=!0,this._tryCleanup(o)}_tryCleanup(o=!1){if(!this.pendingCleanup)return!1;for(const{renderTasks:t,operatorList:h}of this._intentStates.values())if(t.size>0||!h.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this._annotationPromises.clear(),this._jsActionsPromise=null,this._structTreePromise=null,o&&this._stats&&(this._stats=new _display_utils.StatTimer),this.pendingCleanup=!1,!0}_startRenderPage(o,t){const h=this._intentStates.get(t);h&&(this._stats&&this._stats.timeEnd("Page Request"),h.displayReadyCapability&&h.displayReadyCapability.resolve(o))}_renderPageChunk(o,t){for(let h=0,p=o.length;h<p;h++)t.operatorList.fnArray.push(o.fnArray[h]),t.operatorList.argsArray.push(o.argsArray[h]);t.operatorList.lastChunk=o.lastChunk;for(const h of t.renderTasks)h.operatorListChanged();o.lastChunk&&this._tryCleanup()}_pumpOperatorList({renderingIntent:o,cacheKey:t}){const p=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:o,cacheKey:t,annotationStorage:o&_util.RenderingIntentFlag.ANNOTATIONS_STORAGE?this._transport.annotationStorage.serializable:null}).getReader(),S=this._intentStates.get(t);S.streamReader=p;const m=()=>{p.read().then(({value:b,done:f})=>{if(f){S.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(b,S),m())},b=>{if(S.streamReader=null,!this._transport.destroyed){if(S.operatorList){S.operatorList.lastChunk=!0;for(const f of S.renderTasks)f.operatorListChanged();this._tryCleanup()}if(S.displayReadyCapability)S.displayReadyCapability.reject(b);else if(S.opListReadCapability)S.opListReadCapability.reject(b);else throw b}})};m()}_abortOperatorList({intentState:o,reason:t,force:h=!1}){if(o.streamReader){if(!h){if(o.renderTasks.size>0)return;if(t instanceof _display_utils.RenderingCancelledException){o.streamReaderCancelTimeout=setTimeout(()=>{this._abortOperatorList({intentState:o,reason:t,force:!0}),o.streamReaderCancelTimeout=null},RENDERING_CANCELLED_TIMEOUT);return}}if(o.streamReader.cancel(new _util.AbortException(t.message)).catch(()=>{}),o.streamReader=null,!this._transport.destroyed){for(const[p,S]of this._intentStates)if(S===o){this._intentStates.delete(p);break}this.cleanup()}}}get stats(){return this._stats}}exports.PDFPageProxy=PDFPageProxy;class LoopbackPort{constructor(){this._listeners=[],this._deferred=Promise.resolve(void 0)}postMessage(o,t){function h(m){var _;if(typeof m=="function"||typeof m=="symbol"||m instanceof URL)throw new Error(`LoopbackPort.postMessage - cannot clone: ${m==null?void 0:m.toString()}`);if(typeof m!="object"||m===null)return m;if(p.has(m))return p.get(m);let b,f;if((b=m.buffer)&&(0,_util.isArrayBuffer)(b))return t!=null&&t.includes(b)?f=new m.constructor(b,m.byteOffset,m.byteLength):f=new m.constructor(m),p.set(m,f),f;if(m instanceof Map){f=new Map,p.set(m,f);for(const[x,E]of m)f.set(x,h(E));return f}if(m instanceof Set){f=new Set,p.set(m,f);for(const x of m)f.add(h(x));return f}f=Array.isArray(m)?[]:Object.create(null),p.set(m,f);for(const x in m){let E,A=m;for(;!(E=Object.getOwnPropertyDescriptor(A,x));)A=Object.getPrototypeOf(A);typeof E.value>"u"||typeof E.value=="function"&&!((_=m.hasOwnProperty)!=null&&_.call(m,x))||(f[x]=h(E.value))}return f}const p=new WeakMap,S={data:h(o)};this._deferred.then(()=>{for(const m of this._listeners)m.call(this,S)})}addEventListener(o,t){this._listeners.push(t)}removeEventListener(o,t){const h=this._listeners.indexOf(t);this._listeners.splice(h,1)}terminate(){this._listeners.length=0}}exports.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};{if(_is_node.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const n=(G=document==null?void 0:document.currentScript)==null?void 0:G.src;n&&(PDFWorkerUtil.fallbackWorkerSrc=n.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.createCDNWrapper=function(n){const o=`importScripts("${n}");`;return URL.createObjectURL(new Blob([o]))}}class PDFWorker{static get _workerPorts(){return(0,_util.shadow)(this,"_workerPorts",new WeakMap)}constructor({name:n=null,port:o=null,verbosity:t=(0,_util.getVerbosityLevel)()}={}){if(o&&PDFWorker._workerPorts.has(o))throw new Error("Cannot use more than one PDFWorker per port.");if(this.name=n,this.destroyed=!1,this.postMessageTransfers=!0,this.verbosity=t,this._readyCapability=(0,_util.createPromiseCapability)(),this._port=null,this._webWorker=null,this._messageHandler=null,o){PDFWorker._workerPorts.set(o,this),this._initializeFromPort(o);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(n){this._port=n,this._messageHandler=new _message_handler.MessageHandler("main","worker",n),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve()}_initialize(){if(typeof Worker<"u"&&!PDFWorkerUtil.isWorkerDisabled&&!PDFWorker._mainThreadWorkerMessageHandler){let n=PDFWorker.workerSrc;try{(0,_util.isSameOrigin)(window.location.href,n)||(n=PDFWorkerUtil.createCDNWrapper(new URL(n,window.location).href));const o=new Worker(n),t=new _message_handler.MessageHandler("main","worker",o),h=()=>{o.removeEventListener("error",p),t.destroy(),o.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},p=()=>{this._webWorker||h()};o.addEventListener("error",p),t.on("test",m=>{if(o.removeEventListener("error",p),this.destroyed){h();return}m?(this._messageHandler=t,this._port=o,this._webWorker=o,m.supportTransfers||(this.postMessageTransfers=!1),this._readyCapability.resolve(),t.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),t.destroy(),o.terminate())}),t.on("ready",m=>{if(o.removeEventListener("error",p),this.destroyed){h();return}try{S()}catch{this._setupFakeWorker()}});const S=()=>{const m=new Uint8Array([this.postMessageTransfers?255:0]);try{t.send("test",m,[m.buffer])}catch{(0,_util.warn)("Cannot use postMessage transfers."),m[0]=0,t.send("test",m)}};S();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),PDFWorker._setupFakeWorkerGlobal.then(n=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const o=new LoopbackPort;this._port=o;const t=`fake${PDFWorkerUtil.fakeWorkerId++}`,h=new _message_handler.MessageHandler(t+"_worker",t,o);n.setup(h,o);const p=new _message_handler.MessageHandler(t,t+"_worker",o);this._messageHandler=p,this._readyCapability.resolve(),p.send("configure",{verbosity:this.verbosity})}).catch(n=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${n.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),PDFWorker._workerPorts.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(n){if(!(n!=null&&n.port))throw new Error("PDFWorker.fromPort - invalid method signature.");return this._workerPorts.has(n.port)?this._workerPorts.get(n.port):new PDFWorker(n)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _is_node.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){var n;try{return((n=globalThis.pdfjsWorker)==null?void 0:n.WorkerMessageHandler)||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_is_node.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}}exports.PDFWorker=PDFWorker,PDFWorker.getWorkerSrc=function(){return(0,_display_utils.deprecated)("`PDFWorker.getWorkerSrc()`, please use `PDFWorker.workerSrc` instead."),this.workerSrc};class WorkerTransport{constructor(o,t,h,p){this.messageHandler=o,this.loadingTask=t,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({docId:t.docId,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),ownerDocument:p.ownerDocument,styleElement:p.styleElement}),this._params=p,p.useWorkerFetch||(this.CMapReaderFactory=new p.CMapReaderFactory({baseUrl:p.cMapUrl,isCompressed:p.cMapPacked}),this.StandardFontDataFactory=new p.StandardFontDataFactory({baseUrl:p.standardFontDataUrl})),this.destroyed=!1,this.destroyCapability=null,this._passwordCapability=null,this._networkStream=h,this._fullReader=null,this._lastProgress=null,this.pageCache=[],this.pagePromises=[],this.downloadInfoCapability=(0,_util.createPromiseCapability)(),this.setupMessageHandler()}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(o,t=_util.AnnotationMode.ENABLE,h=!1){let p=_util.RenderingIntentFlag.DISPLAY,S="";switch(o){case"any":p=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":p=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${o}`)}switch(t){case _util.AnnotationMode.DISABLE:p+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:p+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:p+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,S=this.annotationStorage.lastModified;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${t}`)}return h&&(p+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:p,cacheKey:`${p}_${S}`}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=(0,_util.createPromiseCapability)(),this._passwordCapability&&this._passwordCapability.reject(new Error("Worker was destroyed during onPassword callback"));const o=[];for(const h of this.pageCache)h&&o.push(h._destroy());this.pageCache.length=0,this.pagePromises.length=0,this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return o.push(t),Promise.all(o).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null,this._networkStream&&this._networkStream.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:o,loadingTask:t}=this;o.on("GetReader",(h,p)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=S=>{this._lastProgress={loaded:S.loaded,total:S.total}},p.onPull=()=>{this._fullReader.read().then(function({value:S,done:m}){if(m){p.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(S),"GetReader - expected an ArrayBuffer."),p.enqueue(new Uint8Array(S),1,[S])}).catch(S=>{p.error(S)})},p.onCancel=S=>{this._fullReader.cancel(S),p.ready.catch(m=>{if(!this.destroyed)throw m})}}),o.on("ReaderHeadersReady",h=>{const p=(0,_util.createPromiseCapability)(),S=this._fullReader;return S.headersReady.then(()=>{(!S.isStreamingSupported||!S.isRangeSupported)&&(this._lastProgress&&t.onProgress&&t.onProgress(this._lastProgress),S.onProgress=m=>{t.onProgress&&t.onProgress({loaded:m.loaded,total:m.total})}),p.resolve({isStreamingSupported:S.isStreamingSupported,isRangeSupported:S.isRangeSupported,contentLength:S.contentLength})},p.reject),p.promise}),o.on("GetRangeReader",(h,p)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const S=this._networkStream.getRangeReader(h.begin,h.end);if(!S){p.close();return}p.onPull=()=>{S.read().then(function({value:m,done:b}){if(b){p.close();return}(0,_util.assert)((0,_util.isArrayBuffer)(m),"GetRangeReader - expected an ArrayBuffer."),p.enqueue(new Uint8Array(m),1,[m])}).catch(m=>{p.error(m)})},p.onCancel=m=>{S.cancel(m),p.ready.catch(b=>{if(!this.destroyed)throw b})}}),o.on("GetDoc",({pdfInfo:h})=>{this._numPages=h.numPages,this._htmlForXfa=h.htmlForXfa,delete h.htmlForXfa,t._capability.resolve(new PDFDocumentProxy(h,this))}),o.on("DocException",function(h){let p;switch(h.name){case"PasswordException":p=new _util.PasswordException(h.message,h.code);break;case"InvalidPDFException":p=new _util.InvalidPDFException(h.message);break;case"MissingPDFException":p=new _util.MissingPDFException(h.message);break;case"UnexpectedResponseException":p=new _util.UnexpectedResponseException(h.message,h.status);break;case"UnknownErrorException":p=new _util.UnknownErrorException(h.message,h.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}t._capability.reject(p)}),o.on("PasswordRequest",h=>{if(this._passwordCapability=(0,_util.createPromiseCapability)(),t.onPassword){const p=S=>{this._passwordCapability.resolve({password:S})};try{t.onPassword(p,h.code)}catch(S){this._passwordCapability.reject(S)}}else this._passwordCapability.reject(new _util.PasswordException(h.message,h.code));return this._passwordCapability.promise}),o.on("DataLoaded",h=>{t.onProgress&&t.onProgress({loaded:h.length,total:h.length}),this.downloadInfoCapability.resolve(h)}),o.on("StartRenderPage",h=>{if(this.destroyed)return;this.pageCache[h.pageIndex]._startRenderPage(h.transparency,h.cacheKey)}),o.on("commonobj",h=>{var b;if(this.destroyed)return;const[p,S,m]=h;if(!this.commonObjs.has(p))switch(S){case"Font":const f=this._params;if("error"in m){const E=m.error;(0,_util.warn)(`Error during font loading: ${E}`),this.commonObjs.resolve(p,E);break}let _=null;f.pdfBug&&((b=globalThis.FontInspector)!=null&&b.enabled)&&(_={registerFont(E,A){globalThis.FontInspector.fontAdded(E,A)}});const x=new _font_loader.FontFaceObject(m,{isEvalSupported:f.isEvalSupported,disableFontFace:f.disableFontFace,ignoreErrors:f.ignoreErrors,onUnsupportedFeature:this._onUnsupportedFeature.bind(this),fontRegistry:_});this.fontLoader.bind(x).catch(E=>o.sendWithPromise("FontFallback",{id:p})).finally(()=>{!f.fontExtraProperties&&x.data&&(x.data=null),this.commonObjs.resolve(p,x)});break;case"FontPath":case"Image":this.commonObjs.resolve(p,m);break;default:throw new Error(`Got unknown common object type ${S}`)}}),o.on("obj",h=>{var _;if(this.destroyed)return;const[p,S,m,b]=h,f=this.pageCache[S];if(!f.objs.has(p))switch(m){case"Image":f.objs.resolve(p,b);const x=8e6;((_=b==null?void 0:b.data)==null?void 0:_.length)>x&&(f.cleanupAfterRender=!0);break;case"Pattern":f.objs.resolve(p,b);break;default:throw new Error(`Got unknown object type ${m}`)}}),o.on("DocProgress",h=>{this.destroyed||t.onProgress&&t.onProgress({loaded:h.loaded,total:h.total})}),o.on("UnsupportedFeature",this._onUnsupportedFeature.bind(this)),o.on("FetchBuiltInCMap",h=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.CMapReaderFactory?this.CMapReaderFactory.fetch(h):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),o.on("FetchStandardFontData",h=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.StandardFontDataFactory?this.StandardFontDataFactory.fetch(h):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}_onUnsupportedFeature({featureId:o}){this.destroyed||this.loadingTask.onUnsupportedFeature&&this.loadingTask.onUnsupportedFeature(o)}getData(){return this.messageHandler.sendWithPromise("GetData",null)}getPage(o){if(!Number.isInteger(o)||o<=0||o>this._numPages)return Promise.reject(new Error("Invalid page request"));const t=o-1;if(t in this.pagePromises)return this.pagePromises[t];const h=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(p=>{if(this.destroyed)throw new Error("Transport destroyed");const S=new PDFPageProxy(t,p,this,this._params.ownerDocument,this._params.pdfBug);return this.pageCache[t]=S,S});return this.pagePromises[t]=h,h}getPageIndex(o){return this.messageHandler.sendWithPromise("GetPageIndex",{ref:o})}getAnnotations(o,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:o,intent:t})}saveDocument(){var o;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:this.annotationStorage.serializable,filename:((o=this._fullReader)==null?void 0:o.filename)??null}).finally(()=>{this.annotationStorage.resetModified()})}getFieldObjects(){return this._getFieldObjectsPromise||(this._getFieldObjectsPromise=this.messageHandler.sendWithPromise("GetFieldObjects",null))}hasJSActions(){return this._hasJSActionsPromise||(this._hasJSActionsPromise=this.messageHandler.sendWithPromise("HasJSActions",null))}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(o){return typeof o!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:o})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getJavaScript(){return this.messageHandler.sendWithPromise("GetJavaScript",null)}getDocJSActions(){return this.messageHandler.sendWithPromise("GetDocJSActions",null)}getPageJSActions(o){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:o})}getStructTree(o){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:o})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(o=>new _optional_content_config.OptionalContentConfig(o))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){return this.messageHandler.sendWithPromise("GetMetadata",null).then(o=>{var t,h;return{info:o[0],metadata:o[1]?new _metadata.Metadata(o[1]):null,contentDispositionFilename:((t=this._fullReader)==null?void 0:t.filename)??null,contentLength:((h=this._fullReader)==null?void 0:h.contentLength)??null}})}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}getStats(){return this.messageHandler.sendWithPromise("GetStats",null)}async startCleanup(o=!1){if(await this.messageHandler.sendWithPromise("Cleanup",null),!this.destroyed){for(let t=0,h=this.pageCache.length;t<h;t++){const p=this.pageCache[t];if(!p)continue;if(!p.cleanup())throw new Error(`startCleanup: Page ${t+1} is currently rendering.`)}this.commonObjs.clear(),o||this.fontLoader.clear(),this._getFieldObjectsPromise=null,this._hasJSActionsPromise=null}}get loadingParams(){const o=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:o.disableAutoFetch,enableXfa:o.enableXfa})}}class PDFObjects{constructor(){this._objs=Object.create(null)}_ensureObj(o){return this._objs[o]?this._objs[o]:this._objs[o]={capability:(0,_util.createPromiseCapability)(),data:null,resolved:!1}}get(o,t=null){if(t)return this._ensureObj(o).capability.promise.then(t),null;const h=this._objs[o];if(!h||!h.resolved)throw new Error(`Requesting object that isn't resolved yet ${o}.`);return h.data}has(o){const t=this._objs[o];return(t==null?void 0:t.resolved)||!1}resolve(o,t){const h=this._ensureObj(o);h.resolved=!0,h.data=t,h.capability.resolve(t)}clear(){this._objs=Object.create(null)}}class RenderTask{constructor(o){this._internalRenderTask=o,this.onContinue=null}get promise(){return this._internalRenderTask.capability.promise}cancel(){this._internalRenderTask.cancel()}}exports.RenderTask=RenderTask;class InternalRenderTask{static get canvasInUse(){return(0,_util.shadow)(this,"canvasInUse",new WeakSet)}constructor({callback:o,params:t,objs:h,commonObjs:p,operatorList:S,pageIndex:m,canvasFactory:b,useRequestAnimationFrame:f=!1,pdfBug:_=!1}){this.callback=o,this.params=t,this.objs=h,this.commonObjs=p,this.operatorListIdx=null,this.operatorList=S,this._pageIndex=m,this.canvasFactory=b,this._pdfBug=_,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=f===!0&&typeof window<"u",this.cancelled=!1,this.capability=(0,_util.createPromiseCapability)(),this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:o=!1,optionalContentConfig:t}){var f;if(this.cancelled)return;if(this._canvas){if(InternalRenderTask.canvasInUse.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");InternalRenderTask.canvasInUse.add(this._canvas)}this._pdfBug&&((f=globalThis.StepperManager)!=null&&f.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:h,viewport:p,transform:S,imageLayer:m,background:b}=this.params;this.gfx=new _canvas.CanvasGraphics(h,this.commonObjs,this.objs,this.canvasFactory,m,t),this.gfx.beginDrawing({transform:S,viewport:p,transparency:o,background:b}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback&&this.graphicsReadyCallback()}cancel(o=null){this.running=!1,this.cancelled=!0,this.gfx&&this.gfx.endDrawing(),this._canvas&&InternalRenderTask.canvasInUse.delete(this._canvas),this.callback(o||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,"canvas"))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}this.stepper&&this.stepper.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),this._canvas&&InternalRenderTask.canvasInUse.delete(this._canvas),this.callback())))}}const version="2.11.338";exports.version=version;const build="dedff3c98";exports.build=build},(G,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.FontLoader=n.FontFaceObject=void 0;var t=o(2);class h{constructor({docId:b,onUnsupportedFeature:f,ownerDocument:_=globalThis.document,styleElement:x=null}){this.constructor===h&&(0,t.unreachable)("Cannot initialize BaseFontLoader."),this.docId=b,this._onUnsupportedFeature=f,this._document=_,this.nativeFontFaces=[],this.styleElement=null}addNativeFontFace(b){this.nativeFontFaces.push(b),this._document.fonts.add(b)}insertRule(b){let f=this.styleElement;f||(f=this.styleElement=this._document.createElement("style"),f.id=`PDFJS_FONT_STYLE_TAG_${this.docId}`,this._document.documentElement.getElementsByTagName("head")[0].appendChild(f));const _=f.sheet;_.insertRule(b,_.cssRules.length)}clear(){for(const b of this.nativeFontFaces)this._document.fonts.delete(b);this.nativeFontFaces.length=0,this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async bind(b){if(b.attached||b.missingFile)return;if(b.attached=!0,this.isFontLoadingAPISupported){const _=b.createNativeFontFace();if(_){this.addNativeFontFace(_);try{await _.loaded}catch(x){throw this._onUnsupportedFeature({featureId:t.UNSUPPORTED_FEATURES.errorFontLoadNative}),(0,t.warn)(`Failed to load font '${_.family}': '${x}'.`),b.disableFontFace=!0,x}}return}const f=b.createFontFaceRule();if(f){if(this.insertRule(f),this.isSyncFontLoadingSupported)return;await new Promise(_=>{const x=this._queueLoadingCallback(_);this._prepareFontLoadEvent([f],[b],x)})}}_queueLoadingCallback(b){(0,t.unreachable)("Abstract method `_queueLoadingCallback`.")}get isFontLoadingAPISupported(){var f;const b=!!((f=this._document)!=null&&f.fonts);return(0,t.shadow)(this,"isFontLoadingAPISupported",b)}get isSyncFontLoadingSupported(){(0,t.unreachable)("Abstract method `isSyncFontLoadingSupported`.")}get _loadTestFont(){(0,t.unreachable)("Abstract method `_loadTestFont`.")}_prepareFontLoadEvent(b,f,_){(0,t.unreachable)("Abstract method `_prepareFontLoadEvent`.")}}let p;n.FontLoader=p,n.FontLoader=p=class extends h{constructor(b){super(b),this.loadingContext={requests:[],nextRequestId:0},this.loadTestFontId=0}get isSyncFontLoadingSupported(){let b=!1;if(typeof navigator>"u")b=!0;else{const f=/Mozilla\/5.0.*?rv:(\d+).*? Gecko/.exec(navigator.userAgent);(f==null?void 0:f[1])>=14&&(b=!0)}return(0,t.shadow)(this,"isSyncFontLoadingSupported",b)}_queueLoadingCallback(b){function f(){for((0,t.assert)(!x.done,"completeRequest() cannot be called twice."),x.done=!0;_.requests.length>0&&_.requests[0].done;){const E=_.requests.shift();setTimeout(E.callback,0)}}const _=this.loadingContext,x={id:`pdfjs-font-loading-${_.nextRequestId++}`,done:!1,complete:f,callback:b};return _.requests.push(x),x}get _loadTestFont(){const b=function(){return atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==")};return(0,t.shadow)(this,"_loadTestFont",b())}_prepareFontLoadEvent(b,f,_){function x(k,L){return k.charCodeAt(L)<<24|k.charCodeAt(L+1)<<16|k.charCodeAt(L+2)<<8|k.charCodeAt(L+3)&255}function E(k,L,H,q){const W=k.substring(0,L),K=k.substring(L+H);return W+q+K}let A,F;const u=this._document.createElement("canvas");u.width=1,u.height=1;const R=u.getContext("2d");let B=0;function I(k,L){if(B++,B>30){(0,t.warn)("Load test font never loaded."),L();return}if(R.font="30px "+k,R.fillText(".",0,20),R.getImageData(0,0,1,1).data[3]>0){L();return}setTimeout(I.bind(null,k,L))}const w=`lt${Date.now()}${this.loadTestFontId++}`;let s=this._loadTestFont;s=E(s,976,w.length,w);const g=16,v=1482184792;let y=x(s,g);for(A=0,F=w.length-3;A<F;A+=4)y=y-v+x(w,A)|0;A<w.length&&(y=y-v+x(w+"XXX",A)|0),s=E(s,g,4,(0,t.string32)(y));const O=`url(data:font/opentype;base64,${btoa(s)});`,M=`@font-face {font-family:"${w}";src:${O}}`;this.insertRule(M);const Q=[];for(const k of f)Q.push(k.loadedName);Q.push(w);const V=this._document.createElement("div");V.style.visibility="hidden",V.style.width=V.style.height="10px",V.style.position="absolute",V.style.top=V.style.left="0px";for(const k of Q){const L=this._document.createElement("span");L.textContent="Hi",L.style.fontFamily=k,V.appendChild(L)}this._document.body.appendChild(V),I(w,()=>{this._document.body.removeChild(V),_.complete()})}};class S{constructor(b,{isEvalSupported:f=!0,disableFontFace:_=!1,ignoreErrors:x=!1,onUnsupportedFeature:E,fontRegistry:A=null}){this.compiledGlyphs=Object.create(null);for(const F in b)this[F]=b[F];this.isEvalSupported=f!==!1,this.disableFontFace=_===!0,this.ignoreErrors=x===!0,this._onUnsupportedFeature=E,this.fontRegistry=A}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let b;if(!this.cssFontInfo)b=new FontFace(this.loadedName,this.data,{});else{const f={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(f.style=`oblique ${this.cssFontInfo.italicAngle}deg`),b=new FontFace(this.cssFontInfo.fontFamily,this.data,f)}return this.fontRegistry&&this.fontRegistry.registerFont(this),b}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const b=(0,t.bytesToString)(this.data),f=`url(data:${this.mimetype};base64,${btoa(b)});`;let _;if(!this.cssFontInfo)_=`@font-face {font-family:"${this.loadedName}";src:${f}}`;else{let x=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(x+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),_=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${x}src:${f}}`}return this.fontRegistry&&this.fontRegistry.registerFont(this,f),_}getPathGenerator(b,f){if(this.compiledGlyphs[f]!==void 0)return this.compiledGlyphs[f];let _;try{_=b.get(this.loadedName+"_path_"+f)}catch(x){if(!this.ignoreErrors)throw x;return this._onUnsupportedFeature({featureId:t.UNSUPPORTED_FEATURES.errorFontGetPath}),(0,t.warn)(`getPathGenerator - ignoring character: "${x}".`),this.compiledGlyphs[f]=function(E,A){}}if(this.isEvalSupported&&t.IsEvalSupportedCached.value){const x=[];for(const E of _){const A=E.args!==void 0?E.args.join(","):"";x.push("c.",E.cmd,"(",A,`);
`)}return this.compiledGlyphs[f]=new Function("c","size",x.join(""))}return this.compiledGlyphs[f]=function(x,E){for(const A of _)A.cmd==="scale"&&(A.args=[E,-E]),x[A.cmd].apply(x,A.args)}}}n.FontFaceObject=S},(G,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.NodeStandardFontDataFactory=n.NodeCMapReaderFactory=n.NodeCanvasFactory=void 0;var t=o(5),h=o(4),p=o(2);let S=class{constructor(){(0,p.unreachable)("Not implemented: NodeCanvasFactory")}};n.NodeCanvasFactory=S;let m=class{constructor(){(0,p.unreachable)("Not implemented: NodeCMapReaderFactory")}};n.NodeCMapReaderFactory=m;let b=class{constructor(){(0,p.unreachable)("Not implemented: NodeStandardFontDataFactory")}};if(n.NodeStandardFontDataFactory=b,h.isNodeJS){const f=function(_){return new Promise((x,E)=>{require$$5.readFile(_,(F,u)=>{if(F||!u){E(new Error(F));return}x(new Uint8Array(u))})})};n.NodeCanvasFactory=S=class extends t.BaseCanvasFactory{_createCanvas(_,x){return require$$5.createCanvas(_,x)}},n.NodeCMapReaderFactory=m=class extends t.BaseCMapReaderFactory{_fetchData(_,x){return f(_).then(E=>({cMapData:E,compressionType:x}))}},n.NodeStandardFontDataFactory=b=class extends t.BaseStandardFontDataFactory{_fetchData(_){return f(_)}}}},(G,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.AnnotationStorage=void 0;var t=o(2);class h{constructor(){this._storage=new Map,this._timeStamp=Date.now(),this._modified=!1,this.onSetModified=null,this.onResetModified=null}getValue(S,m){const b=this._storage.get(S);return b===void 0?m:Object.assign(m,b)}setValue(S,m){const b=this._storage.get(S);let f=!1;if(b!==void 0)for(const[_,x]of Object.entries(m))b[_]!==x&&(f=!0,b[_]=x);else f=!0,this._storage.set(S,m);f&&(this._timeStamp=Date.now(),this._setModified())}getAll(){return this._storage.size>0?(0,t.objectFromMap)(this._storage):null}get size(){return this._storage.size}_setModified(){this._modified||(this._modified=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this._modified&&(this._modified=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get serializable(){return this._storage.size>0?this._storage:null}get lastModified(){return this._timeStamp.toString()}}n.AnnotationStorage=h},(G,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.CanvasGraphics=void 0;var t=o(2),h=o(11),p=o(1);const S=16,m=100,b=4096,f=2,_=15,x=10,E=1e3,A=16,F=1.000001;function u(T){if(!T.mozCurrentTransform){T._originalSave=T.save,T._originalRestore=T.restore,T._originalRotate=T.rotate,T._originalScale=T.scale,T._originalTranslate=T.translate,T._originalTransform=T.transform,T._originalSetTransform=T.setTransform,T._originalResetTransform=T.resetTransform,T._transformMatrix=T._transformMatrix||[1,0,0,1,0,0],T._transformStack=[];try{const c=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(T),"lineWidth");T._setLineWidth=c.set,T._getLineWidth=c.get,Object.defineProperty(T,"lineWidth",{set:function(r){this._setLineWidth(r*F)},get:function(){return this._getLineWidth()}})}catch{}Object.defineProperty(T,"mozCurrentTransform",{get:function(){return this._transformMatrix}}),Object.defineProperty(T,"mozCurrentTransformInverse",{get:function(){const[e,r,i,d,l,C]=this._transformMatrix,P=e*d-r*i,N=r*i-e*d;return[d/P,r/N,i/N,e/P,(d*l-i*C)/N,(r*l-e*C)/P]}}),T.save=function(){const e=this._transformMatrix;this._transformStack.push(e),this._transformMatrix=e.slice(0,6),this._originalSave()},T.restore=function(){const e=this._transformStack.pop();e&&(this._transformMatrix=e,this._originalRestore())},T.translate=function(e,r){const i=this._transformMatrix;i[4]=i[0]*e+i[2]*r+i[4],i[5]=i[1]*e+i[3]*r+i[5],this._originalTranslate(e,r)},T.scale=function(e,r){const i=this._transformMatrix;i[0]*=e,i[1]*=e,i[2]*=r,i[3]*=r,this._originalScale(e,r)},T.transform=function(e,r,i,d,l,C){const P=this._transformMatrix;this._transformMatrix=[P[0]*e+P[2]*r,P[1]*e+P[3]*r,P[0]*i+P[2]*d,P[1]*i+P[3]*d,P[0]*l+P[2]*C+P[4],P[1]*l+P[3]*C+P[5]],T._originalTransform(e,r,i,d,l,C)},T.setTransform=function(e,r,i,d,l,C){this._transformMatrix=[e,r,i,d,l,C],T._originalSetTransform(e,r,i,d,l,C)},T.resetTransform=function(){this._transformMatrix=[1,0,0,1,0,0],T._originalResetTransform()},T.rotate=function(e){const r=Math.cos(e),i=Math.sin(e),d=this._transformMatrix;this._transformMatrix=[d[0]*r+d[2]*i,d[1]*r+d[3]*i,d[0]*-i+d[2]*r,d[1]*-i+d[3]*r,d[4],d[5]],this._originalRotate(e)}}}class R{constructor(c){this.canvasFactory=c,this.cache=Object.create(null)}getCanvas(c,e,r,i){let d;return this.cache[c]!==void 0?(d=this.cache[c],this.canvasFactory.reset(d,e,r),d.context.setTransform(1,0,0,1,0,0)):(d=this.canvasFactory.create(e,r),this.cache[c]=d),i&&u(d.context),d}clear(){for(const c in this.cache){const e=this.cache[c];this.canvasFactory.destroy(e),delete this.cache[c]}}}class B{constructor(c=0){this._cache=new Map,this._maxSize=c}has(c){return this._cache.has(c)}get(c){if(this._cache.has(c)){const e=this._cache.get(c);this._cache.delete(c),this._cache.set(c,e)}return this._cache.get(c)}set(c,e){this._maxSize<=0||(this._cache.size+1>this._maxSize&&this._cache.delete(this._cache.keys().next().value),this._cache.set(c,e))}clear(){this._cache.clear()}}function I(T){const e=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),r=T.width,i=T.height,d=r+1;let l,C,P,N;const j=new Uint8Array(d*(i+1)),D=r+7&-8,$=T.data,X=new Uint8Array(D*i);let J=0;for(l=0,C=$.length;l<C;l++){const ne=$[l];let de=128;for(;de>0;)X[J++]=ne&de?0:255,de>>=1}let Z=0;for(J=0,X[J]!==0&&(j[0]=1,++Z),P=1;P<r;P++)X[J]!==X[J+1]&&(j[P]=X[J]?2:1,++Z),J++;for(X[J]!==0&&(j[P]=2,++Z),l=1;l<i;l++){J=l*D,N=l*d,X[J-D]!==X[J]&&(j[N]=X[J]?1:8,++Z);let ne=(X[J]?4:0)+(X[J-D]?8:0);for(P=1;P<r;P++)ne=(ne>>2)+(X[J+1]?4:0)+(X[J-D+1]?8:0),e[ne]&&(j[N+P]=e[ne],++Z),J++;if(X[J-D]!==X[J]&&(j[N+P]=X[J]?2:4,++Z),Z>1e3)return null}for(J=D*(i-1),N=l*d,X[J]!==0&&(j[N]=8,++Z),P=1;P<r;P++)X[J]!==X[J+1]&&(j[N+P]=X[J]?4:8,++Z),J++;if(X[J]!==0&&(j[N+P]=4,++Z),Z>1e3)return null;const ie=new Int32Array([0,d,-1,0,-d,0,0,0,1]),se=[];for(l=0;Z&&l<=i;l++){let ne=l*d;const de=ne+r;for(;ne<de&&!j[ne];)ne++;if(ne===de)continue;const he=[ne%d,l],ee=ne;let le=j[ne];do{const me=ie[le];do ne+=me;while(!j[ne]);const pe=j[ne];pe!==5&&pe!==10?(le=pe,j[ne]=0):(le=pe&51*le>>4,j[ne]&=le>>2|le<<2),he.push(ne%d,ne/d|0),j[ne]||--Z}while(ee!==ne);se.push(he),--l}return function(ne){ne.save(),ne.scale(1/r,-1/i),ne.translate(0,-i),ne.beginPath();for(let de=0,he=se.length;de<he;de++){const ee=se[de];ne.moveTo(ee[0],ee[1]);for(let le=2,me=ee.length;le<me;le+=2)ne.lineTo(ee[le],ee[le+1])}ne.fill(),ne.beginPath(),ne.restore()}}class w{constructor(){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=t.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=t.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=t.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.resumeSMaskCtx=null,this.transferMaps=null}clone(){return Object.create(this)}setCurrentPoint(c,e){this.x=c,this.y=e}}function s(T,c,e=null){if(typeof ImageData<"u"&&c instanceof ImageData){T.putImageData(c,0,0);return}const r=c.height,i=c.width,d=r%A,l=(r-d)/A,C=d===0?l:l+1,P=T.createImageData(i,A);let N=0,j;const D=c.data,$=P.data;let X,J,Z,ie,se,ae,ne,de;if(e)switch(e.length){case 1:se=e[0],ae=e[0],ne=e[0],de=e[0];break;case 4:se=e[0],ae=e[1],ne=e[2],de=e[3];break}if(c.kind===t.ImageKind.GRAYSCALE_1BPP){const he=D.byteLength,ee=new Uint32Array($.buffer,0,$.byteLength>>2),le=ee.length,me=i+7>>3;let pe=4294967295,fe=t.IsLittleEndianCached.value?4278190080:255;for(de&&de[0]===255&&de[255]===0&&([pe,fe]=[fe,pe]),X=0;X<C;X++){for(Z=X<l?A:d,j=0,J=0;J<Z;J++){const be=he-N;let ge=0;const Ae=be>me?i:be*8-7,_e=Ae&-8;let ye=0,ue=0;for(;ge<_e;ge+=8)ue=D[N++],ee[j++]=ue&128?pe:fe,ee[j++]=ue&64?pe:fe,ee[j++]=ue&32?pe:fe,ee[j++]=ue&16?pe:fe,ee[j++]=ue&8?pe:fe,ee[j++]=ue&4?pe:fe,ee[j++]=ue&2?pe:fe,ee[j++]=ue&1?pe:fe;for(;ge<Ae;ge++)ye===0&&(ue=D[N++],ye=128),ee[j++]=ue&ye?pe:fe,ye>>=1}for(;j<le;)ee[j++]=0;T.putImageData(P,0,X*A)}}else if(c.kind===t.ImageKind.RGBA_32BPP){const he=!!(se||ae||ne);for(J=0,ie=i*A*4,X=0;X<l;X++){if($.set(D.subarray(N,N+ie)),N+=ie,he)for(let ee=0;ee<ie;ee+=4)se&&($[ee+0]=se[$[ee+0]]),ae&&($[ee+1]=ae[$[ee+1]]),ne&&($[ee+2]=ne[$[ee+2]]);T.putImageData(P,0,J),J+=A}if(X<C){if(ie=i*d*4,$.set(D.subarray(N,N+ie)),he)for(let ee=0;ee<ie;ee+=4)se&&($[ee+0]=se[$[ee+0]]),ae&&($[ee+1]=ae[$[ee+1]]),ne&&($[ee+2]=ne[$[ee+2]]);T.putImageData(P,0,J)}}else if(c.kind===t.ImageKind.RGB_24BPP){const he=!!(se||ae||ne);for(Z=A,ie=i*Z,X=0;X<C;X++){for(X>=l&&(Z=d,ie=i*Z),j=0,J=ie;J--;)$[j++]=D[N++],$[j++]=D[N++],$[j++]=D[N++],$[j++]=255;if(he)for(let ee=0;ee<j;ee+=4)se&&($[ee+0]=se[$[ee+0]]),ae&&($[ee+1]=ae[$[ee+1]]),ne&&($[ee+2]=ne[$[ee+2]]);T.putImageData(P,0,X*A)}}else throw new Error(`bad image kind: ${c.kind}`)}function a(T,c){const e=c.height,r=c.width,i=e%A,d=(e-i)/A,l=i===0?d:d+1,C=T.createImageData(r,A);let P=0;const N=c.data,j=C.data;for(let D=0;D<l;D++){const $=D<d?A:i;let X=3;for(let J=0;J<$;J++){let Z,ie=0;for(let se=0;se<r;se++)ie||(Z=N[P++],ie=128),j[X]=Z&ie?0:255,X+=4,ie>>=1}T.putImageData(C,0,D*A)}}function g(T,c){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font"];for(let r=0,i=e.length;r<i;r++){const d=e[r];T[d]!==void 0&&(c[d]=T[d])}T.setLineDash!==void 0&&(c.setLineDash(T.getLineDash()),c.lineDashOffset=T.lineDashOffset)}function v(T){T.strokeStyle="#000000",T.fillStyle="#000000",T.fillRule="nonzero",T.globalAlpha=1,T.lineWidth=1,T.lineCap="butt",T.lineJoin="miter",T.miterLimit=10,T.globalCompositeOperation="source-over",T.font="10px sans-serif",T.setLineDash!==void 0&&(T.setLineDash([]),T.lineDashOffset=0)}function y(T,c,e,r){const i=T.length;for(let d=3;d<i;d+=4){const l=T[d];if(l===0)T[d-3]=c,T[d-2]=e,T[d-1]=r;else if(l<255){const C=255-l;T[d-3]=T[d-3]*l+c*C>>8,T[d-2]=T[d-2]*l+e*C>>8,T[d-1]=T[d-1]*l+r*C>>8}}}function O(T,c,e){const r=T.length,i=1/255;for(let d=3;d<r;d+=4){const l=e?e[T[d]]:T[d];c[d]=c[d]*l*i|0}}function M(T,c,e){const r=T.length;for(let i=3;i<r;i+=4){const d=T[i-3]*77+T[i-2]*152+T[i-1]*28;c[i]=e?c[i]*e[d>>8]>>8:c[i]*d>>16}}function Q(T,c,e,r,i,d,l){const C=!!d,P=C?d[0]:0,N=C?d[1]:0,j=C?d[2]:0;let D;i==="Luminosity"?D=M:D=O;const X=Math.min(r,Math.ceil(1048576/e));for(let J=0;J<r;J+=X){const Z=Math.min(X,r-J),ie=T.getImageData(0,J,e,Z),se=c.getImageData(0,J,e,Z);C&&y(ie.data,P,N,j),D(ie.data,se.data,l),T.putImageData(se,0,J)}}function V(T,c,e){const r=c.canvas,i=c.context;T.setTransform(c.scaleX,0,0,c.scaleY,c.offsetX,c.offsetY),Q(i,e,r.width,r.height,c.subtype,c.backdrop,c.transferMap),T.drawImage(r,0,0)}function k(T,c){const e=t.Util.singularValueDecompose2dScale(T);e[0]=Math.fround(e[0]),e[1]=Math.fround(e[1]);const r=Math.fround((globalThis.devicePixelRatio||1)*p.PixelsPerInch.PDF_TO_CSS_UNITS);return c!==void 0?c:e[0]<=r||e[1]<=r}const L=["butt","round","square"],H=["miter","round","bevel"],q={},W={};class K{constructor(c,e,r,i,d,l){this.ctx=c,this.current=new w,this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=r,this.canvasFactory=i,this.imageLayer=d,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.contentVisible=!0,this.markedContentStack=[],this.optionalContentConfig=l,this.cachedCanvases=new R(this.canvasFactory),this.cachedCanvasPatterns=new B(f),this.cachedPatterns=new Map,c&&u(c),this._cachedGetSinglePixelWidth=null}beginDrawing({transform:c,viewport:e,transparency:r=!1,background:i=null}){const d=this.ctx.canvas.width,l=this.ctx.canvas.height;if(this.ctx.save(),this.ctx.fillStyle=i||"rgb(255, 255, 255)",this.ctx.fillRect(0,0,d,l),this.ctx.restore(),r){const C=this.cachedCanvases.getCanvas("transparent",d,l,!0);this.compositeCtx=this.ctx,this.transparentCanvas=C.canvas,this.ctx=C.context,this.ctx.save(),this.ctx.transform.apply(this.ctx,this.compositeCtx.mozCurrentTransform)}this.ctx.save(),v(this.ctx),c&&this.ctx.transform.apply(this.ctx,c),this.ctx.transform.apply(this.ctx,e.transform),this.baseTransform=this.ctx.mozCurrentTransform.slice(),this._combinedScaleFactor=Math.hypot(this.baseTransform[0],this.baseTransform[2]),this.imageLayer&&this.imageLayer.beginLayout()}executeOperatorList(c,e,r,i){const d=c.argsArray,l=c.fnArray;let C=e||0;const P=d.length;if(P===C)return C;const N=P-C>x&&typeof r=="function",j=N?Date.now()+_:0;let D=0;const $=this.commonObjs,X=this.objs;let J;for(;;){if(i!==void 0&&C===i.nextBreakPoint)return i.breakIt(C,r),C;if(J=l[C],J!==t.OPS.dependency)this[J].apply(this,d[C]);else for(const Z of d[C]){const ie=Z.startsWith("g_")?$:X;if(!ie.has(Z))return ie.get(Z,r),C}if(C++,C===P)return C;if(N&&++D>x){if(Date.now()>j)return r(),C;D=0}}}endDrawing(){for(;this.stateStack.length||this.current.activeSMask!==null;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null),this.cachedCanvases.clear(),this.cachedCanvasPatterns.clear(),this.cachedPatterns.clear(),this.imageLayer&&this.imageLayer.endLayout()}_scaleImage(c,e){const r=c.width,i=c.height;let d=Math.max(Math.hypot(e[0],e[1]),1),l=Math.max(Math.hypot(e[2],e[3]),1),C=r,P=i,N="prescale1",j,D;for(;d>2&&C>1||l>2&&P>1;){let $=C,X=P;d>2&&C>1&&($=Math.ceil(C/2),d/=C/$),l>2&&P>1&&(X=Math.ceil(P/2),l/=P/X),j=this.cachedCanvases.getCanvas(N,$,X),D=j.context,D.clearRect(0,0,$,X),D.drawImage(c,0,0,C,P,0,0,$,X),c=j.canvas,C=$,P=X,N=N==="prescale1"?"prescale2":"prescale1"}return{img:c,paintWidth:C,paintHeight:P}}_createMaskCanvas(c){const e=this.ctx,r=c.width,i=c.height,d=this.current.fillColor,l=this.current.patternFill,C=this.cachedCanvases.getCanvas("maskCanvas",r,i),P=C.context;a(P,c);const N=e.mozCurrentTransform;let j=t.Util.transform(N,[1/r,0,0,-1/i,0,0]);j=t.Util.transform(j,[1,0,0,1,0,-i]);const D=t.Util.applyTransform([0,0],j),$=t.Util.applyTransform([r,i],j),X=t.Util.normalizeRect([D[0],D[1],$[0],$[1]]),J=Math.ceil(X[2]-X[0]),Z=Math.ceil(X[3]-X[1]),ie=this.cachedCanvases.getCanvas("fillCanvas",J,Z,!0),se=ie.context,ae=Math.min(D[0],$[0]),ne=Math.min(D[1],$[1]);se.translate(-ae,-ne),se.transform.apply(se,j);const de=this._scaleImage(C.canvas,se.mozCurrentTransformInverse);se.imageSmoothingEnabled=k(se.mozCurrentTransform,c.interpolate),se.drawImage(de.img,0,0,de.img.width,de.img.height,0,0,r,i),se.globalCompositeOperation="source-in";const he=t.Util.transform(se.mozCurrentTransformInverse,[1,0,0,1,-ae,-ne]);return se.fillStyle=l?d.getPattern(e,this,he,!1):d,se.fillRect(0,0,r,i),{canvas:ie.canvas,offsetX:Math.round(ae),offsetY:Math.round(ne)}}setLineWidth(c){this.current.lineWidth=c,this.ctx.lineWidth=c}setLineCap(c){this.ctx.lineCap=L[c]}setLineJoin(c){this.ctx.lineJoin=H[c]}setMiterLimit(c){this.ctx.miterLimit=c}setDash(c,e){const r=this.ctx;r.setLineDash!==void 0&&(r.setLineDash(c),r.lineDashOffset=e)}setRenderingIntent(c){}setFlatness(c){}setGState(c){for(let e=0,r=c.length;e<r;e++){const i=c[e],d=i[0],l=i[1];switch(d){case"LW":this.setLineWidth(l);break;case"LC":this.setLineCap(l);break;case"LJ":this.setLineJoin(l);break;case"ML":this.setMiterLimit(l);break;case"D":this.setDash(l[0],l[1]);break;case"RI":this.setRenderingIntent(l);break;case"FL":this.setFlatness(l);break;case"Font":this.setFont(l[0],l[1]);break;case"CA":this.current.strokeAlpha=i[1];break;case"ca":this.current.fillAlpha=i[1],this.ctx.globalAlpha=i[1];break;case"BM":this.ctx.globalCompositeOperation=l;break;case"SMask":this.current.activeSMask&&(this.stateStack.length>0&&this.stateStack[this.stateStack.length-1].activeSMask===this.current.activeSMask?this.suspendSMaskGroup():this.endSMaskGroup()),this.current.activeSMask=l?this.tempSMask:null,this.current.activeSMask&&this.beginSMaskGroup(),this.tempSMask=null;break;case"TR":this.current.transferMaps=l}}}beginSMaskGroup(){const c=this.current.activeSMask,e=c.canvas.width,r=c.canvas.height,i="smaskGroupAt"+this.groupLevel,d=this.cachedCanvases.getCanvas(i,e,r,!0),l=this.ctx,C=l.mozCurrentTransform;this.ctx.save();const P=d.context;P.scale(1/c.scaleX,1/c.scaleY),P.translate(-c.offsetX,-c.offsetY),P.transform.apply(P,C),c.startTransformInverse=P.mozCurrentTransformInverse,g(l,P),this.ctx=P,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(l),this.groupLevel++}suspendSMaskGroup(){const c=this.ctx;this.groupLevel--,this.ctx=this.groupStack.pop(),V(this.ctx,this.current.activeSMask,c),this.ctx.restore(),this.ctx.save(),g(c,this.ctx),this.current.resumeSMaskCtx=c;const e=t.Util.transform(this.current.activeSMask.startTransformInverse,c.mozCurrentTransform);this.ctx.transform.apply(this.ctx,e),c.save(),c.setTransform(1,0,0,1,0,0),c.clearRect(0,0,c.canvas.width,c.canvas.height),c.restore()}resumeSMaskGroup(){const c=this.current.resumeSMaskCtx,e=this.ctx;this.ctx=c,this.groupStack.push(e),this.groupLevel++}endSMaskGroup(){const c=this.ctx;this.groupLevel--,this.ctx=this.groupStack.pop(),V(this.ctx,this.current.activeSMask,c),this.ctx.restore(),g(c,this.ctx);const e=t.Util.transform(this.current.activeSMask.startTransformInverse,c.mozCurrentTransform);this.ctx.transform.apply(this.ctx,e)}save(){this.ctx.save();const c=this.current;this.stateStack.push(c),this.current=c.clone(),this.current.resumeSMaskCtx=null}restore(){this.current.resumeSMaskCtx&&this.resumeSMaskGroup(),this.current.activeSMask!==null&&(this.stateStack.length===0||this.stateStack[this.stateStack.length-1].activeSMask!==this.current.activeSMask)&&this.endSMaskGroup(),this.stateStack.length!==0?(this.current=this.stateStack.pop(),this.ctx.restore(),this.pendingClip=null,this._cachedGetSinglePixelWidth=null):this.current.activeSMask=null}transform(c,e,r,i,d,l){this.ctx.transform(c,e,r,i,d,l),this._cachedGetSinglePixelWidth=null}constructPath(c,e){const r=this.ctx,i=this.current;let d=i.x,l=i.y;for(let C=0,P=0,N=c.length;C<N;C++)switch(c[C]|0){case t.OPS.rectangle:d=e[P++],l=e[P++];const j=e[P++],D=e[P++],$=d+j,X=l+D;r.moveTo(d,l),j===0||D===0?r.lineTo($,X):(r.lineTo($,l),r.lineTo($,X),r.lineTo(d,X)),r.closePath();break;case t.OPS.moveTo:d=e[P++],l=e[P++],r.moveTo(d,l);break;case t.OPS.lineTo:d=e[P++],l=e[P++],r.lineTo(d,l);break;case t.OPS.curveTo:d=e[P+4],l=e[P+5],r.bezierCurveTo(e[P],e[P+1],e[P+2],e[P+3],d,l),P+=6;break;case t.OPS.curveTo2:r.bezierCurveTo(d,l,e[P],e[P+1],e[P+2],e[P+3]),d=e[P+2],l=e[P+3],P+=4;break;case t.OPS.curveTo3:d=e[P+2],l=e[P+3],r.bezierCurveTo(e[P],e[P+1],d,l,d,l),P+=4;break;case t.OPS.closePath:r.closePath();break}i.setCurrentPoint(d,l)}closePath(){this.ctx.closePath()}stroke(c){c=typeof c<"u"?c:!0;const e=this.ctx,r=this.current.strokeColor;if(e.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof r=="object"&&(r!=null&&r.getPattern)){const i=this.getSinglePixelWidth();e.save(),e.strokeStyle=r.getPattern(e,this,e.mozCurrentTransformInverse),e.lineWidth=Math.max(i,this.current.lineWidth),e.stroke(),e.restore()}else{const i=this.getSinglePixelWidth();i<0&&-i>=this.current.lineWidth?(e.save(),e.resetTransform(),e.lineWidth=Math.round(this._combinedScaleFactor),e.stroke(),e.restore()):(e.lineWidth=Math.max(i,this.current.lineWidth),e.stroke())}c&&this.consumePath(),e.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(c){c=typeof c<"u"?c:!0;const e=this.ctx,r=this.current.fillColor,i=this.current.patternFill;let d=!1;i&&(e.save(),e.fillStyle=r.getPattern(e,this,e.mozCurrentTransformInverse),d=!0),this.contentVisible&&(this.pendingEOFill?(e.fill("evenodd"),this.pendingEOFill=!1):e.fill()),d&&e.restore(),c&&this.consumePath()}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=q}eoClip(){this.pendingClip=W}beginText(){this.current.textMatrix=t.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const c=this.pendingTextPaths,e=this.ctx;if(c===void 0){e.beginPath();return}e.save(),e.beginPath();for(let r=0;r<c.length;r++){const i=c[r];e.setTransform.apply(e,i.transform),e.translate(i.x,i.y),i.addToPath(e,i.fontSize)}e.restore(),e.clip(),e.beginPath(),delete this.pendingTextPaths}setCharSpacing(c){this.current.charSpacing=c}setWordSpacing(c){this.current.wordSpacing=c}setHScale(c){this.current.textHScale=c/100}setLeading(c){this.current.leading=-c}setFont(c,e){const r=this.commonObjs.get(c),i=this.current;if(!r)throw new Error(`Can't find font for ${c}`);if(i.fontMatrix=r.fontMatrix||t.FONT_IDENTITY_MATRIX,(i.fontMatrix[0]===0||i.fontMatrix[3]===0)&&(0,t.warn)("Invalid font matrix for font "+c),e<0?(e=-e,i.fontDirection=-1):i.fontDirection=1,this.current.font=r,this.current.fontSize=e,r.isType3Font)return;const d=r.loadedName||"sans-serif";let l="normal";r.black?l="900":r.bold&&(l="bold");const C=r.italic?"italic":"normal",P=`"${d}", ${r.fallbackName}`;let N=e;e<S?N=S:e>m&&(N=m),this.current.fontSizeScale=e/N,this.ctx.font=`${C} ${l} ${N}px ${P}`}setTextRenderingMode(c){this.current.textRenderingMode=c}setTextRise(c){this.current.textRise=c}moveText(c,e){this.current.x=this.current.lineX+=c,this.current.y=this.current.lineY+=e}setLeadingMoveText(c,e){this.setLeading(-e),this.moveText(c,e)}setTextMatrix(c,e,r,i,d,l){this.current.textMatrix=[c,e,r,i,d,l],this.current.textMatrixScale=Math.hypot(c,e),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(c,e,r,i,d){const l=this.ctx,C=this.current,P=C.font,N=C.textRenderingMode,j=C.fontSize/C.fontSizeScale,D=N&t.TextRenderingMode.FILL_STROKE_MASK,$=!!(N&t.TextRenderingMode.ADD_TO_PATH_FLAG),X=C.patternFill&&!P.missingFile;let J;(P.disableFontFace||$||X)&&(J=P.getPathGenerator(this.commonObjs,c)),P.disableFontFace||X?(l.save(),l.translate(e,r),l.beginPath(),J(l,j),i&&l.setTransform.apply(l,i),(D===t.TextRenderingMode.FILL||D===t.TextRenderingMode.FILL_STROKE)&&l.fill(),(D===t.TextRenderingMode.STROKE||D===t.TextRenderingMode.FILL_STROKE)&&(d&&(l.resetTransform(),l.lineWidth=Math.round(this._combinedScaleFactor)),l.stroke()),l.restore()):((D===t.TextRenderingMode.FILL||D===t.TextRenderingMode.FILL_STROKE)&&l.fillText(c,e,r),(D===t.TextRenderingMode.STROKE||D===t.TextRenderingMode.FILL_STROKE)&&(d?(l.save(),l.moveTo(e,r),l.resetTransform(),l.lineWidth=Math.round(this._combinedScaleFactor),l.strokeText(c,0,0),l.restore()):l.strokeText(c,e,r))),$&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:l.mozCurrentTransform,x:e,y:r,fontSize:j,addToPath:J})}get isFontSubpixelAAEnabled(){const{context:c}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);c.scale(1.5,1),c.fillText("I",0,10);const e=c.getImageData(0,0,10,10).data;let r=!1;for(let i=3;i<e.length;i+=4)if(e[i]>0&&e[i]<255){r=!0;break}return(0,t.shadow)(this,"isFontSubpixelAAEnabled",r)}showText(c){const e=this.current,r=e.font;if(r.isType3Font)return this.showType3Text(c);const i=e.fontSize;if(i===0)return;const d=this.ctx,l=e.fontSizeScale,C=e.charSpacing,P=e.wordSpacing,N=e.fontDirection,j=e.textHScale*N,D=c.length,$=r.vertical,X=$?1:-1,J=r.defaultVMetrics,Z=i*e.fontMatrix[0],ie=e.textRenderingMode===t.TextRenderingMode.FILL&&!r.disableFontFace&&!e.patternFill;d.save();let se;if(e.patternFill){d.save();const le=e.fillColor.getPattern(d,this,d.mozCurrentTransformInverse);se=d.mozCurrentTransform,d.restore(),d.fillStyle=le}d.transform.apply(d,e.textMatrix),d.translate(e.x,e.y+e.textRise),N>0?d.scale(j,-1):d.scale(j,1);let ae=e.lineWidth,ne=!1;const de=e.textMatrixScale;if(de===0||ae===0){const le=e.textRenderingMode&t.TextRenderingMode.FILL_STROKE_MASK;(le===t.TextRenderingMode.STROKE||le===t.TextRenderingMode.FILL_STROKE)&&(this._cachedGetSinglePixelWidth=null,ae=this.getSinglePixelWidth(),ne=ae<0)}else ae/=de;l!==1&&(d.scale(l,l),ae/=l),d.lineWidth=ae;let he=0,ee;for(ee=0;ee<D;++ee){const le=c[ee];if((0,t.isNum)(le)){he+=X*le*i/1e3;continue}let me=!1;const pe=(le.isSpace?P:0)+C,fe=le.fontChar,be=le.accent;let ge,Ae,_e=le.width;if($){const ue=le.vmetric||J,Ce=-(le.vmetric?ue[1]:_e*.5)*Z,Pe=ue[2]*Z;_e=ue?-ue[0]:_e,ge=Ce/l,Ae=(he+Pe)/l}else ge=he/l,Ae=0;if(r.remeasure&&_e>0){const ue=d.measureText(fe).width*1e3/i*l;if(_e<ue&&this.isFontSubpixelAAEnabled){const Ce=_e/ue;me=!0,d.save(),d.scale(Ce,1),ge/=Ce}else _e!==ue&&(ge+=(_e-ue)/2e3*i/l)}if(this.contentVisible&&(le.isInFont||r.missingFile)){if(ie&&!be)d.fillText(fe,ge,Ae);else if(this.paintChar(fe,ge,Ae,se,ne),be){const ue=ge+i*be.offset.x/l,Ce=Ae-i*be.offset.y/l;this.paintChar(be.fontChar,ue,Ce,se,ne)}}let ye;$?ye=_e*Z-pe*N:ye=_e*Z+pe*N,he+=ye,me&&d.restore()}$?e.y-=he:e.x+=he*j,d.restore()}showType3Text(c){const e=this.ctx,r=this.current,i=r.font,d=r.fontSize,l=r.fontDirection,C=i.vertical?1:-1,P=r.charSpacing,N=r.wordSpacing,j=r.textHScale*l,D=r.fontMatrix||t.FONT_IDENTITY_MATRIX,$=c.length,X=r.textRenderingMode===t.TextRenderingMode.INVISIBLE;let J,Z,ie,se;if(!(X||d===0)){for(this._cachedGetSinglePixelWidth=null,e.save(),e.transform.apply(e,r.textMatrix),e.translate(r.x,r.y),e.scale(j,l),J=0;J<$;++J){if(Z=c[J],(0,t.isNum)(Z)){se=C*Z*d/1e3,this.ctx.translate(se,0),r.x+=se*j;continue}const ae=(Z.isSpace?N:0)+P,ne=i.charProcOperatorList[Z.operatorListId];if(!ne){(0,t.warn)(`Type3 character "${Z.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=Z,this.save(),e.scale(d,d),e.transform.apply(e,D),this.executeOperatorList(ne),this.restore()),ie=t.Util.applyTransform([Z.width,0],D)[0]*d+ae,e.translate(ie,0),r.x+=ie*j}e.restore(),this.processingType3=null}}setCharWidth(c,e){}setCharWidthAndBounds(c,e,r,i,d,l){this.ctx.rect(r,i,d-r,l-i),this.clip(),this.endPath()}getColorN_Pattern(c){let e;if(c[0]==="TilingPattern"){const r=c[1],i=this.baseTransform||this.ctx.mozCurrentTransform.slice(),d={createCanvasGraphics:l=>new K(l,this.commonObjs,this.objs,this.canvasFactory)};e=new h.TilingPattern(c,r,this.ctx,d,i)}else e=this._getPattern(c[1],c[2]);return e}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(c,e,r){const i=t.Util.makeHexColor(c,e,r);this.ctx.strokeStyle=i,this.current.strokeColor=i}setFillRGBColor(c,e,r){const i=t.Util.makeHexColor(c,e,r);this.ctx.fillStyle=i,this.current.fillColor=i,this.current.patternFill=!1}_getPattern(c,e=null){let r;return this.cachedPatterns.has(c)?r=this.cachedPatterns.get(c):(r=(0,h.getShadingPattern)(this.objs.get(c),this.cachedCanvasPatterns),this.cachedPatterns.set(c,r)),e&&(r.matrix=e),r}shadingFill(c){if(!this.contentVisible)return;const e=this.ctx;this.save();const r=this._getPattern(c);e.fillStyle=r.getPattern(e,this,e.mozCurrentTransformInverse,!0);const i=e.mozCurrentTransformInverse;if(i){const d=e.canvas,l=d.width,C=d.height,P=t.Util.applyTransform([0,0],i),N=t.Util.applyTransform([0,C],i),j=t.Util.applyTransform([l,0],i),D=t.Util.applyTransform([l,C],i),$=Math.min(P[0],N[0],j[0],D[0]),X=Math.min(P[1],N[1],j[1],D[1]),J=Math.max(P[0],N[0],j[0],D[0]),Z=Math.max(P[1],N[1],j[1],D[1]);this.ctx.fillRect($,X,J-$,Z-X)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.restore()}beginInlineImage(){(0,t.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,t.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(c,e){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(c)&&c.length===6&&this.transform.apply(this,c),this.baseTransform=this.ctx.mozCurrentTransform,e)){const r=e[2]-e[0],i=e[3]-e[1];this.ctx.rect(e[0],e[1],r,i),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(c){if(!this.contentVisible)return;this.save();const e=this.ctx;c.isolated||(0,t.info)("TODO: Support non-isolated groups."),c.knockout&&(0,t.warn)("Knockout groups not supported.");const r=e.mozCurrentTransform;if(c.matrix&&e.transform.apply(e,c.matrix),!c.bbox)throw new Error("Bounding box is required.");let i=t.Util.getAxialAlignedBoundingBox(c.bbox,e.mozCurrentTransform);const d=[0,0,e.canvas.width,e.canvas.height];i=t.Util.intersect(i,d)||[0,0,0,0];const l=Math.floor(i[0]),C=Math.floor(i[1]);let P=Math.max(Math.ceil(i[2])-l,1),N=Math.max(Math.ceil(i[3])-C,1),j=1,D=1;P>b&&(j=P/b,P=b),N>b&&(D=N/b,N=b);let $="groupAt"+this.groupLevel;c.smask&&($+="_smask_"+this.smaskCounter++%2);const X=this.cachedCanvases.getCanvas($,P,N,!0),J=X.context;J.scale(1/j,1/D),J.translate(-l,-C),J.transform.apply(J,r),c.smask?this.smaskStack.push({canvas:X.canvas,context:J,offsetX:l,offsetY:C,scaleX:j,scaleY:D,subtype:c.smask.subtype,backdrop:c.smask.backdrop,transferMap:c.smask.transferMap||null,startTransformInverse:null}):(e.setTransform(1,0,0,1,0,0),e.translate(l,C),e.scale(j,D)),g(e,J),this.ctx=J,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(e),this.groupLevel++,this.current.activeSMask=null}endGroup(c){if(!this.contentVisible)return;this.groupLevel--;const e=this.ctx;this.ctx=this.groupStack.pop(),this.ctx.imageSmoothingEnabled=!1,c.smask?this.tempSMask=this.smaskStack.pop():this.ctx.drawImage(e.canvas,0,0),this.restore()}beginAnnotations(){this.save(),this.baseTransform&&this.ctx.setTransform.apply(this.ctx,this.baseTransform)}endAnnotations(){this.restore()}beginAnnotation(c,e,r,i){if(this.save(),v(this.ctx),this.current=new w,Array.isArray(e)&&e.length===4){const d=e[2]-e[0],l=e[3]-e[1];this.ctx.rect(e[0],e[1],d,l),this.clip(),this.endPath()}this.transform.apply(this,r),this.transform.apply(this,i)}endAnnotation(){this.restore()}paintImageMaskXObject(c){if(!this.contentVisible)return;const e=this.ctx,r=c.width,i=c.height,d=this.processingType3;if(d&&d.compiled===void 0&&(r<=E&&i<=E?d.compiled=I({data:c.data,width:r,height:i}):d.compiled=null),d!=null&&d.compiled){d.compiled(e);return}const l=this._createMaskCanvas(c),C=l.canvas;e.save(),e.setTransform(1,0,0,1,0,0),e.drawImage(C,l.offsetX,l.offsetY),e.restore()}paintImageMaskXObjectRepeat(c,e,r=0,i=0,d,l){if(!this.contentVisible)return;const C=this.ctx;C.save();const P=C.mozCurrentTransform;C.transform(e,r,i,d,0,0);const N=this._createMaskCanvas(c);C.setTransform(1,0,0,1,0,0);for(let j=0,D=l.length;j<D;j+=2){const $=t.Util.transform(P,[e,r,i,d,l[j],l[j+1]]),[X,J]=t.Util.applyTransform([0,0],$);C.drawImage(N.canvas,X,J)}C.restore()}paintImageMaskXObjectGroup(c){if(!this.contentVisible)return;const e=this.ctx,r=this.current.fillColor,i=this.current.patternFill;for(let d=0,l=c.length;d<l;d++){const C=c[d],P=C.width,N=C.height,j=this.cachedCanvases.getCanvas("maskCanvas",P,N),D=j.context;D.save(),a(D,C),D.globalCompositeOperation="source-in",D.fillStyle=i?r.getPattern(D,this,e.mozCurrentTransformInverse,!1):r,D.fillRect(0,0,P,N),D.restore(),e.save(),e.transform.apply(e,C.transform),e.scale(1,-1),e.drawImage(j.canvas,0,0,P,N,0,-1,1,1),e.restore()}}paintImageXObject(c){if(!this.contentVisible)return;const e=c.startsWith("g_")?this.commonObjs.get(c):this.objs.get(c);if(!e){(0,t.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e)}paintImageXObjectRepeat(c,e,r,i){if(!this.contentVisible)return;const d=c.startsWith("g_")?this.commonObjs.get(c):this.objs.get(c);if(!d){(0,t.warn)("Dependent image isn't ready yet");return}const l=d.width,C=d.height,P=[];for(let N=0,j=i.length;N<j;N+=2)P.push({transform:[e,0,0,r,i[N],i[N+1]],x:0,y:0,w:l,h:C});this.paintInlineImageXObjectGroup(d,P)}paintInlineImageXObject(c){if(!this.contentVisible)return;const e=c.width,r=c.height,i=this.ctx;this.save(),i.scale(1/e,-1/r);let d;if(typeof HTMLElement=="function"&&c instanceof HTMLElement||!c.data)d=c;else{const C=this.cachedCanvases.getCanvas("inlineImage",e,r),P=C.context;s(P,c,this.current.transferMaps),d=C.canvas}const l=this._scaleImage(d,i.mozCurrentTransformInverse);if(i.imageSmoothingEnabled=k(i.mozCurrentTransform,c.interpolate),i.drawImage(l.img,0,0,l.paintWidth,l.paintHeight,0,-r,e,r),this.imageLayer){const C=this.getCanvasPosition(0,-r);this.imageLayer.appendImage({imgData:c,left:C[0],top:C[1],width:e/i.mozCurrentTransformInverse[0],height:r/i.mozCurrentTransformInverse[3]})}this.restore()}paintInlineImageXObjectGroup(c,e){if(!this.contentVisible)return;const r=this.ctx,i=c.width,d=c.height,l=this.cachedCanvases.getCanvas("inlineImage",i,d),C=l.context;s(C,c,this.current.transferMaps);for(let P=0,N=e.length;P<N;P++){const j=e[P];if(r.save(),r.transform.apply(r,j.transform),r.scale(1,-1),r.drawImage(l.canvas,j.x,j.y,j.w,j.h,0,-1,1,1),this.imageLayer){const D=this.getCanvasPosition(j.x,j.y);this.imageLayer.appendImage({imgData:c,left:D[0],top:D[1],width:i,height:d})}r.restore()}}paintSolidColorImageMask(){this.contentVisible&&this.ctx.fillRect(0,0,1,1)}markPoint(c){}markPointProps(c,e){}beginMarkedContent(c){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(c,e){c==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(e)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(){const c=this.ctx;this.pendingClip&&(this.pendingClip===W?c.clip("evenodd"):c.clip(),this.pendingClip=null),c.beginPath()}getSinglePixelWidth(){if(this._cachedGetSinglePixelWidth===null){const c=this.ctx.mozCurrentTransform,e=Math.abs(c[0]*c[3]-c[2]*c[1]),r=c[0]**2+c[2]**2,i=c[1]**2+c[3]**2,d=Math.sqrt(Math.max(r,i))/e;r!==i&&this._combinedScaleFactor*d>1?this._cachedGetSinglePixelWidth=-(this._combinedScaleFactor*d):e>Number.EPSILON?this._cachedGetSinglePixelWidth=d:this._cachedGetSinglePixelWidth=1}return this._cachedGetSinglePixelWidth}getCanvasPosition(c,e){const r=this.ctx.mozCurrentTransform;return[r[0]*c+r[2]*e+r[4],r[1]*c+r[3]*e+r[5]]}isContentVisible(){for(let c=this.markedContentStack.length-1;c>=0;c--)if(!this.markedContentStack[c].visible)return!1;return!0}}n.CanvasGraphics=K;for(const T in t.OPS)K.prototype[T]!==void 0&&(K.prototype[t.OPS[T]]=K.prototype[T])},(G,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.getShadingPattern=x,n.TilingPattern=void 0;var t=o(2);function h(F,u){if(!u||typeof Path2D>"u")return;const R=u[2]-u[0],B=u[3]-u[1],I=new Path2D;I.rect(u[0],u[1],R,B),F.clip(I)}class p{constructor(){this.constructor===p&&(0,t.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,t.unreachable)("Abstract method `getPattern` called.")}}class S extends p{constructor(u,R){super(),this._type=u[1],this._bbox=u[2],this._colorStops=u[3],this._p0=u[4],this._p1=u[5],this._r0=u[6],this._r1=u[7],this.matrix=null,this.cachedCanvasPatterns=R}_createGradient(u){let R;this._type==="axial"?R=u.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(R=u.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const B of this._colorStops)R.addColorStop(B[0],B[1]);return R}getPattern(u,R,B,I=!1){let w;if(I)h(u,this._bbox),w=this._createGradient(u);else if(this.cachedCanvasPatterns.has(this))w=this.cachedCanvasPatterns.get(this);else{const s=R.cachedCanvases.getCanvas("pattern",R.ctx.canvas.width,R.ctx.canvas.height,!0),a=s.context;a.clearRect(0,0,a.canvas.width,a.canvas.height),a.beginPath(),a.rect(0,0,a.canvas.width,a.canvas.height),a.setTransform.apply(a,R.baseTransform),this.matrix&&a.transform.apply(a,this.matrix),h(a,this._bbox),a.fillStyle=this._createGradient(a),a.fill(),w=u.createPattern(s.canvas,"repeat"),this.cachedCanvasPatterns.set(this,w)}if(!I){const s=new DOMMatrix(B);try{w.setTransform(s)}catch(a){(0,t.warn)(`RadialAxialShadingPattern.getPattern: "${a==null?void 0:a.message}".`)}}return w}}function m(F,u,R,B,I,w,s,a){const g=u.coords,v=u.colors,y=F.data,O=F.width*4;let M;g[R+1]>g[B+1]&&(M=R,R=B,B=M,M=w,w=s,s=M),g[B+1]>g[I+1]&&(M=B,B=I,I=M,M=s,s=a,a=M),g[R+1]>g[B+1]&&(M=R,R=B,B=M,M=w,w=s,s=M);const Q=(g[R]+u.offsetX)*u.scaleX,V=(g[R+1]+u.offsetY)*u.scaleY,k=(g[B]+u.offsetX)*u.scaleX,L=(g[B+1]+u.offsetY)*u.scaleY,H=(g[I]+u.offsetX)*u.scaleX,q=(g[I+1]+u.offsetY)*u.scaleY;if(V>=q)return;const W=v[w],K=v[w+1],T=v[w+2],c=v[s],e=v[s+1],r=v[s+2],i=v[a],d=v[a+1],l=v[a+2],C=Math.round(V),P=Math.round(q);let N,j,D,$,X,J,Z,ie;for(let se=C;se<=P;se++){if(se<L){let ee;se<V?ee=0:ee=(V-se)/(V-L),N=Q-(Q-k)*ee,j=W-(W-c)*ee,D=K-(K-e)*ee,$=T-(T-r)*ee}else{let ee;se>q?ee=1:L===q?ee=0:ee=(L-se)/(L-q),N=k-(k-H)*ee,j=c-(c-i)*ee,D=e-(e-d)*ee,$=r-(r-l)*ee}let ae;se<V?ae=0:se>q?ae=1:ae=(V-se)/(V-q),X=Q-(Q-H)*ae,J=W-(W-i)*ae,Z=K-(K-d)*ae,ie=T-(T-l)*ae;const ne=Math.round(Math.min(N,X)),de=Math.round(Math.max(N,X));let he=O*se+ne*4;for(let ee=ne;ee<=de;ee++)ae=(N-ee)/(N-X),ae<0?ae=0:ae>1&&(ae=1),y[he++]=j-(j-J)*ae|0,y[he++]=D-(D-Z)*ae|0,y[he++]=$-($-ie)*ae|0,y[he++]=255}}function b(F,u,R){const B=u.coords,I=u.colors;let w,s;switch(u.type){case"lattice":const a=u.verticesPerRow,g=Math.floor(B.length/a)-1,v=a-1;for(w=0;w<g;w++){let y=w*a;for(let O=0;O<v;O++,y++)m(F,R,B[y],B[y+1],B[y+a],I[y],I[y+1],I[y+a]),m(F,R,B[y+a+1],B[y+1],B[y+a],I[y+a+1],I[y+1],I[y+a])}break;case"triangles":for(w=0,s=B.length;w<s;w+=3)m(F,R,B[w],B[w+1],B[w+2],I[w],I[w+1],I[w+2]);break;default:throw new Error("illegal figure")}}class f extends p{constructor(u){super(),this._coords=u[2],this._colors=u[3],this._figures=u[4],this._bounds=u[5],this._bbox=u[7],this._background=u[8],this.matrix=null}_createMeshCanvas(u,R,B){const a=Math.floor(this._bounds[0]),g=Math.floor(this._bounds[1]),v=Math.ceil(this._bounds[2])-a,y=Math.ceil(this._bounds[3])-g,O=Math.min(Math.ceil(Math.abs(v*u[0]*1.1)),3e3),M=Math.min(Math.ceil(Math.abs(y*u[1]*1.1)),3e3),Q=v/O,V=y/M,k={coords:this._coords,colors:this._colors,offsetX:-a,offsetY:-g,scaleX:1/Q,scaleY:1/V},L=O+2*2,H=M+2*2,q=B.getCanvas("mesh",L,H,!1),W=q.context,K=W.createImageData(O,M);if(R){const c=K.data;for(let e=0,r=c.length;e<r;e+=4)c[e]=R[0],c[e+1]=R[1],c[e+2]=R[2],c[e+3]=255}for(const c of this._figures)b(K,c,k);return W.putImageData(K,2,2),{canvas:q.canvas,offsetX:a-2*Q,offsetY:g-2*V,scaleX:Q,scaleY:V}}getPattern(u,R,B,I=!1){h(u,this._bbox);let w;if(I)w=t.Util.singularValueDecompose2dScale(u.mozCurrentTransform);else if(w=t.Util.singularValueDecompose2dScale(R.baseTransform),this.matrix){const a=t.Util.singularValueDecompose2dScale(this.matrix);w=[w[0]*a[0],w[1]*a[1]]}const s=this._createMeshCanvas(w,I?null:this._background,R.cachedCanvases);return I||(u.setTransform.apply(u,R.baseTransform),this.matrix&&u.transform.apply(u,this.matrix)),u.translate(s.offsetX,s.offsetY),u.scale(s.scaleX,s.scaleY),u.createPattern(s.canvas,"no-repeat")}}class _ extends p{getPattern(){return"hotpink"}}function x(F,u){switch(F[0]){case"RadialAxial":return new S(F,u);case"Mesh":return new f(F);case"Dummy":return new _}throw new Error(`Unknown IR type: ${F[0]}`)}const E={COLORED:1,UNCOLORED:2};class A{static get MAX_PATTERN_SIZE(){return(0,t.shadow)(this,"MAX_PATTERN_SIZE",3e3)}constructor(u,R,B,I,w){this.operatorList=u[2],this.matrix=u[3]||[1,0,0,1,0,0],this.bbox=u[4],this.xstep=u[5],this.ystep=u[6],this.paintType=u[7],this.tilingType=u[8],this.color=R,this.ctx=B,this.canvasGraphicsFactory=I,this.baseTransform=w}createPatternCanvas(u){const R=this.operatorList,B=this.bbox,I=this.xstep,w=this.ystep,s=this.paintType,a=this.tilingType,g=this.color,v=this.canvasGraphicsFactory;(0,t.info)("TilingType: "+a);const y=B[0],O=B[1],M=B[2],Q=B[3],V=t.Util.singularValueDecompose2dScale(this.matrix),k=t.Util.singularValueDecompose2dScale(this.baseTransform),L=[V[0]*k[0],V[1]*k[1]],H=this.getSizeAndScale(I,this.ctx.canvas.width,L[0]),q=this.getSizeAndScale(w,this.ctx.canvas.height,L[1]),W=u.cachedCanvases.getCanvas("pattern",H.size,q.size,!0),K=W.context,T=v.createCanvasGraphics(K);T.groupLevel=u.groupLevel,this.setFillAndStrokeStyleToContext(T,s,g);let c=y,e=O,r=M,i=Q;return y<0&&(c=0,r+=Math.abs(y)),O<0&&(e=0,i+=Math.abs(O)),K.translate(-(H.scale*c),-(q.scale*e)),T.transform(H.scale,0,0,q.scale,0,0),this.clipBbox(T,c,e,r,i),T.baseTransform=T.ctx.mozCurrentTransform.slice(),T.executeOperatorList(R),T.endDrawing(),{canvas:W.canvas,scaleX:H.scale,scaleY:q.scale,offsetX:c,offsetY:e}}getSizeAndScale(u,R,B){u=Math.abs(u);const I=Math.max(A.MAX_PATTERN_SIZE,R);let w=Math.ceil(u*B);return w>=I?w=I:B=w/u,{scale:B,size:w}}clipBbox(u,R,B,I,w){const s=I-R,a=w-B;u.ctx.rect(R,B,s,a),u.clip(),u.endPath()}setFillAndStrokeStyleToContext(u,R,B){const I=u.ctx,w=u.current;switch(R){case E.COLORED:const s=this.ctx;I.fillStyle=s.fillStyle,I.strokeStyle=s.strokeStyle,w.fillColor=s.fillStyle,w.strokeColor=s.strokeStyle;break;case E.UNCOLORED:const a=t.Util.makeHexColor(B[0],B[1],B[2]);I.fillStyle=a,I.strokeStyle=a,w.fillColor=a,w.strokeColor=a;break;default:throw new t.FormatError(`Unsupported paint type: ${R}`)}}getPattern(u,R,B,I=!1){let w=B;I||(w=t.Util.transform(w,R.baseTransform),this.matrix&&(w=t.Util.transform(w,this.matrix)));const s=this.createPatternCanvas(R);let a=new DOMMatrix(w);a=a.translate(s.offsetX,s.offsetY),a=a.scale(1/s.scaleX,1/s.scaleY);const g=u.createPattern(s.canvas,"repeat");try{g.setTransform(a)}catch(v){(0,t.warn)(`TilingPattern.getPattern: "${v==null?void 0:v.message}".`)}return g}}n.TilingPattern=A},(G,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.GlobalWorkerOptions=void 0;const o=Object.create(null);n.GlobalWorkerOptions=o,o.workerPort=o.workerPort===void 0?null:o.workerPort,o.workerSrc=o.workerSrc===void 0?"":o.workerSrc},(G,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.MessageHandler=void 0;var t=o(2);const h={UNKNOWN:0,DATA:1,ERROR:2},p={UNKNOWN:0,CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function S(b){if(!(b instanceof Error||typeof b=="object"&&b!==null))return(0,t.warn)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),b;switch(b.name){case"AbortException":return new t.AbortException(b.message);case"MissingPDFException":return new t.MissingPDFException(b.message);case"PasswordException":return new t.PasswordException(b.message,b.code);case"UnexpectedResponseException":return new t.UnexpectedResponseException(b.message,b.status);case"UnknownErrorException":return new t.UnknownErrorException(b.message,b.details);default:return new t.UnknownErrorException(b.message,b.toString())}}class m{constructor(f,_,x){this.sourceName=f,this.targetName=_,this.comObj=x,this.callbackId=1,this.streamId=1,this.postMessageTransfers=!0,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=E=>{const A=E.data;if(A.targetName!==this.sourceName)return;if(A.stream){this._processStreamMessage(A);return}if(A.callback){const u=A.callbackId,R=this.callbackCapabilities[u];if(!R)throw new Error(`Cannot resolve callback ${u}`);if(delete this.callbackCapabilities[u],A.callback===h.DATA)R.resolve(A.data);else if(A.callback===h.ERROR)R.reject(S(A.reason));else throw new Error("Unexpected callback case");return}const F=this.actionHandler[A.action];if(!F)throw new Error(`Unknown action from worker: ${A.action}`);if(A.callbackId){const u=this.sourceName,R=A.sourceName;new Promise(function(B){B(F(A.data))}).then(function(B){x.postMessage({sourceName:u,targetName:R,callback:h.DATA,callbackId:A.callbackId,data:B})},function(B){x.postMessage({sourceName:u,targetName:R,callback:h.ERROR,callbackId:A.callbackId,reason:S(B)})});return}if(A.streamId){this._createStreamSink(A);return}F(A.data)},x.addEventListener("message",this._onComObjOnMessage)}on(f,_){const x=this.actionHandler;if(x[f])throw new Error(`There is already an actionName called "${f}"`);x[f]=_}send(f,_,x){this._postMessage({sourceName:this.sourceName,targetName:this.targetName,action:f,data:_},x)}sendWithPromise(f,_,x){const E=this.callbackId++,A=(0,t.createPromiseCapability)();this.callbackCapabilities[E]=A;try{this._postMessage({sourceName:this.sourceName,targetName:this.targetName,action:f,callbackId:E,data:_},x)}catch(F){A.reject(F)}return A.promise}sendWithStream(f,_,x,E){const A=this.streamId++,F=this.sourceName,u=this.targetName,R=this.comObj;return new ReadableStream({start:B=>{const I=(0,t.createPromiseCapability)();return this.streamControllers[A]={controller:B,startCall:I,pullCall:null,cancelCall:null,isClosed:!1},this._postMessage({sourceName:F,targetName:u,action:f,streamId:A,data:_,desiredSize:B.desiredSize},E),I.promise},pull:B=>{const I=(0,t.createPromiseCapability)();return this.streamControllers[A].pullCall=I,R.postMessage({sourceName:F,targetName:u,stream:p.PULL,streamId:A,desiredSize:B.desiredSize}),I.promise},cancel:B=>{(0,t.assert)(B instanceof Error,"cancel must have a valid reason");const I=(0,t.createPromiseCapability)();return this.streamControllers[A].cancelCall=I,this.streamControllers[A].isClosed=!0,R.postMessage({sourceName:F,targetName:u,stream:p.CANCEL,streamId:A,reason:S(B)}),I.promise}},x)}_createStreamSink(f){const _=f.streamId,x=this.sourceName,E=f.sourceName,A=this.comObj,F=this,u=this.actionHandler[f.action],R={enqueue(B,I=1,w){if(this.isCancelled)return;const s=this.desiredSize;this.desiredSize-=I,s>0&&this.desiredSize<=0&&(this.sinkCapability=(0,t.createPromiseCapability)(),this.ready=this.sinkCapability.promise),F._postMessage({sourceName:x,targetName:E,stream:p.ENQUEUE,streamId:_,chunk:B},w)},close(){this.isCancelled||(this.isCancelled=!0,A.postMessage({sourceName:x,targetName:E,stream:p.CLOSE,streamId:_}),delete F.streamSinks[_])},error(B){(0,t.assert)(B instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,A.postMessage({sourceName:x,targetName:E,stream:p.ERROR,streamId:_,reason:S(B)}))},sinkCapability:(0,t.createPromiseCapability)(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:f.desiredSize,ready:null};R.sinkCapability.resolve(),R.ready=R.sinkCapability.promise,this.streamSinks[_]=R,new Promise(function(B){B(u(f.data,R))}).then(function(){A.postMessage({sourceName:x,targetName:E,stream:p.START_COMPLETE,streamId:_,success:!0})},function(B){A.postMessage({sourceName:x,targetName:E,stream:p.START_COMPLETE,streamId:_,reason:S(B)})})}_processStreamMessage(f){const _=f.streamId,x=this.sourceName,E=f.sourceName,A=this.comObj,F=this.streamControllers[_],u=this.streamSinks[_];switch(f.stream){case p.START_COMPLETE:f.success?F.startCall.resolve():F.startCall.reject(S(f.reason));break;case p.PULL_COMPLETE:f.success?F.pullCall.resolve():F.pullCall.reject(S(f.reason));break;case p.PULL:if(!u){A.postMessage({sourceName:x,targetName:E,stream:p.PULL_COMPLETE,streamId:_,success:!0});break}u.desiredSize<=0&&f.desiredSize>0&&u.sinkCapability.resolve(),u.desiredSize=f.desiredSize,new Promise(function(R){R(u.onPull&&u.onPull())}).then(function(){A.postMessage({sourceName:x,targetName:E,stream:p.PULL_COMPLETE,streamId:_,success:!0})},function(R){A.postMessage({sourceName:x,targetName:E,stream:p.PULL_COMPLETE,streamId:_,reason:S(R)})});break;case p.ENQUEUE:if((0,t.assert)(F,"enqueue should have stream controller"),F.isClosed)break;F.controller.enqueue(f.chunk);break;case p.CLOSE:if((0,t.assert)(F,"close should have stream controller"),F.isClosed)break;F.isClosed=!0,F.controller.close(),this._deleteStreamController(F,_);break;case p.ERROR:(0,t.assert)(F,"error should have stream controller"),F.controller.error(S(f.reason)),this._deleteStreamController(F,_);break;case p.CANCEL_COMPLETE:f.success?F.cancelCall.resolve():F.cancelCall.reject(S(f.reason)),this._deleteStreamController(F,_);break;case p.CANCEL:if(!u)break;new Promise(function(R){R(u.onCancel&&u.onCancel(S(f.reason)))}).then(function(){A.postMessage({sourceName:x,targetName:E,stream:p.CANCEL_COMPLETE,streamId:_,success:!0})},function(R){A.postMessage({sourceName:x,targetName:E,stream:p.CANCEL_COMPLETE,streamId:_,reason:S(R)})}),u.sinkCapability.reject(S(f.reason)),u.isCancelled=!0,delete this.streamSinks[_];break;default:throw new Error("Unexpected stream case")}}async _deleteStreamController(f,_){await Promise.allSettled([f.startCall&&f.startCall.promise,f.pullCall&&f.pullCall.promise,f.cancelCall&&f.cancelCall.promise]),delete this.streamControllers[_]}_postMessage(f,_){_&&this.postMessageTransfers?this.comObj.postMessage(f,_):this.comObj.postMessage(f)}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}n.MessageHandler=m},(G,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.Metadata=void 0;var t=o(2);class h{constructor({parsedData:S,rawData:m}){this._metadataMap=S,this._data=m}getRaw(){return this._data}get(S){return this._metadataMap.get(S)??null}getAll(){return(0,t.objectFromMap)(this._metadataMap)}has(S){return this._metadataMap.has(S)}}n.Metadata=h},(G,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.OptionalContentConfig=void 0;var t=o(2);class h{constructor(m,b){this.visible=!0,this.name=m,this.intent=b}}class p{constructor(m){if(this.name=null,this.creator=null,this._order=null,this._groups=new Map,m!==null){this.name=m.name,this.creator=m.creator,this._order=m.order;for(const b of m.groups)this._groups.set(b.id,new h(b.name,b.intent));if(m.baseState==="OFF")for(const b of this._groups)b.visible=!1;for(const b of m.on)this._groups.get(b).visible=!0;for(const b of m.off)this._groups.get(b).visible=!1}}_evaluateVisibilityExpression(m){const b=m.length;if(b<2)return!0;const f=m[0];for(let _=1;_<b;_++){const x=m[_];let E;if(Array.isArray(x))E=this._evaluateVisibilityExpression(x);else if(this._groups.has(x))E=this._groups.get(x).visible;else return(0,t.warn)(`Optional content group not found: ${x}`),!0;switch(f){case"And":if(!E)return!1;break;case"Or":if(E)return!0;break;case"Not":return!E;default:return!0}}return f==="And"}isVisible(m){if(this._groups.size===0)return!0;if(!m)return(0,t.warn)("Optional content group not defined."),!0;if(m.type==="OCG")return this._groups.has(m.id)?this._groups.get(m.id).visible:((0,t.warn)(`Optional content group not found: ${m.id}`),!0);if(m.type==="OCMD"){if(m.expression)return this._evaluateVisibilityExpression(m.expression);if(!m.policy||m.policy==="AnyOn"){for(const b of m.ids){if(!this._groups.has(b))return(0,t.warn)(`Optional content group not found: ${b}`),!0;if(this._groups.get(b).visible)return!0}return!1}else if(m.policy==="AllOn"){for(const b of m.ids){if(!this._groups.has(b))return(0,t.warn)(`Optional content group not found: ${b}`),!0;if(!this._groups.get(b).visible)return!1}return!0}else if(m.policy==="AnyOff"){for(const b of m.ids){if(!this._groups.has(b))return(0,t.warn)(`Optional content group not found: ${b}`),!0;if(!this._groups.get(b).visible)return!0}return!1}else if(m.policy==="AllOff"){for(const b of m.ids){if(!this._groups.has(b))return(0,t.warn)(`Optional content group not found: ${b}`),!0;if(this._groups.get(b).visible)return!1}return!0}return(0,t.warn)(`Unknown optional content policy ${m.policy}.`),!0}return(0,t.warn)(`Unknown group type ${m.type}.`),!0}setVisibility(m,b=!0){if(!this._groups.has(m)){(0,t.warn)(`Optional content group not found: ${m}`);return}this._groups.get(m).visible=!!b}getOrder(){return this._groups.size?this._order?this._order.slice():Array.from(this._groups.keys()):null}getGroups(){return this._groups.size>0?(0,t.objectFromMap)(this._groups):null}getGroup(m){return this._groups.get(m)||null}}n.OptionalContentConfig=p},(G,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFDataTransportStream=void 0;var t=o(2),h=o(1);class p{constructor(f,_){(0,t.assert)(_,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=f.progressiveDone||!1,this._contentDispositionFilename=f.contentDispositionFilename||null;const x=f.initialData;if((x==null?void 0:x.length)>0){const E=new Uint8Array(x).buffer;this._queuedChunks.push(E)}this._pdfDataRangeTransport=_,this._isStreamingSupported=!f.disableStream,this._isRangeSupported=!f.disableRange,this._contentLength=f.length,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener((E,A)=>{this._onReceiveData({begin:E,chunk:A})}),this._pdfDataRangeTransport.addProgressListener((E,A)=>{this._onProgress({loaded:E,total:A})}),this._pdfDataRangeTransport.addProgressiveReadListener(E=>{this._onReceiveData({chunk:E})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData(f){const _=new Uint8Array(f.chunk).buffer;if(f.begin===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(_):this._queuedChunks.push(_);else{const x=this._rangeReaders.some(function(E){return E._begin!==f.begin?!1:(E._enqueue(_),!0)});(0,t.assert)(x,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var f;return((f=this._fullRequestReader)==null?void 0:f._loaded)??0}_onProgress(f){if(f.total===void 0){const _=this._rangeReaders[0];_!=null&&_.onProgress&&_.onProgress({loaded:f.loaded})}else{const _=this._fullRequestReader;_!=null&&_.onProgress&&_.onProgress({loaded:f.loaded,total:f.total})}}_onProgressiveDone(){this._fullRequestReader&&this._fullRequestReader.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(f){const _=this._rangeReaders.indexOf(f);_>=0&&this._rangeReaders.splice(_,1)}getFullReader(){(0,t.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const f=this._queuedChunks;return this._queuedChunks=null,new S(this,f,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(f,_){if(_<=this._progressiveDataLength)return null;const x=new m(this,f,_);return this._pdfDataRangeTransport.requestDataRange(f,_),this._rangeReaders.push(x),x}cancelAllRequests(f){this._fullRequestReader&&this._fullRequestReader.cancel(f);for(const _ of this._rangeReaders.slice(0))_.cancel(f);this._pdfDataRangeTransport.abort()}}n.PDFDataTransportStream=p;class S{constructor(f,_,x=!1,E=null){this._stream=f,this._done=x||!1,this._filename=(0,h.isPdfFile)(E)?E:null,this._queuedChunks=_||[],this._loaded=0;for(const A of this._queuedChunks)this._loaded+=A.byteLength;this._requests=[],this._headersReady=Promise.resolve(),f._fullRequestReader=this,this.onProgress=null}_enqueue(f){this._done||(this._requests.length>0?this._requests.shift().resolve({value:f,done:!1}):this._queuedChunks.push(f),this._loaded+=f.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const f=(0,t.createPromiseCapability)();return this._requests.push(f),f.promise}cancel(f){this._done=!0;for(const _ of this._requests)_.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class m{constructor(f,_,x){this._stream=f,this._begin=_,this._end=x,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(f){if(!this._done){if(this._requests.length===0)this._queuedChunk=f;else{this._requests.shift().resolve({value:f,done:!1});for(const x of this._requests)x.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const _=this._queuedChunk;return this._queuedChunk=null,{value:_,done:!1}}if(this._done)return{value:void 0,done:!0};const f=(0,t.createPromiseCapability)();return this._requests.push(f),f.promise}cancel(f){this._done=!0;for(const _ of this._requests)_.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}},(G,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.XfaText=void 0;class o{static textContent(h){const p=[],S={items:p,styles:Object.create(null)};function m(b){var x;if(!b)return;let f=null;const _=b.name;if(_==="#text")f=b.value;else if(o.shouldBuildText(_))(x=b==null?void 0:b.attributes)!=null&&x.textContent?f=b.attributes.textContent:b.value&&(f=b.value);else return;if(f!==null&&p.push({str:f}),!!b.children)for(const E of b.children)m(E)}return m(h),S}static shouldBuildText(h){return!(h==="textarea"||h==="input"||h==="option"||h==="select")}}n.XfaText=o},(G,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.AnnotationLayer=void 0;var t=o(2),h=o(1),p=o(9),S=o(19);const m=1e3,b=new WeakSet;class f{static create(e){switch(e.data.annotationType){case t.AnnotationType.LINK:return new x(e);case t.AnnotationType.TEXT:return new E(e);case t.AnnotationType.WIDGET:switch(e.data.fieldType){case"Tx":return new F(e);case"Btn":return e.data.radioButton?new R(e):e.data.checkBox?new u(e):new B(e);case"Ch":return new I(e)}return new A(e);case t.AnnotationType.POPUP:return new w(e);case t.AnnotationType.FREETEXT:return new a(e);case t.AnnotationType.LINE:return new g(e);case t.AnnotationType.SQUARE:return new v(e);case t.AnnotationType.CIRCLE:return new y(e);case t.AnnotationType.POLYLINE:return new O(e);case t.AnnotationType.CARET:return new Q(e);case t.AnnotationType.INK:return new V(e);case t.AnnotationType.POLYGON:return new M(e);case t.AnnotationType.HIGHLIGHT:return new k(e);case t.AnnotationType.UNDERLINE:return new L(e);case t.AnnotationType.SQUIGGLY:return new H(e);case t.AnnotationType.STRIKEOUT:return new q(e);case t.AnnotationType.STAMP:return new W(e);case t.AnnotationType.FILEATTACHMENT:return new K(e);default:return new _(e)}}}class _{constructor(e,{isRenderable:r=!1,ignoreBorder:i=!1,createQuadrilaterals:d=!1}={}){this.isRenderable=r,this.data=e.data,this.layer=e.layer,this.page=e.page,this.viewport=e.viewport,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this._mouseState=e.mouseState,r&&(this.container=this._createContainer(i)),d&&(this.quadrilaterals=this._createQuadrilaterals(i))}_createContainer(e=!1){const r=this.data,i=this.page,d=this.viewport,l=document.createElement("section");let C=r.rect[2]-r.rect[0],P=r.rect[3]-r.rect[1];l.setAttribute("data-annotation-id",r.id);const N=t.Util.normalizeRect([r.rect[0],i.view[3]-r.rect[1]+i.view[1],r.rect[2],i.view[3]-r.rect[3]+i.view[1]]);if(l.style.transform=`matrix(${d.transform.join(",")})`,l.style.transformOrigin=`${-N[0]}px ${-N[1]}px`,!e&&r.borderStyle.width>0){l.style.borderWidth=`${r.borderStyle.width}px`,r.borderStyle.style!==t.AnnotationBorderStyleType.UNDERLINE&&(C-=2*r.borderStyle.width,P-=2*r.borderStyle.width);const j=r.borderStyle.horizontalCornerRadius,D=r.borderStyle.verticalCornerRadius;if(j>0||D>0){const X=`${j}px / ${D}px`;l.style.borderRadius=X}switch(r.borderStyle.style){case t.AnnotationBorderStyleType.SOLID:l.style.borderStyle="solid";break;case t.AnnotationBorderStyleType.DASHED:l.style.borderStyle="dashed";break;case t.AnnotationBorderStyleType.BEVELED:(0,t.warn)("Unimplemented border style: beveled");break;case t.AnnotationBorderStyleType.INSET:(0,t.warn)("Unimplemented border style: inset");break;case t.AnnotationBorderStyleType.UNDERLINE:l.style.borderBottomStyle="solid";break}r.borderColor||r.color||null?l.style.borderColor=t.Util.makeHexColor(r.color[0]|0,r.color[1]|0,r.color[2]|0):l.style.borderWidth=0}return l.style.left=`${N[0]}px`,l.style.top=`${N[1]}px`,l.style.width=`${C}px`,l.style.height=`${P}px`,l}_createQuadrilaterals(e=!1){if(!this.data.quadPoints)return null;const r=[],i=this.data.rect;for(const d of this.data.quadPoints)this.data.rect=[d[2].x,d[2].y,d[1].x,d[1].y],r.push(this._createContainer(e));return this.data.rect=i,r}_createPopup(e,r){let i=this.container;this.quadrilaterals&&(e=e||this.quadrilaterals,i=this.quadrilaterals[0]),e||(e=document.createElement("div"),e.style.height=i.style.height,e.style.width=i.style.width,i.appendChild(e));const l=new s({container:i,trigger:e,color:r.color,titleObj:r.titleObj,modificationDate:r.modificationDate,contentsObj:r.contentsObj,hideWrapper:!0}).render();l.style.left=i.style.width,i.appendChild(l)}_renderQuadrilaterals(e){for(const r of this.quadrilaterals)r.className=e;return this.quadrilaterals}render(){(0,t.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,r=null){const i=[];if(this._fieldObjects){const d=this._fieldObjects[e];if(d)for(const{page:l,id:C,exportValues:P}of d){if(l===-1||C===r)continue;const N=typeof P=="string"?P:null,j=document.getElementById(C);if(j&&!b.has(j)){(0,t.warn)(`_getElementsByName - element not allowed: ${C}`);continue}i.push({id:C,exportValue:N,domElement:j})}return i}for(const d of document.getElementsByName(e)){const{id:l,exportValue:C}=d;l!==r&&b.has(d)&&i.push({id:l,exportValue:C,domElement:d})}return i}static get platform(){const e=typeof navigator<"u"?navigator.platform:"";return(0,t.shadow)(this,"platform",{isWin:e.includes("Win"),isMac:e.includes("Mac")})}}class x extends _{constructor(e){const r=!!(e.data.url||e.data.dest||e.data.action||e.data.isTooltipOnly||e.data.resetForm||e.data.actions&&(e.data.actions.Action||e.data.actions["Mouse Up"]||e.data.actions["Mouse Down"]));super(e,{isRenderable:r,createQuadrilaterals:!0})}render(){var d;const{data:e,linkService:r}=this,i=document.createElement("a");if(e.url)r.addLinkAttributes||(0,t.warn)("LinkAnnotationElement.render - missing `addLinkAttributes`-method on the `linkService`-instance."),(d=r.addLinkAttributes)==null||d.call(r,i,e.url,e.newWindow);else if(e.action)this._bindNamedAction(i,e.action);else if(e.dest)this._bindLink(i,e.dest);else{let l=!1;e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(l=!0,this._bindJSAction(i,e)),e.resetForm?this._bindResetFormAction(i,e.resetForm):l||this._bindLink(i,"")}return this.quadrilaterals?this._renderQuadrilaterals("linkAnnotation").map((l,C)=>{const P=C===0?i:i.cloneNode();return l.appendChild(P),l}):(this.container.className="linkAnnotation",this.container.appendChild(i),this.container)}_bindLink(e,r){e.href=this.linkService.getDestinationHash(r),e.onclick=()=>(r&&this.linkService.goToDestination(r),!1),(r||r==="")&&(e.className="internalLink")}_bindNamedAction(e,r){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(r),!1),e.className="internalLink"}_bindJSAction(e,r){e.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const d of Object.keys(r.actions)){const l=i.get(d);l&&(e[l]=()=>{var C;return(C=this.linkService.eventBus)==null||C.dispatch("dispatcheventinsandbox",{source:this,detail:{id:r.id,name:d}}),!1})}e.onclick||(e.onclick=()=>!1),e.className="internalLink"}_bindResetFormAction(e,r){const i=e.onclick;if(i||(e.href=this.linkService.getAnchorUrl("")),e.className="internalLink",!this._fieldObjects){(0,t.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(e.onclick=()=>!1);return}e.onclick=()=>{var D;i&&i();const{fields:d,refs:l,include:C}=r,P=[];if(d.length!==0||l.length!==0){const $=new Set(l);for(const X of d){const J=this._fieldObjects[X]||[];for(const{id:Z}of J)$.add(Z)}for(const X of Object.values(this._fieldObjects))for(const J of X)$.has(J.id)===C&&P.push(J)}else for(const $ of Object.values(this._fieldObjects))P.push(...$);const N=this.annotationStorage,j=[];for(const $ of P){const{id:X}=$;switch(j.push(X),$.type){case"text":{const Z=$.defaultValue||"";N.setValue(X,{value:Z,valueAsString:Z});break}case"checkbox":case"radiobutton":{const Z=$.defaultValue===$.exportValues;N.setValue(X,{value:Z});break}case"combobox":case"listbox":{const Z=$.defaultValue||"";N.setValue(X,{value:Z});break}default:continue}const J=document.getElementById(X);!J||!b.has(J)||J.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((D=this.linkService.eventBus)==null||D.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:j,name:"ResetForm"}})),!1}}}class E extends _{constructor(e){var i,d;const r=!!(e.data.hasPopup||(i=e.data.titleObj)!=null&&i.str||(d=e.data.contentsObj)!=null&&d.str);super(e,{isRenderable:r})}render(){this.container.className="textAnnotation";const e=document.createElement("img");return e.style.height=this.container.style.height,e.style.width=this.container.style.width,e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.alt="[{{type}} Annotation]",e.dataset.l10nId="text_annotation_type",e.dataset.l10nArgs=JSON.stringify({type:this.data.name}),this.data.hasPopup||this._createPopup(e,this.data),this.container.appendChild(e),this.container}}class A extends _{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}_getKeyModifier(e){const{isWin:r,isMac:i}=_.platform;return r&&e.ctrlKey||i&&e.metaKey}_setEventListener(e,r,i,d){r.includes("mouse")?e.addEventListener(r,l=>{var C;(C=this.linkService.eventBus)==null||C.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:d(l),shift:l.shiftKey,modifier:this._getKeyModifier(l)}})}):e.addEventListener(r,l=>{var C;(C=this.linkService.eventBus)==null||C.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:i,value:l.target.checked}})})}_setEventListeners(e,r,i){var d;for(const[l,C]of r)(C==="Action"||(d=this.data.actions)!=null&&d[C])&&this._setEventListener(e,l,C,i)}_setBackgroundColor(e){const r=this.data.backgroundColor||null;e.style.backgroundColor=r===null?"transparent":t.Util.makeHexColor(r[0],r[1],r[2])}_dispatchEventFromSandbox(e,r){const i=(l,C,P)=>{const N=P.detail[l];P.target.style[C]=S.ColorConverters[`${N[0]}_HTML`](N.slice(1))},d={display:l=>{const C=l.detail.display%2===1;l.target.style.visibility=C?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:C,print:l.detail.display===0||l.detail.display===3})},print:l=>{this.annotationStorage.setValue(this.data.id,{print:l.detail.print})},hidden:l=>{l.target.style.visibility=l.detail.hidden?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{hidden:l.detail.hidden})},focus:l=>{setTimeout(()=>l.target.focus({preventScroll:!1}),0)},userName:l=>{l.target.title=l.detail.userName},readonly:l=>{l.detail.readonly?l.target.setAttribute("readonly",""):l.target.removeAttribute("readonly")},required:l=>{l.detail.required?l.target.setAttribute("required",""):l.target.removeAttribute("required")},bgColor:l=>{i("bgColor","backgroundColor",l)},fillColor:l=>{i("fillColor","backgroundColor",l)},fgColor:l=>{i("fgColor","color",l)},textColor:l=>{i("textColor","color",l)},borderColor:l=>{i("borderColor","borderColor",l)},strokeColor:l=>{i("strokeColor","borderColor",l)}};for(const l of Object.keys(r.detail)){const C=e[l]||d[l];C&&C(r)}}}class F extends A{constructor(e){const r=e.renderForms||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:r})}setPropertyOnSiblings(e,r,i,d){const l=this.annotationStorage;for(const C of this._getElementsByName(e.name,e.id))C.domElement&&(C.domElement[r]=i),l.setValue(C.id,{[d]:i})}render(){var d;const e=this.annotationStorage,r=this.data.id;this.container.className="textWidgetAnnotation";let i=null;if(this.renderForms){const l=e.getValue(r,{value:this.data.fieldValue,valueAsString:this.data.fieldValue}),C=l.valueAsString||l.value||"",P={userValue:null,formattedValue:null,beforeInputSelectionRange:null,beforeInputValue:null};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=C):(i=document.createElement("input"),i.type="text",i.setAttribute("value",C)),b.add(i),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=m,P.userValue=C,i.setAttribute("id",r),i.addEventListener("input",j=>{e.setValue(r,{value:j.target.value}),this.setPropertyOnSiblings(i,"value",j.target.value,"value")}),i.addEventListener("resetform",j=>{const D=this.data.defaultFieldValue||"";i.value=P.userValue=D,delete P.formattedValue});let N=j=>{P.formattedValue&&(j.target.value=P.formattedValue),j.target.scrollLeft=0,P.beforeInputSelectionRange=null};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",D=>{P.userValue&&(D.target.value=P.userValue)}),i.addEventListener("updatefromsandbox",D=>{const $={value(X){P.userValue=X.detail.value||"",e.setValue(r,{value:P.userValue.toString()}),P.formattedValue||(X.target.value=P.userValue)},valueAsString(X){P.formattedValue=X.detail.valueAsString||"",X.target!==document.activeElement&&(X.target.value=P.formattedValue),e.setValue(r,{formattedValue:P.formattedValue})},selRange(X){const[J,Z]=X.detail.selRange;J>=0&&Z<X.target.value.length&&X.target.setSelectionRange(J,Z)}};this._dispatchEventFromSandbox($,D)}),i.addEventListener("keydown",D=>{var X;P.beforeInputValue=D.target.value;let $=-1;D.key==="Escape"?$=0:D.key==="Enter"?$=2:D.key==="Tab"&&($=3),$!==-1&&(P.userValue=D.target.value,(X=this.linkService.eventBus)==null||X.dispatch("dispatcheventinsandbox",{source:this,detail:{id:r,name:"Keystroke",value:D.target.value,willCommit:!0,commitKey:$,selStart:D.target.selectionStart,selEnd:D.target.selectionEnd}}))});const j=N;N=null,i.addEventListener("blur",D=>{var $;this._mouseState.isDown&&(P.userValue=D.target.value,($=this.linkService.eventBus)==null||$.dispatch("dispatcheventinsandbox",{source:this,detail:{id:r,name:"Keystroke",value:D.target.value,willCommit:!0,commitKey:1,selStart:D.target.selectionStart,selEnd:D.target.selectionEnd}})),j(D)}),i.addEventListener("mousedown",D=>{P.beforeInputValue=D.target.value,P.beforeInputSelectionRange=null}),i.addEventListener("keyup",D=>{D.target.selectionStart===D.target.selectionEnd&&(P.beforeInputSelectionRange=null)}),i.addEventListener("select",D=>{P.beforeInputSelectionRange=[D.target.selectionStart,D.target.selectionEnd]}),(d=this.data.actions)!=null&&d.Keystroke&&i.addEventListener("input",D=>{var J;let $=-1,X=-1;P.beforeInputSelectionRange&&([$,X]=P.beforeInputSelectionRange),(J=this.linkService.eventBus)==null||J.dispatch("dispatcheventinsandbox",{source:this,detail:{id:r,name:"Keystroke",value:P.beforeInputValue,change:D.data,willCommit:!1,selStart:$,selEnd:X}})}),this._setEventListeners(i,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],D=>D.target.value)}if(N&&i.addEventListener("blur",N),this.data.maxLen!==null&&(i.maxLength=this.data.maxLen),this.data.comb){const D=(this.data.rect[2]-this.data.rect[0])/this.data.maxLen;i.classList.add("comb"),i.style.letterSpacing=`calc(${D}px - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell";return this._setTextStyle(i),this._setBackgroundColor(i),this.container.appendChild(i),this.container}_setTextStyle(e){const r=["left","center","right"],{fontSize:i,fontColor:d}=this.data.defaultAppearanceData,l=e.style;i&&(l.fontSize=`${i}px`),l.color=t.Util.makeHexColor(d[0],d[1],d[2]),this.data.textAlignment!==null&&(l.textAlign=r[this.data.textAlignment])}}class u extends A{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,r=this.data,i=r.id;let d=e.getValue(i,{value:r.exportValue===r.fieldValue}).value;typeof d=="string"&&(d=d!=="Off",e.setValue(i,{value:d})),this.container.className="buttonWidgetAnnotation checkBox";const l=document.createElement("input");return b.add(l),l.disabled=r.readOnly,l.type="checkbox",l.name=r.fieldName,d&&l.setAttribute("checked",!0),l.setAttribute("id",i),l.setAttribute("exportValue",r.exportValue),l.tabIndex=m,l.addEventListener("change",C=>{const{name:P,checked:N}=C.target;for(const j of this._getElementsByName(P,i)){const D=N&&j.exportValue===r.exportValue;j.domElement&&(j.domElement.checked=D),e.setValue(j.id,{value:D})}e.setValue(i,{value:N})}),l.addEventListener("resetform",C=>{const P=r.defaultFieldValue||"Off";C.target.checked=P===r.exportValue}),this.enableScripting&&this.hasJSActions&&(l.addEventListener("updatefromsandbox",C=>{const P={value(N){N.target.checked=N.detail.value!=="Off",e.setValue(i,{value:N.target.checked})}};this._dispatchEventFromSandbox(P,C)}),this._setEventListeners(l,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],C=>C.target.checked)),this._setBackgroundColor(l),this.container.appendChild(l),this.container}}class R extends A{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.className="buttonWidgetAnnotation radioButton";const e=this.annotationStorage,r=this.data,i=r.id;let d=e.getValue(i,{value:r.fieldValue===r.buttonValue}).value;typeof d=="string"&&(d=d!==r.buttonValue,e.setValue(i,{value:d}));const l=document.createElement("input");if(b.add(l),l.disabled=r.readOnly,l.type="radio",l.name=r.fieldName,d&&l.setAttribute("checked",!0),l.setAttribute("id",i),l.tabIndex=m,l.addEventListener("change",C=>{const{name:P,checked:N}=C.target;for(const j of this._getElementsByName(P,i))e.setValue(j.id,{value:!1});e.setValue(i,{value:N})}),l.addEventListener("resetform",C=>{const P=r.defaultFieldValue;C.target.checked=P!=null&&P===r.buttonValue}),this.enableScripting&&this.hasJSActions){const C=r.buttonValue;l.addEventListener("updatefromsandbox",P=>{const N={value:j=>{const D=C===j.detail.value;for(const $ of this._getElementsByName(j.target.name)){const X=D&&$.id===i;$.domElement&&($.domElement.checked=X),e.setValue($.id,{value:X})}}};this._dispatchEventFromSandbox(N,P)}),this._setEventListeners(l,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],P=>P.target.checked)}return this._setBackgroundColor(l),this.container.appendChild(l),this.container}}class B extends x{render(){const e=super.render();return e.className="buttonWidgetAnnotation pushButton",this.data.alternativeText&&(e.title=this.data.alternativeText),e}}class I extends A{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.className="choiceWidgetAnnotation";const e=this.annotationStorage,r=this.data.id;e.getValue(r,{value:this.data.fieldValue.length>0?this.data.fieldValue[0]:void 0});let{fontSize:i}=this.data.defaultAppearanceData;i||(i=9);const d=`calc(${i}px * var(--zoom-factor))`,l=document.createElement("select");b.add(l),l.disabled=this.data.readOnly,l.name=this.data.fieldName,l.setAttribute("id",r),l.tabIndex=m,l.style.fontSize=`${i}px`,this.data.combo||(l.size=this.data.options.length,this.data.multiSelect&&(l.multiple=!0)),l.addEventListener("resetform",N=>{const j=this.data.defaultFieldValue;for(const D of l.options)D.selected=D.value===j});for(const N of this.data.options){const j=document.createElement("option");j.textContent=N.displayValue,j.value=N.exportValue,this.data.combo&&(j.style.fontSize=d),this.data.fieldValue.includes(N.exportValue)&&j.setAttribute("selected",!0),l.appendChild(j)}const C=(N,j)=>{const D=j?"value":"textContent",$=N.target.options;return N.target.multiple?Array.prototype.filter.call($,X=>X.selected).map(X=>X[D]):$.selectedIndex===-1?null:$[$.selectedIndex][D]},P=N=>{const j=N.target.options;return Array.prototype.map.call(j,D=>({displayValue:D.textContent,exportValue:D.value}))};return this.enableScripting&&this.hasJSActions?(l.addEventListener("updatefromsandbox",N=>{const j={value(D){const $=D.detail.value,X=new Set(Array.isArray($)?$:[$]);for(const J of l.options)J.selected=X.has(J.value);e.setValue(r,{value:C(D,!0)})},multipleSelection(D){l.multiple=!0},remove(D){const $=l.options,X=D.detail.remove;$[X].selected=!1,l.remove(X),$.length>0&&Array.prototype.findIndex.call($,Z=>Z.selected)===-1&&($[0].selected=!0),e.setValue(r,{value:C(D,!0),items:P(D)})},clear(D){for(;l.length!==0;)l.remove(0);e.setValue(r,{value:null,items:[]})},insert(D){const{index:$,displayValue:X,exportValue:J}=D.detail.insert,Z=document.createElement("option");Z.textContent=X,Z.value=J,l.insertBefore(Z,l.children[$]),e.setValue(r,{value:C(D,!0),items:P(D)})},items(D){const{items:$}=D.detail;for(;l.length!==0;)l.remove(0);for(const X of $){const{displayValue:J,exportValue:Z}=X,ie=document.createElement("option");ie.textContent=J,ie.value=Z,l.appendChild(ie)}l.options.length>0&&(l.options[0].selected=!0),e.setValue(r,{value:C(D,!0),items:P(D)})},indices(D){const $=new Set(D.detail.indices);for(const X of D.target.options)X.selected=$.has(X.index);e.setValue(r,{value:C(D,!0)})},editable(D){D.target.disabled=!D.detail.editable}};this._dispatchEventFromSandbox(j,N)}),l.addEventListener("input",N=>{var $;const j=C(N,!0),D=C(N,!1);e.setValue(r,{value:j}),($=this.linkService.eventBus)==null||$.dispatch("dispatcheventinsandbox",{source:this,detail:{id:r,name:"Keystroke",value:D,changeEx:j,willCommit:!0,commitKey:1,keyDown:!1}})}),this._setEventListeners(l,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"]],N=>N.target.checked)):l.addEventListener("input",function(N){e.setValue(r,{value:C(N)})}),this._setBackgroundColor(l),this.container.appendChild(l),this.container}}class w extends _{constructor(e){var i,d;const r=!!((i=e.data.titleObj)!=null&&i.str||(d=e.data.contentsObj)!=null&&d.str);super(e,{isRenderable:r})}render(){const e=["Line","Square","Circle","PolyLine","Polygon","Ink"];if(this.container.className="popupAnnotation",e.includes(this.data.parentType))return this.container;const r=`[data-annotation-id="${this.data.parentId}"]`,i=this.layer.querySelectorAll(r);if(i.length===0)return this.container;const d=new s({container:this.container,trigger:Array.from(i),color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj}),l=this.page,C=t.Util.normalizeRect([this.data.parentRect[0],l.view[3]-this.data.parentRect[1]+l.view[1],this.data.parentRect[2],l.view[3]-this.data.parentRect[3]+l.view[1]]),P=C[0]+this.data.parentRect[2]-this.data.parentRect[0],N=C[1];return this.container.style.transformOrigin=`${-P}px ${-N}px`,this.container.style.left=`${P}px`,this.container.style.top=`${N}px`,this.container.appendChild(d.render()),this.container}}class s{constructor(e){this.container=e.container,this.trigger=e.trigger,this.color=e.color,this.titleObj=e.titleObj,this.modificationDate=e.modificationDate,this.contentsObj=e.contentsObj,this.hideWrapper=e.hideWrapper||!1,this.pinned=!1}render(){const r=document.createElement("div");r.className="popupWrapper",this.hideElement=this.hideWrapper?r:this.container,this.hideElement.hidden=!0;const i=document.createElement("div");i.className="popup";const d=this.color;if(d){const N=.7*(255-d[0])+d[0],j=.7*(255-d[1])+d[1],D=.7*(255-d[2])+d[2];i.style.backgroundColor=t.Util.makeHexColor(N|0,j|0,D|0)}const l=document.createElement("h1");l.dir=this.titleObj.dir,l.textContent=this.titleObj.str,i.appendChild(l);const C=h.PDFDateString.toDateObject(this.modificationDate);if(C){const N=document.createElement("span");N.textContent="{{date}}, {{time}}",N.dataset.l10nId="annotation_date_string",N.dataset.l10nArgs=JSON.stringify({date:C.toLocaleDateString(),time:C.toLocaleTimeString()}),i.appendChild(N)}const P=this._formatContents(this.contentsObj);i.appendChild(P),Array.isArray(this.trigger)||(this.trigger=[this.trigger]);for(const N of this.trigger)N.addEventListener("click",this._toggle.bind(this)),N.addEventListener("mouseover",this._show.bind(this,!1)),N.addEventListener("mouseout",this._hide.bind(this,!1));return i.addEventListener("click",this._hide.bind(this,!0)),r.appendChild(i),r}_formatContents({str:e,dir:r}){const i=document.createElement("p");i.dir=r;const d=e.split(/(?:\r\n?|\n)/);for(let l=0,C=d.length;l<C;++l){const P=d[l];i.appendChild(document.createTextNode(P)),l<C-1&&i.appendChild(document.createElement("br"))}return i}_toggle(){this.pinned?this._hide(!0):this._show(!0)}_show(e=!1){e&&(this.pinned=!0),this.hideElement.hidden&&(this.hideElement.hidden=!1,this.container.style.zIndex+=1)}_hide(e=!0){e&&(this.pinned=!1),!this.hideElement.hidden&&!this.pinned&&(this.hideElement.hidden=!0,this.container.style.zIndex-=1)}}class a extends _{constructor(e){var i,d;const r=!!(e.data.hasPopup||(i=e.data.titleObj)!=null&&i.str||(d=e.data.contentsObj)!=null&&d.str);super(e,{isRenderable:r,ignoreBorder:!0})}render(){return this.container.className="freeTextAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class g extends _{constructor(e){var i,d;const r=!!(e.data.hasPopup||(i=e.data.titleObj)!=null&&i.str||(d=e.data.contentsObj)!=null&&d.str);super(e,{isRenderable:r,ignoreBorder:!0})}render(){this.container.className="lineAnnotation";const e=this.data,r=e.rect[2]-e.rect[0],i=e.rect[3]-e.rect[1],d=this.svgFactory.create(r,i),l=this.svgFactory.createElement("svg:line");return l.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),l.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),l.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),l.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),l.setAttribute("stroke-width",e.borderStyle.width||1),l.setAttribute("stroke","transparent"),d.appendChild(l),this.container.append(d),this._createPopup(l,e),this.container}}class v extends _{constructor(e){var i,d;const r=!!(e.data.hasPopup||(i=e.data.titleObj)!=null&&i.str||(d=e.data.contentsObj)!=null&&d.str);super(e,{isRenderable:r,ignoreBorder:!0})}render(){this.container.className="squareAnnotation";const e=this.data,r=e.rect[2]-e.rect[0],i=e.rect[3]-e.rect[1],d=this.svgFactory.create(r,i),l=e.borderStyle.width,C=this.svgFactory.createElement("svg:rect");return C.setAttribute("x",l/2),C.setAttribute("y",l/2),C.setAttribute("width",r-l),C.setAttribute("height",i-l),C.setAttribute("stroke-width",l||1),C.setAttribute("stroke","transparent"),C.setAttribute("fill","none"),d.appendChild(C),this.container.append(d),this._createPopup(C,e),this.container}}class y extends _{constructor(e){var i,d;const r=!!(e.data.hasPopup||(i=e.data.titleObj)!=null&&i.str||(d=e.data.contentsObj)!=null&&d.str);super(e,{isRenderable:r,ignoreBorder:!0})}render(){this.container.className="circleAnnotation";const e=this.data,r=e.rect[2]-e.rect[0],i=e.rect[3]-e.rect[1],d=this.svgFactory.create(r,i),l=e.borderStyle.width,C=this.svgFactory.createElement("svg:ellipse");return C.setAttribute("cx",r/2),C.setAttribute("cy",i/2),C.setAttribute("rx",r/2-l/2),C.setAttribute("ry",i/2-l/2),C.setAttribute("stroke-width",l||1),C.setAttribute("stroke","transparent"),C.setAttribute("fill","none"),d.appendChild(C),this.container.append(d),this._createPopup(C,e),this.container}}class O extends _{constructor(e){var i,d;const r=!!(e.data.hasPopup||(i=e.data.titleObj)!=null&&i.str||(d=e.data.contentsObj)!=null&&d.str);super(e,{isRenderable:r,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const e=this.data,r=e.rect[2]-e.rect[0],i=e.rect[3]-e.rect[1],d=this.svgFactory.create(r,i);let l=[];for(const P of e.vertices){const N=P.x-e.rect[0],j=e.rect[3]-P.y;l.push(N+","+j)}l=l.join(" ");const C=this.svgFactory.createElement(this.svgElementName);return C.setAttribute("points",l),C.setAttribute("stroke-width",e.borderStyle.width||1),C.setAttribute("stroke","transparent"),C.setAttribute("fill","none"),d.appendChild(C),this.container.append(d),this._createPopup(C,e),this.container}}class M extends O{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Q extends _{constructor(e){var i,d;const r=!!(e.data.hasPopup||(i=e.data.titleObj)!=null&&i.str||(d=e.data.contentsObj)!=null&&d.str);super(e,{isRenderable:r,ignoreBorder:!0})}render(){return this.container.className="caretAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class V extends _{constructor(e){var i,d;const r=!!(e.data.hasPopup||(i=e.data.titleObj)!=null&&i.str||(d=e.data.contentsObj)!=null&&d.str);super(e,{isRenderable:r,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline"}render(){this.container.className=this.containerClassName;const e=this.data,r=e.rect[2]-e.rect[0],i=e.rect[3]-e.rect[1],d=this.svgFactory.create(r,i);for(const l of e.inkLists){let C=[];for(const N of l){const j=N.x-e.rect[0],D=e.rect[3]-N.y;C.push(`${j},${D}`)}C=C.join(" ");const P=this.svgFactory.createElement(this.svgElementName);P.setAttribute("points",C),P.setAttribute("stroke-width",e.borderStyle.width||1),P.setAttribute("stroke","transparent"),P.setAttribute("fill","none"),this._createPopup(P,e),d.appendChild(P)}return this.container.append(d),this.container}}class k extends _{constructor(e){var i,d;const r=!!(e.data.hasPopup||(i=e.data.titleObj)!=null&&i.str||(d=e.data.contentsObj)!=null&&d.str);super(e,{isRenderable:r,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("highlightAnnotation"):(this.container.className="highlightAnnotation",this.container)}}class L extends _{constructor(e){var i,d;const r=!!(e.data.hasPopup||(i=e.data.titleObj)!=null&&i.str||(d=e.data.contentsObj)!=null&&d.str);super(e,{isRenderable:r,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("underlineAnnotation"):(this.container.className="underlineAnnotation",this.container)}}class H extends _{constructor(e){var i,d;const r=!!(e.data.hasPopup||(i=e.data.titleObj)!=null&&i.str||(d=e.data.contentsObj)!=null&&d.str);super(e,{isRenderable:r,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("squigglyAnnotation"):(this.container.className="squigglyAnnotation",this.container)}}class q extends _{constructor(e){var i,d;const r=!!(e.data.hasPopup||(i=e.data.titleObj)!=null&&i.str||(d=e.data.contentsObj)!=null&&d.str);super(e,{isRenderable:r,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return this.data.hasPopup||this._createPopup(null,this.data),this.quadrilaterals?this._renderQuadrilaterals("strikeoutAnnotation"):(this.container.className="strikeoutAnnotation",this.container)}}class W extends _{constructor(e){var i,d;const r=!!(e.data.hasPopup||(i=e.data.titleObj)!=null&&i.str||(d=e.data.contentsObj)!=null&&d.str);super(e,{isRenderable:r,ignoreBorder:!0})}render(){return this.container.className="stampAnnotation",this.data.hasPopup||this._createPopup(null,this.data),this.container}}class K extends _{constructor(e){var d;super(e,{isRenderable:!0});const{filename:r,content:i}=this.data.file;this.filename=(0,h.getFilenameFromUrl)(r),this.content=i,(d=this.linkService.eventBus)==null||d.dispatch("fileattachmentannotation",{source:this,id:(0,t.stringToPDFString)(r),filename:r,content:i})}render(){var r,i;this.container.className="fileAttachmentAnnotation";const e=document.createElement("div");return e.style.height=this.container.style.height,e.style.width=this.container.style.width,e.addEventListener("dblclick",this._download.bind(this)),!this.data.hasPopup&&((r=this.data.titleObj)!=null&&r.str||(i=this.data.contentsObj)!=null&&i.str)&&this._createPopup(e,this.data),this.container.appendChild(e),this.container}_download(){var e;(e=this.downloadManager)==null||e.openOrDownloadData(this.container,this.content,this.filename)}}class T{static render(e){const r=[],i=[];for(const d of e.annotations)if(d){if(d.annotationType===t.AnnotationType.POPUP){i.push(d);continue}r.push(d)}i.length&&r.push(...i);for(const d of r){const l=f.create({data:d,layer:e.div,page:e.page,viewport:e.viewport,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new h.DOMSVGFactory,annotationStorage:e.annotationStorage||new p.AnnotationStorage,enableScripting:e.enableScripting,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,mouseState:e.mouseState||{isDown:!1}});if(l.isRenderable){const C=l.render();if(d.hidden&&(C.style.visibility="hidden"),Array.isArray(C))for(const P of C)e.div.appendChild(P);else l instanceof w?e.div.prepend(C):e.div.appendChild(C)}}}static update(e){const r=`matrix(${e.viewport.transform.join(",")})`;for(const i of e.annotations){const d=e.div.querySelectorAll(`[data-annotation-id="${i.id}"]`);if(d)for(const l of d)l.style.transform=r}e.div.hidden=!1}}n.AnnotationLayer=T},(G,n)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.ColorConverters=void 0;function o(h){return Math.floor(Math.max(0,Math.min(1,h))*255).toString(16).padStart(2,"0")}class t{static CMYK_G([p,S,m,b]){return["G",1-Math.min(1,.3*p+.59*m+.11*S+b)]}static G_CMYK([p]){return["CMYK",0,0,0,1-p]}static G_RGB([p]){return["RGB",p,p,p]}static G_HTML([p]){const S=o(p);return`#${S}${S}${S}`}static RGB_G([p,S,m]){return["G",.3*p+.59*S+.11*m]}static RGB_HTML([p,S,m]){const b=o(p),f=o(S),_=o(m);return`#${b}${f}${_}`}static T_HTML(){return"#00000000"}static CMYK_RGB([p,S,m,b]){return["RGB",1-Math.min(1,p+b),1-Math.min(1,m+b),1-Math.min(1,S+b)]}static CMYK_HTML(p){return this.RGB_HTML(this.CMYK_RGB(p))}static RGB_CMYK([p,S,m]){const b=1-p,f=1-S,_=1-m,x=Math.min(b,f,_);return["CMYK",b,f,_,x]}}n.ColorConverters=t},(G,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.renderTextLayer=B;var t=o(2);const h=1e5,p=30,S=.8,m=new Map,b=/^\s+$/g;function f(I,w){const s=m.get(I);if(s)return s;w.save(),w.font=`${p}px ${I}`;const a=w.measureText("");let g=a.fontBoundingBoxAscent,v=Math.abs(a.fontBoundingBoxDescent);if(g){w.restore();const O=g/(g+v);return m.set(I,O),O}w.strokeStyle="red",w.clearRect(0,0,p,p),w.strokeText("g",0,0);let y=w.getImageData(0,0,p,p).data;v=0;for(let O=y.length-1-3;O>=0;O-=4)if(y[O]>0){v=Math.ceil(O/4/p);break}w.clearRect(0,0,p,p),w.strokeText("A",0,p),y=w.getImageData(0,0,p,p).data,g=0;for(let O=0,M=y.length;O<M;O+=4)if(y[O]>0){g=p-Math.floor(O/4/p);break}if(w.restore(),g){const O=g/(g+v);return m.set(I,O),O}return m.set(I,S),S}function _(I,w,s,a){const g=document.createElement("span"),v=I._enhanceTextSelection?{angle:0,canvasWidth:0,hasText:w.str!=="",hasEOL:w.hasEOL,originalTransform:null,paddingBottom:0,paddingLeft:0,paddingRight:0,paddingTop:0,scale:1}:{angle:0,canvasWidth:0,hasText:w.str!=="",hasEOL:w.hasEOL};I._textDivs.push(g);const y=t.Util.transform(I._viewport.transform,w.transform);let O=Math.atan2(y[1],y[0]);const M=s[w.fontName];M.vertical&&(O+=Math.PI/2);const Q=Math.hypot(y[2],y[3]),V=Q*f(M.fontFamily,a);let k,L;O===0?(k=y[4],L=y[5]-V):(k=y[4]+V*Math.sin(O),L=y[5]-V*Math.cos(O)),g.style.left=`${k}px`,g.style.top=`${L}px`,g.style.fontSize=`${Q}px`,g.style.fontFamily=M.fontFamily,g.setAttribute("role","presentation"),g.textContent=w.str,g.dir=w.dir,I._fontInspectorEnabled&&(g.dataset.fontName=w.fontName),O!==0&&(v.angle=O*(180/Math.PI));let H=!1;if(w.str.length>1||I._enhanceTextSelection&&b.test(w.str))H=!0;else if(w.transform[0]!==w.transform[3]){const q=Math.abs(w.transform[0]),W=Math.abs(w.transform[3]);q!==W&&Math.max(q,W)/Math.min(q,W)>1.5&&(H=!0)}if(H&&(M.vertical?v.canvasWidth=w.height*I._viewport.scale:v.canvasWidth=w.width*I._viewport.scale),I._textDivProperties.set(g,v),I._textContentStream&&I._layoutText(g),I._enhanceTextSelection&&v.hasText){let q=1,W=0;O!==0&&(q=Math.cos(O),W=Math.sin(O));const K=(M.vertical?w.height:w.width)*I._viewport.scale,T=Q;let c,e;O!==0?(c=[q,W,-W,q,k,L],e=t.Util.getAxialAlignedBoundingBox([0,0,K,T],c)):e=[k,L,k+K,L+T],I._bounds.push({left:e[0],top:e[1],right:e[2],bottom:e[3],div:g,size:[K,T],m:c})}}function x(I){if(I._canceled)return;const w=I._textDivs,s=I._capability,a=w.length;if(a>h){I._renderingDone=!0,s.resolve();return}if(!I._textContentStream)for(let g=0;g<a;g++)I._layoutText(w[g]);I._renderingDone=!0,s.resolve()}function E(I,w,s){let a=0;for(let g=0;g<s;g++){const v=I[w++];v>0&&(a=a?Math.min(v,a):v)}return a}function A(I){const w=I._bounds,s=I._viewport,a=F(s.width,s.height,w);for(let g=0;g<a.length;g++){const v=w[g].div,y=I._textDivProperties.get(v);if(y.angle===0){y.paddingLeft=w[g].left-a[g].left,y.paddingTop=w[g].top-a[g].top,y.paddingRight=a[g].right-w[g].right,y.paddingBottom=a[g].bottom-w[g].bottom,I._textDivProperties.set(v,y);continue}const O=a[g],M=w[g],Q=M.m,V=Q[0],k=Q[1],L=[[0,0],[0,M.size[1]],[M.size[0],0],M.size],H=new Float64Array(64);for(let W=0,K=L.length;W<K;W++){const T=t.Util.applyTransform(L[W],Q);H[W+0]=V&&(O.left-T[0])/V,H[W+4]=k&&(O.top-T[1])/k,H[W+8]=V&&(O.right-T[0])/V,H[W+12]=k&&(O.bottom-T[1])/k,H[W+16]=k&&(O.left-T[0])/-k,H[W+20]=V&&(O.top-T[1])/V,H[W+24]=k&&(O.right-T[0])/-k,H[W+28]=V&&(O.bottom-T[1])/V,H[W+32]=V&&(O.left-T[0])/-V,H[W+36]=k&&(O.top-T[1])/-k,H[W+40]=V&&(O.right-T[0])/-V,H[W+44]=k&&(O.bottom-T[1])/-k,H[W+48]=k&&(O.left-T[0])/k,H[W+52]=V&&(O.top-T[1])/-V,H[W+56]=k&&(O.right-T[0])/k,H[W+60]=V&&(O.bottom-T[1])/-V}const q=1+Math.min(Math.abs(V),Math.abs(k));y.paddingLeft=E(H,32,16)/q,y.paddingTop=E(H,48,16)/q,y.paddingRight=E(H,0,16)/q,y.paddingBottom=E(H,16,16)/q,I._textDivProperties.set(v,y)}}function F(I,w,s){const a=s.map(function(v,y){return{x1:v.left,y1:v.top,x2:v.right,y2:v.bottom,index:y,x1New:void 0,x2New:void 0}});u(I,a);const g=new Array(s.length);for(const v of a){const y=v.index;g[y]={left:v.x1New,top:0,right:v.x2New,bottom:0}}s.map(function(v,y){const O=g[y],M=a[y];M.x1=v.top,M.y1=I-O.right,M.x2=v.bottom,M.y2=I-O.left,M.index=y,M.x1New=void 0,M.x2New=void 0}),u(w,a);for(const v of a){const y=v.index;g[y].top=v.x1New,g[y].bottom=v.x2New}return g}function u(I,w){w.sort(function(g,v){return g.x1-v.x1||g.index-v.index});const a=[{start:-1/0,end:1/0,boundary:{x1:-1/0,y1:-1/0,x2:0,y2:1/0,index:-1,x1New:0,x2New:0}}];for(const g of w){let v=0;for(;v<a.length&&a[v].end<=g.y1;)v++;let y=a.length-1;for(;y>=0&&a[y].start>=g.y2;)y--;let O,M,Q,V,k=-1/0;for(Q=v;Q<=y;Q++){O=a[Q],M=O.boundary;let q;M.x2>g.x1?q=M.index>g.index?M.x1New:g.x1:M.x2New===void 0?q=(M.x2+g.x1)/2:q=M.x2New,q>k&&(k=q)}for(g.x1New=k,Q=v;Q<=y;Q++)O=a[Q],M=O.boundary,M.x2New===void 0?M.x2>g.x1?M.index>g.index&&(M.x2New=M.x2):M.x2New=k:M.x2New>k&&(M.x2New=Math.max(k,M.x2));const L=[];let H=null;for(Q=v;Q<=y;Q++){O=a[Q],M=O.boundary;const q=M.x2>g.x2?M:g;H===q?L[L.length-1].end=O.end:(L.push({start:O.start,end:O.end,boundary:q}),H=q)}for(a[v].start<g.y1&&(L[0].start=g.y1,L.unshift({start:a[v].start,end:g.y1,boundary:a[v].boundary})),g.y2<a[y].end&&(L[L.length-1].end=g.y2,L.push({start:g.y2,end:a[y].end,boundary:a[y].boundary})),Q=v;Q<=y;Q++){if(O=a[Q],M=O.boundary,M.x2New!==void 0)continue;let q=!1;for(V=v-1;!q&&V>=0&&a[V].start>=M.y1;V--)q=a[V].boundary===M;for(V=y+1;!q&&V<a.length&&a[V].end<=M.y2;V++)q=a[V].boundary===M;for(V=0;!q&&V<L.length;V++)q=L[V].boundary===M;q||(M.x2New=k)}Array.prototype.splice.apply(a,[v,y-v+1].concat(L))}for(const g of a){const v=g.boundary;v.x2New===void 0&&(v.x2New=Math.max(I,v.x2))}}class R{constructor({textContent:w,textContentStream:s,container:a,viewport:g,textDivs:v,textContentItemsStr:y,enhanceTextSelection:O}){var M;this._textContent=w,this._textContentStream=s,this._container=a,this._document=a.ownerDocument,this._viewport=g,this._textDivs=v||[],this._textContentItemsStr=y||[],this._enhanceTextSelection=!!O,this._fontInspectorEnabled=!!((M=globalThis.FontInspector)!=null&&M.enabled),this._reader=null,this._layoutTextLastFontSize=null,this._layoutTextLastFontFamily=null,this._layoutTextCtx=null,this._textDivProperties=new WeakMap,this._renderingDone=!1,this._canceled=!1,this._capability=(0,t.createPromiseCapability)(),this._renderTimer=null,this._bounds=[],this._capability.promise.finally(()=>{this._enhanceTextSelection||(this._textDivProperties=null),this._layoutTextCtx&&(this._layoutTextCtx.canvas.width=0,this._layoutTextCtx.canvas.height=0,this._layoutTextCtx=null)}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new t.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._renderTimer!==null&&(clearTimeout(this._renderTimer),this._renderTimer=null),this._capability.reject(new Error("TextLayer task cancelled."))}_processItems(w,s){for(let a=0,g=w.length;a<g;a++){if(w[a].str===void 0){if(w[a].type==="beginMarkedContentProps"||w[a].type==="beginMarkedContent"){const v=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),w[a].id!==null&&this._container.setAttribute("id",`${w[a].id}`),v.appendChild(this._container)}else w[a].type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(w[a].str),_(this,w[a],s,this._layoutTextCtx)}}_layoutText(w){const s=this._textDivProperties.get(w);let a="";if(s.canvasWidth!==0&&s.hasText){const{fontSize:g,fontFamily:v}=w.style;(g!==this._layoutTextLastFontSize||v!==this._layoutTextLastFontFamily)&&(this._layoutTextCtx.font=`${g} ${v}`,this._layoutTextLastFontSize=g,this._layoutTextLastFontFamily=v);const{width:y}=this._layoutTextCtx.measureText(w.textContent);if(y>0){const O=s.canvasWidth/y;this._enhanceTextSelection&&(s.scale=O),a=`scaleX(${O})`}}if(s.angle!==0&&(a=`rotate(${s.angle}deg) ${a}`),a.length>0&&(this._enhanceTextSelection&&(s.originalTransform=a),w.style.transform=a),s.hasText&&this._container.appendChild(w),s.hasEOL){const g=document.createElement("br");g.setAttribute("role","presentation"),this._container.appendChild(g)}}_render(w=0){const s=(0,t.createPromiseCapability)();let a=Object.create(null);const g=this._document.createElement("canvas");if(g.height=g.width=p,g.mozOpaque=!0,this._layoutTextCtx=g.getContext("2d",{alpha:!1}),this._textContent){const v=this._textContent.items,y=this._textContent.styles;this._processItems(v,y),s.resolve()}else if(this._textContentStream){const v=()=>{this._reader.read().then(({value:y,done:O})=>{if(O){s.resolve();return}Object.assign(a,y.styles),this._processItems(y.items,a),v()},s.reject)};this._reader=this._textContentStream.getReader(),v()}else throw new Error('Neither "textContent" nor "textContentStream" parameters specified.');s.promise.then(()=>{a=null,w?this._renderTimer=setTimeout(()=>{x(this),this._renderTimer=null},w):x(this)},this._capability.reject)}expandTextDivs(w=!1){if(!this._enhanceTextSelection||!this._renderingDone)return;this._bounds!==null&&(A(this),this._bounds=null);const s=[],a=[];for(let g=0,v=this._textDivs.length;g<v;g++){const y=this._textDivs[g],O=this._textDivProperties.get(y);O.hasText&&(w?(s.length=0,a.length=0,O.originalTransform&&s.push(O.originalTransform),O.paddingTop>0?(a.push(`${O.paddingTop}px`),s.push(`translateY(${-O.paddingTop}px)`)):a.push(0),O.paddingRight>0?a.push(`${O.paddingRight/O.scale}px`):a.push(0),O.paddingBottom>0?a.push(`${O.paddingBottom}px`):a.push(0),O.paddingLeft>0?(a.push(`${O.paddingLeft/O.scale}px`),s.push(`translateX(${-O.paddingLeft/O.scale}px)`)):a.push(0),y.style.padding=a.join(" "),s.length&&(y.style.transform=s.join(" "))):(y.style.padding=null,y.style.transform=O.originalTransform))}}}function B(I){const w=new R({textContent:I.textContent,textContentStream:I.textContentStream,container:I.container,viewport:I.viewport,textDivs:I.textDivs,textContentItemsStr:I.textContentItemsStr,enhanceTextSelection:I.enhanceTextSelection});return w._render(I.timeout),w}},(G,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.SVGGraphics=void 0;var t=o(2),h=o(1),p=o(4);let S=class{constructor(){(0,t.unreachable)("Not implemented: SVGGraphics")}};n.SVGGraphics=S;{let F=function(s){let a=[];const g=[];for(const v of s){if(v.fn==="save"){a.push({fnId:92,fn:"group",items:[]}),g.push(a),a=a[a.length-1].items;continue}v.fn==="restore"?a=g.pop():a.push(v)}return a},u=function(s){if(Number.isInteger(s))return s.toString();const a=s.toFixed(10);let g=a.length-1;if(a[g]!=="0")return a;do g--;while(a[g]==="0");return a.substring(0,a[g]==="."?g:g+1)},R=function(s){if(s[4]===0&&s[5]===0){if(s[1]===0&&s[2]===0)return s[0]===1&&s[3]===1?"":`scale(${u(s[0])} ${u(s[3])})`;if(s[0]===s[3]&&s[1]===-s[2]){const a=Math.acos(s[0])*180/Math.PI;return`rotate(${u(a)})`}}else if(s[0]===1&&s[1]===0&&s[2]===0&&s[3]===1)return`translate(${u(s[4])} ${u(s[5])})`;return`matrix(${u(s[0])} ${u(s[1])} ${u(s[2])} ${u(s[3])} ${u(s[4])} ${u(s[5])})`};const m={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},b="http://www.w3.org/XML/1998/namespace",f="http://www.w3.org/1999/xlink",_=["butt","round","square"],x=["miter","round","bevel"],E=function(){const s=new Uint8Array([137,80,78,71,13,10,26,10]),a=12,g=new Int32Array(256);for(let k=0;k<256;k++){let L=k;for(let H=0;H<8;H++)L&1?L=3988292384^L>>1&2147483647:L=L>>1&2147483647;g[k]=L}function v(k,L,H){let q=-1;for(let W=L;W<H;W++){const K=(q^k[W])&255,T=g[K];q=q>>>8^T}return q^-1}function y(k,L,H,q){let W=q;const K=L.length;H[W]=K>>24&255,H[W+1]=K>>16&255,H[W+2]=K>>8&255,H[W+3]=K&255,W+=4,H[W]=k.charCodeAt(0)&255,H[W+1]=k.charCodeAt(1)&255,H[W+2]=k.charCodeAt(2)&255,H[W+3]=k.charCodeAt(3)&255,W+=4,H.set(L,W),W+=L.length;const T=v(H,q+4,W);H[W]=T>>24&255,H[W+1]=T>>16&255,H[W+2]=T>>8&255,H[W+3]=T&255}function O(k,L,H){let q=1,W=0;for(let K=L;K<H;++K)q=(q+(k[K]&255))%65521,W=(W+q)%65521;return W<<16|q}function M(k){if(!p.isNodeJS)return Q(k);try{let L;parseInt(process.versions.node)>=8?L=k:L=Buffer.from(k);const H=require$$5.deflateSync(L,{level:9});return H instanceof Uint8Array?H:new Uint8Array(H)}catch(L){(0,t.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+L)}return Q(k)}function Q(k){let L=k.length;const H=65535,q=Math.ceil(L/H),W=new Uint8Array(2+L+q*5+4);let K=0;W[K++]=120,W[K++]=156;let T=0;for(;L>H;)W[K++]=0,W[K++]=255,W[K++]=255,W[K++]=0,W[K++]=0,W.set(k.subarray(T,T+H),K),K+=H,T+=H,L-=H;W[K++]=1,W[K++]=L&255,W[K++]=L>>8&255,W[K++]=~L&65535&255,W[K++]=(~L&65535)>>8&255,W.set(k.subarray(T),K),K+=k.length-T;const c=O(k,0,k.length);return W[K++]=c>>24&255,W[K++]=c>>16&255,W[K++]=c>>8&255,W[K++]=c&255,W}function V(k,L,H,q){const W=k.width,K=k.height;let T,c,e;const r=k.data;switch(L){case t.ImageKind.GRAYSCALE_1BPP:c=0,T=1,e=W+7>>3;break;case t.ImageKind.RGB_24BPP:c=2,T=8,e=W*3;break;case t.ImageKind.RGBA_32BPP:c=6,T=8,e=W*4;break;default:throw new Error("invalid format")}const i=new Uint8Array((1+e)*K);let d=0,l=0;for(let $=0;$<K;++$)i[d++]=0,i.set(r.subarray(l,l+e),d),l+=e,d+=e;if(L===t.ImageKind.GRAYSCALE_1BPP&&q){d=0;for(let $=0;$<K;$++){d++;for(let X=0;X<e;X++)i[d++]^=255}}const C=new Uint8Array([W>>24&255,W>>16&255,W>>8&255,W&255,K>>24&255,K>>16&255,K>>8&255,K&255,T,c,0,0,0]),P=M(i),N=s.length+a*3+C.length+P.length,j=new Uint8Array(N);let D=0;return j.set(s,D),D+=s.length,y("IHDR",C,j,D),D+=a+C.length,y("IDATA",P,j,D),D+=a+P.length,y("IEND",new Uint8Array(0),j,D),(0,t.createObjectURL)(j,"image/png",H)}return function(L,H,q){const W=L.kind===void 0?t.ImageKind.GRAYSCALE_1BPP:L.kind;return V(L,W,H,q)}}();class A{constructor(){this.fontSizeScale=1,this.fontWeight=m.fontWeight,this.fontSize=0,this.textMatrix=t.IDENTITY_MATRIX,this.fontMatrix=t.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=t.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=m.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(a,g){this.x=a,this.y=g}}let B=0,I=0,w=0;n.SVGGraphics=S=class{constructor(s,a,g=!1){this.svgFactory=new h.DOMSVGFactory,this.current=new A,this.transformMatrix=t.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=s,this.objs=a,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!g,this._operatorIdMapping=[];for(const v in t.OPS)this._operatorIdMapping[t.OPS[v]]=v}save(){this.transformStack.push(this.transformMatrix);const s=this.current;this.extraStack.push(s),this.current=s.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(s){this.save(),this.executeOpTree(s),this.restore()}loadDependencies(s){const a=s.fnArray,g=s.argsArray;for(let v=0,y=a.length;v<y;v++)if(a[v]===t.OPS.dependency)for(const O of g[v]){const M=O.startsWith("g_")?this.commonObjs:this.objs,Q=new Promise(V=>{M.get(O,V)});this.current.dependencies.push(Q)}return Promise.all(this.current.dependencies)}transform(s,a,g,v,y,O){const M=[s,a,g,v,y,O];this.transformMatrix=t.Util.transform(this.transformMatrix,M),this.tgrp=null}getSVG(s,a){this.viewport=a;const g=this._initialize(a);return this.loadDependencies(s).then(()=>(this.transformMatrix=t.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(s)),g))}convertOpList(s){const a=this._operatorIdMapping,g=s.argsArray,v=s.fnArray,y=[];for(let O=0,M=v.length;O<M;O++){const Q=v[O];y.push({fnId:Q,fn:a[Q],args:g[O]})}return F(y)}executeOpTree(s){for(const a of s){const g=a.fn,v=a.fnId,y=a.args;switch(v|0){case t.OPS.beginText:this.beginText();break;case t.OPS.dependency:break;case t.OPS.setLeading:this.setLeading(y);break;case t.OPS.setLeadingMoveText:this.setLeadingMoveText(y[0],y[1]);break;case t.OPS.setFont:this.setFont(y);break;case t.OPS.showText:this.showText(y[0]);break;case t.OPS.showSpacedText:this.showText(y[0]);break;case t.OPS.endText:this.endText();break;case t.OPS.moveText:this.moveText(y[0],y[1]);break;case t.OPS.setCharSpacing:this.setCharSpacing(y[0]);break;case t.OPS.setWordSpacing:this.setWordSpacing(y[0]);break;case t.OPS.setHScale:this.setHScale(y[0]);break;case t.OPS.setTextMatrix:this.setTextMatrix(y[0],y[1],y[2],y[3],y[4],y[5]);break;case t.OPS.setTextRise:this.setTextRise(y[0]);break;case t.OPS.setTextRenderingMode:this.setTextRenderingMode(y[0]);break;case t.OPS.setLineWidth:this.setLineWidth(y[0]);break;case t.OPS.setLineJoin:this.setLineJoin(y[0]);break;case t.OPS.setLineCap:this.setLineCap(y[0]);break;case t.OPS.setMiterLimit:this.setMiterLimit(y[0]);break;case t.OPS.setFillRGBColor:this.setFillRGBColor(y[0],y[1],y[2]);break;case t.OPS.setStrokeRGBColor:this.setStrokeRGBColor(y[0],y[1],y[2]);break;case t.OPS.setStrokeColorN:this.setStrokeColorN(y);break;case t.OPS.setFillColorN:this.setFillColorN(y);break;case t.OPS.shadingFill:this.shadingFill(y[0]);break;case t.OPS.setDash:this.setDash(y[0],y[1]);break;case t.OPS.setRenderingIntent:this.setRenderingIntent(y[0]);break;case t.OPS.setFlatness:this.setFlatness(y[0]);break;case t.OPS.setGState:this.setGState(y[0]);break;case t.OPS.fill:this.fill();break;case t.OPS.eoFill:this.eoFill();break;case t.OPS.stroke:this.stroke();break;case t.OPS.fillStroke:this.fillStroke();break;case t.OPS.eoFillStroke:this.eoFillStroke();break;case t.OPS.clip:this.clip("nonzero");break;case t.OPS.eoClip:this.clip("evenodd");break;case t.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case t.OPS.paintImageXObject:this.paintImageXObject(y[0]);break;case t.OPS.paintInlineImageXObject:this.paintInlineImageXObject(y[0]);break;case t.OPS.paintImageMaskXObject:this.paintImageMaskXObject(y[0]);break;case t.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(y[0],y[1]);break;case t.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case t.OPS.closePath:this.closePath();break;case t.OPS.closeStroke:this.closeStroke();break;case t.OPS.closeFillStroke:this.closeFillStroke();break;case t.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case t.OPS.nextLine:this.nextLine();break;case t.OPS.transform:this.transform(y[0],y[1],y[2],y[3],y[4],y[5]);break;case t.OPS.constructPath:this.constructPath(y[0],y[1]);break;case t.OPS.endPath:this.endPath();break;case 92:this.group(a.items);break;default:(0,t.warn)(`Unimplemented operator ${g}`);break}}}setWordSpacing(s){this.current.wordSpacing=s}setCharSpacing(s){this.current.charSpacing=s}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(s,a,g,v,y,O){const M=this.current;M.textMatrix=M.lineMatrix=[s,a,g,v,y,O],M.textMatrixScale=Math.hypot(s,a),M.x=M.lineX=0,M.y=M.lineY=0,M.xcoords=[],M.ycoords=[],M.tspan=this.svgFactory.createElement("svg:tspan"),M.tspan.setAttributeNS(null,"font-family",M.fontFamily),M.tspan.setAttributeNS(null,"font-size",`${u(M.fontSize)}px`),M.tspan.setAttributeNS(null,"y",u(-M.y)),M.txtElement=this.svgFactory.createElement("svg:text"),M.txtElement.appendChild(M.tspan)}beginText(){const s=this.current;s.x=s.lineX=0,s.y=s.lineY=0,s.textMatrix=t.IDENTITY_MATRIX,s.lineMatrix=t.IDENTITY_MATRIX,s.textMatrixScale=1,s.tspan=this.svgFactory.createElement("svg:tspan"),s.txtElement=this.svgFactory.createElement("svg:text"),s.txtgrp=this.svgFactory.createElement("svg:g"),s.xcoords=[],s.ycoords=[]}moveText(s,a){const g=this.current;g.x=g.lineX+=s,g.y=g.lineY+=a,g.xcoords=[],g.ycoords=[],g.tspan=this.svgFactory.createElement("svg:tspan"),g.tspan.setAttributeNS(null,"font-family",g.fontFamily),g.tspan.setAttributeNS(null,"font-size",`${u(g.fontSize)}px`),g.tspan.setAttributeNS(null,"y",u(-g.y))}showText(s){const a=this.current,g=a.font,v=a.fontSize;if(v===0)return;const y=a.fontSizeScale,O=a.charSpacing,M=a.wordSpacing,Q=a.fontDirection,V=a.textHScale*Q,k=g.vertical,L=k?1:-1,H=g.defaultVMetrics,q=v*a.fontMatrix[0];let W=0;for(const c of s){if(c===null){W+=Q*M;continue}else if((0,t.isNum)(c)){W+=L*c*v/1e3;continue}const e=(c.isSpace?M:0)+O,r=c.fontChar;let i,d,l=c.width;if(k){let P;const N=c.vmetric||H;P=c.vmetric?N[1]:l*.5,P=-P*q;const j=N[2]*q;l=N?-N[0]:l,i=P/y,d=(W+j)/y}else i=W/y,d=0;(c.isInFont||g.missingFile)&&(a.xcoords.push(a.x+i),k&&a.ycoords.push(-a.y+d),a.tspan.textContent+=r);let C;k?C=l*q-e*Q:C=l*q+e*Q,W+=C}a.tspan.setAttributeNS(null,"x",a.xcoords.map(u).join(" ")),k?a.tspan.setAttributeNS(null,"y",a.ycoords.map(u).join(" ")):a.tspan.setAttributeNS(null,"y",u(-a.y)),k?a.y-=W:a.x+=W*V,a.tspan.setAttributeNS(null,"font-family",a.fontFamily),a.tspan.setAttributeNS(null,"font-size",`${u(a.fontSize)}px`),a.fontStyle!==m.fontStyle&&a.tspan.setAttributeNS(null,"font-style",a.fontStyle),a.fontWeight!==m.fontWeight&&a.tspan.setAttributeNS(null,"font-weight",a.fontWeight);const K=a.textRenderingMode&t.TextRenderingMode.FILL_STROKE_MASK;if(K===t.TextRenderingMode.FILL||K===t.TextRenderingMode.FILL_STROKE?(a.fillColor!==m.fillColor&&a.tspan.setAttributeNS(null,"fill",a.fillColor),a.fillAlpha<1&&a.tspan.setAttributeNS(null,"fill-opacity",a.fillAlpha)):a.textRenderingMode===t.TextRenderingMode.ADD_TO_PATH?a.tspan.setAttributeNS(null,"fill","transparent"):a.tspan.setAttributeNS(null,"fill","none"),K===t.TextRenderingMode.STROKE||K===t.TextRenderingMode.FILL_STROKE){const c=1/(a.textMatrixScale||1);this._setStrokeAttributes(a.tspan,c)}let T=a.textMatrix;a.textRise!==0&&(T=T.slice(),T[5]+=a.textRise),a.txtElement.setAttributeNS(null,"transform",`${R(T)} scale(${u(V)}, -1)`),a.txtElement.setAttributeNS(b,"xml:space","preserve"),a.txtElement.appendChild(a.tspan),a.txtgrp.appendChild(a.txtElement),this._ensureTransformGroup().appendChild(a.txtElement)}setLeadingMoveText(s,a){this.setLeading(-a),this.moveText(s,a)}addFontStyle(s){if(!s.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.appendChild(this.cssStyle));const a=(0,t.createObjectURL)(s.data,s.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${s.loadedName}"; src: url(${a}); }
`}setFont(s){const a=this.current,g=this.commonObjs.get(s[0]);let v=s[1];a.font=g,this.embedFonts&&!g.missingFile&&!this.embeddedFonts[g.loadedName]&&(this.addFontStyle(g),this.embeddedFonts[g.loadedName]=g),a.fontMatrix=g.fontMatrix||t.FONT_IDENTITY_MATRIX;let y="normal";g.black?y="900":g.bold&&(y="bold");const O=g.italic?"italic":"normal";v<0?(v=-v,a.fontDirection=-1):a.fontDirection=1,a.fontSize=v,a.fontFamily=g.loadedName,a.fontWeight=y,a.fontStyle=O,a.tspan=this.svgFactory.createElement("svg:tspan"),a.tspan.setAttributeNS(null,"y",u(-a.y)),a.xcoords=[],a.ycoords=[]}endText(){var a;const s=this.current;s.textRenderingMode&t.TextRenderingMode.ADD_TO_PATH_FLAG&&((a=s.txtElement)!=null&&a.hasChildNodes())&&(s.element=s.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(s){s>0&&(this.current.lineWidth=s)}setLineCap(s){this.current.lineCap=_[s]}setLineJoin(s){this.current.lineJoin=x[s]}setMiterLimit(s){this.current.miterLimit=s}setStrokeAlpha(s){this.current.strokeAlpha=s}setStrokeRGBColor(s,a,g){this.current.strokeColor=t.Util.makeHexColor(s,a,g)}setFillAlpha(s){this.current.fillAlpha=s}setFillRGBColor(s,a,g){this.current.fillColor=t.Util.makeHexColor(s,a,g),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(s){this.current.strokeColor=this._makeColorN_Pattern(s)}setFillColorN(s){this.current.fillColor=this._makeColorN_Pattern(s)}shadingFill(s){const a=this.viewport.width,g=this.viewport.height,v=t.Util.inverseTransform(this.transformMatrix),y=t.Util.applyTransform([0,0],v),O=t.Util.applyTransform([0,g],v),M=t.Util.applyTransform([a,0],v),Q=t.Util.applyTransform([a,g],v),V=Math.min(y[0],O[0],M[0],Q[0]),k=Math.min(y[1],O[1],M[1],Q[1]),L=Math.max(y[0],O[0],M[0],Q[0]),H=Math.max(y[1],O[1],M[1],Q[1]),q=this.svgFactory.createElement("svg:rect");q.setAttributeNS(null,"x",V),q.setAttributeNS(null,"y",k),q.setAttributeNS(null,"width",L-V),q.setAttributeNS(null,"height",H-k),q.setAttributeNS(null,"fill",this._makeShadingPattern(s)),this.current.fillAlpha<1&&q.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().appendChild(q)}_makeColorN_Pattern(s){return s[0]==="TilingPattern"?this._makeTilingPattern(s):this._makeShadingPattern(s)}_makeTilingPattern(s){const a=s[1],g=s[2],v=s[3]||t.IDENTITY_MATRIX,[y,O,M,Q]=s[4],V=s[5],k=s[6],L=s[7],H=`shading${w++}`,[q,W,K,T]=t.Util.normalizeRect([...t.Util.applyTransform([y,O],v),...t.Util.applyTransform([M,Q],v)]),[c,e]=t.Util.singularValueDecompose2dScale(v),r=V*c,i=k*e,d=this.svgFactory.createElement("svg:pattern");d.setAttributeNS(null,"id",H),d.setAttributeNS(null,"patternUnits","userSpaceOnUse"),d.setAttributeNS(null,"width",r),d.setAttributeNS(null,"height",i),d.setAttributeNS(null,"x",`${q}`),d.setAttributeNS(null,"y",`${W}`);const l=this.svg,C=this.transformMatrix,P=this.current.fillColor,N=this.current.strokeColor,j=this.svgFactory.create(K-q,T-W);if(this.svg=j,this.transformMatrix=v,L===2){const D=t.Util.makeHexColor(...a);this.current.fillColor=D,this.current.strokeColor=D}return this.executeOpTree(this.convertOpList(g)),this.svg=l,this.transformMatrix=C,this.current.fillColor=P,this.current.strokeColor=N,d.appendChild(j.childNodes[0]),this.defs.appendChild(d),`url(#${H})`}_makeShadingPattern(s){switch(s[0]){case"RadialAxial":const a=`shading${w++}`,g=s[3];let v;switch(s[1]){case"axial":const y=s[4],O=s[5];v=this.svgFactory.createElement("svg:linearGradient"),v.setAttributeNS(null,"id",a),v.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),v.setAttributeNS(null,"x1",y[0]),v.setAttributeNS(null,"y1",y[1]),v.setAttributeNS(null,"x2",O[0]),v.setAttributeNS(null,"y2",O[1]);break;case"radial":const M=s[4],Q=s[5],V=s[6],k=s[7];v=this.svgFactory.createElement("svg:radialGradient"),v.setAttributeNS(null,"id",a),v.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),v.setAttributeNS(null,"cx",Q[0]),v.setAttributeNS(null,"cy",Q[1]),v.setAttributeNS(null,"r",k),v.setAttributeNS(null,"fx",M[0]),v.setAttributeNS(null,"fy",M[1]),v.setAttributeNS(null,"fr",V);break;default:throw new Error(`Unknown RadialAxial type: ${s[1]}`)}for(const y of g){const O=this.svgFactory.createElement("svg:stop");O.setAttributeNS(null,"offset",y[0]),O.setAttributeNS(null,"stop-color",y[1]),v.appendChild(O)}return this.defs.appendChild(v),`url(#${a})`;case"Mesh":return(0,t.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${s[0]}`)}}setDash(s,a){this.current.dashArray=s,this.current.dashPhase=a}constructPath(s,a){const g=this.current;let v=g.x,y=g.y,O=[],M=0;for(const Q of s)switch(Q|0){case t.OPS.rectangle:v=a[M++],y=a[M++];const V=a[M++],k=a[M++],L=v+V,H=y+k;O.push("M",u(v),u(y),"L",u(L),u(y),"L",u(L),u(H),"L",u(v),u(H),"Z");break;case t.OPS.moveTo:v=a[M++],y=a[M++],O.push("M",u(v),u(y));break;case t.OPS.lineTo:v=a[M++],y=a[M++],O.push("L",u(v),u(y));break;case t.OPS.curveTo:v=a[M+4],y=a[M+5],O.push("C",u(a[M]),u(a[M+1]),u(a[M+2]),u(a[M+3]),u(v),u(y)),M+=6;break;case t.OPS.curveTo2:O.push("C",u(v),u(y),u(a[M]),u(a[M+1]),u(a[M+2]),u(a[M+3])),v=a[M+2],y=a[M+3],M+=4;break;case t.OPS.curveTo3:v=a[M+2],y=a[M+3],O.push("C",u(a[M]),u(a[M+1]),u(v),u(y),u(v),u(y)),M+=4;break;case t.OPS.closePath:O.push("Z");break}O=O.join(" "),g.path&&s.length>0&&s[0]!==t.OPS.rectangle&&s[0]!==t.OPS.moveTo?O=g.path.getAttributeNS(null,"d")+O:(g.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().appendChild(g.path)),g.path.setAttributeNS(null,"d",O),g.path.setAttributeNS(null,"fill","none"),g.element=g.path,g.setCurrentPoint(v,y)}endPath(){const s=this.current;if(s.path=null,!this.pendingClip)return;if(!s.element){this.pendingClip=null;return}const a=`clippath${B++}`,g=this.svgFactory.createElement("svg:clipPath");g.setAttributeNS(null,"id",a),g.setAttributeNS(null,"transform",R(this.transformMatrix));const v=s.element.cloneNode(!0);if(this.pendingClip==="evenodd"?v.setAttributeNS(null,"clip-rule","evenodd"):v.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,g.appendChild(v),this.defs.appendChild(g),s.activeClipUrl){s.clipGroup=null;for(const y of this.extraStack)y.clipGroup=null;g.setAttributeNS(null,"clip-path",s.activeClipUrl)}s.activeClipUrl=`url(#${a})`,this.tgrp=null}clip(s){this.pendingClip=s}closePath(){const s=this.current;if(s.path){const a=`${s.path.getAttributeNS(null,"d")}Z`;s.path.setAttributeNS(null,"d",a)}}setLeading(s){this.current.leading=-s}setTextRise(s){this.current.textRise=s}setTextRenderingMode(s){this.current.textRenderingMode=s}setHScale(s){this.current.textHScale=s/100}setRenderingIntent(s){}setFlatness(s){}setGState(s){for(const[a,g]of s)switch(a){case"LW":this.setLineWidth(g);break;case"LC":this.setLineCap(g);break;case"LJ":this.setLineJoin(g);break;case"ML":this.setMiterLimit(g);break;case"D":this.setDash(g[0],g[1]);break;case"RI":this.setRenderingIntent(g);break;case"FL":this.setFlatness(g);break;case"Font":this.setFont(g);break;case"CA":this.setStrokeAlpha(g);break;case"ca":this.setFillAlpha(g);break;default:(0,t.warn)(`Unimplemented graphic state operator ${a}`);break}}fill(){const s=this.current;s.element&&(s.element.setAttributeNS(null,"fill",s.fillColor),s.element.setAttributeNS(null,"fill-opacity",s.fillAlpha),this.endPath())}stroke(){const s=this.current;s.element&&(this._setStrokeAttributes(s.element),s.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(s,a=1){const g=this.current;let v=g.dashArray;a!==1&&v.length>0&&(v=v.map(function(y){return a*y})),s.setAttributeNS(null,"stroke",g.strokeColor),s.setAttributeNS(null,"stroke-opacity",g.strokeAlpha),s.setAttributeNS(null,"stroke-miterlimit",u(g.miterLimit)),s.setAttributeNS(null,"stroke-linecap",g.lineCap),s.setAttributeNS(null,"stroke-linejoin",g.lineJoin),s.setAttributeNS(null,"stroke-width",u(a*g.lineWidth)+"px"),s.setAttributeNS(null,"stroke-dasharray",v.map(u).join(" ")),s.setAttributeNS(null,"stroke-dashoffset",u(a*g.dashPhase)+"px")}eoFill(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element&&this.current.element.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const s=this.svgFactory.createElement("svg:rect");s.setAttributeNS(null,"x","0"),s.setAttributeNS(null,"y","0"),s.setAttributeNS(null,"width","1px"),s.setAttributeNS(null,"height","1px"),s.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().appendChild(s)}paintImageXObject(s){const a=s.startsWith("g_")?this.commonObjs.get(s):this.objs.get(s);if(!a){(0,t.warn)(`Dependent image with object ID ${s} is not ready yet`);return}this.paintInlineImageXObject(a)}paintInlineImageXObject(s,a){const g=s.width,v=s.height,y=E(s,this.forceDataSchema,!!a),O=this.svgFactory.createElement("svg:rect");O.setAttributeNS(null,"x","0"),O.setAttributeNS(null,"y","0"),O.setAttributeNS(null,"width",u(g)),O.setAttributeNS(null,"height",u(v)),this.current.element=O,this.clip("nonzero");const M=this.svgFactory.createElement("svg:image");M.setAttributeNS(f,"xlink:href",y),M.setAttributeNS(null,"x","0"),M.setAttributeNS(null,"y",u(-v)),M.setAttributeNS(null,"width",u(g)+"px"),M.setAttributeNS(null,"height",u(v)+"px"),M.setAttributeNS(null,"transform",`scale(${u(1/g)} ${u(-1/v)})`),a?a.appendChild(M):this._ensureTransformGroup().appendChild(M)}paintImageMaskXObject(s){const a=this.current,g=s.width,v=s.height,y=a.fillColor;a.maskId=`mask${I++}`;const O=this.svgFactory.createElement("svg:mask");O.setAttributeNS(null,"id",a.maskId);const M=this.svgFactory.createElement("svg:rect");M.setAttributeNS(null,"x","0"),M.setAttributeNS(null,"y","0"),M.setAttributeNS(null,"width",u(g)),M.setAttributeNS(null,"height",u(v)),M.setAttributeNS(null,"fill",y),M.setAttributeNS(null,"mask",`url(#${a.maskId})`),this.defs.appendChild(O),this._ensureTransformGroup().appendChild(M),this.paintInlineImageXObject(s,O)}paintFormXObjectBegin(s,a){if(Array.isArray(s)&&s.length===6&&this.transform(s[0],s[1],s[2],s[3],s[4],s[5]),a){const g=a[2]-a[0],v=a[3]-a[1],y=this.svgFactory.createElement("svg:rect");y.setAttributeNS(null,"x",a[0]),y.setAttributeNS(null,"y",a[1]),y.setAttributeNS(null,"width",u(g)),y.setAttributeNS(null,"height",u(v)),this.current.element=y,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(s){const a=this.svgFactory.create(s.width,s.height),g=this.svgFactory.createElement("svg:defs");a.appendChild(g),this.defs=g;const v=this.svgFactory.createElement("svg:g");return v.setAttributeNS(null,"transform",R(s.transform)),a.appendChild(v),this.svg=v,a}_ensureClipGroup(){if(!this.current.clipGroup){const s=this.svgFactory.createElement("svg:g");s.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.appendChild(s),this.current.clipGroup=s}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",R(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().appendChild(this.tgrp):this.svg.appendChild(this.tgrp)),this.tgrp}}}},(G,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.XfaLayer=void 0;var t=o(2),h=o(17);class p{static setupStorage(m,b,f,_,x){const E=_.getValue(b,{value:null});switch(f.name){case"textarea":if(E.value!==null&&(m.textContent=E.value),x==="print")break;m.addEventListener("input",A=>{_.setValue(b,{value:A.target.value})});break;case"input":if(f.attributes.type==="radio"||f.attributes.type==="checkbox"){if(E.value===f.attributes.xfaOn?m.setAttribute("checked",!0):E.value===f.attributes.xfaOff&&m.removeAttribute("checked"),x==="print")break;m.addEventListener("change",A=>{_.setValue(b,{value:A.target.checked?A.target.getAttribute("xfaOn"):A.target.getAttribute("xfaOff")})})}else{if(E.value!==null&&m.setAttribute("value",E.value),x==="print")break;m.addEventListener("input",A=>{_.setValue(b,{value:A.target.value})})}break;case"select":if(E.value!==null)for(const A of f.children)A.attributes.value===E.value&&(A.attributes.selected=!0);m.addEventListener("input",A=>{const F=A.target.options,u=F.selectedIndex===-1?"":F[F.selectedIndex].value;_.setValue(b,{value:u})});break}}static setAttributes({html:m,element:b,storage:f=null,intent:_,linkService:x}){var F;const{attributes:E}=b,A=m instanceof HTMLAnchorElement;E.type==="radio"&&(E.name=`${E.name}-${_}`);for(const[u,R]of Object.entries(E))if(!(R==null||u==="dataId"))if(u!=="style")if(u==="textContent")m.textContent=R;else if(u==="class")m.setAttribute(u,R.join(" "));else{if(A&&(u==="href"||u==="newWindow"))continue;m.setAttribute(u,R)}else Object.assign(m.style,R);A&&(x.addLinkAttributes||(0,t.warn)("XfaLayer.setAttribute - missing `addLinkAttributes`-method on the `linkService`-instance."),(F=x.addLinkAttributes)==null||F.call(x,m,E.href,E.newWindow)),f&&E.dataId&&this.setupStorage(m,E.dataId,b,f)}static render(m){var B;const b=m.annotationStorage,f=m.linkService,_=m.xfa,x=m.intent||"display",E=document.createElement(_.name);_.attributes&&this.setAttributes({html:E,element:_,intent:x,linkService:f});const A=[[_,-1,E]],F=m.div;F.appendChild(E);const u=`matrix(${m.viewport.transform.join(",")})`;F.style.transform=u,F.setAttribute("class","xfaLayer xfaFont");const R=[];for(;A.length>0;){const[I,w,s]=A[A.length-1];if(w+1===I.children.length){A.pop();continue}const a=I.children[++A[A.length-1][1]];if(a===null)continue;const{name:g}=a;if(g==="#text"){const y=document.createTextNode(a.value);R.push(y),s.appendChild(y);continue}let v;if((B=a==null?void 0:a.attributes)!=null&&B.xmlns?v=document.createElementNS(a.attributes.xmlns,g):v=document.createElement(g),s.appendChild(v),a.attributes&&this.setAttributes({html:v,element:a,storage:b,intent:x,linkService:f}),a.children&&a.children.length>0)A.push([a,-1,v]);else if(a.value){const y=document.createTextNode(a.value);h.XfaText.shouldBuildText(g)&&R.push(y),v.appendChild(y)}}for(const I of F.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))I.setAttribute("readOnly",!0);return{textDivs:R}}static update(m){const b=`matrix(${m.viewport.transform.join(",")})`;m.div.style.transform=b,m.div.hidden=!1}}n.XfaLayer=p},(G,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFNodeStream=void 0;var t=o(2),h=o(24);const p=require$$5,S=require$$5,m=require$$5,b=require$$5,f=/^file:\/\/\/[a-zA-Z]:\//;function _(w){const s=b.parse(w);return s.protocol==="file:"||s.host?s:/^[a-z]:[/\\]/i.test(w)?b.parse(`file:///${w}`):(s.host||(s.protocol="file:"),s)}class x{constructor(s){this.source=s,this.url=_(s.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&s.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var s;return((s=this._fullRequestReader)==null?void 0:s._loaded)??0}getFullReader(){return(0,t.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new B(this):new u(this),this._fullRequestReader}getRangeReader(s,a){if(a<=this._progressiveDataLength)return null;const g=this.isFsUrl?new I(this,s,a):new R(this,s,a);return this._rangeRequestReaders.push(g),g}cancelAllRequests(s){this._fullRequestReader&&this._fullRequestReader.cancel(s);for(const a of this._rangeRequestReaders.slice(0))a.cancel(s)}}n.PDFNodeStream=x;class E{constructor(s){this._url=s.url,this._done=!1,this._storedError=null,this.onProgress=null;const a=s.source;this._contentLength=a.length,this._loaded=0,this._filename=null,this._disableRange=a.disableRange||!1,this._rangeChunkSize=a.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!a.disableStream,this._isRangeSupported=!a.disableRange,this._readableStream=null,this._readCapability=(0,t.createPromiseCapability)(),this._headersCapability=(0,t.createPromiseCapability)()}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const s=this._readableStream.read();return s===null?(this._readCapability=(0,t.createPromiseCapability)(),this.read()):(this._loaded+=s.length,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(s).buffer,done:!1})}cancel(s){if(!this._readableStream){this._error(s);return}this._readableStream.destroy(s)}_error(s){this._storedError=s,this._readCapability.resolve()}_setReadableStream(s){this._readableStream=s,s.on("readable",()=>{this._readCapability.resolve()}),s.on("end",()=>{s.destroy(),this._done=!0,this._readCapability.resolve()}),s.on("error",a=>{this._error(a)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new t.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class A{constructor(s){this._url=s.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=(0,t.createPromiseCapability)();const a=s.source;this._isStreamingSupported=!a.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const s=this._readableStream.read();return s===null?(this._readCapability=(0,t.createPromiseCapability)(),this.read()):(this._loaded+=s.length,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(s).buffer,done:!1})}cancel(s){if(!this._readableStream){this._error(s);return}this._readableStream.destroy(s)}_error(s){this._storedError=s,this._readCapability.resolve()}_setReadableStream(s){this._readableStream=s,s.on("readable",()=>{this._readCapability.resolve()}),s.on("end",()=>{s.destroy(),this._done=!0,this._readCapability.resolve()}),s.on("error",a=>{this._error(a)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function F(w,s){return{protocol:w.protocol,auth:w.auth,host:w.hostname,port:w.port,path:w.path,method:"GET",headers:s}}class u extends E{constructor(s){super(s);const a=g=>{if(g.statusCode===404){const M=new t.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=M,this._headersCapability.reject(M);return}this._headersCapability.resolve(),this._setReadableStream(g);const v=M=>this._readableStream.headers[M.toLowerCase()],{allowRangeRequests:y,suggestedLength:O}=(0,h.validateRangeRequestCapabilities)({getResponseHeader:v,isHttp:s.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=y,this._contentLength=O||this._contentLength,this._filename=(0,h.extractFilenameFromHeader)(v)};this._request=null,this._url.protocol==="http:"?this._request=S.request(F(this._url,s.httpHeaders),a):this._request=m.request(F(this._url,s.httpHeaders),a),this._request.on("error",g=>{this._storedError=g,this._headersCapability.reject(g)}),this._request.end()}}class R extends A{constructor(s,a,g){super(s),this._httpHeaders={};for(const y in s.httpHeaders){const O=s.httpHeaders[y];typeof O>"u"||(this._httpHeaders[y]=O)}this._httpHeaders.Range=`bytes=${a}-${g-1}`;const v=y=>{if(y.statusCode===404){const O=new t.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=O;return}this._setReadableStream(y)};this._request=null,this._url.protocol==="http:"?this._request=S.request(F(this._url,this._httpHeaders),v):this._request=m.request(F(this._url,this._httpHeaders),v),this._request.on("error",y=>{this._storedError=y}),this._request.end()}}class B extends E{constructor(s){super(s);let a=decodeURIComponent(this._url.path);f.test(this._url.href)&&(a=a.replace(/^\//,"")),p.lstat(a,(g,v)=>{if(g){g.code==="ENOENT"&&(g=new t.MissingPDFException(`Missing PDF "${a}".`)),this._storedError=g,this._headersCapability.reject(g);return}this._contentLength=v.size,this._setReadableStream(p.createReadStream(a)),this._headersCapability.resolve()})}}class I extends A{constructor(s,a,g){super(s);let v=decodeURIComponent(this._url.path);f.test(this._url.href)&&(v=v.replace(/^\//,"")),this._setReadableStream(p.createReadStream(v,{start:a,end:g-1}))}}},(G,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.createResponseStatusError=b,n.extractFilenameFromHeader=m,n.validateRangeRequestCapabilities=S,n.validateResponseStatus=f;var t=o(2),h=o(25),p=o(1);function S({getResponseHeader:_,isHttp:x,rangeChunkSize:E,disableRange:A}){(0,t.assert)(E>0,"Range chunk size must be larger than zero");const F={allowRangeRequests:!1,suggestedLength:void 0},u=parseInt(_("Content-Length"),10);return!Number.isInteger(u)||(F.suggestedLength=u,u<=2*E)||A||!x||_("Accept-Ranges")!=="bytes"||(_("Content-Encoding")||"identity")!=="identity"||(F.allowRangeRequests=!0),F}function m(_){const x=_("Content-Disposition");if(x){let E=(0,h.getFilenameFromContentDispositionHeader)(x);if(E.includes("%"))try{E=decodeURIComponent(E)}catch{}if((0,p.isPdfFile)(E))return E}return null}function b(_,x){return _===404||_===0&&x.startsWith("file:")?new t.MissingPDFException('Missing PDF "'+x+'".'):new t.UnexpectedResponseException(`Unexpected server response (${_}) while retrieving PDF "${x}".`,_)}function f(_){return _===200||_===206}},(G,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.getFilenameFromContentDispositionHeader=h;var t=o(2);function h(p){let S=!0,m=b("filename\\*","i").exec(p);if(m){m=m[1];let u=E(m);return u=unescape(u),u=A(u),u=F(u),_(u)}if(m=x(p),m){const u=F(m);return _(u)}if(m=b("filename","i").exec(p),m){m=m[1];let u=E(m);return u=F(u),_(u)}function b(u,R){return new RegExp("(?:^|;)\\s*"+u+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',R)}function f(u,R){if(u){if(!/^[\x00-\xFF]+$/.test(R))return R;try{const B=new TextDecoder(u,{fatal:!0}),I=(0,t.stringToBytes)(R);R=B.decode(I),S=!1}catch{if(/^utf-?8$/i.test(u))try{R=decodeURIComponent(escape(R)),S=!1}catch{}}}return R}function _(u){return S&&/[\x80-\xff]/.test(u)&&(u=f("utf-8",u),S&&(u=f("iso-8859-1",u))),u}function x(u){const R=[];let B;const I=b("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(B=I.exec(u))!==null;){let[,s,a,g]=B;if(s=parseInt(s,10),s in R){if(s===0)break;continue}R[s]=[a,g]}const w=[];for(let s=0;s<R.length&&s in R;++s){let[a,g]=R[s];g=E(g),a&&(g=unescape(g),s===0&&(g=A(g))),w.push(g)}return w.join("")}function E(u){if(u.startsWith('"')){const R=u.slice(1).split('\\"');for(let B=0;B<R.length;++B){const I=R[B].indexOf('"');I!==-1&&(R[B]=R[B].slice(0,I),R.length=B+1),R[B]=R[B].replace(/\\(.)/g,"$1")}u=R.join('"')}return u}function A(u){const R=u.indexOf("'");if(R===-1)return u;const B=u.slice(0,R),w=u.slice(R+1).replace(/^[^']*'/,"");return f(B,w)}function F(u){return!u.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(u)?u:u.replace(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(R,B,I,w){if(I==="q"||I==="Q")return w=w.replace(/_/g," "),w=w.replace(/=([0-9a-fA-F]{2})/g,function(s,a){return String.fromCharCode(parseInt(a,16))}),f(B,w);try{w=atob(w)}catch{}return f(B,w)})}return""}},(G,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFNetworkStream=void 0;var t=o(2),h=o(24);const p=200,S=206;function m(E){const A=E.response;return typeof A!="string"?A:(0,t.stringToBytes)(A).buffer}class b{constructor(A,F={}){this.url=A,this.isHttp=/^https?:/i.test(A),this.httpHeaders=this.isHttp&&F.httpHeaders||Object.create(null),this.withCredentials=F.withCredentials||!1,this.getXhr=F.getXhr||function(){return new XMLHttpRequest},this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(A,F,u){const R={begin:A,end:F};for(const B in u)R[B]=u[B];return this.request(R)}requestFull(A){return this.request(A)}request(A){const F=this.getXhr(),u=this.currXhrId++,R=this.pendingRequests[u]={xhr:F};F.open("GET",this.url),F.withCredentials=this.withCredentials;for(const B in this.httpHeaders){const I=this.httpHeaders[B];typeof I>"u"||F.setRequestHeader(B,I)}return this.isHttp&&"begin"in A&&"end"in A?(F.setRequestHeader("Range",`bytes=${A.begin}-${A.end-1}`),R.expectedStatus=S):R.expectedStatus=p,F.responseType="arraybuffer",A.onError&&(F.onerror=function(B){A.onError(F.status)}),F.onreadystatechange=this.onStateChange.bind(this,u),F.onprogress=this.onProgress.bind(this,u),R.onHeadersReceived=A.onHeadersReceived,R.onDone=A.onDone,R.onError=A.onError,R.onProgress=A.onProgress,F.send(null),u}onProgress(A,F){var R;const u=this.pendingRequests[A];u&&((R=u.onProgress)==null||R.call(u,F))}onStateChange(A,F){var s,a,g;const u=this.pendingRequests[A];if(!u)return;const R=u.xhr;if(R.readyState>=2&&u.onHeadersReceived&&(u.onHeadersReceived(),delete u.onHeadersReceived),R.readyState!==4||!(A in this.pendingRequests))return;if(delete this.pendingRequests[A],R.status===0&&this.isHttp){(s=u.onError)==null||s.call(u,R.status);return}const B=R.status||p;if(!(B===p&&u.expectedStatus===S)&&B!==u.expectedStatus){(a=u.onError)==null||a.call(u,R.status);return}const w=m(R);if(B===S){const v=R.getResponseHeader("Content-Range"),y=/bytes (\d+)-(\d+)\/(\d+)/.exec(v);u.onDone({begin:parseInt(y[1],10),chunk:w})}else w?u.onDone({begin:0,chunk:w}):(g=u.onError)==null||g.call(u,R.status)}getRequestXhr(A){return this.pendingRequests[A].xhr}isPendingRequest(A){return A in this.pendingRequests}abortRequest(A){const F=this.pendingRequests[A].xhr;delete this.pendingRequests[A],F.abort()}}class f{constructor(A){this._source=A,this._manager=new b(A.url,{httpHeaders:A.httpHeaders,withCredentials:A.withCredentials}),this._rangeChunkSize=A.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(A){const F=this._rangeRequestReaders.indexOf(A);F>=0&&this._rangeRequestReaders.splice(F,1)}getFullReader(){return(0,t.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new _(this._manager,this._source),this._fullRequestReader}getRangeReader(A,F){const u=new x(this._manager,A,F);return u.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(u),u}cancelAllRequests(A){var F;(F=this._fullRequestReader)==null||F.cancel(A);for(const u of this._rangeRequestReaders.slice(0))u.cancel(A)}}n.PDFNetworkStream=f;class _{constructor(A,F){this._manager=A;const u={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=F.url,this._fullRequestId=A.requestFull(u),this._headersReceivedCapability=(0,t.createPromiseCapability)(),this._disableRange=F.disableRange||!1,this._contentLength=F.length,this._rangeChunkSize=F.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const A=this._fullRequestId,F=this._manager.getRequestXhr(A),u=I=>F.getResponseHeader(I),{allowRangeRequests:R,suggestedLength:B}=(0,h.validateRangeRequestCapabilities)({getResponseHeader:u,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});R&&(this._isRangeSupported=!0),this._contentLength=B||this._contentLength,this._filename=(0,h.extractFilenameFromHeader)(u),this._isRangeSupported&&this._manager.abortRequest(A),this._headersReceivedCapability.resolve()}_onDone(A){if(A&&(this._requests.length>0?this._requests.shift().resolve({value:A.chunk,done:!1}):this._cachedChunks.push(A.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const F of this._requests)F.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(A){this._storedError=(0,h.createResponseStatusError)(A,this._url),this._headersReceivedCapability.reject(this._storedError);for(const F of this._requests)F.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(A){var F;(F=this.onProgress)==null||F.call(this,{loaded:A.loaded,total:A.lengthComputable?A.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const A=(0,t.createPromiseCapability)();return this._requests.push(A),A.promise}cancel(A){this._done=!0,this._headersReceivedCapability.reject(A);for(const F of this._requests)F.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class x{constructor(A,F,u){this._manager=A;const R={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=A.url,this._requestId=A.requestRange(F,u,R),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){var A;(A=this.onClosed)==null||A.call(this,this)}_onDone(A){const F=A.chunk;this._requests.length>0?this._requests.shift().resolve({value:F,done:!1}):this._queuedChunk=F,this._done=!0;for(const u of this._requests)u.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(A){this._storedError=(0,h.createResponseStatusError)(A,this._url);for(const F of this._requests)F.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(A){var F;this.isStreamingSupported||(F=this.onProgress)==null||F.call(this,{loaded:A.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const F=this._queuedChunk;return this._queuedChunk=null,{value:F,done:!1}}if(this._done)return{value:void 0,done:!0};const A=(0,t.createPromiseCapability)();return this._requests.push(A),A.promise}cancel(A){this._done=!0;for(const F of this._requests)F.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}},(G,n,o)=>{Object.defineProperty(n,"__esModule",{value:!0}),n.PDFFetchStream=void 0;var t=o(2),h=o(24);function p(_,x,E){return{method:"GET",headers:_,signal:E==null?void 0:E.signal,mode:"cors",credentials:x?"include":"same-origin",redirect:"follow"}}function S(_){const x=new Headers;for(const E in _){const A=_[E];typeof A>"u"||x.append(E,A)}return x}class m{constructor(x){this.source=x,this.isHttp=/^https?:/i.test(x.url),this.httpHeaders=this.isHttp&&x.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var x;return((x=this._fullRequestReader)==null?void 0:x._loaded)??0}getFullReader(){return(0,t.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new b(this),this._fullRequestReader}getRangeReader(x,E){if(E<=this._progressiveDataLength)return null;const A=new f(this,x,E);return this._rangeRequestReaders.push(A),A}cancelAllRequests(x){this._fullRequestReader&&this._fullRequestReader.cancel(x);for(const E of this._rangeRequestReaders.slice(0))E.cancel(x)}}n.PDFFetchStream=m;class b{constructor(x){this._stream=x,this._reader=null,this._loaded=0,this._filename=null;const E=x.source;this._withCredentials=E.withCredentials||!1,this._contentLength=E.length,this._headersCapability=(0,t.createPromiseCapability)(),this._disableRange=E.disableRange||!1,this._rangeChunkSize=E.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),typeof AbortController<"u"&&(this._abortController=new AbortController),this._isStreamingSupported=!E.disableStream,this._isRangeSupported=!E.disableRange,this._headers=S(this._stream.httpHeaders);const A=E.url;fetch(A,p(this._headers,this._withCredentials,this._abortController)).then(F=>{if(!(0,h.validateResponseStatus)(F.status))throw(0,h.createResponseStatusError)(F.status,A);this._reader=F.body.getReader(),this._headersCapability.resolve();const u=I=>F.headers.get(I),{allowRangeRequests:R,suggestedLength:B}=(0,h.validateRangeRequestCapabilities)({getResponseHeader:u,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=R,this._contentLength=B||this._contentLength,this._filename=(0,h.extractFilenameFromHeader)(u),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new t.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:x,done:E}=await this._reader.read();return E?{value:x,done:E}:(this._loaded+=x.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(x).buffer,done:!1})}cancel(x){this._reader&&this._reader.cancel(x),this._abortController&&this._abortController.abort()}}class f{constructor(x,E,A){this._stream=x,this._reader=null,this._loaded=0;const F=x.source;this._withCredentials=F.withCredentials||!1,this._readCapability=(0,t.createPromiseCapability)(),this._isStreamingSupported=!F.disableStream,typeof AbortController<"u"&&(this._abortController=new AbortController),this._headers=S(this._stream.httpHeaders),this._headers.append("Range",`bytes=${E}-${A-1}`);const u=F.url;fetch(u,p(this._headers,this._withCredentials,this._abortController)).then(R=>{if(!(0,h.validateResponseStatus)(R.status))throw(0,h.createResponseStatusError)(R.status,u);this._readCapability.resolve(),this._reader=R.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:x,done:E}=await this._reader.read();return E?{value:x,done:E}:(this._loaded+=x.byteLength,this.onProgress&&this.onProgress({loaded:this._loaded}),{value:new Uint8Array(x).buffer,done:!1})}cancel(x){this._reader&&this._reader.cancel(x),this._abortController&&this._abortController.abort()}}}],__webpack_module_cache__={};function __w_pdfjs_require__(G){var n=__webpack_module_cache__[G];if(n!==void 0)return n.exports;var o=__webpack_module_cache__[G]={exports:{}};return __webpack_modules__[G](o,o.exports,__w_pdfjs_require__),o.exports}var __webpack_exports__={};return(()=>{var G=__webpack_exports__;Object.defineProperty(G,"__esModule",{value:!0}),Object.defineProperty(G,"addLinkAttributes",{enumerable:!0,get:function(){return n.addLinkAttributes}}),Object.defineProperty(G,"getFilenameFromUrl",{enumerable:!0,get:function(){return n.getFilenameFromUrl}}),Object.defineProperty(G,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return n.getPdfFilenameFromUrl}}),Object.defineProperty(G,"getXfaPageViewport",{enumerable:!0,get:function(){return n.getXfaPageViewport}}),Object.defineProperty(G,"isPdfFile",{enumerable:!0,get:function(){return n.isPdfFile}}),Object.defineProperty(G,"LinkTarget",{enumerable:!0,get:function(){return n.LinkTarget}}),Object.defineProperty(G,"loadScript",{enumerable:!0,get:function(){return n.loadScript}}),Object.defineProperty(G,"PDFDateString",{enumerable:!0,get:function(){return n.PDFDateString}}),Object.defineProperty(G,"PixelsPerInch",{enumerable:!0,get:function(){return n.PixelsPerInch}}),Object.defineProperty(G,"RenderingCancelledException",{enumerable:!0,get:function(){return n.RenderingCancelledException}}),Object.defineProperty(G,"AnnotationMode",{enumerable:!0,get:function(){return o.AnnotationMode}}),Object.defineProperty(G,"CMapCompressionType",{enumerable:!0,get:function(){return o.CMapCompressionType}}),Object.defineProperty(G,"createObjectURL",{enumerable:!0,get:function(){return o.createObjectURL}}),Object.defineProperty(G,"createPromiseCapability",{enumerable:!0,get:function(){return o.createPromiseCapability}}),Object.defineProperty(G,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return o.createValidAbsoluteUrl}}),Object.defineProperty(G,"InvalidPDFException",{enumerable:!0,get:function(){return o.InvalidPDFException}}),Object.defineProperty(G,"MissingPDFException",{enumerable:!0,get:function(){return o.MissingPDFException}}),Object.defineProperty(G,"OPS",{enumerable:!0,get:function(){return o.OPS}}),Object.defineProperty(G,"PasswordResponses",{enumerable:!0,get:function(){return o.PasswordResponses}}),Object.defineProperty(G,"PermissionFlag",{enumerable:!0,get:function(){return o.PermissionFlag}}),Object.defineProperty(G,"removeNullCharacters",{enumerable:!0,get:function(){return o.removeNullCharacters}}),Object.defineProperty(G,"shadow",{enumerable:!0,get:function(){return o.shadow}}),Object.defineProperty(G,"UnexpectedResponseException",{enumerable:!0,get:function(){return o.UnexpectedResponseException}}),Object.defineProperty(G,"UNSUPPORTED_FEATURES",{enumerable:!0,get:function(){return o.UNSUPPORTED_FEATURES}}),Object.defineProperty(G,"Util",{enumerable:!0,get:function(){return o.Util}}),Object.defineProperty(G,"VerbosityLevel",{enumerable:!0,get:function(){return o.VerbosityLevel}}),Object.defineProperty(G,"build",{enumerable:!0,get:function(){return t.build}}),Object.defineProperty(G,"getDocument",{enumerable:!0,get:function(){return t.getDocument}}),Object.defineProperty(G,"LoopbackPort",{enumerable:!0,get:function(){return t.LoopbackPort}}),Object.defineProperty(G,"PDFDataRangeTransport",{enumerable:!0,get:function(){return t.PDFDataRangeTransport}}),Object.defineProperty(G,"PDFWorker",{enumerable:!0,get:function(){return t.PDFWorker}}),Object.defineProperty(G,"version",{enumerable:!0,get:function(){return t.version}}),Object.defineProperty(G,"AnnotationLayer",{enumerable:!0,get:function(){return h.AnnotationLayer}}),Object.defineProperty(G,"GlobalWorkerOptions",{enumerable:!0,get:function(){return p.GlobalWorkerOptions}}),Object.defineProperty(G,"renderTextLayer",{enumerable:!0,get:function(){return m.renderTextLayer}}),Object.defineProperty(G,"SVGGraphics",{enumerable:!0,get:function(){return b.SVGGraphics}}),Object.defineProperty(G,"XfaLayer",{enumerable:!0,get:function(){return f.XfaLayer}});var n=__w_pdfjs_require__(1),o=__w_pdfjs_require__(2),t=__w_pdfjs_require__(6),h=__w_pdfjs_require__(18),p=__w_pdfjs_require__(12),S=__w_pdfjs_require__(4),m=__w_pdfjs_require__(20),b=__w_pdfjs_require__(21),f=__w_pdfjs_require__(22);if(S.isNodeJS){const{PDFNodeStream:_}=__w_pdfjs_require__(23);(0,t.setPDFNetworkStreamFactory)(x=>new _(x))}else{const{PDFNetworkStream:_}=__w_pdfjs_require__(26),{PDFFetchStream:x}=__w_pdfjs_require__(27);(0,t.setPDFNetworkStreamFactory)(E=>(0,n.isValidFetchUrl)(E.url)?new x(E):new _(E))}})(),__webpack_exports__})()})})(pdf);var pdfExports=pdf.exports;async function process_file(G,n,o,t,h,p,S){const m=n.name,b=n.size,f=new Date;let _;const x=h,E=p,A=new RecursiveCharacterTextSplitter({chunkSize:x,chunkOverlap:E}),F=createClient(PUBLIC_SUPABASE_URL,PUBLIC_SUPABASE_KEY);let R=(await F.auth.getUser()).data.user.id;console.log("userID",R);let B;if(console.log("isUrl",S),S===!0){console.log("isUrl",S);const g=new FileReader;g.onload=async function(v){const y=v.target.result,O={pageContent:y.toString(),metadata:{file_sha1:_,file_size:b,file_name:m,chunk_size:h,chunk_overlap:p,date:f}};B=await A.splitDocuments([O]),console.log("splittedDocuments",B[0].user_id),_=await computeSHA1FromContent$1(y);const M=[];for(const H of B){const q={pageContent:H.pageContent,metadata:{file_sha1:_,file_size:b,file_name:m,chunk_size:h,chunk_overlap:p,date:f}};M.push(q)}const Q=createClient(PUBLIC_SUPABASE_URL,PUBLIC_SUPABASE_KEY),V=PUBLIC_OPENAI_API_KEY,k=new OpenAIEmbeddings({openAIApiKey:V});console.log("user_id",R),new SupabaseVectorStore(k,{client:Q,queryName:"insert",tableName:"documents"}).addDocuments(M)},await g.readAsText(n)}else if(t===".pdf"){console.log("isPdf");const g=new File([n],m,{type:n.type});_=await computeSHA1FromFile(g);const v=await fetchFileAsArrayBuffer(g),y=await pdfExports.getDocument({data:v}).promise,O=await extractTextFromPDF(y);console.log("pdfText",O);const M={pageContent:O,metadata:{file_sha1:_,file_size:b,file_name:m,chunk_size:h,chunk_overlap:p,date:f}};B=await A.splitDocuments([M]),console.log("splittedDocuments",B);const Q=[];for(const q of B){const W={pageContent:q.pageContent,metadata:{file_sha1:_,file_size:b,file_name:m,chunk_size:h,chunk_overlap:p,date:f}};Q.push(W)}const V=createClient(PUBLIC_SUPABASE_URL,PUBLIC_SUPABASE_KEY),k=PUBLIC_OPENAI_API_KEY,L=new OpenAIEmbeddings({openAIApiKey:k});console.log("user_id",R);let H=new SupabaseVectorStore(L,{client:V,queryName:"insert",tableName:"documents"});console.log("docs Metadata",Q[0].user_id),H.addDocuments(Q)}else{const g=new File([n],m,{type:n.type});_=await computeSHA1FromFile(g);const y=await new o(g).load();B=await A.splitDocuments(y)}const I=[];for(const g of B){const v={pageContent:g.pageContent,metadata:{file_sha1:_,file_size:b,file_name:m,chunk_size:h,chunk_overlap:p,date:f}};I.push(v)}const w=PUBLIC_OPENAI_API_KEY,s=new OpenAIEmbeddings({openAIApiKey:w});console.log("user_id",R);let a=new SupabaseVectorStore(s,{client:F,tableName:"documents",queryName:"insert"});console.log("docsWithMetadata",I);try{a.addDocuments(I)}catch(g){console.log("error",g)}}async function extractTextFromPDF(G){let n="";for(let o=1;o<=G.numPages;o++){const p=(await(await G.getPage(o)).getTextContent()).items.map(S=>S.str).join(" ");n+=p+" "}return n}async function fetchFileAsArrayBuffer(G){return await(await fetch(URL.createObjectURL(G))).arrayBuffer()}class BaseDocumentLoader{async loadAndSplit(n=new RecursiveCharacterTextSplitter){const o=await this.load();return n.splitDocuments(o)}}class TextLoader extends BaseDocumentLoader{constructor(n){super(),Object.defineProperty(this,"filePathOrBlob",{enumerable:!0,configurable:!0,writable:!0,value:n})}async parse(n){return[n]}async load(){let n,o;if(typeof this.filePathOrBlob=="string"){const{readFile:h}=await TextLoader.imports();n=await h(this.filePathOrBlob,"utf8"),o={source:this.filePathOrBlob}}else n=await this.filePathOrBlob.text(),o={source:"blob",blobType:this.filePathOrBlob.type};const t=await this.parse(n);return t.forEach((h,p)=>{if(typeof h!="string")throw new Error(`Expected string, at position ${p} got ${typeof h}`)}),t.map((h,p)=>new Document({pageContent:h,metadata:t.length===1?o:{...o,line:p+1}}))}static async imports(){try{const{readFile:n}=await __vitePreload(()=>import("../chunks/promises.0ef77ad7.js"),[],import.meta.url);return{readFile:n}}catch(n){throw console.error(n),new Error(`Failed to load fs/promises. TextLoader available only on environment 'node'. It appears you are running environment '${getEnv()}'. See https://<link to docs> for alternatives.`)}}}function processTxt(G,n){return process_file(G,n,TextLoader,".txt",500,0)}function process_pdf(G,n){return process_file(G,n,TextLoader,".pdf",500,0)}class UnstructuredLoader extends BaseDocumentLoader{constructor(n,o={}){super(),Object.defineProperty(this,"filePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiUrl",{enumerable:!0,configurable:!0,writable:!0,value:"https://api.unstructured.io/general/v0/general"}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"strategy",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof o=="string"?(this.filePath=o,this.apiUrl=n):(this.filePath=n,this.apiKey=o.apiKey,this.apiUrl=o.apiUrl??this.apiUrl,this.strategy=o.strategy??"hi_res")}async _partition(){const{readFile:n,basename:o}=await this.imports(),t=await n(this.filePath),h=o(this.filePath),p=new FormData;p.append("files",new Blob([t]),h),p.append("strategy",this.strategy);const S={"UNSTRUCTURED-API-KEY":this.apiKey??""},m=await fetch(this.apiUrl,{method:"POST",body:p,headers:S});if(!m.ok)throw new Error(`Failed to partition file ${this.filePath} with error ${m.status} and message ${await m.text()}`);const b=await m.json();if(!Array.isArray(b))throw new Error(`Expected partitioning request to return an array, but got ${b}`);return b.filter(f=>typeof f.text=="string")}async load(){const n=await this._partition(),o=[];for(const t of n){const{metadata:h,text:p}=t;o.push(new Document({pageContent:p,metadata:{...h,category:t.type}}))}return o}async imports(){try{const{readFile:n}=await __vitePreload(()=>import("../chunks/promises.0ef77ad7.js"),[],import.meta.url),{basename:o}=await __vitePreload(()=>import("../chunks/__vite-browser-external_node_path.042c5bd1.js"),[],import.meta.url);return{readFile:n,basename:o}}catch(n){throw console.error(n),new Error(`Failed to load fs/promises. TextLoader available only on environment 'node'. It appears you are running environment '${getEnv()}'. See https://<link to docs> for alternatives.`)}}}async function processHtml(G,n){return process_file(G,n,UnstructuredLoader,".html")}async function getHtml(G){try{const o=`/api?${new URLSearchParams({url:G}).toString()}`,t=await fetch(o,{method:"GET"});return t.status===200?await t.text():(console.log("error: ",t.status),null)}catch(n){return console.log("error: ",n),null}}class CustomFile extends Blob{constructor(n,o){super(n,o),this.name=o.name,this.lastModifiedDate=new Date}}function createHtmlFile(G,n){const o=slugify(G)+".html";return new CustomFile([n],{type:"text/html",name:o})}function slugify(G){return G=G.normalize("NFKD").replace(/[\u0300-\u036f]/g,""),G=G.replace(/[^\w\s-]/g,"").trim().toLowerCase(),G=G.replace(/[-\s]+/g,"-"),G}async function computeSHA1FromContent(G){const o=new TextEncoder().encode(G),t=await crypto.subtle.digest("SHA-1",o),p=Array.from(new Uint8Array(t)).map(S=>S.toString(16).padStart(2,"0")).join("");return console.log("readableHash from computeSHA1FromContent: ",p),p}const file_processors={".txt":processTxt,".pdf":process_pdf,".html":processHtml};async function file_uploader(G,n,o,t){Array.isArray(t)||(t=[t]),console.log(t);for(const h of t)await filter_file(h,G)}async function file_already_exists(G,n){const o=computeSHA1FromContent(n);let t=createClient(PUBLIC_SUPABASE_URL,PUBLIC_SUPABASE_KEY);const{data:h,error:p}=await t.from("documents").select("id").eq("metadata->>file_sha1",o);return p?(console.log(`Error retrieving data: ${p.message}`),!1):h.length>0}async function filter_file(G,n,o){if(await file_already_exists(n,G))return console.log(`😎 ${G.name} is already in the database.`),!1;if(G.size<1)return console.log(`💨 ${G.name} is empty.`),!1;{const t=`.${G.name.split(".").pop()}`;if(console.log(G.name,t),t in file_processors){const h=PUBLIC_OPENAI_API_KEY;let p=createClient(PUBLIC_SUPABASE_URL,PUBLIC_SUPABASE_KEY),S=new OpenAIEmbeddings({openAIApiKey:h}),m=new SupabaseVectorStore(S,{client:p,tableName:"documents"});return await file_processors[t](m,G),console.log(`✅ ${G.name}`),!0}else return console.log(`❌ ${G.name} is not a valid file type.`),!1}}async function url_uploader(G,n,o,t){const h=await getHtml(t);console.log(h);const p=createHtmlFile(t,h);console.log(p),await process_file(o,p,UnstructuredLoader,".html",500,0,!0)}const file="src/routes/upload/+page.svelte";function create_if_block(G){let n,o;const t={c:function(){n=element("div"),o=text(G[1]),this.h()},l:function(p){n=claim_element(p,"DIV",{class:!0});var S=children(n);o=claim_text(S,G[1]),S.forEach(detach_dev),this.h()},h:function(){attr_dev(n,"class","text-red-500 mb-4"),add_location(n,file,73,10,1616)},m:function(p,S){insert_hydration_dev(p,n,S),append_hydration_dev(n,o)},p:function(p,S){S&2&&set_data_dev(o,p[1])},d:function(p){p&&detach_dev(n)}};return dispatch_dev("SvelteRegisterBlock",{block:t,id:create_if_block.name,type:"if",source:"(51:8) {#if error}",ctx:G}),t}function create_default_slot(G){let n,o,t,h,p,S,m="Insert Data Page",b,f,_,x,E="Upload Files",A,F,u,R,B,I="Upload Files",w,s,a,g="Add the URL to the database",v,y,O,M,Q,V="Add URL",k,L,H;t=new NavBar({$$inline:!0});let q=G[1]&&create_if_block(G);const W={c:function(){n=element("div"),o=element("div"),create_component(t.$$.fragment),h=space(),p=element("div"),S=element("h1"),S.textContent=m,b=space(),q&&q.c(),f=space(),_=element("div"),x=element("label"),x.textContent=E,A=space(),F=element("div"),u=element("input"),R=space(),B=element("button"),B.textContent=I,w=space(),s=element("div"),a=element("label"),a.textContent=g,v=space(),y=element("div"),O=element("textarea"),M=space(),Q=element("button"),Q.textContent=V,this.h()},l:function(T){n=claim_element(T,"DIV",{class:!0});var c=children(n);o=claim_element(c,"DIV",{class:!0});var e=children(o);claim_component(t.$$.fragment,e),h=claim_space(e),p=claim_element(e,"DIV",{class:!0});var r=children(p);S=claim_element(r,"H1",{class:!0,"data-svelte-h":!0}),get_svelte_dataset(S)!=="svelte-1uys3o0"&&(S.textContent=m),b=claim_space(r),q&&q.l(r),f=claim_space(r),_=claim_element(r,"DIV",{class:!0});var i=children(_);x=claim_element(i,"LABEL",{class:!0,"data-svelte-h":!0}),get_svelte_dataset(x)!=="svelte-qb0qet"&&(x.textContent=E),A=claim_space(i),F=claim_element(i,"DIV",{class:!0});var d=children(F);u=claim_element(d,"INPUT",{type:!0,class:!0}),R=claim_space(d),B=claim_element(d,"BUTTON",{class:!0,"data-svelte-h":!0}),get_svelte_dataset(B)!=="svelte-lgl95g"&&(B.textContent=I),d.forEach(detach_dev),i.forEach(detach_dev),w=claim_space(r),s=claim_element(r,"DIV",{class:!0});var l=children(s);a=claim_element(l,"LABEL",{class:!0,"data-svelte-h":!0}),get_svelte_dataset(a)!=="svelte-qczuz7"&&(a.textContent=g),v=claim_space(l),y=claim_element(l,"DIV",{class:!0});var C=children(y);O=claim_element(C,"TEXTAREA",{class:!0,rows:!0}),children(O).forEach(detach_dev),M=claim_space(C),Q=claim_element(C,"BUTTON",{class:!0,"data-svelte-h":!0}),get_svelte_dataset(Q)!=="svelte-q899tv"&&(Q.textContent=V),C.forEach(detach_dev),l.forEach(detach_dev),r.forEach(detach_dev),e.forEach(detach_dev),c.forEach(detach_dev),this.h()},h:function(){attr_dev(S,"class","text-2xl md:text-4xl font-bold mb-4 md:mb-8"),add_location(S,file,68,8,1457),attr_dev(x,"class","label mb-2 text-lg font-bold"),add_location(x,file,78,10,1759),attr_dev(u,"type","file"),u.multiple=!0,attr_dev(u,"class","input input-accent mr-0 md:mr-4 mb-2 md:mb-0"),add_location(u,file,80,12,1899),attr_dev(B,"class","btn btn-primary text-lg font-bold"),add_location(B,file,86,12,2082),attr_dev(F,"class","flex flex-col md:flex-row items-center"),add_location(F,file,79,10,1834),attr_dev(_,"class","w-full mb-4 md:mb-8"),add_location(_,file,77,8,1715),attr_dev(a,"class","label mb-2 text-lg font-bold"),add_location(a,file,97,10,2361),attr_dev(O,"class","textarea textarea-accent resize-none flex-grow text-lg font-bold mb-2 md:mb-0 md:mr-4"),attr_dev(O,"rows","1"),add_location(O,file,101,12,2540),attr_dev(Q,"class","btn btn-primary text-lg font-bold"),add_location(Q,file,106,12,2739),attr_dev(y,"class","flex flex-col md:flex-row items-center"),add_location(y,file,100,10,2475),attr_dev(s,"class","w-full"),add_location(s,file,96,8,2330),attr_dev(p,"class","p-4 md:p-8 flex flex-col items-center h-screen"),add_location(p,file,67,6,1388),attr_dev(o,"class","flex flex-col items-center"),add_location(o,file,65,4,1324),attr_dev(n,"class","flex flex-col min-h-screen min-w-full bg-gray-900 text-white p-4"),add_location(n,file,64,2,1241)},m:function(T,c){insert_hydration_dev(T,n,c),append_hydration_dev(n,o),mount_component(t,o,null),append_hydration_dev(o,h),append_hydration_dev(o,p),append_hydration_dev(p,S),append_hydration_dev(p,b),q&&q.m(p,null),append_hydration_dev(p,f),append_hydration_dev(p,_),append_hydration_dev(_,x),append_hydration_dev(_,A),append_hydration_dev(_,F),append_hydration_dev(F,u),append_hydration_dev(F,R),append_hydration_dev(F,B),append_hydration_dev(p,w),append_hydration_dev(p,s),append_hydration_dev(s,a),append_hydration_dev(s,v),append_hydration_dev(s,y),append_hydration_dev(y,O),set_input_value(O,G[0]),append_hydration_dev(y,M),append_hydration_dev(y,Q),k=!0,L||(H=[listen_dev(u,"change",G[2],!1,!1,!1,!1),listen_dev(B,"click",G[5],!1,!1,!1,!1),listen_dev(O,"input",G[6]),listen_dev(Q,"click",G[7],!1,!1,!1,!1)],L=!0)},p:function(T,c){T[1]?q?q.p(T,c):(q=create_if_block(T),q.c(),q.m(p,f)):q&&(q.d(1),q=null),c&1&&set_input_value(O,T[0])},i:function(T){k||(transition_in(t.$$.fragment,T),k=!0)},o:function(T){transition_out(t.$$.fragment,T),k=!1},d:function(T){T&&detach_dev(n),destroy_component(t),q&&q.d(),L=!1,run_all(H)}};return dispatch_dev("SvelteRegisterBlock",{block:W,id:create_default_slot.name,type:"slot",source:"(42:0) <AuthCheck>",ctx:G}),W}function create_fragment(G){let n,o;n=new AuthCheck({props:{$$slots:{default:[create_default_slot]},$$scope:{ctx:G}},$$inline:!0});const t={c:function(){create_component(n.$$.fragment)},l:function(p){claim_component(n.$$.fragment,p)},m:function(p,S){mount_component(n,p,S),o=!0},p:function(p,[S]){const m={};S&4099&&(m.$$scope={dirty:S,ctx:p}),n.$set(m)},i:function(p){o||(transition_in(n.$$.fragment,p),o=!0)},o:function(p){transition_out(n.$$.fragment,p),o=!1},d:function(p){destroy_component(n,p)}};return dispatch_dev("SvelteRegisterBlock",{block:t,id:create_fragment.name,type:"component",source:"",ctx:G}),t}function instance(G,n,o){let{$$slots:t={},$$scope:h}=n;validate_slots("Page",t,[]);let p,S,m,b,f,_="";async function x(I){b=I.target.files[0]}onMount(()=>{p=createClient(PUBLIC_SUPABASE_URL,PUBLIC_SUPABASE_KEY);const I=PUBLIC_OPENAI_API_KEY;let w=new OpenAIEmbeddings({openAIApiKey:I});S=new SupabaseVectorStore(w,{client:p,tableName:"documents"})});async function E(){await file_uploader(p,PUBLIC_HUGGINGFACE_API_KEY,S,b),o(1,_="")}async function A(){await url_uploader(p,PUBLIC_HUGGINGFACE_API_KEY,S,f),o(1,_="")}const F=[];Object.keys(n).forEach(I=>{!~F.indexOf(I)&&I.slice(0,2)!=="$$"&&I!=="slot"&&console.warn(`<Page> was created with unknown prop '${I}'`)});const u=()=>E();function R(){f=this.value,o(0,f)}const B=()=>A();return G.$capture_state=()=>({file_uploader,url_uploader,OpenAIEmbeddings,createClient,SupabaseVectorStore,onMount,PUBLIC_SUPABASE_KEY,PUBLIC_SUPABASE_URL,PUBLIC_HUGGINGFACE_API_KEY,PUBLIC_OPENAI_API_KEY,AuthCheck,NavBar,supabase:p,vector:S,embeddings:m,files:b,url:f,error:_,upload:x,handleFileUpload:E,handleUrlUpload:A}),G.$inject_state=I=>{"supabase"in I&&(p=I.supabase),"vector"in I&&(S=I.vector),"embeddings"in I&&(m=I.embeddings),"files"in I&&(b=I.files),"url"in I&&o(0,f=I.url),"error"in I&&o(1,_=I.error)},n&&"$$inject"in n&&G.$inject_state(n.$$inject),[f,_,x,E,A,u,R,B]}class Page extends SvelteComponentDev{constructor(n){super(n),init(this,n,instance,create_fragment,safe_not_equal,{}),dispatch_dev("SvelteRegisterComponent",{component:this,tagName:"Page",options:n,id:create_fragment.name})}}export{Page as component};
